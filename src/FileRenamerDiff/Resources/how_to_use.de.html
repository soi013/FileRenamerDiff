<!doctype html>
<html>
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="data:text/css;charset=utf-8;charset=utf-8,%0A%0A%2Eclearfix%20%7B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Eclearfix%3Abefore%2C%0A%2Eclearfix%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Eclearfix%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Ehide%2Dtext%20%7B%0Afont%3A%200%2F0%20a%3B%0Acolor%3A%20transparent%3B%0Atext%2Dshadow%3A%20none%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Einput%2Dblock%2Dlevel%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amin%2Dheight%3A%2030px%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Aarticle%2C%0Aaside%2C%0Adetails%2C%0Afigcaption%2C%0Afigure%2C%0Afooter%2C%0Aheader%2C%0Ahgroup%2C%0Anav%2C%0Asection%20%7B%0Adisplay%3A%20block%3B%0A%7D%0Aaudio%2C%0Acanvas%2C%0Avideo%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%2Adisplay%3A%20inline%3B%0A%2Azoom%3A%201%3B%0A%7D%0Aaudio%3Anot%28%5Bcontrols%5D%29%20%7B%0Adisplay%3A%20none%3B%0A%7D%0Ahtml%20%7B%0Afont%2Dsize%3A%20100%25%3B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%2Dms%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%7D%0Aa%3Afocus%20%7B%0Aoutline%3A%20thin%20dotted%20%23333%3B%0Aoutline%3A%205px%20auto%20%2Dwebkit%2Dfocus%2Dring%2Dcolor%3B%0Aoutline%2Doffset%3A%20%2D2px%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Aoutline%3A%200%3B%0A%7D%0Asub%2C%0Asup%20%7B%0Aposition%3A%20relative%3B%0Afont%2Dsize%3A%2075%25%3B%0Aline%2Dheight%3A%200%3B%0Avertical%2Dalign%3A%20baseline%3B%0A%7D%0Asup%20%7B%0Atop%3A%20%2D0%2E5em%3B%0A%7D%0Asub%20%7B%0Abottom%3A%20%2D0%2E25em%3B%0A%7D%0Aimg%20%7B%0A%0Amax%2Dwidth%3A%20100%25%3B%0A%0Awidth%3A%20auto%5C9%3B%0A%0Aheight%3A%20auto%3B%0A%0Avertical%2Dalign%3A%20middle%3B%0Aborder%3A%200%3B%0A%2Dms%2Dinterpolation%2Dmode%3A%20bicubic%3B%0A%7D%0A%23map%5Fcanvas%20img%2C%0A%2Egoogle%2Dmaps%20img%20%7B%0Amax%2Dwidth%3A%20none%3B%0A%7D%0Abutton%2C%0Ainput%2C%0Aselect%2C%0Atextarea%20%7B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0Abutton%2C%0Ainput%20%7B%0A%2Aoverflow%3A%20visible%3B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Abutton%3A%3A%2Dmoz%2Dfocus%2Dinner%2C%0Ainput%3A%3A%2Dmoz%2Dfocus%2Dinner%20%7B%0Apadding%3A%200%3B%0Aborder%3A%200%3B%0A%7D%0Abutton%2C%0Ahtml%20input%5Btype%3D%22button%22%5D%2C%0Ainput%5Btype%3D%22reset%22%5D%2C%0Ainput%5Btype%3D%22submit%22%5D%20%7B%0A%2Dwebkit%2Dappearance%3A%20button%3B%0Acursor%3A%20pointer%3B%0A%7D%0Alabel%2C%0Aselect%2C%0Abutton%2C%0Ainput%5Btype%3D%22button%22%5D%2C%0Ainput%5Btype%3D%22reset%22%5D%2C%0Ainput%5Btype%3D%22submit%22%5D%2C%0Ainput%5Btype%3D%22radio%22%5D%2C%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Acursor%3A%20pointer%3B%0A%7D%0Ainput%5Btype%3D%22search%22%5D%20%7B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20content%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20content%2Dbox%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0A%2Dwebkit%2Dappearance%3A%20textfield%3B%0A%7D%0Ainput%5Btype%3D%22search%22%5D%3A%3A%2Dwebkit%2Dsearch%2Ddecoration%2C%0Ainput%5Btype%3D%22search%22%5D%3A%3A%2Dwebkit%2Dsearch%2Dcancel%2Dbutton%20%7B%0A%2Dwebkit%2Dappearance%3A%20none%3B%0A%7D%0Atextarea%20%7B%0Aoverflow%3A%20auto%3B%0Avertical%2Dalign%3A%20top%3B%0A%7D%0A%40media%20print%20%7B%0A%2A%20%7B%0Atext%2Dshadow%3A%20none%20%21important%3B%0Acolor%3A%20%23000%20%21important%3B%0Abackground%3A%20transparent%20%21important%3B%0Abox%2Dshadow%3A%20none%20%21important%3B%0A%7D%0Aa%2C%0Aa%3Avisited%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Aa%5Bhref%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28href%29%20%22%29%22%3B%0A%7D%0Aabbr%5Btitle%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28title%29%20%22%29%22%3B%0A%7D%0A%2Eir%20a%3Aafter%2C%0Aa%5Bhref%5E%3D%22javascript%3A%22%5D%3Aafter%2C%0Aa%5Bhref%5E%3D%22%23%22%5D%3Aafter%20%7B%0Acontent%3A%20%22%22%3B%0A%7D%0Apre%2C%0Ablockquote%20%7B%0Aborder%3A%201px%20solid%20%23999%3B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Athead%20%7B%0Adisplay%3A%20table%2Dheader%2Dgroup%3B%0A%7D%0Atr%2C%0Aimg%20%7B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%20%21important%3B%0A%7D%0A%40page%20%7B%0Amargin%3A%200%2E5cm%3B%0A%7D%0Ap%2C%0Ah2%2C%0Ah3%20%7B%0Aorphans%3A%203%3B%0Awidows%3A%203%3B%0A%7D%0Ah2%2C%0Ah3%20%7B%0Apage%2Dbreak%2Dafter%3A%20avoid%3B%0A%7D%0A%7D%0Abody%20%7B%0Amargin%3A%200%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%2020px%3B%0Acolor%3A%20%23333333%3B%0Abackground%2Dcolor%3A%20%23ffffff%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230088cc%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Afocus%20%7B%0Acolor%3A%20%23005580%3B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0A%2Eimg%2Drounded%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%206px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%206px%3B%0Aborder%2Dradius%3A%206px%3B%0A%7D%0A%2Eimg%2Dpolaroid%20%7B%0Apadding%3A%204px%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%3A%201px%20solid%20%23ccc%3B%0Aborder%3A%201px%20solid%20rgba%280%2C%200%2C%200%2C%200%2E2%29%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%201px%203px%20rgba%280%2C%200%2C%200%2C%200%2E1%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%201px%203px%20rgba%280%2C%200%2C%200%2C%200%2E1%29%3B%0Abox%2Dshadow%3A%200%201px%203px%20rgba%280%2C%200%2C%200%2C%200%2E1%29%3B%0A%7D%0A%2Eimg%2Dcircle%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%20500px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%20500px%3B%0Aborder%2Dradius%3A%20500px%3B%0A%7D%0A%2Erow%20%7B%0Amargin%2Dleft%3A%20%2D20px%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%3Abefore%2C%0A%2Erow%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%20%7B%0Afloat%3A%20left%3B%0Amin%2Dheight%3A%201px%3B%0Amargin%2Dleft%3A%2020px%3B%0A%7D%0A%2Econtainer%2C%0A%2Enavbar%2Dstatic%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Econtainer%20%7B%0Awidth%3A%20940px%3B%0A%7D%0A%2Espan12%20%7B%0Awidth%3A%20940px%3B%0A%7D%0A%2Espan11%20%7B%0Awidth%3A%20860px%3B%0A%7D%0A%2Espan10%20%7B%0Awidth%3A%20780px%3B%0A%7D%0A%2Espan9%20%7B%0Awidth%3A%20700px%3B%0A%7D%0A%2Espan8%20%7B%0Awidth%3A%20620px%3B%0A%7D%0A%2Espan7%20%7B%0Awidth%3A%20540px%3B%0A%7D%0A%2Espan6%20%7B%0Awidth%3A%20460px%3B%0A%7D%0A%2Espan5%20%7B%0Awidth%3A%20380px%3B%0A%7D%0A%2Espan4%20%7B%0Awidth%3A%20300px%3B%0A%7D%0A%2Espan3%20%7B%0Awidth%3A%20220px%3B%0A%7D%0A%2Espan2%20%7B%0Awidth%3A%20140px%3B%0A%7D%0A%2Espan1%20%7B%0Awidth%3A%2060px%3B%0A%7D%0A%2Eoffset12%20%7B%0Amargin%2Dleft%3A%20980px%3B%0A%7D%0A%2Eoffset11%20%7B%0Amargin%2Dleft%3A%20900px%3B%0A%7D%0A%2Eoffset10%20%7B%0Amargin%2Dleft%3A%20820px%3B%0A%7D%0A%2Eoffset9%20%7B%0Amargin%2Dleft%3A%20740px%3B%0A%7D%0A%2Eoffset8%20%7B%0Amargin%2Dleft%3A%20660px%3B%0A%7D%0A%2Eoffset7%20%7B%0Amargin%2Dleft%3A%20580px%3B%0A%7D%0A%2Eoffset6%20%7B%0Amargin%2Dleft%3A%20500px%3B%0A%7D%0A%2Eoffset5%20%7B%0Amargin%2Dleft%3A%20420px%3B%0A%7D%0A%2Eoffset4%20%7B%0Amargin%2Dleft%3A%20340px%3B%0A%7D%0A%2Eoffset3%20%7B%0Amargin%2Dleft%3A%20260px%3B%0A%7D%0A%2Eoffset2%20%7B%0Amargin%2Dleft%3A%20180px%3B%0A%7D%0A%2Eoffset1%20%7B%0Amargin%2Dleft%3A%20100px%3B%0A%7D%0A%2Erow%2Dfluid%20%7B%0Awidth%3A%20100%25%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%2Dfluid%3Abefore%2C%0A%2Erow%2Dfluid%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amin%2Dheight%3A%2030px%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Afloat%3A%20left%3B%0Amargin%2Dleft%3A%202%2E127659574468085%25%3B%0A%2Amargin%2Dleft%3A%202%2E074468085106383%25%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%20%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%202%2E127659574468085%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan12%20%7B%0Awidth%3A%20100%25%3B%0A%2Awidth%3A%2099%2E94680851063829%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan11%20%7B%0Awidth%3A%2091%2E48936170212765%25%3B%0A%2Awidth%3A%2091%2E43617021276594%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan10%20%7B%0Awidth%3A%2082%2E97872340425532%25%3B%0A%2Awidth%3A%2082%2E92553191489361%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan9%20%7B%0Awidth%3A%2074%2E46808510638297%25%3B%0A%2Awidth%3A%2074%2E41489361702126%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan8%20%7B%0Awidth%3A%2065%2E95744680851064%25%3B%0A%2Awidth%3A%2065%2E90425531914893%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan7%20%7B%0Awidth%3A%2057%2E44680851063829%25%3B%0A%2Awidth%3A%2057%2E39361702127659%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan6%20%7B%0Awidth%3A%2048%2E93617021276595%25%3B%0A%2Awidth%3A%2048%2E88297872340425%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan5%20%7B%0Awidth%3A%2040%2E42553191489362%25%3B%0A%2Awidth%3A%2040%2E37234042553192%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan4%20%7B%0Awidth%3A%2031%2E914893617021278%25%3B%0A%2Awidth%3A%2031%2E861702127659576%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan3%20%7B%0Awidth%3A%2023%2E404255319148934%25%3B%0A%2Awidth%3A%2023%2E351063829787233%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan2%20%7B%0Awidth%3A%2014%2E893617021276595%25%3B%0A%2Awidth%3A%2014%2E840425531914894%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan1%20%7B%0Awidth%3A%206%2E382978723404255%25%3B%0A%2Awidth%3A%206%2E329787234042553%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%20%7B%0Amargin%2Dleft%3A%20104%2E25531914893617%25%3B%0A%2Amargin%2Dleft%3A%20104%2E14893617021275%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%20102%2E12765957446808%25%3B%0A%2Amargin%2Dleft%3A%20102%2E02127659574467%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%20%7B%0Amargin%2Dleft%3A%2095%2E74468085106382%25%3B%0A%2Amargin%2Dleft%3A%2095%2E6382978723404%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2093%2E61702127659574%25%3B%0A%2Amargin%2Dleft%3A%2093%2E51063829787232%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%20%7B%0Amargin%2Dleft%3A%2087%2E23404255319149%25%3B%0A%2Amargin%2Dleft%3A%2087%2E12765957446807%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2085%2E1063829787234%25%3B%0A%2Amargin%2Dleft%3A%2084%2E99999999999999%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%20%7B%0Amargin%2Dleft%3A%2078%2E72340425531914%25%3B%0A%2Amargin%2Dleft%3A%2078%2E61702127659572%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2076%2E59574468085106%25%3B%0A%2Amargin%2Dleft%3A%2076%2E48936170212764%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%20%7B%0Amargin%2Dleft%3A%2070%2E2127659574468%25%3B%0A%2Amargin%2Dleft%3A%2070%2E10638297872339%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2068%2E08510638297872%25%3B%0A%2Amargin%2Dleft%3A%2067%2E9787234042553%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%20%7B%0Amargin%2Dleft%3A%2061%2E70212765957446%25%3B%0A%2Amargin%2Dleft%3A%2061%2E59574468085106%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2059%2E574468085106375%25%3B%0A%2Amargin%2Dleft%3A%2059%2E46808510638297%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%20%7B%0Amargin%2Dleft%3A%2053%2E191489361702125%25%3B%0A%2Amargin%2Dleft%3A%2053%2E085106382978715%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2051%2E063829787234035%25%3B%0A%2Amargin%2Dleft%3A%2050%2E95744680851063%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%20%7B%0Amargin%2Dleft%3A%2044%2E68085106382979%25%3B%0A%2Amargin%2Dleft%3A%2044%2E57446808510638%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2042%2E5531914893617%25%3B%0A%2Amargin%2Dleft%3A%2042%2E4468085106383%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%20%7B%0Amargin%2Dleft%3A%2036%2E170212765957444%25%3B%0A%2Amargin%2Dleft%3A%2036%2E06382978723405%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2034%2E04255319148936%25%3B%0A%2Amargin%2Dleft%3A%2033%2E93617021276596%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%20%7B%0Amargin%2Dleft%3A%2027%2E659574468085104%25%3B%0A%2Amargin%2Dleft%3A%2027%2E5531914893617%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2025%2E53191489361702%25%3B%0A%2Amargin%2Dleft%3A%2025%2E425531914893618%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%20%7B%0Amargin%2Dleft%3A%2019%2E148936170212764%25%3B%0A%2Amargin%2Dleft%3A%2019%2E04255319148936%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2017%2E02127659574468%25%3B%0A%2Amargin%2Dleft%3A%2016%2E914893617021278%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%20%7B%0Amargin%2Dleft%3A%2010%2E638297872340425%25%3B%0A%2Amargin%2Dleft%3A%2010%2E53191489361702%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%208%2E51063829787234%25%3B%0A%2Amargin%2Dleft%3A%208%2E404255319148938%25%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%2Ehide%2C%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%2Ehide%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%2Epull%2Dright%2C%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%2Epull%2Dright%20%7B%0Afloat%3A%20right%3B%0A%7D%0A%2Econtainer%20%7B%0Amargin%2Dright%3A%20auto%3B%0Amargin%2Dleft%3A%20auto%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Econtainer%3Abefore%2C%0A%2Econtainer%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Econtainer%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Econtainer%2Dfluid%20%7B%0Apadding%2Dright%3A%2020px%3B%0Apadding%2Dleft%3A%2020px%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Econtainer%2Dfluid%3Abefore%2C%0A%2Econtainer%2Dfluid%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Econtainer%2Dfluid%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%200%2010px%3B%0A%7D%0A%2Elead%20%7B%0Amargin%2Dbottom%3A%2020px%3B%0Afont%2Dsize%3A%2021px%3B%0Afont%2Dweight%3A%20200%3B%0Aline%2Dheight%3A%2030px%3B%0A%7D%0Asmall%20%7B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aem%20%7B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0Acite%20%7B%0Afont%2Dstyle%3A%20normal%3B%0A%7D%0A%2Emuted%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0Aa%2Emuted%3Ahover%2C%0Aa%2Emuted%3Afocus%20%7B%0Acolor%3A%20%23808080%3B%0A%7D%0A%2Etext%2Dwarning%20%7B%0Acolor%3A%20%23c09853%3B%0A%7D%0Aa%2Etext%2Dwarning%3Ahover%2C%0Aa%2Etext%2Dwarning%3Afocus%20%7B%0Acolor%3A%20%23a47e3c%3B%0A%7D%0A%2Etext%2Derror%20%7B%0Acolor%3A%20%23b94a48%3B%0A%7D%0Aa%2Etext%2Derror%3Ahover%2C%0Aa%2Etext%2Derror%3Afocus%20%7B%0Acolor%3A%20%23953b39%3B%0A%7D%0A%2Etext%2Dinfo%20%7B%0Acolor%3A%20%233a87ad%3B%0A%7D%0Aa%2Etext%2Dinfo%3Ahover%2C%0Aa%2Etext%2Dinfo%3Afocus%20%7B%0Acolor%3A%20%232d6987%3B%0A%7D%0A%2Etext%2Dsuccess%20%7B%0Acolor%3A%20%23468847%3B%0A%7D%0Aa%2Etext%2Dsuccess%3Ahover%2C%0Aa%2Etext%2Dsuccess%3Afocus%20%7B%0Acolor%3A%20%23356635%3B%0A%7D%0A%2Etext%2Dleft%20%7B%0Atext%2Dalign%3A%20left%3B%0A%7D%0A%2Etext%2Dright%20%7B%0Atext%2Dalign%3A%20right%3B%0A%7D%0A%2Etext%2Dcenter%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%3A%2010px%200%3B%0Afont%2Dfamily%3A%20inherit%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%2020px%3B%0Acolor%3A%20inherit%3B%0Atext%2Drendering%3A%20optimizelegibility%3B%0A%7D%0Ah1%20small%2C%0Ah2%20small%2C%0Ah3%20small%2C%0Ah4%20small%2C%0Ah5%20small%2C%0Ah6%20small%20%7B%0Afont%2Dweight%3A%20normal%3B%0Aline%2Dheight%3A%201%3B%0Acolor%3A%20%23999999%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%20%7B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2038%2E5px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2031%2E5px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2024%2E5px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2017%2E5px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011%2E9px%3B%0A%7D%0Ah1%20small%20%7B%0Afont%2Dsize%3A%2024%2E5px%3B%0A%7D%0Ah2%20small%20%7B%0Afont%2Dsize%3A%2017%2E5px%3B%0A%7D%0Ah3%20small%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah4%20small%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0A%2Epage%2Dheader%20%7B%0Apadding%2Dbottom%3A%209px%3B%0Amargin%3A%2020px%200%2030px%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eeeeee%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%200%2010px%2025px%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%20%7B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0Aul%2Eunstyled%2C%0Aol%2Eunstyled%20%7B%0Amargin%2Dleft%3A%200%3B%0Alist%2Dstyle%3A%20none%3B%0A%7D%0Aul%2Einline%2C%0Aol%2Einline%20%7B%0Amargin%2Dleft%3A%200%3B%0Alist%2Dstyle%3A%20none%3B%0A%7D%0Aul%2Einline%20%3E%20li%2C%0Aol%2Einline%20%3E%20li%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%2Adisplay%3A%20inline%3B%0A%0A%2Azoom%3A%201%3B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0A%7D%0Adl%20%7B%0Amargin%2Dbottom%3A%2020px%3B%0A%7D%0Adt%2C%0Add%20%7B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0Adt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%2010px%3B%0A%7D%0A%2Edl%2Dhorizontal%20%7B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Edl%2Dhorizontal%3Abefore%2C%0A%2Edl%2Dhorizontal%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Edl%2Dhorizontal%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Edl%2Dhorizontal%20dt%20%7B%0Afloat%3A%20left%3B%0Awidth%3A%20160px%3B%0Aclear%3A%20left%3B%0Atext%2Dalign%3A%20right%3B%0Aoverflow%3A%20hidden%3B%0Atext%2Doverflow%3A%20ellipsis%3B%0Awhite%2Dspace%3A%20nowrap%3B%0A%7D%0A%2Edl%2Dhorizontal%20dd%20%7B%0Amargin%2Dleft%3A%20180px%3B%0A%7D%0Ahr%20%7B%0Amargin%3A%2020px%200%3B%0Aborder%3A%200%3B%0Aborder%2Dtop%3A%201px%20solid%20%23eeeeee%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ffffff%3B%0A%7D%0Aabbr%5Btitle%5D%2C%0Aabbr%5Bdata%2Doriginal%2Dtitle%5D%20%7B%0Acursor%3A%20help%3B%0Aborder%2Dbottom%3A%201px%20dotted%20%23999999%3B%0A%7D%0Aabbr%2Einitialism%20%7B%0Afont%2Dsize%3A%2090%25%3B%0Atext%2Dtransform%3A%20uppercase%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%200%200%2015px%3B%0Amargin%3A%200%200%2020px%3B%0Aborder%2Dleft%3A%205px%20solid%20%23eeeeee%3B%0A%7D%0Ablockquote%20p%20%7B%0Amargin%2Dbottom%3A%200%3B%0Afont%2Dsize%3A%2017%2E5px%3B%0Afont%2Dweight%3A%20300%3B%0Aline%2Dheight%3A%201%2E25%3B%0A%7D%0Ablockquote%20small%20%7B%0Adisplay%3A%20block%3B%0Aline%2Dheight%3A%2020px%3B%0Acolor%3A%20%23999999%3B%0A%7D%0Ablockquote%20small%3Abefore%20%7B%0Acontent%3A%20%27%5C2014%20%5C00A0%27%3B%0A%7D%0Ablockquote%2Epull%2Dright%20%7B%0Afloat%3A%20right%3B%0Apadding%2Dright%3A%2015px%3B%0Apadding%2Dleft%3A%200%3B%0Aborder%2Dright%3A%205px%20solid%20%23eeeeee%3B%0Aborder%2Dleft%3A%200%3B%0A%7D%0Ablockquote%2Epull%2Dright%20p%2C%0Ablockquote%2Epull%2Dright%20small%20%7B%0Atext%2Dalign%3A%20right%3B%0A%7D%0Ablockquote%2Epull%2Dright%20small%3Abefore%20%7B%0Acontent%3A%20%27%27%3B%0A%7D%0Ablockquote%2Epull%2Dright%20small%3Aafter%20%7B%0Acontent%3A%20%27%5C00A0%20%5C2014%27%3B%0A%7D%0Aq%3Abefore%2C%0Aq%3Aafter%2C%0Ablockquote%3Abefore%2C%0Ablockquote%3Aafter%20%7B%0Acontent%3A%20%22%22%3B%0A%7D%0Aaddress%20%7B%0Adisplay%3A%20block%3B%0Amargin%2Dbottom%3A%2020px%3B%0Afont%2Dstyle%3A%20normal%3B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0Acode%2C%0Apre%20%7B%0Apadding%3A%200%203px%202px%3B%0Afont%2Dfamily%3A%20Monaco%2C%20Menlo%2C%20Consolas%2C%20%22Courier%20New%22%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0Acolor%3A%20%23333333%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%203px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%203px%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%20%7B%0Apadding%3A%202px%204px%3B%0Acolor%3A%20%23d14%3B%0Abackground%2Dcolor%3A%20%23f7f7f9%3B%0Aborder%3A%201px%20solid%20%23e1e1e8%3B%0Awhite%2Dspace%3A%20nowrap%3B%0A%7D%0Apre%20%7B%0Adisplay%3A%20block%3B%0Apadding%3A%209%2E5px%3B%0Amargin%3A%200%200%2010px%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%2020px%3B%0Aword%2Dbreak%3A%20break%2Dall%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0Awhite%2Dspace%3A%20pre%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0Aborder%3A%201px%20solid%20%23ccc%3B%0Aborder%3A%201px%20solid%20rgba%280%2C%200%2C%200%2C%200%2E15%29%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%3B%0Aborder%2Dradius%3A%204px%3B%0A%7D%0Apre%2Eprettyprint%20%7B%0Amargin%2Dbottom%3A%2020px%3B%0A%7D%0Apre%20code%20%7B%0Apadding%3A%200%3B%0Acolor%3A%20inherit%3B%0Awhite%2Dspace%3A%20pre%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Epre%2Dscrollable%20%7B%0Amax%2Dheight%3A%20340px%3B%0Aoverflow%2Dy%3A%20scroll%3B%0A%7D%0Atable%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0A%2Etable%20%7B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2020px%3B%0A%7D%0A%2Etable%20th%2C%0A%2Etable%20td%20%7B%0Apadding%3A%208px%3B%0Aline%2Dheight%3A%2020px%3B%0Atext%2Dalign%3A%20left%3B%0Avertical%2Dalign%3A%20top%3B%0Aborder%2Dtop%3A%201px%20solid%20%23dddddd%3B%0A%7D%0A%2Etable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Etable%20thead%20th%20%7B%0Avertical%2Dalign%3A%20bottom%3B%0A%7D%0A%2Etable%20caption%20%2B%20thead%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%20caption%20%2B%20thead%20tr%3Afirst%2Dchild%20td%2C%0A%2Etable%20colgroup%20%2B%20thead%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%20colgroup%20%2B%20thead%20tr%3Afirst%2Dchild%20td%2C%0A%2Etable%20thead%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%20thead%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%200%3B%0A%7D%0A%2Etable%20tbody%20%2B%20tbody%20%7B%0Aborder%2Dtop%3A%202px%20solid%20%23dddddd%3B%0A%7D%0A%2Etable%20%2Etable%20%7B%0Abackground%2Dcolor%3A%20%23ffffff%3B%0A%7D%0A%2Etable%2Dcondensed%20th%2C%0A%2Etable%2Dcondensed%20td%20%7B%0Apadding%3A%204px%205px%3B%0A%7D%0A%2Etable%2Dbordered%20%7B%0Aborder%3A%201px%20solid%20%23dddddd%3B%0Aborder%2Dcollapse%3A%20separate%3B%0A%2Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dleft%3A%200%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%3B%0Aborder%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20th%2C%0A%2Etable%2Dbordered%20td%20%7B%0Aborder%2Dleft%3A%201px%20solid%20%23dddddd%3B%0A%7D%0A%2Etable%2Dbordered%20caption%20%2B%20thead%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20caption%20%2B%20tbody%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20caption%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20thead%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20tbody%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%2C%0A%2Etable%2Dbordered%20thead%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20th%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%200%3B%0A%7D%0A%2Etable%2Dbordered%20thead%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20th%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20td%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20th%3Afirst%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopleft%3A%204px%3B%0Aborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20thead%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20th%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20td%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Afirst%2Dchild%20tr%3Afirst%2Dchild%20%3E%20th%3Alast%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopright%3A%204px%3B%0Aborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20thead%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20td%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tfoot%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20td%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20tfoot%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Afirst%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dbottom%2Dleft%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomleft%3A%204px%3B%0Aborder%2Dbottom%2Dleft%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20thead%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20td%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tfoot%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20td%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20tfoot%3Alast%2Dchild%20tr%3Alast%2Dchild%20%3E%20th%3Alast%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dbottom%2Dright%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomright%3A%204px%3B%0Aborder%2Dbottom%2Dright%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20tfoot%20%2B%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20td%3Afirst%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dbottom%2Dleft%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomleft%3A%200%3B%0Aborder%2Dbottom%2Dleft%2Dradius%3A%200%3B%0A%7D%0A%2Etable%2Dbordered%20tfoot%20%2B%20tbody%3Alast%2Dchild%20tr%3Alast%2Dchild%20td%3Alast%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dbottom%2Dright%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomright%3A%200%3B%0Aborder%2Dbottom%2Dright%2Dradius%3A%200%3B%0A%7D%0A%2Etable%2Dbordered%20caption%20%2B%20thead%20tr%3Afirst%2Dchild%20th%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20caption%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20thead%20tr%3Afirst%2Dchild%20th%3Afirst%2Dchild%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%3Afirst%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopleft%3A%204px%3B%0Aborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dbordered%20caption%20%2B%20thead%20tr%3Afirst%2Dchild%20th%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20caption%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20thead%20tr%3Afirst%2Dchild%20th%3Alast%2Dchild%2C%0A%2Etable%2Dbordered%20colgroup%20%2B%20tbody%20tr%3Afirst%2Dchild%20td%3Alast%2Dchild%20%7B%0A%2Dwebkit%2Dborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopright%3A%204px%3B%0Aborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%7D%0A%2Etable%2Dstriped%20tbody%20%3E%20tr%3Anth%2Dchild%28odd%29%20%3E%20td%2C%0A%2Etable%2Dstriped%20tbody%20%3E%20tr%3Anth%2Dchild%28odd%29%20%3E%20th%20%7B%0Abackground%2Dcolor%3A%20%23f9f9f9%3B%0A%7D%0A%2Etable%2Dhover%20tbody%20tr%3Ahover%20%3E%20td%2C%0A%2Etable%2Dhover%20tbody%20tr%3Ahover%20%3E%20th%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0Atable%20td%5Bclass%2A%3D%22span%22%5D%2C%0Atable%20th%5Bclass%2A%3D%22span%22%5D%2C%0A%2Erow%2Dfluid%20table%20td%5Bclass%2A%3D%22span%22%5D%2C%0A%2Erow%2Dfluid%20table%20th%5Bclass%2A%3D%22span%22%5D%20%7B%0Adisplay%3A%20table%2Dcell%3B%0Afloat%3A%20none%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan1%2C%0A%2Etable%20th%2Espan1%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%2044px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan2%2C%0A%2Etable%20th%2Espan2%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20124px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan3%2C%0A%2Etable%20th%2Espan3%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20204px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan4%2C%0A%2Etable%20th%2Espan4%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20284px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan5%2C%0A%2Etable%20th%2Espan5%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20364px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan6%2C%0A%2Etable%20th%2Espan6%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20444px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan7%2C%0A%2Etable%20th%2Espan7%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20524px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan8%2C%0A%2Etable%20th%2Espan8%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20604px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan9%2C%0A%2Etable%20th%2Espan9%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20684px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan10%2C%0A%2Etable%20th%2Espan10%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20764px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan11%2C%0A%2Etable%20th%2Espan11%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20844px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20td%2Espan12%2C%0A%2Etable%20th%2Espan12%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20924px%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Etable%20tbody%20tr%2Esuccess%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23dff0d8%3B%0A%7D%0A%2Etable%20tbody%20tr%2Eerror%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23f2dede%3B%0A%7D%0A%2Etable%20tbody%20tr%2Ewarning%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23fcf8e3%3B%0A%7D%0A%2Etable%20tbody%20tr%2Einfo%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23d9edf7%3B%0A%7D%0A%2Etable%2Dhover%20tbody%20tr%2Esuccess%3Ahover%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23d0e9c6%3B%0A%7D%0A%2Etable%2Dhover%20tbody%20tr%2Eerror%3Ahover%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23ebcccc%3B%0A%7D%0A%2Etable%2Dhover%20tbody%20tr%2Ewarning%3Ahover%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23faf2cc%3B%0A%7D%0A%2Etable%2Dhover%20tbody%20tr%2Einfo%3Ahover%20%3E%20td%20%7B%0Abackground%2Dcolor%3A%20%23c4e3f3%3B%0A%7D%0A%2Enav%20%7B%0Amargin%2Dleft%3A%200%3B%0Amargin%2Dbottom%3A%2020px%3B%0Alist%2Dstyle%3A%20none%3B%0A%7D%0A%2Enav%20%3E%20li%20%3E%20a%20%7B%0Adisplay%3A%20block%3B%0A%7D%0A%2Enav%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enav%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Atext%2Ddecoration%3A%20none%3B%0Abackground%2Dcolor%3A%20%23eeeeee%3B%0A%7D%0A%2Enav%20%3E%20li%20%3E%20a%20%3E%20img%20%7B%0Amax%2Dwidth%3A%20none%3B%0A%7D%0A%2Enav%20%3E%20%2Epull%2Dright%20%7B%0Afloat%3A%20right%3B%0A%7D%0A%2Enav%2Dheader%20%7B%0Adisplay%3A%20block%3B%0Apadding%3A%203px%2015px%3B%0Afont%2Dsize%3A%2011px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%2020px%3B%0Acolor%3A%20%23999999%3B%0Atext%2Dshadow%3A%200%201px%200%20rgba%28255%2C%20255%2C%20255%2C%200%2E5%29%3B%0Atext%2Dtransform%3A%20uppercase%3B%0A%7D%0A%2Enav%20li%20%2B%20%2Enav%2Dheader%20%7B%0Amargin%2Dtop%3A%209px%3B%0A%7D%0A%2Enav%2Dlist%20%7B%0Apadding%2Dleft%3A%2015px%3B%0Apadding%2Dright%3A%2015px%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Enav%2Dlist%20%3E%20li%20%3E%20a%2C%0A%2Enav%2Dlist%20%2Enav%2Dheader%20%7B%0Amargin%2Dleft%3A%20%2D15px%3B%0Amargin%2Dright%3A%20%2D15px%3B%0Atext%2Dshadow%3A%200%201px%200%20rgba%28255%2C%20255%2C%20255%2C%200%2E5%29%3B%0A%7D%0A%2Enav%2Dlist%20%3E%20li%20%3E%20a%20%7B%0Apadding%3A%203px%2015px%3B%0A%7D%0A%2Enav%2Dlist%20%3E%20%2Eactive%20%3E%20a%2C%0A%2Enav%2Dlist%20%3E%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enav%2Dlist%20%3E%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0Atext%2Dshadow%3A%200%20%2D1px%200%20rgba%280%2C%200%2C%200%2C%200%2E2%29%3B%0Abackground%2Dcolor%3A%20%230088cc%3B%0A%7D%0A%2Enav%2Dlist%20%5Bclass%5E%3D%22icon%2D%22%5D%2C%0A%2Enav%2Dlist%20%5Bclass%2A%3D%22%20icon%2D%22%5D%20%7B%0Amargin%2Dright%3A%202px%3B%0A%7D%0A%2Enav%2Dlist%20%2Edivider%20%7B%0A%2Awidth%3A%20100%25%3B%0Aheight%3A%201px%3B%0Amargin%3A%209px%201px%3B%0A%2Amargin%3A%20%2D5px%200%205px%3B%0Aoverflow%3A%20hidden%3B%0Abackground%2Dcolor%3A%20%23e5e5e5%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ffffff%3B%0A%7D%0A%2Enav%2Dtabs%2C%0A%2Enav%2Dpills%20%7B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Enav%2Dtabs%3Abefore%2C%0A%2Enav%2Dpills%3Abefore%2C%0A%2Enav%2Dtabs%3Aafter%2C%0A%2Enav%2Dpills%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Enav%2Dtabs%3Aafter%2C%0A%2Enav%2Dpills%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20li%2C%0A%2Enav%2Dpills%20%3E%20li%20%7B%0Afloat%3A%20left%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20li%20%3E%20a%2C%0A%2Enav%2Dpills%20%3E%20li%20%3E%20a%20%7B%0Apadding%2Dright%3A%2012px%3B%0Apadding%2Dleft%3A%2012px%3B%0Amargin%2Dright%3A%202px%3B%0Aline%2Dheight%3A%2014px%3B%0A%7D%0A%2Enav%2Dtabs%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20li%20%7B%0Amargin%2Dbottom%3A%20%2D1px%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20li%20%3E%20a%20%7B%0Apadding%2Dtop%3A%208px%3B%0Apadding%2Dbottom%3A%208px%3B%0Aline%2Dheight%3A%2020px%3B%0Aborder%3A%201px%20solid%20transparent%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%204px%200%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%204px%200%200%3B%0Aborder%2Dradius%3A%204px%204px%200%200%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23eeeeee%20%23eeeeee%20%23dddddd%3B%0A%7D%0A%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%2C%0A%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23555555%3B%0Abackground%2Dcolor%3A%20%23ffffff%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dbottom%2Dcolor%3A%20transparent%3B%0Acursor%3A%20default%3B%0A%7D%0A%2Enav%2Dpills%20%3E%20li%20%3E%20a%20%7B%0Apadding%2Dtop%3A%208px%3B%0Apadding%2Dbottom%3A%208px%3B%0Amargin%2Dtop%3A%202px%3B%0Amargin%2Dbottom%3A%202px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%205px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%205px%3B%0Aborder%2Dradius%3A%205px%3B%0A%7D%0A%2Enav%2Dpills%20%3E%20%2Eactive%20%3E%20a%2C%0A%2Enav%2Dpills%20%3E%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enav%2Dpills%20%3E%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%230088cc%3B%0A%7D%0A%2Enav%2Dstacked%20%3E%20li%20%7B%0Afloat%3A%20none%3B%0A%7D%0A%2Enav%2Dstacked%20%3E%20li%20%3E%20a%20%7B%0Amargin%2Dright%3A%200%3B%0A%7D%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%7B%0Aborder%2Dbottom%3A%200%3B%0A%7D%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%3E%20li%20%3E%20a%20%7B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%3B%0Aborder%2Dradius%3A%200%3B%0A%7D%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%3E%20li%3Afirst%2Dchild%20%3E%20a%20%7B%0A%2Dwebkit%2Dborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopright%3A%204px%3B%0Aborder%2Dtop%2Dright%2Dradius%3A%204px%3B%0A%2Dwebkit%2Dborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dtopleft%3A%204px%3B%0Aborder%2Dtop%2Dleft%2Dradius%3A%204px%3B%0A%7D%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%3E%20li%3Alast%2Dchild%20%3E%20a%20%7B%0A%2Dwebkit%2Dborder%2Dbottom%2Dright%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomright%3A%204px%3B%0Aborder%2Dbottom%2Dright%2Dradius%3A%204px%3B%0A%2Dwebkit%2Dborder%2Dbottom%2Dleft%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%2Dbottomleft%3A%204px%3B%0Aborder%2Dbottom%2Dleft%2Dradius%3A%204px%3B%0A%7D%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enav%2Dtabs%2Enav%2Dstacked%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23ddd%3B%0Az%2Dindex%3A%202%3B%0A%7D%0A%2Enav%2Dpills%2Enav%2Dstacked%20%3E%20li%20%3E%20a%20%7B%0Amargin%2Dbottom%3A%203px%3B%0A%7D%0A%2Enav%2Dpills%2Enav%2Dstacked%20%3E%20li%3Alast%2Dchild%20%3E%20a%20%7B%0Amargin%2Dbottom%3A%201px%3B%0A%7D%0A%2Enav%2Dtabs%20%2Edropdown%2Dmenu%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%200%206px%206px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%200%206px%206px%3B%0Aborder%2Dradius%3A%200%200%206px%206px%3B%0A%7D%0A%2Enav%2Dpills%20%2Edropdown%2Dmenu%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%206px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%206px%3B%0Aborder%2Dradius%3A%206px%3B%0A%7D%0A%2Enav%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%230088cc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%230088cc%3B%0Amargin%2Dtop%3A%206px%3B%0A%7D%0A%2Enav%20%2Edropdown%2Dtoggle%3Ahover%20%2Ecaret%2C%0A%2Enav%20%2Edropdown%2Dtoggle%3Afocus%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23005580%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23005580%3B%0A%7D%0A%0A%2Enav%2Dtabs%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Amargin%2Dtop%3A%208px%3B%0A%7D%0A%2Enav%20%2Eactive%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23fff%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23fff%3B%0A%7D%0A%2Enav%2Dtabs%20%2Eactive%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23555555%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23555555%3B%0A%7D%0A%2Enav%20%3E%20%2Edropdown%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enav%20%3E%20%2Edropdown%2Eactive%20%3E%20a%3Afocus%20%7B%0Acursor%3A%20pointer%3B%0A%7D%0A%2Enav%2Dtabs%20%2Eopen%20%2Edropdown%2Dtoggle%2C%0A%2Enav%2Dpills%20%2Eopen%20%2Edropdown%2Dtoggle%2C%0A%2Enav%20%3E%20li%2Edropdown%2Eopen%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enav%20%3E%20li%2Edropdown%2Eopen%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23999999%3B%0Aborder%2Dcolor%3A%20%23999999%3B%0A%7D%0A%2Enav%20li%2Edropdown%2Eopen%20%2Ecaret%2C%0A%2Enav%20li%2Edropdown%2Eopen%2Eactive%20%2Ecaret%2C%0A%2Enav%20li%2Edropdown%2Eopen%20a%3Ahover%20%2Ecaret%2C%0A%2Enav%20li%2Edropdown%2Eopen%20a%3Afocus%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23ffffff%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23ffffff%3B%0Aopacity%3A%201%3B%0Afilter%3A%20alpha%28opacity%3D100%29%3B%0A%7D%0A%2Etabs%2Dstacked%20%2Eopen%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dstacked%20%2Eopen%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23999999%3B%0A%7D%0A%2Etabbable%20%7B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Etabbable%3Abefore%2C%0A%2Etabbable%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Etabbable%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Etab%2Dcontent%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%2C%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%7B%0Aborder%2Dbottom%3A%200%3B%0A%7D%0A%2Etab%2Dcontent%20%3E%20%2Etab%2Dpane%2C%0A%2Epill%2Dcontent%20%3E%20%2Epill%2Dpane%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%2Etab%2Dcontent%20%3E%20%2Eactive%2C%0A%2Epill%2Dcontent%20%3E%20%2Eactive%20%7B%0Adisplay%3A%20block%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%7B%0Amargin%2Dtop%3A%20%2D1px%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%200%204px%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%200%204px%204px%3B%0Aborder%2Dradius%3A%200%200%204px%204px%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Aborder%2Dbottom%2Dcolor%3A%20transparent%3B%0Aborder%2Dtop%2Dcolor%3A%20%23ddd%3B%0A%7D%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%2C%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dbelow%20%3E%20%2Enav%2Dtabs%20%3E%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20transparent%20%23ddd%20%23ddd%20%23ddd%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%3E%20li%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%7B%0Afloat%3A%20none%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%20%7B%0Amin%2Dwidth%3A%2074px%3B%0Amargin%2Dright%3A%200%3B%0Amargin%2Dbottom%3A%203px%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%7B%0Afloat%3A%20left%3B%0Amargin%2Dright%3A%2019px%3B%0Aborder%2Dright%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%20%7B%0Amargin%2Dright%3A%20%2D1px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%200%200%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%200%200%204px%3B%0Aborder%2Dradius%3A%204px%200%200%204px%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23eeeeee%20%23dddddd%20%23eeeeee%20%23eeeeee%3B%0A%7D%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%2C%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dleft%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23ddd%20transparent%20%23ddd%20%23ddd%3B%0A%2Aborder%2Dright%2Dcolor%3A%20%23ffffff%3B%0A%7D%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%7B%0Afloat%3A%20right%3B%0Amargin%2Dleft%3A%2019px%3B%0Aborder%2Dleft%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%20%7B%0Amargin%2Dleft%3A%20%2D1px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%204px%204px%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%204px%204px%200%3B%0Aborder%2Dradius%3A%200%204px%204px%200%3B%0A%7D%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23eeeeee%20%23eeeeee%20%23eeeeee%20%23dddddd%3B%0A%7D%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Etabs%2Dright%20%3E%20%2Enav%2Dtabs%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Aborder%2Dcolor%3A%20%23ddd%20%23ddd%20%23ddd%20transparent%3B%0A%2Aborder%2Dleft%2Dcolor%3A%20%23ffffff%3B%0A%7D%0A%2Enav%20%3E%20%2Edisabled%20%3E%20a%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0A%2Enav%20%3E%20%2Edisabled%20%3E%20a%3Ahover%2C%0A%2Enav%20%3E%20%2Edisabled%20%3E%20a%3Afocus%20%7B%0Atext%2Ddecoration%3A%20none%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Acursor%3A%20default%3B%0A%7D%0A%2Enavbar%20%7B%0Aoverflow%3A%20visible%3B%0Amargin%2Dbottom%3A%2020px%3B%0A%2Aposition%3A%20relative%3B%0A%2Az%2Dindex%3A%202%3B%0A%7D%0A%2Enavbar%2Dinner%20%7B%0Amin%2Dheight%3A%2040px%3B%0Apadding%2Dleft%3A%2020px%3B%0Apadding%2Dright%3A%2020px%3B%0Abackground%2Dcolor%3A%20%23fafafa%3B%0Abackground%2Dimage%3A%20%2Dmoz%2Dlinear%2Dgradient%28top%2C%20%23ffffff%2C%20%23f2f2f2%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dgradient%28linear%2C%200%200%2C%200%20100%25%2C%20from%28%23ffffff%29%2C%20to%28%23f2f2f2%29%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dlinear%2Dgradient%28top%2C%20%23ffffff%2C%20%23f2f2f2%29%3B%0Abackground%2Dimage%3A%20%2Do%2Dlinear%2Dgradient%28top%2C%20%23ffffff%2C%20%23f2f2f2%29%3B%0Abackground%2Dimage%3A%20linear%2Dgradient%28to%20bottom%2C%20%23ffffff%2C%20%23f2f2f2%29%3B%0Abackground%2Drepeat%3A%20repeat%2Dx%3B%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28startColorstr%3D%27%23ffffffff%27%2C%20endColorstr%3D%27%23fff2f2f2%27%2C%20GradientType%3D0%29%3B%0Aborder%3A%201px%20solid%20%23d4d4d4%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%3B%0Aborder%2Dradius%3A%204px%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%201px%204px%20rgba%280%2C%200%2C%200%2C%200%2E065%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%201px%204px%20rgba%280%2C%200%2C%200%2C%200%2E065%29%3B%0Abox%2Dshadow%3A%200%201px%204px%20rgba%280%2C%200%2C%200%2C%200%2E065%29%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Enavbar%2Dinner%3Abefore%2C%0A%2Enavbar%2Dinner%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Enavbar%2Dinner%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Enavbar%20%2Econtainer%20%7B%0Awidth%3A%20auto%3B%0A%7D%0A%2Enav%2Dcollapse%2Ecollapse%20%7B%0Aheight%3A%20auto%3B%0Aoverflow%3A%20visible%3B%0A%7D%0A%2Enavbar%20%2Ebrand%20%7B%0Afloat%3A%20left%3B%0Adisplay%3A%20block%3B%0Apadding%3A%2010px%2020px%2010px%3B%0Amargin%2Dleft%3A%20%2D20px%3B%0Afont%2Dsize%3A%2020px%3B%0Afont%2Dweight%3A%20200%3B%0Acolor%3A%20%23777777%3B%0Atext%2Dshadow%3A%200%201px%200%20%23ffffff%3B%0A%7D%0A%2Enavbar%20%2Ebrand%3Ahover%2C%0A%2Enavbar%20%2Ebrand%3Afocus%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Enavbar%2Dtext%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aline%2Dheight%3A%2040px%3B%0Acolor%3A%20%23777777%3B%0A%7D%0A%2Enavbar%2Dlink%20%7B%0Acolor%3A%20%23777777%3B%0A%7D%0A%2Enavbar%2Dlink%3Ahover%2C%0A%2Enavbar%2Dlink%3Afocus%20%7B%0Acolor%3A%20%23333333%3B%0A%7D%0A%2Enavbar%20%2Edivider%2Dvertical%20%7B%0Aheight%3A%2040px%3B%0Amargin%3A%200%209px%3B%0Aborder%2Dleft%3A%201px%20solid%20%23f2f2f2%3B%0Aborder%2Dright%3A%201px%20solid%20%23ffffff%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2C%0A%2Enavbar%20%2Ebtn%2Dgroup%20%7B%0Amargin%2Dtop%3A%205px%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dgroup%20%2Ebtn%2C%0A%2Enavbar%20%2Einput%2Dprepend%20%2Ebtn%2C%0A%2Enavbar%20%2Einput%2Dappend%20%2Ebtn%2C%0A%2Enavbar%20%2Einput%2Dprepend%20%2Ebtn%2Dgroup%2C%0A%2Enavbar%20%2Einput%2Dappend%20%2Ebtn%2Dgroup%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0A%2Enavbar%2Dform%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Enavbar%2Dform%3Abefore%2C%0A%2Enavbar%2Dform%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Enavbar%2Dform%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Enavbar%2Dform%20input%2C%0A%2Enavbar%2Dform%20select%2C%0A%2Enavbar%2Dform%20%2Eradio%2C%0A%2Enavbar%2Dform%20%2Echeckbox%20%7B%0Amargin%2Dtop%3A%205px%3B%0A%7D%0A%2Enavbar%2Dform%20input%2C%0A%2Enavbar%2Dform%20select%2C%0A%2Enavbar%2Dform%20%2Ebtn%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Enavbar%2Dform%20input%5Btype%3D%22image%22%5D%2C%0A%2Enavbar%2Dform%20input%5Btype%3D%22checkbox%22%5D%2C%0A%2Enavbar%2Dform%20input%5Btype%3D%22radio%22%5D%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Enavbar%2Dform%20%2Einput%2Dappend%2C%0A%2Enavbar%2Dform%20%2Einput%2Dprepend%20%7B%0Amargin%2Dtop%3A%205px%3B%0Awhite%2Dspace%3A%20nowrap%3B%0A%7D%0A%2Enavbar%2Dform%20%2Einput%2Dappend%20input%2C%0A%2Enavbar%2Dform%20%2Einput%2Dprepend%20input%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0A%2Enavbar%2Dsearch%20%7B%0Aposition%3A%20relative%3B%0Afloat%3A%20left%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Enavbar%2Dsearch%20%2Esearch%2Dquery%20%7B%0Amargin%2Dbottom%3A%200%3B%0Apadding%3A%204px%2014px%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2013px%3B%0Afont%2Dweight%3A%20normal%3B%0Aline%2Dheight%3A%201%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%2015px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%2015px%3B%0Aborder%2Dradius%3A%2015px%3B%0A%7D%0A%2Enavbar%2Dstatic%2Dtop%20%7B%0Aposition%3A%20static%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Enavbar%2Dstatic%2Dtop%20%2Enavbar%2Dinner%20%7B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%3B%0Aborder%2Dradius%3A%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%7B%0Aposition%3A%20fixed%3B%0Aright%3A%200%3B%0Aleft%3A%200%3B%0Az%2Dindex%3A%201030%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%2Enavbar%2Dinner%2C%0A%2Enavbar%2Dstatic%2Dtop%20%2Enavbar%2Dinner%20%7B%0Aborder%2Dwidth%3A%200%200%201px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enavbar%2Dinner%20%7B%0Aborder%2Dwidth%3A%201px%200%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%2Enavbar%2Dinner%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enavbar%2Dinner%20%7B%0Apadding%2Dleft%3A%200%3B%0Apadding%2Dright%3A%200%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%3B%0Aborder%2Dradius%3A%200%3B%0A%7D%0A%2Enavbar%2Dstatic%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Econtainer%20%7B%0Awidth%3A%20940px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%7B%0Atop%3A%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%2Enavbar%2Dinner%2C%0A%2Enavbar%2Dstatic%2Dtop%20%2Enavbar%2Dinner%20%7B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%201px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%201px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0Abox%2Dshadow%3A%200%201px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%7B%0Abottom%3A%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enavbar%2Dinner%20%7B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%20%2D1px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%20%2D1px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0Abox%2Dshadow%3A%200%20%2D1px%2010px%20rgba%280%2C0%2C0%2C%2E1%29%3B%0A%7D%0A%2Enavbar%20%2Enav%20%7B%0Aposition%3A%20relative%3B%0Aleft%3A%200%3B%0Adisplay%3A%20block%3B%0Afloat%3A%20left%3B%0Amargin%3A%200%2010px%200%200%3B%0A%7D%0A%2Enavbar%20%2Enav%2Epull%2Dright%20%7B%0Afloat%3A%20right%3B%0Amargin%2Dright%3A%200%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20li%20%7B%0Afloat%3A%20left%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20a%20%7B%0Afloat%3A%20none%3B%0Apadding%3A%2010px%2015px%2010px%3B%0Acolor%3A%20%23777777%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Dshadow%3A%200%201px%200%20%23ffffff%3B%0A%7D%0A%2Enavbar%20%2Enav%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Amargin%2Dtop%3A%208px%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20a%3Afocus%2C%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20a%3Ahover%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0Acolor%3A%20%23333333%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20%2Eactive%20%3E%20a%2C%0A%2Enavbar%20%2Enav%20%3E%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enavbar%20%2Enav%20%3E%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23555555%3B%0Atext%2Ddecoration%3A%20none%3B%0Abackground%2Dcolor%3A%20%23e5e5e5%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20inset%200%203px%208px%20rgba%280%2C%200%2C%200%2C%200%2E125%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20inset%200%203px%208px%20rgba%280%2C%200%2C%200%2C%200%2E125%29%3B%0Abox%2Dshadow%3A%20inset%200%203px%208px%20rgba%280%2C%200%2C%200%2C%200%2E125%29%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dnavbar%20%7B%0Adisplay%3A%20none%3B%0Afloat%3A%20right%3B%0Apadding%3A%207px%2010px%3B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0Acolor%3A%20%23ffffff%3B%0Atext%2Dshadow%3A%200%20%2D1px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0Abackground%2Dcolor%3A%20%23ededed%3B%0Abackground%2Dimage%3A%20%2Dmoz%2Dlinear%2Dgradient%28top%2C%20%23f2f2f2%2C%20%23e5e5e5%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dgradient%28linear%2C%200%200%2C%200%20100%25%2C%20from%28%23f2f2f2%29%2C%20to%28%23e5e5e5%29%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dlinear%2Dgradient%28top%2C%20%23f2f2f2%2C%20%23e5e5e5%29%3B%0Abackground%2Dimage%3A%20%2Do%2Dlinear%2Dgradient%28top%2C%20%23f2f2f2%2C%20%23e5e5e5%29%3B%0Abackground%2Dimage%3A%20linear%2Dgradient%28to%20bottom%2C%20%23f2f2f2%2C%20%23e5e5e5%29%3B%0Abackground%2Drepeat%3A%20repeat%2Dx%3B%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28startColorstr%3D%27%23fff2f2f2%27%2C%20endColorstr%3D%27%23ffe5e5e5%27%2C%20GradientType%3D0%29%3B%0Aborder%2Dcolor%3A%20%23e5e5e5%20%23e5e5e5%20%23bfbfbf%3B%0Aborder%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E1%29%20rgba%280%2C%200%2C%200%2C%200%2E1%29%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0A%2Abackground%2Dcolor%3A%20%23e5e5e5%3B%0A%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28enabled%20%3D%20false%29%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E075%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E075%29%3B%0Abox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E075%29%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dnavbar%3Ahover%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%3Afocus%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%3Aactive%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%2Eactive%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%2Edisabled%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%5Bdisabled%5D%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23e5e5e5%3B%0A%2Abackground%2Dcolor%3A%20%23d9d9d9%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dnavbar%3Aactive%2C%0A%2Enavbar%20%2Ebtn%2Dnavbar%2Eactive%20%7B%0Abackground%2Dcolor%3A%20%23cccccc%20%5C9%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dnavbar%20%2Eicon%2Dbar%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%2018px%3B%0Aheight%3A%202px%3B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%201px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%201px%3B%0Aborder%2Dradius%3A%201px%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%201px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%201px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0Abox%2Dshadow%3A%200%201px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0A%7D%0A%2Ebtn%2Dnavbar%20%2Eicon%2Dbar%20%2B%20%2Eicon%2Dbar%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Abefore%20%7B%0Acontent%3A%20%27%27%3B%0Adisplay%3A%20inline%2Dblock%3B%0Aborder%2Dleft%3A%207px%20solid%20transparent%3B%0Aborder%2Dright%3A%207px%20solid%20transparent%3B%0Aborder%2Dbottom%3A%207px%20solid%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E2%29%3B%0Aposition%3A%20absolute%3B%0Atop%3A%20%2D7px%3B%0Aleft%3A%209px%3B%0A%7D%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Aafter%20%7B%0Acontent%3A%20%27%27%3B%0Adisplay%3A%20inline%2Dblock%3B%0Aborder%2Dleft%3A%206px%20solid%20transparent%3B%0Aborder%2Dright%3A%206px%20solid%20transparent%3B%0Aborder%2Dbottom%3A%206px%20solid%20%23ffffff%3B%0Aposition%3A%20absolute%3B%0Atop%3A%20%2D6px%3B%0Aleft%3A%2010px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Abefore%20%7B%0Aborder%2Dtop%3A%207px%20solid%20%23ccc%3B%0Aborder%2Dtop%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E2%29%3B%0Aborder%2Dbottom%3A%200%3B%0Abottom%3A%20%2D7px%3B%0Atop%3A%20auto%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Aafter%20%7B%0Aborder%2Dtop%3A%206px%20solid%20%23ffffff%3B%0Aborder%2Dbottom%3A%200%3B%0Abottom%3A%20%2D6px%3B%0Atop%3A%20auto%3B%0A%7D%0A%2Enavbar%20%2Enav%20li%2Edropdown%20%3E%20a%3Ahover%20%2Ecaret%2C%0A%2Enavbar%20%2Enav%20li%2Edropdown%20%3E%20a%3Afocus%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23333333%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23333333%3B%0A%7D%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eopen%20%3E%20%2Edropdown%2Dtoggle%2C%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eactive%20%3E%20%2Edropdown%2Dtoggle%2C%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eopen%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%7B%0Abackground%2Dcolor%3A%20%23e5e5e5%3B%0Acolor%3A%20%23555555%3B%0A%7D%0A%2Enavbar%20%2Enav%20li%2Edropdown%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23777777%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23777777%3B%0A%7D%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eopen%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%2C%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%2C%0A%2Enavbar%20%2Enav%20li%2Edropdown%2Eopen%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23555555%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23555555%3B%0A%7D%0A%2Enavbar%20%2Epull%2Dright%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%2C%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%2Epull%2Dright%20%7B%0Aleft%3A%20auto%3B%0Aright%3A%200%3B%0A%7D%0A%2Enavbar%20%2Epull%2Dright%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Abefore%2C%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%2Epull%2Dright%3Abefore%20%7B%0Aleft%3A%20auto%3B%0Aright%3A%2012px%3B%0A%7D%0A%2Enavbar%20%2Epull%2Dright%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Aafter%2C%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%2Epull%2Dright%3Aafter%20%7B%0Aleft%3A%20auto%3B%0Aright%3A%2013px%3B%0A%7D%0A%2Enavbar%20%2Epull%2Dright%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%20%2Edropdown%2Dmenu%2C%0A%2Enavbar%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%2Epull%2Dright%20%2Edropdown%2Dmenu%20%7B%0Aleft%3A%20auto%3B%0Aright%3A%20100%25%3B%0Amargin%2Dleft%3A%200%3B%0Amargin%2Dright%3A%20%2D1px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%206px%200%206px%206px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%206px%200%206px%206px%3B%0Aborder%2Dradius%3A%206px%200%206px%206px%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dinner%20%7B%0Abackground%2Dcolor%3A%20%231b1b1b%3B%0Abackground%2Dimage%3A%20%2Dmoz%2Dlinear%2Dgradient%28top%2C%20%23222222%2C%20%23111111%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dgradient%28linear%2C%200%200%2C%200%20100%25%2C%20from%28%23222222%29%2C%20to%28%23111111%29%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dlinear%2Dgradient%28top%2C%20%23222222%2C%20%23111111%29%3B%0Abackground%2Dimage%3A%20%2Do%2Dlinear%2Dgradient%28top%2C%20%23222222%2C%20%23111111%29%3B%0Abackground%2Dimage%3A%20linear%2Dgradient%28to%20bottom%2C%20%23222222%2C%20%23111111%29%3B%0Abackground%2Drepeat%3A%20repeat%2Dx%3B%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28startColorstr%3D%27%23ff222222%27%2C%20endColorstr%3D%27%23ff111111%27%2C%20GradientType%3D0%29%3B%0Aborder%2Dcolor%3A%20%23252525%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebrand%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%3E%20li%20%3E%20a%20%7B%0Acolor%3A%20%23999999%3B%0Atext%2Dshadow%3A%200%20%2D1px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebrand%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Ebrand%3Afocus%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%3E%20li%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebrand%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dtext%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20%3E%20li%20%3E%20a%3Afocus%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%3E%20li%20%3E%20a%3Ahover%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0Acolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20%2Eactive%20%3E%20a%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%2Eactive%20%3E%20a%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Enav%20%2Eactive%20%3E%20a%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23111111%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dlink%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dlink%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dlink%3Afocus%20%7B%0Acolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Edivider%2Dvertical%20%7B%0Aborder%2Dleft%2Dcolor%3A%20%23111111%3B%0Aborder%2Dright%2Dcolor%3A%20%23222222%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eopen%20%3E%20%2Edropdown%2Dtoggle%2C%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eactive%20%3E%20%2Edropdown%2Dtoggle%2C%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eopen%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%7B%0Abackground%2Dcolor%3A%20%23111111%3B%0Acolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%20%3E%20a%3Ahover%20%2Ecaret%2C%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%20%3E%20a%3Afocus%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23ffffff%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23999999%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23999999%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eopen%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%2C%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%2C%0A%2Enavbar%2Dinverse%20%2Enav%20li%2Edropdown%2Eopen%2Eactive%20%3E%20%2Edropdown%2Dtoggle%20%2Ecaret%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23ffffff%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23ffffff%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23515151%3B%0Aborder%2Dcolor%3A%20%23111111%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20inset%200%201px%202px%20rgba%280%2C0%2C0%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E15%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20inset%200%201px%202px%20rgba%280%2C0%2C0%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E15%29%3B%0Abox%2Dshadow%3A%20inset%200%201px%202px%20rgba%280%2C0%2C0%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E15%29%3B%0A%2Dwebkit%2Dtransition%3A%20none%3B%0A%2Dmoz%2Dtransition%3A%20none%3B%0A%2Do%2Dtransition%3A%20none%3B%0Atransition%3A%20none%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%3A%2Dmoz%2Dplaceholder%20%7B%0Acolor%3A%20%23cccccc%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%3A%2Dms%2Dinput%2Dplaceholder%20%7B%0Acolor%3A%20%23cccccc%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%3A%3A%2Dwebkit%2Dinput%2Dplaceholder%20%7B%0Acolor%3A%20%23cccccc%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%3Afocus%2C%0A%2Enavbar%2Dinverse%20%2Enavbar%2Dsearch%20%2Esearch%2Dquery%2Efocused%20%7B%0Apadding%3A%205px%2015px%3B%0Acolor%3A%20%23333333%3B%0Atext%2Dshadow%3A%200%201px%200%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23ffffff%3B%0Aborder%3A%200%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%200%203px%20rgba%280%2C%200%2C%200%2C%200%2E15%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%200%203px%20rgba%280%2C%200%2C%200%2C%200%2E15%29%3B%0Abox%2Dshadow%3A%200%200%203px%20rgba%280%2C%200%2C%200%2C%200%2E15%29%3B%0Aoutline%3A%200%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%20%7B%0Acolor%3A%20%23ffffff%3B%0Atext%2Dshadow%3A%200%20%2D1px%200%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0Abackground%2Dcolor%3A%20%230e0e0e%3B%0Abackground%2Dimage%3A%20%2Dmoz%2Dlinear%2Dgradient%28top%2C%20%23151515%2C%20%23040404%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dgradient%28linear%2C%200%200%2C%200%20100%25%2C%20from%28%23151515%29%2C%20to%28%23040404%29%29%3B%0Abackground%2Dimage%3A%20%2Dwebkit%2Dlinear%2Dgradient%28top%2C%20%23151515%2C%20%23040404%29%3B%0Abackground%2Dimage%3A%20%2Do%2Dlinear%2Dgradient%28top%2C%20%23151515%2C%20%23040404%29%3B%0Abackground%2Dimage%3A%20linear%2Dgradient%28to%20bottom%2C%20%23151515%2C%20%23040404%29%3B%0Abackground%2Drepeat%3A%20repeat%2Dx%3B%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28startColorstr%3D%27%23ff151515%27%2C%20endColorstr%3D%27%23ff040404%27%2C%20GradientType%3D0%29%3B%0Aborder%2Dcolor%3A%20%23040404%20%23040404%20%23000000%3B%0Aborder%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E1%29%20rgba%280%2C%200%2C%200%2C%200%2E1%29%20rgba%280%2C%200%2C%200%2C%200%2E25%29%3B%0A%2Abackground%2Dcolor%3A%20%23040404%3B%0A%0Afilter%3A%20progid%3ADXImageTransform%2EMicrosoft%2Egradient%28enabled%20%3D%20false%29%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%3Afocus%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%3Aactive%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%2Eactive%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%2Edisabled%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%5Bdisabled%5D%20%7B%0Acolor%3A%20%23ffffff%3B%0Abackground%2Dcolor%3A%20%23040404%3B%0A%2Abackground%2Dcolor%3A%20%23000000%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%3Aactive%2C%0A%2Enavbar%2Dinverse%20%2Ebtn%2Dnavbar%2Eactive%20%7B%0Abackground%2Dcolor%3A%20%23000000%20%5C9%3B%0A%7D%0A%2Ewell%20%7B%0Amin%2Dheight%3A%2020px%3B%0Apadding%3A%2019px%3B%0Amargin%2Dbottom%3A%2020px%3B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0Aborder%3A%201px%20solid%20%23e3e3e3%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%3B%0Aborder%2Dradius%3A%204px%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20inset%200%201px%201px%20rgba%280%2C%200%2C%200%2C%200%2E05%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20inset%200%201px%201px%20rgba%280%2C%200%2C%200%2C%200%2E05%29%3B%0Abox%2Dshadow%3A%20inset%200%201px%201px%20rgba%280%2C%200%2C%200%2C%200%2E05%29%3B%0A%7D%0A%2Ewell%20blockquote%20%7B%0Aborder%2Dcolor%3A%20%23ddd%3B%0Aborder%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E15%29%3B%0A%7D%0A%2Ewell%2Dlarge%20%7B%0Apadding%3A%2024px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%206px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%206px%3B%0Aborder%2Dradius%3A%206px%3B%0A%7D%0A%2Ewell%2Dsmall%20%7B%0Apadding%3A%209px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%203px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%203px%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%40%2Dms%2Dviewport%20%7B%0Awidth%3A%20device%2Dwidth%3B%0A%7D%0A%2Ehidden%20%7B%0Adisplay%3A%20none%3B%0Avisibility%3A%20hidden%3B%0A%7D%0A%2Evisible%2Dphone%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%2Evisible%2Dtablet%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%2Ehidden%2Ddesktop%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%2Evisible%2Ddesktop%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%40media%20%28min%2Dwidth%3A%20768px%29%20and%20%28max%2Dwidth%3A%20979px%29%20%7B%0A%2Ehidden%2Ddesktop%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%2Evisible%2Ddesktop%20%7B%0Adisplay%3A%20none%20%21important%20%3B%0A%7D%0A%2Evisible%2Dtablet%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%2Ehidden%2Dtablet%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%7D%0A%40media%20%28max%2Dwidth%3A%20767px%29%20%7B%0A%2Ehidden%2Ddesktop%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%2Evisible%2Ddesktop%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%2Evisible%2Dphone%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%2Ehidden%2Dphone%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%7D%0A%2Evisible%2Dprint%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%40media%20print%20%7B%0A%2Evisible%2Dprint%20%7B%0Adisplay%3A%20inherit%20%21important%3B%0A%7D%0A%2Ehidden%2Dprint%20%7B%0Adisplay%3A%20none%20%21important%3B%0A%7D%0A%7D%0A%40media%20%28max%2Dwidth%3A%20767px%29%20%7B%0Abody%20%7B%0Apadding%2Dleft%3A%2020px%3B%0Apadding%2Dright%3A%2020px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%2C%0A%2Enavbar%2Dfixed%2Dbottom%2C%0A%2Enavbar%2Dstatic%2Dtop%20%7B%0Amargin%2Dleft%3A%20%2D20px%3B%0Amargin%2Dright%3A%20%2D20px%3B%0A%7D%0A%2Econtainer%2Dfluid%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2Edl%2Dhorizontal%20dt%20%7B%0Afloat%3A%20none%3B%0Aclear%3A%20none%3B%0Awidth%3A%20auto%3B%0Atext%2Dalign%3A%20left%3B%0A%7D%0A%2Edl%2Dhorizontal%20dd%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Econtainer%20%7B%0Awidth%3A%20auto%3B%0A%7D%0A%2Erow%2Dfluid%20%7B%0Awidth%3A%20100%25%3B%0A%7D%0A%2Erow%2C%0A%2Ethumbnails%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Ethumbnails%20%3E%20li%20%7B%0Afloat%3A%20none%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%2C%0A%2Euneditable%2Dinput%5Bclass%2A%3D%22span%22%5D%2C%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Afloat%3A%20none%3B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dleft%3A%200%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0A%2Espan12%2C%0A%2Erow%2Dfluid%20%2Espan12%20%7B%0Awidth%3A%20100%25%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22offset%22%5D%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Einput%2Dlarge%2C%0A%2Einput%2Dxlarge%2C%0A%2Einput%2Dxxlarge%2C%0Ainput%5Bclass%2A%3D%22span%22%5D%2C%0Aselect%5Bclass%2A%3D%22span%22%5D%2C%0Atextarea%5Bclass%2A%3D%22span%22%5D%2C%0A%2Euneditable%2Dinput%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amin%2Dheight%3A%2030px%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0A%2Einput%2Dprepend%20input%2C%0A%2Einput%2Dappend%20input%2C%0A%2Einput%2Dprepend%20input%5Bclass%2A%3D%22span%22%5D%2C%0A%2Einput%2Dappend%20input%5Bclass%2A%3D%22span%22%5D%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Awidth%3A%20auto%3B%0A%7D%0A%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Emodal%20%7B%0Aposition%3A%20fixed%3B%0Atop%3A%2020px%3B%0Aleft%3A%2020px%3B%0Aright%3A%2020px%3B%0Awidth%3A%20auto%3B%0Amargin%3A%200%3B%0A%7D%0A%2Emodal%2Efade%20%7B%0Atop%3A%20%2D100px%3B%0A%7D%0A%2Emodal%2Efade%2Ein%20%7B%0Atop%3A%2020px%3B%0A%7D%0A%7D%0A%40media%20%28max%2Dwidth%3A%20480px%29%20%7B%0A%2Enav%2Dcollapse%20%7B%0A%2Dwebkit%2Dtransform%3A%20translate3d%280%2C%200%2C%200%29%3B%0A%7D%0A%2Epage%2Dheader%20h1%20small%20%7B%0Adisplay%3A%20block%3B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%2C%0Ainput%5Btype%3D%22radio%22%5D%20%7B%0Aborder%3A%201px%20solid%20%23ccc%3B%0A%7D%0A%2Eform%2Dhorizontal%20%2Econtrol%2Dlabel%20%7B%0Afloat%3A%20none%3B%0Awidth%3A%20auto%3B%0Apadding%2Dtop%3A%200%3B%0Atext%2Dalign%3A%20left%3B%0A%7D%0A%2Eform%2Dhorizontal%20%2Econtrols%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Eform%2Dhorizontal%20%2Econtrol%2Dlist%20%7B%0Apadding%2Dtop%3A%200%3B%0A%7D%0A%2Eform%2Dhorizontal%20%2Eform%2Dactions%20%7B%0Apadding%2Dleft%3A%2010px%3B%0Apadding%2Dright%3A%2010px%3B%0A%7D%0A%2Emedia%20%2Epull%2Dleft%2C%0A%2Emedia%20%2Epull%2Dright%20%7B%0Afloat%3A%20none%3B%0Adisplay%3A%20block%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Emedia%2Dobject%20%7B%0Amargin%2Dright%3A%200%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Emodal%20%7B%0Atop%3A%2010px%3B%0Aleft%3A%2010px%3B%0Aright%3A%2010px%3B%0A%7D%0A%2Emodal%2Dheader%20%2Eclose%20%7B%0Apadding%3A%2010px%3B%0Amargin%3A%20%2D10px%3B%0A%7D%0A%2Ecarousel%2Dcaption%20%7B%0Aposition%3A%20static%3B%0A%7D%0A%7D%0A%40media%20%28min%2Dwidth%3A%20768px%29%20and%20%28max%2Dwidth%3A%20979px%29%20%7B%0A%2Erow%20%7B%0Amargin%2Dleft%3A%20%2D20px%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%3Abefore%2C%0A%2Erow%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%20%7B%0Afloat%3A%20left%3B%0Amin%2Dheight%3A%201px%3B%0Amargin%2Dleft%3A%2020px%3B%0A%7D%0A%2Econtainer%2C%0A%2Enavbar%2Dstatic%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Econtainer%20%7B%0Awidth%3A%20724px%3B%0A%7D%0A%2Espan12%20%7B%0Awidth%3A%20724px%3B%0A%7D%0A%2Espan11%20%7B%0Awidth%3A%20662px%3B%0A%7D%0A%2Espan10%20%7B%0Awidth%3A%20600px%3B%0A%7D%0A%2Espan9%20%7B%0Awidth%3A%20538px%3B%0A%7D%0A%2Espan8%20%7B%0Awidth%3A%20476px%3B%0A%7D%0A%2Espan7%20%7B%0Awidth%3A%20414px%3B%0A%7D%0A%2Espan6%20%7B%0Awidth%3A%20352px%3B%0A%7D%0A%2Espan5%20%7B%0Awidth%3A%20290px%3B%0A%7D%0A%2Espan4%20%7B%0Awidth%3A%20228px%3B%0A%7D%0A%2Espan3%20%7B%0Awidth%3A%20166px%3B%0A%7D%0A%2Espan2%20%7B%0Awidth%3A%20104px%3B%0A%7D%0A%2Espan1%20%7B%0Awidth%3A%2042px%3B%0A%7D%0A%2Eoffset12%20%7B%0Amargin%2Dleft%3A%20764px%3B%0A%7D%0A%2Eoffset11%20%7B%0Amargin%2Dleft%3A%20702px%3B%0A%7D%0A%2Eoffset10%20%7B%0Amargin%2Dleft%3A%20640px%3B%0A%7D%0A%2Eoffset9%20%7B%0Amargin%2Dleft%3A%20578px%3B%0A%7D%0A%2Eoffset8%20%7B%0Amargin%2Dleft%3A%20516px%3B%0A%7D%0A%2Eoffset7%20%7B%0Amargin%2Dleft%3A%20454px%3B%0A%7D%0A%2Eoffset6%20%7B%0Amargin%2Dleft%3A%20392px%3B%0A%7D%0A%2Eoffset5%20%7B%0Amargin%2Dleft%3A%20330px%3B%0A%7D%0A%2Eoffset4%20%7B%0Amargin%2Dleft%3A%20268px%3B%0A%7D%0A%2Eoffset3%20%7B%0Amargin%2Dleft%3A%20206px%3B%0A%7D%0A%2Eoffset2%20%7B%0Amargin%2Dleft%3A%20144px%3B%0A%7D%0A%2Eoffset1%20%7B%0Amargin%2Dleft%3A%2082px%3B%0A%7D%0A%2Erow%2Dfluid%20%7B%0Awidth%3A%20100%25%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%2Dfluid%3Abefore%2C%0A%2Erow%2Dfluid%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amin%2Dheight%3A%2030px%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Afloat%3A%20left%3B%0Amargin%2Dleft%3A%202%2E7624309392265194%25%3B%0A%2Amargin%2Dleft%3A%202%2E709239449864817%25%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%20%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%202%2E7624309392265194%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan12%20%7B%0Awidth%3A%20100%25%3B%0A%2Awidth%3A%2099%2E94680851063829%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan11%20%7B%0Awidth%3A%2091%2E43646408839778%25%3B%0A%2Awidth%3A%2091%2E38327259903608%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan10%20%7B%0Awidth%3A%2082%2E87292817679558%25%3B%0A%2Awidth%3A%2082%2E81973668743387%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan9%20%7B%0Awidth%3A%2074%2E30939226519337%25%3B%0A%2Awidth%3A%2074%2E25620077583166%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan8%20%7B%0Awidth%3A%2065%2E74585635359117%25%3B%0A%2Awidth%3A%2065%2E69266486422946%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan7%20%7B%0Awidth%3A%2057%2E18232044198895%25%3B%0A%2Awidth%3A%2057%2E12912895262725%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan6%20%7B%0Awidth%3A%2048%2E61878453038674%25%3B%0A%2Awidth%3A%2048%2E56559304102504%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan5%20%7B%0Awidth%3A%2040%2E05524861878453%25%3B%0A%2Awidth%3A%2040%2E00205712942283%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan4%20%7B%0Awidth%3A%2031%2E491712707182323%25%3B%0A%2Awidth%3A%2031%2E43852121782062%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan3%20%7B%0Awidth%3A%2022%2E92817679558011%25%3B%0A%2Awidth%3A%2022%2E87498530621841%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan2%20%7B%0Awidth%3A%2014%2E3646408839779%25%3B%0A%2Awidth%3A%2014%2E311449394616199%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan1%20%7B%0Awidth%3A%205%2E801104972375691%25%3B%0A%2Awidth%3A%205%2E747913483013988%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%20%7B%0Amargin%2Dleft%3A%20105%2E52486187845304%25%3B%0A%2Amargin%2Dleft%3A%20105%2E41847889972962%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%20102%2E76243093922652%25%3B%0A%2Amargin%2Dleft%3A%20102%2E6560479605031%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%20%7B%0Amargin%2Dleft%3A%2096%2E96132596685082%25%3B%0A%2Amargin%2Dleft%3A%2096%2E8549429881274%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2094%2E1988950276243%25%3B%0A%2Amargin%2Dleft%3A%2094%2E09251204890089%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%20%7B%0Amargin%2Dleft%3A%2088%2E39779005524862%25%3B%0A%2Amargin%2Dleft%3A%2088%2E2914070765252%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2085%2E6353591160221%25%3B%0A%2Amargin%2Dleft%3A%2085%2E52897613729868%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%20%7B%0Amargin%2Dleft%3A%2079%2E8342541436464%25%3B%0A%2Amargin%2Dleft%3A%2079%2E72787116492299%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2077%2E07182320441989%25%3B%0A%2Amargin%2Dleft%3A%2076%2E96544022569647%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%20%7B%0Amargin%2Dleft%3A%2071%2E2707182320442%25%3B%0A%2Amargin%2Dleft%3A%2071%2E16433525332079%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2068%2E50828729281768%25%3B%0A%2Amargin%2Dleft%3A%2068%2E40190431409427%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%20%7B%0Amargin%2Dleft%3A%2062%2E70718232044199%25%3B%0A%2Amargin%2Dleft%3A%2062%2E600799341718584%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2059%2E94475138121547%25%3B%0A%2Amargin%2Dleft%3A%2059%2E838368402492065%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%20%7B%0Amargin%2Dleft%3A%2054%2E14364640883978%25%3B%0A%2Amargin%2Dleft%3A%2054%2E037263430116376%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2051%2E38121546961326%25%3B%0A%2Amargin%2Dleft%3A%2051%2E27483249088986%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%20%7B%0Amargin%2Dleft%3A%2045%2E58011049723757%25%3B%0A%2Amargin%2Dleft%3A%2045%2E47372751851417%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2042%2E81767955801105%25%3B%0A%2Amargin%2Dleft%3A%2042%2E71129657928765%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%20%7B%0Amargin%2Dleft%3A%2037%2E01657458563536%25%3B%0A%2Amargin%2Dleft%3A%2036%2E91019160691196%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2034%2E25414364640884%25%3B%0A%2Amargin%2Dleft%3A%2034%2E14776066768544%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%20%7B%0Amargin%2Dleft%3A%2028%2E45303867403315%25%3B%0A%2Amargin%2Dleft%3A%2028%2E346655695309746%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2025%2E69060773480663%25%3B%0A%2Amargin%2Dleft%3A%2025%2E584224756083227%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%20%7B%0Amargin%2Dleft%3A%2019%2E88950276243094%25%3B%0A%2Amargin%2Dleft%3A%2019%2E783119783707537%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2017%2E12707182320442%25%3B%0A%2Amargin%2Dleft%3A%2017%2E02068884448102%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%20%7B%0Amargin%2Dleft%3A%2011%2E32596685082873%25%3B%0A%2Amargin%2Dleft%3A%2011%2E219583872105325%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%208%2E56353591160221%25%3B%0A%2Amargin%2Dleft%3A%208%2E457152932878806%25%3B%0A%7D%0Ainput%2C%0Atextarea%2C%0A%2Euneditable%2Dinput%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%2020px%3B%0A%7D%0Ainput%2Espan12%2C%0Atextarea%2Espan12%2C%0A%2Euneditable%2Dinput%2Espan12%20%7B%0Awidth%3A%20710px%3B%0A%7D%0Ainput%2Espan11%2C%0Atextarea%2Espan11%2C%0A%2Euneditable%2Dinput%2Espan11%20%7B%0Awidth%3A%20648px%3B%0A%7D%0Ainput%2Espan10%2C%0Atextarea%2Espan10%2C%0A%2Euneditable%2Dinput%2Espan10%20%7B%0Awidth%3A%20586px%3B%0A%7D%0Ainput%2Espan9%2C%0Atextarea%2Espan9%2C%0A%2Euneditable%2Dinput%2Espan9%20%7B%0Awidth%3A%20524px%3B%0A%7D%0Ainput%2Espan8%2C%0Atextarea%2Espan8%2C%0A%2Euneditable%2Dinput%2Espan8%20%7B%0Awidth%3A%20462px%3B%0A%7D%0Ainput%2Espan7%2C%0Atextarea%2Espan7%2C%0A%2Euneditable%2Dinput%2Espan7%20%7B%0Awidth%3A%20400px%3B%0A%7D%0Ainput%2Espan6%2C%0Atextarea%2Espan6%2C%0A%2Euneditable%2Dinput%2Espan6%20%7B%0Awidth%3A%20338px%3B%0A%7D%0Ainput%2Espan5%2C%0Atextarea%2Espan5%2C%0A%2Euneditable%2Dinput%2Espan5%20%7B%0Awidth%3A%20276px%3B%0A%7D%0Ainput%2Espan4%2C%0Atextarea%2Espan4%2C%0A%2Euneditable%2Dinput%2Espan4%20%7B%0Awidth%3A%20214px%3B%0A%7D%0Ainput%2Espan3%2C%0Atextarea%2Espan3%2C%0A%2Euneditable%2Dinput%2Espan3%20%7B%0Awidth%3A%20152px%3B%0A%7D%0Ainput%2Espan2%2C%0Atextarea%2Espan2%2C%0A%2Euneditable%2Dinput%2Espan2%20%7B%0Awidth%3A%2090px%3B%0A%7D%0Ainput%2Espan1%2C%0Atextarea%2Espan1%2C%0A%2Euneditable%2Dinput%2Espan1%20%7B%0Awidth%3A%2028px%3B%0A%7D%0A%7D%0A%40media%20%28min%2Dwidth%3A%201200px%29%20%7B%0A%2Erow%20%7B%0Amargin%2Dleft%3A%20%2D30px%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%3Abefore%2C%0A%2Erow%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%5Bclass%2A%3D%22span%22%5D%20%7B%0Afloat%3A%20left%3B%0Amin%2Dheight%3A%201px%3B%0Amargin%2Dleft%3A%2030px%3B%0A%7D%0A%2Econtainer%2C%0A%2Enavbar%2Dstatic%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dtop%20%2Econtainer%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Econtainer%20%7B%0Awidth%3A%201170px%3B%0A%7D%0A%2Espan12%20%7B%0Awidth%3A%201170px%3B%0A%7D%0A%2Espan11%20%7B%0Awidth%3A%201070px%3B%0A%7D%0A%2Espan10%20%7B%0Awidth%3A%20970px%3B%0A%7D%0A%2Espan9%20%7B%0Awidth%3A%20870px%3B%0A%7D%0A%2Espan8%20%7B%0Awidth%3A%20770px%3B%0A%7D%0A%2Espan7%20%7B%0Awidth%3A%20670px%3B%0A%7D%0A%2Espan6%20%7B%0Awidth%3A%20570px%3B%0A%7D%0A%2Espan5%20%7B%0Awidth%3A%20470px%3B%0A%7D%0A%2Espan4%20%7B%0Awidth%3A%20370px%3B%0A%7D%0A%2Espan3%20%7B%0Awidth%3A%20270px%3B%0A%7D%0A%2Espan2%20%7B%0Awidth%3A%20170px%3B%0A%7D%0A%2Espan1%20%7B%0Awidth%3A%2070px%3B%0A%7D%0A%2Eoffset12%20%7B%0Amargin%2Dleft%3A%201230px%3B%0A%7D%0A%2Eoffset11%20%7B%0Amargin%2Dleft%3A%201130px%3B%0A%7D%0A%2Eoffset10%20%7B%0Amargin%2Dleft%3A%201030px%3B%0A%7D%0A%2Eoffset9%20%7B%0Amargin%2Dleft%3A%20930px%3B%0A%7D%0A%2Eoffset8%20%7B%0Amargin%2Dleft%3A%20830px%3B%0A%7D%0A%2Eoffset7%20%7B%0Amargin%2Dleft%3A%20730px%3B%0A%7D%0A%2Eoffset6%20%7B%0Amargin%2Dleft%3A%20630px%3B%0A%7D%0A%2Eoffset5%20%7B%0Amargin%2Dleft%3A%20530px%3B%0A%7D%0A%2Eoffset4%20%7B%0Amargin%2Dleft%3A%20430px%3B%0A%7D%0A%2Eoffset3%20%7B%0Amargin%2Dleft%3A%20330px%3B%0A%7D%0A%2Eoffset2%20%7B%0Amargin%2Dleft%3A%20230px%3B%0A%7D%0A%2Eoffset1%20%7B%0Amargin%2Dleft%3A%20130px%3B%0A%7D%0A%2Erow%2Dfluid%20%7B%0Awidth%3A%20100%25%3B%0A%2Azoom%3A%201%3B%0A%7D%0A%2Erow%2Dfluid%3Abefore%2C%0A%2Erow%2Dfluid%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0Aline%2Dheight%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%3Aafter%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Amin%2Dheight%3A%2030px%3B%0A%2Dwebkit%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0A%2Dmoz%2Dbox%2Dsizing%3A%20border%2Dbox%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Afloat%3A%20left%3B%0Amargin%2Dleft%3A%202%2E564102564102564%25%3B%0A%2Amargin%2Dleft%3A%202%2E5109110747408616%25%3B%0A%7D%0A%2Erow%2Dfluid%20%5Bclass%2A%3D%22span%22%5D%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Erow%2Dfluid%20%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%202%2E564102564102564%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan12%20%7B%0Awidth%3A%20100%25%3B%0A%2Awidth%3A%2099%2E94680851063829%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan11%20%7B%0Awidth%3A%2091%2E45299145299145%25%3B%0A%2Awidth%3A%2091%2E39979996362975%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan10%20%7B%0Awidth%3A%2082%2E90598290598291%25%3B%0A%2Awidth%3A%2082%2E8527914166212%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan9%20%7B%0Awidth%3A%2074%2E35897435897436%25%3B%0A%2Awidth%3A%2074%2E30578286961266%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan8%20%7B%0Awidth%3A%2065%2E81196581196582%25%3B%0A%2Awidth%3A%2065%2E75877432260411%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan7%20%7B%0Awidth%3A%2057%2E26495726495726%25%3B%0A%2Awidth%3A%2057%2E21176577559556%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan6%20%7B%0Awidth%3A%2048%2E717948717948715%25%3B%0A%2Awidth%3A%2048%2E664757228587014%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan5%20%7B%0Awidth%3A%2040%2E17094017094017%25%3B%0A%2Awidth%3A%2040%2E11774868157847%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan4%20%7B%0Awidth%3A%2031%2E623931623931625%25%3B%0A%2Awidth%3A%2031%2E570740134569924%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan3%20%7B%0Awidth%3A%2023%2E076923076923077%25%3B%0A%2Awidth%3A%2023%2E023731587561375%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan2%20%7B%0Awidth%3A%2014%2E52991452991453%25%3B%0A%2Awidth%3A%2014%2E476723040552828%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Espan1%20%7B%0Awidth%3A%205%2E982905982905983%25%3B%0A%2Awidth%3A%205%2E929714493544281%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%20%7B%0Amargin%2Dleft%3A%20105%2E12820512820512%25%3B%0A%2Amargin%2Dleft%3A%20105%2E02182214948171%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset12%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%20102%2E56410256410257%25%3B%0A%2Amargin%2Dleft%3A%20102%2E45771958537915%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%20%7B%0Amargin%2Dleft%3A%2096%2E58119658119658%25%3B%0A%2Amargin%2Dleft%3A%2096%2E47481360247316%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset11%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2094%2E01709401709402%25%3B%0A%2Amargin%2Dleft%3A%2093%2E91071103837061%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%20%7B%0Amargin%2Dleft%3A%2088%2E03418803418803%25%3B%0A%2Amargin%2Dleft%3A%2087%2E92780505546462%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset10%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2085%2E47008547008548%25%3B%0A%2Amargin%2Dleft%3A%2085%2E36370249136206%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%20%7B%0Amargin%2Dleft%3A%2079%2E48717948717949%25%3B%0A%2Amargin%2Dleft%3A%2079%2E38079650845607%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset9%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2076%2E92307692307693%25%3B%0A%2Amargin%2Dleft%3A%2076%2E81669394435352%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%20%7B%0Amargin%2Dleft%3A%2070%2E94017094017094%25%3B%0A%2Amargin%2Dleft%3A%2070%2E83378796144753%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset8%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2068%2E37606837606839%25%3B%0A%2Amargin%2Dleft%3A%2068%2E26968539734497%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%20%7B%0Amargin%2Dleft%3A%2062%2E393162393162385%25%3B%0A%2Amargin%2Dleft%3A%2062%2E28677941443899%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset7%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2059%2E82905982905982%25%3B%0A%2Amargin%2Dleft%3A%2059%2E72267685033642%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%20%7B%0Amargin%2Dleft%3A%2053%2E84615384615384%25%3B%0A%2Amargin%2Dleft%3A%2053%2E739770867430444%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset6%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2051%2E28205128205128%25%3B%0A%2Amargin%2Dleft%3A%2051%2E175668303327875%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%20%7B%0Amargin%2Dleft%3A%2045%2E299145299145295%25%3B%0A%2Amargin%2Dleft%3A%2045%2E1927623204219%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset5%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2042%2E73504273504273%25%3B%0A%2Amargin%2Dleft%3A%2042%2E62865975631933%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%20%7B%0Amargin%2Dleft%3A%2036%2E75213675213675%25%3B%0A%2Amargin%2Dleft%3A%2036%2E645753773413354%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset4%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2034%2E18803418803419%25%3B%0A%2Amargin%2Dleft%3A%2034%2E081651209310785%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%20%7B%0Amargin%2Dleft%3A%2028%2E205128205128204%25%3B%0A%2Amargin%2Dleft%3A%2028%2E0987452264048%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset3%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2025%2E641025641025642%25%3B%0A%2Amargin%2Dleft%3A%2025%2E53464266230224%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%20%7B%0Amargin%2Dleft%3A%2019%2E65811965811966%25%3B%0A%2Amargin%2Dleft%3A%2019%2E551736679396257%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset2%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%2017%2E094017094017094%25%3B%0A%2Amargin%2Dleft%3A%2016%2E98763411529369%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%20%7B%0Amargin%2Dleft%3A%2011%2E11111111111111%25%3B%0A%2Amargin%2Dleft%3A%2011%2E004728132387708%25%3B%0A%7D%0A%2Erow%2Dfluid%20%2Eoffset1%3Afirst%2Dchild%20%7B%0Amargin%2Dleft%3A%208%2E547008547008547%25%3B%0A%2Amargin%2Dleft%3A%208%2E440625568285142%25%3B%0A%7D%0Ainput%2C%0Atextarea%2C%0A%2Euneditable%2Dinput%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Econtrols%2Drow%20%5Bclass%2A%3D%22span%22%5D%20%2B%20%5Bclass%2A%3D%22span%22%5D%20%7B%0Amargin%2Dleft%3A%2030px%3B%0A%7D%0Ainput%2Espan12%2C%0Atextarea%2Espan12%2C%0A%2Euneditable%2Dinput%2Espan12%20%7B%0Awidth%3A%201156px%3B%0A%7D%0Ainput%2Espan11%2C%0Atextarea%2Espan11%2C%0A%2Euneditable%2Dinput%2Espan11%20%7B%0Awidth%3A%201056px%3B%0A%7D%0Ainput%2Espan10%2C%0Atextarea%2Espan10%2C%0A%2Euneditable%2Dinput%2Espan10%20%7B%0Awidth%3A%20956px%3B%0A%7D%0Ainput%2Espan9%2C%0Atextarea%2Espan9%2C%0A%2Euneditable%2Dinput%2Espan9%20%7B%0Awidth%3A%20856px%3B%0A%7D%0Ainput%2Espan8%2C%0Atextarea%2Espan8%2C%0A%2Euneditable%2Dinput%2Espan8%20%7B%0Awidth%3A%20756px%3B%0A%7D%0Ainput%2Espan7%2C%0Atextarea%2Espan7%2C%0A%2Euneditable%2Dinput%2Espan7%20%7B%0Awidth%3A%20656px%3B%0A%7D%0Ainput%2Espan6%2C%0Atextarea%2Espan6%2C%0A%2Euneditable%2Dinput%2Espan6%20%7B%0Awidth%3A%20556px%3B%0A%7D%0Ainput%2Espan5%2C%0Atextarea%2Espan5%2C%0A%2Euneditable%2Dinput%2Espan5%20%7B%0Awidth%3A%20456px%3B%0A%7D%0Ainput%2Espan4%2C%0Atextarea%2Espan4%2C%0A%2Euneditable%2Dinput%2Espan4%20%7B%0Awidth%3A%20356px%3B%0A%7D%0Ainput%2Espan3%2C%0Atextarea%2Espan3%2C%0A%2Euneditable%2Dinput%2Espan3%20%7B%0Awidth%3A%20256px%3B%0A%7D%0Ainput%2Espan2%2C%0Atextarea%2Espan2%2C%0A%2Euneditable%2Dinput%2Espan2%20%7B%0Awidth%3A%20156px%3B%0A%7D%0Ainput%2Espan1%2C%0Atextarea%2Espan1%2C%0A%2Euneditable%2Dinput%2Espan1%20%7B%0Awidth%3A%2056px%3B%0A%7D%0A%2Ethumbnails%20%7B%0Amargin%2Dleft%3A%20%2D30px%3B%0A%7D%0A%2Ethumbnails%20%3E%20li%20%7B%0Amargin%2Dleft%3A%2030px%3B%0A%7D%0A%2Erow%2Dfluid%20%2Ethumbnails%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%7D%0A%40media%20%28max%2Dwidth%3A%20979px%29%20%7B%0Abody%20%7B%0Apadding%2Dtop%3A%200%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%7B%0Aposition%3A%20static%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%7B%0Amargin%2Dbottom%3A%2020px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dbottom%20%7B%0Amargin%2Dtop%3A%2020px%3B%0A%7D%0A%2Enavbar%2Dfixed%2Dtop%20%2Enavbar%2Dinner%2C%0A%2Enavbar%2Dfixed%2Dbottom%20%2Enavbar%2Dinner%20%7B%0Apadding%3A%205px%3B%0A%7D%0A%2Enavbar%20%2Econtainer%20%7B%0Awidth%3A%20auto%3B%0Apadding%3A%200%3B%0A%7D%0A%2Enavbar%20%2Ebrand%20%7B%0Apadding%2Dleft%3A%2010px%3B%0Apadding%2Dright%3A%2010px%3B%0Amargin%3A%200%200%200%20%2D5px%3B%0A%7D%0A%2Enav%2Dcollapse%20%7B%0Aclear%3A%20both%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%7B%0Afloat%3A%20none%3B%0Amargin%3A%200%200%2010px%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%7B%0Afloat%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%20%7B%0Amargin%2Dbottom%3A%202px%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20%2Edivider%2Dvertical%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%2Enav%2Dheader%20%7B%0Acolor%3A%20%23777777%3B%0Atext%2Dshadow%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%2C%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%20%7B%0Apadding%3A%209px%2015px%3B%0Afont%2Dweight%3A%20bold%3B%0Acolor%3A%20%23777777%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%203px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%203px%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Ebtn%20%7B%0Apadding%3A%204px%2010px%204px%3B%0Afont%2Dweight%3A%20normal%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%204px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%204px%3B%0Aborder%2Dradius%3A%204px%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20li%20%2B%20li%20a%20%7B%0Amargin%2Dbottom%3A%202px%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%3Afocus%2C%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%3Ahover%2C%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%3Afocus%20%7B%0Abackground%2Dcolor%3A%20%23f2f2f2%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%2C%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%20%7B%0Acolor%3A%20%23999999%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20a%3Afocus%2C%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%3Ahover%2C%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20a%3Afocus%20%7B%0Abackground%2Dcolor%3A%20%23111111%3B%0A%7D%0A%2Enav%2Dcollapse%2Ein%20%2Ebtn%2Dgroup%20%7B%0Amargin%2Dtop%3A%205px%3B%0Apadding%3A%200%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20%7B%0Aposition%3A%20static%3B%0Atop%3A%20auto%3B%0Aleft%3A%20auto%3B%0Afloat%3A%20none%3B%0Adisplay%3A%20none%3B%0Amax%2Dwidth%3A%20none%3B%0Amargin%3A%200%2015px%3B%0Apadding%3A%200%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%20none%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%3B%0Aborder%2Dradius%3A%200%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20none%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20none%3B%0Abox%2Dshadow%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Eopen%20%3E%20%2Edropdown%2Dmenu%20%7B%0Adisplay%3A%20block%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%3Abefore%2C%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%3Aafter%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Edropdown%2Dmenu%20%2Edivider%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Abefore%2C%0A%2Enav%2Dcollapse%20%2Enav%20%3E%20li%20%3E%20%2Edropdown%2Dmenu%3Aafter%20%7B%0Adisplay%3A%20none%3B%0A%7D%0A%2Enav%2Dcollapse%20%2Enavbar%2Dform%2C%0A%2Enav%2Dcollapse%20%2Enavbar%2Dsearch%20%7B%0Afloat%3A%20none%3B%0Apadding%3A%2010px%2015px%3B%0Amargin%3A%2010px%200%3B%0Aborder%2Dtop%3A%201px%20solid%20%23f2f2f2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23f2f2f2%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%3B%0Abox%2Dshadow%3A%20inset%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%2C%200%201px%200%20rgba%28255%2C255%2C255%2C%2E1%29%3B%0A%7D%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Enavbar%2Dform%2C%0A%2Enavbar%2Dinverse%20%2Enav%2Dcollapse%20%2Enavbar%2Dsearch%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%23111111%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23111111%3B%0A%7D%0A%2Enavbar%20%2Enav%2Dcollapse%20%2Enav%2Epull%2Dright%20%7B%0Afloat%3A%20none%3B%0Amargin%2Dleft%3A%200%3B%0A%7D%0A%2Enav%2Dcollapse%2C%0A%2Enav%2Dcollapse%2Ecollapse%20%7B%0Aoverflow%3A%20hidden%3B%0Aheight%3A%200%3B%0A%7D%0A%2Enavbar%20%2Ebtn%2Dnavbar%20%7B%0Adisplay%3A%20block%3B%0A%7D%0A%2Enavbar%2Dstatic%20%2Enavbar%2Dinner%20%7B%0Apadding%2Dleft%3A%2010px%3B%0Apadding%2Dright%3A%2010px%3B%0A%7D%0A%7D%0A%40media%20%28min%2Dwidth%3A%20980px%29%20%7B%0A%2Enav%2Dcollapse%2Ecollapse%20%7B%0Aheight%3A%20auto%20%21important%3B%0Aoverflow%3A%20visible%20%21important%3B%0A%7D%0A%7D%0A%0A%2Edoc%2Dtitle%20%7B%20float%3A%20left%3B%20display%3A%20block%3B%20padding%3A%2010px%2020px%2010px%3B%20margin%2Dleft%3A%20%2D20px%3B%0Afont%2Dsize%3A%2020px%3B%20font%2Dweight%3A%20200%3B%20color%3A%20%23777777%3B%20text%2Dshadow%3A%200%201px%200%20%23ffffff%3B%20%7D%0A%2Edoc%2Dinfo%20%2Enavbar%2Dtext%20%7B%20padding%3A%200%2015px%3B%20%7D%0Ah1%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h2%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h3%20a%20%7B%20color%3A%20%23333%3B%20%7D%0Ah4%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h5%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h6%20a%20%7B%20color%3A%20%23333%3B%20%7D%0Ah1%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h2%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h3%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%0Ah4%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h5%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%20h6%3Ahover%20a%20%7B%20color%3A%20%23333%3B%20%7D%0A%2Etoc%20%7B%20margin%2Dtop%3A%2010px%3B%20%7D%0A%2Etoc%2C%20%2Etoc%20ul%20%7B%20padding%3A%200%3B%20%7D%0A%2Etoc%20ul%20%7B%20margin%2Dleft%3A%200%3B%20margin%2Dbottom%3A%2020px%3B%20list%2Dstyle%3A%20none%3B%20%7D%0A%2Etoc%20ul%20%3E%20li%20%3E%20a%20%7B%20display%3A%20block%3B%20%7D%0A%2Etoc%20ul%20%3E%20li%20%3E%20a%3Ahover%2C%0A%2Etoc%20ul%20%3E%20li%20%3E%20a%3Afocus%20%7B%20text%2Ddecoration%3A%20none%3B%20background%2Dcolor%3A%20%23eeeeee%3B%20%7D%0A%2Etoc%20ul%20%7B%20margin%2Dbottom%3A%200%3B%20padding%2Dleft%3A%205px%3Bpadding%2Dright%3A%205px%3B%7D%0A%2Etoc%20ul%20%3E%20li%20%3E%20a%2C%20%2Etoc%20ul%20%3E%20li%20%3E%20a%20%7B%20padding%3A%203px%2015px%3B%20%7D%0A%23TOC%20%7B%20overflow%2Dy%3A%20scroll%3B%0Atop%3A%200%3B%0Abottom%3A%200%3B%0A%7D%0Atable%20%7B%0Amin%2Dwidth%3A%20100%25%0A%7D%0A%2Evideo%2Djs%20%7B%0Amin%2Dwidth%3A100%25%3B%20max%2Dwidth%3A100%25%3B%0A%7D%0A%2Evjs%2Dfullscreen%20%7B%0Apadding%2Dtop%3A%200px%0A%7D%0A%3A%3A%2Dwebkit%2Dscrollbar%20%7B%0Awidth%3A%2012px%3B%20%0Aheight%3A%2012px%3B%20%0A%7D%0A%3A%3A%2Dwebkit%2Dscrollbar%2Dtrack%20%7B%0Abackground%3A%20rgba%280%2C%200%2C%200%2C%200%2E1%29%3B%0A%7D%0A%3A%3A%2Dwebkit%2Dscrollbar%2Dthumb%20%7B%0Abackground%3A%20rgba%280%2C%200%2C%200%2C%200%2E5%29%3B%0A%7D%0A" />

    <link href="data:text/css; charset=utf-8;charset=utf-8,%40charset%20%22UTF%2D8%22%3B%0A%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmodal%2Ddialog%2C%20%2Evjs%2Dmodal%2Ddialog%20%2Evjs%2Dmodal%2Ddialog%2Dcontent%20%7B%0Aposition%3A%20absolute%3B%0Atop%3A%200%3B%0Aleft%3A%200%3B%0Awidth%3A%20100%25%3B%0Aheight%3A%20100%25%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Abefore%20%7B%0Atext%2Dalign%3A%20center%3B%20%7D%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Asrc%3A%20url%28data%3Aapplication%2Fvnd%2Ems%2Dfontobject%3Bbase64%2ClBYAAPAVAAABAAIAAAAAAAIABQMAAAAAAAABAJABAAAAAExQAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAA2hJyEQAAAAAAAAAAAAAAAAAAAAAAAA4AVgBpAGQAZQBvAEoAUwAAAA4AUgBlAGcAdQBsAGEAcgAAABYAVgBlAHIAcwBpAG8AbgAgADEALgAwAAAADgBWAGkAZABlAG8ASgBTAAAAAAAAAQAAAAoAgAADACBPUy8yUZFeBAAAASgAAABWY21hcOIvELYAAAH4AAABSmdseWblfxf%2BAAADhAAADuRoZWFkCsZ2fQAAANAAAAA2aGhlYQ6iBx8AAACsAAAAJGhtdHjSAAAAAAABgAAAAHhsb2NhMMgtQgAAA0QAAAA%2BbWF4cAEvAHkAAAEIAAAAIG5hbWXVx%2FWgAAASaAAAAgpwb3N0vawAegAAFHQAAAF5AAEAAAcAAAAAoQcAAAAAAAcAAAEAAAAAAAAAAAAAAAAAAAAeAAEAAAABAAARchLaXw889QALBwAAAAAA0lQVwAAAAADSVBXAAAAAAAcABwAAAAAIAAIAAAAAAAAAAQAAAB4AbQAHAAAAAAACAAAACgAKAAAA%2FwAAAAAAAAABBwABkAAFAAgEcQTmAAAA%2BgRxBOYAAANcAFcBzgAAAgAFAwAAAAAAAAAAAAAAAAAAAAAAAAAAAABQZkVkAEDxAfEdBwAAAAChBwAAAAAAAAEAAAAAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAAAAADAAAAAwAAABwAAQAAAAAARAADAAEAAAAcAAQAKAAAAAYABAABAAIAAPEd%2F%2F8AAAAA8QH%2F%2FwAADwAAAQAAAAAAAAAAAQYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgBQAGYAsgDGAOYBHgFIAXQBnAHyAi4CjgK6AwoDjgOwA%2BoEOAR8BLgE6AUMBaIF6AY2BmwG2gdyAAAAAQAAAAAFiwWLAAIAAAERAQJVAzYFi%2FvqAgsAAAMAAAAABmsGawACAA4AGgAACQITBAADEgAFJAATAgABJgAnNgA3FgAXBgAC6wHA%2FkCV%2FsP%2BWggIAaYBPQE9AaYICP5a%2FsP9%2Fq4GBgFS%2Ff0BUgYG%2Fq4CMAFQAVABmwj%2BWv7D%2FsP%2BWggIAaYBPQE9Aab6yAYBUv39AVIGBv6u%2Ff3%2BrgAAAAIAAAAABUAFiwADAAcAAAEhESkBESERAcABK%2F7VAlUBKwF1BBb76gQWAAAABAAAAAAGIAYgAAYAEwAkACcAAAEuAScVFzY3BgcXPgE1JgAnFRYSAQcBIREhAREBBgcVPgE3FzcBBxcE0AFlVbgDuwIncSUoBf7f5aXO%2B7dfAWH%2BnwErAXUBPkxdToo7mV%2F9YJycA4BkniuluBgYaltxRpxU9AFjOJo0%2FvQB61%2F%2Bn%2F5A%2FosB9v7COx2aEkQxmF8ElpycAAABAAAAAASrBdYABQAAAREhAREBAgsBKgF2%2FooEYP5A%2FosEqv6LAAAAAgAAAAAFZgXWAAYADAAAAS4BJxE%2BAQERIQERAQVlAWVUVGX8EQErAXX%2BiwOAZJ4r%2FaYrngFE%2FkD%2BiwSq%2FosAAAMAAAAABiAGDwAFAAwAGgAAExEhAREBBS4BJxE%2BAQMVFhIXBgIHFTYANyYA4AErAXX%2BiwLFAWVVVWW6pc4DA86l5QEhBQX%2B3wRg%2FkD%2BiwSq%2FovgZJ4r%2FaYrngLzmjT%2B9LW1%2FvQ0mjgBYvX1AWIAAAAEAAAAAAWLBYsABQALABEAFwAAASMRITUjAzM1MzUhASMVIREjAxUzFTMRAguWAXbglpbg%2FooDgOABdpbg4JYC6%2F6KlgIK4Jb8gJYBdgKgluABdgAEAAAAAAWLBYsABQALABEAFwAAATMVMxEhEyMVIREjATM1MzUhEzUjESE1AXXglv6K4OABdpYBwJbg%2FoqWlgF2AlXgAXYBwJYBdvvq4JYBwOD%2BipYAAAAAAgAAAAAF1gXWAA8AEwAAASEOAQcRHgEXIT4BNxEuAQMhESEFQPyAP1UBAVU%2FA4A%2FVQEBVT%2F8gAOABdUBVT%2F8gD9VAQFVPwOAP1X77AOAAAAGAAAAAAZrBmsABwAMABMAGwAgACgAAAkBJicOAQcBJS4BJwEFIQE2EjcmBQEGAgcWFyEFHgEXATMBFhc%2BATcBAr4BZE5Uh%2FBhARIDjjXpof7uAuX90AF6XGgBAfwT%2Ft1caAEBDgIw%2FeQ16aEBEnj%2B3U5Uh%2FBh%2Fu4D8AJoEgEBWFD%2BJ3el9j7%2BJ0v9c2QBAZNNTQH4ZP7%2Fk01IS6X2PgHZ%2FggSAQFYUAHZAAAABQAAAAAGawXWAA8AEwAXABsAHwAAASEOAQcRHgEXIT4BNxEuAQEhFSEBITUhBSE1ITUhNSEF1ftWQFQCAlRABKpAVAICVPsWASr%2B1gLq%2FRYC6gHA%2FtYBKv0WAuoF1QFVP%2FyAP1UBAVU%2FA4A%2FVf2slf7VlZWVlpUAAwAAAAAGIAXWAA8AJwA%2FAAABIQ4BBxEeARchPgE3ES4BASM1IxUzNTMVFAYHIy4BJxE%2BATczHgEVBSM1IxUzNTMVDgEHIy4BNRE0NjczHgEXBYv76j9UAgJUPwQWP1QCAlT9a3CVlXAqIOAgKgEBKiDgICoCC3CVlXABKiDgICoqIOAgKgEF1QFVP%2FyAP1UBAVU%2FA4A%2FVf33JeAlSiAqAQEqIAEqICoBASogSiXgJUogKgEBKiABKiAqAQEqIAAABgAAAAAGIAT2AAMABwALAA8AEwAXAAATMzUjETM1IxEzNSMBITUhESE1IREVITXglZWVlZWVASsEFfvrBBX76wQVAzWW%2FkCVAcCV%2FkCW%2FkCVAlWVlQAAAAEAAAAABiAGbAAuAAABIgYHATY0JwEeATM%2BATcuAScOAQcUFwEuASMOAQceARcyNjcBBgceARc%2BATcuAQVAK0oe%2FewHBwIPHk4sX38CAn9fX38CB%2F3xHk4sX38CAn9fLE4eAhQFAQN7XFx7AwN7Ak8fGwE3GTYZATQdIAJ%2FX19%2FAgJ%2FXxsZ%2Fs0cIAJ%2FX19%2FAiAc%2FsoXGlx7AgJ7XF17AAACAAAAAAZZBmsAQwBPAAABNjQnNz4BJwMuAQ8BJi8BLgEnIQ4BDwEGBycmBgcDBhYfAQYUFwcOARcTHgE%2FARYfAR4BFyE%2BAT8BNjcXFjY3EzYmJwUuASc%2BATceARcOAQWrBQWeCgYHlgcZDbo6RBwDFA%2F%2B1g8UAhxFOboNGgeVBwULnQUFnQsFB5UHGg26OUUcAhQPASoPFAIcRTm6DRoHlQcFC%2F04b5QCApRvb5QCApQDNyRKJHsJGg0BAwwJBUstHMYOEQEBEQ7GHC1LBQkM%2Fv0MGwl7JEokewkaDf79DAkFSy0cxg4RAQERDsYcLUsFCQwBAwwbCUEClG9vlAIClG9vlAAAAAABAAAAAAZrBmsACwAAExIABSQAEwIAJQQAlQgBpgE9AT0BpggI%2Flr%2Bw%2F7D%2FloDgP7D%2FloICAGmAT0BPQGmCAj%2BWgAAAAIAAAAABmsGawALABcAAAEEAAMSAAUkABMCAAEmACc2ADcWABcGAAOA%2FsP%2BWggIAaYBPQE9AaYICP5a%2FsP9%2Fq4GBgFS%2Ff0BUgYG%2Fq4Gawj%2BWv7D%2FsP%2BWggIAaYBPQE9Aab6yAYBUv39AVIGBv6u%2Ff3%2BrgAAAwAAAAAGawZrAAsAFwAjAAABBAADEgAFJAATAgABJgAnNgA3FgAXBgADDgEHLgEnPgE3HgEDgP7D%2FloICAGmAT0BPQGmCAj%2BWv7D%2Ff6uBgYBUv39AVIGBv6uHQJ%2FX19%2FAgJ%2FX19%2FBmsI%2Flr%2Bw%2F7D%2FloICAGmAT0BPQGm%2BsgGAVL9%2FQFSBgb%2Brv39%2Fq4CT19%2FAgJ%2FX19%2FAgJ%2FAAAABAAAAAAGIAYgAA8AGwAlACkAAAEhDgEHER4BFyE%2BATcRLgEBIzUjFSMRMxUzNTsBIR4BFxEOAQchNzM1IwWL%2B%2Bo%2FVAICVD8EFj9UAgJU%2FWtwlXBwlXCWASogKgEBKiD%2B1nCVlQYgAlQ%2F%2B%2Bo%2FVAICVD8EFj9U%2FIKVlQHAu7sBKiD%2B1iAqAXDgAAIAAAAABmsGawALABcAAAEEAAMSAAUkABMCABMHCQEnCQE3CQEXAQOA%2FsP%2BWggIAaYBPQE9AaYICP5aOGn%2B9P70aQEL%2FvVpAQwBDGn%2B9QZrCP5a%2FsP%2Bw%2F5aCAgBpgE9AT0BpvwRaQEL%2FvVpAQwBDGn%2B9QELaf70AAEAAAAABdYGtgAWAAABEQkBER4BFw4BBy4BJyMWABc2ADcmAAOA%2FosBdb79BQX9vr79BZUGAVH%2B%2FgFRBgb%2BrwWLASr%2Bi%2F6LASoE%2Fb%2B%2B%2FQUF%2Fb7%2B%2Fq8GBgFR%2Fv4BUQAAAAEAAAAABT8HAAAUAAABESMiBh0BIQMjESERIxEzNTQ2MzIFP51WPAElJ%2F7%2Bzv%2F%2F0K2TBvT%2B%2BEhIvf7Y%2FQkC9wEo2rrNAAAAAAQAAAAABo4HAAAwAEUAYABsAAABFB4DFRQHBgQjIiYnJjU0Njc2JS4BNTQ3BiMiJjU0Njc%2BATMhByMeARUUDgMnMjY3NjU0LgIjIgYHBhUUHgMTMj4CNTQuAS8BJi8CJiMiDgMVFB4CATMVIxUjNSM1MzUzAx9AW1pAMEj%2B6p%2BE5TklWUqDAREgHxUuFpTLSD9N03ABooqDSkwxRUYxkiZQGjUiP2pAKlEZLxQrPVk2OmtbNw4PEx4KHCVOECA1aG9TNkZxfQNr1dVp1NRpA%2BQkRUNQgE5aU3pzU2A8R1GKLlISKkApJDEEwZRSmjZCQFg%2FjFpIc0c7QD4hGzlmOoZ9UichO2UuZ2dSNPyXGjRePhkwJBgjCxcdOAIOJDhdO0ZrOx0DbGzb22zZAAMAAAAABoAGbAADAA4AKgAAAREhEQEWBisBIiY0NjIWAREhETQmIyIGBwYVESESEC8BIRUjPgMzMhYB3f62AV8BZ1QCUmRnpmQEj%2F63UVY%2FVRUL%2FrcCAQEBSQIUKkdnP6vQBI%2F8IQPfATJJYmKTYWH83f3IAhJpd0UzHjP91wGPAfAwMJAgMDgf4wAAAQAAAAAGlAYAADEAAAEGBxYVFAIOAQQjICcWMzI3LgEnFjMyNy4BPQEWFy4BNTQ3FgQXJjU0NjMyFzY3Bgc2BpRDXwFMm9b%2B0qz%2B8eEjK%2BGwaaYfIRwrKnCTRE5CTix5AVvGCL2GjGBtYCVpXQVoYkUOHIL%2B%2Fe63bZEEigJ9YQULF7F1BCYDLI5TWEuVswomJIa9ZhU5cz8KAAAAAQAAAAAFgAcAACIAAAEXDgEHBi4DNREjNT4ENz4BOwERIRUhERQeAjc2BTBQF7BZaK1wTiGoSHJEMBQFAQcE9AFN%2FrINIEMwTgHP7SM%2BAQI4XHh4OgIg1xpXXW9XLQUH%2Flj8%2FfoeNDUeAQIAAQAAAAAGgAaAAEoAAAEUAgQjIic2PwEeATMyPgE1NC4BIyIOAxUUFhcWPwE2NzYnJjU0NjMyFhUUBiMiJjc%2BAjU0JiMiBhUUFwMGFyYCNTQSJCAEEgaAzv6f0W9rOxM2FGo9eb5od%2BKOabZ%2FWytQTR4ICAYCBhEz0amXqYlrPUoOCCUXNjI%2BVhljEQTO%2Fs4BYQGiAWHOA4DR%2Fp%2FOIF1H0yc5ifCWcsh%2BOmB9hkNoniAMIB8YBhcUPVqX2aSDqu5XPSN1WR8yQnJVSTH%2BXkZrWwF86dEBYc7O%2Fp8AAAcAAAAABwAEzwAOABcAKgA9AFAAWgBdAAABETYeAgcOAQcGJiMnJjcWNjc2JgcRFAUWNjc%2BATcuAScjBh8BHgEXDgEXFjY3PgE3LgEnIwYfAR4BFxQGFxY2Nz4BNy4BJyMGHwEeARcOAQUzPwEVMxEjBgMlFScDHITNlFsIDauCR60IAQGqVGgKCXFjAX4iIQ4jKwECSzAdAQQKJDQCAT5jIiEOIiwBAkswHgEFCiQ0AT9jIiEOIiwBAkswHgEFCiQ0AQE%2B%2BYPuQeGqzSzSASeOAckC%2FQUPZr2AisAPBQUDA8MCVUxncwX%2BlQfCBzUdPJZXfbk%2BCwkQP6hjcb1MBzUdPJZXfbk%2BCwkQP6hjcb1MBzUdPJZXfbk%2BCwkQP6hjcb1SZAFlAwxH%2FrWD%2BQEAAAAAABAAxgABAAAAAAABAAcAAAABAAAAAAACAAcABwABAAAAAAADAAcADgABAAAAAAAEAAcAFQABAAAAAAAFAAsAHAABAAAAAAAGAAcAJwABAAAAAAAKACsALgABAAAAAAALABMAWQADAAEECQABAA4AbAADAAEECQACAA4AegADAAEECQADAA4AiAADAAEECQAEAA4AlgADAAEECQAFABYApAADAAEECQAGAA4AugADAAEECQAKAFYAyAADAAEECQALACYBHlZpZGVvSlNSZWd1bGFyVmlkZW9KU1ZpZGVvSlNWZXJzaW9uIDEuMFZpZGVvSlNHZW5lcmF0ZWQgYnkgc3ZnMnR0ZiBmcm9tIEZvbnRlbGxvIHByb2plY3QuaHR0cDovL2ZvbnRlbGxvLmNvbQBWAGkAZABlAG8ASgBTAFIAZQBnAHUAbABhAHIAVgBpAGQAZQBvAEoAUwBWAGkAZABlAG8ASgBTAFYAZQByAHMAaQBvAG4AIAAxAC4AMABWAGkAZABlAG8ASgBTAEcAZQBuAGUAcgBhAHQAZQBkACAAYgB5ACAAcwB2AGcAMgB0AHQAZgAgAGYAcgBvAG0AIABGAG8AbgB0AGUAbABsAG8AIABwAHIAbwBqAGUAYwB0AC4AaAB0AHQAcAA6AC8ALwBmAG8AbgB0AGUAbABsAG8ALgBjAG8AbQAAAAIAAAAAAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgAAAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgRwbGF5C3BsYXktY2lyY2xlBXBhdXNlC3ZvbHVtZS1tdXRlCnZvbHVtZS1sb3cKdm9sdW1lLW1pZAt2b2x1bWUtaGlnaBBmdWxsc2NyZWVuLWVudGVyD2Z1bGxzY3JlZW4tZXhpdAZzcXVhcmUHc3Bpbm5lcglzdWJ0aXRsZXMIY2FwdGlvbnMIY2hhcHRlcnMFc2hhcmUDY29nBmNpcmNsZQ5jaXJjbGUtb3V0bGluZRNjaXJjbGUtaW5uZXItY2lyY2xlAmhkBmNhbmNlbAZyZXBsYXkIZmFjZWJvb2sFZ3BsdXMIbGlua2VkaW4HdHdpdHRlcgZ0dW1ibHIJcGludGVyZXN0EWF1ZGlvLWRlc2NyaXB0aW9uAAAAAAA%3D%29%20format%28%22eot%22%29%3B%20%7D%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Asrc%3A%20url%28data%3Aapplication%2Ffont%2Dwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAA4wAAoAAAAAFfAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAD4AAABWUZFeBGNtYXAAAAE0AAAAOgAAAUriLxC2Z2x5ZgAAAXAAAAnnAAAO5OV%2FF%2F5oZWFkAAALWAAAACoAAAA2CsZ2fWhoZWEAAAuEAAAAGAAAACQOogcfaG10eAAAC5wAAAAPAAAAeNIAAABsb2NhAAALrAAAAD4AAAA%2BMMgtQm1heHAAAAvsAAAAHwAAACABLwB5bmFtZQAADAwAAAElAAACCtXH9aBwb3N0AAANNAAAAPkAAAF5vawAenicY2BkZ2CcwMDKwMFSyPKMgYHhF4RmjmEIZzzHwMDEwMrMgBUEpLmmMDh8ZPwoyw7iLmSHCDOCCADu%2FQo9AAB4nGNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYGD7K%2Fv8PUvCREUTzM0DVAwEjG8OIBwCOWgbUAAB4nI1XfVBU1xV%2F574vlsUlj%2F14grDs48FuAgaR3X2LEnY3UZSgEkTwAySAgkIwI8bRfFDjTszYCWRMW9lNa4y2meokmq%2B2k5ia0dpkmknbkWgSSW3GyaaNf0RTx0wxX7A3Pe%2FtQmIgHXf3vXvvueeee%2B45v3POXQYY%2FPCD%2FCBDGAYkIE2sxg%2BOXSJmhmH1OaFX6MU5C5PDMCZi5Rg2i%2BELGSthwM14NCbgYGSBIZfhFA1H6Zu0OS0NDkMVfg%2BnpdFm%2BmaCvigI0JBIQIMg0BdJGdTj9ylj7nr%2Bb97%2BHl8C1%2BH2xNAvjPqxjIgaKtItICkSnIISeo40QQls4xxjlzgHsnGGvi7BxQiMlSlkPMhfCh67rAUEUQ6CHxW2O7JARCkKnlUQ7UEIyAEQZe4MdDW9xr5OPFuKbubpRxcPDY8da4MOelDfAYJLW%2BsGKn%2FVlmjfv5%2BNdB4oOfTazJn3tGxZtL9xFNZX7PPRUbjcRg%2FSMB2EL%2BgblXn7shbO%2FWUbF9u%2FH5XQ9eKO8iMMr9tY35qYoRi20wGuXV%2FCHaGDk2fdgHwCk5HUXQpCcgHfBV2NjV3jkq4PHTSUSBwuOQALvxPAps6fiftk6P6yJpcm5bB4dFkgoh195mbiSTnkL3jupq7jh4ZZdvjQRVB4PPx3SsVTu5D%2F6kd85RU66ttXAeuuXYN1E%2FY2sMMzZkZiZNRZlRS%2Fynr9Xr8Cql2RVNbutXslYo7B9ngsFqcDbCQO22PxeIxcpgMxkh6PjUdwkvw6hvRpZeoCFKshDQzJVr%2B%2BDWyLx%2BhAXJcGp3TJMV1ME45xCNvHLsWRrpOZSduOoG0zERuIIwuIkhNkBREglQKLiODD45FQE0BTiE214xE2wp8zOt9NjH3GRtDMk7Ehoq2tzCzGxdyMEQJuD0qGIrQ58ApoWQE3D2h1h6zwuB14wYFIDAA5CZ11jT%2B92gFZ7B7%2Fp7%2BhV8jFxBl4aG03wLiVXtBbCylLfIJzkPUAvWAw0yvsVdKdBbC6nnruP%2FRFkHqWJLZ2Auxdtgy%2B6qTf7l1WswTJcJ6mGVxwXj92UtfU2WXUNX%2BqBUCxK6D4FR4f%2FcufG1sZbiSkMcwdMdoxBxTTEXIp4SCXMNhHoFjvTTFP4vkoPReNRmPRCTwa%2B3qY0DR7qn7Vjh612wRRTaI04HWCnZ%2BgIzvS%2FZJP0%2BmynphCui4hzmG0id6%2BaLSv2BV3FQMYDTHrlGQ%2FSZ%2Bq4ZdF8aLa5Ar8GW3tVNKEj13cF0buMaesx1i9CL%2FUo1tM0h%2B74o9HjQ%2BUcPaxy8mH9ccwK8KpKA3rHdIUjTKpfIBxuokpxUGBIILm84ATvHh8tAIe2iZj8KvYwUOXawHMVNgxZvlwSa0z8Zkokkxn3ey2nYTsbMO3mPh8cji7zklsPLD9a9f2s2w%2FuSt%2FFgSytWzw5bmS3PielU1P56aGrlz6NzlnbT8h%2FWtb%2B1OxIqxBbC9g7kINUbtAEDxsKWSCe46eltCPmaiUxy2IrODIB8EmixaQrU4IAQ6THg6BFpAdWsCquT16DkL9ccIC%2FFGeP5AuiDExe8bx%2BQtzWVsmHcm0kdzqecdn5IhRkTc%2FzfNPm3ns5sw4Pq86l9gyofh6jkTF5iFChjYbbzZQWFvYb8qZAWyGiV9ya%2B5bFgnzpuWt3FuX8KYMmsiYZepPseBgGhZcOMt0%2B4Q8fDOTftJjHIuhdaLsFXFM9AclTi9jbGRq8ZvIOykZei77kfo53eoppVPovbGiyV63p%2Fp%2FdkWETTjmhjTIm8RP284b04bcNYlRsvO6Gp2JeaiIueVHsgJGF2aASlCQLuG8EsBomzb%2B%2B%2FAXmwhaOoLhL7iQ4%2Fuc449gWJ56%2FXWDARn74v%2FPL1bRBB4TBEyYrqezSkUPHaWjPWCm13ogAzJ66LVpbTEuXccDZlyXxBQ%2FIrzKOPS7gAkkIyZ0N6joE6M246aDsO1kgucTJ%2FEdFWA5pbAcTfoSP4hJeBCni7nEn5IclL4kpDgmMMuH8Kpk0%2BWrBUIeKCyWS0nPVz7NW86Hnl55GxR5KB3%2B9tszL%2BwVRulXNTUn6D8SJvIl3PzP46eZST%2FtQTllTDXTzmxCaTYna7eJAqcWuD1ulBXQsMz5fQEBCfowCF5FVDF%2F2yysB9OW5veVEtRAFOy41FoeJEiAOZhDiFstsKAwJ8Hijs72q1jWvWx%2BuKU5XFZDLx189OK8ojW1u0By5dtLHUN%2Frwkte68PnhnYVbt0bvWiub9w1%2Bf4C0L3hIuXZ8%2BxlVSt0eb3tgQsmVZnem5R3U0uf%2FfmFdqiLTvY3nPnet5%2Fv4f9pLB6QX2krnnFQ1tXtN%2B2ePlAaUNWcfiWwrncn4ca9ml3hFeHHm%2Bu2bq4MhxUZs3bMH%2F3jgaPUtlVunFjg2%2F8yRzf3cHsssKZqlnOqyCWworWykW9lXnspk0ffrjpfCreIpjPWbwnFxt3PAkcQgkUuH1auUMf%2BtxJQ0hK1k1zsNaqQdaLMxfoq9AGGxtJQ%2BfGw53cE%2FTY8pWhJruZHiMAcCexFS%2FeGDp6hntiXGE%2FgvI7163b29ExfiHxNsnqub%2Fa6%2FQmPoAn4GpZ2c9cZRX5%2F57IWUNYuubiQBAddhuxAKe6PA5vuV5dkk0VXkMM3zk42W3Awrgka8LQgjZY%2BtQIffd5%2BvnHasnHL%2FcczldyS4r79i6su6Nu9oPQ8lbaid2Pt9%2FbXtTTynevq7bkPkITV47d%2B3NugOzo4M3y77Zxbnb2nhWrl0T%2FkO4u3H1ig33e1lD6JDYjiKkCHOioF0pZv6T6gxxipxLNhFc8xERA48vq5ZfXdL%2FQV6c8W3PfwjIsZyI3Csvo72e4FpTVwTv%2FUYNAKtY%2B8MB84vogZ1Xr5lW38iJdPZ74xunzO4Gk7BARIkytjlyCoPVoIb3IluMfAYRhEoAO2aGXKc2TNAJaSwdzQEeq7jC7TWYF2Y2jrEIXlyVEhunBs5t7K62a7Z6qB0923%2F%2BvPT2v7mwpqV%2FmTEsTiCB5zz735HOP9VbVWtKKZK08uDJ7vcQN02HogGegY5iNnKUHh12ti9%2FzzHvsauy%2Btx%2Be375j94LuA64MV%2F5MQbZVNT95%2Fre7jlxZVaVuW5Nffsd9TXfOpXcv6m2Bn3x6FgXg%2Foz%2BP0h%2Fce8g2mTEWxVTzzQzrTruNCcRdbu6VY87gLVXc4uSjXfosak7XxWM4oyl%2BockmzCFhJXaGwK8e6sCW2T3sLmPnh5qSZtx9JHFL6QBHGnsTjdtWQ8PFygWtQTIkrI84NILfQSC65FUMFsnOYFHEoSmUCD49a4rt3985PTsd8GzB%2F5KEnzmhhORgVOZPM%2Byb5KmpRu38jQqviH6826Lrdrxx6DZdFPo2fVbTiy9AUpDJ3SxGYvpK7u%2BRhz8D4BCxssAeJxjYGRgYABiwcIjbvH8Nl8ZuNkZQOBSiOgBZJqdASzOwcAEogDqtAdOAAB4nGNgZGBgZwCChWASxGZkQAVyABOTANd4nGNnYGBgHwAMADNUANMAAAAAAAAOAFAAZgCyAMYA5gEeAUgBdAGcAfICLgKOAroDCgOOA7AD6gQ4BHwEuAToBQwFogXoBjYGbAbaB3IAAHicY2BkYGCQY8hlYGcAASYg5gJCBob%2FYD4DABa6AakAeJxdkE1qg0AYhl8Tk9AIoVDaVSmzahcF87PMARLIMoFAl0ZHY1BHdBJIT9AT9AQ9RQ9Qeqy%2ByteNMzDzfM%2B88w0K4BY%2FcNAMB6N2bUaPPBLukybCLvleeAAPj8JD%2BhfhMV7hC3u4wxs7OO4NzQSZcI%2F8Ltwnfwi75E%2FhAR7wJTyk%2FxYeY49fYQ%2FPztM%2BjbTZ7LY6OWdBJdX%2Fpqs6NYWa%2BzMxa13oKrA6Uoerqi%2FJwtpYxZXJ1coUVmeZUWVlTjq0%2FtHacjmdxuL90OR8O0UEDYMNdtiSEpz5XQGqzlm30kzUdAYFFOb8R7NOZk0q2lwAyz1i7oAr1xoXvrOgtYhZx8wY5KRV269JZ5yGpmzPTjQhvY9je6vEElPOuJP3mWKnP5M3V%2BYAAAB4nG2P2XLCMAxFfYE4CWlZSveFP8hHOY4gHhw79VLav68hMNOH6kG60mg5YhM22pr9b1vGMMEUM2TgyFGgxBwVbnCLBZZYYY07bHCPBzziCc94wSve8I4PbGeDFj%2FVydVSOakpG0T0VH1ZHXuq%2BxhoftHaHq%2ByV%2B21o1P7brWLWnvpiExNJpBb%2Fi18q8D9ZxSOcj8oY8iVPjZBBU2%2BkGIIypokuqTI%2Bcx3qXMq7Z6PQIsx1DYGrQxtLul50YV50rVcCiNJc0enX4qdkNRYe8j2g46%2BSIMHapXJw1GFdIWH2DfalQknZeTDWsRW2bqlBK3ORIz9AqJUapQAAAA%3D%29%20format%28%22woff%22%29%2C%20url%28data%3Aapplication%2Fx%2Dfont%2Dttf%3Bcharset%3Dutf%2D8%3Bbase64%2CAAEAAAAKAIAAAwAgT1MvMlGRXgQAAAEoAAAAVmNtYXDiLxC2AAAB%2BAAAAUpnbHlm5X8X%2FgAAA4QAAA7kaGVhZArGdn0AAADQAAAANmhoZWEOogcfAAAArAAAACRobXR40gAAAAAAAYAAAAB4bG9jYTDILUIAAANEAAAAPm1heHABLwB5AAABCAAAACBuYW1l1cf1oAAAEmgAAAIKcG9zdL2sAHoAABR0AAABeQABAAAHAAAAAKEHAAAAAAAHAAABAAAAAAAAAAAAAAAAAAAAHgABAAAAAQAAEXIS2l8PPPUACwcAAAAAANJUFcAAAAAA0lQVwAAAAAAHAAcAAAAACAACAAAAAAAAAAEAAAAeAG0ABwAAAAAAAgAAAAoACgAAAP8AAAAAAAAAAQcAAZAABQAIBHEE5gAAAPoEcQTmAAADXABXAc4AAAIABQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUGZFZABA8QHxHQcAAAAAoQcAAAAAAAABAAAAAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAAAAAAAwAAAAMAAAAcAAEAAAAAAEQAAwABAAAAHAAEACgAAAAGAAQAAQACAADxHf%2F%2FAAAAAPEB%2F%2F8AAA8AAAEAAAAAAAAAAAEGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AUABmALIAxgDmAR4BSAF0AZwB8gIuAo4CugMKA44DsAPqBDgEfAS4BOgFDAWiBegGNgZsBtoHcgAAAAEAAAAABYsFiwACAAABEQECVQM2BYv76gILAAADAAAAAAZrBmsAAgAOABoAAAkCEwQAAxIABSQAEwIAASYAJzYANxYAFwYAAusBwP5Alf7D%2FloICAGmAT0BPQGmCAj%2BWv7D%2Ff6uBgYBUv39AVIGBv6uAjABUAFQAZsI%2Flr%2Bw%2F7D%2FloICAGmAT0BPQGm%2BsgGAVL9%2FQFSBgb%2Brv39%2Fq4AAAACAAAAAAVABYsAAwAHAAABIREpAREhEQHAASv%2B1QJVASsBdQQW%2B%2BoEFgAAAAQAAAAABiAGIAAGABMAJAAnAAABLgEnFRc2NwYHFz4BNSYAJxUWEgEHASERIQERAQYHFT4BNxc3AQcXBNABZVW4A7sCJ3ElKAX%2B3%2BWlzvu3XwFh%2Fp8BKwF1AT5MXU6KO5lf%2FWCcnAOAZJ4rpbgYGGpbcUacVPQBYziaNP70Aetf%2Fp%2F%2BQP6LAfb%2BwjsdmhJEMZhfBJacnAAAAQAAAAAEqwXWAAUAAAERIQERAQILASoBdv6KBGD%2BQP6LBKr%2BiwAAAAIAAAAABWYF1gAGAAwAAAEuAScRPgEBESEBEQEFZQFlVFRl%2FBEBKwF1%2FosDgGSeK%2F2mK54BRP5A%2FosEqv6LAAADAAAAAAYgBg8ABQAMABoAABMRIQERAQUuAScRPgEDFRYSFwYCBxU2ADcmAOABKwF1%2FosCxQFlVVVluqXOAwPOpeUBIQUF%2Ft8EYP5A%2FosEqv6L4GSeK%2F2mK54C85o0%2FvS1tf70NJo4AWL19QFiAAAABAAAAAAFiwWLAAUACwARABcAAAEjESE1IwMzNTM1IQEjFSERIwMVMxUzEQILlgF24JaW4P6KA4DgAXaW4OCWAuv%2BipYCCuCW%2FICWAXYCoJbgAXYABAAAAAAFiwWLAAUACwARABcAAAEzFTMRIRMjFSERIwEzNTM1IRM1IxEhNQF14Jb%2BiuDgAXaWAcCW4P6KlpYBdgJV4AF2AcCWAXb76uCWAcDg%2FoqWAAAAAAIAAAAABdYF1gAPABMAAAEhDgEHER4BFyE%2BATcRLgEDIREhBUD8gD9VAQFVPwOAP1UBAVU%2F%2FIADgAXVAVU%2F%2FIA%2FVQEBVT8DgD9V%2B%2BwDgAAABgAAAAAGawZrAAcADAATABsAIAAoAAAJASYnDgEHASUuAScBBSEBNhI3JgUBBgIHFhchBR4BFwEzARYXPgE3AQK%2BAWROVIfwYQESA4416aH%2B7gLl%2FdABelxoAQH8E%2F7dXGgBAQ4CMP3kNemhARJ4%2Ft1OVIfwYf7uA%2FACaBIBAVhQ%2Fid3pfY%2B%2FidL%2FXNkAQGTTU0B%2BGT%2B%2F5NNSEul9j4B2f4IEgEBWFAB2QAAAAUAAAAABmsF1gAPABMAFwAbAB8AAAEhDgEHER4BFyE%2BATcRLgEBIRUhASE1IQUhNSE1ITUhBdX7VkBUAgJUQASqQFQCAlT7FgEq%2FtYC6v0WAuoBwP7WASr9FgLqBdUBVT%2F8gD9VAQFVPwOAP1X9rJX%2B1ZWVlZaVAAMAAAAABiAF1gAPACcAPwAAASEOAQcRHgEXIT4BNxEuAQEjNSMVMzUzFRQGByMuAScRPgE3Mx4BFQUjNSMVMzUzFQ4BByMuATURNDY3Mx4BFwWL%2B%2Bo%2FVAICVD8EFj9UAgJU%2FWtwlZVwKiDgICoBASog4CAqAgtwlZVwASog4CAqKiDgICoBBdUBVT%2F8gD9VAQFVPwOAP1X99yXgJUogKgEBKiABKiAqAQEqIEol4CVKICoBASogASogKgEBKiAAAAYAAAAABiAE9gADAAcACwAPABMAFwAAEzM1IxEzNSMRMzUjASE1IREhNSERFSE14JWVlZWVlQErBBX76wQV%2B%2BsEFQM1lv5AlQHAlf5Alv5AlQJVlZUAAAABAAAAAAYgBmwALgAAASIGBwE2NCcBHgEzPgE3LgEnDgEHFBcBLgEjDgEHHgEXMjY3AQYHHgEXPgE3LgEFQCtKHv3sBwcCDx5OLF9%2FAgJ%2FX19%2FAgf98R5OLF9%2FAgJ%2FXyxOHgIUBQEDe1xcewMDewJPHxsBNxk2GQE0HSACf19ffwICf18bGf7NHCACf19ffwIgHP7KFxpcewICe1xdewAAAgAAAAAGWQZrAEMATwAAATY0Jzc%2BAScDLgEPASYvAS4BJyEOAQ8BBgcnJgYHAwYWHwEGFBcHDgEXEx4BPwEWHwEeARchPgE%2FATY3FxY2NxM2JicFLgEnPgE3HgEXDgEFqwUFngoGB5YHGQ26OkQcAxQP%2FtYPFAIcRTm6DRoHlQcFC50FBZ0LBQeVBxoNujlFHAIUDwEqDxQCHEU5ug0aB5UHBQv9OG%2BUAgKUb2%2BUAgKUAzckSiR7CRoNAQMMCQVLLRzGDhEBAREOxhwtSwUJDP79DBsJeyRKJHsJGg3%2B%2FQwJBUstHMYOEQEBEQ7GHC1LBQkMAQMMGwlBApRvb5QCApRvb5QAAAAAAQAAAAAGawZrAAsAABMSAAUkABMCACUEAJUIAaYBPQE9AaYICP5a%2FsP%2Bw%2F5aA4D%2Bw%2F5aCAgBpgE9AT0BpggI%2FloAAAACAAAAAAZrBmsACwAXAAABBAADEgAFJAATAgABJgAnNgA3FgAXBgADgP7D%2FloICAGmAT0BPQGmCAj%2BWv7D%2Ff6uBgYBUv39AVIGBv6uBmsI%2Flr%2Bw%2F7D%2FloICAGmAT0BPQGm%2BsgGAVL9%2FQFSBgb%2Brv39%2Fq4AAAMAAAAABmsGawALABcAIwAAAQQAAxIABSQAEwIAASYAJzYANxYAFwYAAw4BBy4BJz4BNx4BA4D%2Bw%2F5aCAgBpgE9AT0BpggI%2Flr%2Bw%2F3%2BrgYGAVL9%2FQFSBgb%2Brh0Cf19ffwICf19ffwZrCP5a%2FsP%2Bw%2F5aCAgBpgE9AT0BpvrIBgFS%2Ff0BUgYG%2Fq79%2Ff6uAk9ffwICf19ffwICfwAAAAQAAAAABiAGIAAPABsAJQApAAABIQ4BBxEeARchPgE3ES4BASM1IxUjETMVMzU7ASEeARcRDgEHITczNSMFi%2FvqP1QCAlQ%2FBBY%2FVAICVP1rcJVwcJVwlgEqICoBASog%2FtZwlZUGIAJUP%2FvqP1QCAlQ%2FBBY%2FVPyClZUBwLu7ASog%2FtYgKgFw4AACAAAAAAZrBmsACwAXAAABBAADEgAFJAATAgATBwkBJwkBNwkBFwEDgP7D%2FloICAGmAT0BPQGmCAj%2BWjhp%2FvT%2B9GkBC%2F71aQEMAQxp%2FvUGawj%2BWv7D%2FsP%2BWggIAaYBPQE9Aab8EWkBC%2F71aQEMAQxp%2FvUBC2n%2B9AABAAAAAAXWBrYAFgAAAREJAREeARcOAQcuAScjFgAXNgA3JgADgP6LAXW%2B%2FQUF%2Fb6%2B%2FQWVBgFR%2Fv4BUQYG%2Fq8FiwEq%2Fov%2BiwEqBP2%2Fvv0FBf2%2B%2Fv6vBgYBUf7%2BAVEAAAABAAAAAAU%2FBwAAFAAAAREjIgYdASEDIxEhESMRMzU0NjMyBT%2BdVjwBJSf%2B%2Fs7%2F%2F9Ctkwb0%2FvhISL3%2B2P0JAvcBKNq6zQAAAAAEAAAAAAaOBwAAMABFAGAAbAAAARQeAxUUBwYEIyImJyY1NDY3NiUuATU0NwYjIiY1NDY3PgEzIQcjHgEVFA4DJzI2NzY1NC4CIyIGBwYVFB4DEzI%2BAjU0LgEvASYvAiYjIg4DFRQeAgEzFSMVIzUjNTM1MwMfQFtaQDBI%2FuqfhOU5JVlKgwERIB8VLhaUy0g%2FTdNwAaKKg0pMMUVGMZImUBo1Ij9qQCpRGS8UKz1ZNjprWzcODxMeChwlThAgNWhvUzZGcX0Da9XVadTUaQPkJEVDUIBOWlN6c1NgPEdRii5SEipAKSQxBMGUUpo2QkBYP4xaSHNHO0A%2BIRs5ZjqGfVInITtlLmdnUjT8lxo0Xj4ZMCQYIwsXHTgCDiQ4XTtGazsdA2xs29ts2QADAAAAAAaABmwAAwAOACoAAAERIREBFgYrASImNDYyFgERIRE0JiMiBgcGFREhEhAvASEVIz4DMzIWAd3%2BtgFfAWdUAlJkZ6ZkBI%2F%2Bt1FWP1UVC%2F63AgEBAUkCFCpHZz%2Br0ASP%2FCED3wEySWJik2Fh%2FN39yAISaXdFMx4z%2FdcBjwHwMDCQIDA4H%2BMAAAEAAAAABpQGAAAxAAABBgcWFRQCDgEEIyAnFjMyNy4BJxYzMjcuAT0BFhcuATU0NxYEFyY1NDYzMhc2NwYHNgaUQ18BTJvW%2FtKs%2FvHhIyvhsGmmHyEcKypwk0ROQk4seQFbxgi9hoxgbWAlaV0FaGJFDhyC%2Fv3ut22RBIoCfWEFCxexdQQmAyyOU1hLlbMKJiSGvWYVOXM%2FCgAAAAEAAAAABYAHAAAiAAABFw4BBwYuAzURIzU%2BBDc%2BATsBESEVIREUHgI3NgUwUBewWWitcE4hqEhyRDAUBQEHBPQBTf6yDSBDME4Bz%2B0jPgECOFx4eDoCINcaV11vVy0FB%2F5Y%2FP36HjQ1HgECAAEAAAAABoAGgABKAAABFAIEIyInNj8BHgEzMj4BNTQuASMiDgMVFBYXFj8BNjc2JyY1NDYzMhYVFAYjIiY3PgI1NCYjIgYVFBcDBhcmAjU0EiQgBBIGgM7%2Bn9FvazsTNhRqPXm%2BaHfijmm2f1srUE0eCAgGAgYRM9Gpl6mJaz1KDgglFzYyPlYZYxEEzv7OAWEBogFhzgOA0f6fziBdR9MnOYnwlnLIfjpgfYZDaJ4gDCAfGAYXFD1al9mkg6ruVz0jdVkfMkJyVUkx%2Fl5Ga1sBfOnRAWHOzv6fAAAHAAAAAAcABM8ADgAXACoAPQBQAFoAXQAAARE2HgIHDgEHBiYjJyY3FjY3NiYHERQFFjY3PgE3LgEnIwYfAR4BFw4BFxY2Nz4BNy4BJyMGHwEeARcUBhcWNjc%2BATcuAScjBh8BHgEXDgEFMz8BFTMRIwYDJRUnAxyEzZRbCA2rgketCAEBqlRoCglxYwF%2BIiEOIysBAkswHQEECiQ0AgE%2BYyIhDiIsAQJLMB4BBQokNAE%2FYyIhDiIsAQJLMB4BBQokNAEBPvmD7kHhqs0s0gEnjgHJAv0FD2a9gIrADwUFAwPDAlVMZ3MF%2FpUHwgc1HTyWV325PgsJED%2BoY3G9TAc1HTyWV325PgsJED%2BoY3G9TAc1HTyWV325PgsJED%2BoY3G9UmQBZQMMR%2F61g%2FkBAAAAAAAQAMYAAQAAAAAAAQAHAAAAAQAAAAAAAgAHAAcAAQAAAAAAAwAHAA4AAQAAAAAABAAHABUAAQAAAAAABQALABwAAQAAAAAABgAHACcAAQAAAAAACgArAC4AAQAAAAAACwATAFkAAwABBAkAAQAOAGwAAwABBAkAAgAOAHoAAwABBAkAAwAOAIgAAwABBAkABAAOAJYAAwABBAkABQAWAKQAAwABBAkABgAOALoAAwABBAkACgBWAMgAAwABBAkACwAmAR5WaWRlb0pTUmVndWxhclZpZGVvSlNWaWRlb0pTVmVyc2lvbiAxLjBWaWRlb0pTR2VuZXJhdGVkIGJ5IHN2ZzJ0dGYgZnJvbSBGb250ZWxsbyBwcm9qZWN0Lmh0dHA6Ly9mb250ZWxsby5jb20AVgBpAGQAZQBvAEoAUwBSAGUAZwB1AGwAYQByAFYAaQBkAGUAbwBKAFMAVgBpAGQAZQBvAEoAUwBWAGUAcgBzAGkAbwBuACAAMQAuADAAVgBpAGQAZQBvAEoAUwBHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAGgAdAB0AHAAOgAvAC8AZgBvAG4AdABlAGwAbABvAC4AYwBvAG0AAAACAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAAECAQMBBAEFAQYBBwEIAQkBCgELAQwBDQEOAQ8BEAERARIBEwEUARUBFgEXARgBGQEaARsBHAEdAR4EcGxheQtwbGF5LWNpcmNsZQVwYXVzZQt2b2x1bWUtbXV0ZQp2b2x1bWUtbG93CnZvbHVtZS1taWQLdm9sdW1lLWhpZ2gQZnVsbHNjcmVlbi1lbnRlcg9mdWxsc2NyZWVuLWV4aXQGc3F1YXJlB3NwaW5uZXIJc3VidGl0bGVzCGNhcHRpb25zCGNoYXB0ZXJzBXNoYXJlA2NvZwZjaXJjbGUOY2lyY2xlLW91dGxpbmUTY2lyY2xlLWlubmVyLWNpcmNsZQJoZAZjYW5jZWwGcmVwbGF5CGZhY2Vib29rBWdwbHVzCGxpbmtlZGluB3R3aXR0ZXIGdHVtYmxyCXBpbnRlcmVzdBFhdWRpby1kZXNjcmlwdGlvbgAAAAAA%29%20format%28%22truetype%22%29%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dplay%2C%20%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dcontrol%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dplay%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dcontrol%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%81%22%3B%20%7D%0A%2Evjs%2Dicon%2Dplay%2Dcircle%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dplay%2Dcircle%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%82%22%3B%20%7D%0A%2Evjs%2Dicon%2Dpause%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dcontrol%2Evjs%2Dplaying%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dpause%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dcontrol%2Evjs%2Dplaying%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%83%22%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dmute%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D0%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D0%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dmute%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D0%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D0%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%84%22%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dlow%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D1%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D1%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dlow%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D1%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D1%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%85%22%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dmid%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D2%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D2%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dmid%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2Evjs%2Dvol%2D2%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dvol%2D2%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%86%22%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dhigh%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dvolume%2Dhigh%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%87%22%3B%20%7D%0A%2Evjs%2Dicon%2Dfullscreen%2Denter%2C%20%2Evideo%2Djs%20%2Evjs%2Dfullscreen%2Dcontrol%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dfullscreen%2Denter%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dfullscreen%2Dcontrol%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%88%22%3B%20%7D%0A%2Evjs%2Dicon%2Dfullscreen%2Dexit%2C%20%2Evideo%2Djs%2Evjs%2Dfullscreen%20%2Evjs%2Dfullscreen%2Dcontrol%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dfullscreen%2Dexit%3Abefore%2C%20%2Evideo%2Djs%2Evjs%2Dfullscreen%20%2Evjs%2Dfullscreen%2Dcontrol%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%89%22%3B%20%7D%0A%2Evjs%2Dicon%2Dsquare%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dsquare%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8A%22%3B%20%7D%0A%2Evjs%2Dicon%2Dspinner%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dspinner%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8B%22%3B%20%7D%0A%2Evjs%2Dicon%2Dsubtitles%2C%20%2Evideo%2Djs%20%2Evjs%2Dsubtitles%2Dbutton%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dsubtitles%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dsubtitles%2Dbutton%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8C%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcaptions%2C%20%2Evideo%2Djs%20%2Evjs%2Dcaptions%2Dbutton%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcaptions%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dcaptions%2Dbutton%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8D%22%3B%20%7D%0A%2Evjs%2Dicon%2Dchapters%2C%20%2Evideo%2Djs%20%2Evjs%2Dchapters%2Dbutton%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dchapters%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dchapters%2Dbutton%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8E%22%3B%20%7D%0A%2Evjs%2Dicon%2Dshare%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dshare%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%8F%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcog%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcog%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%90%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%2C%20%2Evideo%2Djs%20%2Evjs%2Dmouse%2Ddisplay%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%2C%20%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dmouse%2Ddisplay%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dlevel%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%91%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%2Doutline%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%2Doutline%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%92%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%2Dinner%2Dcircle%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcircle%2Dinner%2Dcircle%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%93%22%3B%20%7D%0A%2Evjs%2Dicon%2Dhd%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dhd%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%94%22%3B%20%7D%0A%2Evjs%2Dicon%2Dcancel%2C%20%2Evideo%2Djs%20%2Evjs%2Dcontrol%2Evjs%2Dclose%2Dbutton%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dcancel%3Abefore%2C%20%2Evideo%2Djs%20%2Evjs%2Dcontrol%2Evjs%2Dclose%2Dbutton%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%95%22%3B%20%7D%0A%2Evjs%2Dicon%2Dreplay%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dreplay%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%96%22%3B%20%7D%0A%2Evjs%2Dicon%2Dfacebook%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dfacebook%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%97%22%3B%20%7D%0A%2Evjs%2Dicon%2Dgplus%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dgplus%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%98%22%3B%20%7D%0A%2Evjs%2Dicon%2Dlinkedin%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dlinkedin%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%99%22%3B%20%7D%0A%2Evjs%2Dicon%2Dtwitter%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dtwitter%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%9A%22%3B%20%7D%0A%2Evjs%2Dicon%2Dtumblr%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dtumblr%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%9B%22%3B%20%7D%0A%2Evjs%2Dicon%2Dpinterest%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Dpinterest%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%9C%22%3B%20%7D%0A%2Evjs%2Dicon%2Daudio%2Ddescription%20%7B%0Afont%2Dfamily%3A%20VideoJS%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%20%7D%0A%2Evjs%2Dicon%2Daudio%2Ddescription%3Abefore%20%7B%0Acontent%3A%20%22%EF%84%9D%22%3B%20%7D%0A%2Evideo%2Djs%20%7B%0Adisplay%3A%20block%3B%0Avertical%2Dalign%3A%20top%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Acolor%3A%20%23fff%3B%0Abackground%2Dcolor%3A%20%23000%3B%0Aposition%3A%20relative%3B%0Apadding%3A%200%3B%0Afont%2Dsize%3A%2010px%3B%0Aline%2Dheight%3A%201%3B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dstyle%3A%20normal%3B%0Afont%2Dfamily%3A%20Arial%2C%20Helvetica%2C%20sans%2Dserif%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%20%7D%0A%2Evideo%2Djs%3A%2Dmoz%2Dfull%2Dscreen%20%7B%0Aposition%3A%20absolute%3B%20%7D%0A%2Evideo%2Djs%3A%2Dwebkit%2Dfull%2Dscreen%20%7B%0Awidth%3A%20100%25%20%21important%3B%0Aheight%3A%20100%25%20%21important%3B%20%7D%0A%2Evideo%2Djs%20%2A%2C%0A%2Evideo%2Djs%20%2A%3Abefore%2C%0A%2Evideo%2Djs%20%2A%3Aafter%20%7B%0Abox%2Dsizing%3A%20inherit%3B%20%7D%0A%2Evideo%2Djs%20ul%20%7B%0Afont%2Dfamily%3A%20inherit%3B%0Afont%2Dsize%3A%20inherit%3B%0Aline%2Dheight%3A%20inherit%3B%0Alist%2Dstyle%2Dposition%3A%20outside%3B%0Amargin%2Dleft%3A%200%3B%0Amargin%2Dright%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dfluid%2C%0A%2Evideo%2Djs%2Evjs%2D16%2D9%2C%0A%2Evideo%2Djs%2Evjs%2D4%2D3%20%7B%0Awidth%3A%20100%25%3B%0Amax%2Dwidth%3A%20100%25%3B%0Aheight%3A%200%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2D16%2D9%20%7B%0Apadding%2Dtop%3A%2056%2E25%25%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2D4%2D3%20%7B%0Apadding%2Dtop%3A%2075%25%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dfill%20%7B%0Awidth%3A%20100%25%3B%0Aheight%3A%20100%25%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dtech%20%7B%0Aposition%3A%20absolute%3B%0Atop%3A%200%3B%0Aleft%3A%200%3B%0Awidth%3A%20100%25%3B%0Aheight%3A%20100%25%3B%20%7D%0Abody%2Evjs%2Dfull%2Dwindow%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aheight%3A%20100%25%3B%0Aoverflow%2Dy%3A%20auto%3B%20%7D%0A%2Evjs%2Dfull%2Dwindow%20%2Evideo%2Djs%2Evjs%2Dfullscreen%20%7B%0Aposition%3A%20fixed%3B%0Aoverflow%3A%20hidden%3B%0Az%2Dindex%3A%201000%3B%0Aleft%3A%200%3B%0Atop%3A%200%3B%0Abottom%3A%200%3B%0Aright%3A%200%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dfullscreen%20%7B%0Awidth%3A%20100%25%20%21important%3B%0Aheight%3A%20100%25%20%21important%3B%0Apadding%2Dtop%3A%200%20%21important%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dfullscreen%2Evjs%2Duser%2Dinactive%20%7B%0Acursor%3A%20none%3B%20%7D%0A%2Evjs%2Dhidden%20%7B%0Adisplay%3A%20none%20%21important%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Doffscreen%20%7B%0Aheight%3A%201px%3B%0Aleft%3A%20%2D9999px%3B%0Aposition%3A%20absolute%3B%0Atop%3A%200%3B%0Awidth%3A%201px%3B%20%7D%0A%2Evjs%2Dlock%2Dshowing%20%7B%0Adisplay%3A%20block%20%21important%3B%0Aopacity%3A%201%3B%0Avisibility%3A%20visible%3B%20%7D%0A%2Evjs%2Dno%2Djs%20%7B%0Apadding%3A%2020px%3B%0Acolor%3A%20%23fff%3B%0Abackground%2Dcolor%3A%20%23000%3B%0Afont%2Dsize%3A%2018px%3B%0Afont%2Dfamily%3A%20Arial%2C%20Helvetica%2C%20sans%2Dserif%3B%0Atext%2Dalign%3A%20center%3B%0Awidth%3A%20300px%3B%0Aheight%3A%20150px%3B%0Amargin%3A%200px%20auto%3B%20%7D%0A%2Evjs%2Dno%2Djs%20a%2C%0A%2Evjs%2Dno%2Djs%20a%3Avisited%20%7B%0Acolor%3A%20%2366A8CC%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%20%7B%0Afont%2Dsize%3A%203em%3B%0Aline%2Dheight%3A%201%2E5em%3B%0Aheight%3A%201%2E5em%3B%0Awidth%3A%203em%3B%0Adisplay%3A%20block%3B%0Aposition%3A%20absolute%3B%0Atop%3A%2010px%3B%0Aleft%3A%2010px%3B%0Apadding%3A%200%3B%0Acursor%3A%20pointer%3B%0Aopacity%3A%201%3B%0Aborder%3A%200%2E06666em%20solid%20%23fff%3B%0Abackground%2Dcolor%3A%20%232B333F%3B%0Abackground%2Dcolor%3A%20rgba%2843%2C%2051%2C%2063%2C%200%2E7%29%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%2E3em%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%2E3em%3B%0Aborder%2Dradius%3A%200%2E3em%3B%0A%2Dwebkit%2Dtransition%3A%20all%200%2E4s%3B%0A%2Dmoz%2Dtransition%3A%20all%200%2E4s%3B%0A%2Do%2Dtransition%3A%20all%200%2E4s%3B%0Atransition%3A%20all%200%2E4s%3B%20%7D%0A%2Evjs%2Dbig%2Dplay%2Dcentered%20%2Evjs%2Dbig%2Dplay%2Dbutton%20%7B%0Atop%3A%2050%25%3B%0Aleft%3A%2050%25%3B%0Amargin%2Dtop%3A%20%2D0%2E75em%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%20%7D%0A%2Evideo%2Djs%3Ahover%20%2Evjs%2Dbig%2Dplay%2Dbutton%2C%0A%2Evideo%2Djs%20%2Evjs%2Dbig%2Dplay%2Dbutton%3Afocus%20%7B%0Aoutline%3A%200%3B%0Aborder%2Dcolor%3A%20%23fff%3B%0Abackground%2Dcolor%3A%20%2373859f%3B%0Abackground%2Dcolor%3A%20rgba%28115%2C%20133%2C%20159%2C%200%2E5%29%3B%0A%2Dwebkit%2Dtransition%3A%20all%200s%3B%0A%2Dmoz%2Dtransition%3A%20all%200s%3B%0A%2Do%2Dtransition%3A%20all%200s%3B%0Atransition%3A%20all%200s%3B%20%7D%0A%2Evjs%2Dcontrols%2Ddisabled%20%2Evjs%2Dbig%2Dplay%2Dbutton%2C%0A%2Evjs%2Dhas%2Dstarted%20%2Evjs%2Dbig%2Dplay%2Dbutton%2C%0A%2Evjs%2Dusing%2Dnative%2Dcontrols%20%2Evjs%2Dbig%2Dplay%2Dbutton%2C%0A%2Evjs%2Derror%20%2Evjs%2Dbig%2Dplay%2Dbutton%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20button%20%7B%0Abackground%3A%20none%3B%0Aborder%3A%20none%3B%0Acolor%3A%20inherit%3B%0Adisplay%3A%20inline%2Dblock%3B%0Aoverflow%3A%20visible%3B%0Afont%2Dsize%3A%20inherit%3B%0Aline%2Dheight%3A%20inherit%3B%0Atext%2Dtransform%3A%20none%3B%0Atext%2Ddecoration%3A%20none%3B%0Atransition%3A%20none%3B%0A%2Dwebkit%2Dappearance%3A%20none%3B%0A%2Dmoz%2Dappearance%3A%20none%3B%0Aappearance%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%2Evjs%2Dclose%2Dbutton%20%7B%0Acursor%3A%20pointer%3B%0Aheight%3A%203em%3B%0Aposition%3A%20absolute%3B%0Aright%3A%200%3B%0Atop%3A%200%2E5em%3B%0Az%2Dindex%3A%202%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%20%7B%0Acursor%3A%20pointer%3B%20%7D%0A%2Evjs%2Dmenu%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Adisplay%3A%20block%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20auto%3B%20%7D%0A%2Evjs%2Dscrubbing%20%2Evjs%2Dmenu%2Dbutton%3Ahover%20%2Evjs%2Dmenu%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evjs%2Dmenu%20li%20%7B%0Alist%2Dstyle%3A%20none%3B%0Amargin%3A%200%3B%0Apadding%3A%200%2E2em%200%3B%0Aline%2Dheight%3A%201%2E4em%3B%0Afont%2Dsize%3A%201%2E2em%3B%0Atext%2Dalign%3A%20center%3B%0Atext%2Dtransform%3A%20lowercase%3B%20%7D%0A%2Evjs%2Dmenu%20li%3Afocus%2C%0A%2Evjs%2Dmenu%20li%3Ahover%20%7B%0Aoutline%3A%200%3B%0Abackground%2Dcolor%3A%20%2373859f%3B%0Abackground%2Dcolor%3A%20rgba%28115%2C%20133%2C%20159%2C%200%2E5%29%3B%20%7D%0A%2Evjs%2Dmenu%20li%2Evjs%2Dselected%2C%0A%2Evjs%2Dmenu%20li%2Evjs%2Dselected%3Afocus%2C%0A%2Evjs%2Dmenu%20li%2Evjs%2Dselected%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Acolor%3A%20%232B333F%3B%20%7D%0A%2Evjs%2Dmenu%20li%2Evjs%2Dmenu%2Dtitle%20%7B%0Atext%2Dalign%3A%20center%3B%0Atext%2Dtransform%3A%20uppercase%3B%0Afont%2Dsize%3A%201em%3B%0Aline%2Dheight%3A%202em%3B%0Apadding%3A%200%3B%0Amargin%3A%200%200%200%2E3em%200%3B%0Afont%2Dweight%3A%20bold%3B%0Acursor%3A%20default%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%20%2Evjs%2Dmenu%20%7B%0Adisplay%3A%20none%3B%0Aposition%3A%20absolute%3B%0Abottom%3A%200%3B%0Awidth%3A%2010em%3B%0Aleft%3A%20%2D3em%3B%0Aheight%3A%200em%3B%0Amargin%2Dbottom%3A%201%2E5em%3B%0Aborder%2Dtop%2Dcolor%3A%20rgba%2843%2C%2051%2C%2063%2C%200%2E7%29%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%20%2Evjs%2Dmenu%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Abackground%2Dcolor%3A%20%232B333F%3B%0Abackground%2Dcolor%3A%20rgba%2843%2C%2051%2C%2063%2C%200%2E7%29%3B%0Aposition%3A%20absolute%3B%0Awidth%3A%20100%25%3B%0Abottom%3A%201%2E5em%3B%0Amax%2Dheight%3A%2015em%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%3Ahover%20%2Evjs%2Dmenu%2C%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%20%2Evjs%2Dmenu%2Evjs%2Dlock%2Dshowing%20%7B%0Adisplay%3A%20block%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%20%7B%0A%2Dwebkit%2Dtransition%3A%20all%200%2E4s%3B%0A%2Dmoz%2Dtransition%3A%20all%200%2E4s%3B%0A%2Do%2Dtransition%3A%20all%200%2E4s%3B%0Atransition%3A%20all%200%2E4s%3B%0Aoverflow%3A%20hidden%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%3Abefore%20%7B%0Awidth%3A%202%2E222222222em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%3Ahover%2C%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%3Afocus%2C%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%2Evjs%2Dslider%2Dactive%2C%0A%2Evideo%2Djs%2Evjs%2Dno%2Dflex%20%2Evjs%2Dmenu%2Dbutton%2Dinline%20%7B%0Awidth%3A%2012em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmenu%2Dbutton%2Dinline%2Evjs%2Dslider%2Dactive%20%7B%0A%2Dwebkit%2Dtransition%3A%20none%3B%0A%2Dmoz%2Dtransition%3A%20none%3B%0A%2Do%2Dtransition%3A%20none%3B%0Atransition%3A%20none%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dinline%20%2Evjs%2Dmenu%20%7B%0Aopacity%3A%200%3B%0Aheight%3A%20100%25%3B%0Awidth%3A%20auto%3B%0Aposition%3A%20absolute%3B%0Aleft%3A%202%2E2222222em%3B%0Atop%3A%200%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0A%2Dwebkit%2Dtransition%3A%20all%200%2E4s%3B%0A%2Dmoz%2Dtransition%3A%20all%200%2E4s%3B%0A%2Do%2Dtransition%3A%20all%200%2E4s%3B%0Atransition%3A%20all%200%2E4s%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dinline%3Ahover%20%2Evjs%2Dmenu%2C%0A%2Evjs%2Dmenu%2Dbutton%2Dinline%3Afocus%20%2Evjs%2Dmenu%2C%0A%2Evjs%2Dmenu%2Dbutton%2Dinline%2Evjs%2Dslider%2Dactive%20%2Evjs%2Dmenu%20%7B%0Adisplay%3A%20block%3B%0Aopacity%3A%201%3B%20%7D%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dmenu%2Dbutton%2Dinline%20%2Evjs%2Dmenu%20%7B%0Adisplay%3A%20block%3B%0Aopacity%3A%201%3B%0Aposition%3A%20relative%3B%0Awidth%3A%20auto%3B%20%7D%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dmenu%2Dbutton%2Dinline%3Ahover%20%2Evjs%2Dmenu%2C%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dmenu%2Dbutton%2Dinline%3Afocus%20%2Evjs%2Dmenu%2C%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dmenu%2Dbutton%2Dinline%2Evjs%2Dslider%2Dactive%20%2Evjs%2Dmenu%20%7B%0Awidth%3A%20auto%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dinline%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Awidth%3A%20auto%3B%0Aheight%3A%20100%25%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20hidden%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Adisplay%3A%20none%3B%0Awidth%3A%20100%25%3B%0Aposition%3A%20absolute%3B%0Abottom%3A%200%3B%0Aleft%3A%200%3B%0Aright%3A%200%3B%0Aheight%3A%203%2E0em%3B%0Abackground%2Dcolor%3A%20%232B333F%3B%0Abackground%2Dcolor%3A%20rgba%2843%2C%2051%2C%2063%2C%200%2E7%29%3B%20%7D%0A%2Evjs%2Dhas%2Dstarted%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Adisplay%3A%20%2Dwebkit%2Dbox%3B%0Adisplay%3A%20%2Dwebkit%2Dflex%3B%0Adisplay%3A%20%2Dms%2Dflexbox%3B%0Adisplay%3A%20flex%3B%0Avisibility%3A%20visible%3B%0Aopacity%3A%201%3B%0A%2Dwebkit%2Dtransition%3A%20visibility%200%2E1s%2C%20opacity%200%2E1s%3B%0A%2Dmoz%2Dtransition%3A%20visibility%200%2E1s%2C%20opacity%200%2E1s%3B%0A%2Do%2Dtransition%3A%20visibility%200%2E1s%2C%20opacity%200%2E1s%3B%0Atransition%3A%20visibility%200%2E1s%2C%20opacity%200%2E1s%3B%20%7D%0A%2Evjs%2Dhas%2Dstarted%2Evjs%2Duser%2Dinactive%2Evjs%2Dplaying%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Avisibility%3A%20hidden%3B%0Aopacity%3A%200%3B%0A%2Dwebkit%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0A%2Dmoz%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0A%2Do%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0Atransition%3A%20visibility%201s%2C%20opacity%201s%3B%20%7D%0A%2Evjs%2Dcontrols%2Ddisabled%20%2Evjs%2Dcontrol%2Dbar%2C%0A%2Evjs%2Dusing%2Dnative%2Dcontrols%20%2Evjs%2Dcontrol%2Dbar%2C%0A%2Evjs%2Derror%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Adisplay%3A%20none%20%21important%3B%20%7D%0A%2Evjs%2Daudio%2Evjs%2Dhas%2Dstarted%2Evjs%2Duser%2Dinactive%2Evjs%2Dplaying%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Aopacity%3A%201%3B%0Avisibility%3A%20visible%3B%20%7D%0A%40media%20%EF%BF%BDscreen%20%7B%0A%2Evjs%2Duser%2Dinactive%2Evjs%2Dplaying%20%2Evjs%2Dcontrol%2Dbar%20%3Abefore%20%7B%0Acontent%3A%20%22%22%3B%20%7D%20%7D%0A%2Evjs%2Dhas%2Dstarted%2Evjs%2Dno%2Dflex%20%2Evjs%2Dcontrol%2Dbar%20%7B%0Adisplay%3A%20table%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%20%7B%0Aoutline%3A%20none%3B%0Aposition%3A%20relative%3B%0Atext%2Dalign%3A%20center%3B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0Aheight%3A%20100%25%3B%0Awidth%3A%204em%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Abefore%20%7B%0Afont%2Dsize%3A%201%2E8em%3B%0Aline%2Dheight%3A%201%2E67%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Afocus%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Ahover%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%3Afocus%20%7B%0Atext%2Dshadow%3A%200em%200em%201em%20white%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcontrol%2Dtext%20%7B%0Aborder%3A%200%3B%0Aclip%3A%20rect%280%200%200%200%29%3B%0Aheight%3A%201px%3B%0Amargin%3A%20%2D1px%3B%0Aoverflow%3A%20hidden%3B%0Apadding%3A%200%3B%0Aposition%3A%20absolute%3B%0Awidth%3A%201px%3B%20%7D%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dcontrol%20%7B%0Adisplay%3A%20table%2Dcell%3B%0Avertical%2Dalign%3A%20middle%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcustom%2Dcontrol%2Dspacer%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%20%7B%0A%2Dwebkit%2Dbox%2Dflex%3A%20auto%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20auto%3B%0A%2Dwebkit%2Dflex%3A%20auto%3B%0A%2Dms%2Dflex%3A%20auto%3B%0Aflex%3A%20auto%3B%0Adisplay%3A%20%2Dwebkit%2Dbox%3B%0Adisplay%3A%20%2Dwebkit%2Dflex%3B%0Adisplay%3A%20%2Dms%2Dflexbox%3B%0Adisplay%3A%20flex%3B%0A%2Dwebkit%2Dbox%2Dalign%3A%20center%3B%0A%2Dwebkit%2Dalign%2Ditems%3A%20center%3B%0A%2Dms%2Dflex%2Dalign%3A%20center%3B%0Aalign%2Ditems%3A%20center%3B%20%7D%0A%2Evjs%2Dlive%20%2Evjs%2Dprogress%2Dcontrol%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dholder%20%7B%0A%2Dwebkit%2Dbox%2Dflex%3A%20auto%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20auto%3B%0A%2Dwebkit%2Dflex%3A%20auto%3B%0A%2Dms%2Dflex%3A%20auto%3B%0Aflex%3A%20auto%3B%0A%2Dwebkit%2Dtransition%3A%20all%200%2E2s%3B%0A%2Dmoz%2Dtransition%3A%20all%200%2E2s%3B%0A%2Do%2Dtransition%3A%20all%200%2E2s%3B%0Atransition%3A%20all%200%2E2s%3B%0Aheight%3A%200%2E3em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%3Ahover%20%2Evjs%2Dprogress%2Dholder%20%7B%0Afont%2Dsize%3A%201%2E666666666666666666em%3B%20%7D%0A%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%3Ahover%20%2Evjs%2Dmouse%2Ddisplay%3Aafter%2C%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%3Ahover%20%2Evjs%2Dplay%2Dprogress%3Aafter%20%7B%0Adisplay%3A%20block%3B%0Afont%2Dsize%3A%200%2E6em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dholder%20%2Evjs%2Dplay%2Dprogress%2C%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dholder%20%2Evjs%2Dload%2Dprogress%2C%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dholder%20%2Evjs%2Dload%2Dprogress%20div%20%7B%0Aposition%3A%20absolute%3B%0Adisplay%3A%20block%3B%0Aheight%3A%200%2E3em%3B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0Awidth%3A%200%3B%0Aleft%3A%200%3B%0Atop%3A%200%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmouse%2Ddisplay%3Abefore%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%3Abefore%20%7B%0Aposition%3A%20absolute%3B%0Atop%3A%20%2D0%2E333333333333333em%3B%0Aright%3A%20%2D0%2E5em%3B%0Afont%2Dsize%3A%200%2E9em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmouse%2Ddisplay%3Aafter%2C%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%3Aafter%20%7B%0Adisplay%3A%20none%3B%0Aposition%3A%20absolute%3B%0Atop%3A%20%2D2%2E4em%3B%0Aright%3A%20%2D1%2E5em%3B%0Afont%2Dsize%3A%200%2E9em%3B%0Acolor%3A%20%23000%3B%0Acontent%3A%20attr%28data%2Dcurrent%2Dtime%29%3B%0Apadding%3A%200%2E2em%200%2E5em%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0Abackground%2Dcolor%3A%20rgba%28255%2C%20255%2C%20255%2C%200%2E8%29%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%200%2E3em%3B%0A%2Dmoz%2Dborder%2Dradius%3A%200%2E3em%3B%0Aborder%2Dradius%3A%200%2E3em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%3Abefore%2C%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dprogress%3Aafter%20%7B%0Az%2Dindex%3A%201%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dload%2Dprogress%20%7B%0Abackground%3A%20ligthen%28%2373859f%2C%2025%25%29%3B%0Abackground%3A%20rgba%28115%2C%20133%2C%20159%2C%200%2E5%29%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dload%2Dprogress%20div%20%7B%0Abackground%3A%20ligthen%28%2373859f%2C%2050%25%29%3B%0Abackground%3A%20rgba%28115%2C%20133%2C%20159%2C%200%2E75%29%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dno%2Dflex%20%2Evjs%2Dprogress%2Dcontrol%20%7B%0Awidth%3A%20auto%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%20%7B%0Adisplay%3A%20none%3B%0Aposition%3A%20absolute%3B%0Awidth%3A%201px%3B%0Aheight%3A%20100%25%3B%0Abackground%2Dcolor%3A%20%23000%3B%0Az%2Dindex%3A%201%3B%20%7D%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%20%7B%0Az%2Dindex%3A%200%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%3Ahover%20%2Evjs%2Dmouse%2Ddisplay%20%7B%0Adisplay%3A%20block%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%2C%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%3Aafter%20%7B%0Avisibility%3A%20hidden%3B%0Aopacity%3A%200%3B%0A%2Dwebkit%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0A%2Dmoz%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0A%2Do%2Dtransition%3A%20visibility%201s%2C%20opacity%201s%3B%0Atransition%3A%20visibility%201s%2C%20opacity%201s%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%2Evjs%2Dno%2Dflex%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%2C%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%2Evjs%2Dno%2Dflex%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%3Aafter%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dprogress%2Dcontrol%20%2Evjs%2Dmouse%2Ddisplay%3Aafter%20%7B%0Acolor%3A%20%23fff%3B%0Abackground%2Dcolor%3A%20%23000%3B%0Abackground%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E8%29%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dslider%20%7B%0Aoutline%3A%200%3B%0Aposition%3A%20relative%3B%0Acursor%3A%20pointer%3B%0Apadding%3A%200%3B%0Amargin%3A%200%200%2E45em%200%200%2E45em%3B%0Abackground%2Dcolor%3A%20%2373859f%3B%0Abackground%2Dcolor%3A%20rgba%28115%2C%20133%2C%20159%2C%200%2E5%29%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dslider%3Afocus%20%7B%0Atext%2Dshadow%3A%200em%200em%201em%20white%3B%0A%2Dwebkit%2Dbox%2Dshadow%3A%200%200%201em%20%23fff%3B%0A%2Dmoz%2Dbox%2Dshadow%3A%200%200%201em%20%23fff%3B%0Abox%2Dshadow%3A%200%200%201em%20%23fff%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmute%2Dcontrol%2C%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%20%7B%0Acursor%3A%20pointer%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dcontrol%20%7B%0Awidth%3A%205em%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%0Adisplay%3A%20%2Dwebkit%2Dbox%3B%0Adisplay%3A%20%2Dwebkit%2Dflex%3B%0Adisplay%3A%20%2Dms%2Dflexbox%3B%0Adisplay%3A%20flex%3B%0A%2Dwebkit%2Dbox%2Dalign%3A%20center%3B%0A%2Dwebkit%2Dalign%2Ditems%3A%20center%3B%0A%2Dms%2Dflex%2Dalign%3A%20center%3B%0Aalign%2Ditems%3A%20center%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dbar%20%7B%0Amargin%3A%201%2E35em%3B%20%7D%0A%2Evjs%2Dvolume%2Dbar%2Evjs%2Dslider%2Dhorizontal%20%7B%0Awidth%3A%205em%3B%0Aheight%3A%200%2E3em%3B%20%7D%0A%2Evjs%2Dvolume%2Dbar%2Evjs%2Dslider%2Dvertical%20%7B%0Awidth%3A%200%2E3em%3B%0Aheight%3A%205em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Aposition%3A%20absolute%3B%0Abottom%3A%200%3B%0Aleft%3A%200%3B%0Abackground%2Dcolor%3A%20%23fff%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dvolume%2Dlevel%3Abefore%20%7B%0Aposition%3A%20absolute%3B%0Afont%2Dsize%3A%200%2E9em%3B%20%7D%0A%2Evjs%2Dslider%2Dvertical%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Awidth%3A%200%2E3em%3B%20%7D%0A%2Evjs%2Dslider%2Dvertical%20%2Evjs%2Dvolume%2Dlevel%3Abefore%20%7B%0Atop%3A%20%2D0%2E5em%3B%0Aleft%3A%20%2D0%2E3em%3B%20%7D%0A%2Evjs%2Dslider%2Dhorizontal%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Aheight%3A%200%2E3em%3B%20%7D%0A%2Evjs%2Dslider%2Dhorizontal%20%2Evjs%2Dvolume%2Dlevel%3Abefore%20%7B%0Atop%3A%20%2D0%2E3em%3B%0Aright%3A%20%2D0%2E5em%3B%20%7D%0A%2Evjs%2Dvolume%2Dbar%2Evjs%2Dslider%2Dvertical%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Aheight%3A%20100%25%3B%20%7D%0A%2Evjs%2Dvolume%2Dbar%2Evjs%2Dslider%2Dhorizontal%20%2Evjs%2Dvolume%2Dlevel%20%7B%0Awidth%3A%20100%25%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%2Evjs%2Dvolume%2Dmenu%2Dbutton%20%2Evjs%2Dmenu%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%200%3B%0Aheight%3A%200%3B%0Aborder%2Dtop%2Dcolor%3A%20transparent%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dvertical%20%2Evjs%2Dmenu%20%7B%0Aleft%3A%200%2E5em%3B%0Aheight%3A%208em%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dhorizontal%20%2Evjs%2Dmenu%20%7B%0Aleft%3A%20%2D2em%3B%20%7D%0A%2Evjs%2Dmenu%2Dbutton%2Dpopup%2Evjs%2Dvolume%2Dmenu%2Dbutton%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Aheight%3A%200%3B%0Awidth%3A%200%3B%0Aoverflow%2Dx%3A%20hidden%3B%0Aoverflow%2Dy%3A%20hidden%3B%20%7D%0A%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dvertical%3Ahover%20%2Evjs%2Dmenu%2Dcontent%2C%0A%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dvertical%20%2Evjs%2Dlock%2Dshowing%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Aheight%3A%208em%3B%0Awidth%3A%202%2E9em%3B%20%7D%0A%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dhorizontal%3Ahover%20%2Evjs%2Dmenu%2Dcontent%2C%0A%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Dhorizontal%20%2Evjs%2Dlock%2Dshowing%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Aheight%3A%202%2E9em%3B%0Awidth%3A%208em%3B%20%7D%0A%2Evjs%2Dvolume%2Dmenu%2Dbutton%2Evjs%2Dmenu%2Dbutton%2Dinline%20%2Evjs%2Dmenu%2Dcontent%20%7B%0Abackground%2Dcolor%3A%20transparent%20%21important%3B%20%7D%0A%2Evjs%2Dposter%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Drepeat%3A%20no%2Drepeat%3B%0Abackground%2Dposition%3A%2050%25%2050%25%3B%0Abackground%2Dsize%3A%20contain%3B%0Acursor%3A%20pointer%3B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0Aposition%3A%20absolute%3B%0Atop%3A%200%3B%0Aright%3A%200%3B%0Abottom%3A%200%3B%0Aleft%3A%200%3B%0Aheight%3A%20100%25%3B%20%7D%0A%2Evjs%2Dposter%20img%20%7B%0Adisplay%3A%20block%3B%0Avertical%2Dalign%3A%20middle%3B%0Amargin%3A%200%20auto%3B%0Amax%2Dheight%3A%20100%25%3B%0Apadding%3A%200%3B%0Awidth%3A%20100%25%3B%20%7D%0A%2Evjs%2Dhas%2Dstarted%20%2Evjs%2Dposter%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evjs%2Daudio%2Evjs%2Dhas%2Dstarted%20%2Evjs%2Dposter%20%7B%0Adisplay%3A%20block%3B%20%7D%0A%2Evjs%2Dcontrols%2Ddisabled%20%2Evjs%2Dposter%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evjs%2Dusing%2Dnative%2Dcontrols%20%2Evjs%2Dposter%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dlive%2Dcontrol%20%7B%0Adisplay%3A%20%2Dwebkit%2Dbox%3B%0Adisplay%3A%20%2Dwebkit%2Dflex%3B%0Adisplay%3A%20%2Dms%2Dflexbox%3B%0Adisplay%3A%20flex%3B%0A%2Dwebkit%2Dbox%2Dalign%3A%20flex%2Dstart%3B%0A%2Dwebkit%2Dalign%2Ditems%3A%20flex%2Dstart%3B%0A%2Dms%2Dflex%2Dalign%3A%20flex%2Dstart%3B%0Aalign%2Ditems%3A%20flex%2Dstart%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20auto%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20auto%3B%0A%2Dwebkit%2Dflex%3A%20auto%3B%0A%2Dms%2Dflex%3A%20auto%3B%0Aflex%3A%20auto%3B%0Afont%2Dsize%3A%201em%3B%0Aline%2Dheight%3A%203em%3B%20%7D%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dlive%2Dcontrol%20%7B%0Adisplay%3A%20table%2Dcell%3B%0Awidth%3A%20auto%3B%0Atext%2Dalign%3A%20left%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dtime%2Dcontrol%20%7B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%0Afont%2Dsize%3A%201em%3B%0Aline%2Dheight%3A%203em%3B%20%7D%0A%2Evjs%2Dlive%20%2Evjs%2Dtime%2Dcontrol%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dcurrent%2Dtime%2C%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dcurrent%2Dtime%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dduration%2C%0A%2Evjs%2Dno%2Dflex%20%2Evjs%2Dduration%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evjs%2Dtime%2Ddivider%20%7B%0Adisplay%3A%20none%3B%0Aline%2Dheight%3A%203em%3B%20%7D%0A%2Evjs%2Dlive%20%2Evjs%2Dtime%2Ddivider%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dplay%2Dcontrol%20%7B%0Acursor%3A%20pointer%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%20%7D%0A%2Evjs%2Dtext%2Dtrack%2Ddisplay%20%7B%0Aposition%3A%20absolute%3B%0Abottom%3A%203em%3B%0Aleft%3A%200%3B%0Aright%3A%200%3B%0Atop%3A%200%3B%0Apointer%2Devents%3A%20none%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%2Evjs%2Dplaying%20%2Evjs%2Dtext%2Dtrack%2Ddisplay%20%7B%0Abottom%3A%201em%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dtext%2Dtrack%20%7B%0Afont%2Dsize%3A%201%2E4em%3B%0Atext%2Dalign%3A%20center%3B%0Amargin%2Dbottom%3A%200%2E1em%3B%0Abackground%2Dcolor%3A%20%23000%3B%0Abackground%2Dcolor%3A%20rgba%280%2C%200%2C%200%2C%200%2E5%29%3B%20%7D%0A%2Evjs%2Dsubtitles%20%7B%0Acolor%3A%20%23fff%3B%20%7D%0A%2Evjs%2Dcaptions%20%7B%0Acolor%3A%20%23fc6%3B%20%7D%0A%2Evjs%2Dtt%2Dcue%20%7B%0Adisplay%3A%20block%3B%20%7D%0Avideo%3A%3A%2Dwebkit%2Dmedia%2Dtext%2Dtrack%2Ddisplay%20%7B%0A%2Dmoz%2Dtransform%3A%20translateY%28%2D3em%29%3B%0A%2Dms%2Dtransform%3A%20translateY%28%2D3em%29%3B%0A%2Do%2Dtransform%3A%20translateY%28%2D3em%29%3B%0A%2Dwebkit%2Dtransform%3A%20translateY%28%2D3em%29%3B%0Atransform%3A%20translateY%28%2D3em%29%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Duser%2Dinactive%2Evjs%2Dplaying%20video%3A%3A%2Dwebkit%2Dmedia%2Dtext%2Dtrack%2Ddisplay%20%7B%0A%2Dmoz%2Dtransform%3A%20translateY%28%2D1%2E5em%29%3B%0A%2Dms%2Dtransform%3A%20translateY%28%2D1%2E5em%29%3B%0A%2Do%2Dtransform%3A%20translateY%28%2D1%2E5em%29%3B%0A%2Dwebkit%2Dtransform%3A%20translateY%28%2D1%2E5em%29%3B%0Atransform%3A%20translateY%28%2D1%2E5em%29%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dfullscreen%2Dcontrol%20%7B%0Awidth%3A%203%2E8em%3B%0Acursor%3A%20pointer%3B%0A%2Dwebkit%2Dbox%2Dflex%3A%20none%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20none%3B%0A%2Dwebkit%2Dflex%3A%20none%3B%0A%2Dms%2Dflex%3A%20none%3B%0Aflex%3A%20none%3B%20%7D%0A%2Evjs%2Dplayback%2Drate%20%2Evjs%2Dplayback%2Drate%2Dvalue%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%202%3B%0Aposition%3A%20absolute%3B%0Atop%3A%200%3B%0Aleft%3A%200%3B%0Awidth%3A%20100%25%3B%0Aheight%3A%20100%25%3B%0Atext%2Dalign%3A%20center%3B%20%7D%0A%2Evjs%2Dplayback%2Drate%20%2Evjs%2Dmenu%20%7B%0Awidth%3A%204em%3B%0Aleft%3A%200em%3B%20%7D%0A%2Evjs%2Derror%20%2Evjs%2Derror%2Ddisplay%20%2Evjs%2Dmodal%2Ddialog%2Dcontent%20%7B%0Afont%2Dsize%3A%201%2E4em%3B%0Atext%2Dalign%3A%20center%3B%20%7D%0A%2Evjs%2Derror%20%2Evjs%2Derror%2Ddisplay%3Abefore%20%7B%0Acolor%3A%20%23fff%3B%0Acontent%3A%20%27X%27%3B%0Afont%2Dfamily%3A%20Arial%2C%20Helvetica%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%204em%3B%0Aleft%3A%200%3B%0Aline%2Dheight%3A%201%3B%0Amargin%2Dtop%3A%20%2D0%2E5em%3B%0Aposition%3A%20absolute%3B%0Atext%2Dshadow%3A%200%2E05em%200%2E05em%200%2E1em%20%23000%3B%0Atext%2Dalign%3A%20center%3B%0Atop%3A%2050%25%3B%0Avertical%2Dalign%3A%20middle%3B%0Awidth%3A%20100%25%3B%20%7D%0A%2Evjs%2Dloading%2Dspinner%20%7B%0Adisplay%3A%20none%3B%0Aposition%3A%20absolute%3B%0Atop%3A%2050%25%3B%0Aleft%3A%2050%25%3B%0Amargin%3A%20%2D25px%200%200%20%2D25px%3B%0Aopacity%3A%200%2E85%3B%0Atext%2Dalign%3A%20left%3B%0Aborder%3A%206px%20solid%20rgba%2843%2C%2051%2C%2063%2C%200%2E7%29%3B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Abackground%2Dclip%3A%20padding%2Dbox%3B%0Awidth%3A%2050px%3B%0Aheight%3A%2050px%3B%0Aborder%2Dradius%3A%2025px%3B%20%7D%0A%2Evjs%2Dseeking%20%2Evjs%2Dloading%2Dspinner%2C%0A%2Evjs%2Dwaiting%20%2Evjs%2Dloading%2Dspinner%20%7B%0Adisplay%3A%20block%3B%20%7D%0A%2Evjs%2Dloading%2Dspinner%3Abefore%2C%0A%2Evjs%2Dloading%2Dspinner%3Aafter%20%7B%0Acontent%3A%20%22%22%3B%0Aposition%3A%20absolute%3B%0Amargin%3A%20%2D6px%3B%0Abox%2Dsizing%3A%20inherit%3B%0Awidth%3A%20inherit%3B%0Aheight%3A%20inherit%3B%0Aborder%2Dradius%3A%20inherit%3B%0Aopacity%3A%201%3B%0Aborder%3A%20inherit%3B%0Aborder%2Dcolor%3A%20transparent%3B%0Aborder%2Dtop%2Dcolor%3A%20white%3B%20%7D%0A%2Evjs%2Dseeking%20%2Evjs%2Dloading%2Dspinner%3Abefore%2C%0A%2Evjs%2Dseeking%20%2Evjs%2Dloading%2Dspinner%3Aafter%2C%0A%2Evjs%2Dwaiting%20%2Evjs%2Dloading%2Dspinner%3Abefore%2C%0A%2Evjs%2Dwaiting%20%2Evjs%2Dloading%2Dspinner%3Aafter%20%7B%0A%2Dwebkit%2Danimation%3A%20vjs%2Dspinner%2Dspin%201%2E1s%20cubic%2Dbezier%280%2E6%2C%200%2E2%2C%200%2C%200%2E8%29%20infinite%2C%20vjs%2Dspinner%2Dfade%201%2E1s%20linear%20infinite%3B%0Aanimation%3A%20vjs%2Dspinner%2Dspin%201%2E1s%20cubic%2Dbezier%280%2E6%2C%200%2E2%2C%200%2C%200%2E8%29%20infinite%2C%20vjs%2Dspinner%2Dfade%201%2E1s%20linear%20infinite%3B%20%7D%0A%2Evjs%2Dseeking%20%2Evjs%2Dloading%2Dspinner%3Abefore%2C%0A%2Evjs%2Dwaiting%20%2Evjs%2Dloading%2Dspinner%3Abefore%20%7B%0Aborder%2Dtop%2Dcolor%3A%20white%3B%20%7D%0A%2Evjs%2Dseeking%20%2Evjs%2Dloading%2Dspinner%3Aafter%2C%0A%2Evjs%2Dwaiting%20%2Evjs%2Dloading%2Dspinner%3Aafter%20%7B%0Aborder%2Dtop%2Dcolor%3A%20white%3B%0A%2Dwebkit%2Danimation%2Ddelay%3A%200%2E44s%3B%0Aanimation%2Ddelay%3A%200%2E44s%3B%20%7D%0A%40keyframes%20vjs%2Dspinner%2Dspin%20%7B%0A100%25%20%7B%0Atransform%3A%20rotate%28360deg%29%3B%20%7D%20%7D%0A%40%2Dwebkit%2Dkeyframes%20vjs%2Dspinner%2Dspin%20%7B%0A100%25%20%7B%0A%2Dwebkit%2Dtransform%3A%20rotate%28360deg%29%3B%20%7D%20%7D%0A%40keyframes%20vjs%2Dspinner%2Dfade%20%7B%0A0%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A20%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A35%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20white%3B%20%7D%0A60%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A100%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%20%7D%0A%40%2Dwebkit%2Dkeyframes%20vjs%2Dspinner%2Dfade%20%7B%0A0%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A20%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A35%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20white%3B%20%7D%0A60%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%0A100%25%20%7B%0Aborder%2Dtop%2Dcolor%3A%20%2373859f%3B%20%7D%20%7D%0A%2Evjs%2Dchapters%2Dbutton%20%2Evjs%2Dmenu%20%7B%0Aleft%3A%20%2D10em%3B%0Awidth%3A%200%3B%20%7D%0A%2Evjs%2Dchapters%2Dbutton%20%2Evjs%2Dmenu%20ul%20%7B%0Awidth%3A%2024em%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcustom%2Dcontrol%2Dspacer%20%7B%0A%2Dwebkit%2Dbox%2Dflex%3A%20auto%3B%0A%2Dmoz%2Dbox%2Dflex%3A%20auto%3B%0A%2Dwebkit%2Dflex%3A%20auto%3B%0A%2Dms%2Dflex%3A%20auto%3B%0Aflex%3A%20auto%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%2Evjs%2Dno%2Dflex%20%2Evjs%2Dcustom%2Dcontrol%2Dspacer%20%7B%0Awidth%3A%20auto%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcurrent%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcaptions%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dtime%2Ddivider%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dprogress%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dduration%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dremaining%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dplayback%2Drate%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dmute%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dvolume%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dchapters%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcaptions%2Dbutton%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dsubtitles%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dtiny%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dvolume%2Dmenu%2Dbutton%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcurrent%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcaptions%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dtime%2Ddivider%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dduration%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dremaining%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dplayback%2Drate%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcaptions%2Dbutton%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dmute%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dvolume%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dchapters%2Dbutton%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dsubtitles%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dvolume%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dx%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dfullscreen%2Dcontrol%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcurrent%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dcaptions%2Dbutton%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dtime%2Ddivider%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dduration%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dremaining%2Dtime%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dplayback%2Drate%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dmute%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dvolume%2Dcontrol%2C%20%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dchapters%2Dbutton%2C%0A%2Evideo%2Djs%2Evjs%2Dlayout%2Dsmall%3Anot%28%2Evjs%2Dfullscreen%29%20%2Evjs%2Dsubtitles%2Dbutton%20%7B%0Adisplay%3A%20none%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%7B%0Aposition%3A%20relative%3B%0Atop%3A%201em%3B%0Abackground%2Dcolor%3A%20%232B333F%3B%0Abackground%2Dcolor%3A%20rgba%2843%2C%2051%2C%2063%2C%200%2E75%29%3B%0Acolor%3A%20%23fff%3B%0Amargin%3A%200%20auto%3B%0Apadding%3A%200%2E5em%3B%0Aheight%3A%2015em%3B%0Afont%2Dsize%3A%2012px%3B%0Awidth%3A%2040em%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%20%7B%0Atop%3A%200%3B%0Abottom%3A%202em%3B%0Aleft%3A%200%3B%0Aright%3A%200%3B%0Aposition%3A%20absolute%3B%0Aoverflow%3A%20auto%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dcolors%2C%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dfont%20%7B%0Afloat%3A%20left%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dcolors%3Aafter%2C%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dfont%3Aafter%2C%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dcontrols%3Aafter%20%7B%0Aclear%3A%20both%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksettings%2Dcontrols%20%7B%0Aposition%3A%20absolute%3B%0Abottom%3A%201em%3B%0Aright%3A%201em%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksetting%20%7B%0Amargin%3A%205px%3B%0Apadding%3A%203px%3B%0Amin%2Dheight%3A%2040px%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksetting%20label%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100px%3B%0Amargin%2Dbottom%3A%205px%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksetting%20span%20%7B%0Adisplay%3A%20inline%3B%0Amargin%2Dleft%3A%205px%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksetting%20%3E%20div%20%7B%0Amargin%2Dbottom%3A%205px%3B%0Amin%2Dheight%3A%2020px%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20%2Evjs%2Dtracksetting%20%3E%20div%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0Apadding%2Dbottom%3A%200%3B%0Amin%2Dheight%3A%200%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20label%20%3E%20input%20%7B%0Amargin%2Dright%3A%2010px%3B%20%7D%0A%2Evjs%2Dcaption%2Dsettings%20input%5Btype%3D%22button%22%5D%20%7B%0Awidth%3A%2040px%3B%0Aheight%3A%2040px%3B%20%7D%0A%2Evideo%2Djs%20%2Evjs%2Dmodal%2Ddialog%20%7B%0Abackground%3A%20rgba%280%2C%200%2C%200%2C%200%2E8%29%3B%0Abackground%3A%20%2Dwebkit%2Dlinear%2Dgradient%28%2D90deg%2C%20rgba%280%2C%200%2C%200%2C%200%2E8%29%2C%20rgba%28255%2C%20255%2C%20255%2C%200%29%29%3B%0Abackground%3A%20linear%2Dgradient%28180deg%2C%20rgba%280%2C%200%2C%200%2C%200%2E8%29%2C%20rgba%28255%2C%20255%2C%20255%2C%200%29%29%3B%20%7D%0A%2Evjs%2Dmodal%2Ddialog%20%2Evjs%2Dmodal%2Ddialog%2Dcontent%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0Aline%2Dheight%3A%201%2E5%3B%0Apadding%3A%2020px%2024px%3B%0Az%2Dindex%3A%201%3B%20%7D%0A" rel="stylesheet" />

    <script src="data:application/javascript; charset=utf-8;base64,LyohIGpRdWVyeSB2Mi4yLjEgfCAoYykgalF1ZXJ5IEZvdW5kYXRpb24gfCBqcXVlcnkub3JnL2xpY2Vuc2UgKi8KIWZ1bmN0aW9uKGEsYil7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YS5kb2N1bWVudD9iKGEsITApOmZ1bmN0aW9uKGEpe2lmKCFhLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiBiKGEpfTpiKGEpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQ9YS5kb2N1bWVudCxlPWMuc2xpY2UsZj1jLmNvbmNhdCxnPWMucHVzaCxoPWMuaW5kZXhPZixpPXt9LGo9aS50b1N0cmluZyxrPWkuaGFzT3duUHJvcGVydHksbD17fSxtPSIyLjIuMSIsbj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgbi5mbi5pbml0KGEsYil9LG89L15bXHNcdUZFRkZceEEwXSt8W1xzXHVGRUZGXHhBMF0rJC9nLHA9L14tbXMtLyxxPS8tKFtcZGEtel0pL2dpLHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfTtuLmZuPW4ucHJvdG90eXBlPXtqcXVlcnk6bSxjb25zdHJ1Y3RvcjpuLHNlbGVjdG9yOiIiLGxlbmd0aDowLHRvQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gZS5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPWE/MD5hP3RoaXNbYSt0aGlzLmxlbmd0aF06dGhpc1thXTplLmNhbGwodGhpcyl9LHB1c2hTdGFjazpmdW5jdGlvbihhKXt2YXIgYj1uLm1lcmdlKHRoaXMuY29uc3RydWN0b3IoKSxhKTtyZXR1cm4gYi5wcmV2T2JqZWN0PXRoaXMsYi5jb250ZXh0PXRoaXMuY29udGV4dCxifSxlYWNoOmZ1bmN0aW9uKGEpe3JldHVybiBuLmVhY2godGhpcyxhKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhuLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGUuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sZW5ndGgsYz0rYSsoMD5hP2I6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGM+PTAmJmI+Yz9bdGhpc1tjXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKCl9LHB1c2g6Zyxzb3J0OmMuc29ydCxzcGxpY2U6Yy5zcGxpY2V9LG4uZXh0ZW5kPW4uZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGEsYixjLGQsZSxmLGc9YXJndW1lbnRzWzBdfHx7fSxoPTEsaT1hcmd1bWVudHMubGVuZ3RoLGo9ITE7Zm9yKCJib29sZWFuIj09dHlwZW9mIGcmJihqPWcsZz1hcmd1bWVudHNbaF18fHt9LGgrKyksIm9iamVjdCI9PXR5cGVvZiBnfHxuLmlzRnVuY3Rpb24oZyl8fChnPXt9KSxoPT09aSYmKGc9dGhpcyxoLS0pO2k+aDtoKyspaWYobnVsbCE9KGE9YXJndW1lbnRzW2hdKSlmb3IoYiBpbiBhKWM9Z1tiXSxkPWFbYl0sZyE9PWQmJihqJiZkJiYobi5pc1BsYWluT2JqZWN0KGQpfHwoZT1uLmlzQXJyYXkoZCkpKT8oZT8oZT0hMSxmPWMmJm4uaXNBcnJheShjKT9jOltdKTpmPWMmJm4uaXNQbGFpbk9iamVjdChjKT9jOnt9LGdbYl09bi5leHRlbmQoaixmLGQpKTp2b2lkIDAhPT1kJiYoZ1tiXT1kKSk7cmV0dXJuIGd9LG4uZXh0ZW5kKHtleHBhbmRvOiJqUXVlcnkiKyhtK01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKGEpfSxub29wOmZ1bmN0aW9uKCl7fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKGEpe3JldHVybiJmdW5jdGlvbiI9PT1uLnR5cGUoYSl9LGlzQXJyYXk6QXJyYXkuaXNBcnJheSxpc1dpbmRvdzpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YSYmYT09PWEud2luZG93fSxpc051bWVyaWM6ZnVuY3Rpb24oYSl7dmFyIGI9YSYmYS50b1N0cmluZygpO3JldHVybiFuLmlzQXJyYXkoYSkmJmItcGFyc2VGbG9hdChiKSsxPj0wfSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGEpe3JldHVybiJvYmplY3QiIT09bi50eXBlKGEpfHxhLm5vZGVUeXBlfHxuLmlzV2luZG93KGEpPyExOmEuY29uc3RydWN0b3ImJiFrLmNhbGwoYS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsImlzUHJvdG90eXBlT2YiKT8hMTohMH0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXt2YXIgYjtmb3IoYiBpbiBhKXJldHVybiExO3JldHVybiEwfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2ErIiI6Im9iamVjdCI9PXR5cGVvZiBhfHwiZnVuY3Rpb24iPT10eXBlb2YgYT9pW2ouY2FsbChhKV18fCJvYmplY3QiOnR5cGVvZiBhfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGEpe3ZhciBiLGM9ZXZhbDthPW4udHJpbShhKSxhJiYoMT09PWEuaW5kZXhPZigidXNlIHN0cmljdCIpPyhiPWQuY3JlYXRlRWxlbWVudCgic2NyaXB0IiksYi50ZXh0PWEsZC5oZWFkLmFwcGVuZENoaWxkKGIpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYikpOmMoYSkpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShwLCJtcy0iKS5yZXBsYWNlKHEscil9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIudG9Mb3dlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MDtpZihzKGEpKXtmb3IoYz1hLmxlbmd0aDtjPmQ7ZCsrKWlmKGIuY2FsbChhW2RdLGQsYVtkXSk9PT0hMSlicmVha31lbHNlIGZvcihkIGluIGEpaWYoYi5jYWxsKGFbZF0sZCxhW2RdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOihhKyIiKS5yZXBsYWNlKG8sIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtyZXR1cm4gbnVsbCE9YSYmKHMoT2JqZWN0KGEpKT9uLm1lcmdlKGMsInN0cmluZyI9PXR5cGVvZiBhP1thXTphKTpnLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6aC5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2M+ZDtkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztnPmY7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZz0wLGg9W107aWYocyhhKSlmb3IoZD1hLmxlbmd0aDtkPmc7ZysrKWU9YihhW2ddLGcsYyksbnVsbCE9ZSYmaC5wdXNoKGUpO2Vsc2UgZm9yKGcgaW4gYSllPWIoYVtnXSxnLGMpLG51bGwhPWUmJmgucHVzaChlKTtyZXR1cm4gZi5hcHBseShbXSxoKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxmO3JldHVybiJzdHJpbmciPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxuLmlzRnVuY3Rpb24oYSk/KGQ9ZS5jYWxsKGFyZ3VtZW50cywyKSxmPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxkLmNvbmNhdChlLmNhbGwoYXJndW1lbnRzKSkpfSxmLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8bi5ndWlkKyssZik6dm9pZCAwfSxub3c6RGF0ZS5ub3csc3VwcG9ydDpsfSksImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKG4uZm5bU3ltYm9sLml0ZXJhdG9yXT1jW1N5bWJvbC5pdGVyYXRvcl0pLG4uZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciBTeW1ib2wiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSxiKXtpWyJbb2JqZWN0ICIrYisiXSJdPWIudG9Mb3dlckNhc2UoKX0pO2Z1bmN0aW9uIHMoYSl7dmFyIGI9ISFhJiYibGVuZ3RoImluIGEmJmEubGVuZ3RoLGM9bi50eXBlKGEpO3JldHVybiJmdW5jdGlvbiI9PT1jfHxuLmlzV2luZG93KGEpPyExOiJhcnJheSI9PT1jfHwwPT09Ynx8Im51bWJlciI9PXR5cGVvZiBiJiZiPjAmJmItMSBpbiBhfXZhciB0PWZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoLGksaixrLGwsbSxuLG8scCxxLHIscyx0LHU9InNpenpsZSIrMSpuZXcgRGF0ZSx2PWEuZG9jdW1lbnQsdz0wLHg9MCx5PWdhKCksej1nYSgpLEE9Z2EoKSxCPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1iJiYobD0hMCksMH0sQz0xPDwzMSxEPXt9Lmhhc093blByb3BlcnR5LEU9W10sRj1FLnBvcCxHPUUucHVzaCxIPUUucHVzaCxJPUUuc2xpY2UsSj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSz0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLEw9IltcXHgyMFxcdFxcclxcblxcZl0iLE09Iig/OlxcXFwufFtcXHctXXxbXlxceDAwLVxceGEwXSkrIixOPSJcXFsiK0wrIiooIitNKyIpKD86IitMKyIqKFsqXiR8IX5dPz0pIitMKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrTSsiKSl8KSIrTCsiKlxcXSIsTz0iOigiK00rIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK04rIikqKXwuKilcXCl8KSIsUD1uZXcgUmVnRXhwKEwrIisiLCJnIiksUT1uZXcgUmVnRXhwKCJeIitMKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK0wrIiskIiwiZyIpLFI9bmV3IFJlZ0V4cCgiXiIrTCsiKiwiK0wrIioiKSxTPW5ldyBSZWdFeHAoIl4iK0wrIiooWz4rfl18IitMKyIpIitMKyIqIiksVD1uZXcgUmVnRXhwKCI9IitMKyIqKFteXFxdJ1wiXSo/KSIrTCsiKlxcXSIsImciKSxVPW5ldyBSZWdFeHAoTyksVj1uZXcgUmVnRXhwKCJeIitNKyIkIiksVz17SUQ6bmV3IFJlZ0V4cCgiXiMoIitNKyIpIiksQ0xBU1M6bmV3IFJlZ0V4cCgiXlxcLigiK00rIikiKSxUQUc6bmV3IFJlZ0V4cCgiXigiK00rInxbKl0pIiksQVRUUjpuZXcgUmVnRXhwKCJeIitOKSxQU0VVRE86bmV3IFJlZ0V4cCgiXiIrTyksQ0hJTEQ6bmV3IFJlZ0V4cCgiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIitMKyIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIitMKyIqKD86KFsrLV18KSIrTCsiKihcXGQrKXwpKSIrTCsiKlxcKXwpIiwiaSIpLGJvb2w6bmV3IFJlZ0V4cCgiXig/OiIrSysiKSQiLCJpIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoIl4iK0wrIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrTCsiKigoPzotXFxkKT9cXGQqKSIrTCsiKlxcKXwpKD89W14tXXwkKSIsImkiKX0sWD0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFk9L15oXGQkL2ksWj0vXltee10rXHtccypcW25hdGl2ZSBcdy8sJD0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLF89L1srfl0vLGFhPS8nfFxcL2csYmE9bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9IitMKyI/fCgiK0wrIil8LikiLCJpZyIpLGNhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0iMHgiK2ItNjU1MzY7cmV0dXJuIGQhPT1kfHxjP2I6MD5kP1N0cmluZy5mcm9tQ2hhckNvZGUoZCs2NTUzNik6U3RyaW5nLmZyb21DaGFyQ29kZShkPj4xMHw1NTI5NiwxMDIzJmR8NTYzMjApfSxkYT1mdW5jdGlvbigpe20oKX07dHJ5e0guYXBwbHkoRT1JLmNhbGwodi5jaGlsZE5vZGVzKSx2LmNoaWxkTm9kZXMpLEVbdi5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZWEpe0g9e2FwcGx5OkUubGVuZ3RoP2Z1bmN0aW9uKGEsYil7Ry5hcHBseShhLEkuY2FsbChiKSl9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sZW5ndGgsZD0wO3doaWxlKGFbYysrXT1iW2QrK10pO2EubGVuZ3RoPWMtMX19fWZ1bmN0aW9uIGZhKGEsYixkLGUpe3ZhciBmLGgsaixrLGwsbyxyLHMsdz1iJiZiLm93bmVyRG9jdW1lbnQseD1iP2Iubm9kZVR5cGU6OTtpZihkPWR8fFtdLCJzdHJpbmciIT10eXBlb2YgYXx8IWF8fDEhPT14JiY5IT09eCYmMTEhPT14KXJldHVybiBkO2lmKCFlJiYoKGI/Yi5vd25lckRvY3VtZW50fHxiOnYpIT09biYmbShiKSxiPWJ8fG4scCkpe2lmKDExIT09eCYmKG89JC5leGVjKGEpKSlpZihmPW9bMV0pe2lmKDk9PT14KXtpZighKGo9Yi5nZXRFbGVtZW50QnlJZChmKSkpcmV0dXJuIGQ7aWYoai5pZD09PWYpcmV0dXJuIGQucHVzaChqKSxkfWVsc2UgaWYodyYmKGo9dy5nZXRFbGVtZW50QnlJZChmKSkmJnQoYixqKSYmai5pZD09PWYpcmV0dXJuIGQucHVzaChqKSxkfWVsc2V7aWYob1syXSlyZXR1cm4gSC5hcHBseShkLGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYSkpLGQ7aWYoKGY9b1szXSkmJmMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBILmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGYpKSxkfWlmKGMucXNhJiYhQVthKyIgIl0mJighcXx8IXEudGVzdChhKSkpe2lmKDEhPT14KXc9YixzPWE7ZWxzZSBpZigib2JqZWN0IiE9PWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl7KGs9Yi5nZXRBdHRyaWJ1dGUoImlkIikpP2s9ay5yZXBsYWNlKGFhLCJcXCQmIik6Yi5zZXRBdHRyaWJ1dGUoImlkIixrPXUpLHI9ZyhhKSxoPXIubGVuZ3RoLGw9Vi50ZXN0KGspPyIjIitrOiJbaWQ9JyIraysiJ10iO3doaWxlKGgtLSlyW2hdPWwrIiAiK3FhKHJbaF0pO3M9ci5qb2luKCIsIiksdz1fLnRlc3QoYSkmJm9hKGIucGFyZW50Tm9kZSl8fGJ9aWYocyl0cnl7cmV0dXJuIEguYXBwbHkoZCx3LnF1ZXJ5U2VsZWN0b3JBbGwocykpLGR9Y2F0Y2goeSl7fWZpbmFsbHl7az09PXUmJmIucmVtb3ZlQXR0cmlidXRlKCJpZCIpfX19cmV0dXJuIGkoYS5yZXBsYWNlKFEsIiQxIiksYixkLGUpfWZ1bmN0aW9uIGdhKCl7dmFyIGE9W107ZnVuY3Rpb24gYihjLGUpe3JldHVybiBhLnB1c2goYysiICIpPmQuY2FjaGVMZW5ndGgmJmRlbGV0ZSBiW2Euc2hpZnQoKV0sYltjKyIgIl09ZX1yZXR1cm4gYn1mdW5jdGlvbiBoYShhKXtyZXR1cm4gYVt1XT0hMCxhfWZ1bmN0aW9uIGlhKGEpe3ZhciBiPW4uY3JlYXRlRWxlbWVudCgiZGl2Iik7dHJ5e3JldHVybiEhYShiKX1jYXRjaChjKXtyZXR1cm4hMX1maW5hbGx5e2IucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLGI9bnVsbH19ZnVuY3Rpb24gamEoYSxiKXt2YXIgYz1hLnNwbGl0KCJ8IiksZT1jLmxlbmd0aDt3aGlsZShlLS0pZC5hdHRySGFuZGxlW2NbZV1dPWJ9ZnVuY3Rpb24ga2EoYSxiKXt2YXIgYz1iJiZhLGQ9YyYmMT09PWEubm9kZVR5cGUmJjE9PT1iLm5vZGVUeXBlJiYofmIuc291cmNlSW5kZXh8fEMpLSh+YS5zb3VyY2VJbmRleHx8Qyk7aWYoZClyZXR1cm4gZDtpZihjKXdoaWxlKGM9Yy5uZXh0U2libGluZylpZihjPT09YilyZXR1cm4tMTtyZXR1cm4gYT8xOi0xfWZ1bmN0aW9uIGxhKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWMmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG1hKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKCJpbnB1dCI9PT1jfHwiYnV0dG9uIj09PWMpJiZiLnR5cGU9PT1hfX1mdW5jdGlvbiBuYShhKXtyZXR1cm4gaGEoZnVuY3Rpb24oYil7cmV0dXJuIGI9K2IsaGEoZnVuY3Rpb24oYyxkKXt2YXIgZSxmPWEoW10sYy5sZW5ndGgsYiksZz1mLmxlbmd0aDt3aGlsZShnLS0pY1tlPWZbZ11dJiYoY1tlXT0hKGRbZV09Y1tlXSkpfSl9KX1mdW5jdGlvbiBvYShhKXtyZXR1cm4gYSYmInVuZGVmaW5lZCIhPXR5cGVvZiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lJiZhfWM9ZmEuc3VwcG9ydD17fSxmPWZhLmlzWE1MPWZ1bmN0aW9uKGEpe3ZhciBiPWEmJihhLm93bmVyRG9jdW1lbnR8fGEpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4gYj8iSFRNTCIhPT1iLm5vZGVOYW1lOiExfSxtPWZhLnNldERvY3VtZW50PWZ1bmN0aW9uKGEpe3ZhciBiLGUsZz1hP2Eub3duZXJEb2N1bWVudHx8YTp2O3JldHVybiBnIT09biYmOT09PWcubm9kZVR5cGUmJmcuZG9jdW1lbnRFbGVtZW50PyhuPWcsbz1uLmRvY3VtZW50RWxlbWVudCxwPSFmKG4pLChlPW4uZGVmYXVsdFZpZXcpJiZlLnRvcCE9PWUmJihlLmFkZEV2ZW50TGlzdGVuZXI/ZS5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLGRhLCExKTplLmF0dGFjaEV2ZW50JiZlLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZGEpKSxjLmF0dHJpYnV0ZXM9aWEoZnVuY3Rpb24oYSl7cmV0dXJuIGEuY2xhc3NOYW1lPSJpIiwhYS5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpfSksYy5nZXRFbGVtZW50c0J5VGFnTmFtZT1pYShmdW5jdGlvbihhKXtyZXR1cm4gYS5hcHBlbmRDaGlsZChuLmNyZWF0ZUNvbW1lbnQoIiIpKSwhYS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aH0pLGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1aLnRlc3Qobi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxjLmdldEJ5SWQ9aWEoZnVuY3Rpb24oYSl7cmV0dXJuIG8uYXBwZW5kQ2hpbGQoYSkuaWQ9dSwhbi5nZXRFbGVtZW50c0J5TmFtZXx8IW4uZ2V0RWxlbWVudHNCeU5hbWUodSkubGVuZ3RofSksYy5nZXRCeUlkPyhkLmZpbmQuSUQ9ZnVuY3Rpb24oYSxiKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGIuZ2V0RWxlbWVudEJ5SWQmJnApe3ZhciBjPWIuZ2V0RWxlbWVudEJ5SWQoYSk7cmV0dXJuIGM/W2NdOltdfX0sZC5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKGJhLGNhKTtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0QXR0cmlidXRlKCJpZCIpPT09Yn19KTooZGVsZXRlIGQuZmluZC5JRCxkLmZpbHRlci5JRD1mdW5jdGlvbihhKXt2YXIgYj1hLnJlcGxhY2UoYmEsY2EpO3JldHVybiBmdW5jdGlvbihhKXt2YXIgYz0idW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0QXR0cmlidXRlTm9kZSYmYS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiBjJiZjLnZhbHVlPT09Yn19KSxkLmZpbmQuVEFHPWMuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oYSxiKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWU/Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTpjLnFzYT9iLnF1ZXJ5U2VsZWN0b3JBbGwoYSk6dm9pZCAwfTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT0wLGY9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTtpZigiKiI9PT1hKXt3aGlsZShjPWZbZSsrXSkxPT09Yy5ub2RlVHlwZSYmZC5wdXNoKGMpO3JldHVybiBkfXJldHVybiBmfSxkLmZpbmQuQ0xBU1M9Yy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihhLGIpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZwP2IuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhKTp2b2lkIDB9LHI9W10scT1bXSwoYy5xc2E9Wi50ZXN0KG4ucXVlcnlTZWxlY3RvckFsbCkpJiYoaWEoZnVuY3Rpb24oYSl7by5hcHBlbmRDaGlsZChhKS5pbm5lckhUTUw9IjxhIGlkPSciK3UrIic+PC9hPjxzZWxlY3QgaWQ9JyIrdSsiLVxyXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixhLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZxLnB1c2goIlsqXiRdPSIrTCsiKig/OicnfFwiXCIpIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHxxLnB1c2goIlxcWyIrTCsiKig/OnZhbHVlfCIrSysiKSIpLGEucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK3UrIi1dIikubGVuZ3RofHxxLnB1c2goIn49IiksYS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8cS5wdXNoKCI6Y2hlY2tlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiYSMiK3UrIisqIikubGVuZ3RofHxxLnB1c2goIi4jLitbK35dIil9KSxpYShmdW5jdGlvbihhKXt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7Yi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxhLmFwcGVuZENoaWxkKGIpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZxLnB1c2goIm5hbWUiK0wrIipbKl4kfCF+XT89IiksYS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aHx8cS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHEucHVzaCgiLC4qOiIpfSkpLChjLm1hdGNoZXNTZWxlY3Rvcj1aLnRlc3Qocz1vLm1hdGNoZXN8fG8ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxvLm1vek1hdGNoZXNTZWxlY3Rvcnx8by5vTWF0Y2hlc1NlbGVjdG9yfHxvLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJmlhKGZ1bmN0aW9uKGEpe2MuZGlzY29ubmVjdGVkTWF0Y2g9cy5jYWxsKGEsImRpdiIpLHMuY2FsbChhLCJbcyE9JyddOngiKSxyLnB1c2goIiE9IixPKX0pLHE9cS5sZW5ndGgmJm5ldyBSZWdFeHAocS5qb2luKCJ8IikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKCJ8IikpLGI9Wi50ZXN0KG8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pLHQ9Ynx8Wi50ZXN0KG8uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGM9OT09PWEubm9kZVR5cGU/YS5kb2N1bWVudEVsZW1lbnQ6YSxkPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWR8fCEoIWR8fDEhPT1kLm5vZGVUeXBlfHwhKGMuY29udGFpbnM/Yy5jb250YWlucyhkKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQpKSl9OmZ1bmN0aW9uKGEsYil7aWYoYil3aGlsZShiPWIucGFyZW50Tm9kZSlpZihiPT09YSlyZXR1cm4hMDtyZXR1cm4hMX0sQj1iP2Z1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgZD0hYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbi0hYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtyZXR1cm4gZD9kOihkPShhLm93bmVyRG9jdW1lbnR8fGEpPT09KGIub3duZXJEb2N1bWVudHx8Yik/YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKToxLDEmZHx8IWMuc29ydERldGFjaGVkJiZiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGEpPT09ZD9hPT09bnx8YS5vd25lckRvY3VtZW50PT09diYmdCh2LGEpPy0xOmI9PT1ufHxiLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYik/MTprP0ooayxhKS1KKGssYik6MDo0JmQ/LTE6MSl9OmZ1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgYyxkPTAsZT1hLnBhcmVudE5vZGUsZj1iLnBhcmVudE5vZGUsZz1bYV0saD1bYl07aWYoIWV8fCFmKXJldHVybiBhPT09bj8tMTpiPT09bj8xOmU/LTE6Zj8xOms/SihrLGEpLUooayxiKTowO2lmKGU9PT1mKXJldHVybiBrYShhLGIpO2M9YTt3aGlsZShjPWMucGFyZW50Tm9kZSlnLnVuc2hpZnQoYyk7Yz1iO3doaWxlKGM9Yy5wYXJlbnROb2RlKWgudW5zaGlmdChjKTt3aGlsZShnW2RdPT09aFtkXSlkKys7cmV0dXJuIGQ/a2EoZ1tkXSxoW2RdKTpnW2RdPT09dj8tMTpoW2RdPT09dj8xOjB9LG4pOm59LGZhLm1hdGNoZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZmEoYSxudWxsLG51bGwsYil9LGZhLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGIpe2lmKChhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSxiPWIucmVwbGFjZShULCI9JyQxJ10iKSxjLm1hdGNoZXNTZWxlY3RvciYmcCYmIUFbYisiICJdJiYoIXJ8fCFyLnRlc3QoYikpJiYoIXF8fCFxLnRlc3QoYikpKXRyeXt2YXIgZD1zLmNhbGwoYSxiKTtpZihkfHxjLmRpc2Nvbm5lY3RlZE1hdGNofHxhLmRvY3VtZW50JiYxMSE9PWEuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIGR9Y2F0Y2goZSl7fXJldHVybiBmYShiLG4sbnVsbCxbYV0pLmxlbmd0aD4wfSxmYS5jb250YWlucz1mdW5jdGlvbihhLGIpe3JldHVybihhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSx0KGEsYil9LGZhLmF0dHI9ZnVuY3Rpb24oYSxiKXsoYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSk7dmFyIGU9ZC5hdHRySGFuZGxlW2IudG9Mb3dlckNhc2UoKV0sZj1lJiZELmNhbGwoZC5hdHRySGFuZGxlLGIudG9Mb3dlckNhc2UoKSk/ZShhLGIsIXApOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09Zj9mOmMuYXR0cmlidXRlc3x8IXA/YS5nZXRBdHRyaWJ1dGUoYik6KGY9YS5nZXRBdHRyaWJ1dGVOb2RlKGIpKSYmZi5zcGVjaWZpZWQ/Zi52YWx1ZTpudWxsfSxmYS5lcnJvcj1mdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrYSl9LGZhLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZD1bXSxlPTAsZj0wO2lmKGw9IWMuZGV0ZWN0RHVwbGljYXRlcyxrPSFjLnNvcnRTdGFibGUmJmEuc2xpY2UoMCksYS5zb3J0KEIpLGwpe3doaWxlKGI9YVtmKytdKWI9PT1hW2ZdJiYoZT1kLnB1c2goZikpO3doaWxlKGUtLSlhLnNwbGljZShkW2VdLDEpfXJldHVybiBrPW51bGwsYX0sZT1mYS5nZXRUZXh0PWZ1bmN0aW9uKGEpe3ZhciBiLGM9IiIsZD0wLGY9YS5ub2RlVHlwZTtpZihmKXtpZigxPT09Znx8OT09PWZ8fDExPT09Zil7aWYoInN0cmluZyI9PXR5cGVvZiBhLnRleHRDb250ZW50KXJldHVybiBhLnRleHRDb250ZW50O2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZyljKz1lKGEpfWVsc2UgaWYoMz09PWZ8fDQ9PT1mKXJldHVybiBhLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKGI9YVtkKytdKWMrPWUoYik7cmV0dXJuIGN9LGQ9ZmEuc2VsZWN0b3JzPXtjYWNoZUxlbmd0aDo1MCxjcmVhdGVQc2V1ZG86aGEsbWF0Y2g6VyxhdHRySGFuZGxlOnt9LGZpbmQ6e30scmVsYXRpdmU6eyI+Ijp7ZGlyOiJwYXJlbnROb2RlIixmaXJzdDohMH0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDohMH0sIn4iOntkaXI6InByZXZpb3VzU2libGluZyJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS5yZXBsYWNlKGJhLGNhKSxhWzNdPShhWzNdfHxhWzRdfHxhWzVdfHwiIikucmVwbGFjZShiYSxjYSksIn49Ij09PWFbMl0mJihhWzNdPSIgIithWzNdKyIgIiksYS5zbGljZSgwLDQpfSxDSElMRDpmdW5jdGlvbihhKXtyZXR1cm4gYVsxXT1hWzFdLnRvTG93ZXJDYXNlKCksIm50aCI9PT1hWzFdLnNsaWNlKDAsMyk/KGFbM118fGZhLmVycm9yKGFbMF0pLGFbNF09KyhhWzRdP2FbNV0rKGFbNl18fDEpOjIqKCJldmVuIj09PWFbM118fCJvZGQiPT09YVszXSkpLGFbNV09KyhhWzddK2FbOF18fCJvZGQiPT09YVszXSkpOmFbM10mJmZhLmVycm9yKGFbMF0pLGF9LFBTRVVETzpmdW5jdGlvbihhKXt2YXIgYixjPSFhWzZdJiZhWzJdO3JldHVybiBXLkNISUxELnRlc3QoYVswXSk/bnVsbDooYVszXT9hWzJdPWFbNF18fGFbNV18fCIiOmMmJlUudGVzdChjKSYmKGI9ZyhjLCEwKSkmJihiPWMuaW5kZXhPZigiKSIsYy5sZW5ndGgtYiktYy5sZW5ndGgpJiYoYVswXT1hWzBdLnNsaWNlKDAsYiksYVsyXT1jLnNsaWNlKDAsYikpLGEuc2xpY2UoMCwzKSl9fSxmaWx0ZXI6e1RBRzpmdW5jdGlvbihhKXt2YXIgYj1hLnJlcGxhY2UoYmEsY2EpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIioiPT09YT9mdW5jdGlvbigpe3JldHVybiEwfTpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yn19LENMQVNTOmZ1bmN0aW9uKGEpe3ZhciBiPXlbYSsiICJdO3JldHVybiBifHwoYj1uZXcgUmVnRXhwKCIoXnwiK0wrIikiK2ErIigiK0wrInwkKSIpKSYmeShhLGZ1bmN0aW9uKGEpe3JldHVybiBiLnRlc3QoInN0cmluZyI9PXR5cGVvZiBhLmNsYXNzTmFtZSYmYS5jbGFzc05hbWV8fCJ1bmRlZmluZWQiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIil9KX0sQVRUUjpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlPWZhLmF0dHIoZCxhKTtyZXR1cm4gbnVsbD09ZT8iIT0iPT09YjpiPyhlKz0iIiwiPSI9PT1iP2U9PT1jOiIhPSI9PT1iP2UhPT1jOiJePSI9PT1iP2MmJjA9PT1lLmluZGV4T2YoYyk6Iio9Ij09PWI/YyYmZS5pbmRleE9mKGMpPi0xOiIkPSI9PT1iP2MmJmUuc2xpY2UoLWMubGVuZ3RoKT09PWM6In49Ij09PWI/KCIgIitlLnJlcGxhY2UoUCwiICIpKyIgIikuaW5kZXhPZihjKT4tMToifD0iPT09Yj9lPT09Y3x8ZS5zbGljZSgwLGMubGVuZ3RoKzEpPT09YysiLSI6ITEpOiEwfX0sQ0hJTEQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj0ibnRoIiE9PWEuc2xpY2UoMCwzKSxnPSJsYXN0IiE9PWEuc2xpY2UoLTQpLGg9Im9mLXR5cGUiPT09YjtyZXR1cm4gMT09PWQmJjA9PT1lP2Z1bmN0aW9uKGEpe3JldHVybiEhYS5wYXJlbnROb2RlfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG0sbixvLHA9ZiE9PWc/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIixxPWIucGFyZW50Tm9kZSxyPWgmJmIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxzPSFpJiYhaCx0PSExO2lmKHEpe2lmKGYpe3doaWxlKHApe209Yjt3aGlsZShtPW1bcF0paWYoaD9tLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1yOjE9PT1tLm5vZGVUeXBlKXJldHVybiExO289cD0ib25seSI9PT1hJiYhbyYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihvPVtnP3EuZmlyc3RDaGlsZDpxLmxhc3RDaGlsZF0sZyYmcyl7bT1xLGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGo9a1thXXx8W10sbj1qWzBdPT09dyYmalsxXSx0PW4mJmpbMl0sbT1uJiZxLmNoaWxkTm9kZXNbbl07d2hpbGUobT0rK24mJm0mJm1bcF18fCh0PW49MCl8fG8ucG9wKCkpaWYoMT09PW0ubm9kZVR5cGUmJisrdCYmbT09PWIpe2tbYV09W3csbix0XTticmVha319ZWxzZSBpZihzJiYobT1iLGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGo9a1thXXx8W10sbj1qWzBdPT09dyYmalsxXSx0PW4pLHQ9PT0hMSl3aGlsZShtPSsrbiYmbSYmbVtwXXx8KHQ9bj0wKXx8by5wb3AoKSlpZigoaD9tLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1yOjE9PT1tLm5vZGVUeXBlKSYmKyt0JiYocyYmKGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGtbYV09W3csdF0pLG09PT1iKSlicmVhaztyZXR1cm4gdC09ZSx0PT09ZHx8dCVkPT09MCYmdC9kPj0wfX19LFBTRVVETzpmdW5jdGlvbihhLGIpe3ZhciBjLGU9ZC5wc2V1ZG9zW2FdfHxkLnNldEZpbHRlcnNbYS50b0xvd2VyQ2FzZSgpXXx8ZmEuZXJyb3IoInVuc3VwcG9ydGVkIHBzZXVkbzogIithKTtyZXR1cm4gZVt1XT9lKGIpOmUubGVuZ3RoPjE/KGM9W2EsYSwiIixiXSxkLnNldEZpbHRlcnMuaGFzT3duUHJvcGVydHkoYS50b0xvd2VyQ2FzZSgpKT9oYShmdW5jdGlvbihhLGMpe3ZhciBkLGY9ZShhLGIpLGc9Zi5sZW5ndGg7d2hpbGUoZy0tKWQ9SihhLGZbZ10pLGFbZF09IShjW2RdPWZbZ10pfSk6ZnVuY3Rpb24oYSl7cmV0dXJuIGUoYSwwLGMpfSk6ZX19LHBzZXVkb3M6e25vdDpoYShmdW5jdGlvbihhKXt2YXIgYj1bXSxjPVtdLGQ9aChhLnJlcGxhY2UoUSwiJDEiKSk7cmV0dXJuIGRbdV0/aGEoZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsZz1kKGEsbnVsbCxlLFtdKSxoPWEubGVuZ3RoO3doaWxlKGgtLSkoZj1nW2hdKSYmKGFbaF09IShiW2hdPWYpKX0pOmZ1bmN0aW9uKGEsZSxmKXtyZXR1cm4gYlswXT1hLGQoYixudWxsLGYsYyksYlswXT1udWxsLCFjLnBvcCgpfX0pLGhhczpoYShmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGZhKGEsYikubGVuZ3RoPjB9fSksY29udGFpbnM6aGEoZnVuY3Rpb24oYSl7cmV0dXJuIGE9YS5yZXBsYWNlKGJhLGNhKSxmdW5jdGlvbihiKXtyZXR1cm4oYi50ZXh0Q29udGVudHx8Yi5pbm5lclRleHR8fGUoYikpLmluZGV4T2YoYSk+LTF9fSksbGFuZzpoYShmdW5jdGlvbihhKXtyZXR1cm4gVi50ZXN0KGF8fCIiKXx8ZmEuZXJyb3IoInVuc3VwcG9ydGVkIGxhbmc6ICIrYSksYT1hLnJlcGxhY2UoYmEsY2EpLnRvTG93ZXJDYXNlKCksZnVuY3Rpb24oYil7dmFyIGM7ZG8gaWYoYz1wP2IubGFuZzpiLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8Yi5nZXRBdHRyaWJ1dGUoImxhbmciKSlyZXR1cm4gYz1jLnRvTG93ZXJDYXNlKCksYz09PWF8fDA9PT1jLmluZGV4T2YoYSsiLSIpO3doaWxlKChiPWIucGFyZW50Tm9kZSkmJjE9PT1iLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oYil7dmFyIGM9YS5sb2NhdGlvbiYmYS5sb2NhdGlvbi5oYXNoO3JldHVybiBjJiZjLnNsaWNlKDEpPT09Yi5pZH0scm9vdDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW99LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09bi5hY3RpdmVFbGVtZW50JiYoIW4uaGFzRm9jdXN8fG4uaGFzRm9jdXMoKSkmJiEhKGEudHlwZXx8YS5ocmVmfHx+YS50YWJJbmRleCl9LGVuYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMX0sZGlzYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMH0sY2hlY2tlZDpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWImJiEhYS5jaGVja2VkfHwib3B0aW9uIj09PWImJiEhYS5zZWxlY3RlZH0sc2VsZWN0ZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsYS5zZWxlY3RlZD09PSEwfSxlbXB0eTpmdW5jdGlvbihhKXtmb3IoYT1hLmZpcnN0Q2hpbGQ7YTthPWEubmV4dFNpYmxpbmcpaWYoYS5ub2RlVHlwZTw2KXJldHVybiExO3JldHVybiEwfSxwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIWQucHNldWRvcy5lbXB0eShhKX0saGVhZGVyOmZ1bmN0aW9uKGEpe3JldHVybiBZLnRlc3QoYS5ub2RlTmFtZSl9LGlucHV0OmZ1bmN0aW9uKGEpe3JldHVybiBYLnRlc3QoYS5ub2RlTmFtZSl9LGJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWImJiJidXR0b24iPT09YS50eXBlfHwiYnV0dG9uIj09PWJ9LHRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuImlucHV0Ij09PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSYmInRleHQiPT09YS50eXBlJiYobnVsbD09KGI9YS5nZXRBdHRyaWJ1dGUoInR5cGUiKSl8fCJ0ZXh0Ij09PWIudG9Mb3dlckNhc2UoKSl9LGZpcnN0Om5hKGZ1bmN0aW9uKCl7cmV0dXJuWzBdfSksbGFzdDpuYShmdW5jdGlvbihhLGIpe3JldHVybltiLTFdfSksZXE6bmEoZnVuY3Rpb24oYSxiLGMpe3JldHVyblswPmM/YytiOmNdfSksZXZlbjpuYShmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wO2I+YztjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLG9kZDpuYShmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0xO2I+YztjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLGx0Om5hKGZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MD5jP2MrYjpjOy0tZD49MDspYS5wdXNoKGQpO3JldHVybiBhfSksZ3Q6bmEoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wPmM/YytiOmM7KytkPGI7KWEucHVzaChkKTtyZXR1cm4gYX0pfX0sZC5wc2V1ZG9zLm50aD1kLnBzZXVkb3MuZXE7Zm9yKGIgaW57cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pZC5wc2V1ZG9zW2JdPWxhKGIpO2ZvcihiIGlue3N1Ym1pdDohMCxyZXNldDohMH0pZC5wc2V1ZG9zW2JdPW1hKGIpO2Z1bmN0aW9uIHBhKCl7fXBhLnByb3RvdHlwZT1kLmZpbHRlcnM9ZC5wc2V1ZG9zLGQuc2V0RmlsdGVycz1uZXcgcGEsZz1mYS50b2tlbml6ZT1mdW5jdGlvbihhLGIpe3ZhciBjLGUsZixnLGgsaSxqLGs9elthKyIgIl07aWYoaylyZXR1cm4gYj8wOmsuc2xpY2UoMCk7aD1hLGk9W10saj1kLnByZUZpbHRlcjt3aGlsZShoKXsoIWN8fChlPVIuZXhlYyhoKSkpJiYoZSYmKGg9aC5zbGljZShlWzBdLmxlbmd0aCl8fGgpLGkucHVzaChmPVtdKSksYz0hMSwoZT1TLmV4ZWMoaCkpJiYoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZVswXS5yZXBsYWNlKFEsIiAiKX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2ZvcihnIGluIGQuZmlsdGVyKSEoZT1XW2ddLmV4ZWMoaCkpfHxqW2ddJiYhKGU9altnXShlKSl8fChjPWUuc2hpZnQoKSxmLnB1c2goe3ZhbHVlOmMsdHlwZTpnLG1hdGNoZXM6ZX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2lmKCFjKWJyZWFrfXJldHVybiBiP2gubGVuZ3RoOmg/ZmEuZXJyb3IoYSk6eihhLGkpLnNsaWNlKDApfTtmdW5jdGlvbiBxYShhKXtmb3IodmFyIGI9MCxjPWEubGVuZ3RoLGQ9IiI7Yz5iO2IrKylkKz1hW2JdLnZhbHVlO3JldHVybiBkfWZ1bmN0aW9uIHJhKGEsYixjKXt2YXIgZD1iLmRpcixlPWMmJiJwYXJlbnROb2RlIj09PWQsZj14Kys7cmV0dXJuIGIuZmlyc3Q/ZnVuY3Rpb24oYixjLGYpe3doaWxlKGI9YltkXSlpZigxPT09Yi5ub2RlVHlwZXx8ZSlyZXR1cm4gYShiLGMsZil9OmZ1bmN0aW9uKGIsYyxnKXt2YXIgaCxpLGosaz1bdyxmXTtpZihnKXt3aGlsZShiPWJbZF0paWYoKDE9PT1iLm5vZGVUeXBlfHxlKSYmYShiLGMsZykpcmV0dXJuITB9ZWxzZSB3aGlsZShiPWJbZF0paWYoMT09PWIubm9kZVR5cGV8fGUpe2lmKGo9Ylt1XXx8KGJbdV09e30pLGk9altiLnVuaXF1ZUlEXXx8KGpbYi51bmlxdWVJRF09e30pLChoPWlbZF0pJiZoWzBdPT09dyYmaFsxXT09PWYpcmV0dXJuIGtbMl09aFsyXTtpZihpW2RdPWssa1syXT1hKGIsYyxnKSlyZXR1cm4hMH19fWZ1bmN0aW9uIHNhKGEpe3JldHVybiBhLmxlbmd0aD4xP2Z1bmN0aW9uKGIsYyxkKXt2YXIgZT1hLmxlbmd0aDt3aGlsZShlLS0paWYoIWFbZV0oYixjLGQpKXJldHVybiExO3JldHVybiEwfTphWzBdfWZ1bmN0aW9uIHRhKGEsYixjKXtmb3IodmFyIGQ9MCxlPWIubGVuZ3RoO2U+ZDtkKyspZmEoYSxiW2RdLGMpO3JldHVybiBjfWZ1bmN0aW9uIHVhKGEsYixjLGQsZSl7Zm9yKHZhciBmLGc9W10saD0wLGk9YS5sZW5ndGgsaj1udWxsIT1iO2k+aDtoKyspKGY9YVtoXSkmJighY3x8YyhmLGQsZSkpJiYoZy5wdXNoKGYpLGomJmIucHVzaChoKSk7cmV0dXJuIGd9ZnVuY3Rpb24gdmEoYSxiLGMsZCxlLGYpe3JldHVybiBkJiYhZFt1XSYmKGQ9dmEoZCkpLGUmJiFlW3VdJiYoZT12YShlLGYpKSxoYShmdW5jdGlvbihmLGcsaCxpKXt2YXIgaixrLGwsbT1bXSxuPVtdLG89Zy5sZW5ndGgscD1mfHx0YShifHwiKiIsaC5ub2RlVHlwZT9baF06aCxbXSkscT0hYXx8IWYmJmI/cDp1YShwLG0sYSxoLGkpLHI9Yz9lfHwoZj9hOm98fGQpP1tdOmc6cTtpZihjJiZjKHEscixoLGkpLGQpe2o9dWEocixuKSxkKGosW10saCxpKSxrPWoubGVuZ3RoO3doaWxlKGstLSkobD1qW2tdKSYmKHJbbltrXV09IShxW25ba11dPWwpKX1pZihmKXtpZihlfHxhKXtpZihlKXtqPVtdLGs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiZqLnB1c2gocVtrXT1sKTtlKG51bGwscj1bXSxqLGkpfWs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiYoaj1lP0ooZixsKTptW2tdKT4tMSYmKGZbal09IShnW2pdPWwpKX19ZWxzZSByPXVhKHI9PT1nP3Iuc3BsaWNlKG8sci5sZW5ndGgpOnIpLGU/ZShudWxsLGcscixpKTpILmFwcGx5KGcscil9KX1mdW5jdGlvbiB3YShhKXtmb3IodmFyIGIsYyxlLGY9YS5sZW5ndGgsZz1kLnJlbGF0aXZlW2FbMF0udHlwZV0saD1nfHxkLnJlbGF0aXZlWyIgIl0saT1nPzE6MCxrPXJhKGZ1bmN0aW9uKGEpe3JldHVybiBhPT09Yn0saCwhMCksbD1yYShmdW5jdGlvbihhKXtyZXR1cm4gSihiLGEpPi0xfSxoLCEwKSxtPVtmdW5jdGlvbihhLGMsZCl7dmFyIGU9IWcmJihkfHxjIT09ail8fCgoYj1jKS5ub2RlVHlwZT9rKGEsYyxkKTpsKGEsYyxkKSk7cmV0dXJuIGI9bnVsbCxlfV07Zj5pO2krKylpZihjPWQucmVsYXRpdmVbYVtpXS50eXBlXSltPVtyYShzYShtKSxjKV07ZWxzZXtpZihjPWQuZmlsdGVyW2FbaV0udHlwZV0uYXBwbHkobnVsbCxhW2ldLm1hdGNoZXMpLGNbdV0pe2ZvcihlPSsraTtmPmU7ZSsrKWlmKGQucmVsYXRpdmVbYVtlXS50eXBlXSlicmVhaztyZXR1cm4gdmEoaT4xJiZzYShtKSxpPjEmJnFhKGEuc2xpY2UoMCxpLTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09YVtpLTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoUSwiJDEiKSxjLGU+aSYmd2EoYS5zbGljZShpLGUpKSxmPmUmJndhKGE9YS5zbGljZShlKSksZj5lJiZxYShhKSl9bS5wdXNoKGMpfXJldHVybiBzYShtKX1mdW5jdGlvbiB4YShhLGIpe3ZhciBjPWIubGVuZ3RoPjAsZT1hLmxlbmd0aD4wLGY9ZnVuY3Rpb24oZixnLGgsaSxrKXt2YXIgbCxvLHEscj0wLHM9IjAiLHQ9ZiYmW10sdT1bXSx2PWoseD1mfHxlJiZkLmZpbmQuVEFHKCIqIixrKSx5PXcrPW51bGw9PXY/MTpNYXRoLnJhbmRvbSgpfHwuMSx6PXgubGVuZ3RoO2ZvcihrJiYoaj1nPT09bnx8Z3x8ayk7cyE9PXomJm51bGwhPShsPXhbc10pO3MrKyl7aWYoZSYmbCl7bz0wLGd8fGwub3duZXJEb2N1bWVudD09PW58fChtKGwpLGg9IXApO3doaWxlKHE9YVtvKytdKWlmKHEobCxnfHxuLGgpKXtpLnB1c2gobCk7YnJlYWt9ayYmKHc9eSl9YyYmKChsPSFxJiZsKSYmci0tLGYmJnQucHVzaChsKSl9aWYocis9cyxjJiZzIT09cil7bz0wO3doaWxlKHE9YltvKytdKXEodCx1LGcsaCk7aWYoZil7aWYocj4wKXdoaWxlKHMtLSl0W3NdfHx1W3NdfHwodVtzXT1GLmNhbGwoaSkpO3U9dWEodSl9SC5hcHBseShpLHUpLGsmJiFmJiZ1Lmxlbmd0aD4wJiZyK2IubGVuZ3RoPjEmJmZhLnVuaXF1ZVNvcnQoaSl9cmV0dXJuIGsmJih3PXksaj12KSx0fTtyZXR1cm4gYz9oYShmKTpmfXJldHVybiBoPWZhLmNvbXBpbGU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9W10sZj1BW2ErIiAiXTtpZighZil7Ynx8KGI9ZyhhKSksYz1iLmxlbmd0aDt3aGlsZShjLS0pZj13YShiW2NdKSxmW3VdP2QucHVzaChmKTplLnB1c2goZik7Zj1BKGEseGEoZSxkKSksZi5zZWxlY3Rvcj1hfXJldHVybiBmfSxpPWZhLnNlbGVjdD1mdW5jdGlvbihhLGIsZSxmKXt2YXIgaSxqLGssbCxtLG49ImZ1bmN0aW9uIj09dHlwZW9mIGEmJmEsbz0hZiYmZyhhPW4uc2VsZWN0b3J8fGEpO2lmKGU9ZXx8W10sMT09PW8ubGVuZ3RoKXtpZihqPW9bMF09b1swXS5zbGljZSgwKSxqLmxlbmd0aD4yJiYiSUQiPT09KGs9alswXSkudHlwZSYmYy5nZXRCeUlkJiY5PT09Yi5ub2RlVHlwZSYmcCYmZC5yZWxhdGl2ZVtqWzFdLnR5cGVdKXtpZihiPShkLmZpbmQuSUQoay5tYXRjaGVzWzBdLnJlcGxhY2UoYmEsY2EpLGIpfHxbXSlbMF0sIWIpcmV0dXJuIGU7biYmKGI9Yi5wYXJlbnROb2RlKSxhPWEuc2xpY2Uoai5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9aT1XLm5lZWRzQ29udGV4dC50ZXN0KGEpPzA6ai5sZW5ndGg7d2hpbGUoaS0tKXtpZihrPWpbaV0sZC5yZWxhdGl2ZVtsPWsudHlwZV0pYnJlYWs7aWYoKG09ZC5maW5kW2xdKSYmKGY9bShrLm1hdGNoZXNbMF0ucmVwbGFjZShiYSxjYSksXy50ZXN0KGpbMF0udHlwZSkmJm9hKGIucGFyZW50Tm9kZSl8fGIpKSl7aWYoai5zcGxpY2UoaSwxKSxhPWYubGVuZ3RoJiZxYShqKSwhYSlyZXR1cm4gSC5hcHBseShlLGYpLGU7YnJlYWt9fX1yZXR1cm4obnx8aChhLG8pKShmLGIsIXAsZSwhYnx8Xy50ZXN0KGEpJiZvYShiLnBhcmVudE5vZGUpfHxiKSxlfSxjLnNvcnRTdGFibGU9dS5zcGxpdCgiIikuc29ydChCKS5qb2luKCIiKT09PXUsYy5kZXRlY3REdXBsaWNhdGVzPSEhbCxtKCksYy5zb3J0RGV0YWNoZWQ9aWEoZnVuY3Rpb24oYSl7cmV0dXJuIDEmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuLmNyZWF0ZUVsZW1lbnQoImRpdiIpKX0pLGlhKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD0iPGEgaHJlZj0nIyc+PC9hPiIsIiMiPT09YS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpfSl8fGphKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGM/dm9pZCAwOmEuZ2V0QXR0cmlidXRlKGIsInR5cGUiPT09Yi50b0xvd2VyQ2FzZSgpPzE6Mil9KSxjLmF0dHJpYnV0ZXMmJmlhKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD0iPGlucHV0Lz4iLGEuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIiksIiI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpfSl8fGphKCJ2YWx1ZSIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjfHwiaW5wdXQiIT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP3ZvaWQgMDphLmRlZmF1bHRWYWx1ZX0pLGlhKGZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKX0pfHxqYShLLGZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gYz92b2lkIDA6YVtiXT09PSEwP2IudG9Mb3dlckNhc2UoKTooZD1hLmdldEF0dHJpYnV0ZU5vZGUoYikpJiZkLnNwZWNpZmllZD9kLnZhbHVlOm51bGx9KSxmYX0oYSk7bi5maW5kPXQsbi5leHByPXQuc2VsZWN0b3JzLG4uZXhwclsiOiJdPW4uZXhwci5wc2V1ZG9zLG4udW5pcXVlU29ydD1uLnVuaXF1ZT10LnVuaXF1ZVNvcnQsbi50ZXh0PXQuZ2V0VGV4dCxuLmlzWE1MRG9jPXQuaXNYTUwsbi5jb250YWlucz10LmNvbnRhaW5zO3ZhciB1PWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1bXSxlPXZvaWQgMCE9PWM7d2hpbGUoKGE9YVtiXSkmJjkhPT1hLm5vZGVUeXBlKWlmKDE9PT1hLm5vZGVUeXBlKXtpZihlJiZuKGEpLmlzKGMpKWJyZWFrO2QucHVzaChhKX1yZXR1cm4gZH0sdj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1bXTthO2E9YS5uZXh0U2libGluZykxPT09YS5ub2RlVHlwZSYmYSE9PWImJmMucHVzaChhKTtyZXR1cm4gY30sdz1uLmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LHg9L148KFtcdy1dKylccypcLz8+KD86PFwvXDE+fCkkLyx5PS9eLlteOiNcW1wuLF0qJC87ZnVuY3Rpb24geihhLGIsYyl7aWYobi5pc0Z1bmN0aW9uKGIpKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiEhYi5jYWxsKGEsZCxhKSE9PWN9KTtpZihiLm5vZGVUeXBlKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYT09PWIhPT1jfSk7aWYoInN0cmluZyI9PXR5cGVvZiBiKXtpZih5LnRlc3QoYikpcmV0dXJuIG4uZmlsdGVyKGIsYSxjKTtiPW4uZmlsdGVyKGIsYSl9cmV0dXJuIG4uZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBoLmNhbGwoYixhKT4tMSE9PWN9KX1uLmZpbHRlcj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YlswXTtyZXR1cm4gYyYmKGE9Ijpub3QoIithKyIpIiksMT09PWIubGVuZ3RoJiYxPT09ZC5ub2RlVHlwZT9uLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGQsYSk/W2RdOltdOm4uZmluZC5tYXRjaGVzKGEsbi5ncmVwKGIsZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfSkpfSxuLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMubGVuZ3RoLGQ9W10sZT10aGlzO2lmKCJzdHJpbmciIT10eXBlb2YgYSlyZXR1cm4gdGhpcy5wdXNoU3RhY2sobihhKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IoYj0wO2M+YjtiKyspaWYobi5jb250YWlucyhlW2JdLHRoaXMpKXJldHVybiEwfSkpO2ZvcihiPTA7Yz5iO2IrKyluLmZpbmQoYSxlW2JdLGQpO3JldHVybiBkPXRoaXMucHVzaFN0YWNrKGM+MT9uLnVuaXF1ZShkKTpkKSxkLnNlbGVjdG9yPXRoaXMuc2VsZWN0b3I/dGhpcy5zZWxlY3RvcisiICIrYTphLGR9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soeih0aGlzLGF8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soeih0aGlzLGF8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEheih0aGlzLCJzdHJpbmciPT10eXBlb2YgYSYmdy50ZXN0KGEpP24oYSk6YXx8W10sITEpLmxlbmd0aH19KTt2YXIgQSxCPS9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKikpJC8sQz1uLmZuLmluaXQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBlLGY7aWYoIWEpcmV0dXJuIHRoaXM7aWYoYz1jfHxBLCJzdHJpbmciPT10eXBlb2YgYSl7aWYoZT0iPCI9PT1hWzBdJiYiPiI9PT1hW2EubGVuZ3RoLTFdJiZhLmxlbmd0aD49Mz9bbnVsbCxhLG51bGxdOkIuZXhlYyhhKSwhZXx8IWVbMV0mJmIpcmV0dXJuIWJ8fGIuanF1ZXJ5PyhifHxjKS5maW5kKGEpOnRoaXMuY29uc3RydWN0b3IoYikuZmluZChhKTtpZihlWzFdKXtpZihiPWIgaW5zdGFuY2VvZiBuP2JbMF06YixuLm1lcmdlKHRoaXMsbi5wYXJzZUhUTUwoZVsxXSxiJiZiLm5vZGVUeXBlP2Iub3duZXJEb2N1bWVudHx8YjpkLCEwKSkseC50ZXN0KGVbMV0pJiZuLmlzUGxhaW5PYmplY3QoYikpZm9yKGUgaW4gYiluLmlzRnVuY3Rpb24odGhpc1tlXSk/dGhpc1tlXShiW2VdKTp0aGlzLmF0dHIoZSxiW2VdKTtyZXR1cm4gdGhpc31yZXR1cm4gZj1kLmdldEVsZW1lbnRCeUlkKGVbMl0pLGYmJmYucGFyZW50Tm9kZSYmKHRoaXMubGVuZ3RoPTEsdGhpc1swXT1mKSx0aGlzLmNvbnRleHQ9ZCx0aGlzLnNlbGVjdG9yPWEsdGhpc31yZXR1cm4gYS5ub2RlVHlwZT8odGhpcy5jb250ZXh0PXRoaXNbMF09YSx0aGlzLmxlbmd0aD0xLHRoaXMpOm4uaXNGdW5jdGlvbihhKT92b2lkIDAhPT1jLnJlYWR5P2MucmVhZHkoYSk6YShuKToodm9pZCAwIT09YS5zZWxlY3RvciYmKHRoaXMuc2VsZWN0b3I9YS5zZWxlY3Rvcix0aGlzLmNvbnRleHQ9YS5jb250ZXh0KSxuLm1ha2VBcnJheShhLHRoaXMpKX07Qy5wcm90b3R5cGU9bi5mbixBPW4oZCk7dmFyIEQ9L14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sRT17Y2hpbGRyZW46ITAsY29udGVudHM6ITAsbmV4dDohMCxwcmV2OiEwfTtuLmZuLmV4dGVuZCh7aGFzOmZ1bmN0aW9uKGEpe3ZhciBiPW4oYSx0aGlzKSxjPWIubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgYT0wO2M+YTthKyspaWYobi5jb250YWlucyh0aGlzLGJbYV0pKXJldHVybiEwfSl9LGNsb3Nlc3Q6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMsZD0wLGU9dGhpcy5sZW5ndGgsZj1bXSxnPXcudGVzdChhKXx8InN0cmluZyIhPXR5cGVvZiBhP24oYSxifHx0aGlzLmNvbnRleHQpOjA7ZT5kO2QrKylmb3IoYz10aGlzW2RdO2MmJmMhPT1iO2M9Yy5wYXJlbnROb2RlKWlmKGMubm9kZVR5cGU8MTEmJihnP2cuaW5kZXgoYyk+LTE6MT09PWMubm9kZVR5cGUmJm4uZmluZC5tYXRjaGVzU2VsZWN0b3IoYyxhKSkpe2YucHVzaChjKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5sZW5ndGg+MT9uLnVuaXF1ZVNvcnQoZik6Zil9LGluZGV4OmZ1bmN0aW9uKGEpe3JldHVybiBhPyJzdHJpbmciPT10eXBlb2YgYT9oLmNhbGwobihhKSx0aGlzWzBdKTpoLmNhbGwodGhpcyxhLmpxdWVyeT9hWzBdOmEpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4udW5pcXVlU29ydChuLm1lcmdlKHRoaXMuZ2V0KCksbihhLGIpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZChudWxsPT1hP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGEpKX19KTtmdW5jdGlvbiBGKGEsYil7d2hpbGUoKGE9YVtiXSkmJjEhPT1hLm5vZGVUeXBlKTtyZXR1cm4gYX1uLmVhY2goe3BhcmVudDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJjExIT09Yi5ub2RlVHlwZT9iOm51bGx9LHBhcmVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIHUoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1KGEsInBhcmVudE5vZGUiLGMpfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBGKGEsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIEYoYSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIHUoYSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihhKXtyZXR1cm4gdShhLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdShhLCJuZXh0U2libGluZyIsYyl9LHByZXZVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHUoYSwicHJldmlvdXNTaWJsaW5nIixjKX0sc2libGluZ3M6ZnVuY3Rpb24oYSl7cmV0dXJuIHYoKGEucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsYSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3JldHVybiB2KGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8bi5tZXJnZShbXSxhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9bi5tYXAodGhpcyxiLGMpO3JldHVybiJVbnRpbCIhPT1hLnNsaWNlKC01KSYmKGQ9YyksZCYmInN0cmluZyI9PXR5cGVvZiBkJiYoZT1uLmZpbHRlcihkLGUpKSx0aGlzLmxlbmd0aD4xJiYoRVthXXx8bi51bmlxdWVTb3J0KGUpLEQudGVzdChhKSYmZS5yZXZlcnNlKCkpLHRoaXMucHVzaFN0YWNrKGUpfX0pO3ZhciBHPS9cUysvZztmdW5jdGlvbiBIKGEpe3ZhciBiPXt9O3JldHVybiBuLmVhY2goYS5tYXRjaChHKXx8W10sZnVuY3Rpb24oYSxjKXtiW2NdPSEwfSksYn1uLkNhbGxiYWNrcz1mdW5jdGlvbihhKXthPSJzdHJpbmciPT10eXBlb2YgYT9IKGEpOm4uZXh0ZW5kKHt9LGEpO3ZhciBiLGMsZCxlLGY9W10sZz1bXSxoPS0xLGk9ZnVuY3Rpb24oKXtmb3IoZT1hLm9uY2UsZD1iPSEwO2cubGVuZ3RoO2g9LTEpe2M9Zy5zaGlmdCgpO3doaWxlKCsraDxmLmxlbmd0aClmW2hdLmFwcGx5KGNbMF0sY1sxXSk9PT0hMSYmYS5zdG9wT25GYWxzZSYmKGg9Zi5sZW5ndGgsYz0hMSl9YS5tZW1vcnl8fChjPSExKSxiPSExLGUmJihmPWM/W106IiIpfSxqPXthZGQ6ZnVuY3Rpb24oKXtyZXR1cm4gZiYmKGMmJiFiJiYoaD1mLmxlbmd0aC0xLGcucHVzaChjKSksZnVuY3Rpb24gZChiKXtuLmVhY2goYixmdW5jdGlvbihiLGMpe24uaXNGdW5jdGlvbihjKT9hLnVuaXF1ZSYmai5oYXMoYyl8fGYucHVzaChjKTpjJiZjLmxlbmd0aCYmInN0cmluZyIhPT1uLnR5cGUoYykmJmQoYyl9KX0oYXJndW1lbnRzKSxjJiYhYiYmaSgpKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gbi5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihhLGIpe3ZhciBjO3doaWxlKChjPW4uaW5BcnJheShiLGYsYykpPi0xKWYuc3BsaWNlKGMsMSksaD49YyYmaC0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGEpe3JldHVybiBhP24uaW5BcnJheShhLGYpPi0xOmYubGVuZ3RoPjB9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIGYmJihmPVtdKSx0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGU9Zz1bXSxmPWM9IiIsdGhpc30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hZn0sbG9jazpmdW5jdGlvbigpe3JldHVybiBlPWc9W10sY3x8KGY9Yz0iIiksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuISFlfSxmaXJlV2l0aDpmdW5jdGlvbihhLGMpe3JldHVybiBlfHwoYz1jfHxbXSxjPVthLGMuc2xpY2U/Yy5zbGljZSgpOmNdLGcucHVzaChjKSxifHxpKCkpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gai5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWR9fTtyZXR1cm4gan0sbi5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGEpe3ZhciBiPVtbInJlc29sdmUiLCJkb25lIixuLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwicmVzb2x2ZWQiXSxbInJlamVjdCIsImZhaWwiLG4uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCJyZWplY3RlZCJdLFsibm90aWZ5IiwicHJvZ3Jlc3MiLG4uQ2FsbGJhY2tzKCJtZW1vcnkiKV1dLGM9InBlbmRpbmciLGQ9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGN9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBlLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sdGhlbjpmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cztyZXR1cm4gbi5EZWZlcnJlZChmdW5jdGlvbihjKXtuLmVhY2goYixmdW5jdGlvbihiLGYpe3ZhciBnPW4uaXNGdW5jdGlvbihhW2JdKSYmYVtiXTtlW2ZbMV1dKGZ1bmN0aW9uKCl7dmFyIGE9ZyYmZy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YSYmbi5pc0Z1bmN0aW9uKGEucHJvbWlzZSk/YS5wcm9taXNlKCkucHJvZ3Jlc3MoYy5ub3RpZnkpLmRvbmUoYy5yZXNvbHZlKS5mYWlsKGMucmVqZWN0KTpjW2ZbMF0rIldpdGgiXSh0aGlzPT09ZD9jLnByb21pc2UoKTp0aGlzLGc/W2FdOmFyZ3VtZW50cyl9KX0pLGE9bnVsbH0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT9uLmV4dGVuZChhLGQpOmR9fSxlPXt9O3JldHVybiBkLnBpcGU9ZC50aGVuLG4uZWFjaChiLGZ1bmN0aW9uKGEsZil7dmFyIGc9ZlsyXSxoPWZbM107ZFtmWzFdXT1nLmFkZCxoJiZnLmFkZChmdW5jdGlvbigpe2M9aH0sYlsxXmFdWzJdLmRpc2FibGUsYlsyXVsyXS5sb2NrKSxlW2ZbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIGVbZlswXSsiV2l0aCJdKHRoaXM9PT1lP2Q6dGhpcyxhcmd1bWVudHMpLHRoaXN9LGVbZlswXSsiV2l0aCJdPWcuZmlyZVdpdGh9KSxkLnByb21pc2UoZSksYSYmYS5jYWxsKGUsZSksZX0sd2hlbjpmdW5jdGlvbihhKXt2YXIgYj0wLGM9ZS5jYWxsKGFyZ3VtZW50cyksZD1jLmxlbmd0aCxmPTEhPT1kfHxhJiZuLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9kOjAsZz0xPT09Zj9hOm4uRGVmZXJyZWQoKSxoPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZCl7YlthXT10aGlzLGNbYV09YXJndW1lbnRzLmxlbmd0aD4xP2UuY2FsbChhcmd1bWVudHMpOmQsYz09PWk/Zy5ub3RpZnlXaXRoKGIsYyk6LS1mfHxnLnJlc29sdmVXaXRoKGIsYyl9fSxpLGosaztpZihkPjEpZm9yKGk9bmV3IEFycmF5KGQpLGo9bmV3IEFycmF5KGQpLGs9bmV3IEFycmF5KGQpO2Q+YjtiKyspY1tiXSYmbi5pc0Z1bmN0aW9uKGNbYl0ucHJvbWlzZSk/Y1tiXS5wcm9taXNlKCkucHJvZ3Jlc3MoaChiLGosaSkpLmRvbmUoaChiLGssYykpLmZhaWwoZy5yZWplY3QpOi0tZjtyZXR1cm4gZnx8Zy5yZXNvbHZlV2l0aChrLGMpLGcucHJvbWlzZSgpfX0pO3ZhciBJO24uZm4ucmVhZHk9ZnVuY3Rpb24oYSl7cmV0dXJuIG4ucmVhZHkucHJvbWlzZSgpLmRvbmUoYSksdGhpc30sbi5leHRlbmQoe2lzUmVhZHk6ITEscmVhZHlXYWl0OjEsaG9sZFJlYWR5OmZ1bmN0aW9uKGEpe2E/bi5yZWFkeVdhaXQrKzpuLnJlYWR5KCEwKX0scmVhZHk6ZnVuY3Rpb24oYSl7KGE9PT0hMD8tLW4ucmVhZHlXYWl0Om4uaXNSZWFkeSl8fChuLmlzUmVhZHk9ITAsYSE9PSEwJiYtLW4ucmVhZHlXYWl0PjB8fChJLnJlc29sdmVXaXRoKGQsW25dKSxuLmZuLnRyaWdnZXJIYW5kbGVyJiYobihkKS50cmlnZ2VySGFuZGxlcigicmVhZHkiKSxuKGQpLm9mZigicmVhZHkiKSkpKX19KTtmdW5jdGlvbiBKKCl7ZC5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixKKSxhLnJlbW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLEopLG4ucmVhZHkoKX1uLnJlYWR5LnByb21pc2U9ZnVuY3Rpb24oYil7cmV0dXJuIEl8fChJPW4uRGVmZXJyZWQoKSwiY29tcGxldGUiPT09ZC5yZWFkeVN0YXRlfHwibG9hZGluZyIhPT1kLnJlYWR5U3RhdGUmJiFkLmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbD9hLnNldFRpbWVvdXQobi5yZWFkeSk6KGQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsSiksYS5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixKKSkpLEkucHJvbWlzZShiKX0sbi5yZWFkeS5wcm9taXNlKCk7dmFyIEs9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyl7dmFyIGg9MCxpPWEubGVuZ3RoLGo9bnVsbD09YztpZigib2JqZWN0Ij09PW4udHlwZShjKSl7ZT0hMDtmb3IoaCBpbiBjKUsoYSxiLGgsY1toXSwhMCxmLGcpfWVsc2UgaWYodm9pZCAwIT09ZCYmKGU9ITAsbi5pc0Z1bmN0aW9uKGQpfHwoZz0hMCksaiYmKGc/KGIuY2FsbChhLGQpLGI9bnVsbCk6KGo9YixiPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gai5jYWxsKG4oYSksYyl9KSksYikpZm9yKDtpPmg7aCsrKWIoYVtoXSxjLGc/ZDpkLmNhbGwoYVtoXSxoLGIoYVtoXSxjKSkpO3JldHVybiBlP2E6aj9iLmNhbGwoYSk6aT9iKGFbMF0sYyk6Zn0sTD1mdW5jdGlvbihhKXtyZXR1cm4gMT09PWEubm9kZVR5cGV8fDk9PT1hLm5vZGVUeXBlfHwhK2Eubm9kZVR5cGV9O2Z1bmN0aW9uIE0oKXt0aGlzLmV4cGFuZG89bi5leHBhbmRvK00udWlkKyt9TS51aWQ9MSxNLnByb3RvdHlwZT17cmVnaXN0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHx7fTtyZXR1cm4gYS5ub2RlVHlwZT9hW3RoaXMuZXhwYW5kb109YzpPYmplY3QuZGVmaW5lUHJvcGVydHkoYSx0aGlzLmV4cGFuZG8se3ZhbHVlOmMsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksYVt0aGlzLmV4cGFuZG9dfSxjYWNoZTpmdW5jdGlvbihhKXtpZighTChhKSlyZXR1cm57fTt2YXIgYj1hW3RoaXMuZXhwYW5kb107cmV0dXJuIGJ8fChiPXt9LEwoYSkmJihhLm5vZGVUeXBlP2FbdGhpcy5leHBhbmRvXT1iOk9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLHRoaXMuZXhwYW5kbyx7dmFsdWU6Yixjb25maWd1cmFibGU6ITB9KSkpLGJ9LHNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT10aGlzLmNhY2hlKGEpO2lmKCJzdHJpbmciPT10eXBlb2YgYillW2JdPWM7ZWxzZSBmb3IoZCBpbiBiKWVbZF09YltkXTtyZXR1cm4gZX0sZ2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHZvaWQgMD09PWI/dGhpcy5jYWNoZShhKTphW3RoaXMuZXhwYW5kb10mJmFbdGhpcy5leHBhbmRvXVtiXX0sYWNjZXNzOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmInN0cmluZyI9PXR5cGVvZiBiJiZ2b2lkIDA9PT1jPyhkPXRoaXMuZ2V0KGEsYiksdm9pZCAwIT09ZD9kOnRoaXMuZ2V0KGEsbi5jYW1lbENhc2UoYikpKToodGhpcy5zZXQoYSxiLGMpLHZvaWQgMCE9PWM/YzpiKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9YVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PWYpe2lmKHZvaWQgMD09PWIpdGhpcy5yZWdpc3RlcihhKTtlbHNle24uaXNBcnJheShiKT9kPWIuY29uY2F0KGIubWFwKG4uY2FtZWxDYXNlKSk6KGU9bi5jYW1lbENhc2UoYiksYiBpbiBmP2Q9W2IsZV06KGQ9ZSxkPWQgaW4gZj9bZF06ZC5tYXRjaChHKXx8W10pKSxjPWQubGVuZ3RoO3doaWxlKGMtLSlkZWxldGUgZltkW2NdXX0odm9pZCAwPT09Ynx8bi5pc0VtcHR5T2JqZWN0KGYpKSYmKGEubm9kZVR5cGU/YVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgYVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9YVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT1iJiYhbi5pc0VtcHR5T2JqZWN0KGIpfX07dmFyIE49bmV3IE0sTz1uZXcgTSxQPS9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sUT0vW0EtWl0vZztmdW5jdGlvbiBSKGEsYixjKXt2YXIgZDtpZih2b2lkIDA9PT1jJiYxPT09YS5ub2RlVHlwZSlpZihkPSJkYXRhLSIrYi5yZXBsYWNlKFEsIi0kJiIpLnRvTG93ZXJDYXNlKCksYz1hLmdldEF0dHJpYnV0ZShkKSwic3RyaW5nIj09dHlwZW9mIGMpe3RyeXtjPSJ0cnVlIj09PWM/ITA6ImZhbHNlIj09PWM/ITE6Im51bGwiPT09Yz9udWxsOitjKyIiPT09Yz8rYzpQLnRlc3QoYyk/bi5wYXJzZUpTT04oYyk6Y31jYXRjaChlKXt9Ty5zZXQoYSxiLGMpOwp9ZWxzZSBjPXZvaWQgMDtyZXR1cm4gY31uLmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gTy5oYXNEYXRhKGEpfHxOLmhhc0RhdGEoYSl9LGRhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBPLmFjY2VzcyhhLGIsYyl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtPLnJlbW92ZShhLGIpfSxfZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIE4uYWNjZXNzKGEsYixjKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtOLnJlbW92ZShhLGIpfX0pLG4uZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpc1swXSxnPWYmJmYuYXR0cmlidXRlcztpZih2b2lkIDA9PT1hKXtpZih0aGlzLmxlbmd0aCYmKGU9Ty5nZXQoZiksMT09PWYubm9kZVR5cGUmJiFOLmdldChmLCJoYXNEYXRhQXR0cnMiKSkpe2M9Zy5sZW5ndGg7d2hpbGUoYy0tKWdbY10mJihkPWdbY10ubmFtZSwwPT09ZC5pbmRleE9mKCJkYXRhLSIpJiYoZD1uLmNhbWVsQ2FzZShkLnNsaWNlKDUpKSxSKGYsZCxlW2RdKSkpO04uc2V0KGYsImhhc0RhdGFBdHRycyIsITApfXJldHVybiBlfXJldHVybiJvYmplY3QiPT10eXBlb2YgYT90aGlzLmVhY2goZnVuY3Rpb24oKXtPLnNldCh0aGlzLGEpfSk6Syh0aGlzLGZ1bmN0aW9uKGIpe3ZhciBjLGQ7aWYoZiYmdm9pZCAwPT09Yil7aWYoYz1PLmdldChmLGEpfHxPLmdldChmLGEucmVwbGFjZShRLCItJCYiKS50b0xvd2VyQ2FzZSgpKSx2b2lkIDAhPT1jKXJldHVybiBjO2lmKGQ9bi5jYW1lbENhc2UoYSksYz1PLmdldChmLGQpLHZvaWQgMCE9PWMpcmV0dXJuIGM7aWYoYz1SKGYsZCx2b2lkIDApLHZvaWQgMCE9PWMpcmV0dXJuIGN9ZWxzZSBkPW4uY2FtZWxDYXNlKGEpLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPU8uZ2V0KHRoaXMsZCk7Ty5zZXQodGhpcyxkLGIpLGEuaW5kZXhPZigiLSIpPi0xJiZ2b2lkIDAhPT1jJiZPLnNldCh0aGlzLGEsYil9KX0sbnVsbCxiLGFyZ3VtZW50cy5sZW5ndGg+MSxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Ty5yZW1vdmUodGhpcyxhKX0pfX0pLG4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIGE/KGI9KGJ8fCJmeCIpKyJxdWV1ZSIsZD1OLmdldChhLGIpLGMmJighZHx8bi5pc0FycmF5KGMpP2Q9Ti5hY2Nlc3MoYSxiLG4ubWFrZUFycmF5KGMpKTpkLnB1c2goYykpLGR8fFtdKTp2b2lkIDB9LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGM9bi5xdWV1ZShhLGIpLGQ9Yy5sZW5ndGgsZT1jLnNoaWZ0KCksZj1uLl9xdWV1ZUhvb2tzKGEsYiksZz1mdW5jdGlvbigpe24uZGVxdWV1ZShhLGIpfTsiaW5wcm9ncmVzcyI9PT1lJiYoZT1jLnNoaWZ0KCksZC0tKSxlJiYoImZ4Ij09PWImJmMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBmLnN0b3AsZS5jYWxsKGEsZyxmKSksIWQmJmYmJmYuZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihhLGIpe3ZhciBjPWIrInF1ZXVlSG9va3MiO3JldHVybiBOLmdldChhLGMpfHxOLmFjY2VzcyhhLGMse2VtcHR5Om4uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe04ucmVtb3ZlKGEsW2IrInF1ZXVlIixjXSl9KX0pfX0pLG4uZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9ImZ4IixjLS0pLGFyZ3VtZW50cy5sZW5ndGg8Yz9uLnF1ZXVlKHRoaXNbMF0sYSk6dm9pZCAwPT09Yj90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPW4ucXVldWUodGhpcyxhLGIpO24uX3F1ZXVlSG9va3ModGhpcyxhKSwiZngiPT09YSYmImlucHJvZ3Jlc3MiIT09Y1swXSYmbi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5kZXF1ZXVlKHRoaXMsYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MSxlPW4uRGVmZXJyZWQoKSxmPXRoaXMsZz10aGlzLmxlbmd0aCxoPWZ1bmN0aW9uKCl7LS1kfHxlLnJlc29sdmVXaXRoKGYsW2ZdKX07InN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxhPWF8fCJmeCI7d2hpbGUoZy0tKWM9Ti5nZXQoZltnXSxhKyJxdWV1ZUhvb2tzIiksYyYmYy5lbXB0eSYmKGQrKyxjLmVtcHR5LmFkZChoKSk7cmV0dXJuIGgoKSxlLnByb21pc2UoYil9fSk7dmFyIFM9L1srLV0/KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLy5zb3VyY2UsVD1uZXcgUmVnRXhwKCJeKD86KFsrLV0pPXwpKCIrUysiKShbYS16JV0qKSQiLCJpIiksVT1bIlRvcCIsIlJpZ2h0IiwiQm90dG9tIiwiTGVmdCJdLFY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1ifHxhLCJub25lIj09PW4uY3NzKGEsImRpc3BsYXkiKXx8IW4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpfTtmdW5jdGlvbiBXKGEsYixjLGQpe3ZhciBlLGY9MSxnPTIwLGg9ZD9mdW5jdGlvbigpe3JldHVybiBkLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiBuLmNzcyhhLGIsIiIpfSxpPWgoKSxqPWMmJmNbM118fChuLmNzc051bWJlcltiXT8iIjoicHgiKSxrPShuLmNzc051bWJlcltiXXx8InB4IiE9PWomJitpKSYmVC5leGVjKG4uY3NzKGEsYikpO2lmKGsmJmtbM10hPT1qKXtqPWp8fGtbM10sYz1jfHxbXSxrPStpfHwxO2RvIGY9Znx8Ii41IixrLz1mLG4uc3R5bGUoYSxiLGsraik7d2hpbGUoZiE9PShmPWgoKS9pKSYmMSE9PWYmJi0tZyl9cmV0dXJuIGMmJihrPStrfHwraXx8MCxlPWNbMV0/aysoY1sxXSsxKSpjWzJdOitjWzJdLGQmJihkLnVuaXQ9aixkLnN0YXJ0PWssZC5lbmQ9ZSkpLGV9dmFyIFg9L14oPzpjaGVja2JveHxyYWRpbykkL2ksWT0vPChbXHc6LV0rKS8sWj0vXiR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksJD17b3B0aW9uOlsxLCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+IiwiPC9zZWxlY3Q+Il0sdGhlYWQ6WzEsIjx0YWJsZT4iLCI8L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sdHI6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLHRkOlszLCI8dGFibGU+PHRib2R5Pjx0cj4iLCI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXSxfZGVmYXVsdDpbMCwiIiwiIl19OyQub3B0Z3JvdXA9JC5vcHRpb24sJC50Ym9keT0kLnRmb290PSQuY29sZ3JvdXA9JC5jYXB0aW9uPSQudGhlYWQsJC50aD0kLnRkO2Z1bmN0aW9uIF8oYSxiKXt2YXIgYz0idW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShifHwiKiIpOiJ1bmRlZmluZWQiIT10eXBlb2YgYS5xdWVyeVNlbGVjdG9yQWxsP2EucXVlcnlTZWxlY3RvckFsbChifHwiKiIpOltdO3JldHVybiB2b2lkIDA9PT1ifHxiJiZuLm5vZGVOYW1lKGEsYik/bi5tZXJnZShbYV0sYyk6Y31mdW5jdGlvbiBhYShhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylOLnNldChhW2NdLCJnbG9iYWxFdmFsIiwhYnx8Ti5nZXQoYltjXSwiZ2xvYmFsRXZhbCIpKX12YXIgYmE9Lzx8JiM/XHcrOy87ZnVuY3Rpb24gY2EoYSxiLGMsZCxlKXtmb3IodmFyIGYsZyxoLGksaixrLGw9Yi5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksbT1bXSxvPTAscD1hLmxlbmd0aDtwPm87bysrKWlmKGY9YVtvXSxmfHwwPT09ZilpZigib2JqZWN0Ij09PW4udHlwZShmKSluLm1lcmdlKG0sZi5ub2RlVHlwZT9bZl06Zik7ZWxzZSBpZihiYS50ZXN0KGYpKXtnPWd8fGwuYXBwZW5kQ2hpbGQoYi5jcmVhdGVFbGVtZW50KCJkaXYiKSksaD0oWS5leGVjKGYpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLGk9JFtoXXx8JC5fZGVmYXVsdCxnLmlubmVySFRNTD1pWzFdK24uaHRtbFByZWZpbHRlcihmKStpWzJdLGs9aVswXTt3aGlsZShrLS0pZz1nLmxhc3RDaGlsZDtuLm1lcmdlKG0sZy5jaGlsZE5vZGVzKSxnPWwuZmlyc3RDaGlsZCxnLnRleHRDb250ZW50PSIifWVsc2UgbS5wdXNoKGIuY3JlYXRlVGV4dE5vZGUoZikpO2wudGV4dENvbnRlbnQ9IiIsbz0wO3doaWxlKGY9bVtvKytdKWlmKGQmJm4uaW5BcnJheShmLGQpPi0xKWUmJmUucHVzaChmKTtlbHNlIGlmKGo9bi5jb250YWlucyhmLm93bmVyRG9jdW1lbnQsZiksZz1fKGwuYXBwZW5kQ2hpbGQoZiksInNjcmlwdCIpLGomJmFhKGcpLGMpe2s9MDt3aGlsZShmPWdbaysrXSlaLnRlc3QoZi50eXBlfHwiIikmJmMucHVzaChmKX1yZXR1cm4gbH0hZnVuY3Rpb24oKXt2YXIgYT1kLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxiPWEuYXBwZW5kQ2hpbGQoZC5jcmVhdGVFbGVtZW50KCJkaXYiKSksYz1kLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7Yy5zZXRBdHRyaWJ1dGUoInR5cGUiLCJyYWRpbyIpLGMuc2V0QXR0cmlidXRlKCJjaGVja2VkIiwiY2hlY2tlZCIpLGMuc2V0QXR0cmlidXRlKCJuYW1lIiwidCIpLGIuYXBwZW5kQ2hpbGQoYyksbC5jaGVja0Nsb25lPWIuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLGIuaW5uZXJIVE1MPSI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+IixsLm5vQ2xvbmVDaGVja2VkPSEhYi5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWV9KCk7dmFyIGRhPS9ea2V5LyxlYT0vXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sZmE9L14oW14uXSopKD86XC4oLispfCkvO2Z1bmN0aW9uIGdhKCl7cmV0dXJuITB9ZnVuY3Rpb24gaGEoKXtyZXR1cm4hMX1mdW5jdGlvbiBpYSgpe3RyeXtyZXR1cm4gZC5hY3RpdmVFbGVtZW50fWNhdGNoKGEpe319ZnVuY3Rpb24gamEoYSxiLGMsZCxlLGYpe3ZhciBnLGg7aWYoIm9iamVjdCI9PXR5cGVvZiBiKXsic3RyaW5nIiE9dHlwZW9mIGMmJihkPWR8fGMsYz12b2lkIDApO2ZvcihoIGluIGIpamEoYSxoLGMsZCxiW2hdLGYpO3JldHVybiBhfWlmKG51bGw9PWQmJm51bGw9PWU/KGU9YyxkPWM9dm9pZCAwKTpudWxsPT1lJiYoInN0cmluZyI9PXR5cGVvZiBjPyhlPWQsZD12b2lkIDApOihlPWQsZD1jLGM9dm9pZCAwKSksZT09PSExKWU9aGE7ZWxzZSBpZighZSlyZXR1cm4gYTtyZXR1cm4gMT09PWYmJihnPWUsZT1mdW5jdGlvbihhKXtyZXR1cm4gbigpLm9mZihhKSxnLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5ndWlkPWcuZ3VpZHx8KGcuZ3VpZD1uLmd1aWQrKykpLGEuZWFjaChmdW5jdGlvbigpe24uZXZlbnQuYWRkKHRoaXMsYixlLGQsYyl9KX1uLmV2ZW50PXtnbG9iYWw6e30sYWRkOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZyxoLGksaixrLGwsbSxvLHAscSxyPU4uZ2V0KGEpO2lmKHIpe2MuaGFuZGxlciYmKGY9YyxjPWYuaGFuZGxlcixlPWYuc2VsZWN0b3IpLGMuZ3VpZHx8KGMuZ3VpZD1uLmd1aWQrKyksKGk9ci5ldmVudHMpfHwoaT1yLmV2ZW50cz17fSksKGc9ci5oYW5kbGUpfHwoZz1yLmhhbmRsZT1mdW5jdGlvbihiKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIG4mJm4uZXZlbnQudHJpZ2dlcmVkIT09Yi50eXBlP24uZXZlbnQuZGlzcGF0Y2guYXBwbHkoYSxhcmd1bWVudHMpOnZvaWQgMH0pLGI9KGJ8fCIiKS5tYXRjaChHKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSloPWZhLmV4ZWMoYltqXSl8fFtdLG89cT1oWzFdLHA9KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxvJiYobD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LG89KGU/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG8sbD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LGs9bi5leHRlbmQoe3R5cGU6byxvcmlnVHlwZTpxLGRhdGE6ZCxoYW5kbGVyOmMsZ3VpZDpjLmd1aWQsc2VsZWN0b3I6ZSxuZWVkc0NvbnRleHQ6ZSYmbi5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGUpLG5hbWVzcGFjZTpwLmpvaW4oIi4iKX0sZiksKG09aVtvXSl8fChtPWlbb109W10sbS5kZWxlZ2F0ZUNvdW50PTAsbC5zZXR1cCYmbC5zZXR1cC5jYWxsKGEsZCxwLGcpIT09ITF8fGEuYWRkRXZlbnRMaXN0ZW5lciYmYS5hZGRFdmVudExpc3RlbmVyKG8sZykpLGwuYWRkJiYobC5hZGQuY2FsbChhLGspLGsuaGFuZGxlci5ndWlkfHwoay5oYW5kbGVyLmd1aWQ9Yy5ndWlkKSksZT9tLnNwbGljZShtLmRlbGVnYXRlQ291bnQrKywwLGspOm0ucHVzaChrKSxuLmV2ZW50Lmdsb2JhbFtvXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG8scCxxLHI9Ti5oYXNEYXRhKGEpJiZOLmdldChhKTtpZihyJiYoaT1yLmV2ZW50cykpe2I9KGJ8fCIiKS5tYXRjaChHKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSlpZihoPWZhLmV4ZWMoYltqXSl8fFtdLG89cT1oWzFdLHA9KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxvKXtsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30sbz0oZD9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8byxtPWlbb118fFtdLGg9aFsyXSYmbmV3IFJlZ0V4cCgiKF58XFwuKSIrcC5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKSxnPWY9bS5sZW5ndGg7d2hpbGUoZi0tKWs9bVtmXSwhZSYmcSE9PWsub3JpZ1R5cGV8fGMmJmMuZ3VpZCE9PWsuZ3VpZHx8aCYmIWgudGVzdChrLm5hbWVzcGFjZSl8fGQmJmQhPT1rLnNlbGVjdG9yJiYoIioqIiE9PWR8fCFrLnNlbGVjdG9yKXx8KG0uc3BsaWNlKGYsMSksay5zZWxlY3RvciYmbS5kZWxlZ2F0ZUNvdW50LS0sbC5yZW1vdmUmJmwucmVtb3ZlLmNhbGwoYSxrKSk7ZyYmIW0ubGVuZ3RoJiYobC50ZWFyZG93biYmbC50ZWFyZG93bi5jYWxsKGEscCxyLmhhbmRsZSkhPT0hMXx8bi5yZW1vdmVFdmVudChhLG8sci5oYW5kbGUpLGRlbGV0ZSBpW29dKX1lbHNlIGZvcihvIGluIGkpbi5ldmVudC5yZW1vdmUoYSxvK2Jbal0sYyxkLCEwKTtuLmlzRW1wdHlPYmplY3QoaSkmJk4ucmVtb3ZlKGEsImhhbmRsZSBldmVudHMiKX19LGRpc3BhdGNoOmZ1bmN0aW9uKGEpe2E9bi5ldmVudC5maXgoYSk7dmFyIGIsYyxkLGYsZyxoPVtdLGk9ZS5jYWxsKGFyZ3VtZW50cyksaj0oTi5nZXQodGhpcywiZXZlbnRzIil8fHt9KVthLnR5cGVdfHxbXSxrPW4uZXZlbnQuc3BlY2lhbFthLnR5cGVdfHx7fTtpZihpWzBdPWEsYS5kZWxlZ2F0ZVRhcmdldD10aGlzLCFrLnByZURpc3BhdGNofHxrLnByZURpc3BhdGNoLmNhbGwodGhpcyxhKSE9PSExKXtoPW4uZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLGEsaiksYj0wO3doaWxlKChmPWhbYisrXSkmJiFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe2EuY3VycmVudFRhcmdldD1mLmVsZW0sYz0wO3doaWxlKChnPWYuaGFuZGxlcnNbYysrXSkmJiFhLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpKCFhLnJuYW1lc3BhY2V8fGEucm5hbWVzcGFjZS50ZXN0KGcubmFtZXNwYWNlKSkmJihhLmhhbmRsZU9iaj1nLGEuZGF0YT1nLmRhdGEsZD0oKG4uZXZlbnQuc3BlY2lhbFtnLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8Zy5oYW5kbGVyKS5hcHBseShmLmVsZW0saSksdm9pZCAwIT09ZCYmKGEucmVzdWx0PWQpPT09ITEmJihhLnByZXZlbnREZWZhdWx0KCksYS5zdG9wUHJvcGFnYXRpb24oKSkpfXJldHVybiBrLnBvc3REaXNwYXRjaCYmay5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLGEpLGEucmVzdWx0fX0saGFuZGxlcnM6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixnPVtdLGg9Yi5kZWxlZ2F0ZUNvdW50LGk9YS50YXJnZXQ7aWYoaCYmaS5ub2RlVHlwZSYmKCJjbGljayIhPT1hLnR5cGV8fGlzTmFOKGEuYnV0dG9uKXx8YS5idXR0b248MSkpZm9yKDtpIT09dGhpcztpPWkucGFyZW50Tm9kZXx8dGhpcylpZigxPT09aS5ub2RlVHlwZSYmKGkuZGlzYWJsZWQhPT0hMHx8ImNsaWNrIiE9PWEudHlwZSkpe2ZvcihkPVtdLGM9MDtoPmM7YysrKWY9YltjXSxlPWYuc2VsZWN0b3IrIiAiLHZvaWQgMD09PWRbZV0mJihkW2VdPWYubmVlZHNDb250ZXh0P24oZSx0aGlzKS5pbmRleChpKT4tMTpuLmZpbmQoZSx0aGlzLG51bGwsW2ldKS5sZW5ndGgpLGRbZV0mJmQucHVzaChmKTtkLmxlbmd0aCYmZy5wdXNoKHtlbGVtOmksaGFuZGxlcnM6ZH0pfXJldHVybiBoPGIubGVuZ3RoJiZnLnB1c2goe2VsZW06dGhpcyxoYW5kbGVyczpiLnNsaWNlKGgpfSksZ30scHJvcHM6ImFsdEtleSBidWJibGVzIGNhbmNlbGFibGUgY3RybEtleSBjdXJyZW50VGFyZ2V0IGRldGFpbCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOiJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLGZpbHRlcjpmdW5jdGlvbihhLGIpe3JldHVybiBudWxsPT1hLndoaWNoJiYoYS53aGljaD1udWxsIT1iLmNoYXJDb2RlP2IuY2hhckNvZGU6Yi5rZXlDb2RlKSxhfX0sbW91c2VIb29rczp7cHJvcHM6ImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxlLGYsZz1iLmJ1dHRvbjtyZXR1cm4gbnVsbD09YS5wYWdlWCYmbnVsbCE9Yi5jbGllbnRYJiYoYz1hLnRhcmdldC5vd25lckRvY3VtZW50fHxkLGU9Yy5kb2N1bWVudEVsZW1lbnQsZj1jLmJvZHksYS5wYWdlWD1iLmNsaWVudFgrKGUmJmUuc2Nyb2xsTGVmdHx8ZiYmZi5zY3JvbGxMZWZ0fHwwKS0oZSYmZS5jbGllbnRMZWZ0fHxmJiZmLmNsaWVudExlZnR8fDApLGEucGFnZVk9Yi5jbGllbnRZKyhlJiZlLnNjcm9sbFRvcHx8ZiYmZi5zY3JvbGxUb3B8fDApLShlJiZlLmNsaWVudFRvcHx8ZiYmZi5jbGllbnRUb3B8fDApKSxhLndoaWNofHx2b2lkIDA9PT1nfHwoYS53aGljaD0xJmc/MToyJmc/Mzo0Jmc/MjowKSxhfX0sZml4OmZ1bmN0aW9uKGEpe2lmKGFbbi5leHBhbmRvXSlyZXR1cm4gYTt2YXIgYixjLGUsZj1hLnR5cGUsZz1hLGg9dGhpcy5maXhIb29rc1tmXTtofHwodGhpcy5maXhIb29rc1tmXT1oPWVhLnRlc3QoZik/dGhpcy5tb3VzZUhvb2tzOmRhLnRlc3QoZik/dGhpcy5rZXlIb29rczp7fSksZT1oLnByb3BzP3RoaXMucHJvcHMuY29uY2F0KGgucHJvcHMpOnRoaXMucHJvcHMsYT1uZXcgbi5FdmVudChnKSxiPWUubGVuZ3RoO3doaWxlKGItLSljPWVbYl0sYVtjXT1nW2NdO3JldHVybiBhLnRhcmdldHx8KGEudGFyZ2V0PWQpLDM9PT1hLnRhcmdldC5ub2RlVHlwZSYmKGEudGFyZ2V0PWEudGFyZ2V0LnBhcmVudE5vZGUpLGguZmlsdGVyP2guZmlsdGVyKGEsZyk6YX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMhPT1pYSgpJiZ0aGlzLmZvY3VzPyh0aGlzLmZvY3VzKCksITEpOnZvaWQgMH0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzPT09aWEoKSYmdGhpcy5ibHVyPyh0aGlzLmJsdXIoKSwhMSk6dm9pZCAwfSxkZWxlZ2F0ZVR5cGU6ImZvY3Vzb3V0In0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm4iY2hlY2tib3giPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZuLm5vZGVOYW1lKHRoaXMsImlucHV0Iik/KHRoaXMuY2xpY2soKSwhMSk6dm9pZCAwfSxfZGVmYXVsdDpmdW5jdGlvbihhKXtyZXR1cm4gbi5ub2RlTmFtZShhLnRhcmdldCwiYSIpfX0sYmVmb3JldW5sb2FkOntwb3N0RGlzcGF0Y2g6ZnVuY3Rpb24oYSl7dm9pZCAwIT09YS5yZXN1bHQmJmEub3JpZ2luYWxFdmVudCYmKGEub3JpZ2luYWxFdmVudC5yZXR1cm5WYWx1ZT1hLnJlc3VsdCl9fX19LG4ucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oYSxiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lciYmYS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYyl9LG4uRXZlbnQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIG4uRXZlbnQ/KGEmJmEudHlwZT8odGhpcy5vcmlnaW5hbEV2ZW50PWEsdGhpcy50eXBlPWEudHlwZSx0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1hLmRlZmF1bHRQcmV2ZW50ZWR8fHZvaWQgMD09PWEuZGVmYXVsdFByZXZlbnRlZCYmYS5yZXR1cm5WYWx1ZT09PSExP2dhOmhhKTp0aGlzLnR5cGU9YSxiJiZuLmV4dGVuZCh0aGlzLGIpLHRoaXMudGltZVN0YW1wPWEmJmEudGltZVN0YW1wfHxuLm5vdygpLHZvaWQodGhpc1tuLmV4cGFuZG9dPSEwKSk6bmV3IG4uRXZlbnQoYSxiKX0sbi5FdmVudC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOm4uRXZlbnQsaXNEZWZhdWx0UHJldmVudGVkOmhhLGlzUHJvcGFnYXRpb25TdG9wcGVkOmhhLGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOmhhLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPWdhLGEmJmEucHJldmVudERlZmF1bHQoKX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQ9Z2EsYSYmYS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9Z2EsYSYmYS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0aGlzLnN0b3BQcm9wYWdhdGlvbigpfX0sbi5lYWNoKHttb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0Iixwb2ludGVyZW50ZXI6InBvaW50ZXJvdmVyIixwb2ludGVybGVhdmU6InBvaW50ZXJvdXQifSxmdW5jdGlvbihhLGIpe24uZXZlbnQuc3BlY2lhbFthXT17ZGVsZWdhdGVUeXBlOmIsYmluZFR5cGU6YixoYW5kbGU6ZnVuY3Rpb24oYSl7dmFyIGMsZD10aGlzLGU9YS5yZWxhdGVkVGFyZ2V0LGY9YS5oYW5kbGVPYmo7cmV0dXJuKCFlfHxlIT09ZCYmIW4uY29udGFpbnMoZCxlKSkmJihhLnR5cGU9Zi5vcmlnVHlwZSxjPWYuaGFuZGxlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksYS50eXBlPWIpLGN9fX0pLG4uZm4uZXh0ZW5kKHtvbjpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gamEodGhpcyxhLGIsYyxkKX0sb25lOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBqYSh0aGlzLGEsYixjLGQsMSl9LG9mZjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZTtpZihhJiZhLnByZXZlbnREZWZhdWx0JiZhLmhhbmRsZU9iailyZXR1cm4gZD1hLmhhbmRsZU9iaixuKGEuZGVsZWdhdGVUYXJnZXQpLm9mZihkLm5hbWVzcGFjZT9kLm9yaWdUeXBlKyIuIitkLm5hbWVzcGFjZTpkLm9yaWdUeXBlLGQuc2VsZWN0b3IsZC5oYW5kbGVyKSx0aGlzO2lmKCJvYmplY3QiPT10eXBlb2YgYSl7Zm9yKGUgaW4gYSl0aGlzLm9mZihlLGIsYVtlXSk7cmV0dXJuIHRoaXN9cmV0dXJuKGI9PT0hMXx8ImZ1bmN0aW9uIj09dHlwZW9mIGIpJiYoYz1iLGI9dm9pZCAwKSxjPT09ITEmJihjPWhhKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LnJlbW92ZSh0aGlzLGEsYyxiKX0pfX0pO3ZhciBrYT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6LV0rKVtePl0qKVwvPi9naSxsYT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxtYT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxuYT0vXnRydWVcLyguKikvLG9hPS9eXHMqPCEoPzpcW0NEQVRBXFt8LS0pfCg/OlxdXF18LS0pPlxzKiQvZztmdW5jdGlvbiBwYShhLGIpe3JldHVybiBuLm5vZGVOYW1lKGEsInRhYmxlIikmJm4ubm9kZU5hbWUoMTEhPT1iLm5vZGVUeXBlP2I6Yi5maXJzdENoaWxkLCJ0ciIpP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF18fGEuYXBwZW5kQ2hpbGQoYS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRib2R5IikpOmF9ZnVuY3Rpb24gcWEoYSl7cmV0dXJuIGEudHlwZT0obnVsbCE9PWEuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIithLnR5cGUsYX1mdW5jdGlvbiByYShhKXt2YXIgYj1uYS5leGVjKGEudHlwZSk7cmV0dXJuIGI/YS50eXBlPWJbMV06YS5yZW1vdmVBdHRyaWJ1dGUoInR5cGUiKSxhfWZ1bmN0aW9uIHNhKGEsYil7dmFyIGMsZCxlLGYsZyxoLGksajtpZigxPT09Yi5ub2RlVHlwZSl7aWYoTi5oYXNEYXRhKGEpJiYoZj1OLmFjY2VzcyhhKSxnPU4uc2V0KGIsZiksaj1mLmV2ZW50cykpe2RlbGV0ZSBnLmhhbmRsZSxnLmV2ZW50cz17fTtmb3IoZSBpbiBqKWZvcihjPTAsZD1qW2VdLmxlbmd0aDtkPmM7YysrKW4uZXZlbnQuYWRkKGIsZSxqW2VdW2NdKX1PLmhhc0RhdGEoYSkmJihoPU8uYWNjZXNzKGEpLGk9bi5leHRlbmQoe30saCksTy5zZXQoYixpKSl9fWZ1bmN0aW9uIHRhKGEsYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyJpbnB1dCI9PT1jJiZYLnRlc3QoYS50eXBlKT9iLmNoZWNrZWQ9YS5jaGVja2VkOigiaW5wdXQiPT09Y3x8InRleHRhcmVhIj09PWMpJiYoYi5kZWZhdWx0VmFsdWU9YS5kZWZhdWx0VmFsdWUpfWZ1bmN0aW9uIHVhKGEsYixjLGQpe2I9Zi5hcHBseShbXSxiKTt2YXIgZSxnLGgsaSxqLGssbT0wLG89YS5sZW5ndGgscD1vLTEscT1iWzBdLHI9bi5pc0Z1bmN0aW9uKHEpO2lmKHJ8fG8+MSYmInN0cmluZyI9PXR5cGVvZiBxJiYhbC5jaGVja0Nsb25lJiZtYS50ZXN0KHEpKXJldHVybiBhLmVhY2goZnVuY3Rpb24oZSl7dmFyIGY9YS5lcShlKTtyJiYoYlswXT1xLmNhbGwodGhpcyxlLGYuaHRtbCgpKSksdWEoZixiLGMsZCl9KTtpZihvJiYoZT1jYShiLGFbMF0ub3duZXJEb2N1bWVudCwhMSxhLGQpLGc9ZS5maXJzdENoaWxkLDE9PT1lLmNoaWxkTm9kZXMubGVuZ3RoJiYoZT1nKSxnfHxkKSl7Zm9yKGg9bi5tYXAoXyhlLCJzY3JpcHQiKSxxYSksaT1oLmxlbmd0aDtvPm07bSsrKWo9ZSxtIT09cCYmKGo9bi5jbG9uZShqLCEwLCEwKSxpJiZuLm1lcmdlKGgsXyhqLCJzY3JpcHQiKSkpLGMuY2FsbChhW21dLGosbSk7aWYoaSlmb3Ioaz1oW2gubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsbi5tYXAoaCxyYSksbT0wO2k+bTttKyspaj1oW21dLFoudGVzdChqLnR5cGV8fCIiKSYmIU4uYWNjZXNzKGosImdsb2JhbEV2YWwiKSYmbi5jb250YWlucyhrLGopJiYoai5zcmM/bi5fZXZhbFVybCYmbi5fZXZhbFVybChqLnNyYyk6bi5nbG9iYWxFdmFsKGoudGV4dENvbnRlbnQucmVwbGFjZShvYSwiIikpKX1yZXR1cm4gYX1mdW5jdGlvbiB2YShhLGIsYyl7Zm9yKHZhciBkLGU9Yj9uLmZpbHRlcihiLGEpOmEsZj0wO251bGwhPShkPWVbZl0pO2YrKyljfHwxIT09ZC5ub2RlVHlwZXx8bi5jbGVhbkRhdGEoXyhkKSksZC5wYXJlbnROb2RlJiYoYyYmbi5jb250YWlucyhkLm93bmVyRG9jdW1lbnQsZCkmJmFhKF8oZCwic2NyaXB0IikpLGQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkKSk7cmV0dXJuIGF9bi5leHRlbmQoe2h0bWxQcmVmaWx0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShrYSwiPCQxPjwvJDI+Iil9LGNsb25lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuY2xvbmVOb2RlKCEwKSxpPW4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpO2lmKCEobC5ub0Nsb25lQ2hlY2tlZHx8MSE9PWEubm9kZVR5cGUmJjExIT09YS5ub2RlVHlwZXx8bi5pc1hNTERvYyhhKSkpZm9yKGc9XyhoKSxmPV8oYSksZD0wLGU9Zi5sZW5ndGg7ZT5kO2QrKyl0YShmW2RdLGdbZF0pO2lmKGIpaWYoYylmb3IoZj1mfHxfKGEpLGc9Z3x8XyhoKSxkPTAsZT1mLmxlbmd0aDtlPmQ7ZCsrKXNhKGZbZF0sZ1tkXSk7ZWxzZSBzYShhLGgpO3JldHVybiBnPV8oaCwic2NyaXB0IiksZy5sZW5ndGg+MCYmYWEoZywhaSYmXyhhLCJzY3JpcHQiKSksaH0sY2xlYW5EYXRhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQsZT1uLmV2ZW50LnNwZWNpYWwsZj0wO3ZvaWQgMCE9PShjPWFbZl0pO2YrKylpZihMKGMpKXtpZihiPWNbTi5leHBhbmRvXSl7aWYoYi5ldmVudHMpZm9yKGQgaW4gYi5ldmVudHMpZVtkXT9uLmV2ZW50LnJlbW92ZShjLGQpOm4ucmVtb3ZlRXZlbnQoYyxkLGIuaGFuZGxlKTtjW04uZXhwYW5kb109dm9pZCAwfWNbTy5leHBhbmRvXSYmKGNbTy5leHBhbmRvXT12b2lkIDApfX19KSxuLmZuLmV4dGVuZCh7ZG9tTWFuaXA6dWEsZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB2YSh0aGlzLGEsITApfSxyZW1vdmU6ZnVuY3Rpb24oYSl7cmV0dXJuIHZhKHRoaXMsYSl9LHRleHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIEsodGhpcyxmdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwPT09YT9uLnRleHQodGhpcyk6dGhpcy5lbXB0eSgpLmVhY2goZnVuY3Rpb24oKXsoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpJiYodGhpcy50ZXh0Q29udGVudD1hKX0pfSxudWxsLGEsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiB1YSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihhKXtpZigxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSl7dmFyIGI9cGEodGhpcyxhKTtiLmFwcGVuZENoaWxkKGEpfX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHVhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1wYSh0aGlzLGEpO2IuaW5zZXJ0QmVmb3JlKGEsYi5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIHVhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHVhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLHRoaXMubmV4dFNpYmxpbmcpfSl9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBhLGI9MDtudWxsIT0oYT10aGlzW2JdKTtiKyspMT09PWEubm9kZVR5cGUmJihuLmNsZWFuRGF0YShfKGEsITEpKSxhLnRleHRDb250ZW50PSIiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1udWxsPT1hPyExOmEsYj1udWxsPT1iP2E6Yix0aGlzLm1hcChmdW5jdGlvbigpe3JldHVybiBuLmNsb25lKHRoaXMsYSxiKX0pfSxodG1sOmZ1bmN0aW9uKGEpe3JldHVybiBLKHRoaXMsZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXXx8e30sYz0wLGQ9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09YSYmMT09PWIubm9kZVR5cGUpcmV0dXJuIGIuaW5uZXJIVE1MO2lmKCJzdHJpbmciPT10eXBlb2YgYSYmIWxhLnRlc3QoYSkmJiEkWyhZLmV4ZWMoYSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCldKXthPW4uaHRtbFByZWZpbHRlcihhKTt0cnl7Zm9yKDtkPmM7YysrKWI9dGhpc1tjXXx8e30sMT09PWIubm9kZVR5cGUmJihuLmNsZWFuRGF0YShfKGIsITEpKSxiLmlubmVySFRNTD1hKTtiPTB9Y2F0Y2goZSl7fX1iJiZ0aGlzLmVtcHR5KCkuYXBwZW5kKGEpfSxudWxsLGEsYXJndW1lbnRzLmxlbmd0aCl9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKCl7dmFyIGE9W107cmV0dXJuIHVhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGIpe3ZhciBjPXRoaXMucGFyZW50Tm9kZTtuLmluQXJyYXkodGhpcyxhKTwwJiYobi5jbGVhbkRhdGEoXyh0aGlzKSksYyYmYy5yZXBsYWNlQ2hpbGQoYix0aGlzKSl9LGEpfX0pLG4uZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGEsYil7bi5mblthXT1mdW5jdGlvbihhKXtmb3IodmFyIGMsZD1bXSxlPW4oYSksZj1lLmxlbmd0aC0xLGg9MDtmPj1oO2grKyljPWg9PT1mP3RoaXM6dGhpcy5jbG9uZSghMCksbihlW2hdKVtiXShjKSxnLmFwcGx5KGQsYy5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQpfX0pO3ZhciB3YSx4YT17SFRNTDoiYmxvY2siLEJPRFk6ImJsb2NrIn07ZnVuY3Rpb24geWEoYSxiKXt2YXIgYz1uKGIuY3JlYXRlRWxlbWVudChhKSkuYXBwZW5kVG8oYi5ib2R5KSxkPW4uY3NzKGNbMF0sImRpc3BsYXkiKTtyZXR1cm4gYy5kZXRhY2goKSxkfWZ1bmN0aW9uIHphKGEpe3ZhciBiPWQsYz14YVthXTtyZXR1cm4gY3x8KGM9eWEoYSxiKSwibm9uZSIhPT1jJiZjfHwod2E9KHdhfHxuKCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+IikpLmFwcGVuZFRvKGIuZG9jdW1lbnRFbGVtZW50KSxiPXdhWzBdLmNvbnRlbnREb2N1bWVudCxiLndyaXRlKCksYi5jbG9zZSgpLGM9eWEoYSxiKSx3YS5kZXRhY2goKSkseGFbYV09YyksY312YXIgQWE9L15tYXJnaW4vLEJhPW5ldyBSZWdFeHAoIl4oIitTKyIpKD8hcHgpW2EteiVdKyQiLCJpIiksQ2E9ZnVuY3Rpb24oYil7dmFyIGM9Yi5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3O3JldHVybiBjJiZjLm9wZW5lcnx8KGM9YSksYy5nZXRDb21wdXRlZFN0eWxlKGIpfSxEYT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGc9e307Zm9yKGYgaW4gYilnW2ZdPWEuc3R5bGVbZl0sYS5zdHlsZVtmXT1iW2ZdO2U9Yy5hcHBseShhLGR8fFtdKTtmb3IoZiBpbiBiKWEuc3R5bGVbZl09Z1tmXTtyZXR1cm4gZX0sRWE9ZC5kb2N1bWVudEVsZW1lbnQ7IWZ1bmN0aW9uKCl7dmFyIGIsYyxlLGYsZz1kLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGg9ZC5jcmVhdGVFbGVtZW50KCJkaXYiKTtpZihoLnN0eWxlKXtoLnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCIsaC5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwPSIiLGwuY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1oLnN0eWxlLmJhY2tncm91bmRDbGlwLGcuc3R5bGUuY3NzVGV4dD0iYm9yZGVyOjA7d2lkdGg6OHB4O2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweDtwYWRkaW5nOjA7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGUiLGcuYXBwZW5kQ2hpbGQoaCk7ZnVuY3Rpb24gaSgpe2guc3R5bGUuY3NzVGV4dD0iLXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt0b3A6MSU7d2lkdGg6NTAlIixoLmlubmVySFRNTD0iIixFYS5hcHBlbmRDaGlsZChnKTt2YXIgZD1hLmdldENvbXB1dGVkU3R5bGUoaCk7Yj0iMSUiIT09ZC50b3AsZj0iMnB4Ij09PWQubWFyZ2luTGVmdCxjPSI0cHgiPT09ZC53aWR0aCxoLnN0eWxlLm1hcmdpblJpZ2h0PSI1MCUiLGU9IjRweCI9PT1kLm1hcmdpblJpZ2h0LEVhLnJlbW92ZUNoaWxkKGcpfW4uZXh0ZW5kKGwse3BpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gaSgpLGJ9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PWMmJmkoKSxjfSxwaXhlbE1hcmdpblJpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PWMmJmkoKSxlfSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09YyYmaSgpLGZ9LHJlbGlhYmxlTWFyZ2luUmlnaHQ6ZnVuY3Rpb24oKXt2YXIgYixjPWguYXBwZW5kQ2hpbGQoZC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7cmV0dXJuIGMuc3R5bGUuY3NzVGV4dD1oLnN0eWxlLmNzc1RleHQ9Ii13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowIixjLnN0eWxlLm1hcmdpblJpZ2h0PWMuc3R5bGUud2lkdGg9IjAiLGguc3R5bGUud2lkdGg9IjFweCIsRWEuYXBwZW5kQ2hpbGQoZyksYj0hcGFyc2VGbG9hdChhLmdldENvbXB1dGVkU3R5bGUoYykubWFyZ2luUmlnaHQpLEVhLnJlbW92ZUNoaWxkKGcpLGgucmVtb3ZlQ2hpbGQoYyksYn19KX19KCk7ZnVuY3Rpb24gRmEoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5zdHlsZTtyZXR1cm4gYz1jfHxDYShhKSxnPWM/Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpfHxjW2JdOnZvaWQgMCwiIiE9PWcmJnZvaWQgMCE9PWd8fG4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpfHwoZz1uLnN0eWxlKGEsYikpLGMmJiFsLnBpeGVsTWFyZ2luUmlnaHQoKSYmQmEudGVzdChnKSYmQWEudGVzdChiKSYmKGQ9aC53aWR0aCxlPWgubWluV2lkdGgsZj1oLm1heFdpZHRoLGgubWluV2lkdGg9aC5tYXhXaWR0aD1oLndpZHRoPWcsZz1jLndpZHRoLGgud2lkdGg9ZCxoLm1pbldpZHRoPWUsaC5tYXhXaWR0aD1mKSx2b2lkIDAhPT1nP2crIiI6Z31mdW5jdGlvbiBHYShhLGIpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpP3ZvaWQgZGVsZXRlIHRoaXMuZ2V0Oih0aGlzLmdldD1iKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX12YXIgSGE9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLElhPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxKYT17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn0sS2E9WyJXZWJraXQiLCJPIiwiTW96IiwibXMiXSxMYT1kLmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlO2Z1bmN0aW9uIE1hKGEpe2lmKGEgaW4gTGEpcmV0dXJuIGE7dmFyIGI9YVswXS50b1VwcGVyQ2FzZSgpK2Euc2xpY2UoMSksYz1LYS5sZW5ndGg7d2hpbGUoYy0tKWlmKGE9S2FbY10rYixhIGluIExhKXJldHVybiBhfWZ1bmN0aW9uIE5hKGEsYixjKXt2YXIgZD1ULmV4ZWMoYik7cmV0dXJuIGQ/TWF0aC5tYXgoMCxkWzJdLShjfHwwKSkrKGRbM118fCJweCIpOmJ9ZnVuY3Rpb24gT2EoYSxiLGMsZCxlKXtmb3IodmFyIGY9Yz09PShkPyJib3JkZXIiOiJjb250ZW50Iik/NDoid2lkdGgiPT09Yj8xOjAsZz0wOzQ+ZjtmKz0yKSJtYXJnaW4iPT09YyYmKGcrPW4uY3NzKGEsYytVW2ZdLCEwLGUpKSxkPygiY29udGVudCI9PT1jJiYoZy09bi5jc3MoYSwicGFkZGluZyIrVVtmXSwhMCxlKSksIm1hcmdpbiIhPT1jJiYoZy09bi5jc3MoYSwiYm9yZGVyIitVW2ZdKyJXaWR0aCIsITAsZSkpKTooZys9bi5jc3MoYSwicGFkZGluZyIrVVtmXSwhMCxlKSwicGFkZGluZyIhPT1jJiYoZys9bi5jc3MoYSwiYm9yZGVyIitVW2ZdKyJXaWR0aCIsITAsZSkpKTtyZXR1cm4gZ31mdW5jdGlvbiBQYShiLGMsZSl7dmFyIGY9ITAsZz0id2lkdGgiPT09Yz9iLm9mZnNldFdpZHRoOmIub2Zmc2V0SGVpZ2h0LGg9Q2EoYiksaT0iYm9yZGVyLWJveCI9PT1uLmNzcyhiLCJib3hTaXppbmciLCExLGgpO2lmKGQubXNGdWxsc2NyZWVuRWxlbWVudCYmYS50b3AhPT1hJiZiLmdldENsaWVudFJlY3RzKCkubGVuZ3RoJiYoZz1NYXRoLnJvdW5kKDEwMCpiLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpW2NdKSksMD49Z3x8bnVsbD09Zyl7aWYoZz1GYShiLGMsaCksKDA+Z3x8bnVsbD09ZykmJihnPWIuc3R5bGVbY10pLEJhLnRlc3QoZykpcmV0dXJuIGc7Zj1pJiYobC5ib3hTaXppbmdSZWxpYWJsZSgpfHxnPT09Yi5zdHlsZVtjXSksZz1wYXJzZUZsb2F0KGcpfHwwfXJldHVybiBnK09hKGIsYyxlfHwoaT8iYm9yZGVyIjoiY29udGVudCIpLGYsaCkrInB4In1mdW5jdGlvbiBRYShhLGIpe2Zvcih2YXIgYyxkLGUsZj1bXSxnPTAsaD1hLmxlbmd0aDtoPmc7ZysrKWQ9YVtnXSxkLnN0eWxlJiYoZltnXT1OLmdldChkLCJvbGRkaXNwbGF5IiksYz1kLnN0eWxlLmRpc3BsYXksYj8oZltnXXx8Im5vbmUiIT09Y3x8KGQuc3R5bGUuZGlzcGxheT0iIiksIiI9PT1kLnN0eWxlLmRpc3BsYXkmJlYoZCkmJihmW2ddPU4uYWNjZXNzKGQsIm9sZGRpc3BsYXkiLHphKGQubm9kZU5hbWUpKSkpOihlPVYoZCksIm5vbmUiPT09YyYmZXx8Ti5zZXQoZCwib2xkZGlzcGxheSIsZT9jOm4uY3NzKGQsImRpc3BsYXkiKSkpKTtmb3IoZz0wO2g+ZztnKyspZD1hW2ddLGQuc3R5bGUmJihiJiYibm9uZSIhPT1kLnN0eWxlLmRpc3BsYXkmJiIiIT09ZC5zdHlsZS5kaXNwbGF5fHwoZC5zdHlsZS5kaXNwbGF5PWI/ZltnXXx8IiI6Im5vbmUiKSk7cmV0dXJuIGF9bi5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oYSxiKXtpZihiKXt2YXIgYz1GYShhLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1jPyIxIjpjfX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGNvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOnsiZmxvYXQiOiJjc3NGbG9hdCJ9LHN0eWxlOmZ1bmN0aW9uKGEsYixjLGQpe2lmKGEmJjMhPT1hLm5vZGVUeXBlJiY4IT09YS5ub2RlVHlwZSYmYS5zdHlsZSl7dmFyIGUsZixnLGg9bi5jYW1lbENhc2UoYiksaT1hLnN0eWxlO3JldHVybiBiPW4uY3NzUHJvcHNbaF18fChuLmNzc1Byb3BzW2hdPU1hKGgpfHxoKSxnPW4uY3NzSG9va3NbYl18fG4uY3NzSG9va3NbaF0sdm9pZCAwPT09Yz9nJiYiZ2V0ImluIGcmJnZvaWQgMCE9PShlPWcuZ2V0KGEsITEsZCkpP2U6aVtiXTooZj10eXBlb2YgYywic3RyaW5nIj09PWYmJihlPVQuZXhlYyhjKSkmJmVbMV0mJihjPVcoYSxiLGUpLGY9Im51bWJlciIpLG51bGwhPWMmJmM9PT1jJiYoIm51bWJlciI9PT1mJiYoYys9ZSYmZVszXXx8KG4uY3NzTnVtYmVyW2hdPyIiOiJweCIpKSxsLmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1jfHwwIT09Yi5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChpW2JdPSJpbmhlcml0IiksZyYmInNldCJpbiBnJiZ2b2lkIDA9PT0oYz1nLnNldChhLGMsZCkpfHwoaVtiXT1jKSksdm9pZCAwKX19LGNzczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGcsaD1uLmNhbWVsQ2FzZShiKTtyZXR1cm4gYj1uLmNzc1Byb3BzW2hdfHwobi5jc3NQcm9wc1toXT1NYShoKXx8aCksZz1uLmNzc0hvb2tzW2JdfHxuLmNzc0hvb2tzW2hdLGcmJiJnZXQiaW4gZyYmKGU9Zy5nZXQoYSwhMCxjKSksdm9pZCAwPT09ZSYmKGU9RmEoYSxiLGQpKSwibm9ybWFsIj09PWUmJmIgaW4gSmEmJihlPUphW2JdKSwiIj09PWN8fGM/KGY9cGFyc2VGbG9hdChlKSxjPT09ITB8fGlzRmluaXRlKGYpP2Z8fDA6ZSk6ZX19KSxuLmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gYz9IYS50ZXN0KG4uY3NzKGEsImRpc3BsYXkiKSkmJjA9PT1hLm9mZnNldFdpZHRoP0RhKGEsSWEsZnVuY3Rpb24oKXtyZXR1cm4gUGEoYSxiLGQpfSk6UGEoYSxiLGQpOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGEsYyxkKXt2YXIgZSxmPWQmJkNhKGEpLGc9ZCYmT2EoYSxiLGQsImJvcmRlci1ib3giPT09bi5jc3MoYSwiYm94U2l6aW5nIiwhMSxmKSxmKTtyZXR1cm4gZyYmKGU9VC5leGVjKGMpKSYmInB4IiE9PShlWzNdfHwicHgiKSYmKGEuc3R5bGVbYl09YyxjPW4uY3NzKGEsYikpLE5hKGEsYyxnKX19fSksbi5jc3NIb29rcy5tYXJnaW5MZWZ0PUdhKGwucmVsaWFibGVNYXJnaW5MZWZ0LGZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/KHBhcnNlRmxvYXQoRmEoYSwibWFyZ2luTGVmdCIpKXx8YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LURhKGEse21hcmdpbkxlZnQ6MH0sZnVuY3Rpb24oKXtyZXR1cm4gYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0fSkpKyJweCI6dm9pZCAwfSksbi5jc3NIb29rcy5tYXJnaW5SaWdodD1HYShsLnJlbGlhYmxlTWFyZ2luUmlnaHQsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9EYShhLHtkaXNwbGF5OiJpbmxpbmUtYmxvY2sifSxGYSxbYSwibWFyZ2luUmlnaHQiXSk6dm9pZCAwfSksbi5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2ErYl09e2V4cGFuZDpmdW5jdGlvbihjKXtmb3IodmFyIGQ9MCxlPXt9LGY9InN0cmluZyI9PXR5cGVvZiBjP2Muc3BsaXQoIiAiKTpbY107ND5kO2QrKyllW2ErVVtkXStiXT1mW2RdfHxmW2QtMl18fGZbMF07cmV0dXJuIGV9fSxBYS50ZXN0KGEpfHwobi5jc3NIb29rc1thK2JdLnNldD1OYSl9KSxuLmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEsodGhpcyxmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPXt9LGc9MDtpZihuLmlzQXJyYXkoYikpe2ZvcihkPUNhKGEpLGU9Yi5sZW5ndGg7ZT5nO2crKylmW2JbZ11dPW4uY3NzKGEsYltnXSwhMSxkKTtyZXR1cm4gZn1yZXR1cm4gdm9pZCAwIT09Yz9uLnN0eWxlKGEsYixjKTpuLmNzcyhhLGIpfSxhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX0sc2hvdzpmdW5jdGlvbigpe3JldHVybiBRYSh0aGlzLCEwKX0saGlkZTpmdW5jdGlvbigpe3JldHVybiBRYSh0aGlzKX0sdG9nZ2xlOmZ1bmN0aW9uKGEpe3JldHVybiJib29sZWFuIj09dHlwZW9mIGE/YT90aGlzLnNob3coKTp0aGlzLmhpZGUoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXtWKHRoaXMpP24odGhpcykuc2hvdygpOm4odGhpcykuaGlkZSgpfSl9fSk7ZnVuY3Rpb24gUmEoYSxiLGMsZCxlKXtyZXR1cm4gbmV3IFJhLnByb3RvdHlwZS5pbml0KGEsYixjLGQsZSl9bi5Ud2Vlbj1SYSxSYS5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOlJhLGluaXQ6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3RoaXMuZWxlbT1hLHRoaXMucHJvcD1jLHRoaXMuZWFzaW5nPWV8fG4uZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz1iLHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1kLHRoaXMudW5pdD1mfHwobi5jc3NOdW1iZXJbY10/IiI6InB4Iil9LGN1cjpmdW5jdGlvbigpe3ZhciBhPVJhLnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiBhJiZhLmdldD9hLmdldCh0aGlzKTpSYS5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpfSxydW46ZnVuY3Rpb24oYSl7dmFyIGIsYz1SYS5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uP3RoaXMucG9zPWI9bi5lYXNpbmdbdGhpcy5lYXNpbmddKGEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKmEsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik6dGhpcy5wb3M9Yj1hLHRoaXMubm93PSh0aGlzLmVuZC10aGlzLnN0YXJ0KSpiK3RoaXMuc3RhcnQsdGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLGMmJmMuc2V0P2Muc2V0KHRoaXMpOlJhLnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksdGhpc319LFJhLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT1SYS5wcm90b3R5cGUsUmEucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiAxIT09YS5lbGVtLm5vZGVUeXBlfHxudWxsIT1hLmVsZW1bYS5wcm9wXSYmbnVsbD09YS5lbGVtLnN0eWxlW2EucHJvcF0/YS5lbGVtW2EucHJvcF06KGI9bi5jc3MoYS5lbGVtLGEucHJvcCwiIiksYiYmImF1dG8iIT09Yj9iOjApfSxzZXQ6ZnVuY3Rpb24oYSl7bi5meC5zdGVwW2EucHJvcF0/bi5meC5zdGVwW2EucHJvcF0oYSk6MSE9PWEuZWxlbS5ub2RlVHlwZXx8bnVsbD09YS5lbGVtLnN0eWxlW24uY3NzUHJvcHNbYS5wcm9wXV0mJiFuLmNzc0hvb2tzW2EucHJvcF0/YS5lbGVtW2EucHJvcF09YS5ub3c6bi5zdHlsZShhLmVsZW0sYS5wcm9wLGEubm93K2EudW5pdCl9fX0sUmEucHJvcEhvb2tzLnNjcm9sbFRvcD1SYS5wcm9wSG9va3Muc2Nyb2xsTGVmdD17c2V0OmZ1bmN0aW9uKGEpe2EuZWxlbS5ub2RlVHlwZSYmYS5lbGVtLnBhcmVudE5vZGUmJihhLmVsZW1bYS5wcm9wXT1hLm5vdyl9fSxuLmVhc2luZz17bGluZWFyOmZ1bmN0aW9uKGEpe3JldHVybiBhfSxzd2luZzpmdW5jdGlvbihhKXtyZXR1cm4uNS1NYXRoLmNvcyhhKk1hdGguUEkpLzJ9LF9kZWZhdWx0OiJzd2luZyJ9LG4uZng9UmEucHJvdG90eXBlLmluaXQsbi5meC5zdGVwPXt9O3ZhciBTYSxUYSxVYT0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sVmE9L3F1ZXVlSG9va3MkLztmdW5jdGlvbiBXYSgpe3JldHVybiBhLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtTYT12b2lkIDB9KSxTYT1uLm5vdygpfWZ1bmN0aW9uIFhhKGEsYil7dmFyIGMsZD0wLGU9e2hlaWdodDphfTtmb3IoYj1iPzE6MDs0PmQ7ZCs9Mi1iKWM9VVtkXSxlWyJtYXJnaW4iK2NdPWVbInBhZGRpbmciK2NdPWE7cmV0dXJuIGImJihlLm9wYWNpdHk9ZS53aWR0aD1hKSxlfWZ1bmN0aW9uIFlhKGEsYixjKXtmb3IodmFyIGQsZT0oX2EudHdlZW5lcnNbYl18fFtdKS5jb25jYXQoX2EudHdlZW5lcnNbIioiXSksZj0wLGc9ZS5sZW5ndGg7Zz5mO2YrKylpZihkPWVbZl0uY2FsbChjLGIsYSkpcmV0dXJuIGR9ZnVuY3Rpb24gWmEoYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGssbD10aGlzLG09e30sbz1hLnN0eWxlLHA9YS5ub2RlVHlwZSYmVihhKSxxPU4uZ2V0KGEsImZ4c2hvdyIpO2MucXVldWV8fChoPW4uX3F1ZXVlSG9va3MoYSwiZngiKSxudWxsPT1oLnVucXVldWVkJiYoaC51bnF1ZXVlZD0wLGk9aC5lbXB0eS5maXJlLGguZW1wdHkuZmlyZT1mdW5jdGlvbigpe2gudW5xdWV1ZWR8fGkoKX0pLGgudW5xdWV1ZWQrKyxsLmFsd2F5cyhmdW5jdGlvbigpe2wuYWx3YXlzKGZ1bmN0aW9uKCl7aC51bnF1ZXVlZC0tLG4ucXVldWUoYSwiZngiKS5sZW5ndGh8fGguZW1wdHkuZmlyZSgpfSl9KSksMT09PWEubm9kZVR5cGUmJigiaGVpZ2h0ImluIGJ8fCJ3aWR0aCJpbiBiKSYmKGMub3ZlcmZsb3c9W28ub3ZlcmZsb3csby5vdmVyZmxvd1gsby5vdmVyZmxvd1ldLGo9bi5jc3MoYSwiZGlzcGxheSIpLGs9Im5vbmUiPT09aj9OLmdldChhLCJvbGRkaXNwbGF5Iil8fHphKGEubm9kZU5hbWUpOmosImlubGluZSI9PT1rJiYibm9uZSI9PT1uLmNzcyhhLCJmbG9hdCIpJiYoby5kaXNwbGF5PSJpbmxpbmUtYmxvY2siKSksYy5vdmVyZmxvdyYmKG8ub3ZlcmZsb3c9ImhpZGRlbiIsbC5hbHdheXMoZnVuY3Rpb24oKXtvLm92ZXJmbG93PWMub3ZlcmZsb3dbMF0sby5vdmVyZmxvd1g9Yy5vdmVyZmxvd1sxXSxvLm92ZXJmbG93WT1jLm92ZXJmbG93WzJdfSkpO2ZvcihkIGluIGIpaWYoZT1iW2RdLFVhLmV4ZWMoZSkpe2lmKGRlbGV0ZSBiW2RdLGY9Znx8InRvZ2dsZSI9PT1lLGU9PT0ocD8iaGlkZSI6InNob3ciKSl7aWYoInNob3ciIT09ZXx8IXF8fHZvaWQgMD09PXFbZF0pY29udGludWU7cD0hMH1tW2RdPXEmJnFbZF18fG4uc3R5bGUoYSxkKX1lbHNlIGo9dm9pZCAwO2lmKG4uaXNFbXB0eU9iamVjdChtKSkiaW5saW5lIj09PSgibm9uZSI9PT1qP3phKGEubm9kZU5hbWUpOmopJiYoby5kaXNwbGF5PWopO2Vsc2V7cT8iaGlkZGVuImluIHEmJihwPXEuaGlkZGVuKTpxPU4uYWNjZXNzKGEsImZ4c2hvdyIse30pLGYmJihxLmhpZGRlbj0hcCkscD9uKGEpLnNob3coKTpsLmRvbmUoZnVuY3Rpb24oKXtuKGEpLmhpZGUoKX0pLGwuZG9uZShmdW5jdGlvbigpe3ZhciBiO04ucmVtb3ZlKGEsImZ4c2hvdyIpO2ZvcihiIGluIG0pbi5zdHlsZShhLGIsbVtiXSl9KTtmb3IoZCBpbiBtKWc9WWEocD9xW2RdOjAsZCxsKSxkIGluIHF8fChxW2RdPWcuc3RhcnQscCYmKGcuZW5kPWcuc3RhcnQsZy5zdGFydD0id2lkdGgiPT09ZHx8ImhlaWdodCI9PT1kPzE6MCkpfX1mdW5jdGlvbiAkYShhLGIpe3ZhciBjLGQsZSxmLGc7Zm9yKGMgaW4gYSlpZihkPW4uY2FtZWxDYXNlKGMpLGU9YltkXSxmPWFbY10sbi5pc0FycmF5KGYpJiYoZT1mWzFdLGY9YVtjXT1mWzBdKSxjIT09ZCYmKGFbZF09ZixkZWxldGUgYVtjXSksZz1uLmNzc0hvb2tzW2RdLGcmJiJleHBhbmQiaW4gZyl7Zj1nLmV4cGFuZChmKSxkZWxldGUgYVtkXTtmb3IoYyBpbiBmKWMgaW4gYXx8KGFbY109ZltjXSxiW2NdPWUpfWVsc2UgYltkXT1lfWZ1bmN0aW9uIF9hKGEsYixjKXt2YXIgZCxlLGY9MCxnPV9hLnByZWZpbHRlcnMubGVuZ3RoLGg9bi5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSBpLmVsZW19KSxpPWZ1bmN0aW9uKCl7aWYoZSlyZXR1cm4hMTtmb3IodmFyIGI9U2F8fFdhKCksYz1NYXRoLm1heCgwLGouc3RhcnRUaW1lK2ouZHVyYXRpb24tYiksZD1jL2ouZHVyYXRpb258fDAsZj0xLWQsZz0wLGk9ai50d2VlbnMubGVuZ3RoO2k+ZztnKyspai50d2VlbnNbZ10ucnVuKGYpO3JldHVybiBoLm5vdGlmeVdpdGgoYSxbaixmLGNdKSwxPmYmJmk/YzooaC5yZXNvbHZlV2l0aChhLFtqXSksITEpfSxqPWgucHJvbWlzZSh7ZWxlbTphLHByb3BzOm4uZXh0ZW5kKHt9LGIpLG9wdHM6bi5leHRlbmQoITAse3NwZWNpYWxFYXNpbmc6e30sZWFzaW5nOm4uZWFzaW5nLl9kZWZhdWx0fSxjKSxvcmlnaW5hbFByb3BlcnRpZXM6YixvcmlnaW5hbE9wdGlvbnM6YyxzdGFydFRpbWU6U2F8fFdhKCksZHVyYXRpb246Yy5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oYixjKXt2YXIgZD1uLlR3ZWVuKGEsai5vcHRzLGIsYyxqLm9wdHMuc3BlY2lhbEVhc2luZ1tiXXx8ai5vcHRzLmVhc2luZyk7cmV0dXJuIGoudHdlZW5zLnB1c2goZCksZH0sc3RvcDpmdW5jdGlvbihiKXt2YXIgYz0wLGQ9Yj9qLnR3ZWVucy5sZW5ndGg6MDtpZihlKXJldHVybiB0aGlzO2ZvcihlPSEwO2Q+YztjKyspai50d2VlbnNbY10ucnVuKDEpO3JldHVybiBiPyhoLm5vdGlmeVdpdGgoYSxbaiwxLDBdKSxoLnJlc29sdmVXaXRoKGEsW2osYl0pKTpoLnJlamVjdFdpdGgoYSxbaixiXSksdGhpc319KSxrPWoucHJvcHM7Zm9yKCRhKGssai5vcHRzLnNwZWNpYWxFYXNpbmcpO2c+ZjtmKyspaWYoZD1fYS5wcmVmaWx0ZXJzW2ZdLmNhbGwoaixhLGssai5vcHRzKSlyZXR1cm4gbi5pc0Z1bmN0aW9uKGQuc3RvcCkmJihuLl9xdWV1ZUhvb2tzKGouZWxlbSxqLm9wdHMucXVldWUpLnN0b3A9bi5wcm94eShkLnN0b3AsZCkpLGQ7cmV0dXJuIG4ubWFwKGssWWEsaiksbi5pc0Z1bmN0aW9uKGoub3B0cy5zdGFydCkmJmoub3B0cy5zdGFydC5jYWxsKGEsaiksbi5meC50aW1lcihuLmV4dGVuZChpLHtlbGVtOmEsYW5pbTpqLHF1ZXVlOmoub3B0cy5xdWV1ZX0pKSxqLnByb2dyZXNzKGoub3B0cy5wcm9ncmVzcykuZG9uZShqLm9wdHMuZG9uZSxqLm9wdHMuY29tcGxldGUpLmZhaWwoai5vcHRzLmZhaWwpLmFsd2F5cyhqLm9wdHMuYWx3YXlzKX1uLkFuaW1hdGlvbj1uLmV4dGVuZChfYSx7dHdlZW5lcnM6eyIqIjpbZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZVR3ZWVuKGEsYik7cmV0dXJuIFcoYy5lbGVtLGEsVC5leGVjKGIpLGMpLGN9XX0sdHdlZW5lcjpmdW5jdGlvbihhLGIpe24uaXNGdW5jdGlvbihhKT8oYj1hLGE9WyIqIl0pOmE9YS5tYXRjaChHKTtmb3IodmFyIGMsZD0wLGU9YS5sZW5ndGg7ZT5kO2QrKyljPWFbZF0sX2EudHdlZW5lcnNbY109X2EudHdlZW5lcnNbY118fFtdLF9hLnR3ZWVuZXJzW2NdLnVuc2hpZnQoYil9LHByZWZpbHRlcnM6W1phXSxwcmVmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtiP19hLnByZWZpbHRlcnMudW5zaGlmdChhKTpfYS5wcmVmaWx0ZXJzLnB1c2goYSl9fSksbi5zcGVlZD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YSYmIm9iamVjdCI9PXR5cGVvZiBhP24uZXh0ZW5kKHt9LGEpOntjb21wbGV0ZTpjfHwhYyYmYnx8bi5pc0Z1bmN0aW9uKGEpJiZhLGR1cmF0aW9uOmEsZWFzaW5nOmMmJmJ8fGImJiFuLmlzRnVuY3Rpb24oYikmJmJ9O3JldHVybiBkLmR1cmF0aW9uPW4uZngub2ZmPzA6Im51bWJlciI9PXR5cGVvZiBkLmR1cmF0aW9uP2QuZHVyYXRpb246ZC5kdXJhdGlvbiBpbiBuLmZ4LnNwZWVkcz9uLmZ4LnNwZWVkc1tkLmR1cmF0aW9uXTpuLmZ4LnNwZWVkcy5fZGVmYXVsdCwobnVsbD09ZC5xdWV1ZXx8ZC5xdWV1ZT09PSEwKSYmKGQucXVldWU9ImZ4IiksZC5vbGQ9ZC5jb21wbGV0ZSxkLmNvbXBsZXRlPWZ1bmN0aW9uKCl7bi5pc0Z1bmN0aW9uKGQub2xkKSYmZC5vbGQuY2FsbCh0aGlzKSxkLnF1ZXVlJiZuLmRlcXVldWUodGhpcyxkLnF1ZXVlKX0sZH0sbi5mbi5leHRlbmQoe2ZhZGVUbzpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5maWx0ZXIoVikuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bi5pc0VtcHR5T2JqZWN0KGEpLGY9bi5zcGVlZChiLGMsZCksZz1mdW5jdGlvbigpe3ZhciBiPV9hKHRoaXMsbi5leHRlbmQoe30sYSksZik7KGV8fE4uZ2V0KHRoaXMsImZpbmlzaCIpKSYmYi5zdG9wKCEwKX07cmV0dXJuIGcuZmluaXNoPWcsZXx8Zi5xdWV1ZT09PSExP3RoaXMuZWFjaChnKTp0aGlzLnF1ZXVlKGYucXVldWUsZyl9LHN0b3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWZ1bmN0aW9uKGEpe3ZhciBiPWEuc3RvcDtkZWxldGUgYS5zdG9wLGIoYyl9O3JldHVybiJzdHJpbmciIT10eXBlb2YgYSYmKGM9YixiPWEsYT12b2lkIDApLGImJmEhPT0hMSYmdGhpcy5xdWV1ZShhfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj0hMCxlPW51bGwhPWEmJmErInF1ZXVlSG9va3MiLGY9bi50aW1lcnMsZz1OLmdldCh0aGlzKTtpZihlKWdbZV0mJmdbZV0uc3RvcCYmZChnW2VdKTtlbHNlIGZvcihlIGluIGcpZ1tlXSYmZ1tlXS5zdG9wJiZWYS50ZXN0KGUpJiZkKGdbZV0pO2ZvcihlPWYubGVuZ3RoO2UtLTspZltlXS5lbGVtIT09dGhpc3x8bnVsbCE9YSYmZltlXS5xdWV1ZSE9PWF8fChmW2VdLmFuaW0uc3RvcChjKSxiPSExLGYuc3BsaWNlKGUsMSkpOyhifHwhYykmJm4uZGVxdWV1ZSh0aGlzLGEpfSl9LGZpbmlzaDpmdW5jdGlvbihhKXtyZXR1cm4gYSE9PSExJiYoYT1hfHwiZngiKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYixjPU4uZ2V0KHRoaXMpLGQ9Y1thKyJxdWV1ZSJdLGU9Y1thKyJxdWV1ZUhvb2tzIl0sZj1uLnRpbWVycyxnPWQ/ZC5sZW5ndGg6MDtmb3IoYy5maW5pc2g9ITAsbi5xdWV1ZSh0aGlzLGEsW10pLGUmJmUuc3RvcCYmZS5zdG9wLmNhbGwodGhpcywhMCksYj1mLmxlbmd0aDtiLS07KWZbYl0uZWxlbT09PXRoaXMmJmZbYl0ucXVldWU9PT1hJiYoZltiXS5hbmltLnN0b3AoITApLGYuc3BsaWNlKGIsMSkpO2ZvcihiPTA7Zz5iO2IrKylkW2JdJiZkW2JdLmZpbmlzaCYmZFtiXS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgYy5maW5pc2h9KX19KSxuLmVhY2goWyJ0b2dnbGUiLCJzaG93IiwiaGlkZSJdLGZ1bmN0aW9uKGEsYil7dmFyIGM9bi5mbltiXTtuLmZuW2JdPWZ1bmN0aW9uKGEsZCxlKXtyZXR1cm4gbnVsbD09YXx8ImJvb2xlYW4iPT10eXBlb2YgYT9jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUoWGEoYiwhMCksYSxkLGUpfX0pLG4uZWFjaCh7c2xpZGVEb3duOlhhKCJzaG93Iiksc2xpZGVVcDpYYSgiaGlkZSIpLHNsaWRlVG9nZ2xlOlhhKCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKGEsYil7bi5mblthXT1mdW5jdGlvbihhLGMsZCl7cmV0dXJuIHRoaXMuYW5pbWF0ZShiLGEsYyxkKX19KSxuLnRpbWVycz1bXSxuLmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgYSxiPTAsYz1uLnRpbWVycztmb3IoU2E9bi5ub3coKTtiPGMubGVuZ3RoO2IrKylhPWNbYl0sYSgpfHxjW2JdIT09YXx8Yy5zcGxpY2UoYi0tLDEpO2MubGVuZ3RofHxuLmZ4LnN0b3AoKSxTYT12b2lkIDB9LG4uZngudGltZXI9ZnVuY3Rpb24oYSl7bi50aW1lcnMucHVzaChhKSxhKCk/bi5meC5zdGFydCgpOm4udGltZXJzLnBvcCgpfSxuLmZ4LmludGVydmFsPTEzLG4uZnguc3RhcnQ9ZnVuY3Rpb24oKXtUYXx8KFRhPWEuc2V0SW50ZXJ2YWwobi5meC50aWNrLG4uZnguaW50ZXJ2YWwpKX0sbi5meC5zdG9wPWZ1bmN0aW9uKCl7YS5jbGVhckludGVydmFsKFRhKSxUYT1udWxsfSxuLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxuLmZuLmRlbGF5PWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGI9bi5meD9uLmZ4LnNwZWVkc1tiXXx8YjpiLGM9Y3x8ImZ4Iix0aGlzLnF1ZXVlKGMsZnVuY3Rpb24oYyxkKXt2YXIgZT1hLnNldFRpbWVvdXQoYyxiKTtkLnN0b3A9ZnVuY3Rpb24oKXthLmNsZWFyVGltZW91dChlKX19KX0sZnVuY3Rpb24oKXt2YXIgYT1kLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYj1kLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLGM9Yi5hcHBlbmRDaGlsZChkLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTthLnR5cGU9ImNoZWNrYm94IixsLmNoZWNrT249IiIhPT1hLnZhbHVlLGwub3B0U2VsZWN0ZWQ9Yy5zZWxlY3RlZCxiLmRpc2FibGVkPSEwLGwub3B0RGlzYWJsZWQ9IWMuZGlzYWJsZWQsYT1kLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYS52YWx1ZT0idCIsYS50eXBlPSJyYWRpbyIsbC5yYWRpb1ZhbHVlPSJ0Ij09PWEudmFsdWV9KCk7dmFyIGFiLGJiPW4uZXhwci5hdHRySGFuZGxlO24uZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEsodGhpcyxuLmF0dHIsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24ucmVtb3ZlQXR0cih0aGlzLGEpfSl9fSksbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKDMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBhLmdldEF0dHJpYnV0ZT9uLnByb3AoYSxiLGMpOigxPT09ZiYmbi5pc1hNTERvYyhhKXx8KGI9Yi50b0xvd2VyQ2FzZSgpLGU9bi5hdHRySG9va3NbYl18fChuLmV4cHIubWF0Y2guYm9vbC50ZXN0KGIpP2FiOnZvaWQgMCkpLHZvaWQgMCE9PWM/bnVsbD09PWM/dm9pZCBuLnJlbW92ZUF0dHIoYSxiKTplJiYic2V0ImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDooYS5zZXRBdHRyaWJ1dGUoYixjKyIiKSxjKTplJiYiZ2V0ImluIGUmJm51bGwhPT0oZD1lLmdldChhLGIpKT9kOihkPW4uZmluZC5hdHRyKGEsYiksbnVsbD09ZD92b2lkIDA6ZCkpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihhLGIpe2lmKCFsLnJhZGlvVmFsdWUmJiJyYWRpbyI9PT1iJiZuLm5vZGVOYW1lKGEsImlucHV0Iikpe3ZhciBjPWEudmFsdWU7cmV0dXJuIGEuc2V0QXR0cmlidXRlKCJ0eXBlIixiKSxjJiYoYS52YWx1ZT1jKSxifX19fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlPTAsZj1iJiZiLm1hdGNoKEcpO2lmKGYmJjE9PT1hLm5vZGVUeXBlKXdoaWxlKGM9ZltlKytdKWQ9bi5wcm9wRml4W2NdfHxjLG4uZXhwci5tYXRjaC5ib29sLnRlc3QoYykmJihhW2RdPSExKSxhLnJlbW92ZUF0dHJpYnV0ZShjKX19KSxhYj17c2V0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYj09PSExP24ucmVtb3ZlQXR0cihhLGMpOmEuc2V0QXR0cmlidXRlKGMsYyksY319LG4uZWFjaChuLmV4cHIubWF0Y2guYm9vbC5zb3VyY2UubWF0Y2goL1x3Ky9nKSxmdW5jdGlvbihhLGIpe3ZhciBjPWJiW2JdfHxuLmZpbmQuYXR0cjtiYltiXT1mdW5jdGlvbihhLGIsZCl7dmFyIGUsZjtyZXR1cm4gZHx8KGY9YmJbYl0sYmJbYl09ZSxlPW51bGwhPWMoYSxiLGQpP2IudG9Mb3dlckNhc2UoKTpudWxsLGJiW2JdPWYpLGV9fSk7dmFyIGNiPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksZGI9L14oPzphfGFyZWEpJC9pO24uZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEsodGhpcyxuLnByb3AsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW24ucHJvcEZpeFthXXx8YV19KX19KSxuLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPWEubm9kZVR5cGU7aWYoMyE9PWYmJjghPT1mJiYyIT09ZilyZXR1cm4gMT09PWYmJm4uaXNYTUxEb2MoYSl8fChiPW4ucHJvcEZpeFtiXXx8YiwKZT1uLnByb3BIb29rc1tiXSksdm9pZCAwIT09Yz9lJiYic2V0ImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDphW2JdPWM6ZSYmImdldCJpbiBlJiZudWxsIT09KGQ9ZS5nZXQoYSxiKSk/ZDphW2JdfSxwcm9wSG9va3M6e3RhYkluZGV4OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9bi5maW5kLmF0dHIoYSwidGFiaW5kZXgiKTtyZXR1cm4gYj9wYXJzZUludChiLDEwKTpjYi50ZXN0KGEubm9kZU5hbWUpfHxkYi50ZXN0KGEubm9kZU5hbWUpJiZhLmhyZWY/MDotMX19fSxwcm9wRml4OnsiZm9yIjoiaHRtbEZvciIsImNsYXNzIjoiY2xhc3NOYW1lIn19KSxsLm9wdFNlbGVjdGVkfHwobi5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH19KSxuLmVhY2goWyJ0YWJJbmRleCIsInJlYWRPbmx5IiwibWF4TGVuZ3RoIiwiY2VsbFNwYWNpbmciLCJjZWxsUGFkZGluZyIsInJvd1NwYW4iLCJjb2xTcGFuIiwidXNlTWFwIiwiZnJhbWVCb3JkZXIiLCJjb250ZW50RWRpdGFibGUiXSxmdW5jdGlvbigpe24ucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXN9KTt2YXIgZWI9L1tcdFxyXG5cZl0vZztmdW5jdGlvbiBmYihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIn1uLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaT0wO2lmKG4uaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsYixmYih0aGlzKSkpfSk7aWYoInN0cmluZyI9PXR5cGVvZiBhJiZhKXtiPWEubWF0Y2goRyl8fFtdO3doaWxlKGM9dGhpc1tpKytdKWlmKGU9ZmIoYyksZD0xPT09Yy5ub2RlVHlwZSYmKCIgIitlKyIgIikucmVwbGFjZShlYiwiICIpKXtnPTA7d2hpbGUoZj1iW2crK10pZC5pbmRleE9mKCIgIitmKyIgIik8MCYmKGQrPWYrIiAiKTtoPW4udHJpbShkKSxlIT09aCYmYy5zZXRBdHRyaWJ1dGUoImNsYXNzIixoKX19cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoLGk9MDtpZihuLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtuKHRoaXMpLnJlbW92ZUNsYXNzKGEuY2FsbCh0aGlzLGIsZmIodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoInN0cmluZyI9PXR5cGVvZiBhJiZhKXtiPWEubWF0Y2goRyl8fFtdO3doaWxlKGM9dGhpc1tpKytdKWlmKGU9ZmIoYyksZD0xPT09Yy5ub2RlVHlwZSYmKCIgIitlKyIgIikucmVwbGFjZShlYiwiICIpKXtnPTA7d2hpbGUoZj1iW2crK10pd2hpbGUoZC5pbmRleE9mKCIgIitmKyIgIik+LTEpZD1kLnJlcGxhY2UoIiAiK2YrIiAiLCIgIik7aD1uLnRyaW0oZCksZSE9PWgmJmMuc2V0QXR0cmlidXRlKCJjbGFzcyIsaCl9fXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBjPXR5cGVvZiBhO3JldHVybiJib29sZWFuIj09dHlwZW9mIGImJiJzdHJpbmciPT09Yz9iP3RoaXMuYWRkQ2xhc3MoYSk6dGhpcy5yZW1vdmVDbGFzcyhhKTpuLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGMpe24odGhpcykudG9nZ2xlQ2xhc3MoYS5jYWxsKHRoaXMsYyxmYih0aGlzKSxiKSxiKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiLGQsZSxmO2lmKCJzdHJpbmciPT09Yyl7ZD0wLGU9bih0aGlzKSxmPWEubWF0Y2goRyl8fFtdO3doaWxlKGI9ZltkKytdKWUuaGFzQ2xhc3MoYik/ZS5yZW1vdmVDbGFzcyhiKTplLmFkZENsYXNzKGIpfWVsc2Uodm9pZCAwPT09YXx8ImJvb2xlYW4iPT09YykmJihiPWZiKHRoaXMpLGImJk4uc2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iLGIpLHRoaXMuc2V0QXR0cmlidXRlJiZ0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGJ8fGE9PT0hMT8iIjpOLmdldCh0aGlzLCJfX2NsYXNzTmFtZV9fIil8fCIiKSl9KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPTA7Yj0iICIrYSsiICI7d2hpbGUoYz10aGlzW2QrK10paWYoMT09PWMubm9kZVR5cGUmJigiICIrZmIoYykrIiAiKS5yZXBsYWNlKGViLCIgIikuaW5kZXhPZihiKT4tMSlyZXR1cm4hMDtyZXR1cm4hMX19KTt2YXIgZ2I9L1xyL2c7bi5mbi5leHRlbmQoe3ZhbDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZT10aGlzWzBdO3tpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiBkPW4uaXNGdW5jdGlvbihhKSx0aGlzLmVhY2goZnVuY3Rpb24oYyl7dmFyIGU7MT09PXRoaXMubm9kZVR5cGUmJihlPWQ/YS5jYWxsKHRoaXMsYyxuKHRoaXMpLnZhbCgpKTphLG51bGw9PWU/ZT0iIjoibnVtYmVyIj09dHlwZW9mIGU/ZSs9IiI6bi5pc0FycmF5KGUpJiYoZT1uLm1hcChlLGZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOmErIiJ9KSksYj1uLnZhbEhvb2tzW3RoaXMudHlwZV18fG4udmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSxiJiYic2V0ImluIGImJnZvaWQgMCE9PWIuc2V0KHRoaXMsZSwidmFsdWUiKXx8KHRoaXMudmFsdWU9ZSkpfSk7aWYoZSlyZXR1cm4gYj1uLnZhbEhvb2tzW2UudHlwZV18fG4udmFsSG9va3NbZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSxiJiYiZ2V0ImluIGImJnZvaWQgMCE9PShjPWIuZ2V0KGUsInZhbHVlIikpP2M6KGM9ZS52YWx1ZSwic3RyaW5nIj09dHlwZW9mIGM/Yy5yZXBsYWNlKGdiLCIiKTpudWxsPT1jPyIiOmMpfX19KSxuLmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGEpe3JldHVybiBuLnRyaW0oYS52YWx1ZSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkPWEub3B0aW9ucyxlPWEuc2VsZWN0ZWRJbmRleCxmPSJzZWxlY3Qtb25lIj09PWEudHlwZXx8MD5lLGc9Zj9udWxsOltdLGg9Zj9lKzE6ZC5sZW5ndGgsaT0wPmU/aDpmP2U6MDtoPmk7aSsrKWlmKGM9ZFtpXSwoYy5zZWxlY3RlZHx8aT09PWUpJiYobC5vcHREaXNhYmxlZD8hYy5kaXNhYmxlZDpudWxsPT09Yy5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIikpJiYoIWMucGFyZW50Tm9kZS5kaXNhYmxlZHx8IW4ubm9kZU5hbWUoYy5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7aWYoYj1uKGMpLnZhbCgpLGYpcmV0dXJuIGI7Zy5wdXNoKGIpfXJldHVybiBnfSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGU9YS5vcHRpb25zLGY9bi5tYWtlQXJyYXkoYiksZz1lLmxlbmd0aDt3aGlsZShnLS0pZD1lW2ddLChkLnNlbGVjdGVkPW4uaW5BcnJheShuLnZhbEhvb2tzLm9wdGlvbi5nZXQoZCksZik+LTEpJiYoYz0hMCk7cmV0dXJuIGN8fChhLnNlbGVjdGVkSW5kZXg9LTEpLGZ9fX19KSxuLmVhY2goWyJyYWRpbyIsImNoZWNrYm94Il0sZnVuY3Rpb24oKXtuLnZhbEhvb2tzW3RoaXNdPXtzZXQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5pc0FycmF5KGIpP2EuY2hlY2tlZD1uLmluQXJyYXkobihhKS52YWwoKSxiKT4tMTp2b2lkIDB9fSxsLmNoZWNrT258fChuLnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09PWEuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPyJvbiI6YS52YWx1ZX0pfSk7dmFyIGhiPS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLztuLmV4dGVuZChuLmV2ZW50LHt0cmlnZ2VyOmZ1bmN0aW9uKGIsYyxlLGYpe3ZhciBnLGgsaSxqLGwsbSxvLHA9W2V8fGRdLHE9ay5jYWxsKGIsInR5cGUiKT9iLnR5cGU6YixyPWsuY2FsbChiLCJuYW1lc3BhY2UiKT9iLm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKGg9aT1lPWV8fGQsMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiYhaGIudGVzdChxK24uZXZlbnQudHJpZ2dlcmVkKSYmKHEuaW5kZXhPZigiLiIpPi0xJiYocj1xLnNwbGl0KCIuIikscT1yLnNoaWZ0KCksci5zb3J0KCkpLGw9cS5pbmRleE9mKCI6Iik8MCYmIm9uIitxLGI9YltuLmV4cGFuZG9dP2I6bmV3IG4uRXZlbnQocSwib2JqZWN0Ij09dHlwZW9mIGImJmIpLGIuaXNUcmlnZ2VyPWY/MjozLGIubmFtZXNwYWNlPXIuam9pbigiLiIpLGIucm5hbWVzcGFjZT1iLm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIityLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGwsYi5yZXN1bHQ9dm9pZCAwLGIudGFyZ2V0fHwoYi50YXJnZXQ9ZSksYz1udWxsPT1jP1tiXTpuLm1ha2VBcnJheShjLFtiXSksbz1uLmV2ZW50LnNwZWNpYWxbcV18fHt9LGZ8fCFvLnRyaWdnZXJ8fG8udHJpZ2dlci5hcHBseShlLGMpIT09ITEpKXtpZighZiYmIW8ubm9CdWJibGUmJiFuLmlzV2luZG93KGUpKXtmb3Ioaj1vLmRlbGVnYXRlVHlwZXx8cSxoYi50ZXN0KGorcSl8fChoPWgucGFyZW50Tm9kZSk7aDtoPWgucGFyZW50Tm9kZSlwLnB1c2goaCksaT1oO2k9PT0oZS5vd25lckRvY3VtZW50fHxkKSYmcC5wdXNoKGkuZGVmYXVsdFZpZXd8fGkucGFyZW50V2luZG93fHxhKX1nPTA7d2hpbGUoKGg9cFtnKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSliLnR5cGU9Zz4xP2o6by5iaW5kVHlwZXx8cSxtPShOLmdldChoLCJldmVudHMiKXx8e30pW2IudHlwZV0mJk4uZ2V0KGgsImhhbmRsZSIpLG0mJm0uYXBwbHkoaCxjKSxtPWwmJmhbbF0sbSYmbS5hcHBseSYmTChoKSYmKGIucmVzdWx0PW0uYXBwbHkoaCxjKSxiLnJlc3VsdD09PSExJiZiLnByZXZlbnREZWZhdWx0KCkpO3JldHVybiBiLnR5cGU9cSxmfHxiLmlzRGVmYXVsdFByZXZlbnRlZCgpfHxvLl9kZWZhdWx0JiZvLl9kZWZhdWx0LmFwcGx5KHAucG9wKCksYykhPT0hMXx8IUwoZSl8fGwmJm4uaXNGdW5jdGlvbihlW3FdKSYmIW4uaXNXaW5kb3coZSkmJihpPWVbbF0saSYmKGVbbF09bnVsbCksbi5ldmVudC50cmlnZ2VyZWQ9cSxlW3FdKCksbi5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLGkmJihlW2xdPWkpKSxiLnJlc3VsdH19LHNpbXVsYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1uLmV4dGVuZChuZXcgbi5FdmVudCxjLHt0eXBlOmEsaXNTaW11bGF0ZWQ6ITB9KTtuLmV2ZW50LnRyaWdnZXIoZCxudWxsLGIpLGQuaXNEZWZhdWx0UHJldmVudGVkKCkmJmMucHJldmVudERlZmF1bHQoKX19KSxuLmZuLmV4dGVuZCh7dHJpZ2dlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpc1swXTtyZXR1cm4gYz9uLmV2ZW50LnRyaWdnZXIoYSxiLGMsITApOnZvaWQgMH19KSxuLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSxiKXtuLmZuW2JdPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg+MD90aGlzLm9uKGIsbnVsbCxhLGMpOnRoaXMudHJpZ2dlcihiKX19KSxuLmZuLmV4dGVuZCh7aG92ZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5tb3VzZWVudGVyKGEpLm1vdXNlbGVhdmUoYnx8YSl9fSksbC5mb2N1c2luPSJvbmZvY3VzaW4iaW4gYSxsLmZvY3VzaW58fG4uZWFjaCh7Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0In0sZnVuY3Rpb24oYSxiKXt2YXIgYz1mdW5jdGlvbihhKXtuLmV2ZW50LnNpbXVsYXRlKGIsYS50YXJnZXQsbi5ldmVudC5maXgoYSkpfTtuLmV2ZW50LnNwZWNpYWxbYl09e3NldHVwOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGU9Ti5hY2Nlc3MoZCxiKTtlfHxkLmFkZEV2ZW50TGlzdGVuZXIoYSxjLCEwKSxOLmFjY2VzcyhkLGIsKGV8fDApKzEpfSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBkPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxlPU4uYWNjZXNzKGQsYiktMTtlP04uYWNjZXNzKGQsYixlKTooZC5yZW1vdmVFdmVudExpc3RlbmVyKGEsYywhMCksTi5yZW1vdmUoZCxiKSl9fX0pO3ZhciBpYj1hLmxvY2F0aW9uLGpiPW4ubm93KCksa2I9L1w/LztuLnBhcnNlSlNPTj1mdW5jdGlvbihhKXtyZXR1cm4gSlNPTi5wYXJzZShhKyIiKX0sbi5wYXJzZVhNTD1mdW5jdGlvbihiKXt2YXIgYztpZighYnx8InN0cmluZyIhPXR5cGVvZiBiKXJldHVybiBudWxsO3RyeXtjPShuZXcgYS5ET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyhiLCJ0ZXh0L3htbCIpfWNhdGNoKGQpe2M9dm9pZCAwfXJldHVybighY3x8Yy5nZXRFbGVtZW50c0J5VGFnTmFtZSgicGFyc2VyZXJyb3IiKS5sZW5ndGgpJiZuLmVycm9yKCJJbnZhbGlkIFhNTDogIitiKSxjfTt2YXIgbGI9LyMuKiQvLG1iPS8oWz8mXSlfPVteJl0qLyxuYj0vXiguKj8pOlsgXHRdKihbXlxyXG5dKikkL2dtLG9iPS9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLHBiPS9eKD86R0VUfEhFQUQpJC8scWI9L15cL1wvLyxyYj17fSxzYj17fSx0Yj0iKi8iLmNvbmNhdCgiKiIpLHViPWQuY3JlYXRlRWxlbWVudCgiYSIpO3ViLmhyZWY9aWIuaHJlZjtmdW5jdGlvbiB2YihhKXtyZXR1cm4gZnVuY3Rpb24oYixjKXsic3RyaW5nIiE9dHlwZW9mIGImJihjPWIsYj0iKiIpO3ZhciBkLGU9MCxmPWIudG9Mb3dlckNhc2UoKS5tYXRjaChHKXx8W107aWYobi5pc0Z1bmN0aW9uKGMpKXdoaWxlKGQ9ZltlKytdKSIrIj09PWRbMF0/KGQ9ZC5zbGljZSgxKXx8IioiLChhW2RdPWFbZF18fFtdKS51bnNoaWZ0KGMpKTooYVtkXT1hW2RdfHxbXSkucHVzaChjKX19ZnVuY3Rpb24gd2IoYSxiLGMsZCl7dmFyIGU9e30sZj1hPT09c2I7ZnVuY3Rpb24gZyhoKXt2YXIgaTtyZXR1cm4gZVtoXT0hMCxuLmVhY2goYVtoXXx8W10sZnVuY3Rpb24oYSxoKXt2YXIgaj1oKGIsYyxkKTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGp8fGZ8fGVbal0/Zj8hKGk9aik6dm9pZCAwOihiLmRhdGFUeXBlcy51bnNoaWZ0KGopLGcoaiksITEpfSksaX1yZXR1cm4gZyhiLmRhdGFUeXBlc1swXSl8fCFlWyIqIl0mJmcoIioiKX1mdW5jdGlvbiB4YihhLGIpe3ZhciBjLGQsZT1uLmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGMgaW4gYil2b2lkIDAhPT1iW2NdJiYoKGVbY10/YTpkfHwoZD17fSkpW2NdPWJbY10pO3JldHVybiBkJiZuLmV4dGVuZCghMCxhLGQpLGF9ZnVuY3Rpb24geWIoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5jb250ZW50cyxpPWEuZGF0YVR5cGVzO3doaWxlKCIqIj09PWlbMF0paS5zaGlmdCgpLHZvaWQgMD09PWQmJihkPWEubWltZVR5cGV8fGIuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihkKWZvcihlIGluIGgpaWYoaFtlXSYmaFtlXS50ZXN0KGQpKXtpLnVuc2hpZnQoZSk7YnJlYWt9aWYoaVswXWluIGMpZj1pWzBdO2Vsc2V7Zm9yKGUgaW4gYyl7aWYoIWlbMF18fGEuY29udmVydGVyc1tlKyIgIitpWzBdXSl7Zj1lO2JyZWFrfWd8fChnPWUpfWY9Znx8Z31yZXR1cm4gZj8oZiE9PWlbMF0mJmkudW5zaGlmdChmKSxjW2ZdKTp2b2lkIDB9ZnVuY3Rpb24gemIoYSxiLGMsZCl7dmFyIGUsZixnLGgsaSxqPXt9LGs9YS5kYXRhVHlwZXMuc2xpY2UoKTtpZihrWzFdKWZvcihnIGluIGEuY29udmVydGVycylqW2cudG9Mb3dlckNhc2UoKV09YS5jb252ZXJ0ZXJzW2ddO2Y9ay5zaGlmdCgpO3doaWxlKGYpaWYoYS5yZXNwb25zZUZpZWxkc1tmXSYmKGNbYS5yZXNwb25zZUZpZWxkc1tmXV09YiksIWkmJmQmJmEuZGF0YUZpbHRlciYmKGI9YS5kYXRhRmlsdGVyKGIsYS5kYXRhVHlwZSkpLGk9ZixmPWsuc2hpZnQoKSlpZigiKiI9PT1mKWY9aTtlbHNlIGlmKCIqIiE9PWkmJmkhPT1mKXtpZihnPWpbaSsiICIrZl18fGpbIiogIitmXSwhZylmb3IoZSBpbiBqKWlmKGg9ZS5zcGxpdCgiICIpLGhbMV09PT1mJiYoZz1qW2krIiAiK2hbMF1dfHxqWyIqICIraFswXV0pKXtnPT09ITA/Zz1qW2VdOmpbZV0hPT0hMCYmKGY9aFswXSxrLnVuc2hpZnQoaFsxXSkpO2JyZWFrfWlmKGchPT0hMClpZihnJiZhWyJ0aHJvd3MiXSliPWcoYik7ZWxzZSB0cnl7Yj1nKGIpfWNhdGNoKGwpe3JldHVybntzdGF0ZToicGFyc2VyZXJyb3IiLGVycm9yOmc/bDoiTm8gY29udmVyc2lvbiBmcm9tICIraSsiIHRvICIrZn19fXJldHVybntzdGF0ZToic3VjY2VzcyIsZGF0YTpifX1uLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6aWIuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6b2IudGVzdChpYi5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjp0Yix0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpuLnBhcnNlSlNPTiwidGV4dCB4bWwiOm4ucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6ITAsY29udGV4dDohMH19LGFqYXhTZXR1cDpmdW5jdGlvbihhLGIpe3JldHVybiBiP3hiKHhiKGEsbi5hamF4U2V0dGluZ3MpLGIpOnhiKG4uYWpheFNldHRpbmdzLGEpfSxhamF4UHJlZmlsdGVyOnZiKHJiKSxhamF4VHJhbnNwb3J0OnZiKHNiKSxhamF4OmZ1bmN0aW9uKGIsYyl7Im9iamVjdCI9PXR5cGVvZiBiJiYoYz1iLGI9dm9pZCAwKSxjPWN8fHt9O3ZhciBlLGYsZyxoLGksaixrLGwsbT1uLmFqYXhTZXR1cCh7fSxjKSxvPW0uY29udGV4dHx8bSxwPW0uY29udGV4dCYmKG8ubm9kZVR5cGV8fG8uanF1ZXJ5KT9uKG8pOm4uZXZlbnQscT1uLkRlZmVycmVkKCkscj1uLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSxzPW0uc3RhdHVzQ29kZXx8e30sdD17fSx1PXt9LHY9MCx3PSJjYW5jZWxlZCIseD17cmVhZHlTdGF0ZTowLGdldFJlc3BvbnNlSGVhZGVyOmZ1bmN0aW9uKGEpe3ZhciBiO2lmKDI9PT12KXtpZighaCl7aD17fTt3aGlsZShiPW5iLmV4ZWMoZykpaFtiWzFdLnRvTG93ZXJDYXNlKCldPWJbMl19Yj1oW2EudG9Mb3dlckNhc2UoKV19cmV0dXJuIG51bGw9PWI/bnVsbDpifSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gMj09PXY/ZzpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS50b0xvd2VyQ2FzZSgpO3JldHVybiB2fHwoYT11W2NdPXVbY118fGEsdFthXT1iKSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGEpe3JldHVybiB2fHwobS5taW1lVHlwZT1hKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGEpe3ZhciBiO2lmKGEpaWYoMj52KWZvcihiIGluIGEpc1tiXT1bc1tiXSxhW2JdXTtlbHNlIHguYWx3YXlzKGFbeC5zdGF0dXNdKTtyZXR1cm4gdGhpc30sYWJvcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YXx8dztyZXR1cm4gZSYmZS5hYm9ydChiKSx6KDAsYiksdGhpc319O2lmKHEucHJvbWlzZSh4KS5jb21wbGV0ZT1yLmFkZCx4LnN1Y2Nlc3M9eC5kb25lLHguZXJyb3I9eC5mYWlsLG0udXJsPSgoYnx8bS51cmx8fGliLmhyZWYpKyIiKS5yZXBsYWNlKGxiLCIiKS5yZXBsYWNlKHFiLGliLnByb3RvY29sKyIvLyIpLG0udHlwZT1jLm1ldGhvZHx8Yy50eXBlfHxtLm1ldGhvZHx8bS50eXBlLG0uZGF0YVR5cGVzPW4udHJpbShtLmRhdGFUeXBlfHwiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2goRyl8fFsiIl0sbnVsbD09bS5jcm9zc0RvbWFpbil7aj1kLmNyZWF0ZUVsZW1lbnQoImEiKTt0cnl7ai5ocmVmPW0udXJsLGouaHJlZj1qLmhyZWYsbS5jcm9zc0RvbWFpbj11Yi5wcm90b2NvbCsiLy8iK3ViLmhvc3QhPWoucHJvdG9jb2wrIi8vIitqLmhvc3R9Y2F0Y2goeSl7bS5jcm9zc0RvbWFpbj0hMH19aWYobS5kYXRhJiZtLnByb2Nlc3NEYXRhJiYic3RyaW5nIiE9dHlwZW9mIG0uZGF0YSYmKG0uZGF0YT1uLnBhcmFtKG0uZGF0YSxtLnRyYWRpdGlvbmFsKSksd2IocmIsbSxjLHgpLDI9PT12KXJldHVybiB4O2s9bi5ldmVudCYmbS5nbG9iYWwsayYmMD09PW4uYWN0aXZlKysmJm4uZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0IiksbS50eXBlPW0udHlwZS50b1VwcGVyQ2FzZSgpLG0uaGFzQ29udGVudD0hcGIudGVzdChtLnR5cGUpLGY9bS51cmwsbS5oYXNDb250ZW50fHwobS5kYXRhJiYoZj1tLnVybCs9KGtiLnRlc3QoZik/IiYiOiI/IikrbS5kYXRhLGRlbGV0ZSBtLmRhdGEpLG0uY2FjaGU9PT0hMSYmKG0udXJsPW1iLnRlc3QoZik/Zi5yZXBsYWNlKG1iLCIkMV89IitqYisrKTpmKyhrYi50ZXN0KGYpPyImIjoiPyIpKyJfPSIramIrKykpLG0uaWZNb2RpZmllZCYmKG4ubGFzdE1vZGlmaWVkW2ZdJiZ4LnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIixuLmxhc3RNb2RpZmllZFtmXSksbi5ldGFnW2ZdJiZ4LnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLG4uZXRhZ1tmXSkpLChtLmRhdGEmJm0uaGFzQ29udGVudCYmbS5jb250ZW50VHlwZSE9PSExfHxjLmNvbnRlbnRUeXBlKSYmeC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLG0uY29udGVudFR5cGUpLHguc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixtLmRhdGFUeXBlc1swXSYmbS5hY2NlcHRzW20uZGF0YVR5cGVzWzBdXT9tLmFjY2VwdHNbbS5kYXRhVHlwZXNbMF1dKygiKiIhPT1tLmRhdGFUeXBlc1swXT8iLCAiK3RiKyI7IHE9MC4wMSI6IiIpOm0uYWNjZXB0c1siKiJdKTtmb3IobCBpbiBtLmhlYWRlcnMpeC5zZXRSZXF1ZXN0SGVhZGVyKGwsbS5oZWFkZXJzW2xdKTtpZihtLmJlZm9yZVNlbmQmJihtLmJlZm9yZVNlbmQuY2FsbChvLHgsbSk9PT0hMXx8Mj09PXYpKXJldHVybiB4LmFib3J0KCk7dz0iYWJvcnQiO2ZvcihsIGlue3N1Y2Nlc3M6MSxlcnJvcjoxLGNvbXBsZXRlOjF9KXhbbF0obVtsXSk7aWYoZT13YihzYixtLGMseCkpe2lmKHgucmVhZHlTdGF0ZT0xLGsmJnAudHJpZ2dlcigiYWpheFNlbmQiLFt4LG1dKSwyPT09dilyZXR1cm4geDttLmFzeW5jJiZtLnRpbWVvdXQ+MCYmKGk9YS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7eC5hYm9ydCgidGltZW91dCIpfSxtLnRpbWVvdXQpKTt0cnl7dj0xLGUuc2VuZCh0LHopfWNhdGNoKHkpe2lmKCEoMj52KSl0aHJvdyB5O3ooLTEseSl9fWVsc2UgeigtMSwiTm8gVHJhbnNwb3J0Iik7ZnVuY3Rpb24geihiLGMsZCxoKXt2YXIgaixsLHQsdSx3LHk9YzsyIT09diYmKHY9MixpJiZhLmNsZWFyVGltZW91dChpKSxlPXZvaWQgMCxnPWh8fCIiLHgucmVhZHlTdGF0ZT1iPjA/NDowLGo9Yj49MjAwJiYzMDA+Ynx8MzA0PT09YixkJiYodT15YihtLHgsZCkpLHU9emIobSx1LHgsaiksaj8obS5pZk1vZGlmaWVkJiYodz14LmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIiksdyYmKG4ubGFzdE1vZGlmaWVkW2ZdPXcpLHc9eC5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpLHcmJihuLmV0YWdbZl09dykpLDIwND09PWJ8fCJIRUFEIj09PW0udHlwZT95PSJub2NvbnRlbnQiOjMwND09PWI/eT0ibm90bW9kaWZpZWQiOih5PXUuc3RhdGUsbD11LmRhdGEsdD11LmVycm9yLGo9IXQpKToodD15LChifHwheSkmJih5PSJlcnJvciIsMD5iJiYoYj0wKSkpLHguc3RhdHVzPWIseC5zdGF0dXNUZXh0PShjfHx5KSsiIixqP3EucmVzb2x2ZVdpdGgobyxbbCx5LHhdKTpxLnJlamVjdFdpdGgobyxbeCx5LHRdKSx4LnN0YXR1c0NvZGUocykscz12b2lkIDAsayYmcC50cmlnZ2VyKGo/ImFqYXhTdWNjZXNzIjoiYWpheEVycm9yIixbeCxtLGo/bDp0XSksci5maXJlV2l0aChvLFt4LHldKSxrJiYocC50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFt4LG1dKSwtLW4uYWN0aXZlfHxuLmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4geH0sZ2V0SlNPTjpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG4uZ2V0KGEsYixjLCJqc29uIil9LGdldFNjcmlwdDpmdW5jdGlvbihhLGIpe3JldHVybiBuLmdldChhLHZvaWQgMCxiLCJzY3JpcHQiKX19KSxuLmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oYSxiKXtuW2JdPWZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBuLmlzRnVuY3Rpb24oYykmJihlPWV8fGQsZD1jLGM9dm9pZCAwKSxuLmFqYXgobi5leHRlbmQoe3VybDphLHR5cGU6YixkYXRhVHlwZTplLGRhdGE6YyxzdWNjZXNzOmR9LG4uaXNQbGFpbk9iamVjdChhKSYmYSkpfX0pLG4uX2V2YWxVcmw9ZnVuY3Rpb24oYSl7cmV0dXJuIG4uYWpheCh7dXJsOmEsdHlwZToiR0VUIixkYXRhVHlwZToic2NyaXB0Iixhc3luYzohMSxnbG9iYWw6ITEsInRocm93cyI6ITB9KX0sbi5mbi5leHRlbmQoe3dyYXBBbGw6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIG4uaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oYil7bih0aGlzKS53cmFwQWxsKGEuY2FsbCh0aGlzLGIpKX0pOih0aGlzWzBdJiYoYj1uKGEsdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSghMCksdGhpc1swXS5wYXJlbnROb2RlJiZiLmluc2VydEJlZm9yZSh0aGlzWzBdKSxiLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXM7d2hpbGUoYS5maXJzdEVsZW1lbnRDaGlsZClhPWEuZmlyc3RFbGVtZW50Q2hpbGQ7cmV0dXJuIGF9KS5hcHBlbmQodGhpcykpLHRoaXMpfSx3cmFwSW5uZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oYil7bih0aGlzKS53cmFwSW5uZXIoYS5jYWxsKHRoaXMsYikpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9bih0aGlzKSxjPWIuY29udGVudHMoKTtjLmxlbmd0aD9jLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXt2YXIgYj1uLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXtuKHRoaXMpLndyYXBBbGwoYj9hLmNhbGwodGhpcyxjKTphKX0pfSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7bi5ub2RlTmFtZSh0aGlzLCJib2R5Iil8fG4odGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLmVuZCgpfX0pLG4uZXhwci5maWx0ZXJzLmhpZGRlbj1mdW5jdGlvbihhKXtyZXR1cm4hbi5leHByLmZpbHRlcnMudmlzaWJsZShhKX0sbi5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4gYS5vZmZzZXRXaWR0aD4wfHxhLm9mZnNldEhlaWdodD4wfHxhLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPjB9O3ZhciBBYj0vJTIwL2csQmI9L1xbXF0kLyxDYj0vXHI/XG4vZyxEYj0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksRWI9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIEZiKGEsYixjLGQpe3ZhciBlO2lmKG4uaXNBcnJheShiKSluLmVhY2goYixmdW5jdGlvbihiLGUpe2N8fEJiLnRlc3QoYSk/ZChhLGUpOkZiKGErIlsiKygib2JqZWN0Ij09dHlwZW9mIGUmJm51bGwhPWU/YjoiIikrIl0iLGUsYyxkKX0pO2Vsc2UgaWYoY3x8Im9iamVjdCIhPT1uLnR5cGUoYikpZChhLGIpO2Vsc2UgZm9yKGUgaW4gYilGYihhKyJbIitlKyJdIixiW2VdLGMsZCl9bi5wYXJhbT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT1mdW5jdGlvbihhLGIpe2I9bi5pc0Z1bmN0aW9uKGIpP2IoKTpudWxsPT1iPyIiOmIsZFtkLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGEpKyI9IitlbmNvZGVVUklDb21wb25lbnQoYil9O2lmKHZvaWQgMD09PWImJihiPW4uYWpheFNldHRpbmdzJiZuLmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbCksbi5pc0FycmF5KGEpfHxhLmpxdWVyeSYmIW4uaXNQbGFpbk9iamVjdChhKSluLmVhY2goYSxmdW5jdGlvbigpe2UodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IoYyBpbiBhKUZiKGMsYVtjXSxiLGUpO3JldHVybiBkLmpvaW4oIiYiKS5yZXBsYWNlKEFiLCIrIil9LG4uZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gbi5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPW4ucHJvcCh0aGlzLCJlbGVtZW50cyIpO3JldHVybiBhP24ubWFrZUFycmF5KGEpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgYT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIW4odGhpcykuaXMoIjpkaXNhYmxlZCIpJiZFYi50ZXN0KHRoaXMubm9kZU5hbWUpJiYhRGIudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IVgudGVzdChhKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXt2YXIgYz1uKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1jP251bGw6bi5pc0FycmF5KGMpP24ubWFwKGMsZnVuY3Rpb24oYSl7cmV0dXJue25hbWU6Yi5uYW1lLHZhbHVlOmEucmVwbGFjZShDYiwiXHJcbiIpfX0pOntuYW1lOmIubmFtZSx2YWx1ZTpjLnJlcGxhY2UoQ2IsIlxyXG4iKX19KS5nZXQoKX19KSxuLmFqYXhTZXR0aW5ncy54aHI9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG5ldyBhLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGIpe319O3ZhciBHYj17MDoyMDAsMTIyMzoyMDR9LEhiPW4uYWpheFNldHRpbmdzLnhocigpO2wuY29ycz0hIUhiJiYid2l0aENyZWRlbnRpYWxzImluIEhiLGwuYWpheD1IYj0hIUhiLG4uYWpheFRyYW5zcG9ydChmdW5jdGlvbihiKXt2YXIgYyxkO3JldHVybiBsLmNvcnN8fEhiJiYhYi5jcm9zc0RvbWFpbj97c2VuZDpmdW5jdGlvbihlLGYpe3ZhciBnLGg9Yi54aHIoKTtpZihoLm9wZW4oYi50eXBlLGIudXJsLGIuYXN5bmMsYi51c2VybmFtZSxiLnBhc3N3b3JkKSxiLnhockZpZWxkcylmb3IoZyBpbiBiLnhockZpZWxkcyloW2ddPWIueGhyRmllbGRzW2ddO2IubWltZVR5cGUmJmgub3ZlcnJpZGVNaW1lVHlwZSYmaC5vdmVycmlkZU1pbWVUeXBlKGIubWltZVR5cGUpLGIuY3Jvc3NEb21haW58fGVbIlgtUmVxdWVzdGVkLVdpdGgiXXx8KGVbIlgtUmVxdWVzdGVkLVdpdGgiXT0iWE1MSHR0cFJlcXVlc3QiKTtmb3IoZyBpbiBlKWguc2V0UmVxdWVzdEhlYWRlcihnLGVbZ10pO2M9ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7YyYmKGM9ZD1oLm9ubG9hZD1oLm9uZXJyb3I9aC5vbmFib3J0PWgub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsImFib3J0Ij09PWE/aC5hYm9ydCgpOiJlcnJvciI9PT1hPyJudW1iZXIiIT10eXBlb2YgaC5zdGF0dXM/ZigwLCJlcnJvciIpOmYoaC5zdGF0dXMsaC5zdGF0dXNUZXh0KTpmKEdiW2guc3RhdHVzXXx8aC5zdGF0dXMsaC5zdGF0dXNUZXh0LCJ0ZXh0IiE9PShoLnJlc3BvbnNlVHlwZXx8InRleHQiKXx8InN0cmluZyIhPXR5cGVvZiBoLnJlc3BvbnNlVGV4dD97YmluYXJ5OmgucmVzcG9uc2V9Ont0ZXh0OmgucmVzcG9uc2VUZXh0fSxoLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSl9fSxoLm9ubG9hZD1jKCksZD1oLm9uZXJyb3I9YygiZXJyb3IiKSx2b2lkIDAhPT1oLm9uYWJvcnQ/aC5vbmFib3J0PWQ6aC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXs0PT09aC5yZWFkeVN0YXRlJiZhLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtjJiZkKCl9KX0sYz1jKCJhYm9ydCIpO3RyeXtoLnNlbmQoYi5oYXNDb250ZW50JiZiLmRhdGF8fG51bGwpfWNhdGNoKGkpe2lmKGMpdGhyb3cgaX19LGFib3J0OmZ1bmN0aW9uKCl7YyYmYygpfX06dm9pZCAwfSksbi5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDoidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQifSxjb250ZW50czp7c2NyaXB0Oi9cYig/OmphdmF8ZWNtYSlzY3JpcHRcYi99LGNvbnZlcnRlcnM6eyJ0ZXh0IHNjcmlwdCI6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZ2xvYmFsRXZhbChhKSxhfX19KSxuLmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5jYWNoZSYmKGEuY2FjaGU9ITEpLGEuY3Jvc3NEb21haW4mJihhLnR5cGU9IkdFVCIpfSksbi5hamF4VHJhbnNwb3J0KCJzY3JpcHQiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSxmKXtiPW4oIjxzY3JpcHQ+IikucHJvcCh7Y2hhcnNldDphLnNjcmlwdENoYXJzZXQsc3JjOmEudXJsfSkub24oImxvYWQgZXJyb3IiLGM9ZnVuY3Rpb24oYSl7Yi5yZW1vdmUoKSxjPW51bGwsYSYmZigiZXJyb3IiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGQuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgSWI9W10sSmI9Lyg9KVw/KD89JnwkKXxcP1w/LztuLmFqYXhTZXR1cCh7anNvbnA6ImNhbGxiYWNrIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGE9SWIucG9wKCl8fG4uZXhwYW5kbysiXyIramIrKztyZXR1cm4gdGhpc1thXT0hMCxhfX0pLG4uYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKEpiLnRlc3QoYi51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgYi5kYXRhJiYwPT09KGIuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmSmIudGVzdChiLmRhdGEpJiYiZGF0YSIpO3JldHVybiBofHwianNvbnAiPT09Yi5kYXRhVHlwZXNbMF0/KGU9Yi5qc29ucENhbGxiYWNrPW4uaXNGdW5jdGlvbihiLmpzb25wQ2FsbGJhY2spP2IuanNvbnBDYWxsYmFjaygpOmIuanNvbnBDYWxsYmFjayxoP2JbaF09YltoXS5yZXBsYWNlKEpiLCIkMSIrZSk6Yi5qc29ucCE9PSExJiYoYi51cmwrPShrYi50ZXN0KGIudXJsKT8iJiI6Ij8iKStiLmpzb25wKyI9IitlKSxiLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtyZXR1cm4gZ3x8bi5lcnJvcihlKyIgd2FzIG5vdCBjYWxsZWQiKSxnWzBdfSxiLmRhdGFUeXBlc1swXT0ianNvbiIsZj1hW2VdLGFbZV09ZnVuY3Rpb24oKXtnPWFyZ3VtZW50c30sZC5hbHdheXMoZnVuY3Rpb24oKXt2b2lkIDA9PT1mP24oYSkucmVtb3ZlUHJvcChlKTphW2VdPWYsYltlXSYmKGIuanNvbnBDYWxsYmFjaz1jLmpzb25wQ2FsbGJhY2ssSWIucHVzaChlKSksZyYmbi5pc0Z1bmN0aW9uKGYpJiZmKGdbMF0pLGc9Zj12b2lkIDB9KSwic2NyaXB0Iik6dm9pZCAwfSksbC5jcmVhdGVIVE1MRG9jdW1lbnQ9ZnVuY3Rpb24oKXt2YXIgYT1kLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keTtyZXR1cm4gYS5pbm5lckhUTUw9Ijxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwyPT09YS5jaGlsZE5vZGVzLmxlbmd0aH0oKSxuLnBhcnNlSFRNTD1mdW5jdGlvbihhLGIsYyl7aWYoIWF8fCJzdHJpbmciIT10eXBlb2YgYSlyZXR1cm4gbnVsbDsiYm9vbGVhbiI9PXR5cGVvZiBiJiYoYz1iLGI9ITEpLGI9Ynx8KGwuY3JlYXRlSFRNTERvY3VtZW50P2QuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCIiKTpkKTt2YXIgZT14LmV4ZWMoYSksZj0hYyYmW107cmV0dXJuIGU/W2IuY3JlYXRlRWxlbWVudChlWzFdKV06KGU9Y2EoW2FdLGIsZiksZiYmZi5sZW5ndGgmJm4oZikucmVtb3ZlKCksbi5tZXJnZShbXSxlLmNoaWxkTm9kZXMpKX07dmFyIEtiPW4uZm4ubG9hZDtuLmZuLmxvYWQ9ZnVuY3Rpb24oYSxiLGMpe2lmKCJzdHJpbmciIT10eXBlb2YgYSYmS2IpcmV0dXJuIEtiLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZCxlLGYsZz10aGlzLGg9YS5pbmRleE9mKCIgIik7cmV0dXJuIGg+LTEmJihkPW4udHJpbShhLnNsaWNlKGgpKSxhPWEuc2xpY2UoMCxoKSksbi5pc0Z1bmN0aW9uKGIpPyhjPWIsYj12b2lkIDApOmImJiJvYmplY3QiPT10eXBlb2YgYiYmKGU9IlBPU1QiKSxnLmxlbmd0aD4wJiZuLmFqYXgoe3VybDphLHR5cGU6ZXx8IkdFVCIsZGF0YVR5cGU6Imh0bWwiLGRhdGE6Yn0pLmRvbmUoZnVuY3Rpb24oYSl7Zj1hcmd1bWVudHMsZy5odG1sKGQ/bigiPGRpdj4iKS5hcHBlbmQobi5wYXJzZUhUTUwoYSkpLmZpbmQoZCk6YSl9KS5hbHdheXMoYyYmZnVuY3Rpb24oYSxiKXtnLmVhY2goZnVuY3Rpb24oKXtjLmFwcGx5KGcsZnx8W2EucmVzcG9uc2VUZXh0LGIsYV0pfSl9KSx0aGlzfSxuLmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihhLGIpe24uZm5bYl09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub24oYixhKX19KSxuLmV4cHIuZmlsdGVycy5hbmltYXRlZD1mdW5jdGlvbihhKXtyZXR1cm4gbi5ncmVwKG4udGltZXJzLGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yi5lbGVtfSkubGVuZ3RofTtmdW5jdGlvbiBMYihhKXtyZXR1cm4gbi5pc1dpbmRvdyhhKT9hOjk9PT1hLm5vZGVUeXBlJiZhLmRlZmF1bHRWaWV3fW4ub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGs9bi5jc3MoYSwicG9zaXRpb24iKSxsPW4oYSksbT17fTsic3RhdGljIj09PWsmJihhLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLGg9bC5vZmZzZXQoKSxmPW4uY3NzKGEsInRvcCIpLGk9bi5jc3MoYSwibGVmdCIpLGo9KCJhYnNvbHV0ZSI9PT1rfHwiZml4ZWQiPT09aykmJihmK2kpLmluZGV4T2YoImF1dG8iKT4tMSxqPyhkPWwucG9zaXRpb24oKSxnPWQudG9wLGU9ZC5sZWZ0KTooZz1wYXJzZUZsb2F0KGYpfHwwLGU9cGFyc2VGbG9hdChpKXx8MCksbi5pc0Z1bmN0aW9uKGIpJiYoYj1iLmNhbGwoYSxjLG4uZXh0ZW5kKHt9LGgpKSksbnVsbCE9Yi50b3AmJihtLnRvcD1iLnRvcC1oLnRvcCtnKSxudWxsIT1iLmxlZnQmJihtLmxlZnQ9Yi5sZWZ0LWgubGVmdCtlKSwidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxtKTpsLmNzcyhtKX19LG4uZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09YT90aGlzOnRoaXMuZWFjaChmdW5jdGlvbihiKXtuLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLGIpfSk7dmFyIGIsYyxkPXRoaXNbMF0sZT17dG9wOjAsbGVmdDowfSxmPWQmJmQub3duZXJEb2N1bWVudDtpZihmKXJldHVybiBiPWYuZG9jdW1lbnRFbGVtZW50LG4uY29udGFpbnMoYixkKT8oZT1kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGM9TGIoZikse3RvcDplLnRvcCtjLnBhZ2VZT2Zmc2V0LWIuY2xpZW50VG9wLGxlZnQ6ZS5sZWZ0K2MucGFnZVhPZmZzZXQtYi5jbGllbnRMZWZ0fSk6ZX0scG9zaXRpb246ZnVuY3Rpb24oKXtpZih0aGlzWzBdKXt2YXIgYSxiLGM9dGhpc1swXSxkPXt0b3A6MCxsZWZ0OjB9O3JldHVybiJmaXhlZCI9PT1uLmNzcyhjLCJwb3NpdGlvbiIpP2I9Yy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTooYT10aGlzLm9mZnNldFBhcmVudCgpLGI9dGhpcy5vZmZzZXQoKSxuLm5vZGVOYW1lKGFbMF0sImh0bWwiKXx8KGQ9YS5vZmZzZXQoKSksZC50b3ArPW4uY3NzKGFbMF0sImJvcmRlclRvcFdpZHRoIiwhMCksZC5sZWZ0Kz1uLmNzcyhhWzBdLCJib3JkZXJMZWZ0V2lkdGgiLCEwKSkse3RvcDpiLnRvcC1kLnRvcC1uLmNzcyhjLCJtYXJnaW5Ub3AiLCEwKSxsZWZ0OmIubGVmdC1kLmxlZnQtbi5jc3MoYywibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGEmJiJzdGF0aWMiPT09bi5jc3MoYSwicG9zaXRpb24iKSlhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfHxFYX0pfX0pLG4uZWFjaCh7c2Nyb2xsTGVmdDoicGFnZVhPZmZzZXQiLHNjcm9sbFRvcDoicGFnZVlPZmZzZXQifSxmdW5jdGlvbihhLGIpe3ZhciBjPSJwYWdlWU9mZnNldCI9PT1iO24uZm5bYV09ZnVuY3Rpb24oZCl7cmV0dXJuIEsodGhpcyxmdW5jdGlvbihhLGQsZSl7dmFyIGY9TGIoYSk7cmV0dXJuIHZvaWQgMD09PWU/Zj9mW2JdOmFbZF06dm9pZChmP2Yuc2Nyb2xsVG8oYz9mLnBhZ2VYT2Zmc2V0OmUsYz9lOmYucGFnZVlPZmZzZXQpOmFbZF09ZSl9LGEsZCxhcmd1bWVudHMubGVuZ3RoKX19KSxuLmVhY2goWyJ0b3AiLCJsZWZ0Il0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2JdPUdhKGwucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihhLGMpe3JldHVybiBjPyhjPUZhKGEsYiksQmEudGVzdChjKT9uKGEpLnBvc2l0aW9uKClbYl0rInB4IjpjKTp2b2lkIDB9KX0pLG4uZWFjaCh7SGVpZ2h0OiJoZWlnaHQiLFdpZHRoOiJ3aWR0aCJ9LGZ1bmN0aW9uKGEsYil7bi5lYWNoKHtwYWRkaW5nOiJpbm5lciIrYSxjb250ZW50OmIsIiI6Im91dGVyIithfSxmdW5jdGlvbihjLGQpe24uZm5bZF09ZnVuY3Rpb24oZCxlKXt2YXIgZj1hcmd1bWVudHMubGVuZ3RoJiYoY3x8ImJvb2xlYW4iIT10eXBlb2YgZCksZz1jfHwoZD09PSEwfHxlPT09ITA/Im1hcmdpbiI6ImJvcmRlciIpO3JldHVybiBLKHRoaXMsZnVuY3Rpb24oYixjLGQpe3ZhciBlO3JldHVybiBuLmlzV2luZG93KGIpP2IuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiK2FdOjk9PT1iLm5vZGVUeXBlPyhlPWIuZG9jdW1lbnRFbGVtZW50LE1hdGgubWF4KGIuYm9keVsic2Nyb2xsIithXSxlWyJzY3JvbGwiK2FdLGIuYm9keVsib2Zmc2V0IithXSxlWyJvZmZzZXQiK2FdLGVbImNsaWVudCIrYV0pKTp2b2lkIDA9PT1kP24uY3NzKGIsYyxnKTpuLnN0eWxlKGIsYyxkLGcpfSxiLGY/ZDp2b2lkIDAsZixudWxsKX19KX0pLG4uZm4uZXh0ZW5kKHtiaW5kOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5vbihhLG51bGwsYixjKX0sdW5iaW5kOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMub2ZmKGEsbnVsbCxiKX0sZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMub24oYixhLGMsZCl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihhLCIqKiIpOnRoaXMub2ZmKGIsYXx8IioqIixjKX0sc2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aH19KSxuLmZuLmFuZFNlbGY9bi5mbi5hZGRCYWNrLCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiBufSk7dmFyIE1iPWEualF1ZXJ5LE5iPWEuJDtyZXR1cm4gbi5ub0NvbmZsaWN0PWZ1bmN0aW9uKGIpe3JldHVybiBhLiQ9PT1uJiYoYS4kPU5iKSxiJiZhLmpRdWVyeT09PW4mJihhLmpRdWVyeT1NYiksbn0sYnx8KGEualF1ZXJ5PWEuJD1uKSxufSk7Cg=="></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type="text/javascript" src="data:application/javascript;charset=utf-8;base64,LyoqDQogKiBDb29raWUgcGx1Z2luDQogKg0KICogQ29weXJpZ2h0IChjKSAyMDA2IEtsYXVzIEhhcnRsIChzdGlsYnVlcm8uZGUpDQogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczoNCiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwDQogKiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLmh0bWwNCiAqDQogKi8NCg0KLyoqDQogKiBDcmVhdGUgYSBjb29raWUgd2l0aCB0aGUgZ2l2ZW4gbmFtZSBhbmQgdmFsdWUgYW5kIG90aGVyIG9wdGlvbmFsIHBhcmFtZXRlcnMuDQogKg0KICogQGV4YW1wbGUgJC5jb29raWUoJ3RoZV9jb29raWUnLCAndGhlX3ZhbHVlJyk7DQogKiBAZGVzYyBTZXQgdGhlIHZhbHVlIG9mIGEgY29va2llLg0KICogQGV4YW1wbGUgJC5jb29raWUoJ3RoZV9jb29raWUnLCAndGhlX3ZhbHVlJywgeyBleHBpcmVzOiA3LCBwYXRoOiAnLycsIGRvbWFpbjogJ2pxdWVyeS5jb20nLCBzZWN1cmU6IHRydWUgfSk7DQogKiBAZGVzYyBDcmVhdGUgYSBjb29raWUgd2l0aCBhbGwgYXZhaWxhYmxlIG9wdGlvbnMuDQogKiBAZXhhbXBsZSAkLmNvb2tpZSgndGhlX2Nvb2tpZScsICd0aGVfdmFsdWUnKTsNCiAqIEBkZXNjIENyZWF0ZSBhIHNlc3Npb24gY29va2llLg0KICogQGV4YW1wbGUgJC5jb29raWUoJ3RoZV9jb29raWUnLCBudWxsKTsNCiAqIEBkZXNjIERlbGV0ZSBhIGNvb2tpZSBieSBwYXNzaW5nIG51bGwgYXMgdmFsdWUuIEtlZXAgaW4gbWluZCB0aGF0IHlvdSBoYXZlIHRvIHVzZSB0aGUgc2FtZSBwYXRoIGFuZCBkb21haW4NCiAqICAgICAgIHVzZWQgd2hlbiB0aGUgY29va2llIHdhcyBzZXQuDQogKg0KICogQHBhcmFtIFN0cmluZyBuYW1lIFRoZSBuYW1lIG9mIHRoZSBjb29raWUuDQogKiBAcGFyYW0gU3RyaW5nIHZhbHVlIFRoZSB2YWx1ZSBvZiB0aGUgY29va2llLg0KICogQHBhcmFtIE9iamVjdCBvcHRpb25zIEFuIG9iamVjdCBsaXRlcmFsIGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzIHRvIHByb3ZpZGUgb3B0aW9uYWwgY29va2llIGF0dHJpYnV0ZXMuDQogKiBAb3B0aW9uIE51bWJlcnxEYXRlIGV4cGlyZXMgRWl0aGVyIGFuIGludGVnZXIgc3BlY2lmeWluZyB0aGUgZXhwaXJhdGlvbiBkYXRlIGZyb20gbm93IG9uIGluIGRheXMgb3IgYSBEYXRlIG9iamVjdC4NCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZiBhIG5lZ2F0aXZlIHZhbHVlIGlzIHNwZWNpZmllZCAoZS5nLiBhIGRhdGUgaW4gdGhlIHBhc3QpLCB0aGUgY29va2llIHdpbGwgYmUgZGVsZXRlZC4NCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZiBzZXQgdG8gbnVsbCBvciBvbWl0dGVkLCB0aGUgY29va2llIHdpbGwgYmUgYSBzZXNzaW9uIGNvb2tpZSBhbmQgd2lsbCBub3QgYmUgcmV0YWluZWQNCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIHRoZSB0aGUgYnJvd3NlciBleGl0cy4NCiAqIEBvcHRpb24gU3RyaW5nIHBhdGggVGhlIHZhbHVlIG9mIHRoZSBwYXRoIGF0cmlidXRlIG9mIHRoZSBjb29raWUgKGRlZmF1bHQ6IHBhdGggb2YgcGFnZSB0aGF0IGNyZWF0ZWQgdGhlIGNvb2tpZSkuDQogKiBAb3B0aW9uIFN0cmluZyBkb21haW4gVGhlIHZhbHVlIG9mIHRoZSBkb21haW4gYXR0cmlidXRlIG9mIHRoZSBjb29raWUgKGRlZmF1bHQ6IGRvbWFpbiBvZiBwYWdlIHRoYXQgY3JlYXRlZCB0aGUgY29va2llKS4NCiAqIEBvcHRpb24gQm9vbGVhbiBzZWN1cmUgSWYgdHJ1ZSwgdGhlIHNlY3VyZSBhdHRyaWJ1dGUgb2YgdGhlIGNvb2tpZSB3aWxsIGJlIHNldCBhbmQgdGhlIGNvb2tpZSB0cmFuc21pc3Npb24gd2lsbA0KICogICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlIGEgc2VjdXJlIHByb3RvY29sIChsaWtlIEhUVFBTKS4NCiAqIEB0eXBlIHVuZGVmaW5lZA0KICoNCiAqIEBuYW1lICQuY29va2llDQogKiBAY2F0IFBsdWdpbnMvQ29va2llDQogKiBAYXV0aG9yIEtsYXVzIEhhcnRsL2tsYXVzLmhhcnRsQHN0aWxidWVyby5kZQ0KICovDQoNCi8qKg0KICogR2V0IHRoZSB2YWx1ZSBvZiBhIGNvb2tpZSB3aXRoIHRoZSBnaXZlbiBuYW1lLg0KICoNCiAqIEBleGFtcGxlICQuY29va2llKCd0aGVfY29va2llJyk7DQogKiBAZGVzYyBHZXQgdGhlIHZhbHVlIG9mIGEgY29va2llLg0KICoNCiAqIEBwYXJhbSBTdHJpbmcgbmFtZSBUaGUgbmFtZSBvZiB0aGUgY29va2llLg0KICogQHJldHVybiBUaGUgdmFsdWUgb2YgdGhlIGNvb2tpZS4NCiAqIEB0eXBlIFN0cmluZw0KICoNCiAqIEBuYW1lICQuY29va2llDQogKiBAY2F0IFBsdWdpbnMvQ29va2llDQogKiBAYXV0aG9yIEtsYXVzIEhhcnRsL2tsYXVzLmhhcnRsQHN0aWxidWVyby5kZQ0KICovDQpqUXVlcnkuY29va2llID0gZnVuY3Rpb24obmFtZSwgdmFsdWUsIG9wdGlvbnMpIHsNCiAgICBpZiAodHlwZW9mIHZhbHVlICE9ICd1bmRlZmluZWQnKSB7IC8vIG5hbWUgYW5kIHZhbHVlIGdpdmVuLCBzZXQgY29va2llDQogICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9Ow0KICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHsNCiAgICAgICAgICAgIHZhbHVlID0gJyc7DQogICAgICAgICAgICBvcHRpb25zLmV4cGlyZXMgPSAtMTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgZXhwaXJlcyA9ICcnOw0KICAgICAgICBpZiAob3B0aW9ucy5leHBpcmVzICYmICh0eXBlb2Ygb3B0aW9ucy5leHBpcmVzID09ICdudW1iZXInIHx8IG9wdGlvbnMuZXhwaXJlcy50b1VUQ1N0cmluZykpIHsNCiAgICAgICAgICAgIHZhciBkYXRlOw0KICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLmV4cGlyZXMgPT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgICAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgKyAob3B0aW9ucy5leHBpcmVzICogMjQgKiA2MCAqIDYwICogMTAwMCkpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBkYXRlID0gb3B0aW9ucy5leHBpcmVzOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZXhwaXJlcyA9ICc7IGV4cGlyZXM9JyArIGRhdGUudG9VVENTdHJpbmcoKTsgLy8gdXNlIGV4cGlyZXMgYXR0cmlidXRlLCBtYXgtYWdlIGlzIG5vdCBzdXBwb3J0ZWQgYnkgSUUNCiAgICAgICAgfQ0KICAgICAgICAvLyBDQVVUSU9OOiBOZWVkZWQgdG8gcGFyZW50aGVzaXplIG9wdGlvbnMucGF0aCBhbmQgb3B0aW9ucy5kb21haW4NCiAgICAgICAgLy8gaW4gdGhlIGZvbGxvd2luZyBleHByZXNzaW9ucywgb3RoZXJ3aXNlIHRoZXkgZXZhbHVhdGUgdG8gdW5kZWZpbmVkDQogICAgICAgIC8vIGluIHRoZSBwYWNrZWQgdmVyc2lvbiBmb3Igc29tZSByZWFzb24uLi4NCiAgICAgICAgdmFyIHBhdGggPSBvcHRpb25zLnBhdGggPyAnOyBwYXRoPScgKyAob3B0aW9ucy5wYXRoKSA6ICcnOw0KICAgICAgICB2YXIgZG9tYWluID0gb3B0aW9ucy5kb21haW4gPyAnOyBkb21haW49JyArIChvcHRpb25zLmRvbWFpbikgOiAnJzsNCiAgICAgICAgdmFyIHNlY3VyZSA9IG9wdGlvbnMuc2VjdXJlID8gJzsgc2VjdXJlJyA6ICcnOw0KICAgICAgICBkb2N1bWVudC5jb29raWUgPSBbbmFtZSwgJz0nLCBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpLCBleHBpcmVzLCBwYXRoLCBkb21haW4sIHNlY3VyZV0uam9pbignJyk7DQogICAgfSBlbHNlIHsgLy8gb25seSBuYW1lIGdpdmVuLCBnZXQgY29va2llDQogICAgICAgIHZhciBjb29raWVWYWx1ZSA9IG51bGw7DQogICAgICAgIGlmIChkb2N1bWVudC5jb29raWUgJiYgZG9jdW1lbnQuY29va2llICE9ICcnKSB7DQogICAgICAgICAgICB2YXIgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGpRdWVyeS50cmltKGNvb2tpZXNbaV0pOw0KICAgICAgICAgICAgICAgIC8vIERvZXMgdGhpcyBjb29raWUgc3RyaW5nIGJlZ2luIHdpdGggdGhlIG5hbWUgd2Ugd2FudD8NCiAgICAgICAgICAgICAgICBpZiAoY29va2llLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCArIDEpID09IChuYW1lICsgJz0nKSkgew0KICAgICAgICAgICAgICAgICAgICBjb29raWVWYWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKG5hbWUubGVuZ3RoICsgMSkpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGNvb2tpZVZhbHVlOw0KICAgIH0NCn07"></script>
    <script type="text/javascript" src="data:application/javascript;charset=utf-8;base64,LyoqDQoqIGhvdmVySW50ZW50IHI1IC8vIDIwMDcuMDMuMjcgLy8galF1ZXJ5IDEuMS4yKw0KKiA8aHR0cDovL2NoZXJuZS5uZXQvYnJpYW4vcmVzb3VyY2VzL2pxdWVyeS5ob3ZlckludGVudC5odG1sPg0KKiANCiogQHBhcmFtICBmICBvbk1vdXNlT3ZlciBmdW5jdGlvbiB8fCBBbiBvYmplY3Qgd2l0aCBjb25maWd1cmF0aW9uIG9wdGlvbnMNCiogQHBhcmFtICBnICBvbk1vdXNlT3V0IGZ1bmN0aW9uICB8fCBOb3RoaW5nICh1c2UgY29uZmlndXJhdGlvbiBvcHRpb25zIG9iamVjdCkNCiogQGF1dGhvciAgICBCcmlhbiBDaGVybmUgPGJyaWFuQGNoZXJuZS5uZXQ+DQoqLw0KKGZ1bmN0aW9uKCQpeyQuZm4uaG92ZXJJbnRlbnQ9ZnVuY3Rpb24oZixnKXt2YXIgY2ZnPXtzZW5zaXRpdml0eTo3LGludGVydmFsOjEwMCx0aW1lb3V0OjB9O2NmZz0kLmV4dGVuZChjZmcsZz97b3ZlcjpmLG91dDpnfTpmKTt2YXIgY1gsY1kscFgscFk7dmFyIHRyYWNrPWZ1bmN0aW9uKGV2KXtjWD1ldi5wYWdlWDtjWT1ldi5wYWdlWTt9O3ZhciBjb21wYXJlPWZ1bmN0aW9uKGV2LG9iKXtvYi5ob3ZlckludGVudF90PWNsZWFyVGltZW91dChvYi5ob3ZlckludGVudF90KTtpZigoTWF0aC5hYnMocFgtY1gpK01hdGguYWJzKHBZLWNZKSk8Y2ZnLnNlbnNpdGl2aXR5KXskKG9iKS51bmJpbmQoIm1vdXNlbW92ZSIsdHJhY2spO29iLmhvdmVySW50ZW50X3M9MTtyZXR1cm4gY2ZnLm92ZXIuYXBwbHkob2IsW2V2XSk7fWVsc2V7cFg9Y1g7cFk9Y1k7b2IuaG92ZXJJbnRlbnRfdD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Y29tcGFyZShldixvYik7fSxjZmcuaW50ZXJ2YWwpO319O3ZhciBkZWxheT1mdW5jdGlvbihldixvYil7b2IuaG92ZXJJbnRlbnRfdD1jbGVhclRpbWVvdXQob2IuaG92ZXJJbnRlbnRfdCk7b2IuaG92ZXJJbnRlbnRfcz0wO3JldHVybiBjZmcub3V0LmFwcGx5KG9iLFtldl0pO307dmFyIGhhbmRsZUhvdmVyPWZ1bmN0aW9uKGUpe3ZhciBwPShlLnR5cGU9PSJtb3VzZW92ZXIiP2UuZnJvbUVsZW1lbnQ6ZS50b0VsZW1lbnQpfHxlLnJlbGF0ZWRUYXJnZXQ7d2hpbGUocCYmcCE9dGhpcyl7dHJ5e3A9cC5wYXJlbnROb2RlO31jYXRjaChlKXtwPXRoaXM7fX1pZihwPT10aGlzKXtyZXR1cm4gZmFsc2U7fXZhciBldj1qUXVlcnkuZXh0ZW5kKHt9LGUpO3ZhciBvYj10aGlzO2lmKG9iLmhvdmVySW50ZW50X3Qpe29iLmhvdmVySW50ZW50X3Q9Y2xlYXJUaW1lb3V0KG9iLmhvdmVySW50ZW50X3QpO31pZihlLnR5cGU9PSJtb3VzZW92ZXIiKXtwWD1ldi5wYWdlWDtwWT1ldi5wYWdlWTskKG9iKS5iaW5kKCJtb3VzZW1vdmUiLHRyYWNrKTtpZihvYi5ob3ZlckludGVudF9zIT0xKXtvYi5ob3ZlckludGVudF90PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtjb21wYXJlKGV2LG9iKTt9LGNmZy5pbnRlcnZhbCk7fX1lbHNleyQob2IpLnVuYmluZCgibW91c2Vtb3ZlIix0cmFjayk7aWYob2IuaG92ZXJJbnRlbnRfcz09MSl7b2IuaG92ZXJJbnRlbnRfdD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZGVsYXkoZXYsb2IpO30sY2ZnLnRpbWVvdXQpO319fTtyZXR1cm4gdGhpcy5tb3VzZW92ZXIoaGFuZGxlSG92ZXIpLm1vdXNlb3V0KGhhbmRsZUhvdmVyKTt9O30pKGpRdWVyeSk7"></script>
    <script type="text/javascript" src="data:application/javascript;charset=utf-8;base64,KGZ1bmN0aW9uKCQpeyQuZm4uZGNBY2NvcmRpb249ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIGRlZmF1bHRzPXtjbGFzc1BhcmVudDonZGNqcS1wYXJlbnQnLGNsYXNzQWN0aXZlOidhY3RpdmUnLGNsYXNzQXJyb3c6J2RjanEtaWNvbicsY2xhc3NDb3VudDonZGNqcS1jb3VudCcsY2xhc3NFeHBhbmQ6J2RjanEtY3VycmVudC1wYXJlbnQnLGV2ZW50VHlwZTonY2xpY2snLGhvdmVyRGVsYXk6MzAwLG1lbnVDbG9zZTp0cnVlLGF1dG9DbG9zZTp0cnVlLGF1dG9FeHBhbmQ6ZmFsc2Usc3BlZWQ6J3Nsb3cnLHNhdmVTdGF0ZTp0cnVlLGRpc2FibGVMaW5rOnRydWUsc2hvd0NvdW50OmZhbHNlLGNvb2tpZTonZGNqcS1hY2NvcmRpb24nfTt2YXIgb3B0aW9ucz0kLmV4dGVuZChkZWZhdWx0cyxvcHRpb25zKTt0aGlzLmVhY2goZnVuY3Rpb24ob3B0aW9ucyl7dmFyIG9iaj10aGlzO3NldFVwQWNjb3JkaW9uKCk7aWYoZGVmYXVsdHMuc2F2ZVN0YXRlPT10cnVlKXtjaGVja0Nvb2tpZShkZWZhdWx0cy5jb29raWUsb2JqKX1pZihkZWZhdWx0cy5hdXRvRXhwYW5kPT10cnVlKXskKCdsaS4nK2RlZmF1bHRzLmNsYXNzRXhwYW5kKycgPiBhJykuYWRkQ2xhc3MoZGVmYXVsdHMuY2xhc3NBY3RpdmUpfXJlc2V0QWNjb3JkaW9uKCk7aWYoZGVmYXVsdHMuZXZlbnRUeXBlPT0naG92ZXInKXt2YXIgY29uZmlnPXtzZW5zaXRpdml0eToyLGludGVydmFsOmRlZmF1bHRzLmhvdmVyRGVsYXksb3ZlcjpsaW5rT3Zlcix0aW1lb3V0OmRlZmF1bHRzLmhvdmVyRGVsYXksb3V0OmxpbmtPdXR9OyQoJ2xpIGEnLG9iaikuaG92ZXJJbnRlbnQoY29uZmlnKTt2YXIgY29uZmlnTWVudT17c2Vuc2l0aXZpdHk6MixpbnRlcnZhbDoxMDAwLG92ZXI6bWVudU92ZXIsdGltZW91dDoxMDAwLG91dDptZW51T3V0fTskKG9iaikuaG92ZXJJbnRlbnQoY29uZmlnTWVudSk7aWYoZGVmYXVsdHMuZGlzYWJsZUxpbms9PXRydWUpeyQoJ2xpIGEnLG9iaikuY2xpY2soZnVuY3Rpb24oZSl7aWYoJCh0aGlzKS5zaWJsaW5ncygndWwnKS5sZW5ndGg+MCl7ZS5wcmV2ZW50RGVmYXVsdCgpfX0pfX1lbHNleyQoJ2xpIGEnLG9iaikuY2xpY2soZnVuY3Rpb24oZSl7JGFjdGl2ZUxpPSQodGhpcykucGFyZW50KCdsaScpOyRwYXJlbnRzTGk9JGFjdGl2ZUxpLnBhcmVudHMoJ2xpJyk7JHBhcmVudHNVbD0kYWN0aXZlTGkucGFyZW50cygndWwnKTtpZihkZWZhdWx0cy5kaXNhYmxlTGluaz09dHJ1ZSl7aWYoJCh0aGlzKS5zaWJsaW5ncygndWwnKS5sZW5ndGg+MCl7ZS5wcmV2ZW50RGVmYXVsdCgpfX1pZihkZWZhdWx0cy5hdXRvQ2xvc2U9PXRydWUpe2F1dG9DbG9zZUFjY29yZGlvbigkcGFyZW50c0xpLCRwYXJlbnRzVWwpfWlmKCQoJz4gdWwnLCRhY3RpdmVMaSkuaXMoJzp2aXNpYmxlJykpeyQoJ3VsJywkYWN0aXZlTGkpLnNsaWRlVXAoZGVmYXVsdHMuc3BlZWQpOyQoJ2EnLCRhY3RpdmVMaSkucmVtb3ZlQ2xhc3MoZGVmYXVsdHMuY2xhc3NBY3RpdmUpfWVsc2V7JCh0aGlzKS5zaWJsaW5ncygndWwnKS5zbGlkZVRvZ2dsZShkZWZhdWx0cy5zcGVlZCk7JCgnPiBhJywkYWN0aXZlTGkpLmFkZENsYXNzKGRlZmF1bHRzLmNsYXNzQWN0aXZlKX1pZihkZWZhdWx0cy5zYXZlU3RhdGU9PXRydWUpe2NyZWF0ZUNvb2tpZShkZWZhdWx0cy5jb29raWUsb2JqKX19KX1mdW5jdGlvbiBzZXRVcEFjY29yZGlvbigpeyRhcnJvdz0nPHNwYW4gY2xhc3M9IicrZGVmYXVsdHMuY2xhc3NBcnJvdysnIj48L3NwYW4+Jzt2YXIgY2xhc3NQYXJlbnRMaT1kZWZhdWx0cy5jbGFzc1BhcmVudCsnLWxpJzskKCc+IHVsJyxvYmopLnNob3coKTskKCdsaScsb2JqKS5lYWNoKGZ1bmN0aW9uKCl7aWYoJCgnPiB1bCcsdGhpcykubGVuZ3RoPjApeyQodGhpcykuYWRkQ2xhc3MoY2xhc3NQYXJlbnRMaSk7JCgnPiBhJyx0aGlzKS5hZGRDbGFzcyhkZWZhdWx0cy5jbGFzc1BhcmVudCkuYXBwZW5kKCRhcnJvdyl9fSk7JCgnPiB1bCcsb2JqKS5oaWRlKCk7aWYoZGVmYXVsdHMuc2hvd0NvdW50PT10cnVlKXskKCdsaS4nK2NsYXNzUGFyZW50TGksb2JqKS5lYWNoKGZ1bmN0aW9uKCl7aWYoZGVmYXVsdHMuZGlzYWJsZUxpbms9PXRydWUpe3ZhciBnZXRDb3VudD1wYXJzZUludCgkKCd1bCBhOm5vdCguJytkZWZhdWx0cy5jbGFzc1BhcmVudCsnKScsdGhpcykubGVuZ3RoKX1lbHNle3ZhciBnZXRDb3VudD1wYXJzZUludCgkKCd1bCBhJyx0aGlzKS5sZW5ndGgpfSQoJz4gYScsdGhpcykuYXBwZW5kKCcgPHNwYW4gY2xhc3M9IicrZGVmYXVsdHMuY2xhc3NDb3VudCsnIj4oJytnZXRDb3VudCsnKTwvc3Bhbj4nKX0pfX1mdW5jdGlvbiBsaW5rT3ZlcigpeyRhY3RpdmVMaT0kKHRoaXMpLnBhcmVudCgnbGknKTskcGFyZW50c0xpPSRhY3RpdmVMaS5wYXJlbnRzKCdsaScpOyRwYXJlbnRzVWw9JGFjdGl2ZUxpLnBhcmVudHMoJ3VsJyk7aWYoZGVmYXVsdHMuYXV0b0Nsb3NlPT10cnVlKXthdXRvQ2xvc2VBY2NvcmRpb24oJHBhcmVudHNMaSwkcGFyZW50c1VsKX1pZigkKCc+IHVsJywkYWN0aXZlTGkpLmlzKCc6dmlzaWJsZScpKXskKCd1bCcsJGFjdGl2ZUxpKS5zbGlkZVVwKGRlZmF1bHRzLnNwZWVkKTskKCdhJywkYWN0aXZlTGkpLnJlbW92ZUNsYXNzKGRlZmF1bHRzLmNsYXNzQWN0aXZlKX1lbHNleyQodGhpcykuc2libGluZ3MoJ3VsJykuc2xpZGVUb2dnbGUoZGVmYXVsdHMuc3BlZWQpOyQoJz4gYScsJGFjdGl2ZUxpKS5hZGRDbGFzcyhkZWZhdWx0cy5jbGFzc0FjdGl2ZSl9aWYoZGVmYXVsdHMuc2F2ZVN0YXRlPT10cnVlKXtjcmVhdGVDb29raWUoZGVmYXVsdHMuY29va2llLG9iail9fWZ1bmN0aW9uIGxpbmtPdXQoKXt9ZnVuY3Rpb24gbWVudU92ZXIoKXt9ZnVuY3Rpb24gbWVudU91dCgpe2lmKGRlZmF1bHRzLm1lbnVDbG9zZT09dHJ1ZSl7JCgndWwnLG9iaikuc2xpZGVVcChkZWZhdWx0cy5zcGVlZCk7JCgnYScsb2JqKS5yZW1vdmVDbGFzcyhkZWZhdWx0cy5jbGFzc0FjdGl2ZSk7Y3JlYXRlQ29va2llKGRlZmF1bHRzLmNvb2tpZSxvYmopfX1mdW5jdGlvbiBhdXRvQ2xvc2VBY2NvcmRpb24oJHBhcmVudHNMaSwkcGFyZW50c1VsKXskKCd1bCcsb2JqKS5ub3QoJHBhcmVudHNVbCkuc2xpZGVVcChkZWZhdWx0cy5zcGVlZCk7JCgnYScsb2JqKS5yZW1vdmVDbGFzcyhkZWZhdWx0cy5jbGFzc0FjdGl2ZSk7JCgnPiBhJywkcGFyZW50c0xpKS5hZGRDbGFzcyhkZWZhdWx0cy5jbGFzc0FjdGl2ZSl9ZnVuY3Rpb24gcmVzZXRBY2NvcmRpb24oKXskKCd1bCcsb2JqKS5oaWRlKCk7JGFsbEFjdGl2ZUxpPSQoJ2EuJytkZWZhdWx0cy5jbGFzc0FjdGl2ZSxvYmopOyRhbGxBY3RpdmVMaS5zaWJsaW5ncygndWwnKS5zaG93KCl9fSk7ZnVuY3Rpb24gY2hlY2tDb29raWUoY29va2llSWQsb2JqKXt2YXIgY29va2llVmFsPSQuY29va2llKGNvb2tpZUlkKTtpZihjb29raWVWYWwhPW51bGwpe3ZhciBhY3RpdmVBcnJheT1jb29raWVWYWwuc3BsaXQoJywnKTskLmVhY2goYWN0aXZlQXJyYXksZnVuY3Rpb24oaW5kZXgsdmFsdWUpe3ZhciAkY29va2llTGk9JCgnbGk6ZXEoJyt2YWx1ZSsnKScsb2JqKTskKCc+IGEnLCRjb29raWVMaSkuYWRkQ2xhc3MoZGVmYXVsdHMuY2xhc3NBY3RpdmUpO3ZhciAkcGFyZW50c0xpPSRjb29raWVMaS5wYXJlbnRzKCdsaScpOyQoJz4gYScsJHBhcmVudHNMaSkuYWRkQ2xhc3MoZGVmYXVsdHMuY2xhc3NBY3RpdmUpfSl9fWZ1bmN0aW9uIGNyZWF0ZUNvb2tpZShjb29raWVJZCxvYmope3ZhciBhY3RpdmVJbmRleD1bXTskKCdsaSBhLicrZGVmYXVsdHMuY2xhc3NBY3RpdmUsb2JqKS5lYWNoKGZ1bmN0aW9uKGkpe3ZhciAkYXJyYXlJdGVtPSQodGhpcykucGFyZW50KCdsaScpO3ZhciBpdGVtSW5kZXg9JCgnbGknLG9iaikuaW5kZXgoJGFycmF5SXRlbSk7YWN0aXZlSW5kZXgucHVzaChpdGVtSW5kZXgpfSk7JC5jb29raWUoY29va2llSWQsYWN0aXZlSW5kZXgse3BhdGg6Jy8nfSl9fX0pKGpRdWVyeSk7"></script>

    <link href="data:text/css;charset=utf-8;charset=utf-8,%2Eblue%20%2Eaccordion%7B%20border%2Dtop%3A%201px%20solid%20%23013d6c%3B%20border%2Dright%3A%201px%20solid%20%23013d6c%3B%20border%2Dleft%3A%201px%20solid%20%23013d6c%3B%7D%2Eblue%20%2Eaccordion%2C%20%2Eblue%20%2Eaccordion%20li%20%7Bmargin%3A%200%3B%20padding%3A%200%3B%20border%3A%20none%3B%7D%2Eblue%20%2Eaccordion%20a%20%7Bpadding%3A%2010px%2010px%2010px%2015px%3B%20background%3A%20%230D5995%3B%20text%2Ddecoration%3Anone%3B%20display%3A%20block%3B%20color%3A%20%23fff%3B%20border%2Dbottom%3A%201px%20solid%20%23013d6c%3B%20border%2Dtop%3A%201px%20solid%20%234695d3%3B%7D%2Eblue%20%2Eaccordion%20ul%20a%20%7Bpadding%3A%2010px%2010px%2010px%2025px%3B%7D%2Eblue%20%2Eaccordion%20a%2Edcjq%2Dparent%2C%20%2Eblue%20%2Eaccordion%20a%2Edcjq%2Dparent%3Ahover%20%7Bpadding%3A%2010px%2010px%2010px%2015px%3B%7D%2Eblue%20%2Eaccordion%20a%2Edcjq%2Dparent%2Eactive%20%7Bbackground%3A%20%230D5995%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5%2BAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAgSURBVHjaYvz%2F%2F78aAwTcAhFMDGiAEagCxlbDqgIgwABijwcnzTZbgwAAAABJRU5ErkJggg%3D%3D%29%20repeat%200%200%3B%7D%2Eblue%20%2Eaccordion%20a%3Ahover%20%7Bbackground%3A%20%2305477c%3B%7D%2Eblue%20%2Eaccordion%20a%3Aactive%7B%7D" rel="stylesheet" type="text/css" />
    <link href="data:text/css;charset=utf-8;charset=utf-8,%2Egraphite%20%2Eaccordion%7Bfont%3A%20bold%2014px%20Arial%2C%20sans%2Dserif%3B%20border%2Dtop%3A%201px%20solid%20%23111%3B%20border%2Dright%3A%201px%20solid%20%23111%3B%20border%2Dleft%3A%201px%20solid%20%23111%3B%7D%2Egraphite%20%2Eaccordion%2C%20%2Egraphite%20%2Eaccordion%20li%20%7Bmargin%3A%200%3B%20padding%3A%200%3B%20border%3A%20none%3B%7D%2Egraphite%20%2Eaccordion%20a%20%7Bpadding%3A%2010px%2010px%2010px%2050px%3B%20background%3A%20%230C0C0C%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAEAAAArCAIAAAA2QHWOAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABBSURBVHjaYnL19GVi%2BP%2Bf6T82%2FO8f0z8w%2Bx%2BQ%2FR%2FIRqaBcmB5qBiUD1ILZ6OoAbH%2Fo6iBm49mD1geyR1Q9wEEGAAgh3x7DxrMZwAAAABJRU5ErkJggg%3D%3D%29%20repeat%2Dx%200%20%2D1px%3B%20text%2Ddecoration%3Anone%3B%20display%3A%20block%3B%20color%3A%20%23ddd%3B%20border%2Dbottom%3A%201px%20solid%20%23222%3B%20border%2Dtop%3A%201px%20solid%20%23777%3B%20position%3A%20relative%3B%7D%2Egraphite%20%2Eaccordion%20ul%20a%20%7Bbackground%3A%20%23424549%3B%7D%2Egraphite%20%2Eaccordion%20a%2Edcjq%2Dparent%2C%20%2Egraphite%20%2Eaccordion%20a%2Edcjq%2Dparent%3Ahover%20%7Bbackground%3A%20%230C0C0C%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAEAAAArCAIAAAA2QHWOAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABBSURBVHjaYnL19GVi%2BP%2Bf6T82%2FO8f0z8w%2Bx%2BQ%2FR%2FIRqaBcmB5qBiUD1ILZ6OoAbH%2Fo6iBm49mD1geyR1Q9wEEGAAgh3x7DxrMZwAAAABJRU5ErkJggg%3D%3D%29%20repeat%2Dx%200%20%2D1px%3B%7D%2Egraphite%20%2Eaccordion%20a%2Edcjq%2Dparent%2Eactive%20%7B%7D%2Egraphite%20%2Eaccordion%20a%20%2Edcjq%2Dicon%20%7Bposition%3A%20absolute%3B%20top%3A%2050%25%3B%20left%3A%2014px%3B%20width%3A%2034px%3B%20margin%2Dtop%3A%20%2D17px%3B%20height%3A%2034px%3B%20background%3A%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABoAAAApCAYAAAArpDnNAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAH4SURBVHja7FdNSwJRFH1vnEIpCEQ3IurGRVsLWrdSQQhcBAqBtIg2rdMkwUVKusuQlhlDiH%2FDNv2Gln0QQgSSqaPzXueNGtHSmXExOHJ5eK%2FO4Zx73n0zlHNOrLwSe8nsR%2BedycTqi%2FMAY0yVLMeZrtICGBHRHusZLYHmN8PkszTDXEDYsHZixBYExKbSyV6vd7fb7e5Mp7hjNBo9Y20hBv8lmE86pv9XbrVa6%2B12uzQej6nD4SCdTocoirIJ8HP8bmxKjwSjYDD4EA6HFUrpgSRJRICFQqFssVgkvV7v7M8ANmQGWdO0z36%2FfwwdNYBlECSdThOs2UKhQFHLGjPDRDpJ3BjxDTYnSNyJ4mAwIKlUioDVqcvlujBynMz2kTwcDme5L8SRqqoruHlKyCiYgXGuVCo9oXZrSLpIJPKbhOM4esYbjQbx%2B%2F0EspFkMkkTiQSd395swggMZrk1t9t9nc%2Fn0wJEFEVA1kun06mYtWFdHo%2FnqlKpZGKxmF6AZCJfReTwfWTGrNsAk3q5XD6Mx%2BNE9Ax7SgcRzjNu74kyUiAQ2K%2FVaploNKr3RIAAoAoz5IXEZg1Vudlsyj6f7x5MNCRWAfCI%2Bo3whimzjnE9qNVPqpGt7frb64tqtxN2IQcf051nI0Y2fSRmS%2BmWQNPXFm7H15YfAQYAeBuQdTNLxSkAAAAASUVORK5CYII%3D%29%20no%2Drepeat%200%20center%3B%7D%2Egraphite%20%2Eaccordion%20a%2Edcjq%2Dparent%2Eactive%20%2Edcjq%2Dicon%20%7Bbackground%3A%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABoAAAApCAYAAAArpDnNAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFuSURBVHjaYvz%2F%2Fz8DLYGPf1DF21cv%2FrEw0Br8%2Fy%2F379%2B%2FX0w0twdKM9HBRwyg6KG9j0YtIj8xQOBoYiDLImCGHU4%2B%2Bkcni%2F7Bgo6RkdEJihmIwPxAXEda0P2D%2BKisrMzCyspqG1DMiYAefgEBgb319fXRJMcRyEecnJxsM2bMYCdgGdiSOXPmGGtqagqQnRg4ODgY8FgGt0RPT4%2BMxPAPNTHgsIwiS1DykbW19Q0clgVis0RaWvoBWUGnoKCw6%2B%2Ffv5fRLXN1dV2HbglQ3S9xcfF60pL3P7CPQG2Gd8zMzA5%2F%2FvzZx8LCog%2BzbOrUqSgaQJYA1fkDmTsoybDvgJY4AQ27gNVV%2F%2F79JMcSXGUd2GfoloEsYWJi8iXHEliGxVaofoRadhbJEi8gczctClWQZc5A%2BiDUkn0UlXX%2F%2FoMxi6qqKjb5j0DsQJ1q4h8YD7cali4VHx2Djj4%2BGqZN4n%2BjQTdqEbTb8n84dlsAAgwAASNROHTqzS8AAAAASUVORK5CYII%3D%29%20no%2Drepeat%200%20center%3B%7D%2Egraphite%20%2Eaccordion%20a%3Ahover%20%7Bbackground%3A%20%23232323%3B%20color%3A%20%23fff%3B%7D%2Egraphite%20%2Eaccordion%20a%3Aactive%7B%7D" rel="stylesheet" type="text/css" />
    <link href="data:text/css;charset=utf-8;charset=utf-8,%2Egrey%20%2Eaccordion%7Bfont%3A%20bold%2014px%20Arial%2C%20sans%2Dserif%3B%20border%2Dtop%3A%201px%20solid%20%23ccc%3B%20border%2Dright%3A%201px%20solid%20%23ccc%3B%20border%2Dleft%3A%201px%20solid%20%23ccc%3B%7D%2Egrey%20%2Eaccordion%2C%20%2Egrey%20%2Eaccordion%20li%20%7Bmargin%3A%200%3B%20padding%3A%200%3B%20border%3A%20none%3B%7D%2Egrey%20%2Eaccordion%20a%20%7Bpadding%3A%2010px%2010px%2010px%2050px%3B%20background%3A%20%23ececec%3B%20text%2Ddecoration%3Anone%3B%20display%3A%20block%3B%20color%3A%20%23333%3B%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%20border%2Dtop%3A%201px%20solid%20%23fff%3B%20position%3A%20relative%3B%20text%2Dshadow%3A%201px%201px%201px%20%23fff%3B%7D%2Egrey%20%2Eaccordion%20a%2Edcjq%2Dparent%2C%20%2Egrey%20%2Eaccordion%20a%2Edcjq%2Dparent%3Ahover%20%7Bbackground%3A%20%23D7D4D4%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAEAAAArCAIAAAA2QHWOAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAsSURBVHjaYvr9%2BzfTly9fmP7%2F%2F8%2FEwMCAQuNjI2Nc4sSqI2QfiGZjZgYIMACVNF%2FW6EF1XQAAAABJRU5ErkJggg%3D%3D%29%20repeat%2Dx%200%20%2D1px%3B%7D%2Egrey%20%2Eaccordion%20a%2Edcjq%2Dparent%2Eactive%20%7B%7D%2Egrey%20%2Eaccordion%20a%20%2Edcjq%2Dicon%20%7Bposition%3A%20absolute%3B%20top%3A%2050%25%3B%20left%3A%2014px%3B%20width%3A%2034px%3B%20margin%2Dtop%3A%20%2D17px%3B%20height%3A%2034px%3B%20background%3A%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABoAAAApCAYAAAArpDnNAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFWSURBVHjaYvz%2F%2Fz8DLcHLFy%2FKuHl4mFgYaAz%2B%2Ff8vBaTYmGhtEQM0xJhob8%2BoRUPBIhAeRj7692%2BYWfQPSo8GHdmpjsXExMQJSKsgyd0E4oPoGs6cOUNeHAF9BM5HkyZNEuLj42sCis0EYUZGxt1AOoSK1QQk6KysrI6sWLHii7y8PMyrrExMTMupZRlyHL0QExOzmT59%2Bl2YZUDvslDLMvSSgWaW%2FcOS6sCWNTY2PgBagGzZUiBTmtKgA6U6FAl2dvZ%2FcFcALWxtbWVwdXWlyEeg4ENunEiwsLAc%2FPnzpxLMkra2tn8uLi7RQO5TasUR2JI%2Ff%2F6ooVkSDuSuoVYc0cwSlDgSFxdPNTIyEuXk5AQLWFtb%2F7O3t6eKJShF0NatWz8B6dVIcluBeBPVSgaYj4B4Ik3rI3qW3vRpnNCtKqd3xTfariO%2Fhh1t5A9aHzEM23wEEGAA9Cve7kRFQ2MAAAAASUVORK5CYII%3D%29%20no%2Drepeat%200%20center%3B%7D%2Egrey%20%2Eaccordion%20a%2Edcjq%2Dparent%2Eactive%20%2Edcjq%2Dicon%20%7Bbackground%3A%20url%28data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABoAAAApCAYAAAArpDnNAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFoSURBVHjaYvz%2F%2Fz8DLcHLFy%2FKuHl4mFgYaAz%2B%2Ff8vBaTYmGhtEQM0xJhob8%2BoRUPBIhAeRj7692%2BYWfQPSo8GHdmpjsXExEQaSD8lQo8oEH8%2Fc%2BbMF5LiCOgjcD7i4uKaA%2BR7E7KEhYXloJmZmSwZ1QQk6JSVlQ2YmJg2ANl%2B%2BCz58%2BePpoaGBj%2FZccTIyMgE9B4L0LK1WCyDW0K1kgGLZRRbAosjsEXe3t5PgBagW5aMbomzszNDTEzMS7KDLjg4uL2tre0fsmVAag66JU1NTeuEhIQekeMjWOm9xsXFJRzZMmQAs4SdnT0SyP1LaRxhtQzNkl%2BUxBG8YoLikN27d%2F81NTX9X1ZW9v%2FHjx9rgWJsaGpIwqeOHp3w4cOHaejtOrDPxMTEVqqrq2%2BgxCcYRRAWuTV6eno2QPospZYgBx2ulupxqtVH9Cy96dM4oVtVTu%2BKb7RdR05HbLSRP8h9xDBs8xFAgAEASssocmC2zyUAAAAASUVORK5CYII%3D%29%20no%2Drepeat%200%20center%3B%7D%2Egrey%20%2Eaccordion%20a%3Ahover%20%7Bbackground%3A%20%23fff%3B%20color%3A%20%23990000%3B%7D%2Egrey%20%2Eaccordion%20a%3Aactive%7B%7D" rel="stylesheet" type="text/css" />
    <link href="data:text/css;charset=utf-8;charset=utf-8,%0Ahtml%20%7B%0Afont%2Dsize%3A%20100%25%3B%0Aoverflow%2Dy%3A%20scroll%3B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%2Dms%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%7D%0Abody%20%7B%0Acolor%3A%20%23444%3B%0Afont%2Dfamily%3A%20Georgia%2C%20Palatino%2C%20%27Palatino%20Linotype%27%2C%20Times%2C%20%27Times%20New%20Roman%27%2C%20serif%3B%0Afont%2Dsize%3A%2012px%3B%0Aline%2Dheight%3A%201%2E8%3B%0Abackground%3A%20%23fefefe%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230645ad%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%230b0080%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%2306e%3B%0A%7D%0Aa%3Aactive%20%7B%0Acolor%3A%20%23faa700%3B%0A%7D%0Aa%3Afocus%20%7B%0Aoutline%3A%20thin%20dotted%3B%0A%7D%0A%2A%3A%3A%2Dmoz%2Dselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%23000%3B%0A%7D%0A%2A%3A%3Aselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%23000%3B%0A%7D%0Aa%3A%3A%2Dmoz%2Dselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%230645ad%3B%0A%7D%0Aa%3A%3Aselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%230645ad%3B%0A%7D%0Ap%20%7B%0Amargin%3A%201em%200%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0A%7D%0Ah1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%20%7B%0Acolor%3A%20%23111%3B%0Aline%2Dheight%3A%20125%25%3B%0A%0Afont%2Dweight%3A%20normal%3B%0A%7D%0Ah4%2C%20h5%2C%20h6%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202%2E5em%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%202em%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%200%2E9em%3B%0A%7D%0Ablockquote%20%7B%0Acolor%3A%20%23666666%3B%0Amargin%3A%200%3B%0Apadding%2Dleft%3A%203em%3B%0Aborder%2Dleft%3A%200%2E5em%20%23EEE%20solid%3B%0A%7D%0Ahr%20%7B%0Adisplay%3A%20block%3B%0Aheight%3A%202px%3B%0Aborder%3A%200%3B%0Aborder%2Dtop%3A%201px%20solid%20%23aaa%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0Amargin%3A%201em%200%3B%0Apadding%3A%200%3B%0A%7D%0Apre%2C%20code%2C%20kbd%2C%20samp%20%7B%0Acolor%3A%20%23000%3B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0A%5Ffont%2Dfamily%3A%20%27courier%20new%27%2C%20monospace%3B%0Afont%2Dsize%3A%200%2E98em%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Ab%2C%20strong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adfn%20%7B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0Ains%20%7B%0Abackground%3A%20%23ff9%3B%0Acolor%3A%20%23000%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Amark%20%7B%0Abackground%3A%20%23ff0%3B%0Acolor%3A%20%23000%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Asub%2C%20sup%20%7B%0Afont%2Dsize%3A%2075%25%3B%0Aline%2Dheight%3A%200%3B%0Aposition%3A%20relative%3B%0Avertical%2Dalign%3A%20baseline%3B%0A%7D%0Asup%20%7B%0Atop%3A%20%2D0%2E5em%3B%0A%7D%0Asub%20%7B%0Abottom%3A%20%2D0%2E25em%3B%0A%7D%0Aul%2C%20ol%20%7B%0Amargin%3A%201em%200%3B%0Apadding%3A%200%200%200%202em%3B%0A%7D%0Ali%20%7B%0Aline%2Dheight%3A%20inherit%3B%0A%7D%0Ali%20p%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aul%20ul%2C%20ol%20ol%20%7B%0Amargin%3A%20%2E3em%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dbottom%3A%201em%3B%0A%7D%0Adt%20%7B%0Afont%2Dweight%3A%20bold%3B%0Amargin%2Dbottom%3A%20%2E8em%3B%0A%7D%0Add%20%7B%0Amargin%3A%200%200%20%2E8em%202em%3B%0A%7D%0Add%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%2Dms%2Dinterpolation%2Dmode%3A%20bicubic%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0Afigure%20%7B%0Adisplay%3A%20block%3B%0Atext%2Dalign%3A%20center%3B%0Amargin%3A%201em%200%3B%0A%7D%0Afigure%20img%20%7B%0Aborder%3A%20none%3B%0Amargin%3A%200%20auto%3B%0A%7D%0Afigcaption%20%7B%0Afont%2Dsize%3A%200%2E8em%3B%0Afont%2Dstyle%3A%20italic%3B%0Amargin%3A%200%200%20%2E8em%3B%0A%7D%0Atable%20%7B%0Amargin%2Dbottom%3A%202em%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dright%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dspacing%3A%200%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Apadding%3A%20%2E2em%201em%3B%0Abackground%2Dcolor%3A%20%23eee%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dleft%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20td%20%7B%0Apadding%3A%20%2E2em%201em%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dleft%3A%201px%20solid%20%23ddd%3B%0Avertical%2Dalign%3A%20top%3B%0A%7D%0A%2Eauthor%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%40media%20only%20screen%20and%20%28min%2Dwidth%3A%20480px%29%20%7B%0Abody%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0A%7D%0A%40media%20only%20screen%20and%20%28min%2Dwidth%3A%20768px%29%20%7B%0Abody%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0A%7D%0A%40media%20print%20%7B%0A%2A%20%7B%0Abackground%3A%20transparent%20%21important%3B%0Acolor%3A%20black%20%21important%3B%0Afilter%3A%20none%20%21important%3B%0A%2Dms%2Dfilter%3A%20none%20%21important%3B%0A%7D%0Abody%20%7B%0Afont%2Dsize%3A%2012pt%3B%0Amax%2Dwidth%3A%20100%25%3B%0A%7D%0Aa%2C%20a%3Avisited%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%201px%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20black%3B%0A%7D%0Aa%5Bhref%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28href%29%20%22%29%22%3B%0A%7D%0Aabbr%5Btitle%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28title%29%20%22%29%22%3B%0A%7D%0A%2Eir%20a%3Aafter%2C%20a%5Bhref%5E%3D%22javascript%3A%22%5D%3Aafter%2C%20a%5Bhref%5E%3D%22%23%22%5D%3Aafter%20%7B%0Acontent%3A%20%22%22%3B%0A%7D%0Apre%2C%20blockquote%20%7B%0Aborder%3A%201px%20solid%20%23999%3B%0Apadding%2Dright%3A%201em%3B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Atr%2C%20img%20%7B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%20%21important%3B%0A%7D%0A%40page%20%3Aleft%20%7B%0Amargin%3A%2015mm%2020mm%2015mm%2010mm%3B%0A%7D%0A%40page%20%3Aright%20%7B%0Amargin%3A%2015mm%2010mm%2015mm%2020mm%3B%0A%7D%0Ap%2C%20h2%2C%20h3%20%7B%0Aorphans%3A%203%3B%0Awidows%3A%203%3B%0A%7D%0Ah2%2C%20h3%20%7B%0Apage%2Dbreak%2Dafter%3A%20avoid%3B%0A%7D%0A%7D%0A" rel="stylesheet" type="text/css" />
  
    <script src="data:application/javascript; charset=utf-8;base64,LyoKICogIC9NYXRoSmF4LmpzCiAqCiAqICBDb3B5cmlnaHQgKGMpIDIwMDktMjAxOCBUaGUgTWF0aEpheCBDb25zb3J0aXVtCiAqCiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQmJmRvY3VtZW50LmNoaWxkTm9kZXMmJmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpe2lmKCEod2luZG93Lk1hdGhKYXgmJk1hdGhKYXguSHViKSl7aWYod2luZG93Lk1hdGhKYXgpe3dpbmRvdy5NYXRoSmF4PXtBdXRob3JDb25maWc6d2luZG93Lk1hdGhKYXh9fWVsc2V7d2luZG93Lk1hdGhKYXg9e319TWF0aEpheC5pc1BhY2tlZD10cnVlO01hdGhKYXgudmVyc2lvbj0iMi43LjQiO01hdGhKYXguZmlsZXZlcnNpb249IjIuNy40IjtNYXRoSmF4LmNkblZlcnNpb249IjIuNy40IjtNYXRoSmF4LmNkbkZpbGVWZXJzaW9ucz17fTsoZnVuY3Rpb24oZCl7dmFyIGI9d2luZG93W2RdO2lmKCFiKXtiPXdpbmRvd1tkXT17fX12YXIgZT1bXTt2YXIgYz1mdW5jdGlvbihmKXt2YXIgZz1mLmNvbnN0cnVjdG9yO2lmKCFnKXtnPWZ1bmN0aW9uKCl7fX1mb3IodmFyIGggaW4gZil7aWYoaCE9PSJjb25zdHJ1Y3RvciImJmYuaGFzT3duUHJvcGVydHkoaCkpe2dbaF09ZltoXX19cmV0dXJuIGd9O3ZhciBhPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5jYWxsZWUuSW5pdC5jYWxsKHRoaXMsYXJndW1lbnRzKX19O2IuT2JqZWN0PWMoe2NvbnN0cnVjdG9yOmEoKSxTdWJjbGFzczpmdW5jdGlvbihmLGgpe3ZhciBnPWEoKTtnLlNVUEVSPXRoaXM7Zy5Jbml0PXRoaXMuSW5pdDtnLlN1YmNsYXNzPXRoaXMuU3ViY2xhc3M7Zy5BdWdtZW50PXRoaXMuQXVnbWVudDtnLnByb3RvRnVuY3Rpb249dGhpcy5wcm90b0Z1bmN0aW9uO2cuY2FuPXRoaXMuY2FuO2cuaGFzPXRoaXMuaGFzO2cuaXNhPXRoaXMuaXNhO2cucHJvdG90eXBlPW5ldyB0aGlzKGUpO2cucHJvdG90eXBlLmNvbnN0cnVjdG9yPWc7Zy5BdWdtZW50KGYsaCk7cmV0dXJuIGd9LEluaXQ6ZnVuY3Rpb24oZil7dmFyIGc9dGhpcztpZihmLmxlbmd0aD09PTEmJmZbMF09PT1lKXtyZXR1cm4gZ31pZighKGcgaW5zdGFuY2VvZiBmLmNhbGxlZSkpe2c9bmV3IGYuY2FsbGVlKGUpfXJldHVybiBnLkluaXQuYXBwbHkoZyxmKXx8Z30sQXVnbWVudDpmdW5jdGlvbihmLGcpe3ZhciBoO2lmKGYhPW51bGwpe2ZvcihoIGluIGYpe2lmKGYuaGFzT3duUHJvcGVydHkoaCkpe3RoaXMucHJvdG9GdW5jdGlvbihoLGZbaF0pfX1pZihmLnRvU3RyaW5nIT09dGhpcy5wcm90b3R5cGUudG9TdHJpbmcmJmYudG9TdHJpbmchPT17fS50b1N0cmluZyl7dGhpcy5wcm90b0Z1bmN0aW9uKCJ0b1N0cmluZyIsZi50b1N0cmluZyl9fWlmKGchPW51bGwpe2ZvcihoIGluIGcpe2lmKGcuaGFzT3duUHJvcGVydHkoaCkpe3RoaXNbaF09Z1toXX19fXJldHVybiB0aGlzfSxwcm90b0Z1bmN0aW9uOmZ1bmN0aW9uKGcsZil7dGhpcy5wcm90b3R5cGVbZ109ZjtpZih0eXBlb2YgZj09PSJmdW5jdGlvbiIpe2YuU1VQRVI9dGhpcy5TVVBFUi5wcm90b3R5cGV9fSxwcm90b3R5cGU6e0luaXQ6ZnVuY3Rpb24oKXt9LFNVUEVSOmZ1bmN0aW9uKGYpe3JldHVybiBmLmNhbGxlZS5TVVBFUn0sY2FuOmZ1bmN0aW9uKGYpe3JldHVybiB0eXBlb2YodGhpc1tmXSk9PT0iZnVuY3Rpb24ifSxoYXM6ZnVuY3Rpb24oZil7cmV0dXJuIHR5cGVvZih0aGlzW2ZdKSE9PSJ1bmRlZmluZWQifSxpc2E6ZnVuY3Rpb24oZil7cmV0dXJuKGYgaW5zdGFuY2VvZiBPYmplY3QpJiYodGhpcyBpbnN0YW5jZW9mIGYpfX0sY2FuOmZ1bmN0aW9uKGYpe3JldHVybiB0aGlzLnByb3RvdHlwZS5jYW4uY2FsbCh0aGlzLGYpfSxoYXM6ZnVuY3Rpb24oZil7cmV0dXJuIHRoaXMucHJvdG90eXBlLmhhcy5jYWxsKHRoaXMsZil9LGlzYTpmdW5jdGlvbihnKXt2YXIgZj10aGlzO3doaWxlKGYpe2lmKGY9PT1nKXtyZXR1cm4gdHJ1ZX1lbHNle2Y9Zi5TVVBFUn19cmV0dXJuIGZhbHNlfSxTaW1wbGVTVVBFUjpjKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbihmKXtyZXR1cm4gdGhpcy5TaW1wbGVTVVBFUi5kZWZpbmUoZil9LGRlZmluZTpmdW5jdGlvbihmKXt2YXIgaD17fTtpZihmIT1udWxsKXtmb3IodmFyIGcgaW4gZil7aWYoZi5oYXNPd25Qcm9wZXJ0eShnKSl7aFtnXT10aGlzLndyYXAoZyxmW2ddKX19aWYoZi50b1N0cmluZyE9PXRoaXMucHJvdG90eXBlLnRvU3RyaW5nJiZmLnRvU3RyaW5nIT09e30udG9TdHJpbmcpe2gudG9TdHJpbmc9dGhpcy53cmFwKCJ0b1N0cmluZyIsZi50b1N0cmluZyl9fXJldHVybiBofSx3cmFwOmZ1bmN0aW9uKGksaCl7aWYodHlwZW9mKGgpIT09ImZ1bmN0aW9uInx8IWgudG9TdHJpbmcoKS5tYXRjaCgvXC5ccypTVVBFUlxzKlwoLykpe3JldHVybiBofXZhciBnPWZ1bmN0aW9uKCl7dGhpcy5TVVBFUj1nLlNVUEVSW2ldO3RyeXt2YXIgZj1oLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1jYXRjaChqKXtkZWxldGUgdGhpcy5TVVBFUjt0aHJvdyBqfWRlbGV0ZSB0aGlzLlNVUEVSO3JldHVybiBmfTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGgudG9TdHJpbmcuYXBwbHkoaCxhcmd1bWVudHMpfTtyZXR1cm4gZ319KX0pO2IuT2JqZWN0LmlzQXJyYXk9QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oZil7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmKT09PSJbb2JqZWN0IEFycmF5XSJ9O2IuT2JqZWN0LkFycmF5PUFycmF5fSkoIk1hdGhKYXgiKTsoZnVuY3Rpb24oQkFTRU5BTUUpe3ZhciBCQVNFPXdpbmRvd1tCQVNFTkFNRV07aWYoIUJBU0Upe0JBU0U9d2luZG93W0JBU0VOQU1FXT17fX12YXIgaXNBcnJheT1CQVNFLk9iamVjdC5pc0FycmF5O3ZhciBDQUxMQkFDSz1mdW5jdGlvbihkYXRhKXt2YXIgY2I9ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmNhbGxlZS5leGVjdXRlLmFwcGx5KGFyZ3VtZW50cy5jYWxsZWUsYXJndW1lbnRzKX07Zm9yKHZhciBpZCBpbiBDQUxMQkFDSy5wcm90b3R5cGUpe2lmKENBTExCQUNLLnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eShpZCkpe2lmKHR5cGVvZihkYXRhW2lkXSkhPT0idW5kZWZpbmVkIil7Y2JbaWRdPWRhdGFbaWRdfWVsc2V7Y2JbaWRdPUNBTExCQUNLLnByb3RvdHlwZVtpZF19fX1jYi50b1N0cmluZz1DQUxMQkFDSy5wcm90b3R5cGUudG9TdHJpbmc7cmV0dXJuIGNifTtDQUxMQkFDSy5wcm90b3R5cGU9e2lzQ2FsbGJhY2s6dHJ1ZSxob29rOmZ1bmN0aW9uKCl7fSxkYXRhOltdLG9iamVjdDp3aW5kb3csZXhlY3V0ZTpmdW5jdGlvbigpe2lmKCF0aGlzLmNhbGxlZHx8dGhpcy5hdXRvUmVzZXQpe3RoaXMuY2FsbGVkPSF0aGlzLmF1dG9SZXNldDtyZXR1cm4gdGhpcy5ob29rLmFwcGx5KHRoaXMub2JqZWN0LHRoaXMuZGF0YS5jb25jYXQoW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCkpKX19LHJlc2V0OmZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMuY2FsbGVkfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhvb2sudG9TdHJpbmcuYXBwbHkodGhpcy5ob29rLGFyZ3VtZW50cyl9fTt2YXIgSVNDQUxMQkFDSz1mdW5jdGlvbihmKXtyZXR1cm4odHlwZW9mKGYpPT09ImZ1bmN0aW9uIiYmZi5pc0NhbGxiYWNrKX07dmFyIEVWQUw9ZnVuY3Rpb24oY29kZSl7cmV0dXJuIGV2YWwuY2FsbCh3aW5kb3csY29kZSl9O3ZhciBURVNURVZBTD1mdW5jdGlvbigpe0VWQUwoInZhciBfX1RlU3RfVmFSX18gPSAxIik7aWYod2luZG93Ll9fVGVTdF9WYVJfXyl7dHJ5e2RlbGV0ZSB3aW5kb3cuX19UZVN0X1ZhUl9ffWNhdGNoKGVycm9yKXt3aW5kb3cuX19UZVN0X1ZhUl9fPW51bGx9fWVsc2V7aWYod2luZG93LmV4ZWNTY3JpcHQpe0VWQUw9ZnVuY3Rpb24oY29kZSl7QkFTRS5fX2NvZGU9Y29kZTtjb2RlPSJ0cnkgeyIrQkFTRU5BTUUrIi5fX3Jlc3VsdCA9IGV2YWwoIitCQVNFTkFNRSsiLl9fY29kZSl9IGNhdGNoKGVycikgeyIrQkFTRU5BTUUrIi5fX3Jlc3VsdCA9IGVycn0iO3dpbmRvdy5leGVjU2NyaXB0KGNvZGUpO3ZhciByZXN1bHQ9QkFTRS5fX3Jlc3VsdDtkZWxldGUgQkFTRS5fX3Jlc3VsdDtkZWxldGUgQkFTRS5fX2NvZGU7aWYocmVzdWx0IGluc3RhbmNlb2YgRXJyb3Ipe3Rocm93IHJlc3VsdH1yZXR1cm4gcmVzdWx0fX1lbHNle0VWQUw9ZnVuY3Rpb24oY29kZSl7QkFTRS5fX2NvZGU9Y29kZTtjb2RlPSJ0cnkgeyIrQkFTRU5BTUUrIi5fX3Jlc3VsdCA9IGV2YWwoIitCQVNFTkFNRSsiLl9fY29kZSl9IGNhdGNoKGVycikgeyIrQkFTRU5BTUUrIi5fX3Jlc3VsdCA9IGVycn0iO3ZhciBoZWFkPShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpKVswXTtpZighaGVhZCl7aGVhZD1kb2N1bWVudC5ib2R5fXZhciBzY3JpcHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7c2NyaXB0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvZGUpKTtoZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7aGVhZC5yZW1vdmVDaGlsZChzY3JpcHQpO3ZhciByZXN1bHQ9QkFTRS5fX3Jlc3VsdDtkZWxldGUgQkFTRS5fX3Jlc3VsdDtkZWxldGUgQkFTRS5fX2NvZGU7aWYocmVzdWx0IGluc3RhbmNlb2YgRXJyb3Ipe3Rocm93IHJlc3VsdH1yZXR1cm4gcmVzdWx0fX19VEVTVEVWQUw9bnVsbH07dmFyIFVTSU5HPWZ1bmN0aW9uKGFyZ3MsaSl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmISh0eXBlb2YgYXJndW1lbnRzWzBdPT09ImZ1bmN0aW9uIikmJmFyZ3VtZW50c1swXSBpbnN0YW5jZW9mIE9iamVjdCYmdHlwZW9mIGFyZ3VtZW50c1sxXT09PSJudW1iZXIiKXthcmdzPVtdLnNsaWNlLmNhbGwoYXJncyxpKX1lbHNle2FyZ3M9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCl9fWlmKGlzQXJyYXkoYXJncykmJmFyZ3MubGVuZ3RoPT09MSYmdHlwZW9mKGFyZ3NbMF0pPT09ImZ1bmN0aW9uIil7YXJncz1hcmdzWzBdfWlmKHR5cGVvZiBhcmdzPT09ImZ1bmN0aW9uIil7aWYoYXJncy5leGVjdXRlPT09Q0FMTEJBQ0sucHJvdG90eXBlLmV4ZWN1dGUpe3JldHVybiBhcmdzfXJldHVybiBDQUxMQkFDSyh7aG9vazphcmdzfSl9ZWxzZXtpZihpc0FycmF5KGFyZ3MpKXtpZih0eXBlb2YoYXJnc1swXSk9PT0ic3RyaW5nIiYmYXJnc1sxXSBpbnN0YW5jZW9mIE9iamVjdCYmdHlwZW9mIGFyZ3NbMV1bYXJnc1swXV09PT0iZnVuY3Rpb24iKXtyZXR1cm4gQ0FMTEJBQ0soe2hvb2s6YXJnc1sxXVthcmdzWzBdXSxvYmplY3Q6YXJnc1sxXSxkYXRhOmFyZ3Muc2xpY2UoMil9KX1lbHNle2lmKHR5cGVvZiBhcmdzWzBdPT09ImZ1bmN0aW9uIil7cmV0dXJuIENBTExCQUNLKHtob29rOmFyZ3NbMF0sZGF0YTphcmdzLnNsaWNlKDEpfSl9ZWxzZXtpZih0eXBlb2YgYXJnc1sxXT09PSJmdW5jdGlvbiIpe3JldHVybiBDQUxMQkFDSyh7aG9vazphcmdzWzFdLG9iamVjdDphcmdzWzBdLGRhdGE6YXJncy5zbGljZSgyKX0pfX19fWVsc2V7aWYodHlwZW9mKGFyZ3MpPT09InN0cmluZyIpe2lmKFRFU1RFVkFMKXtURVNURVZBTCgpfXJldHVybiBDQUxMQkFDSyh7aG9vazpFVkFMLGRhdGE6W2FyZ3NdfSl9ZWxzZXtpZihhcmdzIGluc3RhbmNlb2YgT2JqZWN0KXtyZXR1cm4gQ0FMTEJBQ0soYXJncyl9ZWxzZXtpZih0eXBlb2YoYXJncyk9PT0idW5kZWZpbmVkIil7cmV0dXJuIENBTExCQUNLKHt9KX19fX19dGhyb3cgRXJyb3IoIkNhbid0IG1ha2UgY2FsbGJhY2sgZnJvbSBnaXZlbiBkYXRhIil9O3ZhciBERUxBWT1mdW5jdGlvbih0aW1lLGNhbGxiYWNrKXtjYWxsYmFjaz1VU0lORyhjYWxsYmFjayk7Y2FsbGJhY2sudGltZW91dD1zZXRUaW1lb3V0KGNhbGxiYWNrLHRpbWUpO3JldHVybiBjYWxsYmFja307dmFyIFdBSVRGT1I9ZnVuY3Rpb24oY2FsbGJhY2ssc2lnbmFsKXtjYWxsYmFjaz1VU0lORyhjYWxsYmFjayk7aWYoIWNhbGxiYWNrLmNhbGxlZCl7V0FJVFNJR05BTChjYWxsYmFjayxzaWduYWwpO3NpZ25hbC5wZW5kaW5nKyt9fTt2YXIgV0FJVEVYRUNVVEU9ZnVuY3Rpb24oKXt2YXIgc2lnbmFscz10aGlzLnNpZ25hbDtkZWxldGUgdGhpcy5zaWduYWw7dGhpcy5leGVjdXRlPXRoaXMub2xkRXhlY3V0ZTtkZWxldGUgdGhpcy5vbGRFeGVjdXRlO3ZhciByZXN1bHQ9dGhpcy5leGVjdXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihJU0NBTExCQUNLKHJlc3VsdCkmJiFyZXN1bHQuY2FsbGVkKXtXQUlUU0lHTkFMKHJlc3VsdCxzaWduYWxzKX1lbHNle2Zvcih2YXIgaT0wLG09c2lnbmFscy5sZW5ndGg7aTxtO2krKyl7c2lnbmFsc1tpXS5wZW5kaW5nLS07aWYoc2lnbmFsc1tpXS5wZW5kaW5nPD0wKXtzaWduYWxzW2ldLmNhbGwoKX19fX07dmFyIFdBSVRTSUdOQUw9ZnVuY3Rpb24oY2FsbGJhY2ssc2lnbmFscyl7aWYoIWlzQXJyYXkoc2lnbmFscykpe3NpZ25hbHM9W3NpZ25hbHNdfWlmKCFjYWxsYmFjay5zaWduYWwpe2NhbGxiYWNrLm9sZEV4ZWN1dGU9Y2FsbGJhY2suZXhlY3V0ZTtjYWxsYmFjay5leGVjdXRlPVdBSVRFWEVDVVRFO2NhbGxiYWNrLnNpZ25hbD1zaWduYWxzfWVsc2V7aWYoc2lnbmFscy5sZW5ndGg9PT0xKXtjYWxsYmFjay5zaWduYWwucHVzaChzaWduYWxzWzBdKX1lbHNle2NhbGxiYWNrLnNpZ25hbD1jYWxsYmFjay5zaWduYWwuY29uY2F0KHNpZ25hbHMpfX19O3ZhciBBRlRFUj1mdW5jdGlvbihjYWxsYmFjayl7Y2FsbGJhY2s9VVNJTkcoY2FsbGJhY2spO2NhbGxiYWNrLnBlbmRpbmc9MDtmb3IodmFyIGk9MSxtPWFyZ3VtZW50cy5sZW5ndGg7aTxtO2krKyl7aWYoYXJndW1lbnRzW2ldKXtXQUlURk9SKGFyZ3VtZW50c1tpXSxjYWxsYmFjayl9fWlmKGNhbGxiYWNrLnBlbmRpbmc9PT0wKXt2YXIgcmVzdWx0PWNhbGxiYWNrKCk7aWYoSVNDQUxMQkFDSyhyZXN1bHQpKXtjYWxsYmFjaz1yZXN1bHR9fXJldHVybiBjYWxsYmFja307dmFyIEhPT0tTPU1hdGhKYXguT2JqZWN0LlN1YmNsYXNzKHtJbml0OmZ1bmN0aW9uKHJlc2V0KXt0aGlzLmhvb2tzPVtdO3RoaXMucmVtb3ZlPVtdO3RoaXMucmVzZXQ9cmVzZXQ7dGhpcy5ydW5uaW5nPWZhbHNlfSxBZGQ6ZnVuY3Rpb24oaG9vayxwcmlvcml0eSl7aWYocHJpb3JpdHk9PW51bGwpe3ByaW9yaXR5PTEwfWlmKCFJU0NBTExCQUNLKGhvb2spKXtob29rPVVTSU5HKGhvb2spfWhvb2sucHJpb3JpdHk9cHJpb3JpdHk7dmFyIGk9dGhpcy5ob29rcy5sZW5ndGg7d2hpbGUoaT4wJiZwcmlvcml0eTx0aGlzLmhvb2tzW2ktMV0ucHJpb3JpdHkpe2ktLX10aGlzLmhvb2tzLnNwbGljZShpLDAsaG9vayk7cmV0dXJuIGhvb2t9LFJlbW92ZTpmdW5jdGlvbihob29rKXtmb3IodmFyIGk9MCxtPXRoaXMuaG9va3MubGVuZ3RoO2k8bTtpKyspe2lmKHRoaXMuaG9va3NbaV09PT1ob29rKXtpZih0aGlzLnJ1bm5pbmcpe3RoaXMucmVtb3ZlLnB1c2goaSl9ZWxzZXt0aGlzLmhvb2tzLnNwbGljZShpLDEpfXJldHVybn19fSxFeGVjdXRlOmZ1bmN0aW9uKCl7dmFyIGNhbGxiYWNrcz1be31dO3RoaXMucnVubmluZz10cnVlO2Zvcih2YXIgaT0wLG09dGhpcy5ob29rcy5sZW5ndGg7aTxtO2krKyl7aWYodGhpcy5yZXNldCl7dGhpcy5ob29rc1tpXS5yZXNldCgpfXZhciByZXN1bHQ9dGhpcy5ob29rc1tpXS5hcHBseSh3aW5kb3csYXJndW1lbnRzKTtpZihJU0NBTExCQUNLKHJlc3VsdCkmJiFyZXN1bHQuY2FsbGVkKXtjYWxsYmFja3MucHVzaChyZXN1bHQpfX10aGlzLnJ1bm5pbmc9ZmFsc2U7aWYodGhpcy5yZW1vdmUubGVuZ3RoKXt0aGlzLlJlbW92ZVBlbmRpbmcoKX1pZihjYWxsYmFja3MubGVuZ3RoPT09MSl7cmV0dXJuIG51bGx9aWYoY2FsbGJhY2tzLmxlbmd0aD09PTIpe3JldHVybiBjYWxsYmFja3NbMV19cmV0dXJuIEFGVEVSLmFwcGx5KHt9LGNhbGxiYWNrcyl9LFJlbW92ZVBlbmRpbmc6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZT10aGlzLnJlbW92ZS5zb3J0KCk7Zm9yKHZhciBpPXRoaXMucmVtb3ZlLmxlbmd0aC0xO2k+PTA7aS0tKXt0aGlzLmhvb2tzLnNwbGljZShpLDEpfXRoaXMucmVtb3ZlPVtdfX0pO3ZhciBFWEVDVVRFSE9PS1M9ZnVuY3Rpb24oaG9va3MsZGF0YSxyZXNldCl7aWYoIWhvb2tzKXtyZXR1cm4gbnVsbH1pZighaXNBcnJheShob29rcykpe2hvb2tzPVtob29rc119aWYoIWlzQXJyYXkoZGF0YSkpe2RhdGE9KGRhdGE9PW51bGw/W106W2RhdGFdKX12YXIgaGFuZGxlcj1IT09LUyhyZXNldCk7Zm9yKHZhciBpPTAsbT1ob29rcy5sZW5ndGg7aTxtO2krKyl7aGFuZGxlci5BZGQoaG9va3NbaV0pfXJldHVybiBoYW5kbGVyLkV4ZWN1dGUuYXBwbHkoaGFuZGxlcixkYXRhKX07dmFyIFFVRVVFPUJBU0UuT2JqZWN0LlN1YmNsYXNzKHtJbml0OmZ1bmN0aW9uKCl7dGhpcy5wZW5kaW5nPXRoaXMucnVubmluZz0wO3RoaXMucXVldWU9W107dGhpcy5QdXNoLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sUHVzaDpmdW5jdGlvbigpe3ZhciBjYWxsYmFjaztmb3IodmFyIGk9MCxtPWFyZ3VtZW50cy5sZW5ndGg7aTxtO2krKyl7Y2FsbGJhY2s9VVNJTkcoYXJndW1lbnRzW2ldKTtpZihjYWxsYmFjaz09PWFyZ3VtZW50c1tpXSYmIWNhbGxiYWNrLmNhbGxlZCl7Y2FsbGJhY2s9VVNJTkcoWyJ3YWl0Iix0aGlzLGNhbGxiYWNrXSl9dGhpcy5xdWV1ZS5wdXNoKGNhbGxiYWNrKX1pZighdGhpcy5ydW5uaW5nJiYhdGhpcy5wZW5kaW5nKXt0aGlzLlByb2Nlc3MoKX1yZXR1cm4gY2FsbGJhY2t9LFByb2Nlc3M6ZnVuY3Rpb24ocXVldWUpe3doaWxlKCF0aGlzLnJ1bm5pbmcmJiF0aGlzLnBlbmRpbmcmJnRoaXMucXVldWUubGVuZ3RoKXt2YXIgY2FsbGJhY2s9dGhpcy5xdWV1ZVswXTtxdWV1ZT10aGlzLnF1ZXVlLnNsaWNlKDEpO3RoaXMucXVldWU9W107dGhpcy5TdXNwZW5kKCk7dmFyIHJlc3VsdD1jYWxsYmFjaygpO3RoaXMuUmVzdW1lKCk7aWYocXVldWUubGVuZ3RoKXt0aGlzLnF1ZXVlPXF1ZXVlLmNvbmNhdCh0aGlzLnF1ZXVlKX1pZihJU0NBTExCQUNLKHJlc3VsdCkmJiFyZXN1bHQuY2FsbGVkKXtXQUlURk9SKHJlc3VsdCx0aGlzKX19fSxTdXNwZW5kOmZ1bmN0aW9uKCl7dGhpcy5ydW5uaW5nKyt9LFJlc3VtZTpmdW5jdGlvbigpe2lmKHRoaXMucnVubmluZyl7dGhpcy5ydW5uaW5nLS19fSxjYWxsOmZ1bmN0aW9uKCl7dGhpcy5Qcm9jZXNzLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sd2FpdDpmdW5jdGlvbihjYWxsYmFjayl7cmV0dXJuIGNhbGxiYWNrfX0pO3ZhciBTSUdOQUw9UVVFVUUuU3ViY2xhc3Moe0luaXQ6ZnVuY3Rpb24obmFtZSl7UVVFVUUucHJvdG90eXBlLkluaXQuY2FsbCh0aGlzKTt0aGlzLm5hbWU9bmFtZTt0aGlzLnBvc3RlZD1bXTt0aGlzLmxpc3RlbmVycz1IT09LUyh0cnVlKTt0aGlzLnBvc3Rpbmc9ZmFsc2U7dGhpcy5jYWxsYmFjaz1udWxsfSxQb3N0OmZ1bmN0aW9uKG1lc3NhZ2UsY2FsbGJhY2ssZm9yZ2V0KXtjYWxsYmFjaz1VU0lORyhjYWxsYmFjayk7aWYodGhpcy5wb3N0aW5nfHx0aGlzLnBlbmRpbmcpe3RoaXMuUHVzaChbIlBvc3QiLHRoaXMsbWVzc2FnZSxjYWxsYmFjayxmb3JnZXRdKX1lbHNle3RoaXMuY2FsbGJhY2s9Y2FsbGJhY2s7Y2FsbGJhY2sucmVzZXQoKTtpZighZm9yZ2V0KXt0aGlzLnBvc3RlZC5wdXNoKG1lc3NhZ2UpfXRoaXMuU3VzcGVuZCgpO3RoaXMucG9zdGluZz10cnVlO3ZhciByZXN1bHQ9dGhpcy5saXN0ZW5lcnMuRXhlY3V0ZShtZXNzYWdlKTtpZihJU0NBTExCQUNLKHJlc3VsdCkmJiFyZXN1bHQuY2FsbGVkKXtXQUlURk9SKHJlc3VsdCx0aGlzKX10aGlzLlJlc3VtZSgpO3RoaXMucG9zdGluZz1mYWxzZTtpZighdGhpcy5wZW5kaW5nKXt0aGlzLmNhbGwoKX19cmV0dXJuIGNhbGxiYWNrfSxDbGVhcjpmdW5jdGlvbihjYWxsYmFjayl7Y2FsbGJhY2s9VVNJTkcoY2FsbGJhY2spO2lmKHRoaXMucG9zdGluZ3x8dGhpcy5wZW5kaW5nKXtjYWxsYmFjaz10aGlzLlB1c2goWyJDbGVhciIsdGhpcyxjYWxsYmFja10pfWVsc2V7dGhpcy5wb3N0ZWQ9W107Y2FsbGJhY2soKX1yZXR1cm4gY2FsbGJhY2t9LGNhbGw6ZnVuY3Rpb24oKXt0aGlzLmNhbGxiYWNrKHRoaXMpO3RoaXMuUHJvY2VzcygpfSxJbnRlcmVzdDpmdW5jdGlvbihjYWxsYmFjayxpZ25vcmVQYXN0LHByaW9yaXR5KXtjYWxsYmFjaz1VU0lORyhjYWxsYmFjayk7dGhpcy5saXN0ZW5lcnMuQWRkKGNhbGxiYWNrLHByaW9yaXR5KTtpZighaWdub3JlUGFzdCl7Zm9yKHZhciBpPTAsbT10aGlzLnBvc3RlZC5sZW5ndGg7aTxtO2krKyl7Y2FsbGJhY2sucmVzZXQoKTt2YXIgcmVzdWx0PWNhbGxiYWNrKHRoaXMucG9zdGVkW2ldKTtpZihJU0NBTExCQUNLKHJlc3VsdCkmJmk9PT10aGlzLnBvc3RlZC5sZW5ndGgtMSl7V0FJVEZPUihyZXN1bHQsdGhpcyl9fX1yZXR1cm4gY2FsbGJhY2t9LE5vSW50ZXJlc3Q6ZnVuY3Rpb24oY2FsbGJhY2spe3RoaXMubGlzdGVuZXJzLlJlbW92ZShjYWxsYmFjayl9LE1lc3NhZ2VIb29rOmZ1bmN0aW9uKG1zZyxjYWxsYmFjayxwcmlvcml0eSl7Y2FsbGJhY2s9VVNJTkcoY2FsbGJhY2spO2lmKCF0aGlzLmhvb2tzKXt0aGlzLmhvb2tzPXt9O3RoaXMuSW50ZXJlc3QoWyJFeGVjdXRlSG9va3MiLHRoaXNdKX1pZighdGhpcy5ob29rc1ttc2ddKXt0aGlzLmhvb2tzW21zZ109SE9PS1ModHJ1ZSl9dGhpcy5ob29rc1ttc2ddLkFkZChjYWxsYmFjayxwcmlvcml0eSk7Zm9yKHZhciBpPTAsbT10aGlzLnBvc3RlZC5sZW5ndGg7aTxtO2krKyl7aWYodGhpcy5wb3N0ZWRbaV09PW1zZyl7Y2FsbGJhY2sucmVzZXQoKTtjYWxsYmFjayh0aGlzLnBvc3RlZFtpXSl9fWNhbGxiYWNrLm1zZz1tc2c7cmV0dXJuIGNhbGxiYWNrfSxFeGVjdXRlSG9va3M6ZnVuY3Rpb24obXNnKXt2YXIgdHlwZT0oaXNBcnJheShtc2cpP21zZ1swXTptc2cpO2lmKCF0aGlzLmhvb2tzW3R5cGVdKXtyZXR1cm4gbnVsbH1yZXR1cm4gdGhpcy5ob29rc1t0eXBlXS5FeGVjdXRlKG1zZyl9LFJlbW92ZUhvb2s6ZnVuY3Rpb24oaG9vayl7dGhpcy5ob29rc1tob29rLm1zZ10uUmVtb3ZlKGhvb2spfX0se3NpZ25hbHM6e30sZmluZDpmdW5jdGlvbihuYW1lKXtpZighU0lHTkFMLnNpZ25hbHNbbmFtZV0pe1NJR05BTC5zaWduYWxzW25hbWVdPW5ldyBTSUdOQUwobmFtZSl9cmV0dXJuIFNJR05BTC5zaWduYWxzW25hbWVdfX0pO0JBU0UuQ2FsbGJhY2s9QkFTRS5DYWxsQmFjaz1VU0lORztCQVNFLkNhbGxiYWNrLkRlbGF5PURFTEFZO0JBU0UuQ2FsbGJhY2suQWZ0ZXI9QUZURVI7QkFTRS5DYWxsYmFjay5RdWV1ZT1RVUVVRTtCQVNFLkNhbGxiYWNrLlNpZ25hbD1TSUdOQUwuZmluZDtCQVNFLkNhbGxiYWNrLkhvb2tzPUhPT0tTO0JBU0UuQ2FsbGJhY2suRXhlY3V0ZUhvb2tzPUVYRUNVVEVIT09LU30pKCJNYXRoSmF4Iik7KGZ1bmN0aW9uKGUpe3ZhciBhPXdpbmRvd1tlXTtpZighYSl7YT13aW5kb3dbZV09e319dmFyIGQ9KG5hdmlnYXRvci52ZW5kb3I9PT0iQXBwbGUgQ29tcHV0ZXIsIEluYy4iJiZ0eXBlb2YgbmF2aWdhdG9yLnZlbmRvclN1Yj09PSJ1bmRlZmluZWQiKTt2YXIgZz0wO3ZhciBoPWZ1bmN0aW9uKGkpe2lmKGRvY3VtZW50LnN0eWxlU2hlZXRzJiZkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGg+Zyl7Zz1kb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGh9aWYoIWkpe2k9ZG9jdW1lbnQuaGVhZHx8KChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpKVswXSk7aWYoIWkpe2k9ZG9jdW1lbnQuYm9keX19cmV0dXJuIGl9O3ZhciBmPVtdO3ZhciBjPWZ1bmN0aW9uKCl7Zm9yKHZhciBrPTAsaj1mLmxlbmd0aDtrPGo7aysrKXthLkFqYXguaGVhZC5yZW1vdmVDaGlsZChmW2tdKX1mPVtdfTt2YXIgYj17fTtiW2VdPSIiO2IuYTExeT0iW01hdGhKYXhdL2V4dGVuc2lvbnMvYTExeSI7Yi5Db250cmliPSJodHRwczovL2Nkbi5tYXRoamF4Lm9yZy9tYXRoamF4L2NvbnRyaWIiO2EuQWpheD17bG9hZGVkOnt9LGxvYWRpbmc6e30sbG9hZEhvb2tzOnt9LHRpbWVvdXQ6MTUqMTAwMCxzdHlsZURlbGF5OjEsY29uZmlnOntyb290OiIiLHBhdGg6Yn0scGFyYW1zOnt9LFNUQVRVUzp7T0s6MSxFUlJPUjotMX0sZmlsZVVSTDpmdW5jdGlvbihqKXt2YXIgaTt3aGlsZSgoaT1qLm1hdGNoKC9eXFsoWy0uX2EtejAtOV0rKVxdL2kpKSYmYi5oYXNPd25Qcm9wZXJ0eShpWzFdKSl7aj0oYltpWzFdXXx8dGhpcy5jb25maWcucm9vdCkrai5zdWJzdHIoaVsxXS5sZW5ndGgrMil9cmV0dXJuIGp9LGZpbGVOYW1lOmZ1bmN0aW9uKGope3ZhciBpPXRoaXMuY29uZmlnLnJvb3Q7aWYoai5zdWJzdHIoMCxpLmxlbmd0aCk9PT1pKXtqPSJbIitlKyJdIitqLnN1YnN0cihpLmxlbmd0aCl9ZG97dmFyIGs9ZmFsc2U7Zm9yKHZhciBsIGluIGIpe2lmKGIuaGFzT3duUHJvcGVydHkobCkmJmJbbF0pe2lmKGouc3Vic3RyKDAsYltsXS5sZW5ndGgpPT09YltsXSl7aj0iWyIrbCsiXSIrai5zdWJzdHIoYltsXS5sZW5ndGgpO2s9dHJ1ZTticmVha319fX13aGlsZShrKTtyZXR1cm4gan0sZmlsZVJldjpmdW5jdGlvbihqKXt2YXIgaT1hLmNkbkZpbGVWZXJzaW9uc1tqXXx8YS5jZG5WZXJzaW9ufHwiIjtpZihpKXtpPSI/Vj0iK2l9cmV0dXJuIGl9LHVybFJldjpmdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5maWxlVVJMKGkpK3RoaXMuZmlsZVJldihpKX0sUmVxdWlyZTpmdW5jdGlvbihrLG4pe249YS5DYWxsYmFjayhuKTt2YXIgbDtpZihrIGluc3RhbmNlb2YgT2JqZWN0KXtmb3IodmFyIGogaW4gayl7aWYoay5oYXNPd25Qcm9wZXJ0eShqKSl7bD1qLnRvVXBwZXJDYXNlKCk7az1rW2pdfX19ZWxzZXtsPWsuc3BsaXQoL1wuLykucG9wKCkudG9VcHBlckNhc2UoKX1pZih0aGlzLnBhcmFtcy5ub0NvbnRyaWImJmsuc3Vic3RyKDAsOSk9PT0iW0NvbnRyaWJdIil7bih0aGlzLlNUQVRVUy5FUlJPUil9ZWxzZXtrPXRoaXMuZmlsZVVSTChrKTtpZih0aGlzLmxvYWRlZFtrXSl7bih0aGlzLmxvYWRlZFtrXSl9ZWxzZXt2YXIgbT17fTttW2xdPWs7dGhpcy5Mb2FkKG0sbil9fXJldHVybiBufSxMb2FkOmZ1bmN0aW9uKGssbSl7bT1hLkNhbGxiYWNrKG0pO3ZhciBsO2lmKGsgaW5zdGFuY2VvZiBPYmplY3Qpe2Zvcih2YXIgaiBpbiBrKXtpZihrLmhhc093blByb3BlcnR5KGopKXtsPWoudG9VcHBlckNhc2UoKTtrPWtbal19fX1lbHNle2w9ay5zcGxpdCgvXC4vKS5wb3AoKS50b1VwcGVyQ2FzZSgpfWs9dGhpcy5maWxlVVJMKGspO2lmKHRoaXMubG9hZGluZ1trXSl7dGhpcy5hZGRIb29rKGssbSl9ZWxzZXt0aGlzLmhlYWQ9aCh0aGlzLmhlYWQpO2lmKHRoaXMubG9hZGVyW2xdKXt0aGlzLmxvYWRlcltsXS5jYWxsKHRoaXMsayxtKX1lbHNle3Rocm93IEVycm9yKCJDYW4ndCBsb2FkIGZpbGVzIG9mIHR5cGUgIitsKX19cmV0dXJuIG19LExvYWRIb29rOmZ1bmN0aW9uKGwsbSxrKXttPWEuQ2FsbGJhY2sobSk7aWYobCBpbnN0YW5jZW9mIE9iamVjdCl7Zm9yKHZhciBqIGluIGwpe2lmKGwuaGFzT3duUHJvcGVydHkoaikpe2w9bFtqXX19fWw9dGhpcy5maWxlVVJMKGwpO2lmKHRoaXMubG9hZGVkW2xdKXttKHRoaXMubG9hZGVkW2xdKX1lbHNle3RoaXMuYWRkSG9vayhsLG0sayl9cmV0dXJuIG19LGFkZEhvb2s6ZnVuY3Rpb24oaixrLGkpe2lmKCF0aGlzLmxvYWRIb29rc1tqXSl7dGhpcy5sb2FkSG9va3Nbal09TWF0aEpheC5DYWxsYmFjay5Ib29rcygpfXRoaXMubG9hZEhvb2tzW2pdLkFkZChrLGkpO2suZmlsZT1qfSxyZW1vdmVIb29rOmZ1bmN0aW9uKGkpe2lmKHRoaXMubG9hZEhvb2tzW2kuZmlsZV0pe3RoaXMubG9hZEhvb2tzW2kuZmlsZV0uUmVtb3ZlKGkpO2lmKCF0aGlzLmxvYWRIb29rc1tpLmZpbGVdLmhvb2tzLmxlbmd0aCl7ZGVsZXRlIHRoaXMubG9hZEhvb2tzW2kuZmlsZV19fX0sUHJlbG9hZGluZzpmdW5jdGlvbigpe2Zvcih2YXIgbD0wLGo9YXJndW1lbnRzLmxlbmd0aDtsPGo7bCsrKXt2YXIgaz10aGlzLmZpbGVVUkwoYXJndW1lbnRzW2xdKTtpZighdGhpcy5sb2FkaW5nW2tdKXt0aGlzLmxvYWRpbmdba109e3ByZWxvYWRlZDp0cnVlfX19fSxsb2FkZXI6e0pTOmZ1bmN0aW9uKGssbSl7dmFyIGo9dGhpcy5maWxlTmFtZShrKTt2YXIgaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTt2YXIgbD1hLkNhbGxiYWNrKFsibG9hZFRpbWVvdXQiLHRoaXMsa10pO3RoaXMubG9hZGluZ1trXT17Y2FsbGJhY2s6bSx0aW1lb3V0OnNldFRpbWVvdXQobCx0aGlzLnRpbWVvdXQpLHN0YXR1czp0aGlzLlNUQVRVUy5PSyxzY3JpcHQ6aX07dGhpcy5sb2FkaW5nW2tdLm1lc3NhZ2U9YS5NZXNzYWdlLkZpbGUoaik7aS5vbmVycm9yPWw7aS50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiO2kuc3JjPWsrdGhpcy5maWxlUmV2KGopO3RoaXMuaGVhZC5hcHBlbmRDaGlsZChpKX0sQ1NTOmZ1bmN0aW9uKGosbCl7dmFyIGk9dGhpcy5maWxlTmFtZShqKTt2YXIgaz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaW5rIik7ay5yZWw9InN0eWxlc2hlZXQiO2sudHlwZT0idGV4dC9jc3MiO2suaHJlZj1qK3RoaXMuZmlsZVJldihpKTt0aGlzLmxvYWRpbmdbal09e2NhbGxiYWNrOmwsbWVzc2FnZTphLk1lc3NhZ2UuRmlsZShpKSxzdGF0dXM6dGhpcy5TVEFUVVMuT0t9O3RoaXMuaGVhZC5hcHBlbmRDaGlsZChrKTt0aGlzLnRpbWVyLmNyZWF0ZS5jYWxsKHRoaXMsW3RoaXMudGltZXIuZmlsZSxqXSxrKX19LHRpbWVyOntjcmVhdGU6ZnVuY3Rpb24oaixpKXtqPWEuQ2FsbGJhY2soaik7aWYoaS5ub2RlTmFtZT09PSJTVFlMRSImJmkuc3R5bGVTaGVldCYmdHlwZW9mKGkuc3R5bGVTaGVldC5jc3NUZXh0KSE9PSJ1bmRlZmluZWQiKXtqKHRoaXMuU1RBVFVTLk9LKX1lbHNle2lmKHdpbmRvdy5jaHJvbWUmJmkubm9kZU5hbWU9PT0iTElOSyIpe2oodGhpcy5TVEFUVVMuT0spfWVsc2V7aWYoZCl7dGhpcy50aW1lci5zdGFydCh0aGlzLFt0aGlzLnRpbWVyLmNoZWNrU2FmYXJpMixnKyssal0sdGhpcy5zdHlsZURlbGF5KX1lbHNle3RoaXMudGltZXIuc3RhcnQodGhpcyxbdGhpcy50aW1lci5jaGVja0xlbmd0aCxpLGpdLHRoaXMuc3R5bGVEZWxheSl9fX1yZXR1cm4gan0sc3RhcnQ6ZnVuY3Rpb24oaixpLGssbCl7aT1hLkNhbGxiYWNrKGkpO2kuZXhlY3V0ZT10aGlzLmV4ZWN1dGU7aS50aW1lPXRoaXMudGltZTtpLlNUQVRVUz1qLlNUQVRVUztpLnRpbWVvdXQ9bHx8ai50aW1lb3V0O2kuZGVsYXk9aS50b3RhbD1rfHwwO2lmKGspe3NldFRpbWVvdXQoaSxrKX1lbHNle2koKX19LHRpbWU6ZnVuY3Rpb24oaSl7dGhpcy50b3RhbCs9dGhpcy5kZWxheTt0aGlzLmRlbGF5PU1hdGguZmxvb3IodGhpcy5kZWxheSoxLjA1KzUpO2lmKHRoaXMudG90YWw+PXRoaXMudGltZW91dCl7aSh0aGlzLlNUQVRVUy5FUlJPUik7cmV0dXJuIDF9cmV0dXJuIDB9LGZpbGU6ZnVuY3Rpb24oaixpKXtpZihpPDApe2EuQWpheC5sb2FkVGltZW91dChqKX1lbHNle2EuQWpheC5sb2FkQ29tcGxldGUoail9fSxleGVjdXRlOmZ1bmN0aW9uKCl7dGhpcy5ob29rLmNhbGwodGhpcy5vYmplY3QsdGhpcyx0aGlzLmRhdGFbMF0sdGhpcy5kYXRhWzFdKX0sY2hlY2tTYWZhcmkyOmZ1bmN0aW9uKGksaixrKXtpZihpLnRpbWUoaykpe3JldHVybn1pZihkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGg+aiYmZG9jdW1lbnQuc3R5bGVTaGVldHNbal0uY3NzUnVsZXMmJmRvY3VtZW50LnN0eWxlU2hlZXRzW2pdLmNzc1J1bGVzLmxlbmd0aCl7ayhpLlNUQVRVUy5PSyl9ZWxzZXtzZXRUaW1lb3V0KGksaS5kZWxheSl9fSxjaGVja0xlbmd0aDpmdW5jdGlvbihpLGwsbil7aWYoaS50aW1lKG4pKXtyZXR1cm59dmFyIG09MDt2YXIgaj0obC5zaGVldHx8bC5zdHlsZVNoZWV0KTt0cnl7aWYoKGouY3NzUnVsZXN8fGoucnVsZXN8fFtdKS5sZW5ndGg+MCl7bT0xfX1jYXRjaChrKXtpZihrLm1lc3NhZ2UubWF0Y2goL3Byb3RlY3RlZCB2YXJpYWJsZXxyZXN0cmljdGVkIFVSSS8pKXttPTF9ZWxzZXtpZihrLm1lc3NhZ2UubWF0Y2goL1NlY3VyaXR5IGVycm9yLykpe209MX19fWlmKG0pe3NldFRpbWVvdXQoYS5DYWxsYmFjayhbbixpLlNUQVRVUy5PS10pLDApfWVsc2V7c2V0VGltZW91dChpLGkuZGVsYXkpfX19LGxvYWRDb21wbGV0ZTpmdW5jdGlvbihpKXtpPXRoaXMuZmlsZVVSTChpKTt2YXIgaj10aGlzLmxvYWRpbmdbaV07aWYoaiYmIWoucHJlbG9hZGVkKXthLk1lc3NhZ2UuQ2xlYXIoai5tZXNzYWdlKTtjbGVhclRpbWVvdXQoai50aW1lb3V0KTtpZihqLnNjcmlwdCl7aWYoZi5sZW5ndGg9PT0wKXtzZXRUaW1lb3V0KGMsMCl9Zi5wdXNoKGouc2NyaXB0KX10aGlzLmxvYWRlZFtpXT1qLnN0YXR1cztkZWxldGUgdGhpcy5sb2FkaW5nW2ldO3RoaXMuYWRkSG9vayhpLGouY2FsbGJhY2spfWVsc2V7aWYoail7ZGVsZXRlIHRoaXMubG9hZGluZ1tpXX10aGlzLmxvYWRlZFtpXT10aGlzLlNUQVRVUy5PSztqPXtzdGF0dXM6dGhpcy5TVEFUVVMuT0t9fWlmKCF0aGlzLmxvYWRIb29rc1tpXSl7cmV0dXJuIG51bGx9cmV0dXJuIHRoaXMubG9hZEhvb2tzW2ldLkV4ZWN1dGUoai5zdGF0dXMpfSxsb2FkVGltZW91dDpmdW5jdGlvbihpKXtpZih0aGlzLmxvYWRpbmdbaV0udGltZW91dCl7Y2xlYXJUaW1lb3V0KHRoaXMubG9hZGluZ1tpXS50aW1lb3V0KX10aGlzLmxvYWRpbmdbaV0uc3RhdHVzPXRoaXMuU1RBVFVTLkVSUk9SO3RoaXMubG9hZEVycm9yKGkpO3RoaXMubG9hZENvbXBsZXRlKGkpfSxsb2FkRXJyb3I6ZnVuY3Rpb24oaSl7YS5NZXNzYWdlLlNldChbIkxvYWRGYWlsZWQiLCJGaWxlIGZhaWxlZCB0byBsb2FkOiAlMSIsaV0sbnVsbCwyMDAwKTthLkh1Yi5zaWduYWwuUG9zdChbImZpbGUgbG9hZCBlcnJvciIsaV0pfSxTdHlsZXM6ZnVuY3Rpb24oayxsKXt2YXIgaT10aGlzLlN0eWxlU3RyaW5nKGspO2lmKGk9PT0iIil7bD1hLkNhbGxiYWNrKGwpO2woKX1lbHNle3ZhciBqPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7ai50eXBlPSJ0ZXh0L2NzcyI7dGhpcy5oZWFkPWgodGhpcy5oZWFkKTt0aGlzLmhlYWQuYXBwZW5kQ2hpbGQoaik7aWYoai5zdHlsZVNoZWV0JiZ0eXBlb2Yoai5zdHlsZVNoZWV0LmNzc1RleHQpIT09InVuZGVmaW5lZCIpe2ouc3R5bGVTaGVldC5jc3NUZXh0PWl9ZWxzZXtqLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGkpKX1sPXRoaXMudGltZXIuY3JlYXRlLmNhbGwodGhpcyxsLGopfXJldHVybiBsfSxTdHlsZVN0cmluZzpmdW5jdGlvbihuKXtpZih0eXBlb2Yobik9PT0ic3RyaW5nIil7cmV0dXJuIG59dmFyIGs9IiIsbyxtO2ZvcihvIGluIG4pe2lmKG4uaGFzT3duUHJvcGVydHkobykpe2lmKHR5cGVvZiBuW29dPT09InN0cmluZyIpe2srPW8rIiB7IituW29dKyJ9XG4ifWVsc2V7aWYoYS5PYmplY3QuaXNBcnJheShuW29dKSl7Zm9yKHZhciBsPTA7bDxuW29dLmxlbmd0aDtsKyspe209e307bVtvXT1uW29dW2xdO2srPXRoaXMuU3R5bGVTdHJpbmcobSl9fWVsc2V7aWYoby5zdWJzdHIoMCw2KT09PSJAbWVkaWEiKXtrKz1vKyIgeyIrdGhpcy5TdHlsZVN0cmluZyhuW29dKSsifVxuIn1lbHNle2lmKG5bb10hPW51bGwpe209W107Zm9yKHZhciBqIGluIG5bb10pe2lmKG5bb10uaGFzT3duUHJvcGVydHkoaikpe2lmKG5bb11bal0hPW51bGwpe21bbS5sZW5ndGhdPWorIjogIituW29dW2pdfX19ays9bysiIHsiK20uam9pbigiOyAiKSsifVxuIn19fX19fXJldHVybiBrfX19KSgiTWF0aEpheCIpO01hdGhKYXguSFRNTD17RWxlbWVudDpmdW5jdGlvbihkLGYsZSl7dmFyIGc9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkKSxoO2lmKGYpe2lmKGYuaGFzT3duUHJvcGVydHkoInN0eWxlIikpe3ZhciBjPWYuc3R5bGU7Zi5zdHlsZT17fTtmb3IoaCBpbiBjKXtpZihjLmhhc093blByb3BlcnR5KGgpKXtmLnN0eWxlW2gucmVwbGFjZSgvLShbYS16XSkvZyx0aGlzLnVjTWF0Y2gpXT1jW2hdfX19TWF0aEpheC5IdWIuSW5zZXJ0KGcsZik7Zm9yKGggaW4gZil7aWYoaD09PSJyb2xlInx8aC5zdWJzdHIoMCw1KT09PSJhcmlhLSIpe2cuc2V0QXR0cmlidXRlKGgsZltoXSl9fX1pZihlKXtpZighTWF0aEpheC5PYmplY3QuaXNBcnJheShlKSl7ZT1bZV19Zm9yKHZhciBiPTAsYT1lLmxlbmd0aDtiPGE7YisrKXtpZihNYXRoSmF4Lk9iamVjdC5pc0FycmF5KGVbYl0pKXtnLmFwcGVuZENoaWxkKHRoaXMuRWxlbWVudChlW2JdWzBdLGVbYl1bMV0sZVtiXVsyXSkpfWVsc2V7aWYoZD09PSJzY3JpcHQiKXt0aGlzLnNldFNjcmlwdChnLGVbYl0pfWVsc2V7Zy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShlW2JdKSl9fX19cmV0dXJuIGd9LHVjTWF0Y2g6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfSxhZGRFbGVtZW50OmZ1bmN0aW9uKGIsYSxkLGMpe3JldHVybiBiLmFwcGVuZENoaWxkKHRoaXMuRWxlbWVudChhLGQsYykpfSxUZXh0Tm9kZTpmdW5jdGlvbihhKXtyZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYSl9LGFkZFRleHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5hcHBlbmRDaGlsZCh0aGlzLlRleHROb2RlKGIpKX0sc2V0U2NyaXB0OmZ1bmN0aW9uKGEsYil7aWYodGhpcy5zZXRTY3JpcHRCdWcpe2EudGV4dD1ifWVsc2V7d2hpbGUoYS5maXJzdENoaWxkKXthLnJlbW92ZUNoaWxkKGEuZmlyc3RDaGlsZCl9dGhpcy5hZGRUZXh0KGEsYil9fSxnZXRTY3JpcHQ6ZnVuY3Rpb24oYSl7dmFyIGI9KGEudGV4dD09PSIiP2EuaW5uZXJIVE1MOmEudGV4dCk7cmV0dXJuIGIucmVwbGFjZSgvXlxzKy8sIiIpLnJlcGxhY2UoL1xzKyQvLCIiKX0sQ29va2llOntwcmVmaXg6Im1qeCIsZXhwaXJlczozNjUsU2V0OmZ1bmN0aW9uKGEsZSl7dmFyIGQ9W107aWYoZSl7Zm9yKHZhciBnIGluIGUpe2lmKGUuaGFzT3duUHJvcGVydHkoZykpe2QucHVzaChnKyI6IitlW2ddLnRvU3RyaW5nKCkucmVwbGFjZSgvJi9nLCImJiIpKX19fXZhciBiPXRoaXMucHJlZml4KyIuIithKyI9Iitlc2NhcGUoZC5qb2luKCImOyIpKTtpZih0aGlzLmV4cGlyZXMpe3ZhciBmPW5ldyBEYXRlKCk7Zi5zZXREYXRlKGYuZ2V0RGF0ZSgpK3RoaXMuZXhwaXJlcyk7Yis9IjsgZXhwaXJlcz0iK2YudG9HTVRTdHJpbmcoKX10cnl7ZG9jdW1lbnQuY29va2llPWIrIjsgcGF0aD0vIn1jYXRjaChjKXt9fSxHZXQ6ZnVuY3Rpb24oYSxkKXtpZighZCl7ZD17fX12YXIgZz1uZXcgUmVnRXhwKCIoPzpefDtcXHMqKSIrdGhpcy5wcmVmaXgrIlxcLiIrYSsiPShbXjtdKikoPzo7fCQpIik7dmFyIGY7dHJ5e2Y9Zy5leGVjKGRvY3VtZW50LmNvb2tpZSl9Y2F0Y2goYyl7fWlmKGYmJmZbMV0hPT0iIil7dmFyIGo9dW5lc2NhcGUoZlsxXSkuc3BsaXQoIiY7Iik7Zm9yKHZhciBlPTAsYj1qLmxlbmd0aDtlPGI7ZSsrKXtmPWpbZV0ubWF0Y2goLyhbXjpdKyk6KC4qKS8pO3ZhciBoPWZbMl0ucmVwbGFjZSgvJiYvZywiJiIpO2lmKGg9PT0idHJ1ZSIpe2g9dHJ1ZX1lbHNle2lmKGg9PT0iZmFsc2UiKXtoPWZhbHNlfWVsc2V7aWYoaC5tYXRjaCgvXi0/KFxkKyhcLlxkKyk/fFwuXGQrKSQvKSl7aD1wYXJzZUZsb2F0KGgpfX19ZFtmWzFdXT1ofX1yZXR1cm4gZH19fTtNYXRoSmF4LkxvY2FsaXphdGlvbj17bG9jYWxlOiJlbiIsZGlyZWN0b3J5OiJbTWF0aEpheF0vbG9jYWxpemF0aW9uIixzdHJpbmdzOnthcjp7bWVudVRpdGxlOiJcdTA2MjdcdTA2NDRcdTA2MzlcdTA2MzFcdTA2MjhcdTA2NEFcdTA2MjkifSxhc3Q6e21lbnVUaXRsZToiYXN0dXJpYW51In0sYmc6e21lbnVUaXRsZToiXHUwNDMxXHUwNDRBXHUwNDNCXHUwNDMzXHUwNDMwXHUwNDQwXHUwNDQxXHUwNDNBXHUwNDM4In0sYmNjOnttZW51VGl0bGU6Ilx1MDYyOFx1MDY0NFx1MDY0OFx1MDY4Nlx1MDZDQyJ9LGJyOnttZW51VGl0bGU6ImJyZXpob25lZyJ9LGNhOnttZW51VGl0bGU6ImNhdGFsXHUwMEUwIn0sY2RvOnttZW51VGl0bGU6Ik1cdTAwRUNuZy1kXHUwMTE1XHUwMzI0bmctbmdcdTFFNzNcdTAzMDQifSxjczp7bWVudVRpdGxlOiJcdTAxMERlXHUwMTYxdGluYSJ9LGRhOnttZW51VGl0bGU6ImRhbnNrIn0sZGU6e21lbnVUaXRsZToiRGV1dHNjaCJ9LGRpcTp7bWVudVRpdGxlOiJaYXpha2kifSxlbjp7bWVudVRpdGxlOiJFbmdsaXNoIixpc0xvYWRlZDp0cnVlfSxlbzp7bWVudVRpdGxlOiJFc3BlcmFudG8ifSxlczp7bWVudVRpdGxlOiJlc3BhXHUwMEYxb2wifSxmYTp7bWVudVRpdGxlOiJcdTA2NDFcdTA2MjdcdTA2MzFcdTA2MzNcdTA2Q0MifSxmaTp7bWVudVRpdGxlOiJzdW9taSJ9LGZyOnttZW51VGl0bGU6ImZyYW5cdTAwRTdhaXMifSxnbDp7bWVudVRpdGxlOiJnYWxlZ28ifSxoZTp7bWVudVRpdGxlOiJcdTA1RTJcdTA1RDFcdTA1RThcdTA1RDlcdTA1RUEifSxpYTp7bWVudVRpdGxlOiJpbnRlcmxpbmd1YSJ9LGl0OnttZW51VGl0bGU6Iml0YWxpYW5vIn0samE6e21lbnVUaXRsZToiXHU2NUU1XHU2NzJDXHU4QTlFIn0sa246e21lbnVUaXRsZToiXHUwQzk1XHUwQ0E4XHUwQ0NEXHUwQ0E4XHUwQ0ExIn0sa286e21lbnVUaXRsZToiXHVENTVDXHVBRDZEXHVDNUI0In0sbGI6e21lbnVUaXRsZToiTFx1MDBFQnR6ZWJ1ZXJnZXNjaCJ9LGxraTp7bWVudVRpdGxlOiJcdTA2NDRcdTA2RDVcdTA2QTlcdTA2Q0MifSxsdDp7bWVudVRpdGxlOiJsaWV0dXZpXHUwMTczIn0sbWs6e21lbnVUaXRsZToiXHUwNDNDXHUwNDMwXHUwNDNBXHUwNDM1XHUwNDM0XHUwNDNFXHUwNDNEXHUwNDQxXHUwNDNBXHUwNDM4In0sbmw6e21lbnVUaXRsZToiTmVkZXJsYW5kcyJ9LG9jOnttZW51VGl0bGU6Im9jY2l0YW4ifSxwbDp7bWVudVRpdGxlOiJwb2xza2kifSxwdDp7bWVudVRpdGxlOiJwb3J0dWd1XHUwMEVBcyJ9LCJwdC1iciI6e21lbnVUaXRsZToicG9ydHVndVx1MDBFQXMgZG8gQnJhc2lsIn0scnU6e21lbnVUaXRsZToiXHUwNDQwXHUwNDQzXHUwNDQxXHUwNDQxXHUwNDNBXHUwNDM4XHUwNDM5In0sc2NvOnttZW51VGl0bGU6IlNjb3RzIn0sc2NuOnttZW51VGl0bGU6InNpY2lsaWFudSJ9LHNrOnttZW51VGl0bGU6InNsb3Zlblx1MDEwRGluYSJ9LHNsOnttZW51VGl0bGU6InNsb3Zlblx1MDE2MVx1MDEwRGluYSJ9LHN2OnttZW51VGl0bGU6InN2ZW5za2EifSx0aDp7bWVudVRpdGxlOiJcdTBFNDRcdTBFMTdcdTBFMjIifSx0cjp7bWVudVRpdGxlOiJUXHUwMEZDcmtcdTAwRTdlIn0sdWs6e21lbnVUaXRsZToiXHUwNDQzXHUwNDNBXHUwNDQwXHUwNDMwXHUwNDU3XHUwNDNEXHUwNDQxXHUwNDRDXHUwNDNBXHUwNDMwIn0sdmk6e21lbnVUaXRsZToiVGlcdTFFQkZuZyBWaVx1MUVDN3QifSwiemgtaGFucyI6e21lbnVUaXRsZToiXHU0RTJEXHU2NTg3XHVGRjA4XHU3QjgwXHU0RjUzXHVGRjA5In0sInpoLWhhbnQiOnttZW51VGl0bGU6Ilx1NkM0OVx1OEJFRCJ9fSxwYXR0ZXJuOi8lKFxkK3xce1xkK1x9fFx7W2Etel0rOlwlXGQrKD86XHwoPzolXHtcZCtcfXwlLnxbXlx9XSkqKStcfXwuKS9nLFNQTElUOigiYXhiIi5zcGxpdCgvKHgpLykubGVuZ3RoPT09Mz9mdW5jdGlvbihhLGIpe3JldHVybiBhLnNwbGl0KGIpfTpmdW5jdGlvbihjLGUpe3ZhciBhPVtdLGIsZD0wO2UubGFzdEluZGV4PTA7d2hpbGUoKGI9ZS5leGVjKGMpKSl7YS5wdXNoKGMuc3Vic3RyKGQsYi5pbmRleC1kKSk7YS5wdXNoLmFwcGx5KGEsYi5zbGljZSgxKSk7ZD1iLmluZGV4K2JbMF0ubGVuZ3RofWEucHVzaChjLnN1YnN0cihkKSk7cmV0dXJuIGF9KSxfOmZ1bmN0aW9uKGIsYSl7aWYoTWF0aEpheC5PYmplY3QuaXNBcnJheShhKSl7cmV0dXJuIHRoaXMucHJvY2Vzc1NuaXBwZXQoYixhKX1yZXR1cm4gdGhpcy5wcm9jZXNzU3RyaW5nKHRoaXMubG9va3VwUGhyYXNlKGIsYSksW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMikpfSxwcm9jZXNzU3RyaW5nOmZ1bmN0aW9uKGwscCxnKXt2YXIgaixlLG89TWF0aEpheC5PYmplY3QuaXNBcnJheTtmb3Ioaj0wLGU9cC5sZW5ndGg7ajxlO2orKyl7aWYoZyYmbyhwW2pdKSl7cFtqXT10aGlzLnByb2Nlc3NTbmlwcGV0KGcscFtqXSl9fXZhciBmPXRoaXMuU1BMSVQobCx0aGlzLnBhdHRlcm4pO2ZvcihqPTEsZT1mLmxlbmd0aDtqPGU7ais9Mil7dmFyIHE9ZltqXS5jaGFyQXQoMCk7aWYocT49IjAiJiZxPD0iOSIpe2Zbal09cFtmW2pdLTFdO2lmKHR5cGVvZiBmW2pdPT09Im51bWJlciIpe2Zbal09dGhpcy5udW1iZXIoZltqXSl9fWVsc2V7aWYocT09PSJ7Iil7cT1mW2pdLnN1YnN0cigxKTtpZihxPj0iMCImJnE8PSI5Iil7ZltqXT1wW2Zbal0uc3Vic3RyKDEsZltqXS5sZW5ndGgtMiktMV07aWYodHlwZW9mIGZbal09PT0ibnVtYmVyIil7ZltqXT10aGlzLm51bWJlcihmW2pdKX19ZWxzZXt2YXIgaz1mW2pdLm1hdGNoKC9eXHsoW2Etel0rKTolKFxkKylcfCguKilcfSQvKTtpZihrKXtpZihrWzFdPT09InBsdXJhbCIpe3ZhciBkPXBba1syXS0xXTtpZih0eXBlb2YgZD09PSJ1bmRlZmluZWQiKXtmW2pdPSI/Pz8ifWVsc2V7ZD10aGlzLnBsdXJhbChkKS0xO3ZhciBoPWtbM10ucmVwbGFjZSgvKF58W14lXSkoJSUpKiVcfC9nLCIkMSQyJVx1RUZFRiIpLnNwbGl0KC9cfC8pO2lmKGQ+PTAmJmQ8aC5sZW5ndGgpe2Zbal09dGhpcy5wcm9jZXNzU3RyaW5nKGhbZF0ucmVwbGFjZSgvXHVFRkVGL2csInwiKSxwLGcpfWVsc2V7ZltqXT0iPz8/In19fWVsc2V7ZltqXT0iJSIrZltqXX19fX19aWYoZltqXT09bnVsbCl7ZltqXT0iPz8/In19aWYoIWcpe3JldHVybiBmLmpvaW4oIiIpfXZhciBhPVtdLGI9IiI7Zm9yKGo9MDtqPGU7aisrKXtiKz1mW2pdO2orKztpZihqPGUpe2lmKG8oZltqXSkpe2EucHVzaChiKTthPWEuY29uY2F0KGZbal0pO2I9IiJ9ZWxzZXtiKz1mW2pdfX19aWYoYiE9PSIiKXthLnB1c2goYil9cmV0dXJuIGF9LHByb2Nlc3NTbmlwcGV0OmZ1bmN0aW9uKGcsZSl7dmFyIGM9W107Zm9yKHZhciBkPTAsYj1lLmxlbmd0aDtkPGI7ZCsrKXtpZihNYXRoSmF4Lk9iamVjdC5pc0FycmF5KGVbZF0pKXt2YXIgZj1lW2RdO2lmKHR5cGVvZiBmWzFdPT09InN0cmluZyIpe3ZhciBoPWZbMF07aWYoIU1hdGhKYXguT2JqZWN0LmlzQXJyYXkoaCkpe2g9W2csaF19dmFyIGE9dGhpcy5sb29rdXBQaHJhc2UoaCxmWzFdKTtjPWMuY29uY2F0KHRoaXMucHJvY2Vzc01hcmtkb3duKGEsZi5zbGljZSgyKSxnKSl9ZWxzZXtpZihNYXRoSmF4Lk9iamVjdC5pc0FycmF5KGZbMV0pKXtjPWMuY29uY2F0KHRoaXMucHJvY2Vzc1NuaXBwZXQuYXBwbHkodGhpcyxmKSl9ZWxzZXtpZihmLmxlbmd0aD49Myl7Yy5wdXNoKFtmWzBdLGZbMV0sdGhpcy5wcm9jZXNzU25pcHBldChnLGZbMl0pXSl9ZWxzZXtjLnB1c2goZVtkXSl9fX19ZWxzZXtjLnB1c2goZVtkXSl9fXJldHVybiBjfSxtYXJrZG93blBhdHRlcm46LyglLil8KFwqezEsM30pKCg/OiUufC4pKz8pXDJ8KGArKSgoPzolLnwuKSs/KVw0fFxbKCg/OiUufC4pKz8pXF1cKChbXlxzXCldKylcKS8scHJvY2Vzc01hcmtkb3duOmZ1bmN0aW9uKGIsaCxkKXt2YXIgaj1bXSxlO3ZhciBjPWIuc3BsaXQodGhpcy5tYXJrZG93blBhdHRlcm4pO3ZhciBnPWNbMF07Zm9yKHZhciBmPTEsYT1jLmxlbmd0aDtmPGE7Zis9OCl7aWYoY1tmKzFdKXtlPXRoaXMucHJvY2Vzc1N0cmluZyhjW2YrMl0saCxkKTtpZighTWF0aEpheC5PYmplY3QuaXNBcnJheShlKSl7ZT1bZV19ZT1bWyJiIiwiaSIsImkiXVtjW2YrMV0ubGVuZ3RoLTFdLHt9LGVdO2lmKGNbZisxXS5sZW5ndGg9PT0zKXtlPVsiYiIse30sZV19fWVsc2V7aWYoY1tmKzNdKXtlPXRoaXMucHJvY2Vzc1N0cmluZyhjW2YrNF0ucmVwbGFjZSgvXlxzLywiIikucmVwbGFjZSgvXHMkLywiIiksaCxkKTtpZighTWF0aEpheC5PYmplY3QuaXNBcnJheShlKSl7ZT1bZV19ZT1bImNvZGUiLHt9LGVdfWVsc2V7aWYoY1tmKzVdKXtlPXRoaXMucHJvY2Vzc1N0cmluZyhjW2YrNV0saCxkKTtpZighTWF0aEpheC5PYmplY3QuaXNBcnJheShlKSl7ZT1bZV19ZT1bImEiLHtocmVmOnRoaXMucHJvY2Vzc1N0cmluZyhjW2YrNl0saCksdGFyZ2V0OiJfYmxhbmsifSxlXX1lbHNle2crPWNbZl07ZT1udWxsfX19aWYoZSl7aj10aGlzLmNvbmNhdFN0cmluZyhqLGcsaCxkKTtqLnB1c2goZSk7Zz0iIn1pZihjW2YrN10hPT0iIil7Zys9Y1tmKzddfX1qPXRoaXMuY29uY2F0U3RyaW5nKGosZyxoLGQpO3JldHVybiBqfSxjb25jYXRTdHJpbmc6ZnVuY3Rpb24oYSxjLGIsZCl7aWYoYyE9IiIpe2M9dGhpcy5wcm9jZXNzU3RyaW5nKGMsYixkKTtpZighTWF0aEpheC5PYmplY3QuaXNBcnJheShjKSl7Yz1bY119YT1hLmNvbmNhdChjKX1yZXR1cm4gYX0sbG9va3VwUGhyYXNlOmZ1bmN0aW9uKGYsYSxkKXtpZighZCl7ZD0iXyJ9aWYoTWF0aEpheC5PYmplY3QuaXNBcnJheShmKSl7ZD0oZlswXXx8Il8iKTtmPShmWzFdfHwiIil9dmFyIGM9dGhpcy5sb2FkRG9tYWluKGQpO2lmKGMpe01hdGhKYXguSHViLlJlc3RhcnRBZnRlcihjKX12YXIgYj10aGlzLnN0cmluZ3NbdGhpcy5sb2NhbGVdO2lmKGIpe2lmKGIuZG9tYWlucyYmZCBpbiBiLmRvbWFpbnMpe3ZhciBlPWIuZG9tYWluc1tkXTtpZihlLnN0cmluZ3MmJmYgaW4gZS5zdHJpbmdzKXthPWUuc3RyaW5nc1tmXX19fXJldHVybiBhfSxsb2FkRmlsZTpmdW5jdGlvbihiLGQsZSl7ZT1NYXRoSmF4LkNhbGxiYWNrKGUpO2I9KGQuZmlsZXx8Yik7aWYoIWIubWF0Y2goL1wuanMkLykpe2IrPSIuanMifWlmKCFiLm1hdGNoKC9eKFthLXpdKzp8XFtNYXRoSmF4XF0pLykpe3ZhciBhPSh0aGlzLnN0cmluZ3NbdGhpcy5sb2NhbGVdLmRpcmVjdG9yeXx8dGhpcy5kaXJlY3RvcnkrIi8iK3RoaXMubG9jYWxlfHwiW01hdGhKYXhdL2xvY2FsaXphdGlvbi8iK3RoaXMubG9jYWxlKTtiPWErIi8iK2J9dmFyIGM9TWF0aEpheC5BamF4LlJlcXVpcmUoYixmdW5jdGlvbigpe2QuaXNMb2FkZWQ9dHJ1ZTtyZXR1cm4gZSgpfSk7cmV0dXJuKGMuY2FsbGVkP251bGw6Yyl9LGxvYWREb21haW46ZnVuY3Rpb24oYyxlKXt2YXIgYixhPXRoaXMuc3RyaW5nc1t0aGlzLmxvY2FsZV07aWYoYSl7aWYoIWEuaXNMb2FkZWQpe2I9dGhpcy5sb2FkRmlsZSh0aGlzLmxvY2FsZSxhKTtpZihiKXtyZXR1cm4gTWF0aEpheC5DYWxsYmFjay5RdWV1ZShiLFsibG9hZERvbWFpbiIsdGhpcyxjXSkuUHVzaChlfHx7fSl9fWlmKGEuZG9tYWlucyYmYyBpbiBhLmRvbWFpbnMpe3ZhciBkPWEuZG9tYWluc1tjXTtpZighZC5pc0xvYWRlZCl7Yj10aGlzLmxvYWRGaWxlKGMsZCk7aWYoYil7cmV0dXJuIE1hdGhKYXguQ2FsbGJhY2suUXVldWUoYikuUHVzaChlKX19fX1yZXR1cm4gTWF0aEpheC5DYWxsYmFjayhlKSgpfSxUcnk6ZnVuY3Rpb24oYSl7YT1NYXRoSmF4LkNhbGxiYWNrKGEpO2EuYXV0b1Jlc2V0PXRydWU7dHJ5e2EoKX1jYXRjaChiKXtpZighYi5yZXN0YXJ0KXt0aHJvdyBifU1hdGhKYXguQ2FsbGJhY2suQWZ0ZXIoWyJUcnkiLHRoaXMsYV0sYi5yZXN0YXJ0KX19LHJlc2V0TG9jYWxlOmZ1bmN0aW9uKGEpe2lmKCFhKXtyZXR1cm59YT1hLnRvTG93ZXJDYXNlKCk7d2hpbGUoIXRoaXMuc3RyaW5nc1thXSl7dmFyIGM9YS5sYXN0SW5kZXhPZigiLSIpO2lmKGM9PT0tMSl7cmV0dXJufWE9YS5zdWJzdHJpbmcoMCxjKX12YXIgYj10aGlzLnN0cmluZ3NbYV0ucmVtYXA7dGhpcy5sb2NhbGU9Yj9iOmE7TWF0aEpheC5DYWxsYmFjay5TaWduYWwoIkh1YiIpLlBvc3QoWyJMb2NhbGUgUmVzZXQiLHRoaXMubG9jYWxlXSl9LHNldExvY2FsZTpmdW5jdGlvbihhKXt0aGlzLnJlc2V0TG9jYWxlKGEpO2lmKE1hdGhKYXguTWVudSl7dGhpcy5sb2FkRG9tYWluKCJNYXRoTWVudSIpfX0sYWRkVHJhbnNsYXRpb246ZnVuY3Rpb24oYixlLGMpe3ZhciBkPXRoaXMuc3RyaW5nc1tiXSxhPWZhbHNlO2lmKCFkKXtkPXRoaXMuc3RyaW5nc1tiXT17fTthPXRydWV9aWYoIWQuZG9tYWlucyl7ZC5kb21haW5zPXt9fWlmKGUpe2lmKCFkLmRvbWFpbnNbZV0pe2QuZG9tYWluc1tlXT17fX1kPWQuZG9tYWluc1tlXX1NYXRoSmF4Lkh1Yi5JbnNlcnQoZCxjKTtpZihhJiZNYXRoSmF4Lk1lbnUubWVudSl7TWF0aEpheC5NZW51LkNyZWF0ZUxvY2FsZU1lbnUoKX19LHNldENTUzpmdW5jdGlvbihiKXt2YXIgYT10aGlzLnN0cmluZ3NbdGhpcy5sb2NhbGVdO2lmKGEpe2lmKGEuZm9udEZhbWlseSl7Yi5zdHlsZS5mb250RmFtaWx5PWEuZm9udEZhbWlseX1pZihhLmZvbnREaXJlY3Rpb24pe2Iuc3R5bGUuZGlyZWN0aW9uPWEuZm9udERpcmVjdGlvbjtpZihhLmZvbnREaXJlY3Rpb249PT0icnRsIil7Yi5zdHlsZS50ZXh0QWxpZ249InJpZ2h0In19fXJldHVybiBifSxmb250RmFtaWx5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zdHJpbmdzW3RoaXMubG9jYWxlXTtyZXR1cm4oYT9hLmZvbnRGYW1pbHk6bnVsbCl9LGZvbnREaXJlY3Rpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnN0cmluZ3NbdGhpcy5sb2NhbGVdO3JldHVybihhP2EuZm9udERpcmVjdGlvbjpudWxsKX0scGx1cmFsOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMuc3RyaW5nc1t0aGlzLmxvY2FsZV07aWYoYSYmYS5wbHVyYWwpe3JldHVybiBhLnBsdXJhbChiKX1pZihiPT0xKXtyZXR1cm4gMX1yZXR1cm4gMn0sbnVtYmVyOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMuc3RyaW5nc1t0aGlzLmxvY2FsZV07aWYoYSYmYS5udW1iZXIpe3JldHVybiBhLm51bWJlcihiKX1yZXR1cm4gYn19O01hdGhKYXguTWVzc2FnZT17cmVhZHk6ZmFsc2UsbG9nOlt7fV0sY3VycmVudDpudWxsLHRleHROb2RlQnVnOihuYXZpZ2F0b3IudmVuZG9yPT09IkFwcGxlIENvbXB1dGVyLCBJbmMuIiYmdHlwZW9mIG5hdmlnYXRvci52ZW5kb3JTdWI9PT0idW5kZWZpbmVkIil8fCh3aW5kb3cuaGFzT3duUHJvcGVydHkmJndpbmRvdy5oYXNPd25Qcm9wZXJ0eSgia29ucXVlcm9yIikpLHN0eWxlczp7IiNNYXRoSmF4X01lc3NhZ2UiOntwb3NpdGlvbjoiZml4ZWQiLGxlZnQ6IjFweCIsYm90dG9tOiIycHgiLCJiYWNrZ3JvdW5kLWNvbG9yIjoiI0U2RTZFNiIsYm9yZGVyOiIxcHggc29saWQgIzk1OTU5NSIsbWFyZ2luOiIwcHgiLHBhZGRpbmc6IjJweCA4cHgiLCJ6LWluZGV4IjoiMTAyIixjb2xvcjoiYmxhY2siLCJmb250LXNpemUiOiI4MCUiLHdpZHRoOiJhdXRvIiwid2hpdGUtc3BhY2UiOiJub3dyYXAifSwiI01hdGhKYXhfTVNJRV9GcmFtZSI6e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOjAsbGVmdDowLHdpZHRoOiIwcHgiLCJ6LWluZGV4IjoxMDEsYm9yZGVyOiIwcHgiLG1hcmdpbjoiMHB4IixwYWRkaW5nOiIwcHgifX0sYnJvd3NlcnM6e01TSUU6ZnVuY3Rpb24oYSl7TWF0aEpheC5NZXNzYWdlLm1zaWVGaXhlZFBvc2l0aW9uQnVnPSgoZG9jdW1lbnQuZG9jdW1lbnRNb2RlfHwwKTw3KTtpZihNYXRoSmF4Lk1lc3NhZ2UubXNpZUZpeGVkUG9zaXRpb25CdWcpe01hdGhKYXguSHViLmNvbmZpZy5zdHlsZXNbIiNNYXRoSmF4X01lc3NhZ2UiXS5wb3NpdGlvbj0iYWJzb2x1dGUifU1hdGhKYXguTWVzc2FnZS5xdWlya3M9KGRvY3VtZW50LmNvbXBhdE1vZGU9PT0iQmFja0NvbXBhdCIpfSxDaHJvbWU6ZnVuY3Rpb24oYSl7TWF0aEpheC5IdWIuY29uZmlnLnN0eWxlc1siI01hdGhKYXhfTWVzc2FnZSJdLmJvdHRvbT0iMS41ZW0iO01hdGhKYXguSHViLmNvbmZpZy5zdHlsZXNbIiNNYXRoSmF4X01lc3NhZ2UiXS5sZWZ0PSIxZW0ifX0sSW5pdDpmdW5jdGlvbihhKXtpZihhKXt0aGlzLnJlYWR5PXRydWV9aWYoIWRvY3VtZW50LmJvZHl8fCF0aGlzLnJlYWR5KXtyZXR1cm4gZmFsc2V9aWYodGhpcy5kaXYmJnRoaXMuZGl2LnBhcmVudE5vZGU9PW51bGwpe3RoaXMuZGl2PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJNYXRoSmF4X01lc3NhZ2UiKTt0aGlzLnRleHQ9KHRoaXMuZGl2P3RoaXMuZGl2LmZpcnN0Q2hpbGQ6bnVsbCl9aWYoIXRoaXMuZGl2KXt2YXIgYj1kb2N1bWVudC5ib2R5O2lmKHRoaXMubXNpZUZpeGVkUG9zaXRpb25CdWcmJndpbmRvdy5hdHRhY2hFdmVudCl7Yj10aGlzLmZyYW1lPXRoaXMuYWRkRGl2KGRvY3VtZW50LmJvZHkpO2IucmVtb3ZlQXR0cmlidXRlKCJpZCIpO2Iuc3R5bGUucG9zaXRpb249ImFic29sdXRlIjtiLnN0eWxlLmJvcmRlcj1iLnN0eWxlLm1hcmdpbj1iLnN0eWxlLnBhZGRpbmc9IjBweCI7Yi5zdHlsZS56SW5kZXg9IjEwMSI7Yi5zdHlsZS5oZWlnaHQ9IjBweCI7Yj10aGlzLmFkZERpdihiKTtiLmlkPSJNYXRoSmF4X01TSUVfRnJhbWUiO3dpbmRvdy5hdHRhY2hFdmVudCgib25zY3JvbGwiLHRoaXMuTW92ZUZyYW1lKTt3aW5kb3cuYXR0YWNoRXZlbnQoIm9ucmVzaXplIix0aGlzLk1vdmVGcmFtZSk7dGhpcy5Nb3ZlRnJhbWUoKX10aGlzLmRpdj10aGlzLmFkZERpdihiKTt0aGlzLmRpdi5zdHlsZS5kaXNwbGF5PSJub25lIn1pZighdGhpcy50ZXh0KXt0aGlzLnRleHQ9dGhpcy5kaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpKX1yZXR1cm4gdHJ1ZX0sYWRkRGl2OmZ1bmN0aW9uKGEpe3ZhciBiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2IuaWQ9Ik1hdGhKYXhfTWVzc2FnZSI7aWYoYS5maXJzdENoaWxkKXthLmluc2VydEJlZm9yZShiLGEuZmlyc3RDaGlsZCl9ZWxzZXthLmFwcGVuZENoaWxkKGIpfXJldHVybiBifSxNb3ZlRnJhbWU6ZnVuY3Rpb24oKXt2YXIgYT0oTWF0aEpheC5NZXNzYWdlLnF1aXJrcz9kb2N1bWVudC5ib2R5OmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7dmFyIGI9TWF0aEpheC5NZXNzYWdlLmZyYW1lO2Iuc3R5bGUubGVmdD1hLnNjcm9sbExlZnQrInB4IjtiLnN0eWxlLnRvcD1hLnNjcm9sbFRvcCsicHgiO2Iuc3R5bGUud2lkdGg9YS5jbGllbnRXaWR0aCsicHgiO2I9Yi5maXJzdENoaWxkO2Iuc3R5bGUuaGVpZ2h0PWEuY2xpZW50SGVpZ2h0KyJweCJ9LGxvY2FsaXplOmZ1bmN0aW9uKGEpe3JldHVybiBNYXRoSmF4LkxvY2FsaXphdGlvbi5fKGEsYSl9LGZpbHRlclRleHQ6ZnVuY3Rpb24oYSxjLGIpe2lmKE1hdGhKYXguSHViLmNvbmZpZy5tZXNzYWdlU3R5bGU9PT0ic2ltcGxlIil7aWYoYj09PSJMb2FkRmlsZSIpe2lmKCF0aGlzLmxvYWRpbmcpe3RoaXMubG9hZGluZz10aGlzLmxvY2FsaXplKCJMb2FkaW5nIikrIiAifWE9dGhpcy5sb2FkaW5nO3RoaXMubG9hZGluZys9Ii4ifWVsc2V7aWYoYj09PSJQcm9jZXNzTWF0aCIpe2lmKCF0aGlzLnByb2Nlc3Npbmcpe3RoaXMucHJvY2Vzc2luZz10aGlzLmxvY2FsaXplKCJQcm9jZXNzaW5nIikrIiAifWE9dGhpcy5wcm9jZXNzaW5nO3RoaXMucHJvY2Vzc2luZys9Ii4ifWVsc2V7aWYoYj09PSJUeXBlc2V0TWF0aCIpe2lmKCF0aGlzLnR5cGVzZXR0aW5nKXt0aGlzLnR5cGVzZXR0aW5nPXRoaXMubG9jYWxpemUoIlR5cGVzZXR0aW5nIikrIiAifWE9dGhpcy50eXBlc2V0dGluZzt0aGlzLnR5cGVzZXR0aW5nKz0iLiJ9fX19cmV0dXJuIGF9LGNsZWFyQ291bnRzOmZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMubG9hZGluZztkZWxldGUgdGhpcy5wcm9jZXNzaW5nO2RlbGV0ZSB0aGlzLnR5cGVzZXR0aW5nfSxTZXQ6ZnVuY3Rpb24oYyxlLGIpe2lmKGU9PW51bGwpe2U9dGhpcy5sb2cubGVuZ3RoO3RoaXMubG9nW2VdPXt9fXZhciBkPSIiO2lmKE1hdGhKYXguT2JqZWN0LmlzQXJyYXkoYykpe2Q9Y1swXTtpZihNYXRoSmF4Lk9iamVjdC5pc0FycmF5KGQpKXtkPWRbMV19dHJ5e2M9TWF0aEpheC5Mb2NhbGl6YXRpb24uXy5hcHBseShNYXRoSmF4LkxvY2FsaXphdGlvbixjKX1jYXRjaChhKXtpZighYS5yZXN0YXJ0KXt0aHJvdyBhfWlmKCFhLnJlc3RhcnQuY2FsbGVkKXtpZih0aGlzLmxvZ1tlXS5yZXN0YXJ0ZWQ9PW51bGwpe3RoaXMubG9nW2VdLnJlc3RhcnRlZD0wfXRoaXMubG9nW2VdLnJlc3RhcnRlZCsrO2RlbGV0ZSB0aGlzLmxvZ1tlXS5jbGVhcmVkO01hdGhKYXguQ2FsbGJhY2suQWZ0ZXIoWyJTZXQiLHRoaXMsYyxlLGJdLGEucmVzdGFydCk7cmV0dXJuIGV9fX1pZih0aGlzLnRpbWVyKXtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7ZGVsZXRlIHRoaXMudGltZXJ9dGhpcy5sb2dbZV0udGV4dD1jO3RoaXMubG9nW2VdLmZpbHRlcmVkVGV4dD1jPXRoaXMuZmlsdGVyVGV4dChjLGUsZCk7aWYodHlwZW9mKHRoaXMubG9nW2VdLm5leHQpPT09InVuZGVmaW5lZCIpe3RoaXMubG9nW2VdLm5leHQ9dGhpcy5jdXJyZW50O2lmKHRoaXMuY3VycmVudCE9bnVsbCl7dGhpcy5sb2dbdGhpcy5jdXJyZW50XS5wcmV2PWV9dGhpcy5jdXJyZW50PWV9aWYodGhpcy5jdXJyZW50PT09ZSYmTWF0aEpheC5IdWIuY29uZmlnLm1lc3NhZ2VTdHlsZSE9PSJub25lIil7aWYodGhpcy5Jbml0KCkpe2lmKHRoaXMudGV4dE5vZGVCdWcpe3RoaXMuZGl2LmlubmVySFRNTD1jfWVsc2V7dGhpcy50ZXh0Lm5vZGVWYWx1ZT1jfXRoaXMuZGl2LnN0eWxlLmRpc3BsYXk9IiI7aWYodGhpcy5zdGF0dXMpe3dpbmRvdy5zdGF0dXM9IiI7ZGVsZXRlIHRoaXMuc3RhdHVzfX1lbHNle3dpbmRvdy5zdGF0dXM9Yzt0aGlzLnN0YXR1cz10cnVlfX1pZih0aGlzLmxvZ1tlXS5yZXN0YXJ0ZWQpe2lmKHRoaXMubG9nW2VdLmNsZWFyZWQpe2I9MH1pZigtLXRoaXMubG9nW2VdLnJlc3RhcnRlZD09PTApe2RlbGV0ZSB0aGlzLmxvZ1tlXS5jbGVhcmVkfX1pZihiKXtzZXRUaW1lb3V0KE1hdGhKYXguQ2FsbGJhY2soWyJDbGVhciIsdGhpcyxlXSksYil9ZWxzZXtpZihiPT0wKXt0aGlzLkNsZWFyKGUsMCl9fXJldHVybiBlfSxDbGVhcjpmdW5jdGlvbihiLGEpe2lmKHRoaXMubG9nW2JdLnByZXYhPW51bGwpe3RoaXMubG9nW3RoaXMubG9nW2JdLnByZXZdLm5leHQ9dGhpcy5sb2dbYl0ubmV4dH1pZih0aGlzLmxvZ1tiXS5uZXh0IT1udWxsKXt0aGlzLmxvZ1t0aGlzLmxvZ1tiXS5uZXh0XS5wcmV2PXRoaXMubG9nW2JdLnByZXZ9aWYodGhpcy5jdXJyZW50PT09Yil7dGhpcy5jdXJyZW50PXRoaXMubG9nW2JdLm5leHQ7aWYodGhpcy50ZXh0KXtpZih0aGlzLmRpdi5wYXJlbnROb2RlPT1udWxsKXt0aGlzLkluaXQoKX1pZih0aGlzLmN1cnJlbnQ9PW51bGwpe2lmKHRoaXMudGltZXIpe2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtkZWxldGUgdGhpcy50aW1lcn1pZihhPT1udWxsKXthPTYwMH1pZihhPT09MCl7dGhpcy5SZW1vdmUoKX1lbHNle3RoaXMudGltZXI9c2V0VGltZW91dChNYXRoSmF4LkNhbGxiYWNrKFsiUmVtb3ZlIix0aGlzXSksYSl9fWVsc2V7aWYoTWF0aEpheC5IdWIuY29uZmlnLm1lc3NhZ2VTdHlsZSE9PSJub25lIil7aWYodGhpcy50ZXh0Tm9kZUJ1Zyl7dGhpcy5kaXYuaW5uZXJIVE1MPXRoaXMubG9nW3RoaXMuY3VycmVudF0uZmlsdGVyZWRUZXh0fWVsc2V7dGhpcy50ZXh0Lm5vZGVWYWx1ZT10aGlzLmxvZ1t0aGlzLmN1cnJlbnRdLmZpbHRlcmVkVGV4dH19fWlmKHRoaXMuc3RhdHVzKXt3aW5kb3cuc3RhdHVzPSIiO2RlbGV0ZSB0aGlzLnN0YXR1c319ZWxzZXtpZih0aGlzLnN0YXR1cyl7d2luZG93LnN0YXR1cz0odGhpcy5jdXJyZW50PT1udWxsPyIiOnRoaXMubG9nW3RoaXMuY3VycmVudF0udGV4dCl9fX1kZWxldGUgdGhpcy5sb2dbYl0ubmV4dDtkZWxldGUgdGhpcy5sb2dbYl0ucHJldjtkZWxldGUgdGhpcy5sb2dbYl0uZmlsdGVyZWRUZXh0O2lmKHRoaXMubG9nW2JdLnJlc3RhcnRlZCl7dGhpcy5sb2dbYl0uY2xlYXJlZD10cnVlfX0sUmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy50ZXh0Lm5vZGVWYWx1ZT0iIjt0aGlzLmRpdi5zdHlsZS5kaXNwbGF5PSJub25lIn0sRmlsZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5TZXQoWyJMb2FkRmlsZSIsIkxvYWRpbmcgJTEiLGFdLG51bGwsbnVsbCl9LExvZzpmdW5jdGlvbigpe3ZhciBiPVtdO2Zvcih2YXIgYz0xLGE9dGhpcy5sb2cubGVuZ3RoO2M8YTtjKyspe2JbY109dGhpcy5sb2dbY10udGV4dH1yZXR1cm4gYi5qb2luKCJcbiIpfX07TWF0aEpheC5IdWI9e2NvbmZpZzp7cm9vdDoiIixjb25maWc6W10sc3R5bGVTaGVldHM6W10sc3R5bGVzOnsiLk1hdGhKYXhfUHJldmlldyI6e2NvbG9yOiIjODg4In19LGpheDpbXSxleHRlbnNpb25zOltdLHByZUpheDpudWxsLHBvc3RKYXg6bnVsbCxkaXNwbGF5QWxpZ246ImNlbnRlciIsZGlzcGxheUluZGVudDoiMCIscHJlUmVtb3ZlQ2xhc3M6Ik1hdGhKYXhfUHJldmlldyIsc2hvd1Byb2Nlc3NpbmdNZXNzYWdlczp0cnVlLG1lc3NhZ2VTdHlsZToibm9ybWFsIixkZWxheVN0YXJ0dXBVbnRpbDoibm9uZSIsc2tpcFN0YXJ0dXBUeXBlc2V0OmZhbHNlLGVsZW1lbnRzOltdLHBvc2l0aW9uVG9IYXNoOnRydWUsc2hvd01hdGhNZW51OnRydWUsc2hvd01hdGhNZW51TVNJRTp0cnVlLG1lbnVTZXR0aW5nczp7em9vbToiTm9uZSIsQ1RSTDpmYWxzZSxBTFQ6ZmFsc2UsQ01EOmZhbHNlLFNoaWZ0OmZhbHNlLGRpc2NvdmVyYWJsZTpmYWxzZSx6c2NhbGU6IjIwMCUiLHJlbmRlcmVyOm51bGwsZm9udDoiQXV0byIsY29udGV4dDoiTWF0aEpheCIsbG9jYWxlOm51bGwsbXBDb250ZXh0OmZhbHNlLG1wTW91c2U6ZmFsc2UsdGV4SGludHM6dHJ1ZSxGYXN0UHJldmlldzpudWxsLGFzc2lzdGl2ZU1NTDpudWxsLGluVGFiT3JkZXI6dHJ1ZSxzZW1hbnRpY3M6ZmFsc2V9LGVycm9yU2V0dGluZ3M6e21lc3NhZ2U6WyJbIixbIk1hdGhQcm9jZXNzaW5nRXJyb3IiLCJNYXRoIFByb2Nlc3NpbmcgRXJyb3IiXSwiXSJdLHN0eWxlOntjb2xvcjoiI0NDMDAwMCIsImZvbnQtc3R5bGUiOiJpdGFsaWMifX0saWdub3JlTU1MYXR0cmlidXRlczp7fX0scHJlUHJvY2Vzc29yczpNYXRoSmF4LkNhbGxiYWNrLkhvb2tzKHRydWUpLGlucHV0SmF4Ont9LG91dHB1dEpheDp7b3JkZXI6e319LHByb2Nlc3NTZWN0aW9uRGVsYXk6NTAscHJvY2Vzc1VwZGF0ZVRpbWU6MjUwLHByb2Nlc3NVcGRhdGVEZWxheToxMCxzaWduYWw6TWF0aEpheC5DYWxsYmFjay5TaWduYWwoIkh1YiIpLENvbmZpZzpmdW5jdGlvbihhKXt0aGlzLkluc2VydCh0aGlzLmNvbmZpZyxhKTtpZih0aGlzLmNvbmZpZy5BdWdtZW50KXt0aGlzLkF1Z21lbnQodGhpcy5jb25maWcuQXVnbWVudCl9fSxDb21iaW5lQ29uZmlnOmZ1bmN0aW9uKGMsZil7dmFyIGI9dGhpcy5jb25maWcsZyxlO2M9Yy5zcGxpdCgvXC4vKTtmb3IodmFyIGQ9MCxhPWMubGVuZ3RoO2Q8YTtkKyspe2c9Y1tkXTtpZighYltnXSl7YltnXT17fX1lPWI7Yj1iW2ddfWVbZ109Yj10aGlzLkluc2VydChmLGIpO3JldHVybiBifSxSZWdpc3Rlcjp7UHJlUHJvY2Vzc29yOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGhKYXguSHViLnByZVByb2Nlc3NvcnMuQWRkLmFwcGx5KE1hdGhKYXguSHViLnByZVByb2Nlc3NvcnMsYXJndW1lbnRzKX0sTWVzc2FnZUhvb2s6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aEpheC5IdWIuc2lnbmFsLk1lc3NhZ2VIb29rLmFwcGx5KE1hdGhKYXguSHViLnNpZ25hbCxhcmd1bWVudHMpfSxTdGFydHVwSG9vazpmdW5jdGlvbigpe3JldHVybiBNYXRoSmF4Lkh1Yi5TdGFydHVwLnNpZ25hbC5NZXNzYWdlSG9vay5hcHBseShNYXRoSmF4Lkh1Yi5TdGFydHVwLnNpZ25hbCxhcmd1bWVudHMpfSxMb2FkSG9vazpmdW5jdGlvbigpe3JldHVybiBNYXRoSmF4LkFqYXguTG9hZEhvb2suYXBwbHkoTWF0aEpheC5BamF4LGFyZ3VtZW50cyl9fSxVblJlZ2lzdGVyOntQcmVQcm9jZXNzb3I6ZnVuY3Rpb24oYSl7TWF0aEpheC5IdWIucHJlUHJvY2Vzc29ycy5SZW1vdmUoYSl9LE1lc3NhZ2VIb29rOmZ1bmN0aW9uKGEpe01hdGhKYXguSHViLnNpZ25hbC5SZW1vdmVIb29rKGEpfSxTdGFydHVwSG9vazpmdW5jdGlvbihhKXtNYXRoSmF4Lkh1Yi5TdGFydHVwLnNpZ25hbC5SZW1vdmVIb29rKGEpfSxMb2FkSG9vazpmdW5jdGlvbihhKXtNYXRoSmF4LkFqYXgucmVtb3ZlSG9vayhhKX19LGdldEFsbEpheDpmdW5jdGlvbihlKXt2YXIgYz1bXSxiPXRoaXMuZWxlbWVudFNjcmlwdHMoZSk7Zm9yKHZhciBkPTAsYT1iLmxlbmd0aDtkPGE7ZCsrKXtpZihiW2RdLk1hdGhKYXgmJmJbZF0uTWF0aEpheC5lbGVtZW50SmF4KXtjLnB1c2goYltkXS5NYXRoSmF4LmVsZW1lbnRKYXgpfX1yZXR1cm4gY30sZ2V0SmF4QnlUeXBlOmZ1bmN0aW9uKGYsZSl7dmFyIGM9W10sYj10aGlzLmVsZW1lbnRTY3JpcHRzKGUpO2Zvcih2YXIgZD0wLGE9Yi5sZW5ndGg7ZDxhO2QrKyl7aWYoYltkXS5NYXRoSmF4JiZiW2RdLk1hdGhKYXguZWxlbWVudEpheCYmYltkXS5NYXRoSmF4LmVsZW1lbnRKYXgubWltZVR5cGU9PT1mKXtjLnB1c2goYltkXS5NYXRoSmF4LmVsZW1lbnRKYXgpfX1yZXR1cm4gY30sZ2V0SmF4QnlJbnB1dFR5cGU6ZnVuY3Rpb24oZixlKXt2YXIgYz1bXSxiPXRoaXMuZWxlbWVudFNjcmlwdHMoZSk7Zm9yKHZhciBkPTAsYT1iLmxlbmd0aDtkPGE7ZCsrKXtpZihiW2RdLk1hdGhKYXgmJmJbZF0uTWF0aEpheC5lbGVtZW50SmF4JiZiW2RdLnR5cGUmJmJbZF0udHlwZS5yZXBsYWNlKC8gKjsoLnxccykqLywiIik9PT1mKXtjLnB1c2goYltkXS5NYXRoSmF4LmVsZW1lbnRKYXgpfX1yZXR1cm4gY30sZ2V0SmF4Rm9yOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZihhKT09PSJzdHJpbmciKXthPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpfWlmKGEmJmEuTWF0aEpheCl7cmV0dXJuIGEuTWF0aEpheC5lbGVtZW50SmF4fWlmKHRoaXMuaXNNYXRoSmF4Tm9kZShhKSl7aWYoIWEuaXNNYXRoSmF4KXthPWEuZmlyc3RDaGlsZH13aGlsZShhJiYhYS5qYXhJRCl7YT1hLnBhcmVudE5vZGV9aWYoYSl7cmV0dXJuIE1hdGhKYXguT3V0cHV0SmF4W2EuamF4SURdLmdldEpheEZyb21NYXRoKGEpfX1yZXR1cm4gbnVsbH0saXNKYXg6ZnVuY3Rpb24oYSl7aWYodHlwZW9mKGEpPT09InN0cmluZyIpe2E9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSl9aWYodGhpcy5pc01hdGhKYXhOb2RlKGEpKXtyZXR1cm4gMX1pZihhJiYoYS50YWdOYW1lfHwiIikudG9Mb3dlckNhc2UoKT09PSJzY3JpcHQiKXtpZihhLk1hdGhKYXgpe3JldHVybihhLk1hdGhKYXguc3RhdGU9PT1NYXRoSmF4LkVsZW1lbnRKYXguU1RBVEUuUFJPQ0VTU0VEPzE6LTEpfWlmKGEudHlwZSYmdGhpcy5pbnB1dEpheFthLnR5cGUucmVwbGFjZSgvICo7KC58XHMpKi8sIiIpXSl7cmV0dXJuIC0xfX1yZXR1cm4gMH0saXNNYXRoSmF4Tm9kZTpmdW5jdGlvbihhKXtyZXR1cm4gISFhJiYoYS5pc01hdGhKYXh8fChhLmNsYXNzTmFtZXx8IiIpPT09Ik1hdGhKYXhfTWF0aE1MIil9LHNldFJlbmRlcmVyOmZ1bmN0aW9uKGQsYyl7aWYoIWQpe3JldHVybn1pZighTWF0aEpheC5PdXRwdXRKYXhbZF0pe3RoaXMuY29uZmlnLm1lbnVTZXR0aW5ncy5yZW5kZXJlcj0iIjt2YXIgYj0iW01hdGhKYXhdL2pheC9vdXRwdXQvIitkKyIvY29uZmlnLmpzIjtyZXR1cm4gTWF0aEpheC5BamF4LlJlcXVpcmUoYixbInNldFJlbmRlcmVyIix0aGlzLGQsY10pfWVsc2V7dGhpcy5jb25maWcubWVudVNldHRpbmdzLnJlbmRlcmVyPWQ7aWYoYz09bnVsbCl7Yz0iamF4L21tbCJ9dmFyIGE9dGhpcy5vdXRwdXRKYXg7aWYoYVtjXSYmYVtjXS5sZW5ndGgpe2lmKGQhPT1hW2NdWzBdLmlkKXthW2NdLnVuc2hpZnQoTWF0aEpheC5PdXRwdXRKYXhbZF0pO3JldHVybiB0aGlzLnNpZ25hbC5Qb3N0KFsiUmVuZGVyZXIgU2VsZWN0ZWQiLGRdKX19cmV0dXJuIG51bGx9fSxRdWV1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnF1ZXVlLlB1c2guYXBwbHkodGhpcy5xdWV1ZSxhcmd1bWVudHMpfSxUeXBlc2V0OmZ1bmN0aW9uKGMsZCl7aWYoIU1hdGhKYXguaXNSZWFkeSl7cmV0dXJuIG51bGx9dmFyIGI9dGhpcy5lbGVtZW50Q2FsbGJhY2soYyxkKTtpZihiLmNvdW50KXt2YXIgYT1NYXRoSmF4LkNhbGxiYWNrLlF1ZXVlKFsiUHJlUHJvY2VzcyIsdGhpcyxiLmVsZW1lbnRzXSxbIlByb2Nlc3MiLHRoaXMsYi5lbGVtZW50c10pfXJldHVybiBhLlB1c2goYi5jYWxsYmFjayl9LFByZVByb2Nlc3M6ZnVuY3Rpb24oZSxnKXt2YXIgYz10aGlzLmVsZW1lbnRDYWxsYmFjayhlLGcpO3ZhciBiPU1hdGhKYXguQ2FsbGJhY2suUXVldWUoKTtpZihjLmNvdW50KXt2YXIgZj0oYy5jb3VudD09PTE/W2MuZWxlbWVudHNdOmMuZWxlbWVudHMpO2IuUHVzaChbIlBvc3QiLHRoaXMuc2lnbmFsLFsiQmVnaW4gUHJlUHJvY2VzcyIsYy5lbGVtZW50c11dKTtmb3IodmFyIGQ9MCxhPWYubGVuZ3RoO2Q8YTtkKyspe2lmKGZbZF0pe2IuUHVzaChbIkV4ZWN1dGUiLHRoaXMucHJlUHJvY2Vzc29ycyxmW2RdXSl9fWIuUHVzaChbIlBvc3QiLHRoaXMuc2lnbmFsLFsiRW5kIFByZVByb2Nlc3MiLGMuZWxlbWVudHNdXSl9cmV0dXJuIGIuUHVzaChjLmNhbGxiYWNrKX0sUHJvY2VzczpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRha2VBY3Rpb24oIlByb2Nlc3MiLGEsYil9LFVwZGF0ZTpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRha2VBY3Rpb24oIlVwZGF0ZSIsYSxiKX0sUmVwcm9jZXNzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMudGFrZUFjdGlvbigiUmVwcm9jZXNzIixhLGIpfSxSZXJlbmRlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRha2VBY3Rpb24oIlJlcmVuZGVyIixhLGIpfSx0YWtlQWN0aW9uOmZ1bmN0aW9uKGcsZCxoKXt2YXIgYz10aGlzLmVsZW1lbnRDYWxsYmFjayhkLGgpO3ZhciBmPWMuZWxlbWVudHM7dmFyIGE9TWF0aEpheC5DYWxsYmFjay5RdWV1ZShbIkNsZWFyIix0aGlzLnNpZ25hbF0pO3ZhciBlPXtzY3JpcHRzOltdLHN0YXJ0Om5ldyBEYXRlKCkuZ2V0VGltZSgpLGk6MCxqOjAsamF4Ont9LGpheElEczpbXX07aWYoYy5jb3VudCl7dmFyIGI9WyJEZWxheSIsTWF0aEpheC5DYWxsYmFjayx0aGlzLnByb2Nlc3NTZWN0aW9uRGVsYXldO2lmKCFiWzJdKXtiPXt9fWEuUHVzaChbImNsZWFyQ291bnRzIixNYXRoSmF4Lk1lc3NhZ2VdLFsiUG9zdCIsdGhpcy5zaWduYWwsWyJCZWdpbiAiK2csZl1dLFsiUG9zdCIsdGhpcy5zaWduYWwsWyJCZWdpbiBNYXRoIixmLGddXSxbInByZXBhcmVTY3JpcHRzIix0aGlzLGcsZixlXSxbIlBvc3QiLHRoaXMuc2lnbmFsLFsiQmVnaW4gTWF0aCBJbnB1dCIsZixnXV0sWyJwcm9jZXNzSW5wdXQiLHRoaXMsZV0sWyJQb3N0Iix0aGlzLnNpZ25hbCxbIkVuZCBNYXRoIElucHV0IixmLGddXSxiLFsicHJlcGFyZU91dHB1dCIsdGhpcyxlLCJwcmVQcm9jZXNzIl0sYixbIlBvc3QiLHRoaXMuc2lnbmFsLFsiQmVnaW4gTWF0aCBPdXRwdXQiLGYsZ11dLFsicHJvY2Vzc091dHB1dCIsdGhpcyxlXSxbIlBvc3QiLHRoaXMuc2lnbmFsLFsiRW5kIE1hdGggT3V0cHV0IixmLGddXSxiLFsicHJlcGFyZU91dHB1dCIsdGhpcyxlLCJwb3N0UHJvY2VzcyJdLGIsWyJQb3N0Iix0aGlzLnNpZ25hbCxbIkVuZCBNYXRoIixmLGddXSxbIlBvc3QiLHRoaXMuc2lnbmFsLFsiRW5kICIrZyxmXV0sWyJjbGVhckNvdW50cyIsTWF0aEpheC5NZXNzYWdlXSl9cmV0dXJuIGEuUHVzaChjLmNhbGxiYWNrKX0sc2NyaXB0QWN0aW9uOntQcm9jZXNzOmZ1bmN0aW9uKGEpe30sVXBkYXRlOmZ1bmN0aW9uKGIpe3ZhciBhPWIuTWF0aEpheC5lbGVtZW50SmF4O2lmKGEmJmEubmVlZHNVcGRhdGUoKSl7YS5SZW1vdmUodHJ1ZSk7Yi5NYXRoSmF4LnN0YXRlPWEuU1RBVEUuVVBEQVRFfWVsc2V7Yi5NYXRoSmF4LnN0YXRlPWEuU1RBVEUuUFJPQ0VTU0VEfX0sUmVwcm9jZXNzOmZ1bmN0aW9uKGIpe3ZhciBhPWIuTWF0aEpheC5lbGVtZW50SmF4O2lmKGEpe2EuUmVtb3ZlKHRydWUpO2IuTWF0aEpheC5zdGF0ZT1hLlNUQVRFLlVQREFURX19LFJlcmVuZGVyOmZ1bmN0aW9uKGIpe3ZhciBhPWIuTWF0aEpheC5lbGVtZW50SmF4O2lmKGEpe2EuUmVtb3ZlKHRydWUpO2IuTWF0aEpheC5zdGF0ZT1hLlNUQVRFLk9VVFBVVH19fSxwcmVwYXJlU2NyaXB0czpmdW5jdGlvbihoLGUsZyl7aWYoYXJndW1lbnRzLmNhbGxlZS5kaXNhYmxlZCl7cmV0dXJufXZhciBiPXRoaXMuZWxlbWVudFNjcmlwdHMoZSk7dmFyIGY9TWF0aEpheC5FbGVtZW50SmF4LlNUQVRFO2Zvcih2YXIgZD0wLGE9Yi5sZW5ndGg7ZDxhO2QrKyl7dmFyIGM9YltkXTtpZihjLnR5cGUmJnRoaXMuaW5wdXRKYXhbYy50eXBlLnJlcGxhY2UoLyAqOygufFxuKSovLCIiKV0pe2lmKGMuTWF0aEpheCl7aWYoYy5NYXRoSmF4LmVsZW1lbnRKYXgmJmMuTWF0aEpheC5lbGVtZW50SmF4LmhvdmVyKXtNYXRoSmF4LkV4dGVuc2lvbi5NYXRoRXZlbnRzLkhvdmVyLkNsZWFySG92ZXIoYy5NYXRoSmF4LmVsZW1lbnRKYXgpfWlmKGMuTWF0aEpheC5zdGF0ZSE9PWYuUEVORElORyl7dGhpcy5zY3JpcHRBY3Rpb25baF0oYyl9fWlmKCFjLk1hdGhKYXgpe2MuTWF0aEpheD17c3RhdGU6Zi5QRU5ESU5HfX1pZihjLk1hdGhKYXguZXJyb3Ipe2RlbGV0ZSBjLk1hdGhKYXguZXJyb3J9aWYoYy5NYXRoSmF4LnN0YXRlIT09Zi5QUk9DRVNTRUQpe2cuc2NyaXB0cy5wdXNoKGMpfX19fSxjaGVja1NjcmlwdFNpYmxpbmdzOmZ1bmN0aW9uKGEpe2lmKGEuTWF0aEpheC5jaGVja2VkKXtyZXR1cm59dmFyIGI9dGhpcy5jb25maWcsZj1hLnByZXZpb3VzU2libGluZztpZihmJiZmLm5vZGVOYW1lPT09IiN0ZXh0Iil7dmFyIGQsZSxjPWEubmV4dFNpYmxpbmc7aWYoYyYmYy5ub2RlTmFtZSE9PSIjdGV4dCIpe2M9bnVsbH1pZihiLnByZUpheCl7aWYodHlwZW9mKGIucHJlSmF4KT09PSJzdHJpbmciKXtiLnByZUpheD1uZXcgUmVnRXhwKGIucHJlSmF4KyIkIil9ZD1mLm5vZGVWYWx1ZS5tYXRjaChiLnByZUpheCl9aWYoYi5wb3N0SmF4JiZjKXtpZih0eXBlb2YoYi5wb3N0SmF4KT09PSJzdHJpbmciKXtiLnBvc3RKYXg9bmV3IFJlZ0V4cCgiXiIrYi5wb3N0SmF4KX1lPWMubm9kZVZhbHVlLm1hdGNoKGIucG9zdEpheCl9aWYoZCYmKCFiLnBvc3RKYXh8fGUpKXtmLm5vZGVWYWx1ZT1mLm5vZGVWYWx1ZS5yZXBsYWNlKGIucHJlSmF4LChkLmxlbmd0aD4xP2RbMV06IiIpKTtmPW51bGx9aWYoZSYmKCFiLnByZUpheHx8ZCkpe2Mubm9kZVZhbHVlPWMubm9kZVZhbHVlLnJlcGxhY2UoYi5wb3N0SmF4LChlLmxlbmd0aD4xP2VbMV06IiIpKX1pZihmJiYhZi5ub2RlVmFsdWUubWF0Y2goL1xTLykpe2Y9Zi5wcmV2aW91c1NpYmxpbmd9fWlmKGIucHJlUmVtb3ZlQ2xhc3MmJmYmJmYuY2xhc3NOYW1lPT09Yi5wcmVSZW1vdmVDbGFzcyl7YS5NYXRoSmF4LnByZXZpZXc9Zn1hLk1hdGhKYXguY2hlY2tlZD0xfSxwcm9jZXNzSW5wdXQ6ZnVuY3Rpb24oYSl7dmFyIGIsaT1NYXRoSmF4LkVsZW1lbnRKYXguU1RBVEU7dmFyIGgsZSxkPWEuc2NyaXB0cy5sZW5ndGg7dHJ5e3doaWxlKGEuaTxkKXtoPWEuc2NyaXB0c1thLmldO2lmKCFoKXthLmkrKztjb250aW51ZX1lPWgucHJldmlvdXNTaWJsaW5nO2lmKGUmJmUuY2xhc3NOYW1lPT09Ik1hdGhKYXhfRXJyb3IiKXtlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSl9aWYoIWgucGFyZW50Tm9kZXx8IWguTWF0aEpheHx8aC5NYXRoSmF4LnN0YXRlPT09aS5QUk9DRVNTRUQpe2EuaSsrO2NvbnRpbnVlfWlmKCFoLk1hdGhKYXguZWxlbWVudEpheHx8aC5NYXRoSmF4LnN0YXRlPT09aS5VUERBVEUpe3RoaXMuY2hlY2tTY3JpcHRTaWJsaW5ncyhoKTt2YXIgZz1oLnR5cGUucmVwbGFjZSgvICo7KC58XHMpKi8sIiIpO3ZhciBqPXRoaXMuaW5wdXRKYXhbZ107Yj1qLlByb2Nlc3MoaCxhKTtpZih0eXBlb2YgYj09PSJmdW5jdGlvbiIpe2lmKGIuY2FsbGVkKXtjb250aW51ZX10aGlzLlJlc3RhcnRBZnRlcihiKX1iPWIuQXR0YWNoKGgsai5pZCk7dGhpcy5zYXZlU2NyaXB0KGIsYSxoLGkpO3RoaXMucG9zdElucHV0SG9va3MuRXhlY3V0ZShiLGouaWQsaCl9ZWxzZXtpZihoLk1hdGhKYXguc3RhdGU9PT1pLk9VVFBVVCl7dGhpcy5zYXZlU2NyaXB0KGguTWF0aEpheC5lbGVtZW50SmF4LGEsaCxpKX19YS5pKys7dmFyIGM9bmV3IERhdGUoKS5nZXRUaW1lKCk7aWYoYy1hLnN0YXJ0PnRoaXMucHJvY2Vzc1VwZGF0ZVRpbWUmJmEuaTxhLnNjcmlwdHMubGVuZ3RoKXthLnN0YXJ0PWM7dGhpcy5SZXN0YXJ0QWZ0ZXIoTWF0aEpheC5DYWxsYmFjay5EZWxheSgxKSl9fX1jYXRjaChmKXtyZXR1cm4gdGhpcy5wcm9jZXNzRXJyb3IoZixhLCJJbnB1dCIpfWlmKGEuc2NyaXB0cy5sZW5ndGgmJnRoaXMuY29uZmlnLnNob3dQcm9jZXNzaW5nTWVzc2FnZXMpe01hdGhKYXguTWVzc2FnZS5TZXQoWyJQcm9jZXNzTWF0aCIsIlByb2Nlc3NpbmcgbWF0aDogJTElJSIsMTAwXSwwKX1hLnN0YXJ0PW5ldyBEYXRlKCkuZ2V0VGltZSgpO2EuaT1hLmo9MDtyZXR1cm4gbnVsbH0scG9zdElucHV0SG9va3M6TWF0aEpheC5DYWxsYmFjay5Ib29rcyh0cnVlKSxzYXZlU2NyaXB0OmZ1bmN0aW9uKGEsZCxiLGMpe2lmKCF0aGlzLm91dHB1dEpheFthLm1pbWVUeXBlXSl7Yi5NYXRoSmF4LnN0YXRlPWMuVVBEQVRFO3Rocm93IEVycm9yKCJObyBvdXRwdXQgamF4IHJlZ2lzdGVyZWQgZm9yICIrYS5taW1lVHlwZSl9YS5vdXRwdXRKYXg9dGhpcy5vdXRwdXRKYXhbYS5taW1lVHlwZV1bMF0uaWQ7aWYoIWQuamF4W2Eub3V0cHV0SmF4XSl7aWYoZC5qYXhJRHMubGVuZ3RoPT09MCl7ZC5qYXhbYS5vdXRwdXRKYXhdPWQuc2NyaXB0c31lbHNle2lmKGQuamF4SURzLmxlbmd0aD09PTEpe2QuamF4W2QuamF4SURzWzBdXT1kLnNjcmlwdHMuc2xpY2UoMCxkLmkpfWQuamF4W2Eub3V0cHV0SmF4XT1bXX1kLmpheElEcy5wdXNoKGEub3V0cHV0SmF4KX1pZihkLmpheElEcy5sZW5ndGg+MSl7ZC5qYXhbYS5vdXRwdXRKYXhdLnB1c2goYil9Yi5NYXRoSmF4LnN0YXRlPWMuT1VUUFVUfSxwcmVwYXJlT3V0cHV0OmZ1bmN0aW9uKGMsZil7d2hpbGUoYy5qPGMuamF4SURzLmxlbmd0aCl7dmFyIGU9Yy5qYXhJRHNbYy5qXSxkPU1hdGhKYXguT3V0cHV0SmF4W2VdO2lmKGRbZl0pe3RyeXt2YXIgYT1kW2ZdKGMpO2lmKHR5cGVvZiBhPT09ImZ1bmN0aW9uIil7aWYoYS5jYWxsZWQpe2NvbnRpbnVlfXRoaXMuUmVzdGFydEFmdGVyKGEpfX1jYXRjaChiKXtpZighYi5yZXN0YXJ0KXtNYXRoSmF4Lk1lc3NhZ2UuU2V0KFsiUHJlcEVycm9yIiwiRXJyb3IgcHJlcGFyaW5nICUxIG91dHB1dCAoJTIpIixlLGZdLG51bGwsNjAwKTtNYXRoSmF4Lkh1Yi5sYXN0UHJlcEVycm9yPWI7Yy5qKyt9cmV0dXJuIE1hdGhKYXguQ2FsbGJhY2suQWZ0ZXIoWyJwcmVwYXJlT3V0cHV0Iix0aGlzLGMsZl0sYi5yZXN0YXJ0KX19Yy5qKyt9cmV0dXJuIG51bGx9LHByb2Nlc3NPdXRwdXQ6ZnVuY3Rpb24oaCl7dmFyIGIsZz1NYXRoSmF4LkVsZW1lbnRKYXguU1RBVEUsZCxhPWguc2NyaXB0cy5sZW5ndGg7dHJ5e3doaWxlKGguaTxhKXtkPWguc2NyaXB0c1toLmldO2lmKCFkfHwhZC5wYXJlbnROb2RlfHwhZC5NYXRoSmF4fHxkLk1hdGhKYXguZXJyb3Ipe2guaSsrO2NvbnRpbnVlfXZhciBjPWQuTWF0aEpheC5lbGVtZW50SmF4O2lmKCFjKXtoLmkrKztjb250aW51ZX1iPU1hdGhKYXguT3V0cHV0SmF4W2Mub3V0cHV0SmF4XS5Qcm9jZXNzKGQsaCk7aWYoYiE9PWZhbHNlKXtkLk1hdGhKYXguc3RhdGU9Zy5QUk9DRVNTRUQ7aWYoZC5NYXRoSmF4LnByZXZpZXcpe2QuTWF0aEpheC5wcmV2aWV3LmlubmVySFRNTD0iIjtkLk1hdGhKYXgucHJldmlldy5zdHlsZS5kaXNwbGF5PSJub25lIn10aGlzLnNpZ25hbC5Qb3N0KFsiTmV3IE1hdGgiLGMuaW5wdXRJRF0pfWguaSsrO3ZhciBlPW5ldyBEYXRlKCkuZ2V0VGltZSgpO2lmKGUtaC5zdGFydD50aGlzLnByb2Nlc3NVcGRhdGVUaW1lJiZoLmk8aC5zY3JpcHRzLmxlbmd0aCl7aC5zdGFydD1lO3RoaXMuUmVzdGFydEFmdGVyKE1hdGhKYXguQ2FsbGJhY2suRGVsYXkodGhpcy5wcm9jZXNzVXBkYXRlRGVsYXkpKX19fWNhdGNoKGYpe3JldHVybiB0aGlzLnByb2Nlc3NFcnJvcihmLGgsIk91dHB1dCIpfWlmKGguc2NyaXB0cy5sZW5ndGgmJnRoaXMuY29uZmlnLnNob3dQcm9jZXNzaW5nTWVzc2FnZXMpe01hdGhKYXguTWVzc2FnZS5TZXQoWyJUeXBlc2V0TWF0aCIsIlR5cGVzZXR0aW5nIG1hdGg6ICUxJSUiLDEwMF0sMCk7TWF0aEpheC5NZXNzYWdlLkNsZWFyKDApfWguaT1oLmo9MDtyZXR1cm4gbnVsbH0scHJvY2Vzc01lc3NhZ2U6ZnVuY3Rpb24oZCxiKXt2YXIgYT1NYXRoLmZsb29yKGQuaS8oZC5zY3JpcHRzLmxlbmd0aCkqMTAwKTt2YXIgYz0oYj09PSJPdXRwdXQiP1siVHlwZXNldE1hdGgiLCJUeXBlc2V0dGluZyBtYXRoOiAlMSUlIl06WyJQcm9jZXNzTWF0aCIsIlByb2Nlc3NpbmcgbWF0aDogJTElJSJdKTtpZih0aGlzLmNvbmZpZy5zaG93UHJvY2Vzc2luZ01lc3NhZ2VzKXtNYXRoSmF4Lk1lc3NhZ2UuU2V0KGMuY29uY2F0KGEpLDApfX0scHJvY2Vzc0Vycm9yOmZ1bmN0aW9uKGIsYyxhKXtpZighYi5yZXN0YXJ0KXtpZighdGhpcy5jb25maWcuZXJyb3JTZXR0aW5ncy5tZXNzYWdlKXt0aHJvdyBifXRoaXMuZm9ybWF0RXJyb3IoYy5zY3JpcHRzW2MuaV0sYik7Yy5pKyt9dGhpcy5wcm9jZXNzTWVzc2FnZShjLGEpO3JldHVybiBNYXRoSmF4LkNhbGxiYWNrLkFmdGVyKFsicHJvY2VzcyIrYSx0aGlzLGNdLGIucmVzdGFydCl9LGZvcm1hdEVycm9yOmZ1bmN0aW9uKGIsZil7dmFyIGg9ZnVuY3Rpb24obCxrLGosaSl7cmV0dXJuIE1hdGhKYXguTG9jYWxpemF0aW9uLl8obCxrLGosaSl9O3ZhciBlPWgoIkVycm9yTWVzc2FnZSIsIkVycm9yOiAlMSIsZi5tZXNzYWdlKSsiXG4iO2lmKGYuc291cmNlVVJMfHxmLmZpbGVOYW1lKXtlKz0iXG4iK2goIkVycm9yRmlsZSIsImZpbGU6ICUxIixmLnNvdXJjZVVSTHx8Zi5maWxlTmFtZSl9aWYoZi5saW5lfHxmLmxpbmVOdW1iZXIpe2UrPSJcbiIraCgiRXJyb3JMaW5lIiwibGluZTogJTEiLGYubGluZXx8Zi5saW5lTnVtYmVyKX1lKz0iXG5cbiIraCgiRXJyb3JUaXBzIiwiRGVidWdnaW5nIHRpcHM6IHVzZSAlMSwgaW5zcGVjdCAlMiBpbiB0aGUgYnJvd3NlciBjb25zb2xlIiwiJ3VucGFja2VkL01hdGhKYXguanMnIiwiJ01hdGhKYXguSHViLmxhc3RFcnJvciciKTtiLk1hdGhKYXguZXJyb3I9TWF0aEpheC5PdXRwdXRKYXguRXJyb3IuSmF4KGUsYik7aWYoYi5NYXRoSmF4LmVsZW1lbnRKYXgpe2IuTWF0aEpheC5lcnJvci5pbnB1dElEPWIuTWF0aEpheC5lbGVtZW50SmF4LmlucHV0SUR9dmFyIGc9dGhpcy5jb25maWcuZXJyb3JTZXR0aW5nczt2YXIgYT1oKGcubWVzc2FnZUlkLGcubWVzc2FnZSk7dmFyIGM9TWF0aEpheC5IVE1MLkVsZW1lbnQoInNwYW4iLHtjbGFzc05hbWU6Ik1hdGhKYXhfRXJyb3IiLGpheElEOiJFcnJvciIsaXNNYXRoSmF4OnRydWUsaWQ6Yi5NYXRoSmF4LmVycm9yLmlucHV0SUQrIi1GcmFtZSJ9LFtbInNwYW4iLG51bGwsYV1dKTtNYXRoSmF4LkFqYXguUmVxdWlyZSgiW01hdGhKYXhdL2V4dGVuc2lvbnMvTWF0aEV2ZW50cy5qcyIsZnVuY3Rpb24oKXt2YXIgaj1NYXRoSmF4LkV4dGVuc2lvbi5NYXRoRXZlbnRzLkV2ZW50LGk9TWF0aEpheC5IdWI7Yy5vbmNvbnRleHRtZW51PWouTWVudTtjLm9ubW91c2Vkb3duPWouTW91c2Vkb3duO2Mub25rZXlkb3duPWouS2V5ZG93bjtjLnRhYkluZGV4PWkuZ2V0VGFiT3JkZXIoaS5nZXRKYXhGb3IoYikpfSk7dmFyIGQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYy5pZCk7aWYoZCl7ZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGQpfWlmKGIucGFyZW50Tm9kZSl7Yi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjLGIpfWlmKGIuTWF0aEpheC5wcmV2aWV3KXtiLk1hdGhKYXgucHJldmlldy5pbm5lckhUTUw9IiI7Yi5NYXRoSmF4LnByZXZpZXcuc3R5bGUuZGlzcGxheT0ibm9uZSJ9dGhpcy5sYXN0RXJyb3I9Zjt0aGlzLnNpZ25hbC5Qb3N0KFsiTWF0aCBQcm9jZXNzaW5nIEVycm9yIixiLGZdKX0sUmVzdGFydEFmdGVyOmZ1bmN0aW9uKGEpe3Rocm93IHRoaXMuSW5zZXJ0KEVycm9yKCJyZXN0YXJ0Iikse3Jlc3RhcnQ6TWF0aEpheC5DYWxsYmFjayhhKX0pfSxlbGVtZW50Q2FsbGJhY2s6ZnVuY3Rpb24oYyxmKXtpZihmPT1udWxsJiYoTWF0aEpheC5PYmplY3QuaXNBcnJheShjKXx8dHlwZW9mIGM9PT0iZnVuY3Rpb24iKSl7dHJ5e01hdGhKYXguQ2FsbGJhY2soYyk7Zj1jO2M9bnVsbH1jYXRjaChkKXt9fWlmKGM9PW51bGwpe2M9dGhpcy5jb25maWcuZWxlbWVudHN8fFtdfWlmKHRoaXMuaXNIVE1MQ29sbGVjdGlvbihjKSl7Yz10aGlzLkhUTUxDb2xsZWN0aW9uMkFycmF5KGMpfWlmKCFNYXRoSmF4Lk9iamVjdC5pc0FycmF5KGMpKXtjPVtjXX1jPVtdLmNvbmNhdChjKTtmb3IodmFyIGI9MCxhPWMubGVuZ3RoO2I8YTtiKyspe2lmKHR5cGVvZihjW2JdKT09PSJzdHJpbmciKXtjW2JdPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNbYl0pfX1pZighZG9jdW1lbnQuYm9keSl7ZG9jdW1lbnQuYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdfWlmKGMubGVuZ3RoPT0wKXtjLnB1c2goZG9jdW1lbnQuYm9keSl9aWYoIWYpe2Y9e319cmV0dXJue2NvdW50OmMubGVuZ3RoLGVsZW1lbnRzOihjLmxlbmd0aD09PTE/Y1swXTpjKSxjYWxsYmFjazpmfX0sZWxlbWVudFNjcmlwdHM6ZnVuY3Rpb24oZSl7dmFyIGI9W107aWYoTWF0aEpheC5PYmplY3QuaXNBcnJheShlKXx8dGhpcy5pc0hUTUxDb2xsZWN0aW9uKGUpKXtmb3IodmFyIGQ9MCxhPWUubGVuZ3RoO2Q8YTtkKyspe3ZhciBmPTA7Zm9yKHZhciBjPTA7YzxkJiYhZjtjKyspe2Y9ZVtjXS5jb250YWlucyhlW2RdKX1pZighZil7Yi5wdXNoLmFwcGx5KGIsdGhpcy5lbGVtZW50U2NyaXB0cyhlW2RdKSl9fXJldHVybiBifWlmKHR5cGVvZihlKT09PSJzdHJpbmciKXtlPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpfWlmKCFkb2N1bWVudC5ib2R5KXtkb2N1bWVudC5ib2R5PWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF19aWYoZT09bnVsbCl7ZT1kb2N1bWVudC5ib2R5fWlmKGUudGFnTmFtZSE9bnVsbCYmZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PT0ic2NyaXB0Iil7cmV0dXJuW2VdfWI9ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0Iik7aWYodGhpcy5tc2llSFRNTENvbGxlY3Rpb25CdWcpe2I9dGhpcy5IVE1MQ29sbGVjdGlvbjJBcnJheShiKX1yZXR1cm4gYn0saXNIVE1MQ29sbGVjdGlvbjpmdW5jdGlvbihhKXtyZXR1cm4oIkhUTUxDb2xsZWN0aW9uIiBpbiB3aW5kb3cmJnR5cGVvZihhKT09PSJvYmplY3QiJiZhIGluc3RhbmNlb2YgSFRNTENvbGxlY3Rpb24pfSxIVE1MQ29sbGVjdGlvbjJBcnJheTpmdW5jdGlvbihjKXtpZighdGhpcy5tc2llSFRNTENvbGxlY3Rpb25CdWcpe3JldHVybltdLnNsaWNlLmNhbGwoYyl9dmFyIGI9W107Zm9yKHZhciBkPTAsYT1jLmxlbmd0aDtkPGE7ZCsrKXtiW2RdPWNbZF19cmV0dXJuIGJ9LEluc2VydDpmdW5jdGlvbihjLGEpe2Zvcih2YXIgYiBpbiBhKXtpZihhLmhhc093blByb3BlcnR5KGIpKXtpZih0eXBlb2YgYVtiXT09PSJvYmplY3QiJiYhKE1hdGhKYXguT2JqZWN0LmlzQXJyYXkoYVtiXSkpJiYodHlwZW9mIGNbYl09PT0ib2JqZWN0Inx8dHlwZW9mIGNbYl09PT0iZnVuY3Rpb24iKSl7dGhpcy5JbnNlcnQoY1tiXSxhW2JdKX1lbHNle2NbYl09YVtiXX19fXJldHVybiBjfSxnZXRUYWJPcmRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jb25maWcubWVudVNldHRpbmdzLmluVGFiT3JkZXI/MDotMX0sU3BsaXRMaXN0OigidHJpbSIgaW4gU3RyaW5nLnByb3RvdHlwZT9mdW5jdGlvbihhKXtyZXR1cm4gYS50cmltKCkuc3BsaXQoL1xzKy8pfTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9eXHMrLywiIikucmVwbGFjZSgvXHMrJC8sIiIpLnNwbGl0KC9ccysvKX0pfTtNYXRoSmF4Lkh1Yi5JbnNlcnQoTWF0aEpheC5IdWIuY29uZmlnLnN0eWxlcyxNYXRoSmF4Lk1lc3NhZ2Uuc3R5bGVzKTtNYXRoSmF4Lkh1Yi5JbnNlcnQoTWF0aEpheC5IdWIuY29uZmlnLnN0eWxlcyx7Ii5NYXRoSmF4X0Vycm9yIjpNYXRoSmF4Lkh1Yi5jb25maWcuZXJyb3JTZXR0aW5ncy5zdHlsZX0pO01hdGhKYXguRXh0ZW5zaW9uPXt9O01hdGhKYXguSHViLkNvbmZpZ3VyZWQ9TWF0aEpheC5DYWxsYmFjayh7fSk7TWF0aEpheC5IdWIuU3RhcnR1cD17c2NyaXB0OiIiLHF1ZXVlOk1hdGhKYXguQ2FsbGJhY2suUXVldWUoKSxzaWduYWw6TWF0aEpheC5DYWxsYmFjay5TaWduYWwoIlN0YXJ0dXAiKSxwYXJhbXM6e30sQ29uZmlnOmZ1bmN0aW9uKCl7dGhpcy5xdWV1ZS5QdXNoKFsiUG9zdCIsdGhpcy5zaWduYWwsIkJlZ2luIENvbmZpZyJdKTtpZihNYXRoSmF4LkF1dGhvckNvbmZpZyYmTWF0aEpheC5BdXRob3JDb25maWcucm9vdCl7TWF0aEpheC5BamF4LmNvbmZpZy5yb290PU1hdGhKYXguQXV0aG9yQ29uZmlnLnJvb3R9aWYodGhpcy5wYXJhbXMubG9jYWxlKXtNYXRoSmF4LkxvY2FsaXphdGlvbi5yZXNldExvY2FsZSh0aGlzLnBhcmFtcy5sb2NhbGUpO01hdGhKYXguSHViLmNvbmZpZy5tZW51U2V0dGluZ3MubG9jYWxlPXRoaXMucGFyYW1zLmxvY2FsZX1pZih0aGlzLnBhcmFtcy5jb25maWcpe3ZhciBjPXRoaXMucGFyYW1zLmNvbmZpZy5zcGxpdCgvLC8pO2Zvcih2YXIgYj0wLGE9Yy5sZW5ndGg7YjxhO2IrKyl7aWYoIWNbYl0ubWF0Y2goL1wuanMkLykpe2NbYl0rPSIuanMifXRoaXMucXVldWUuUHVzaChbIlJlcXVpcmUiLE1hdGhKYXguQWpheCx0aGlzLlVSTCgiY29uZmlnIixjW2JdKV0pfX10aGlzLnF1ZXVlLlB1c2goWyJDb25maWciLE1hdGhKYXguSHViLE1hdGhKYXguQXV0aG9yQ29uZmlnXSk7aWYodGhpcy5zY3JpcHQubWF0Y2goL1xTLykpe3RoaXMucXVldWUuUHVzaCh0aGlzLnNjcmlwdCsiO1xuMTsiKX10aGlzLnF1ZXVlLlB1c2goWyJDb25maWdEZWxheSIsdGhpc10sWyJDb25maWdCbG9ja3MiLHRoaXNdLFtmdW5jdGlvbihkKXtyZXR1cm4gZC5sb2FkQXJyYXkoTWF0aEpheC5IdWIuY29uZmlnLmNvbmZpZywiY29uZmlnIixudWxsLHRydWUpfSx0aGlzXSxbIlBvc3QiLHRoaXMuc2lnbmFsLCJFbmQgQ29uZmlnIl0pfSxDb25maWdEZWxheTpmdW5jdGlvbigpe3ZhciBhPXRoaXMucGFyYW1zLmRlbGF5U3RhcnR1cFVudGlsfHxNYXRoSmF4Lkh1Yi5jb25maWcuZGVsYXlTdGFydHVwVW50aWw7aWYoYT09PSJvbmxvYWQiKXtyZXR1cm4gdGhpcy5vbmxvYWR9aWYoYT09PSJjb25maWd1cmVkIil7cmV0dXJuIE1hdGhKYXguSHViLkNvbmZpZ3VyZWR9cmV0dXJuIGF9LENvbmZpZ0Jsb2NrczpmdW5jdGlvbigpe3ZhciBjPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKTt2YXIgYj1NYXRoSmF4LkNhbGxiYWNrLlF1ZXVlKCk7Zm9yKHZhciBkPTAsYT1jLmxlbmd0aDtkPGE7ZCsrKXt2YXIgZT1TdHJpbmcoY1tkXS50eXBlKS5yZXBsYWNlKC8gL2csIiIpO2lmKGUubWF0Y2goL150ZXh0XC94LW1hdGhqYXgtY29uZmlnKDsuKik/JC8pJiYhZS5tYXRjaCgvO2V4ZWN1dGVkPXRydWUvKSl7Y1tkXS50eXBlKz0iO2V4ZWN1dGVkPXRydWUiO2IuUHVzaChjW2RdLmlubmVySFRNTCsiO1xuMTsiKX19cmV0dXJuIGIuUHVzaChmdW5jdGlvbigpe01hdGhKYXguQWpheC5jb25maWcucm9vdD1NYXRoSmF4Lkh1Yi5jb25maWcucm9vdH0pfSxDb29raWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWV1ZS5QdXNoKFsiUG9zdCIsdGhpcy5zaWduYWwsIkJlZ2luIENvb2tpZSJdLFsiR2V0IixNYXRoSmF4LkhUTUwuQ29va2llLCJtZW51IixNYXRoSmF4Lkh1Yi5jb25maWcubWVudVNldHRpbmdzXSxbZnVuY3Rpb24oZSl7dmFyIGQ9ZS5tZW51U2V0dGluZ3M7aWYoZC5sb2NhbGUpe01hdGhKYXguTG9jYWxpemF0aW9uLnJlc2V0TG9jYWxlKGQubG9jYWxlKX12YXIgZz1lLm1lbnVTZXR0aW5ncy5yZW5kZXJlcixiPWUuamF4O2lmKGcpe3ZhciBjPSJvdXRwdXQvIitnO2Iuc29ydCgpO2Zvcih2YXIgZj0wLGE9Yi5sZW5ndGg7ZjxhO2YrKyl7aWYoYltmXS5zdWJzdHIoMCw3KT09PSJvdXRwdXQvIil7YnJlYWt9fWlmKGY9PWEtMSl7Yi5wb3AoKX1lbHNle3doaWxlKGY8YSl7aWYoYltmXT09PWMpe2Iuc3BsaWNlKGYsMSk7YnJlYWt9ZisrfX1iLnVuc2hpZnQoYyl9aWYoZC5DSFRNTHByZXZpZXchPW51bGwpe2lmKGQuRmFzdFByZXZpZXc9PW51bGwpe2QuRmFzdFByZXZpZXc9ZC5DSFRNTHByZXZpZXd9ZGVsZXRlIGQuQ0hUTUxwcmV2aWV3fWlmKGQuRmFzdFByZXZpZXcmJiFNYXRoSmF4LkV4dGVuc2lvblsiZmFzdC1wcmV2aWV3Il0pe01hdGhKYXguSHViLmNvbmZpZy5leHRlbnNpb25zLnB1c2goImZhc3QtcHJldmlldy5qcyIpfWlmKGUubWVudVNldHRpbmdzLmFzc2lzdGl2ZU1NTCYmIU1hdGhKYXguRXh0ZW5zaW9uLkFzc2lzdGl2ZU1NTCl7TWF0aEpheC5IdWIuY29uZmlnLmV4dGVuc2lvbnMucHVzaCgiQXNzaXN0aXZlTU1MLmpzIil9fSxNYXRoSmF4Lkh1Yi5jb25maWddLFsiUG9zdCIsdGhpcy5zaWduYWwsIkVuZCBDb29raWUiXSl9LFN0eWxlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLnF1ZXVlLlB1c2goWyJQb3N0Iix0aGlzLnNpZ25hbCwiQmVnaW4gU3R5bGVzIl0sWyJsb2FkQXJyYXkiLHRoaXMsTWF0aEpheC5IdWIuY29uZmlnLnN0eWxlU2hlZXRzLCJjb25maWciXSxbIlN0eWxlcyIsTWF0aEpheC5BamF4LE1hdGhKYXguSHViLmNvbmZpZy5zdHlsZXNdLFsiUG9zdCIsdGhpcy5zaWduYWwsIkVuZCBTdHlsZXMiXSl9LEpheDpmdW5jdGlvbigpe3ZhciBmPU1hdGhKYXguSHViLmNvbmZpZyxjPU1hdGhKYXguSHViLm91dHB1dEpheDtmb3IodmFyIGc9MCxiPWYuamF4Lmxlbmd0aCxkPTA7ZzxiO2crKyl7dmFyIGU9Zi5qYXhbZ10uc3Vic3RyKDcpO2lmKGYuamF4W2ddLnN1YnN0cigwLDcpPT09Im91dHB1dC8iJiZjLm9yZGVyW2VdPT1udWxsKXtjLm9yZGVyW2VdPWQ7ZCsrfX12YXIgYT1NYXRoSmF4LkNhbGxiYWNrLlF1ZXVlKCk7cmV0dXJuIGEuUHVzaChbIlBvc3QiLHRoaXMuc2lnbmFsLCJCZWdpbiBKYXgiXSxbImxvYWRBcnJheSIsdGhpcyxmLmpheCwiamF4IiwiY29uZmlnLmpzIl0sWyJQb3N0Iix0aGlzLnNpZ25hbCwiRW5kIEpheCJdKX0sRXh0ZW5zaW9uczpmdW5jdGlvbigpe3ZhciBhPU1hdGhKYXguQ2FsbGJhY2suUXVldWUoKTtyZXR1cm4gYS5QdXNoKFsiUG9zdCIsdGhpcy5zaWduYWwsIkJlZ2luIEV4dGVuc2lvbnMiXSxbImxvYWRBcnJheSIsdGhpcyxNYXRoSmF4Lkh1Yi5jb25maWcuZXh0ZW5zaW9ucywiZXh0ZW5zaW9ucyJdLFsiUG9zdCIsdGhpcy5zaWduYWwsIkVuZCBFeHRlbnNpb25zIl0pfSxNZXNzYWdlOmZ1bmN0aW9uKCl7TWF0aEpheC5NZXNzYWdlLkluaXQodHJ1ZSl9LE1lbnU6ZnVuY3Rpb24oKXt2YXIgYj1NYXRoSmF4Lkh1Yi5jb25maWcubWVudVNldHRpbmdzLGE9TWF0aEpheC5IdWIub3V0cHV0SmF4LGQ7Zm9yKHZhciBjIGluIGEpe2lmKGEuaGFzT3duUHJvcGVydHkoYykpe2lmKGFbY10ubGVuZ3RoKXtkPWFbY107YnJlYWt9fX1pZihkJiZkLmxlbmd0aCl7aWYoYi5yZW5kZXJlciYmYi5yZW5kZXJlciE9PWRbMF0uaWQpe2QudW5zaGlmdChNYXRoSmF4Lk91dHB1dEpheFtiLnJlbmRlcmVyXSl9Yi5yZW5kZXJlcj1kWzBdLmlkfX0sSGFzaDpmdW5jdGlvbigpe2lmKE1hdGhKYXguSHViLmNvbmZpZy5wb3NpdGlvblRvSGFzaCYmZG9jdW1lbnQubG9jYXRpb24uaGFzaCYmZG9jdW1lbnQuYm9keSYmZG9jdW1lbnQuYm9keS5zY3JvbGxJbnRvVmlldyl7dmFyIGQ9ZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmxvY2F0aW9uLmhhc2guc3Vic3RyKDEpKTt2YXIgZj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChkKTtpZighZil7dmFyIGM9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKTtmb3IodmFyIGU9MCxiPWMubGVuZ3RoO2U8YjtlKyspe2lmKGNbZV0ubmFtZT09PWQpe2Y9Y1tlXTticmVha319fWlmKGYpe3doaWxlKCFmLnNjcm9sbEludG9WaWV3KXtmPWYucGFyZW50Tm9kZX1mPXRoaXMuSGFzaENoZWNrKGYpO2lmKGYmJmYuc2Nyb2xsSW50b1ZpZXcpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtmLnNjcm9sbEludG9WaWV3KHRydWUpfSwxKX19fX0sSGFzaENoZWNrOmZ1bmN0aW9uKGIpe3ZhciBhPU1hdGhKYXguSHViLmdldEpheEZvcihiKTtpZihhJiZNYXRoSmF4Lk91dHB1dEpheFthLm91dHB1dEpheF0uaGFzaENoZWNrKXtiPU1hdGhKYXguT3V0cHV0SmF4W2Eub3V0cHV0SmF4XS5oYXNoQ2hlY2soYil9cmV0dXJuIGJ9LE1lbnVab29tOmZ1bmN0aW9uKCl7aWYoTWF0aEpheC5IdWIuY29uZmlnLnNob3dNYXRoTWVudSl7aWYoIU1hdGhKYXguRXh0ZW5zaW9uLk1hdGhNZW51KXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7TWF0aEpheC5DYWxsYmFjay5RdWV1ZShbIlJlcXVpcmUiLE1hdGhKYXguQWpheCwiW01hdGhKYXhdL2V4dGVuc2lvbnMvTWF0aE1lbnUuanMiLHt9XSxbImxvYWREb21haW4iLE1hdGhKYXguTG9jYWxpemF0aW9uLCJNYXRoTWVudSJdKX0sMTAwMCl9ZWxzZXtzZXRUaW1lb3V0KE1hdGhKYXguQ2FsbGJhY2soWyJsb2FkRG9tYWluIixNYXRoSmF4LkxvY2FsaXphdGlvbiwiTWF0aE1lbnUiXSksMTAwMCl9aWYoIU1hdGhKYXguRXh0ZW5zaW9uLk1hdGhab29tKXtzZXRUaW1lb3V0KE1hdGhKYXguQ2FsbGJhY2soWyJSZXF1aXJlIixNYXRoSmF4LkFqYXgsIltNYXRoSmF4XS9leHRlbnNpb25zL01hdGhab29tLmpzIix7fV0pLDIwMDApfX19LG9uTG9hZDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub25sb2FkPU1hdGhKYXguQ2FsbGJhY2soZnVuY3Rpb24oKXtNYXRoSmF4Lkh1Yi5TdGFydHVwLnNpZ25hbC5Qb3N0KCJvbkxvYWQiKX0pO2lmKGRvY3VtZW50LmJvZHkmJmRvY3VtZW50LnJlYWR5U3RhdGUpe2lmKE1hdGhKYXguSHViLkJyb3dzZXIuaXNNU0lFKXtpZihkb2N1bWVudC5yZWFkeVN0YXRlPT09ImNvbXBsZXRlIil7cmV0dXJuW2FdfX1lbHNle2lmKGRvY3VtZW50LnJlYWR5U3RhdGUhPT0ibG9hZGluZyIpe3JldHVyblthXX19fWlmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsYSxmYWxzZSk7aWYoIXRoaXMucGFyYW1zLm5vRE9NQ29udGVudEV2ZW50KXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsYSxmYWxzZSl9fWVsc2V7aWYod2luZG93LmF0dGFjaEV2ZW50KXt3aW5kb3cuYXR0YWNoRXZlbnQoIm9ubG9hZCIsYSl9ZWxzZXt3aW5kb3cub25sb2FkPWF9fXJldHVybiBhfSxUeXBlc2V0OmZ1bmN0aW9uKGEsYil7aWYoTWF0aEpheC5IdWIuY29uZmlnLnNraXBTdGFydHVwVHlwZXNldCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX1yZXR1cm4gdGhpcy5xdWV1ZS5QdXNoKFsiUG9zdCIsdGhpcy5zaWduYWwsIkJlZ2luIFR5cGVzZXQiXSxbIlR5cGVzZXQiLE1hdGhKYXguSHViLGEsYl0sWyJQb3N0Iix0aGlzLnNpZ25hbCwiRW5kIFR5cGVzZXQiXSl9LFVSTDpmdW5jdGlvbihiLGEpe2lmKCFhLm1hdGNoKC9eKFthLXpdKzpcL1wvfFxbfFwvKS8pKXthPSJbTWF0aEpheF0vIitiKyIvIithfXJldHVybiBhfSxsb2FkQXJyYXk6ZnVuY3Rpb24oYixmLGMsYSl7aWYoYil7aWYoIU1hdGhKYXguT2JqZWN0LmlzQXJyYXkoYikpe2I9W2JdfWlmKGIubGVuZ3RoKXt2YXIgaD1NYXRoSmF4LkNhbGxiYWNrLlF1ZXVlKCksaj17fSxlO2Zvcih2YXIgZz0wLGQ9Yi5sZW5ndGg7ZzxkO2crKyl7ZT10aGlzLlVSTChmLGJbZ10pO2lmKGMpe2UrPSIvIitjfWlmKGEpe2guUHVzaChbIlJlcXVpcmUiLE1hdGhKYXguQWpheCxlLGpdKX1lbHNle2guUHVzaChNYXRoSmF4LkFqYXguUmVxdWlyZShlLGopKX19cmV0dXJuIGguUHVzaCh7fSl9fXJldHVybiBudWxsfX07KGZ1bmN0aW9uKGQpe3ZhciBiPXdpbmRvd1tkXSxlPSJbIitkKyJdIjt2YXIgYz1iLkh1YixhPWIuQWpheCxmPWIuQ2FsbGJhY2s7dmFyIGc9TWF0aEpheC5PYmplY3QuU3ViY2xhc3Moe0pBWEZJTEU6ImpheC5qcyIscmVxdWlyZTpudWxsLGNvbmZpZzp7fSxJbml0OmZ1bmN0aW9uKGksaCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApe3JldHVybiB0aGlzfXJldHVybih0aGlzLmNvbnN0cnVjdG9yLlN1YmNsYXNzKGksaCkpKCl9LEF1Z21lbnQ6ZnVuY3Rpb24oayxqKXt2YXIgaT10aGlzLmNvbnN0cnVjdG9yLGg9e307aWYoayE9bnVsbCl7Zm9yKHZhciBsIGluIGspe2lmKGsuaGFzT3duUHJvcGVydHkobCkpe2lmKHR5cGVvZiBrW2xdPT09ImZ1bmN0aW9uIil7aS5wcm90b0Z1bmN0aW9uKGwsa1tsXSl9ZWxzZXtoW2xdPWtbbF19fX1pZihrLnRvU3RyaW5nIT09aS5wcm90b3R5cGUudG9TdHJpbmcmJmsudG9TdHJpbmchPT17fS50b1N0cmluZyl7aS5wcm90b0Z1bmN0aW9uKCJ0b1N0cmluZyIsay50b1N0cmluZyl9fWMuSW5zZXJ0KGkucHJvdG90eXBlLGgpO2kuQXVnbWVudChudWxsLGopO3JldHVybiB0aGlzfSxUcmFuc2xhdGU6ZnVuY3Rpb24oaCxpKXt0aHJvdyBFcnJvcih0aGlzLmRpcmVjdG9yeSsiLyIrdGhpcy5KQVhGSUxFKyIgZmFpbGVkIHRvIGRlZmluZSB0aGUgVHJhbnNsYXRlKCkgbWV0aG9kIil9LFJlZ2lzdGVyOmZ1bmN0aW9uKGgpe30sQ29uZmlnOmZ1bmN0aW9uKCl7dGhpcy5jb25maWc9Yy5Db21iaW5lQ29uZmlnKHRoaXMuaWQsdGhpcy5jb25maWcpO2lmKHRoaXMuY29uZmlnLkF1Z21lbnQpe3RoaXMuQXVnbWVudCh0aGlzLmNvbmZpZy5BdWdtZW50KX19LFN0YXJ0dXA6ZnVuY3Rpb24oKXt9LGxvYWRDb21wbGV0ZTpmdW5jdGlvbihpKXtpZihpPT09ImNvbmZpZy5qcyIpe3JldHVybiBhLmxvYWRDb21wbGV0ZSh0aGlzLmRpcmVjdG9yeSsiLyIraSl9ZWxzZXt2YXIgaD1mLlF1ZXVlKCk7aC5QdXNoKGMuUmVnaXN0ZXIuU3RhcnR1cEhvb2soIkVuZCBDb25maWciLHt9KSxbIlBvc3QiLGMuU3RhcnR1cC5zaWduYWwsdGhpcy5pZCsiIEpheCBDb25maWciXSxbIkNvbmZpZyIsdGhpc10sWyJQb3N0IixjLlN0YXJ0dXAuc2lnbmFsLHRoaXMuaWQrIiBKYXggUmVxdWlyZSJdLFtmdW5jdGlvbihqKXtyZXR1cm4gTWF0aEpheC5IdWIuU3RhcnR1cC5sb2FkQXJyYXkoai5yZXF1aXJlLHRoaXMuZGlyZWN0b3J5KX0sdGhpc10sW2Z1bmN0aW9uKGosayl7cmV0dXJuIE1hdGhKYXguSHViLlN0YXJ0dXAubG9hZEFycmF5KGouZXh0ZW5zaW9ucywiZXh0ZW5zaW9ucy8iK2spfSx0aGlzLmNvbmZpZ3x8e30sdGhpcy5pZF0sWyJQb3N0IixjLlN0YXJ0dXAuc2lnbmFsLHRoaXMuaWQrIiBKYXggU3RhcnR1cCJdLFsiU3RhcnR1cCIsdGhpc10sWyJQb3N0IixjLlN0YXJ0dXAuc2lnbmFsLHRoaXMuaWQrIiBKYXggUmVhZHkiXSk7aWYodGhpcy5jb3B5VHJhbnNsYXRlKXtoLlB1c2goW2Z1bmN0aW9uKGope2oucHJlUHJvY2Vzcz1qLnByZVRyYW5zbGF0ZTtqLlByb2Nlc3M9ai5UcmFuc2xhdGU7ai5wb3N0UHJvY2Vzcz1qLnBvc3RUcmFuc2xhdGV9LHRoaXMuY29uc3RydWN0b3IucHJvdG90eXBlXSl9cmV0dXJuIGguUHVzaChbImxvYWRDb21wbGV0ZSIsYSx0aGlzLmRpcmVjdG9yeSsiLyIraV0pfX19LHtpZDoiSmF4Iix2ZXJzaW9uOiIyLjcuNCIsZGlyZWN0b3J5OmUrIi9qYXgiLGV4dGVuc2lvbkRpcjplKyIvZXh0ZW5zaW9ucyJ9KTtiLklucHV0SmF4PWcuU3ViY2xhc3Moe2VsZW1lbnRKYXg6Im1tbCIsc291cmNlTWVudVRpdGxlOlsiT3JpZ2luYWwiLCJPcmlnaW5hbCBGb3JtIl0sY29weVRyYW5zbGF0ZTp0cnVlLFByb2Nlc3M6ZnVuY3Rpb24obCxxKXt2YXIgaj1mLlF1ZXVlKCksbzt2YXIgaz10aGlzLmVsZW1lbnRKYXg7aWYoIWIuT2JqZWN0LmlzQXJyYXkoaykpe2s9W2tdfWZvcih2YXIgbj0wLGg9ay5sZW5ndGg7bjxoO24rKyl7bz1iLkVsZW1lbnRKYXguZGlyZWN0b3J5KyIvIitrW25dKyIvIit0aGlzLkpBWEZJTEU7aWYoIXRoaXMucmVxdWlyZSl7dGhpcy5yZXF1aXJlPVtdfWVsc2V7aWYoIWIuT2JqZWN0LmlzQXJyYXkodGhpcy5yZXF1aXJlKSl7dGhpcy5yZXF1aXJlPVt0aGlzLnJlcXVpcmVdfX10aGlzLnJlcXVpcmUucHVzaChvKTtqLlB1c2goYS5SZXF1aXJlKG8pKX1vPXRoaXMuZGlyZWN0b3J5KyIvIit0aGlzLkpBWEZJTEU7dmFyIHA9ai5QdXNoKGEuUmVxdWlyZShvKSk7aWYoIXAuY2FsbGVkKXt0aGlzLmNvbnN0cnVjdG9yLnByb3RvdHlwZS5Qcm9jZXNzPWZ1bmN0aW9uKCl7aWYoIXAuY2FsbGVkKXtyZXR1cm4gcH10aHJvdyBFcnJvcihvKyIgZmFpbGVkIHRvIGxvYWQgcHJvcGVybHkiKX19az1jLm91dHB1dEpheFsiamF4LyIra1swXV07aWYoayl7ai5QdXNoKGEuUmVxdWlyZShrWzBdLmRpcmVjdG9yeSsiLyIrdGhpcy5KQVhGSUxFKSl9cmV0dXJuIGouUHVzaCh7fSl9LG5lZWRzVXBkYXRlOmZ1bmN0aW9uKGgpe3ZhciBpPWguU291cmNlRWxlbWVudCgpO3JldHVybihoLm9yaWdpbmFsVGV4dCE9PWIuSFRNTC5nZXRTY3JpcHQoaSkpfSxSZWdpc3RlcjpmdW5jdGlvbihoKXtpZighYy5pbnB1dEpheCl7Yy5pbnB1dEpheD17fX1jLmlucHV0SmF4W2hdPXRoaXN9fSx7aWQ6IklucHV0SmF4Iix2ZXJzaW9uOiIyLjcuNCIsZGlyZWN0b3J5OmcuZGlyZWN0b3J5KyIvaW5wdXQiLGV4dGVuc2lvbkRpcjpnLmV4dGVuc2lvbkRpcn0pO2IuT3V0cHV0SmF4PWcuU3ViY2xhc3Moe2NvcHlUcmFuc2xhdGU6dHJ1ZSxwcmVQcm9jZXNzOmZ1bmN0aW9uKGope3ZhciBpLGg9dGhpcy5kaXJlY3RvcnkrIi8iK3RoaXMuSkFYRklMRTt0aGlzLmNvbnN0cnVjdG9yLnByb3RvdHlwZS5wcmVQcm9jZXNzPWZ1bmN0aW9uKGspe2lmKCFpLmNhbGxlZCl7cmV0dXJuIGl9dGhyb3cgRXJyb3IoaCsiIGZhaWxlZCB0byBsb2FkIHByb3Blcmx5Iil9O2k9YS5SZXF1aXJlKGgpO3JldHVybiBpfSxSZWdpc3RlcjpmdW5jdGlvbihpKXt2YXIgaD1jLm91dHB1dEpheDtpZighaFtpXSl7aFtpXT1bXX1pZihoW2ldLmxlbmd0aCYmKHRoaXMuaWQ9PT1jLmNvbmZpZy5tZW51U2V0dGluZ3MucmVuZGVyZXJ8fChoLm9yZGVyW3RoaXMuaWRdfHwwKTwoaC5vcmRlcltoW2ldWzBdLmlkXXx8MCkpKXtoW2ldLnVuc2hpZnQodGhpcyl9ZWxzZXtoW2ldLnB1c2godGhpcyl9aWYoIXRoaXMucmVxdWlyZSl7dGhpcy5yZXF1aXJlPVtdfWVsc2V7aWYoIWIuT2JqZWN0LmlzQXJyYXkodGhpcy5yZXF1aXJlKSl7dGhpcy5yZXF1aXJlPVt0aGlzLnJlcXVpcmVdfX10aGlzLnJlcXVpcmUucHVzaChiLkVsZW1lbnRKYXguZGlyZWN0b3J5KyIvIisoaS5zcGxpdCgvXC8vKVsxXSkrIi8iK3RoaXMuSkFYRklMRSl9LFJlbW92ZTpmdW5jdGlvbihoKXt9fSx7aWQ6Ik91dHB1dEpheCIsdmVyc2lvbjoiMi43LjQiLGRpcmVjdG9yeTpnLmRpcmVjdG9yeSsiL291dHB1dCIsZXh0ZW5zaW9uRGlyOmcuZXh0ZW5zaW9uRGlyLGZvbnREaXI6ZSsoYi5pc1BhY2tlZD8iIjoiLy4uIikrIi9mb250cyIsaW1hZ2VEaXI6ZSsoYi5pc1BhY2tlZD8iIjoiLy4uIikrIi9pbWFnZXMifSk7Yi5FbGVtZW50SmF4PWcuU3ViY2xhc3Moe0luaXQ6ZnVuY3Rpb24oaSxoKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5TdWJjbGFzcyhpLGgpfSxpbnB1dEpheDpudWxsLG91dHB1dEpheDpudWxsLGlucHV0SUQ6bnVsbCxvcmlnaW5hbFRleHQ6IiIsbWltZVR5cGU6IiIsc291cmNlTWVudVRpdGxlOlsiTWF0aE1MY29kZSIsIk1hdGhNTCBDb2RlIl0sVGV4dDpmdW5jdGlvbihpLGope3ZhciBoPXRoaXMuU291cmNlRWxlbWVudCgpO2IuSFRNTC5zZXRTY3JpcHQoaCxpKTtoLk1hdGhKYXguc3RhdGU9dGhpcy5TVEFURS5VUERBVEU7cmV0dXJuIGMuVXBkYXRlKGgsail9LFJlcHJvY2VzczpmdW5jdGlvbihpKXt2YXIgaD10aGlzLlNvdXJjZUVsZW1lbnQoKTtoLk1hdGhKYXguc3RhdGU9dGhpcy5TVEFURS5VUERBVEU7cmV0dXJuIGMuUmVwcm9jZXNzKGgsaSl9LFVwZGF0ZTpmdW5jdGlvbihoKXtyZXR1cm4gdGhpcy5SZXJlbmRlcihoKX0sUmVyZW5kZXI6ZnVuY3Rpb24oaSl7dmFyIGg9dGhpcy5Tb3VyY2VFbGVtZW50KCk7aC5NYXRoSmF4LnN0YXRlPXRoaXMuU1RBVEUuT1VUUFVUO3JldHVybiBjLlByb2Nlc3MoaCxpKX0sUmVtb3ZlOmZ1bmN0aW9uKGgpe2lmKHRoaXMuaG92ZXIpe3RoaXMuaG92ZXIuY2xlYXIodGhpcyl9Yi5PdXRwdXRKYXhbdGhpcy5vdXRwdXRKYXhdLlJlbW92ZSh0aGlzKTtpZighaCl7Yy5zaWduYWwuUG9zdChbIlJlbW92ZSBNYXRoIix0aGlzLmlucHV0SURdKTt0aGlzLkRldGFjaCgpfX0sbmVlZHNVcGRhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gYi5JbnB1dEpheFt0aGlzLmlucHV0SmF4XS5uZWVkc1VwZGF0ZSh0aGlzKX0sU291cmNlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlucHV0SUQpfSxBdHRhY2g6ZnVuY3Rpb24oaSxqKXt2YXIgaD1pLk1hdGhKYXguZWxlbWVudEpheDtpZihpLk1hdGhKYXguc3RhdGU9PT10aGlzLlNUQVRFLlVQREFURSl7aC5DbG9uZSh0aGlzKX1lbHNle2g9aS5NYXRoSmF4LmVsZW1lbnRKYXg9dGhpcztpZihpLmlkKXt0aGlzLmlucHV0SUQ9aS5pZH1lbHNle2kuaWQ9dGhpcy5pbnB1dElEPWIuRWxlbWVudEpheC5HZXRJRCgpO3RoaXMubmV3SUQ9MX19aC5vcmlnaW5hbFRleHQ9Yi5IVE1MLmdldFNjcmlwdChpKTtoLmlucHV0SmF4PWo7aWYoaC5yb290KXtoLnJvb3QuaW5wdXRJRD1oLmlucHV0SUR9cmV0dXJuIGh9LERldGFjaDpmdW5jdGlvbigpe3ZhciBoPXRoaXMuU291cmNlRWxlbWVudCgpO2lmKCFoKXtyZXR1cm59dHJ5e2RlbGV0ZSBoLk1hdGhKYXh9Y2F0Y2goaSl7aC5NYXRoSmF4PW51bGx9aWYodGhpcy5uZXdJRCl7aC5pZD0iIn19LENsb25lOmZ1bmN0aW9uKGgpe3ZhciBpO2ZvcihpIGluIHRoaXMpe2lmKCF0aGlzLmhhc093blByb3BlcnR5KGkpKXtjb250aW51ZX1pZih0eXBlb2YoaFtpXSk9PT0idW5kZWZpbmVkIiYmaSE9PSJuZXdJRCIpe2RlbGV0ZSB0aGlzW2ldfX1mb3IoaSBpbiBoKXtpZighaC5oYXNPd25Qcm9wZXJ0eShpKSl7Y29udGludWV9aWYodHlwZW9mKHRoaXNbaV0pPT09InVuZGVmaW5lZCJ8fCh0aGlzW2ldIT09aFtpXSYmaSE9PSJpbnB1dElEIikpe3RoaXNbaV09aFtpXX19fX0se2lkOiJFbGVtZW50SmF4Iix2ZXJzaW9uOiIyLjcuNCIsZGlyZWN0b3J5OmcuZGlyZWN0b3J5KyIvZWxlbWVudCIsZXh0ZW5zaW9uRGlyOmcuZXh0ZW5zaW9uRGlyLElEOjAsU1RBVEU6e1BFTkRJTkc6MSxQUk9DRVNTRUQ6MixVUERBVEU6MyxPVVRQVVQ6NH0sR2V0SUQ6ZnVuY3Rpb24oKXt0aGlzLklEKys7cmV0dXJuIk1hdGhKYXgtRWxlbWVudC0iK3RoaXMuSUR9LFN1YmNsYXNzOmZ1bmN0aW9uKCl7dmFyIGg9Zy5TdWJjbGFzcy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aC5sb2FkQ29tcGxldGU9dGhpcy5wcm90b3R5cGUubG9hZENvbXBsZXRlO3JldHVybiBofX0pO2IuRWxlbWVudEpheC5wcm90b3R5cGUuU1RBVEU9Yi5FbGVtZW50SmF4LlNUQVRFO2IuT3V0cHV0SmF4LkVycm9yPXtpZDoiRXJyb3IiLHZlcnNpb246IjIuNy40Iixjb25maWc6e30sZXJyb3JzOjAsQ29udGV4dE1lbnU6ZnVuY3Rpb24oKXtyZXR1cm4gYi5FeHRlbnNpb24uTWF0aEV2ZW50cy5FdmVudC5Db250ZXh0TWVudS5hcHBseShiLkV4dGVuc2lvbi5NYXRoRXZlbnRzLkV2ZW50LGFyZ3VtZW50cyl9LE1vdXNlZG93bjpmdW5jdGlvbigpe3JldHVybiBiLkV4dGVuc2lvbi5NYXRoRXZlbnRzLkV2ZW50LkFsdENvbnRleHRNZW51LmFwcGx5KGIuRXh0ZW5zaW9uLk1hdGhFdmVudHMuRXZlbnQsYXJndW1lbnRzKX0sZ2V0SmF4RnJvbU1hdGg6ZnVuY3Rpb24oaCl7cmV0dXJuKGgubmV4dFNpYmxpbmcuTWF0aEpheHx8e30pLmVycm9yfSxKYXg6ZnVuY3Rpb24oaixpKXt2YXIgaD1NYXRoSmF4Lkh1Yi5pbnB1dEpheFtpLnR5cGUucmVwbGFjZSgvICo7KC58XHMpKi8sIiIpXTt0aGlzLmVycm9ycysrO3JldHVybntpbnB1dEpheDooaHx8e2lkOiJFcnJvciJ9KS5pZCxvdXRwdXRKYXg6IkVycm9yIixpbnB1dElEOiJNYXRoSmF4LUVycm9yLSIrdGhpcy5lcnJvcnMsc291cmNlTWVudVRpdGxlOlsiRXJyb3JNZXNzYWdlIiwiRXJyb3IgTWVzc2FnZSJdLHNvdXJjZU1lbnVGb3JtYXQ6IkVycm9yIixvcmlnaW5hbFRleHQ6TWF0aEpheC5IVE1MLmdldFNjcmlwdChpKSxlcnJvclRleHQ6an19fTtiLklucHV0SmF4LkVycm9yPXtpZDoiRXJyb3IiLHZlcnNpb246IjIuNy40Iixjb25maWc6e30sc291cmNlTWVudVRpdGxlOlsiT3JpZ2luYWwiLCJPcmlnaW5hbCBGb3JtIl19fSkoIk1hdGhKYXgiKTsoZnVuY3Rpb24obyl7dmFyIGg9d2luZG93W29dO2lmKCFoKXtoPXdpbmRvd1tvXT17fX12YXIgZD1oLkh1Yjt2YXIgcz1kLlN0YXJ0dXA7dmFyIHc9ZC5jb25maWc7dmFyIGc9ZG9jdW1lbnQuaGVhZHx8KGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0pO2lmKCFnKXtnPWRvY3VtZW50LmNoaWxkTm9kZXNbMF19dmFyIGI9KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudHx8ZG9jdW1lbnQpLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKTtpZihiLmxlbmd0aD09PTAmJmcubmFtZXNwYWNlVVJJKXtiPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoZy5uYW1lc3BhY2VVUkksInNjcmlwdCIpfXZhciBmPW5ldyBSZWdFeHAoIihefC8pIitvKyJcXC5qcyhcXD8uKik/JCIpO2Zvcih2YXIgcT1iLmxlbmd0aC0xO3E+PTA7cS0tKXtpZigoYltxXS5zcmN8fCIiKS5tYXRjaChmKSl7cy5zY3JpcHQ9YltxXS5pbm5lckhUTUw7aWYoUmVnRXhwLiQyKXt2YXIgdD1SZWdFeHAuJDIuc3Vic3RyKDEpLnNwbGl0KC9cJi8pO2Zvcih2YXIgcD0wLGw9dC5sZW5ndGg7cDxsO3ArKyl7dmFyIG49dFtwXS5tYXRjaCgvKC4qKT0oLiopLyk7aWYobil7cy5wYXJhbXNbdW5lc2NhcGUoblsxXSldPXVuZXNjYXBlKG5bMl0pfWVsc2V7cy5wYXJhbXNbdFtwXV09dHJ1ZX19fXcucm9vdD1iW3FdLnNyYy5yZXBsYWNlKC8oXnxcLylbXlwvXSooXD8uKik/JC8sIiIpO2guQWpheC5jb25maWcucm9vdD13LnJvb3Q7aC5BamF4LnBhcmFtcz1zLnBhcmFtczticmVha319dmFyIGs9bmF2aWdhdG9yLnVzZXJBZ2VudDt2YXIgYT17aXNNYWM6KG5hdmlnYXRvci5wbGF0Zm9ybS5zdWJzdHIoMCwzKT09PSJNYWMiKSxpc1BDOihuYXZpZ2F0b3IucGxhdGZvcm0uc3Vic3RyKDAsMyk9PT0iV2luIiksaXNNU0lFOigiQWN0aXZlWE9iamVjdCIgaW4gd2luZG93JiYiY2xpcGJvYXJkRGF0YSIgaW4gd2luZG93KSxpc0VkZ2U6KCJNU0dlc3R1cmVFdmVudCIgaW4gd2luZG93JiYiY2hyb21lIiBpbiB3aW5kb3cmJndpbmRvdy5jaHJvbWUubG9hZFRpbWVzPT1udWxsKSxpc0ZpcmVmb3g6KCEhay5tYXRjaCgvR2Vja29cLy8pJiYhay5tYXRjaCgvbGlrZSBHZWNrby8pKSxpc1NhZmFyaTooISFrLm1hdGNoKC8gKEFwcGxlKT9XZWJLaXRcLy8pJiYhay5tYXRjaCgvIGxpa2UgaVBob25lIC8pJiYoIXdpbmRvdy5jaHJvbWV8fHdpbmRvdy5jaHJvbWUuYXBwPT1udWxsKSksaXNDaHJvbWU6KCJjaHJvbWUiIGluIHdpbmRvdyYmd2luZG93LmNocm9tZS5sb2FkVGltZXMhPW51bGwpLGlzT3BlcmE6KCJvcGVyYSIgaW4gd2luZG93JiZ3aW5kb3cub3BlcmEudmVyc2lvbiE9bnVsbCksaXNLb25xdWVyb3I6KCJrb25xdWVyb3IiIGluIHdpbmRvdyYmbmF2aWdhdG9yLnZlbmRvcj09IktERSIpLHZlcnNpb25BdExlYXN0OmZ1bmN0aW9uKHkpe3ZhciB4PSh0aGlzLnZlcnNpb24pLnNwbGl0KCIuIik7eT0obmV3IFN0cmluZyh5KSkuc3BsaXQoIi4iKTtmb3IodmFyIHo9MCxqPXkubGVuZ3RoO3o8ajt6Kyspe2lmKHhbel0hPXlbel0pe3JldHVybiBwYXJzZUludCh4W3pdfHwiMCIpPj1wYXJzZUludCh5W3pdKX19cmV0dXJuIHRydWV9LFNlbGVjdDpmdW5jdGlvbihqKXt2YXIgaT1qW2QuQnJvd3Nlcl07aWYoaSl7cmV0dXJuIGkoZC5Ccm93c2VyKX1yZXR1cm4gbnVsbH19O3ZhciBlPWsucmVwbGFjZSgvXk1vemlsbGFcLyhcZCtcLikrXGQrIC8sIiIpLnJlcGxhY2UoL1thLXpdWy1hLXowLTkuXzogXStcL1xkK1teIF0qLVteIF0qXC4oW2Etel1bYS16XSk/XGQrIC9pLCIiKS5yZXBsYWNlKC9HZW50b28gfFVidW50dVwvKFxkK1wuKSpcZCsgKFwoW14pXSpcKSApPy8sIiIpO2QuQnJvd3Nlcj1kLkluc2VydChkLkluc2VydChuZXcgU3RyaW5nKCJVbmtub3duIikse3ZlcnNpb246IjAuMCJ9KSxhKTtmb3IodmFyIHYgaW4gYSl7aWYoYS5oYXNPd25Qcm9wZXJ0eSh2KSl7aWYoYVt2XSYmdi5zdWJzdHIoMCwyKT09PSJpcyIpe3Y9di5zbGljZSgyKTtpZih2PT09Ik1hYyJ8fHY9PT0iUEMiKXtjb250aW51ZX1kLkJyb3dzZXI9ZC5JbnNlcnQobmV3IFN0cmluZyh2KSxhKTt2YXIgcj1uZXcgUmVnRXhwKCIuKihWZXJzaW9uL3wgVHJpZGVudC8uKjsgcnY6KSgoPzpcXGQrXFwuKStcXGQrKXwuKigiK3YrIikiKyh2PT0iTVNJRSI/IiAiOiIvIikrIigoPzpcXGQrXFwuKSpcXGQrKXwoPzpefFxcKHwgKShbYS16XVstYS16MC05Ll86IF0rfCg/OkFwcGxlKT9XZWJLaXQpLygoPzpcXGQrXFwuKStcXGQrKSIpO3ZhciB1PXIuZXhlYyhlKXx8WyIiLCIiLCIiLCJ1bmtub3duIiwiMC4wIl07ZC5Ccm93c2VyLm5hbWU9KHVbMV0hPSIiP3Y6KHVbM118fHVbNV0pKTtkLkJyb3dzZXIudmVyc2lvbj11WzJdfHx1WzRdfHx1WzZdO2JyZWFrfX19dHJ5e2QuQnJvd3Nlci5TZWxlY3Qoe1NhZmFyaTpmdW5jdGlvbihqKXt2YXIgaT1wYXJzZUludCgoU3RyaW5nKGoudmVyc2lvbikuc3BsaXQoIi4iKSlbMF0pO2lmKGk+ODUpe2oud2Via2l0PWoudmVyc2lvbn1pZihpPj01Mzgpe2oudmVyc2lvbj0iOC4wIn1lbHNle2lmKGk+PTUzNyl7ai52ZXJzaW9uPSI3LjAifWVsc2V7aWYoaT49NTM2KXtqLnZlcnNpb249IjYuMCJ9ZWxzZXtpZihpPj01MzQpe2oudmVyc2lvbj0iNS4xIn1lbHNle2lmKGk+PTUzMyl7ai52ZXJzaW9uPSI1LjAifWVsc2V7aWYoaT49NTI2KXtqLnZlcnNpb249IjQuMCJ9ZWxzZXtpZihpPj01MjUpe2oudmVyc2lvbj0iMy4xIn1lbHNle2lmKGk+NTAwKXtqLnZlcnNpb249IjMuMCJ9ZWxzZXtpZihpPjQwMCl7ai52ZXJzaW9uPSIyLjAifWVsc2V7aWYoaT44NSl7ai52ZXJzaW9uPSIxLjAifX19fX19fX19fWoud2Via2l0PShuYXZpZ2F0b3IuYXBwVmVyc2lvbi5tYXRjaCgvV2ViS2l0XC8oXGQrKVwuLykpWzFdO2ouaXNNb2JpbGU9KG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKC9Nb2JpbGUvaSkhPW51bGwpO2oubm9Db250ZXh0TWVudT1qLmlzTW9iaWxlfSxGaXJlZm94OmZ1bmN0aW9uKGope2lmKChqLnZlcnNpb249PT0iMC4wInx8ay5tYXRjaCgvRmlyZWZveC8pPT1udWxsKSYmbmF2aWdhdG9yLnByb2R1Y3Q9PT0iR2Vja28iKXt2YXIgbT1rLm1hdGNoKC9bXC8gXXJ2OihcZCtcLlxkLio/KVtcKSBdLyk7aWYobSl7ai52ZXJzaW9uPW1bMV19ZWxzZXt2YXIgaT0obmF2aWdhdG9yLmJ1aWxkSUR8fG5hdmlnYXRvci5wcm9kdWN0U3VifHwiMCIpLnN1YnN0cigwLDgpO2lmKGk+PSIyMDExMTIyMCIpe2oudmVyc2lvbj0iOS4wIn1lbHNle2lmKGk+PSIyMDExMTEyMCIpe2oudmVyc2lvbj0iOC4wIn1lbHNle2lmKGk+PSIyMDExMDkyNyIpe2oudmVyc2lvbj0iNy4wIn1lbHNle2lmKGk+PSIyMDExMDgxNiIpe2oudmVyc2lvbj0iNi4wIn1lbHNle2lmKGk+PSIyMDExMDYyMSIpe2oudmVyc2lvbj0iNS4wIn1lbHNle2lmKGk+PSIyMDExMDMyMCIpe2oudmVyc2lvbj0iNC4wIn1lbHNle2lmKGk+PSIyMDEwMDEyMSIpe2oudmVyc2lvbj0iMy42In1lbHNle2lmKGk+PSIyMDA5MDYzMCIpe2oudmVyc2lvbj0iMy41In1lbHNle2lmKGk+PSIyMDA4MDYxNyIpe2oudmVyc2lvbj0iMy4wIn1lbHNle2lmKGk+PSIyMDA2MTAyNCIpe2oudmVyc2lvbj0iMi4wIn19fX19fX19fX19fWouaXNNb2JpbGU9KG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKC9BbmRyb2lkL2kpIT1udWxsfHxrLm1hdGNoKC8gRmVubmVjXC8vKSE9bnVsbHx8ay5tYXRjaCgvTW9iaWxlLykhPW51bGwpfSxDaHJvbWU6ZnVuY3Rpb24oaSl7aS5ub0NvbnRleHRNZW51PWkuaXNNb2JpbGU9ISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8gTW9iaWxlWyBcL10vKX0sT3BlcmE6ZnVuY3Rpb24oaSl7aS52ZXJzaW9uPW9wZXJhLnZlcnNpb24oKX0sRWRnZTpmdW5jdGlvbihpKXtpLmlzTW9iaWxlPSEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvIFBob25lLyl9LE1TSUU6ZnVuY3Rpb24oail7ai5pc01vYmlsZT0hIW5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goLyBQaG9uZS8pO2ouaXNJRTk9ISEoZG9jdW1lbnQuZG9jdW1lbnRNb2RlJiYod2luZG93LnBlcmZvcm1hbmNlfHx3aW5kb3cubXNQZXJmb3JtYW5jZSkpO01hdGhKYXguSFRNTC5zZXRTY3JpcHRCdWc9IWouaXNJRTl8fGRvY3VtZW50LmRvY3VtZW50TW9kZTw5O01hdGhKYXguSHViLm1zaWVIVE1MQ29sbGVjdGlvbkJ1Zz0oZG9jdW1lbnQuZG9jdW1lbnRNb2RlPDkpO2lmKGRvY3VtZW50LmRvY3VtZW50TW9kZTwxMCYmIXMucGFyYW1zLk5vTWF0aFBsYXllcil7dHJ5e25ldyBBY3RpdmVYT2JqZWN0KCJNYXRoUGxheWVyLkZhY3RvcnkuMSIpO2ouaGFzTWF0aFBsYXllcj10cnVlfWNhdGNoKG0pe310cnl7aWYoai5oYXNNYXRoUGxheWVyKXt2YXIgaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvYmplY3QiKTtpLmlkPSJtYXRocGxheWVyIjtpLmNsYXNzaWQ9ImNsc2lkOjMyRjY2QTIwLTc2MTQtMTFENC1CRDExLTAwMTA0QkQzRjk4NyI7Zy5hcHBlbmRDaGlsZChpKTtkb2N1bWVudC5uYW1lc3BhY2VzLmFkZCgibSIsImh0dHA6Ly93d3cudzMub3JnLzE5OTgvTWF0aC9NYXRoTUwiKTtqLm1wTmFtZXNwYWNlPXRydWU7aWYoZG9jdW1lbnQucmVhZHlTdGF0ZSYmKGRvY3VtZW50LnJlYWR5U3RhdGU9PT0ibG9hZGluZyJ8fGRvY3VtZW50LnJlYWR5U3RhdGU9PT0iaW50ZXJhY3RpdmUiKSl7ZG9jdW1lbnQud3JpdGUoJzw/aW1wb3J0IG5hbWVzcGFjZT0ibSIgaW1wbGVtZW50YXRpb249IiNNYXRoUGxheWVyIj4nKTtqLm1wSW1wb3J0ZWQ9dHJ1ZX19ZWxzZXtkb2N1bWVudC5uYW1lc3BhY2VzLmFkZCgibWp4X0lFX2ZpeCIsImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiKX19Y2F0Y2gobSl7fX19fSl9Y2F0Y2goYyl7Y29uc29sZS5lcnJvcihjLm1lc3NhZ2UpfWQuQnJvd3Nlci5TZWxlY3QoTWF0aEpheC5NZXNzYWdlLmJyb3dzZXJzKTtpZihoLkF1dGhvckNvbmZpZyYmdHlwZW9mIGguQXV0aG9yQ29uZmlnLkF1dGhvckluaXQ9PT0iZnVuY3Rpb24iKXtoLkF1dGhvckNvbmZpZy5BdXRob3JJbml0KCl9ZC5xdWV1ZT1oLkNhbGxiYWNrLlF1ZXVlKCk7ZC5xdWV1ZS5QdXNoKFsiUG9zdCIscy5zaWduYWwsIkJlZ2luIl0sWyJDb25maWciLHNdLFsiQ29va2llIixzXSxbIlN0eWxlcyIsc10sWyJNZXNzYWdlIixzXSxmdW5jdGlvbigpe3ZhciBpPWguQ2FsbGJhY2suUXVldWUocy5KYXgoKSxzLkV4dGVuc2lvbnMoKSk7cmV0dXJuIGkuUHVzaCh7fSl9LFsiTWVudSIsc10scy5vbkxvYWQoKSxmdW5jdGlvbigpe01hdGhKYXguaXNSZWFkeT10cnVlfSxbIlR5cGVzZXQiLHNdLFsiSGFzaCIsc10sWyJNZW51Wm9vbSIsc10sWyJQb3N0IixzLnNpZ25hbCwiRW5kIl0pfSkoIk1hdGhKYXgiKX19Owo="></script>
  
    <script src="data:application/javascript;charset=utf-8;base64,TWF0aEpheC5IdWIuQ29uZmlnKHsKICAgIHRleDJqYXg6IHsKICAgICAgICBwcmV2aWV3OiAibm9uZSIsCiAgICAgICAgaW5saW5lTWF0aDogW1snJCcsICckJ10sIFsiXFwoIiwgIlxcKSJdXSwKICAgICAgICBwcm9jZXNzRXNjYXBlczogdHJ1ZQogICAgfSwKICAgIG1lc3NhZ2VTdHlsZTogIm5vbmUiCgp9KTsKCgpmdW5jdGlvbiBzZXRTdGlja3lNZW51ICgpIHsKICAgICAKICAgIHZhciBvcHRpb25zID0gewogICAgICAgIGJvdHRvbWluZzogZmFsc2UsCiAgICAgICAgaW5uZXJfc2Nyb2xsaW5nOiBmYWxzZQogICAgfTsKICAgIAogICAgdmFyIHN0aWNreSA9ICIjVE9DIjsKICAgIHZhciB3aWR0aCA9ICQod2luZG93KS53aWR0aCgpOwogICAgCiAgICBpZiAod2lkdGggPj0gNzY4KSB7CiAgICAgICAgY29uc29sZS5sb2coJ2ZvbGQgaW4nKTsKICAgICAgICAvLyQoc3RpY2t5KS5oaWRlKCk7CiAgICAgICAgLy8kKHN0aWNreSkuc2hvdygpOwogICAgICAgICQoc3RpY2t5KS5zdGlja19pbl9wYXJlbnQob3B0aW9ucyk7CiAgICAgICAgLy8gJCgiLndlbGwgdWwiKS5hZGRDbGFzcygnbWVudScpOwogICAgICAgIAogICAgICAgICQoIi53ZWxsIHVsIikuYXR0cignaWQnLCAnYWNjb3JkaW9uLTEnKTsKCiAgICB9IGVsc2UgewogICAgICAgICQoIi53ZWxsIHVsIikuYXR0cignaWQnLCAnJyk7CiAgICAgICAgJChzdGlja3kpLnRyaWdnZXIoInN0aWNreV9raXQ6ZGV0YWNoIik7CiAgICAgICAgY29uc29sZS5sb2coJ2ZvbGQgb3V0Jyk7CiAgICAgICAgCiAgICB9Cn07CgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHsKCiAgICAgICAgc2V0U3RpY2t5TWVudSgpOwogICAgfSk7Cn0pOwpmdW5jdGlvbiBkb0FjY29yZGlvbiAoKSB7CgogICAgJCgiI2FjY29yZGlvbi0xIikuZGNBY2NvcmRpb24oewogICAgICAgIGV2ZW50VHlwZTogJ2NsaWNrJywKICAgICAgICBhdXRvQ2xvc2U6IGZhbHNlLAogICAgICAgIHNhdmVTdGF0ZTogZmFsc2UsCiAgICAgICAgZGlzYWJsZUxpbms6IGZhbHNlLAogICAgICAgIHNwZWVkOiAwLAogICAgICAgIHNob3dDb3VudDogdHJ1ZSwKICAgICAgICBhdXRvRXhwYW5kOiB0cnVlLAogICAgICAgIGNvb2tpZTogJ2RjanEtYWNjb3JkaW9uLTEnLAogICAgICAgIGNsYXNzRXhwYW5kOiAnZGNqcS1jdXJyZW50LXBhcmVudCcKICAgIH0pOwp9CgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICBzZXRTdGlja3lNZW51KCk7CiAgICBkb0FjY29yZGlvbigpOwp9KTsKCiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICQoICd0YWJsZScgKS5hZGRDbGFzcyggInRhYmxlIiApOwp9KTsKCi8qCiQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLnJlc2l6ZVRPKSBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVUTyk7CiAgICB0aGlzLnJlc2l6ZVRPID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAkKHRoaXMpLnRyaWdnZXIoJ3Jlc2l6ZUVuZCcpOwogICAgfSwgMjAwKTsKfSk7CgokKHdpbmRvdykuYmluZCgncmVzaXplRW5kJywgZnVuY3Rpb24oKSB7CiAgICAvL2RvIHNvbWV0aGluZywgd2luZG93IGhhc24ndCBjaGFuZ2VkIHNpemUgaW4gNTAwbXMKICAgIC8vd2luZG93LmxvY2F0aW9uID0gbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5oYXNoOwogICAgLy9sb2NhdGlvbi5yZWxvYWQoKTsKICAgIHNldFN0aWNreU1lbnUoKTsKfSk7Ki8K"></script>
  
    <script src="data:application/javascript;charset=utf-8;base64,Ly8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjkuMgoKLyoqCkBsaWNlbnNlIFN0aWNreS1raXQgdjEuMS4yIHwgV1RGUEwgfCBMZWFmIENvcmNvcmFuIDIwMTUgfCBodHRwOi8vbGVhZm8ubmV0CiAqLwoKKGZ1bmN0aW9uKCkgewogIHZhciAkLCB3aW47CgogICQgPSB0aGlzLmpRdWVyeSB8fCB3aW5kb3cualF1ZXJ5OwoKICB3aW4gPSAkKHdpbmRvdyk7CgogICQuZm4uc3RpY2tfaW5fcGFyZW50ID0gZnVuY3Rpb24ob3B0cykgewogICAgdmFyIGRvYywgZWxtLCBlbmFibGVfYm90dG9taW5nLCBmbiwgaSwgaW5uZXJfc2Nyb2xsaW5nLCBsZW4sIG1hbnVhbF9zcGFjZXIsIG9mZnNldF90b3AsIHBhcmVudF9zZWxlY3RvciwgcmVjYWxjX2V2ZXJ5LCBzdGlja3lfY2xhc3M7CiAgICBpZiAob3B0cyA9PSBudWxsKSB7CiAgICAgIG9wdHMgPSB7fTsKICAgIH0KICAgIHN0aWNreV9jbGFzcyA9IG9wdHMuc3RpY2t5X2NsYXNzLCBpbm5lcl9zY3JvbGxpbmcgPSBvcHRzLmlubmVyX3Njcm9sbGluZywgcmVjYWxjX2V2ZXJ5ID0gb3B0cy5yZWNhbGNfZXZlcnksIHBhcmVudF9zZWxlY3RvciA9IG9wdHMucGFyZW50LCBvZmZzZXRfdG9wID0gb3B0cy5vZmZzZXRfdG9wLCBtYW51YWxfc3BhY2VyID0gb3B0cy5zcGFjZXIsIGVuYWJsZV9ib3R0b21pbmcgPSBvcHRzLmJvdHRvbWluZzsKICAgIGlmIChvZmZzZXRfdG9wID09IG51bGwpIHsKICAgICAgb2Zmc2V0X3RvcCA9IDA7CiAgICB9CiAgICBpZiAocGFyZW50X3NlbGVjdG9yID09IG51bGwpIHsKICAgICAgcGFyZW50X3NlbGVjdG9yID0gdm9pZCAwOwogICAgfQogICAgaWYgKGlubmVyX3Njcm9sbGluZyA9PSBudWxsKSB7CiAgICAgIGlubmVyX3Njcm9sbGluZyA9IHRydWU7CiAgICB9CiAgICBpZiAoc3RpY2t5X2NsYXNzID09IG51bGwpIHsKICAgICAgc3RpY2t5X2NsYXNzID0gImlzX3N0dWNrIjsKICAgIH0KICAgIGRvYyA9ICQoZG9jdW1lbnQpOwogICAgaWYgKGVuYWJsZV9ib3R0b21pbmcgPT0gbnVsbCkgewogICAgICBlbmFibGVfYm90dG9taW5nID0gdHJ1ZTsKICAgIH0KICAgIGZuID0gZnVuY3Rpb24oZWxtLCBwYWRkaW5nX2JvdHRvbSwgcGFyZW50X3RvcCwgcGFyZW50X2hlaWdodCwgdG9wLCBoZWlnaHQsIGVsX2Zsb2F0LCBkZXRhY2hlZCkgewogICAgICB2YXIgYm90dG9tZWQsIGRldGFjaCwgZml4ZWQsIGxhc3RfcG9zLCBsYXN0X3Njcm9sbF9oZWlnaHQsIG9mZnNldCwgcGFyZW50LCByZWNhbGMsIHJlY2FsY19hbmRfdGljaywgcmVjYWxjX2NvdW50ZXIsIHNwYWNlciwgdGljazsKICAgICAgaWYgKGVsbS5kYXRhKCJzdGlja3lfa2l0IikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZWxtLmRhdGEoInN0aWNreV9raXQiLCB0cnVlKTsKICAgICAgbGFzdF9zY3JvbGxfaGVpZ2h0ID0gZG9jLmhlaWdodCgpOwogICAgICBwYXJlbnQgPSBlbG0ucGFyZW50KCk7CiAgICAgIGlmIChwYXJlbnRfc2VsZWN0b3IgIT0gbnVsbCkgewogICAgICAgIHBhcmVudCA9IHBhcmVudC5jbG9zZXN0KHBhcmVudF9zZWxlY3Rvcik7CiAgICAgIH0KICAgICAgaWYgKCFwYXJlbnQubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgImZhaWxlZCB0byBmaW5kIHN0aWNrIHBhcmVudCI7CiAgICAgIH0KICAgICAgZml4ZWQgPSBmYWxzZTsKICAgICAgYm90dG9tZWQgPSBmYWxzZTsKICAgICAgc3BhY2VyID0gbWFudWFsX3NwYWNlciAhPSBudWxsID8gbWFudWFsX3NwYWNlciAmJiBlbG0uY2xvc2VzdChtYW51YWxfc3BhY2VyKSA6ICQoIjxkaXYgLz4iKTsKICAgICAgaWYgKHNwYWNlcikgewogICAgICAgIHNwYWNlci5jc3MoJ3Bvc2l0aW9uJywgZWxtLmNzcygncG9zaXRpb24nKSk7CiAgICAgIH0KICAgICAgcmVjYWxjID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGJvcmRlcl90b3AsIHBhZGRpbmdfdG9wLCByZXN0b3JlOwogICAgICAgIGlmIChkZXRhY2hlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsYXN0X3Njcm9sbF9oZWlnaHQgPSBkb2MuaGVpZ2h0KCk7CiAgICAgICAgYm9yZGVyX3RvcCA9IHBhcnNlSW50KHBhcmVudC5jc3MoImJvcmRlci10b3Atd2lkdGgiKSwgMTApOwogICAgICAgIHBhZGRpbmdfdG9wID0gcGFyc2VJbnQocGFyZW50LmNzcygicGFkZGluZy10b3AiKSwgMTApOwogICAgICAgIHBhZGRpbmdfYm90dG9tID0gcGFyc2VJbnQocGFyZW50LmNzcygicGFkZGluZy1ib3R0b20iKSwgMTApOwogICAgICAgIHBhcmVudF90b3AgPSBwYXJlbnQub2Zmc2V0KCkudG9wICsgYm9yZGVyX3RvcCArIHBhZGRpbmdfdG9wOwogICAgICAgIHBhcmVudF9oZWlnaHQgPSBwYXJlbnQuaGVpZ2h0KCk7CiAgICAgICAgaWYgKGZpeGVkKSB7CiAgICAgICAgICBmaXhlZCA9IGZhbHNlOwogICAgICAgICAgYm90dG9tZWQgPSBmYWxzZTsKICAgICAgICAgIGlmIChtYW51YWxfc3BhY2VyID09IG51bGwpIHsKICAgICAgICAgICAgZWxtLmluc2VydEFmdGVyKHNwYWNlcik7CiAgICAgICAgICAgIHNwYWNlci5kZXRhY2goKTsKICAgICAgICAgIH0KICAgICAgICAgIGVsbS5jc3MoewogICAgICAgICAgICBwb3NpdGlvbjogIiIsCiAgICAgICAgICAgIHRvcDogIiIsCiAgICAgICAgICAgIHdpZHRoOiAiIiwKICAgICAgICAgICAgYm90dG9tOiAiIgogICAgICAgICAgfSkucmVtb3ZlQ2xhc3Moc3RpY2t5X2NsYXNzKTsKICAgICAgICAgIHJlc3RvcmUgPSB0cnVlOwogICAgICAgIH0KICAgICAgICB0b3AgPSBlbG0ub2Zmc2V0KCkudG9wIC0gKHBhcnNlSW50KGVsbS5jc3MoIm1hcmdpbi10b3AiKSwgMTApIHx8IDApIC0gb2Zmc2V0X3RvcDsKICAgICAgICBoZWlnaHQgPSBlbG0ub3V0ZXJIZWlnaHQodHJ1ZSk7CiAgICAgICAgZWxfZmxvYXQgPSBlbG0uY3NzKCJmbG9hdCIpOwogICAgICAgIGlmIChzcGFjZXIpIHsKICAgICAgICAgIHNwYWNlci5jc3MoewogICAgICAgICAgICB3aWR0aDogZWxtLm91dGVyV2lkdGgodHJ1ZSksCiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LAogICAgICAgICAgICBkaXNwbGF5OiBlbG0uY3NzKCJkaXNwbGF5IiksCiAgICAgICAgICAgICJ2ZXJ0aWNhbC1hbGlnbiI6IGVsbS5jc3MoInZlcnRpY2FsLWFsaWduIiksCiAgICAgICAgICAgICJmbG9hdCI6IGVsX2Zsb2F0CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3RvcmUpIHsKICAgICAgICAgIHJldHVybiB0aWNrKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICByZWNhbGMoKTsKICAgICAgaWYgKGhlaWdodCA9PT0gcGFyZW50X2hlaWdodCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsYXN0X3BvcyA9IHZvaWQgMDsKICAgICAgb2Zmc2V0ID0gb2Zmc2V0X3RvcDsKICAgICAgcmVjYWxjX2NvdW50ZXIgPSByZWNhbGNfZXZlcnk7CiAgICAgIHRpY2sgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgY3NzLCBkZWx0YSwgcmVjYWxjZWQsIHNjcm9sbCwgd2lsbF9ib3R0b20sIHdpbl9oZWlnaHQ7CiAgICAgICAgaWYgKGRldGFjaGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJlY2FsY2VkID0gZmFsc2U7CiAgICAgICAgaWYgKHJlY2FsY19jb3VudGVyICE9IG51bGwpIHsKICAgICAgICAgIHJlY2FsY19jb3VudGVyIC09IDE7CiAgICAgICAgICBpZiAocmVjYWxjX2NvdW50ZXIgPD0gMCkgewogICAgICAgICAgICByZWNhbGNfY291bnRlciA9IHJlY2FsY19ldmVyeTsKICAgICAgICAgICAgcmVjYWxjKCk7CiAgICAgICAgICAgIHJlY2FsY2VkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFyZWNhbGNlZCAmJiBkb2MuaGVpZ2h0KCkgIT09IGxhc3Rfc2Nyb2xsX2hlaWdodCkgewogICAgICAgICAgcmVjYWxjKCk7CiAgICAgICAgICByZWNhbGNlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHNjcm9sbCA9IHdpbi5zY3JvbGxUb3AoKTsKICAgICAgICBpZiAobGFzdF9wb3MgIT0gbnVsbCkgewogICAgICAgICAgZGVsdGEgPSBzY3JvbGwgLSBsYXN0X3BvczsKICAgICAgICB9CiAgICAgICAgbGFzdF9wb3MgPSBzY3JvbGw7CiAgICAgICAgaWYgKGZpeGVkKSB7CiAgICAgICAgICBpZiAoZW5hYmxlX2JvdHRvbWluZykgewogICAgICAgICAgICB3aWxsX2JvdHRvbSA9IHNjcm9sbCArIGhlaWdodCArIG9mZnNldCA+IHBhcmVudF9oZWlnaHQgKyBwYXJlbnRfdG9wOwogICAgICAgICAgICBpZiAoYm90dG9tZWQgJiYgIXdpbGxfYm90dG9tKSB7CiAgICAgICAgICAgICAgYm90dG9tZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBlbG0uY3NzKHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAiZml4ZWQiLAogICAgICAgICAgICAgICAgYm90dG9tOiAiIiwKICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0CiAgICAgICAgICAgICAgfSkudHJpZ2dlcigic3RpY2t5X2tpdDp1bmJvdHRvbSIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc2Nyb2xsIDwgdG9wKSB7CiAgICAgICAgICAgIGZpeGVkID0gZmFsc2U7CiAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldF90b3A7CiAgICAgICAgICAgIGlmIChtYW51YWxfc3BhY2VyID09IG51bGwpIHsKICAgICAgICAgICAgICBpZiAoZWxfZmxvYXQgPT09ICJsZWZ0IiB8fCBlbF9mbG9hdCA9PT0gInJpZ2h0IikgewogICAgICAgICAgICAgICAgZWxtLmluc2VydEFmdGVyKHNwYWNlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNwYWNlci5kZXRhY2goKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjc3MgPSB7CiAgICAgICAgICAgICAgcG9zaXRpb246ICIiLAogICAgICAgICAgICAgIHdpZHRoOiAiIiwKICAgICAgICAgICAgICB0b3A6ICIiCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGVsbS5jc3MoY3NzKS5yZW1vdmVDbGFzcyhzdGlja3lfY2xhc3MpLnRyaWdnZXIoInN0aWNreV9raXQ6dW5zdGljayIpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGlubmVyX3Njcm9sbGluZykgewogICAgICAgICAgICB3aW5faGVpZ2h0ID0gd2luLmhlaWdodCgpOwogICAgICAgICAgICBpZiAoaGVpZ2h0ICsgb2Zmc2V0X3RvcCA+IHdpbl9oZWlnaHQpIHsKICAgICAgICAgICAgICBpZiAoIWJvdHRvbWVkKSB7CiAgICAgICAgICAgICAgICBvZmZzZXQgLT0gZGVsdGE7CiAgICAgICAgICAgICAgICBvZmZzZXQgPSBNYXRoLm1heCh3aW5faGVpZ2h0IC0gaGVpZ2h0LCBvZmZzZXQpOwogICAgICAgICAgICAgICAgb2Zmc2V0ID0gTWF0aC5taW4ob2Zmc2V0X3RvcCwgb2Zmc2V0KTsKICAgICAgICAgICAgICAgIGlmIChmaXhlZCkgewogICAgICAgICAgICAgICAgICBlbG0uY3NzKHsKICAgICAgICAgICAgICAgICAgICB0b3A6IG9mZnNldCArICJweCIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChzY3JvbGwgPiB0b3ApIHsKICAgICAgICAgICAgZml4ZWQgPSB0cnVlOwogICAgICAgICAgICBjc3MgPSB7CiAgICAgICAgICAgICAgcG9zaXRpb246ICJmaXhlZCIsCiAgICAgICAgICAgICAgdG9wOiBvZmZzZXQKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY3NzLndpZHRoID0gZWxtLmNzcygiYm94LXNpemluZyIpID09PSAiYm9yZGVyLWJveCIgPyBlbG0ub3V0ZXJXaWR0aCgpICsgInB4IiA6IGVsbS53aWR0aCgpICsgInB4IjsKICAgICAgICAgICAgZWxtLmNzcyhjc3MpLmFkZENsYXNzKHN0aWNreV9jbGFzcyk7CiAgICAgICAgICAgIGlmIChtYW51YWxfc3BhY2VyID09IG51bGwpIHsKICAgICAgICAgICAgICBlbG0uYWZ0ZXIoc3BhY2VyKTsKICAgICAgICAgICAgICBpZiAoZWxfZmxvYXQgPT09ICJsZWZ0IiB8fCBlbF9mbG9hdCA9PT0gInJpZ2h0IikgewogICAgICAgICAgICAgICAgc3BhY2VyLmFwcGVuZChlbG0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbG0udHJpZ2dlcigic3RpY2t5X2tpdDpzdGljayIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZml4ZWQgJiYgZW5hYmxlX2JvdHRvbWluZykgewogICAgICAgICAgaWYgKHdpbGxfYm90dG9tID09IG51bGwpIHsKICAgICAgICAgICAgd2lsbF9ib3R0b20gPSBzY3JvbGwgKyBoZWlnaHQgKyBvZmZzZXQgPiBwYXJlbnRfaGVpZ2h0ICsgcGFyZW50X3RvcDsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghYm90dG9tZWQgJiYgd2lsbF9ib3R0b20pIHsKICAgICAgICAgICAgYm90dG9tZWQgPSB0cnVlOwogICAgICAgICAgICBpZiAocGFyZW50LmNzcygicG9zaXRpb24iKSA9PT0gInN0YXRpYyIpIHsKICAgICAgICAgICAgICBwYXJlbnQuY3NzKHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAicmVsYXRpdmUiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGVsbS5jc3MoewogICAgICAgICAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgICAgICAgICAgIGJvdHRvbTogcGFkZGluZ19ib3R0b20sCiAgICAgICAgICAgICAgdG9wOiAiYXV0byIKICAgICAgICAgICAgfSkudHJpZ2dlcigic3RpY2t5X2tpdDpib3R0b20iKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICAgIHJlY2FsY19hbmRfdGljayA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJlY2FsYygpOwogICAgICAgIHJldHVybiB0aWNrKCk7CiAgICAgIH07CiAgICAgIGRldGFjaCA9IGZ1bmN0aW9uKCkgewogICAgICAgIGRldGFjaGVkID0gdHJ1ZTsKICAgICAgICB3aW4ub2ZmKCJ0b3VjaG1vdmUiLCB0aWNrKTsKICAgICAgICB3aW4ub2ZmKCJzY3JvbGwiLCB0aWNrKTsKICAgICAgICB3aW4ub2ZmKCJyZXNpemUiLCByZWNhbGNfYW5kX3RpY2spOwogICAgICAgICQoZG9jdW1lbnQuYm9keSkub2ZmKCJzdGlja3lfa2l0OnJlY2FsYyIsIHJlY2FsY19hbmRfdGljayk7CiAgICAgICAgZWxtLm9mZigic3RpY2t5X2tpdDpkZXRhY2giLCBkZXRhY2gpOwogICAgICAgIGVsbS5yZW1vdmVEYXRhKCJzdGlja3lfa2l0Iik7CiAgICAgICAgZWxtLmNzcyh7CiAgICAgICAgICBwb3NpdGlvbjogIiIsCiAgICAgICAgICBib3R0b206ICIiLAogICAgICAgICAgdG9wOiAiIiwKICAgICAgICAgIHdpZHRoOiAiIgogICAgICAgIH0pOwogICAgICAgIHBhcmVudC5wb3NpdGlvbigicG9zaXRpb24iLCAiIik7CiAgICAgICAgaWYgKGZpeGVkKSB7CiAgICAgICAgICBpZiAobWFudWFsX3NwYWNlciA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChlbF9mbG9hdCA9PT0gImxlZnQiIHx8IGVsX2Zsb2F0ID09PSAicmlnaHQiKSB7CiAgICAgICAgICAgICAgZWxtLmluc2VydEFmdGVyKHNwYWNlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3BhY2VyLnJlbW92ZSgpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGVsbS5yZW1vdmVDbGFzcyhzdGlja3lfY2xhc3MpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgd2luLm9uKCJ0b3VjaG1vdmUiLCB0aWNrKTsKICAgICAgd2luLm9uKCJzY3JvbGwiLCB0aWNrKTsKICAgICAgd2luLm9uKCJyZXNpemUiLCByZWNhbGNfYW5kX3RpY2spOwogICAgICAkKGRvY3VtZW50LmJvZHkpLm9uKCJzdGlja3lfa2l0OnJlY2FsYyIsIHJlY2FsY19hbmRfdGljayk7CiAgICAgIGVsbS5vbigic3RpY2t5X2tpdDpkZXRhY2giLCBkZXRhY2gpOwogICAgICByZXR1cm4gc2V0VGltZW91dCh0aWNrLCAwKTsKICAgIH07CiAgICBmb3IgKGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGVsbSA9IHRoaXNbaV07CiAgICAgIGZuKCQoZWxtKSk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9OwoKfSkuY2FsbCh0aGlzKTsK"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="soi" />
  <title>How To Use</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="data:text/css,body%20%7Bfont%2Dfamily%3A%20Helvetica%2C%20arial%2C%20sans%2Dserif%3Bfont%2Dsize%3A%2014px%3Bline%2Dheight%3A%201%2E6%3Bpadding%2Dtop%3A%2010px%3Bpadding%2Dbottom%3A%2010px%3Bbackground%2Dcolor%3A%20white%3Bpadding%3A%2030px%3B%7Dbody%3E%2A%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%20%21important%3B%7Dbody%3E%2A%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%20%21important%3B%7Da%20%7Bcolor%3A%20%234183C4%3B%7Da%2Eabsent%20%7Bcolor%3A%20%23cc0000%3B%7Da%2Eanchor%20%7Bdisplay%3A%20block%3Bpadding%2Dleft%3A%2030px%3Bmargin%2Dleft%3A%20%2D30px%3Bcursor%3A%20pointer%3Bposition%3A%20absolute%3Btop%3A%200%3Bleft%3A%200%3Bbottom%3A%200%3B%7Dh1%2Ch2%2Ch3%2Ch4%2Ch5%2Ch6%20%7Bmargin%3A%2020px%200%2010px%3Bpadding%3A%200%3Bfont%2Dweight%3A%20bold%3B%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3Bcursor%3A%20text%3Bposition%3A%20relative%3B%7Dh1%3Ahover%20a%2Eanchor%2Ch2%3Ahover%20a%2Eanchor%2Ch3%3Ahover%20a%2Eanchor%2Ch4%3Ahover%20a%2Eanchor%2Ch5%3Ahover%20a%2Eanchor%2Ch6%3Ahover%20a%2Eanchor%20%7Bbackground%3A%20url%28data%3Atext%2Fplain%3B%20charset%3Dutf%2D8%3Bcharset%3Dutf%2D8%2C404%253A%2520Not%2520Found%29%20no%2Drepeat%2010px%20center%3Btext%2Ddecoration%3A%20none%3B%7Dh1%20tt%2Ch1%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh2%20tt%2Ch2%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh3%20tt%2Ch3%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh4%20tt%2Ch4%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh5%20tt%2Ch5%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh6%20tt%2Ch6%20code%20%7Bfont%2Dsize%3A%20inherit%3B%7Dh1%20%7Bfont%2Dsize%3A%2028px%3Bcolor%3A%20black%3B%7Dh2%20%7Bfont%2Dsize%3A%2024px%3Bborder%2Dbottom%3A%201px%20solid%20%23cccccc%3Bcolor%3A%20black%3B%7Dh3%20%7Bfont%2Dsize%3A%2018px%3B%7Dh4%20%7Bfont%2Dsize%3A%2016px%3B%7Dh5%20%7Bfont%2Dsize%3A%2014px%3B%7Dh6%20%7Bcolor%3A%20%23777777%3Bfont%2Dsize%3A%2014px%3B%7Dp%2Cblockquote%2Cul%2Col%2Cdl%2Cli%2Ctable%2Cpre%20%7Bmargin%3A%2015px%200%3B%7Dhr%20%7Bbackground%3A%20transparent%20url%28data%3Atext%2Fplain%3B%20charset%3Dutf%2D8%3Bcharset%3Dutf%2D8%2C404%253A%2520Not%2520Found%29%20repeat%2Dx%200%200%3Bborder%3A%200%20none%3Bcolor%3A%20%23cccccc%3Bheight%3A%204px%3Bpadding%3A%200%3B%7Dbody%3Eh2%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3Bpadding%2Dtop%3A%200%3B%7Dbody%3Eh1%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3Bpadding%2Dtop%3A%200%3B%7Dbody%3Eh1%3Afirst%2Dchild%2Bh2%20%7Bmargin%2Dtop%3A%200%3Bpadding%2Dtop%3A%200%3B%7Dbody%3Eh3%3Afirst%2Dchild%2Cbody%3Eh4%3Afirst%2Dchild%2Cbody%3Eh5%3Afirst%2Dchild%2Cbody%3Eh6%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3Bpadding%2Dtop%3A%200%3B%7Da%3Afirst%2Dchild%20h1%2Ca%3Afirst%2Dchild%20h2%2Ca%3Afirst%2Dchild%20h3%2Ca%3Afirst%2Dchild%20h4%2Ca%3Afirst%2Dchild%20h5%2Ca%3Afirst%2Dchild%20h6%20%7Bmargin%2Dtop%3A%200%3Bpadding%2Dtop%3A%200%3B%7Dh1%20p%2Ch2%20p%2Ch3%20p%2Ch4%20p%2Ch5%20p%2Ch6%20p%20%7Bmargin%2Dtop%3A%200%3B%7Dli%20p%2Efirst%20%7Bdisplay%3A%20inline%2Dblock%3B%7Dul%2Col%20%7Bpadding%2Dleft%3A%2030px%3B%7Dul%20%3Afirst%2Dchild%2Col%20%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3B%7Dul%20%3Alast%2Dchild%2Col%20%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Ddl%20%7Bpadding%3A%200%3B%7Ddl%20dt%20%7Bfont%2Dsize%3A%2014px%3Bfont%2Dweight%3A%20bold%3Bfont%2Dstyle%3A%20italic%3Bpadding%3A%200%3Bmargin%3A%2015px%200%205px%3B%7Ddl%20dt%3Afirst%2Dchild%20%7Bpadding%3A%200%3B%7Ddl%20dt%3E%20%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3B%7Ddl%20dt%3E%20%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Ddl%20dd%20%7Bmargin%3A%200%200%2015px%3Bpadding%3A%200%2015px%3B%7Ddl%20dd%3E%20%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3B%7Ddl%20dd%3E%20%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Dblockquote%20%7Bborder%2Dleft%3A%204px%20solid%20%23dddddd%3Bpadding%3A%200%2015px%3Bcolor%3A%20%23777777%3B%7Dblockquote%3E%20%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3B%7Dblockquote%3E%20%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Dtable%20%7Bpadding%3A%200%3B%7Dtable%20tr%20%7Bborder%2Dtop%3A%201px%20solid%20%23cccccc%3Bbackground%2Dcolor%3A%20white%3Bmargin%3A%200%3Bpadding%3A%200%3B%7Dtable%20tr%3Anth%2Dchild%282n%29%20%7Bbackground%2Dcolor%3A%20%23f8f8f8%3B%7Dtable%20tr%20th%20%7Bfont%2Dweight%3A%20bold%3Bborder%3A%201px%20solid%20%23cccccc%3Btext%2Dalign%3A%20left%3Bmargin%3A%200%3Bpadding%3A%206px%2013px%3B%7Dtable%20tr%20td%20%7Bborder%3A%201px%20solid%20%23cccccc%3Btext%2Dalign%3A%20left%3Bmargin%3A%200%3Bpadding%3A%206px%2013px%3B%7Dtable%20tr%20th%20%3Afirst%2Dchild%2Ctable%20tr%20td%20%3Afirst%2Dchild%20%7Bmargin%2Dtop%3A%200%3B%7Dtable%20tr%20th%20%3Alast%2Dchild%2Ctable%20tr%20td%20%3Alast%2Dchild%20%7Bmargin%2Dbottom%3A%200%3B%7Dimg%20%7Bmax%2Dwidth%3A%20100%25%3B%7Dspan%2Eframe%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3B%7Dspan%2Eframe%3Espan%20%7Bborder%3A%201px%20solid%20%23dddddd%3Bdisplay%3A%20block%3Bfloat%3A%20left%3Boverflow%3A%20hidden%3Bmargin%3A%2013px%200%200%3Bpadding%3A%207px%3Bwidth%3A%20auto%3B%7Dspan%2Eframe%20span%20img%20%7Bdisplay%3A%20block%3Bfloat%3A%20left%3B%7Dspan%2Eframe%20span%20span%20%7Bclear%3A%20both%3Bcolor%3A%20%23333333%3Bdisplay%3A%20block%3Bpadding%3A%205px%200%200%3B%7Dspan%2Ealign%2Dcenter%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3Bclear%3A%20both%3B%7Dspan%2Ealign%2Dcenter%3Espan%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3Bmargin%3A%2013px%20auto%200%3Btext%2Dalign%3A%20center%3B%7Dspan%2Ealign%2Dcenter%20span%20img%20%7Bmargin%3A%200%20auto%3Btext%2Dalign%3A%20center%3B%7Dspan%2Ealign%2Dright%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3Bclear%3A%20both%3B%7Dspan%2Ealign%2Dright%3Espan%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3Bmargin%3A%2013px%200%200%3Btext%2Dalign%3A%20right%3B%7Dspan%2Ealign%2Dright%20span%20img%20%7Bmargin%3A%200%3Btext%2Dalign%3A%20right%3B%7Dspan%2Efloat%2Dleft%20%7Bdisplay%3A%20block%3Bmargin%2Dright%3A%2013px%3Boverflow%3A%20hidden%3Bfloat%3A%20left%3B%7Dspan%2Efloat%2Dleft%20span%20%7Bmargin%3A%2013px%200%200%3B%7Dspan%2Efloat%2Dright%20%7Bdisplay%3A%20block%3Bmargin%2Dleft%3A%2013px%3Boverflow%3A%20hidden%3Bfloat%3A%20right%3B%7Dspan%2Efloat%2Dright%3Espan%20%7Bdisplay%3A%20block%3Boverflow%3A%20hidden%3Bmargin%3A%2013px%20auto%200%3Btext%2Dalign%3A%20right%3B%7Dcode%2Ctt%20%7Bmargin%3A%200%202px%3Bpadding%3A%200%205px%3Bwhite%2Dspace%3A%20nowrap%3Bborder%3A%201px%20solid%20%23eaeaea%3Bbackground%2Dcolor%3A%20%23f8f8f8%3Bborder%2Dradius%3A%203px%3B%7Dpre%20code%20%7Bmargin%3A%200%3Bpadding%3A%200%3Bwhite%2Dspace%3A%20pre%3Bborder%3A%20none%3Bbackground%3A%20transparent%3B%7D%2Ehighlight%20pre%20%7Bbackground%2Dcolor%3A%20%23f8f8f8%3Bborder%3A%201px%20solid%20%23cccccc%3Bfont%2Dsize%3A%2013px%3Bline%2Dheight%3A%2019px%3Boverflow%3A%20auto%3Bpadding%3A%206px%2010px%3Bborder%2Dradius%3A%203px%3B%7Dpre%20%7Bbackground%2Dcolor%3A%20%23f8f8f8%3Bborder%3A%201px%20solid%20%23cccccc%3Bfont%2Dsize%3A%2013px%3Bline%2Dheight%3A%2019px%3Boverflow%3A%20auto%3Bpadding%3A%206px%2010px%3Bborder%2Dradius%3A%203px%3B%7Dpre%20code%2Cpre%20tt%20%7Bbackground%2Dcolor%3A%20transparent%3Bborder%3A%20none%3B%7Dkbd%20%7Bmargin%3A%200px%200%2E1em%3Bpadding%3A%203px%3Bfont%2Dsize%3A%2013px%3Bcolor%3A%20rgb%2836%2C%2039%2C%2041%29%3Bbackground%3A%20rgb%28255%2C%20255%2C%20255%29%3Bborder%3A%201px%20solid%20rgb%28173%2C%20179%2C%20185%29%3Bborder%2Dradius%3A%203px%3Bbox%2Dshadow%3A%20rgba%2812%2C%2013%2C%2014%2C%200%2E2%29%200px%201px%200px%2C%20rgb%28255%2C%20255%2C%20255%29%200px%200px%200px%202px%20inset%3Bwhite%2Dspace%3A%20nowrap%3Bvertical%2Dalign%3A%20middle%3B%7D" />
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">How To Use</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">soi</p></li>
                              <li><p class="navbar-text">2021/02/08</p></li>
                  </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">

        <ul>
        <li><a href="#schnellanleitung">Schnellanleitung</a></li>
        <li><a href="#geben-sie-die-zieldatei-an.">Geben Sie die Zieldatei an.</a>
        <ul>
        <li><a href="#dateien-durchsuchen">Dateien durchsuchen</a></li>
        <li><a href="#direkt-angeben">Direkt angeben</a></li>
        </ul></li>
        <li><a href="#einstellungen-umbenennen">Einstellungen umbenennen</a>
        <ul>
        <li><a href="#texte-lschen">Texte lschen</a>
        <ul>
        <li><a href="#regulren-ausdrcke">Regulren Ausdrcke</a></li>
        </ul></li>
        <li><a href="#ersetzungsmuster">Ersetzungsmuster</a>
        <ul>
        <li><a href="#regulrer-ausdruck">Regulrer Ausdruck</a></li>
        <li><a href="#filerenamerdiff-original-regex">FileRenamerDiff Original Regex</a></li>
        </ul></li>
        </ul></li>
        <li><a href="#besttigung-des-umbenennens">Besttigung des Umbenennens</a></li>
        <li><a href="#speichern-umbenennen">Speichern umbenennen</a></li>
        </ul>

        </div>
      </div>
            <div class="span9">
            <p><a href="https://github.com/soi013/FileRenamerDiff/blob/master/src/FileRenamerDiff/HowToUse/how_to_use.de.md">View Online</a></p>
            <h1 id="schnellanleitung">Schnellanleitung</h1>
            <ol type="1">
            <li><p>Spezifikation der Zieldatei: Sie knnen Dateien per Drag &amp; Drop in die Dateiliste ziehen oder nach <kbd>Filesuche</kbd> aus einem bestimmten Verzeichnis suchen.</p></li>
            <li><p>Muster fr das Umbenennen einstellen: Stellen Sie das Muster Lschen/Ersetzen unter <kbd>Einstellungen</kbd> ein.</p></li>
            <li><p>Umbenennen besttigen: Fhren Sie <kbd>Trockenlauf</kbd> aus, um das Umbenennen zu besttigen.</p></li>
            <li><p>Umbenennen ausfhren: Fhren Sie <kbd>Umbenennen Speichern</kbd> aus, um die aktuelle Datei umzubenennen.</p></li>
            </ol>
            <h1 id="geben-sie-die-zieldatei-an.">Geben Sie die Zieldatei an.</h1>
            <p>Sie knnen die Zieldatei, die umbenannt werden soll, auf zwei Arten angeben: &quot; Dateien durchsuchen&quot; oder Direkte Angabe.</p>
            <p>Um eine Datei aus der Zieldateiliste zu entfernen, klicken Sie auf die Schaltflche links in der Zeile. Sie knnen die Dateiliste auch leeren, indem Sie auf die Schaltflche oben links klicken.</p>
            <h2 id="dateien-durchsuchen">Dateien durchsuchen</h2>
            <p>Suchen Sie nach Dateien in einem beliebigen Ordner und fgen Sie sie der Liste der Zieldateien hinzu.</p>
            <p>Es gibt drei Mglichkeiten, nach Dateien zu suchen.</p>
            <ul>
            <li>Auswahl ber das Ordnersymbol in der oberen linken Ecke mit Hilfe des Dialogs.</li>
            <li>Ziehen Sie einen Ordner auf den Ordnerpfad in der oberen linken Ecke.</li>
            <li>Direkte Eingabe des Ordnerpfads in der oberen linken Ecke und Drcken der Schaltflche <kbd>Dateien durchsuchen</kbd>.</li>
            </ul>
            <p>Sie knnen die Bedingungen fr das Durchsuchen von Dateien unter <kbd>Einstellungen</kbd> &gt; <kbd>Filesuche</kbd> festlegen.</p>
            <h2 id="direkt-angeben">Direkt angeben</h2>
            <p>Geben Sie die Dateien, die umbenannt werden sollen, direkt an.</p>
            <p>Es gibt zwei Mglichkeiten, die Dateien direkt anzugeben.</p>
            <ul>
            <li>Verwenden Sie den obigen Dialog <kbd>Dateien hinzufgen</kbd>, um die Datei auszuwhlen.</li>
            <li>Ziehen Sie die Datei in die Dateiliste.</li>
            </ul>
            <h1 id="einstellungen-umbenennen">Einstellungen umbenennen</h1>
            <p>Legen Sie die Bedingungen fr das Umbenennen von Dateien fest.</p>
            <p>Die Ausfhrungsreihenfolge der Bedingungen ist Lschen  Ersetzen. Wenn Sie die Datei nach Ersetzen lschen mchten, lassen Sie <kbd>Text-ersetzen</kbd> in <kbd>Ersetzungsmuster</kbd> leer, was dem Lschen entspricht.</p>
            <h2 id="texte-lschen">Texte lschen</h2>
            <p>Geben Sie die zu lschenden Zeichen an.</p>
            <p><kbd>Hinzufgen</kbd> fgt eine neue Zeile ein. Sie knnen eine Zeile lschen, indem Sie auf die Schaltflche am rechten Rand der Zeile klicken. Um die Reihenfolge der Zeilen zu ndern, greifen Sie den linken Rand der Zeile und ziehen Sie.</p>
            <p>Sie knnen das Common Pattern auswhlen, indem Sie auf die Schaltflche unten rechts klicken.</p>
            <p>Wenn das Kontrollkstchen Regulrer Ausdruck aktiviert ist, knnen Sie die zu lschenden Zeichen mithilfe eines regulren Ausdrucks angeben.</p>
            <h3 id="regulren-ausdrcke">Regulren Ausdrcke</h3>
            <p>Die regulren Ausdrcke (Regex) in dieser Software verwenden Microsoft .NET regulre Ausdrcke. Im Folgenden finden Sie eine Liste mit typischen Ausdrcken. Eine ausfhrlichere Erklrung finden Sie unter den folgenden Links.</p>
            <p><a href="https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference#character-escapes">Regex Quick Reference - Microsoft Docs</a></p>
            <table style="width:100%;">
            <colgroup>
            <col style="width: 15%" />
            <col style="width: 50%" />
            <col style="width: 6%" />
            <col style="width: 12%" />
            <col style="width: 15%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Regex</th>
            <th>Beschreibung</th>
            <th>Muster</th>
            <th>Eingabe</th>
            <th>Ausgabe</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td><code>[</code>ch_group<code>]</code></td>
            <td>Passt auf jedes einzelne Zeichen in <em>ch_group</em>.</td>
            <td>[ae]</td>
            <td>gr<strong>a</strong>y, L<strong>A</strong>N<strong>E</strong></td>
            <td>gry,LN</td>
            </tr>
            <tr class="even">
            <td><code>[</code>first<code>-</code>last<code>]</code></td>
            <td>Zeichenbereich: Passt auf jedes einzelne Zeichen im Bereich von <em>first</em> bis <em>last</em>.</td>
            <td>[A-Z]</td>
            <td><strong>R</strong>ocky4</td>
            <td>ocky4</td>
            </tr>
            <tr class="odd">
            <td><code>.</code></td>
            <td>Platzhalterzeichen: Passt auf jedes einzelne Zeichen</td>
            <td>a.e</td>
            <td>w<strong>ate</strong>r</td>
            <td>wr</td>
            </tr>
            <tr class="even">
            <td><code>\w</code></td>
            <td>Entspricht einem beliebigen Wortzeichen</td>
            <td>\w</td>
            <td><strong>A</strong>.<strong>a</strong> <strong></strong>~<strong></strong>-</td>
            <td>. ~-</td>
            </tr>
            <tr class="odd">
            <td><code>\s</code></td>
            <td>Entspricht einem beliebigen Zeichen mit Leerzeichen</td>
            <td>\s</td>
            <td>A BC</td>
            <td>ABC</td>
            </tr>
            <tr class="even">
            <td><code>\d</code></td>
            <td>Entspricht einer beliebigen Dezimalziffer</td>
            <td>\d</td>
            <td>Rocky<strong>4</strong></td>
            <td>Rocky</td>
            </tr>
            <tr class="odd">
            <td><code>^</code></td>
            <td>Die Suche muss am Anfang des Dateinamens beginnen</td>
            <td>^r</td>
            <td><strong>r</strong>ear rock</td>
            <td>ear rock</td>
            </tr>
            <tr class="even">
            <td><code>$</code></td>
            <td>bereinstimmung muss am Ende des Dateinamens stehen</td>
            <td>$r</td>
            <td>rock rea<strong>r</strong></td>
            <td>rock rea</td>
            </tr>
            <tr class="odd">
            <td><code>*</code></td>
            <td>Entspricht dem vorherigen Element null oder mehr Mal</td>
            <td>o*r</td>
            <td>d<strong>oor</strong>,<strong>or</strong>,o,l<strong>r</strong></td>
            <td>d,,o,l</td>
            </tr>
            <tr class="even">
            <td><code>+</code></td>
            <td>Entspricht dem vorhergehenden Element ein oder mehrere Male</td>
            <td>o+r</td>
            <td>d<strong>oor</strong>,<strong>or</strong>,o,lr</td>
            <td>d,,o,lr</td>
            </tr>
            <tr class="odd">
            <td><code>?</code></td>
            <td>Stimmt mit dem vorherigen Element null oder ein Mal berein</td>
            <td>o?r</td>
            <td>do<strong>or</strong>,<strong>or</strong>,o,l<strong>r</strong></td>
            <td>do,,o,l</td>
            </tr>
            <tr class="even">
            <td><code>{</code>n<code>}</code></td>
            <td>Passt genau <em>n</em> Mal auf das vorhergehende Element</td>
            <td>[or]{2}</td>
            <td>d<strong>oo</strong>r,<strong>or</strong>,o,lr</td>
            <td>dr,,o,lr</td>
            </tr>
            <tr class="odd">
            <td><code>\</code>escape</td>
            <td>Erkennen von Escape-Zeichen wie z. B. <code>.</code> und <code>*</code> als normale Zeichen.</td>
            <td>\d\.\d</td>
            <td>1_<strong>2.3</strong>_45</td>
            <td>1__45</td>
            </tr>
            </tbody>
            </table>
            <h2 id="ersetzungsmuster">Ersetzungsmuster</h2>
            <p>Gibt das Muster vor und nach der Ersetzung an.</p>
            <p><kbd>Hinzufgen</kbd> fgt eine neue Zeile ein. Sie knnen eine Zeile lschen, indem Sie mit der rechten Taste in die Zeile klicken. Um die Reihenfolge der Zeilen zu ndern, greifen Sie den linken Rand der Zeile und ziehen Sie.</p>
            <p>Sie knnen das Common Pattern auswhlen, indem Sie auf die Schaltflche unten rechts klicken.</p>
            <p>Wenn <kbd>Regulrer Ausdruck</kbd> aktiviert ist, knnen Sie das Ersetzungsmuster mit einem regulren Ausdruck angeben.</p>
            <h3 id="regulrer-ausdruck">Regulrer Ausdruck</h3>
            <p>Der regulre Ausdruck vor der Ersetzung ist der gleiche wie <kbd>Zu lschen Texte</kbd>.</p>
            <p>Es gibt auch regulre Ausdrcke, die nach der Ersetzung verwendet werden knnen. Einige der gebruchlichsten sind unten aufgefhrt.Eine genauere Erluterung finden Sie unter den folgenden Links.</p>
            <p><a href="https://docs.microsoft.com/dotnet/standard/base-types/substitutions-in-regular-expressions">Substitutions In Regular Expressions - Microsoft Docs</a></p>
            <table>
            <colgroup>
            <col style="width: 5%" />
            <col style="width: 50%" />
            <col style="width: 9%" />
            <col style="width: 10%" />
            <col style="width: 11%" />
            <col style="width: 13%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Regex</th>
            <th>Beschreibung</th>
            <th>Zieltext</th>
            <th>Text-ersetzen</th>
            <th>Eingabe</th>
            <th>Ausgabe</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td><code>$0</code></td>
            <td>Include all matching strings in the replacement string</td>
            <td>ABC</td>
            <td>[$0]</td>
            <td>x<strong>ABC</strong>x_AxBC</td>
            <td>x<strong>[ABC]</strong>x_AxBC</td>
            </tr>
            <tr class="even">
            <td><code>$num</code></td>
            <td>Includes the last substring matched by the capturing group that is identified by <em>num</em></td>
            <td>\d*(\d{3})</td>
            <td>$1</td>
            <td>A<strong>0012</strong> 34</td>
            <td>A<strong>012</strong> 34</td>
            </tr>
            </tbody>
            </table>
            <h3 id="filerenamerdiff-original-regex">FileRenamerDiff Original Regex</h3>
            <p>Dies ist ein regulrer Ausdruck, der nur in dieser Anwendung vorkommt und nicht in Microsoft .NET.</p>
            <table>
            <colgroup>
            <col style="width: 10%" />
            <col style="width: 47%" />
            <col style="width: 18%" />
            <col style="width: 23%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Regex</th>
            <th>Beschreibung</th>
            <th>Eingabe</th>
            <th>Ausgabe</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td><code>\u</code></td>
            <td>Allen Text in Grobuchstaben umwandeln</td>
            <td>l<strong>ow</strong> UPP P<strong>as</strong></td>
            <td>L<strong>OW</strong> UPP P<strong>AS</strong></td>
            </tr>
            <tr class="even">
            <td><code>\l</code></td>
            <td>Allen Text in Kleinbuchstaben umwandeln</td>
            <td>low <strong>UPP</strong> <strong>P</strong>as</td>
            <td>low <strong>upp</strong> <strong>p</strong>as</td>
            </tr>
            <tr class="odd">
            <td><code>\h</code></td>
            <td>Alle Buchstaben und Zahlen in Zeichen halber Breite umwandeln</td>
            <td>Ha14 <strong></strong></td>
            <td>Ha14 <strong>Fu17</strong></td>
            </tr>
            <tr class="even">
            <td><code>\f</code></td>
            <td>Alle Buchstaben und Zahlen in Zeichen normaler Breite umwandeln</td>
            <td><strong>Ha14</strong> </td>
            <td><strong></strong> </td>
            </tr>
            <tr class="odd">
            <td><code>\f</code></td>
            <td>Konvertiere alle Katakana halber Breite in volle Breite</td>
            <td><strong> </strong></td>
            <td><strong> </strong></td>
            </tr>
            <tr class="even">
            <td><code>\n</code></td>
            <td>Umlaute in Klarschriftzeichen umwandeln</td>
            <td>s<strong></strong> <strong></strong>L <strong></strong>ra</td>
            <td>s<strong>uess</strong> <strong>OE</strong>L <strong>Ae</strong>ra</td>
            </tr>
            </tbody>
            </table>
            <h1 id="besttigung-des-umbenennens">Besttigung des Umbenennens</h1>
            <p><kbd>Trockenlauf</kbd> ermglicht es Ihnen, die Dateien vor und nach dem Umbenennen zu sehen.</p>
            <p>Die Beschreibung der einzelnen Spalten in der Dateiliste lautet wie folgt.</p>
            <table>
            <colgroup>
            <col style="width: 15%" />
            <col style="width: 42%" />
            <col style="width: 42%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Spaltenname</th>
            <th>Angezeigter Inhalt</th>
            <th>Funktion</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Lschen-Schaltflche</td>
            <td>Lschen-Schaltflche</td>
            <td>Lschen der Zeile. Die Schaltflche in der Kopfzeile lscht alle Dateien.</td>
            </tr>
            <tr class="even">
            <td>Alter Dateiname</td>
            <td>Dateiname vor dem Umbenennen. Der genderte Teil wird rosa hinterlegt.</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>Neuer Dateiname</td>
            <td>Dateiname nach dem Umbenennen. Der genderte Teil wird grn hinterlegt.</td>
            <td></td>
            </tr>
            <tr class="even">
            <td>Hkchen</td>
            <td>Ein Hkchen wird angezeigt, wenn es nderungen gibt.</td>
            <td>Die Schaltflche in der Kopfzeile macht die Datei-Liste nur mit nderungen.</td>
            </tr>
            <tr class="odd">
            <td>Mit Duplikat markieren</td>
            <td>Wenn es Duplikate gibt, wird eine Duplikatmarkierung angezeigt.</td>
            <td>Die Schaltflche in der Kopfzeile bewirkt, dass die Dateiliste nur mit Duplikaten angezeigt wird.</td>
            </tr>
            <tr class="even">
            <td>Verzeichnis</td>
            <td>Verzeichnis, zu dem die Datei gehrt</td>
            <td>Anklicken, um die Datei im Explorer anzuzeigen</td>
            </tr>
            <tr class="odd">
            <td>Gre</td>
            <td>Gre der Datei</td>
            <td></td>
            </tr>
            <tr class="even">
            <td>nderungsdatum</td>
            <td>Datum und Uhrzeit der nderung der Datei</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>Erstellungsdatum</td>
            <td>Datum und Uhrzeit der Erstellung der Datei</td>
            <td></td>
            </tr>
            </tbody>
            </table>
            <h1 id="speichern-umbenennen">Speichern umbenennen</h1>
            <p><kbd>UmbenennenSpeichern</kbd> wird die aktuelle Datei umbenennen. Kann nicht ausgefhrt werden, wenn es Duplikate in der Dateiliste gibt.</p>
            <p>Wenn das Verzeichnis, zu dem die Datei gehrt, beim Umbenennen neu geschrieben wird, wird sie aus der Dateiliste entfernt.</p>
            </div>
    </div>
  </div>

  <script src="data:application/javascript; charset=utf-8;base64,LyoqCiAqIEBsaWNlbnNlCiAqIFZpZGVvLmpzIDUuNC40IDxodHRwOi8vdmlkZW9qcy5jb20vPgogKiBDb3B5cmlnaHQgQnJpZ2h0Y292ZSwgSW5jLiA8aHR0cHM6Ly93d3cuYnJpZ2h0Y292ZS5jb20vPgogKiBBdmFpbGFibGUgdW5kZXIgQXBhY2hlIExpY2Vuc2UgVmVyc2lvbiAyLjAKICogPGh0dHBzOi8vZ2l0aHViLmNvbS92aWRlb2pzL3ZpZGVvLmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0U+CiAqCiAqIEluY2x1ZGVzIHZ0dC5qcyA8aHR0cHM6Ly9naXRodWIuY29tL21vemlsbGEvdnR0LmpzPgogKiBBdmFpbGFibGUgdW5kZXIgQXBhY2hlIExpY2Vuc2UgVmVyc2lvbiAyLjAKICogPGh0dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL3Z0dC5qcy9ibG9iL21hc3Rlci9MSUNFTlNFPgogKi8KCihmdW5jdGlvbihmKXtpZih0eXBlb2YgZXhwb3J0cz09PSJvYmplY3QiJiZ0eXBlb2YgbW9kdWxlIT09InVuZGVmaW5lZCIpe21vZHVsZS5leHBvcnRzPWYoKX1lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT0iZnVuY3Rpb24iJiZkZWZpbmUuYW1kKXtkZWZpbmUoW10sZil9ZWxzZXt2YXIgZztpZih0eXBlb2Ygd2luZG93IT09InVuZGVmaW5lZCIpe2c9d2luZG93fWVsc2UgaWYodHlwZW9mIGdsb2JhbCE9PSJ1bmRlZmluZWQiKXtnPWdsb2JhbH1lbHNlIGlmKHR5cGVvZiBzZWxmIT09InVuZGVmaW5lZCIpe2c9c2VsZn1lbHNle2c9dGhpc31nLnZpZGVvanMgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewp2YXIgdG9wTGV2ZWwgPSB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6CiAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHt9CnZhciBtaW5Eb2MgPSBfZGVyZXFfKCdtaW4tZG9jdW1lbnQnKTsKCmlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7CiAgICBtb2R1bGUuZXhwb3J0cyA9IGRvY3VtZW50Owp9IGVsc2UgewogICAgdmFyIGRvY2N5ID0gdG9wTGV2ZWxbJ19fR0xPQkFMX0RPQ1VNRU5UX0NBQ0hFQDQnXTsKCiAgICBpZiAoIWRvY2N5KSB7CiAgICAgICAgZG9jY3kgPSB0b3BMZXZlbFsnX19HTE9CQUxfRE9DVU1FTlRfQ0FDSEVANCddID0gbWluRG9jOwogICAgfQoKICAgIG1vZHVsZS5leHBvcnRzID0gZG9jY3k7Cn0KCn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSAidW5kZWZpbmVkIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiA/IHdpbmRvdyA6IHt9KQovLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldDp1dGYtODtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbTV2WkdWZmJXOWtkV3hsY3k5bmJHOWlZV3d2Wkc5amRXMWxiblF1YW5NaVhTd2libUZ0WlhNaU9sdGRMQ0p0WVhCd2FXNW5jeUk2SWp0QlFVRkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CSWl3aVptbHNaU0k2SW1kbGJtVnlZWFJsWkM1cWN5SXNJbk52ZFhKalpWSnZiM1FpT2lJaUxDSnpiM1Z5WTJWelEyOXVkR1Z1ZENJNld5SjJZWElnZEc5d1RHVjJaV3dnUFNCMGVYQmxiMllnWjJ4dlltRnNJQ0U5UFNBbmRXNWtaV1pwYm1Wa0p5QS9JR2RzYjJKaGJDQTZYRzRnSUNBZ2RIbHdaVzltSUhkcGJtUnZkeUFoUFQwZ0ozVnVaR1ZtYVc1bFpDY2dQeUIzYVc1a2IzY2dPaUI3ZlZ4dWRtRnlJRzFwYmtSdll5QTlJSEpsY1hWcGNtVW9KMjFwYmkxa2IyTjFiV1Z1ZENjcE8xeHVYRzVwWmlBb2RIbHdaVzltSUdSdlkzVnRaVzUwSUNFOVBTQW5kVzVrWldacGJtVmtKeWtnZTF4dUlDQWdJRzF2WkhWc1pTNWxlSEJ2Y25SeklEMGdaRzlqZFcxbGJuUTdYRzU5SUdWc2MyVWdlMXh1SUNBZ0lIWmhjaUJrYjJOamVTQTlJSFJ2Y0V4bGRtVnNXeWRmWDBkTVQwSkJURjlFVDBOVlRVVk9WRjlEUVVOSVJVQTBKMTA3WEc1Y2JpQWdJQ0JwWmlBb0lXUnZZMk41S1NCN1hHNGdJQ0FnSUNBZ0lHUnZZMk41SUQwZ2RHOXdUR1YyWld4YkoxOWZSMHhQUWtGTVgwUlBRMVZOUlU1VVgwTkJRMGhGUURRblhTQTlJRzFwYmtSdll6dGNiaUFnSUNCOVhHNWNiaUFnSUNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdSdlkyTjVPMXh1ZlZ4dUlsMTkKfSx7Im1pbi1kb2N1bWVudCI6M31dLDI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CmlmICh0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIikgewogICAgbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3c7Cn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIpIHsKICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsOwp9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIil7CiAgICBtb2R1bGUuZXhwb3J0cyA9IHNlbGY7Cn0gZWxzZSB7CiAgICBtb2R1bGUuZXhwb3J0cyA9IHt9Owp9Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ6dXRmLTg7YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0p6YjNWeVkyVnpJanBiSW01dlpHVmZiVzlrZFd4bGN5OW5iRzlpWVd3dmQybHVaRzkzTG1weklsMHNJbTVoYldWeklqcGJYU3dpYldGd2NHbHVaM01pT2lJN1FVRkJRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU0lzSW1acGJHVWlPaUpuWlc1bGNtRjBaV1F1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sYzBOdmJuUmxiblFpT2xzaWFXWWdLSFI1Y0dWdlppQjNhVzVrYjNjZ0lUMDlJRndpZFc1a1pXWnBibVZrWENJcElIdGNiaUFnSUNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhkcGJtUnZkenRjYm4wZ1pXeHpaU0JwWmlBb2RIbHdaVzltSUdkc2IySmhiQ0FoUFQwZ1hDSjFibVJsWm1sdVpXUmNJaWtnZTF4dUlDQWdJRzF2WkhWc1pTNWxlSEJ2Y25SeklEMGdaMnh2WW1Gc08xeHVmU0JsYkhObElHbG1JQ2gwZVhCbGIyWWdjMlZzWmlBaFBUMGdYQ0oxYm1SbFptbHVaV1JjSWlsN1hHNGdJQ0FnYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0J6Wld4bU8xeHVmU0JsYkhObElIdGNiaUFnSUNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUh0OU8xeHVmVnh1SWwxOQp9LHt9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKCn0se31dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgZ2V0TmF0aXZlID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvZ2V0TmF0aXZlJyk7CgovKiBOYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqLwp2YXIgbmF0aXZlTm93ID0gZ2V0TmF0aXZlKERhdGUsICdub3cnKTsKCi8qKgogKiBHZXRzIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRoYXQgaGF2ZSBlbGFwc2VkIHNpbmNlIHRoZSBVbml4IGVwb2NoCiAqICgxIEphbnVhcnkgMTk3MCAwMDowMDowMCBVVEMpLgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBEYXRlCiAqIEBleGFtcGxlCiAqCiAqIF8uZGVmZXIoZnVuY3Rpb24oc3RhbXApIHsKICogICBjb25zb2xlLmxvZyhfLm5vdygpIC0gc3RhbXApOwogKiB9LCBfLm5vdygpKTsKICogLy8gPT4gbG9ncyB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBpdCB0b29rIGZvciB0aGUgZGVmZXJyZWQgZnVuY3Rpb24gdG8gYmUgaW52b2tlZAogKi8KdmFyIG5vdyA9IG5hdGl2ZU5vdyB8fCBmdW5jdGlvbigpIHsKICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IG5vdzsKCn0seyIuLi9pbnRlcm5hbC9nZXROYXRpdmUiOjIwfV0sNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBpc09iamVjdCA9IF9kZXJlcV8oJy4uL2xhbmcvaXNPYmplY3QnKSwKICAgIG5vdyA9IF9kZXJlcV8oJy4uL2RhdGUvbm93Jyk7CgovKiogVXNlZCBhcyB0aGUgYFR5cGVFcnJvcmAgbWVzc2FnZSBmb3IgIkZ1bmN0aW9ucyIgbWV0aG9kcy4gKi8KdmFyIEZVTkNfRVJST1JfVEVYVCA9ICdFeHBlY3RlZCBhIGZ1bmN0aW9uJzsKCi8qIE5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcyBmb3IgdGhvc2Ugd2l0aCB0aGUgc2FtZSBuYW1lIGFzIG90aGVyIGBsb2Rhc2hgIG1ldGhvZHMuICovCnZhciBuYXRpdmVNYXggPSBNYXRoLm1heDsKCi8qKgogKiBDcmVhdGVzIGEgZGVib3VuY2VkIGZ1bmN0aW9uIHRoYXQgZGVsYXlzIGludm9raW5nIGBmdW5jYCB1bnRpbCBhZnRlciBgd2FpdGAKICogbWlsbGlzZWNvbmRzIGhhdmUgZWxhcHNlZCBzaW5jZSB0aGUgbGFzdCB0aW1lIHRoZSBkZWJvdW5jZWQgZnVuY3Rpb24gd2FzCiAqIGludm9rZWQuIFRoZSBkZWJvdW5jZWQgZnVuY3Rpb24gY29tZXMgd2l0aCBhIGBjYW5jZWxgIG1ldGhvZCB0byBjYW5jZWwKICogZGVsYXllZCBpbnZvY2F0aW9ucy4gUHJvdmlkZSBhbiBvcHRpb25zIG9iamVjdCB0byBpbmRpY2F0ZSB0aGF0IGBmdW5jYAogKiBzaG91bGQgYmUgaW52b2tlZCBvbiB0aGUgbGVhZGluZyBhbmQvb3IgdHJhaWxpbmcgZWRnZSBvZiB0aGUgYHdhaXRgIHRpbWVvdXQuCiAqIFN1YnNlcXVlbnQgY2FsbHMgdG8gdGhlIGRlYm91bmNlZCBmdW5jdGlvbiByZXR1cm4gdGhlIHJlc3VsdCBvZiB0aGUgbGFzdAogKiBgZnVuY2AgaW52b2NhdGlvbi4KICoKICogKipOb3RlOioqIElmIGBsZWFkaW5nYCBhbmQgYHRyYWlsaW5nYCBvcHRpb25zIGFyZSBgdHJ1ZWAsIGBmdW5jYCBpcyBpbnZva2VkCiAqIG9uIHRoZSB0cmFpbGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0IG9ubHkgaWYgdGhlIHRoZSBkZWJvdW5jZWQgZnVuY3Rpb24gaXMKICogaW52b2tlZCBtb3JlIHRoYW4gb25jZSBkdXJpbmcgdGhlIGB3YWl0YCB0aW1lb3V0LgogKgogKiBTZWUgW0RhdmlkIENvcmJhY2hvJ3MgYXJ0aWNsZV0oaHR0cDovL2RydXBhbG1vdGlvbi5jb20vYXJ0aWNsZS9kZWJvdW5jZS1hbmQtdGhyb3R0bGUtdmlzdWFsLWV4cGxhbmF0aW9uKQogKiBmb3IgZGV0YWlscyBvdmVyIHRoZSBkaWZmZXJlbmNlcyBiZXR3ZWVuIGBfLmRlYm91bmNlYCBhbmQgYF8udGhyb3R0bGVgLgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBGdW5jdGlvbgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBkZWJvdW5jZS4KICogQHBhcmFtIHtudW1iZXJ9IFt3YWl0PTBdIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIGRlbGF5LgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIFRoZSBvcHRpb25zIG9iamVjdC4KICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5sZWFkaW5nPWZhbHNlXSBTcGVjaWZ5IGludm9raW5nIG9uIHRoZSBsZWFkaW5nCiAqICBlZGdlIG9mIHRoZSB0aW1lb3V0LgogKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMubWF4V2FpdF0gVGhlIG1heGltdW0gdGltZSBgZnVuY2AgaXMgYWxsb3dlZCB0byBiZQogKiAgZGVsYXllZCBiZWZvcmUgaXQncyBpbnZva2VkLgogKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnRyYWlsaW5nPXRydWVdIFNwZWNpZnkgaW52b2tpbmcgb24gdGhlIHRyYWlsaW5nCiAqICBlZGdlIG9mIHRoZSB0aW1lb3V0LgogKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBkZWJvdW5jZWQgZnVuY3Rpb24uCiAqIEBleGFtcGxlCiAqCiAqIC8vIGF2b2lkIGNvc3RseSBjYWxjdWxhdGlvbnMgd2hpbGUgdGhlIHdpbmRvdyBzaXplIGlzIGluIGZsdXgKICogalF1ZXJ5KHdpbmRvdykub24oJ3Jlc2l6ZScsIF8uZGVib3VuY2UoY2FsY3VsYXRlTGF5b3V0LCAxNTApKTsKICoKICogLy8gaW52b2tlIGBzZW5kTWFpbGAgd2hlbiB0aGUgY2xpY2sgZXZlbnQgaXMgZmlyZWQsIGRlYm91bmNpbmcgc3Vic2VxdWVudCBjYWxscwogKiBqUXVlcnkoJyNwb3N0Ym94Jykub24oJ2NsaWNrJywgXy5kZWJvdW5jZShzZW5kTWFpbCwgMzAwLCB7CiAqICAgJ2xlYWRpbmcnOiB0cnVlLAogKiAgICd0cmFpbGluZyc6IGZhbHNlCiAqIH0pKTsKICoKICogLy8gZW5zdXJlIGBiYXRjaExvZ2AgaXMgaW52b2tlZCBvbmNlIGFmdGVyIDEgc2Vjb25kIG9mIGRlYm91bmNlZCBjYWxscwogKiB2YXIgc291cmNlID0gbmV3IEV2ZW50U291cmNlKCcvc3RyZWFtJyk7CiAqIGpRdWVyeShzb3VyY2UpLm9uKCdtZXNzYWdlJywgXy5kZWJvdW5jZShiYXRjaExvZywgMjUwLCB7CiAqICAgJ21heFdhaXQnOiAxMDAwCiAqIH0pKTsKICoKICogLy8gY2FuY2VsIGEgZGVib3VuY2VkIGNhbGwKICogdmFyIHRvZG9DaGFuZ2VzID0gXy5kZWJvdW5jZShiYXRjaExvZywgMTAwMCk7CiAqIE9iamVjdC5vYnNlcnZlKG1vZGVscy50b2RvLCB0b2RvQ2hhbmdlcyk7CiAqCiAqIE9iamVjdC5vYnNlcnZlKG1vZGVscywgZnVuY3Rpb24oY2hhbmdlcykgewogKiAgIGlmIChfLmZpbmQoY2hhbmdlcywgeyAndXNlcic6ICd0b2RvJywgJ3R5cGUnOiAnZGVsZXRlJ30pKSB7CiAqICAgICB0b2RvQ2hhbmdlcy5jYW5jZWwoKTsKICogICB9CiAqIH0sIFsnZGVsZXRlJ10pOwogKgogKiAvLyAuLi5hdCBzb21lIHBvaW50IGBtb2RlbHMudG9kb2AgaXMgY2hhbmdlZAogKiBtb2RlbHMudG9kby5jb21wbGV0ZWQgPSB0cnVlOwogKgogKiAvLyAuLi5iZWZvcmUgMSBzZWNvbmQgaGFzIHBhc3NlZCBgbW9kZWxzLnRvZG9gIGlzIGRlbGV0ZWQKICogLy8gd2hpY2ggY2FuY2VscyB0aGUgZGVib3VuY2VkIGB0b2RvQ2hhbmdlc2AgY2FsbAogKiBkZWxldGUgbW9kZWxzLnRvZG87CiAqLwpmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0LCBvcHRpb25zKSB7CiAgdmFyIGFyZ3MsCiAgICAgIG1heFRpbWVvdXRJZCwKICAgICAgcmVzdWx0LAogICAgICBzdGFtcCwKICAgICAgdGhpc0FyZywKICAgICAgdGltZW91dElkLAogICAgICB0cmFpbGluZ0NhbGwsCiAgICAgIGxhc3RDYWxsZWQgPSAwLAogICAgICBtYXhXYWl0ID0gZmFsc2UsCiAgICAgIHRyYWlsaW5nID0gdHJ1ZTsKCiAgaWYgKHR5cGVvZiBmdW5jICE9ICdmdW5jdGlvbicpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTsKICB9CiAgd2FpdCA9IHdhaXQgPCAwID8gMCA6ICgrd2FpdCB8fCAwKTsKICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkgewogICAgdmFyIGxlYWRpbmcgPSB0cnVlOwogICAgdHJhaWxpbmcgPSBmYWxzZTsKICB9IGVsc2UgaWYgKGlzT2JqZWN0KG9wdGlvbnMpKSB7CiAgICBsZWFkaW5nID0gISFvcHRpb25zLmxlYWRpbmc7CiAgICBtYXhXYWl0ID0gJ21heFdhaXQnIGluIG9wdGlvbnMgJiYgbmF0aXZlTWF4KCtvcHRpb25zLm1heFdhaXQgfHwgMCwgd2FpdCk7CiAgICB0cmFpbGluZyA9ICd0cmFpbGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy50cmFpbGluZyA6IHRyYWlsaW5nOwogIH0KCiAgZnVuY3Rpb24gY2FuY2VsKCkgewogICAgaWYgKHRpbWVvdXRJZCkgewogICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsKICAgIH0KICAgIGlmIChtYXhUaW1lb3V0SWQpIHsKICAgICAgY2xlYXJUaW1lb3V0KG1heFRpbWVvdXRJZCk7CiAgICB9CiAgICBsYXN0Q2FsbGVkID0gMDsKICAgIG1heFRpbWVvdXRJZCA9IHRpbWVvdXRJZCA9IHRyYWlsaW5nQ2FsbCA9IHVuZGVmaW5lZDsKICB9CgogIGZ1bmN0aW9uIGNvbXBsZXRlKGlzQ2FsbGVkLCBpZCkgewogICAgaWYgKGlkKSB7CiAgICAgIGNsZWFyVGltZW91dChpZCk7CiAgICB9CiAgICBtYXhUaW1lb3V0SWQgPSB0aW1lb3V0SWQgPSB0cmFpbGluZ0NhbGwgPSB1bmRlZmluZWQ7CiAgICBpZiAoaXNDYWxsZWQpIHsKICAgICAgbGFzdENhbGxlZCA9IG5vdygpOwogICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpOwogICAgICBpZiAoIXRpbWVvdXRJZCAmJiAhbWF4VGltZW91dElkKSB7CiAgICAgICAgYXJncyA9IHRoaXNBcmcgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGRlbGF5ZWQoKSB7CiAgICB2YXIgcmVtYWluaW5nID0gd2FpdCAtIChub3coKSAtIHN0YW1wKTsKICAgIGlmIChyZW1haW5pbmcgPD0gMCB8fCByZW1haW5pbmcgPiB3YWl0KSB7CiAgICAgIGNvbXBsZXRlKHRyYWlsaW5nQ2FsbCwgbWF4VGltZW91dElkKTsKICAgIH0gZWxzZSB7CiAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZGVsYXllZCwgcmVtYWluaW5nKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIG1heERlbGF5ZWQoKSB7CiAgICBjb21wbGV0ZSh0cmFpbGluZywgdGltZW91dElkKTsKICB9CgogIGZ1bmN0aW9uIGRlYm91bmNlZCgpIHsKICAgIGFyZ3MgPSBhcmd1bWVudHM7CiAgICBzdGFtcCA9IG5vdygpOwogICAgdGhpc0FyZyA9IHRoaXM7CiAgICB0cmFpbGluZ0NhbGwgPSB0cmFpbGluZyAmJiAodGltZW91dElkIHx8ICFsZWFkaW5nKTsKCiAgICBpZiAobWF4V2FpdCA9PT0gZmFsc2UpIHsKICAgICAgdmFyIGxlYWRpbmdDYWxsID0gbGVhZGluZyAmJiAhdGltZW91dElkOwogICAgfSBlbHNlIHsKICAgICAgaWYgKCFtYXhUaW1lb3V0SWQgJiYgIWxlYWRpbmcpIHsKICAgICAgICBsYXN0Q2FsbGVkID0gc3RhbXA7CiAgICAgIH0KICAgICAgdmFyIHJlbWFpbmluZyA9IG1heFdhaXQgLSAoc3RhbXAgLSBsYXN0Q2FsbGVkKSwKICAgICAgICAgIGlzQ2FsbGVkID0gcmVtYWluaW5nIDw9IDAgfHwgcmVtYWluaW5nID4gbWF4V2FpdDsKCiAgICAgIGlmIChpc0NhbGxlZCkgewogICAgICAgIGlmIChtYXhUaW1lb3V0SWQpIHsKICAgICAgICAgIG1heFRpbWVvdXRJZCA9IGNsZWFyVGltZW91dChtYXhUaW1lb3V0SWQpOwogICAgICAgIH0KICAgICAgICBsYXN0Q2FsbGVkID0gc3RhbXA7CiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmdzKTsKICAgICAgfQogICAgICBlbHNlIGlmICghbWF4VGltZW91dElkKSB7CiAgICAgICAgbWF4VGltZW91dElkID0gc2V0VGltZW91dChtYXhEZWxheWVkLCByZW1haW5pbmcpOwogICAgICB9CiAgICB9CiAgICBpZiAoaXNDYWxsZWQgJiYgdGltZW91dElkKSB7CiAgICAgIHRpbWVvdXRJZCA9IGNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgfQogICAgZWxzZSBpZiAoIXRpbWVvdXRJZCAmJiB3YWl0ICE9PSBtYXhXYWl0KSB7CiAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZGVsYXllZCwgd2FpdCk7CiAgICB9CiAgICBpZiAobGVhZGluZ0NhbGwpIHsKICAgICAgaXNDYWxsZWQgPSB0cnVlOwogICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpOwogICAgfQogICAgaWYgKGlzQ2FsbGVkICYmICF0aW1lb3V0SWQgJiYgIW1heFRpbWVvdXRJZCkgewogICAgICBhcmdzID0gdGhpc0FyZyA9IHVuZGVmaW5lZDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGRlYm91bmNlZC5jYW5jZWwgPSBjYW5jZWw7CiAgcmV0dXJuIGRlYm91bmNlZDsKfQoKbW9kdWxlLmV4cG9ydHMgPSBkZWJvdW5jZTsKCn0seyIuLi9kYXRlL25vdyI6NCwiLi4vbGFuZy9pc09iamVjdCI6MzN9XSw2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqIFVzZWQgYXMgdGhlIGBUeXBlRXJyb3JgIG1lc3NhZ2UgZm9yICJGdW5jdGlvbnMiIG1ldGhvZHMuICovCnZhciBGVU5DX0VSUk9SX1RFWFQgPSAnRXhwZWN0ZWQgYSBmdW5jdGlvbic7CgovKiBOYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqLwp2YXIgbmF0aXZlTWF4ID0gTWF0aC5tYXg7CgovKioKICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyBgZnVuY2Agd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlCiAqIGNyZWF0ZWQgZnVuY3Rpb24gYW5kIGFyZ3VtZW50cyBmcm9tIGBzdGFydGAgYW5kIGJleW9uZCBwcm92aWRlZCBhcyBhbiBhcnJheS4KICoKICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uIHRoZSBbcmVzdCBwYXJhbWV0ZXJdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9GdW5jdGlvbnMvcmVzdF9wYXJhbWV0ZXJzKS4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAY2F0ZWdvcnkgRnVuY3Rpb24KICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYXBwbHkgYSByZXN0IHBhcmFtZXRlciB0by4KICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD1mdW5jLmxlbmd0aC0xXSBUaGUgc3RhcnQgcG9zaXRpb24gb2YgdGhlIHJlc3QgcGFyYW1ldGVyLgogKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi4KICogQGV4YW1wbGUKICoKICogdmFyIHNheSA9IF8ucmVzdFBhcmFtKGZ1bmN0aW9uKHdoYXQsIG5hbWVzKSB7CiAqICAgcmV0dXJuIHdoYXQgKyAnICcgKyBfLmluaXRpYWwobmFtZXMpLmpvaW4oJywgJykgKwogKiAgICAgKF8uc2l6ZShuYW1lcykgPiAxID8gJywgJiAnIDogJycpICsgXy5sYXN0KG5hbWVzKTsKICogfSk7CiAqCiAqIHNheSgnaGVsbG8nLCAnZnJlZCcsICdiYXJuZXknLCAncGViYmxlcycpOwogKiAvLyA9PiAnaGVsbG8gZnJlZCwgYmFybmV5LCAmIHBlYmJsZXMnCiAqLwpmdW5jdGlvbiByZXN0UGFyYW0oZnVuYywgc3RhcnQpIHsKICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpOwogIH0KICBzdGFydCA9IG5hdGl2ZU1heChzdGFydCA9PT0gdW5kZWZpbmVkID8gKGZ1bmMubGVuZ3RoIC0gMSkgOiAoK3N0YXJ0IHx8IDApLCAwKTsKICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cywKICAgICAgICBpbmRleCA9IC0xLAogICAgICAgIGxlbmd0aCA9IG5hdGl2ZU1heChhcmdzLmxlbmd0aCAtIHN0YXJ0LCAwKSwKICAgICAgICByZXN0ID0gQXJyYXkobGVuZ3RoKTsKCiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkgewogICAgICByZXN0W2luZGV4XSA9IGFyZ3Nbc3RhcnQgKyBpbmRleF07CiAgICB9CiAgICBzd2l0Y2ggKHN0YXJ0KSB7CiAgICAgIGNhc2UgMDogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzLCByZXN0KTsKICAgICAgY2FzZSAxOiByZXR1cm4gZnVuYy5jYWxsKHRoaXMsIGFyZ3NbMF0sIHJlc3QpOwogICAgICBjYXNlIDI6IHJldHVybiBmdW5jLmNhbGwodGhpcywgYXJnc1swXSwgYXJnc1sxXSwgcmVzdCk7CiAgICB9CiAgICB2YXIgb3RoZXJBcmdzID0gQXJyYXkoc3RhcnQgKyAxKTsKICAgIGluZGV4ID0gLTE7CiAgICB3aGlsZSAoKytpbmRleCA8IHN0YXJ0KSB7CiAgICAgIG90aGVyQXJnc1tpbmRleF0gPSBhcmdzW2luZGV4XTsKICAgIH0KICAgIG90aGVyQXJnc1tzdGFydF0gPSByZXN0OwogICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgb3RoZXJBcmdzKTsKICB9Owp9Cgptb2R1bGUuZXhwb3J0cyA9IHJlc3RQYXJhbTsKCn0se31dLDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgZGVib3VuY2UgPSBfZGVyZXFfKCcuL2RlYm91bmNlJyksCiAgICBpc09iamVjdCA9IF9kZXJlcV8oJy4uL2xhbmcvaXNPYmplY3QnKTsKCi8qKiBVc2VkIGFzIHRoZSBgVHlwZUVycm9yYCBtZXNzYWdlIGZvciAiRnVuY3Rpb25zIiBtZXRob2RzLiAqLwp2YXIgRlVOQ19FUlJPUl9URVhUID0gJ0V4cGVjdGVkIGEgZnVuY3Rpb24nOwoKLyoqCiAqIENyZWF0ZXMgYSB0aHJvdHRsZWQgZnVuY3Rpb24gdGhhdCBvbmx5IGludm9rZXMgYGZ1bmNgIGF0IG1vc3Qgb25jZSBwZXIKICogZXZlcnkgYHdhaXRgIG1pbGxpc2Vjb25kcy4gVGhlIHRocm90dGxlZCBmdW5jdGlvbiBjb21lcyB3aXRoIGEgYGNhbmNlbGAKICogbWV0aG9kIHRvIGNhbmNlbCBkZWxheWVkIGludm9jYXRpb25zLiBQcm92aWRlIGFuIG9wdGlvbnMgb2JqZWN0IHRvIGluZGljYXRlCiAqIHRoYXQgYGZ1bmNgIHNob3VsZCBiZSBpbnZva2VkIG9uIHRoZSBsZWFkaW5nIGFuZC9vciB0cmFpbGluZyBlZGdlIG9mIHRoZQogKiBgd2FpdGAgdGltZW91dC4gU3Vic2VxdWVudCBjYWxscyB0byB0aGUgdGhyb3R0bGVkIGZ1bmN0aW9uIHJldHVybiB0aGUKICogcmVzdWx0IG9mIHRoZSBsYXN0IGBmdW5jYCBjYWxsLgogKgogKiAqKk5vdGU6KiogSWYgYGxlYWRpbmdgIGFuZCBgdHJhaWxpbmdgIG9wdGlvbnMgYXJlIGB0cnVlYCwgYGZ1bmNgIGlzIGludm9rZWQKICogb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQgb25seSBpZiB0aGUgdGhlIHRocm90dGxlZCBmdW5jdGlvbiBpcwogKiBpbnZva2VkIG1vcmUgdGhhbiBvbmNlIGR1cmluZyB0aGUgYHdhaXRgIHRpbWVvdXQuCiAqCiAqIFNlZSBbRGF2aWQgQ29yYmFjaG8ncyBhcnRpY2xlXShodHRwOi8vZHJ1cGFsbW90aW9uLmNvbS9hcnRpY2xlL2RlYm91bmNlLWFuZC10aHJvdHRsZS12aXN1YWwtZXhwbGFuYXRpb24pCiAqIGZvciBkZXRhaWxzIG92ZXIgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4gYF8udGhyb3R0bGVgIGFuZCBgXy5kZWJvdW5jZWAuCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IEZ1bmN0aW9uCiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHRocm90dGxlLgogKiBAcGFyYW0ge251bWJlcn0gW3dhaXQ9MF0gVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gdGhyb3R0bGUgaW52b2NhdGlvbnMgdG8uCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gVGhlIG9wdGlvbnMgb2JqZWN0LgogKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmxlYWRpbmc9dHJ1ZV0gU3BlY2lmeSBpbnZva2luZyBvbiB0aGUgbGVhZGluZwogKiAgZWRnZSBvZiB0aGUgdGltZW91dC4KICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50cmFpbGluZz10cnVlXSBTcGVjaWZ5IGludm9raW5nIG9uIHRoZSB0cmFpbGluZwogKiAgZWRnZSBvZiB0aGUgdGltZW91dC4KICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgdGhyb3R0bGVkIGZ1bmN0aW9uLgogKiBAZXhhbXBsZQogKgogKiAvLyBhdm9pZCBleGNlc3NpdmVseSB1cGRhdGluZyB0aGUgcG9zaXRpb24gd2hpbGUgc2Nyb2xsaW5nCiAqIGpRdWVyeSh3aW5kb3cpLm9uKCdzY3JvbGwnLCBfLnRocm90dGxlKHVwZGF0ZVBvc2l0aW9uLCAxMDApKTsKICoKICogLy8gaW52b2tlIGByZW5ld1Rva2VuYCB3aGVuIHRoZSBjbGljayBldmVudCBpcyBmaXJlZCwgYnV0IG5vdCBtb3JlIHRoYW4gb25jZSBldmVyeSA1IG1pbnV0ZXMKICogalF1ZXJ5KCcuaW50ZXJhY3RpdmUnKS5vbignY2xpY2snLCBfLnRocm90dGxlKHJlbmV3VG9rZW4sIDMwMDAwMCwgewogKiAgICd0cmFpbGluZyc6IGZhbHNlCiAqIH0pKTsKICoKICogLy8gY2FuY2VsIGEgdHJhaWxpbmcgdGhyb3R0bGVkIGNhbGwKICogalF1ZXJ5KHdpbmRvdykub24oJ3BvcHN0YXRlJywgdGhyb3R0bGVkLmNhbmNlbCk7CiAqLwpmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0LCBvcHRpb25zKSB7CiAgdmFyIGxlYWRpbmcgPSB0cnVlLAogICAgICB0cmFpbGluZyA9IHRydWU7CgogIGlmICh0eXBlb2YgZnVuYyAhPSAnZnVuY3Rpb24nKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7CiAgfQogIGlmIChvcHRpb25zID09PSBmYWxzZSkgewogICAgbGVhZGluZyA9IGZhbHNlOwogIH0gZWxzZSBpZiAoaXNPYmplY3Qob3B0aW9ucykpIHsKICAgIGxlYWRpbmcgPSAnbGVhZGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy5sZWFkaW5nIDogbGVhZGluZzsKICAgIHRyYWlsaW5nID0gJ3RyYWlsaW5nJyBpbiBvcHRpb25zID8gISFvcHRpb25zLnRyYWlsaW5nIDogdHJhaWxpbmc7CiAgfQogIHJldHVybiBkZWJvdW5jZShmdW5jLCB3YWl0LCB7ICdsZWFkaW5nJzogbGVhZGluZywgJ21heFdhaXQnOiArd2FpdCwgJ3RyYWlsaW5nJzogdHJhaWxpbmcgfSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gdGhyb3R0bGU7Cgp9LHsiLi4vbGFuZy9pc09iamVjdCI6MzMsIi4vZGVib3VuY2UiOjV9XSw4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIENvcGllcyB0aGUgdmFsdWVzIG9mIGBzb3VyY2VgIHRvIGBhcnJheWAuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7QXJyYXl9IHNvdXJjZSBUaGUgYXJyYXkgdG8gY29weSB2YWx1ZXMgZnJvbS4KICogQHBhcmFtIHtBcnJheX0gW2FycmF5PVtdXSBUaGUgYXJyYXkgdG8gY29weSB2YWx1ZXMgdG8uCiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLgogKi8KZnVuY3Rpb24gYXJyYXlDb3B5KHNvdXJjZSwgYXJyYXkpIHsKICB2YXIgaW5kZXggPSAtMSwKICAgICAgbGVuZ3RoID0gc291cmNlLmxlbmd0aDsKCiAgYXJyYXkgfHwgKGFycmF5ID0gQXJyYXkobGVuZ3RoKSk7CiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHsKICAgIGFycmF5W2luZGV4XSA9IHNvdXJjZVtpbmRleF07CiAgfQogIHJldHVybiBhcnJheTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBhcnJheUNvcHk7Cgp9LHt9XSw5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5mb3JFYWNoYCBmb3IgYXJyYXlzIHdpdGhvdXQgc3VwcG9ydCBmb3IgY2FsbGJhY2sKICogc2hvcnRoYW5kcyBhbmQgYHRoaXNgIGJpbmRpbmcuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuCiAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uCiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLgogKi8KZnVuY3Rpb24gYXJyYXlFYWNoKGFycmF5LCBpdGVyYXRlZSkgewogIHZhciBpbmRleCA9IC0xLAogICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgogIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7CiAgICBpZiAoaXRlcmF0ZWUoYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpID09PSBmYWxzZSkgewogICAgICBicmVhazsKICAgIH0KICB9CiAgcmV0dXJuIGFycmF5Owp9Cgptb2R1bGUuZXhwb3J0cyA9IGFycmF5RWFjaDsKCn0se31dLDEwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIENvcGllcyBwcm9wZXJ0aWVzIG9mIGBzb3VyY2VgIHRvIGBvYmplY3RgLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVzIGZyb20uCiAqIEBwYXJhbSB7QXJyYXl9IHByb3BzIFRoZSBwcm9wZXJ0eSBuYW1lcyB0byBjb3B5LgogKiBAcGFyYW0ge09iamVjdH0gW29iamVjdD17fV0gVGhlIG9iamVjdCB0byBjb3B5IHByb3BlcnRpZXMgdG8uCiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuCiAqLwpmdW5jdGlvbiBiYXNlQ29weShzb3VyY2UsIHByb3BzLCBvYmplY3QpIHsKICBvYmplY3QgfHwgKG9iamVjdCA9IHt9KTsKCiAgdmFyIGluZGV4ID0gLTEsCiAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDsKCiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHsKICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07CiAgICBvYmplY3Rba2V5XSA9IHNvdXJjZVtrZXldOwogIH0KICByZXR1cm4gb2JqZWN0Owp9Cgptb2R1bGUuZXhwb3J0cyA9IGJhc2VDb3B5OwoKfSx7fV0sMTE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgY3JlYXRlQmFzZUZvciA9IF9kZXJlcV8oJy4vY3JlYXRlQmFzZUZvcicpOwoKLyoqCiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBiYXNlRm9ySW5gIGFuZCBgYmFzZUZvck93bmAgd2hpY2ggaXRlcmF0ZXMKICogb3ZlciBgb2JqZWN0YCBwcm9wZXJ0aWVzIHJldHVybmVkIGJ5IGBrZXlzRnVuY2AgaW52b2tpbmcgYGl0ZXJhdGVlYCBmb3IKICogZWFjaCBwcm9wZXJ0eS4gSXRlcmF0ZWUgZnVuY3Rpb25zIG1heSBleGl0IGl0ZXJhdGlvbiBlYXJseSBieSBleHBsaWNpdGx5CiAqIHJldHVybmluZyBgZmFsc2VgLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBrZXlzRnVuYyBUaGUgZnVuY3Rpb24gdG8gZ2V0IHRoZSBrZXlzIG9mIGBvYmplY3RgLgogKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLgogKi8KdmFyIGJhc2VGb3IgPSBjcmVhdGVCYXNlRm9yKCk7Cgptb2R1bGUuZXhwb3J0cyA9IGJhc2VGb3I7Cgp9LHsiLi9jcmVhdGVCYXNlRm9yIjoxOH1dLDEyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGJhc2VGb3IgPSBfZGVyZXFfKCcuL2Jhc2VGb3InKSwKICAgIGtleXNJbiA9IF9kZXJlcV8oJy4uL29iamVjdC9rZXlzSW4nKTsKCi8qKgogKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5mb3JJbmAgd2l0aG91dCBzdXBwb3J0IGZvciBjYWxsYmFjawogKiBzaG9ydGhhbmRzIGFuZCBgdGhpc2AgYmluZGluZy4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci4KICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi4KICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC4KICovCmZ1bmN0aW9uIGJhc2VGb3JJbihvYmplY3QsIGl0ZXJhdGVlKSB7CiAgcmV0dXJuIGJhc2VGb3Iob2JqZWN0LCBpdGVyYXRlZSwga2V5c0luKTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBiYXNlRm9ySW47Cgp9LHsiLi4vb2JqZWN0L2tleXNJbiI6MzksIi4vYmFzZUZvciI6MTF9XSwxMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBhcnJheUVhY2ggPSBfZGVyZXFfKCcuL2FycmF5RWFjaCcpLAogICAgYmFzZU1lcmdlRGVlcCA9IF9kZXJlcV8oJy4vYmFzZU1lcmdlRGVlcCcpLAogICAgaXNBcnJheSA9IF9kZXJlcV8oJy4uL2xhbmcvaXNBcnJheScpLAogICAgaXNBcnJheUxpa2UgPSBfZGVyZXFfKCcuL2lzQXJyYXlMaWtlJyksCiAgICBpc09iamVjdCA9IF9kZXJlcV8oJy4uL2xhbmcvaXNPYmplY3QnKSwKICAgIGlzT2JqZWN0TGlrZSA9IF9kZXJlcV8oJy4vaXNPYmplY3RMaWtlJyksCiAgICBpc1R5cGVkQXJyYXkgPSBfZGVyZXFfKCcuLi9sYW5nL2lzVHlwZWRBcnJheScpLAogICAga2V5cyA9IF9kZXJlcV8oJy4uL29iamVjdC9rZXlzJyk7CgovKioKICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubWVyZ2VgIHdpdGhvdXQgc3VwcG9ydCBmb3IgYXJndW1lbnQganVnZ2xpbmcsCiAqIG11bHRpcGxlIHNvdXJjZXMsIGFuZCBgdGhpc2AgYmluZGluZyBgY3VzdG9taXplcmAgZnVuY3Rpb25zLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuCiAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIHNvdXJjZSBvYmplY3QuCiAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIG1lcmdlZCB2YWx1ZXMuCiAqIEBwYXJhbSB7QXJyYXl9IFtzdGFja0E9W11dIFRyYWNrcyB0cmF2ZXJzZWQgc291cmNlIG9iamVjdHMuCiAqIEBwYXJhbSB7QXJyYXl9IFtzdGFja0I9W11dIEFzc29jaWF0ZXMgdmFsdWVzIHdpdGggc291cmNlIGNvdW50ZXJwYXJ0cy4KICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC4KICovCmZ1bmN0aW9uIGJhc2VNZXJnZShvYmplY3QsIHNvdXJjZSwgY3VzdG9taXplciwgc3RhY2tBLCBzdGFja0IpIHsKICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHsKICAgIHJldHVybiBvYmplY3Q7CiAgfQogIHZhciBpc1NyY0FyciA9IGlzQXJyYXlMaWtlKHNvdXJjZSkgJiYgKGlzQXJyYXkoc291cmNlKSB8fCBpc1R5cGVkQXJyYXkoc291cmNlKSksCiAgICAgIHByb3BzID0gaXNTcmNBcnIgPyB1bmRlZmluZWQgOiBrZXlzKHNvdXJjZSk7CgogIGFycmF5RWFjaChwcm9wcyB8fCBzb3VyY2UsIGZ1bmN0aW9uKHNyY1ZhbHVlLCBrZXkpIHsKICAgIGlmIChwcm9wcykgewogICAgICBrZXkgPSBzcmNWYWx1ZTsKICAgICAgc3JjVmFsdWUgPSBzb3VyY2Vba2V5XTsKICAgIH0KICAgIGlmIChpc09iamVjdExpa2Uoc3JjVmFsdWUpKSB7CiAgICAgIHN0YWNrQSB8fCAoc3RhY2tBID0gW10pOwogICAgICBzdGFja0IgfHwgKHN0YWNrQiA9IFtdKTsKICAgICAgYmFzZU1lcmdlRGVlcChvYmplY3QsIHNvdXJjZSwga2V5LCBiYXNlTWVyZ2UsIGN1c3RvbWl6ZXIsIHN0YWNrQSwgc3RhY2tCKTsKICAgIH0KICAgIGVsc2UgewogICAgICB2YXIgdmFsdWUgPSBvYmplY3Rba2V5XSwKICAgICAgICAgIHJlc3VsdCA9IGN1c3RvbWl6ZXIgPyBjdXN0b21pemVyKHZhbHVlLCBzcmNWYWx1ZSwga2V5LCBvYmplY3QsIHNvdXJjZSkgOiB1bmRlZmluZWQsCiAgICAgICAgICBpc0NvbW1vbiA9IHJlc3VsdCA9PT0gdW5kZWZpbmVkOwoKICAgICAgaWYgKGlzQ29tbW9uKSB7CiAgICAgICAgcmVzdWx0ID0gc3JjVmFsdWU7CiAgICAgIH0KICAgICAgaWYgKChyZXN1bHQgIT09IHVuZGVmaW5lZCB8fCAoaXNTcmNBcnIgJiYgIShrZXkgaW4gb2JqZWN0KSkpICYmCiAgICAgICAgICAoaXNDb21tb24gfHwgKHJlc3VsdCA9PT0gcmVzdWx0ID8gKHJlc3VsdCAhPT0gdmFsdWUpIDogKHZhbHVlID09PSB2YWx1ZSkpKSkgewogICAgICAgIG9iamVjdFtrZXldID0gcmVzdWx0OwogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIG9iamVjdDsKfQoKbW9kdWxlLmV4cG9ydHMgPSBiYXNlTWVyZ2U7Cgp9LHsiLi4vbGFuZy9pc0FycmF5IjozMCwiLi4vbGFuZy9pc09iamVjdCI6MzMsIi4uL2xhbmcvaXNUeXBlZEFycmF5IjozNiwiLi4vb2JqZWN0L2tleXMiOjM4LCIuL2FycmF5RWFjaCI6OSwiLi9iYXNlTWVyZ2VEZWVwIjoxNCwiLi9pc0FycmF5TGlrZSI6MjEsIi4vaXNPYmplY3RMaWtlIjoyNn1dLDE0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGFycmF5Q29weSA9IF9kZXJlcV8oJy4vYXJyYXlDb3B5JyksCiAgICBpc0FyZ3VtZW50cyA9IF9kZXJlcV8oJy4uL2xhbmcvaXNBcmd1bWVudHMnKSwKICAgIGlzQXJyYXkgPSBfZGVyZXFfKCcuLi9sYW5nL2lzQXJyYXknKSwKICAgIGlzQXJyYXlMaWtlID0gX2RlcmVxXygnLi9pc0FycmF5TGlrZScpLAogICAgaXNQbGFpbk9iamVjdCA9IF9kZXJlcV8oJy4uL2xhbmcvaXNQbGFpbk9iamVjdCcpLAogICAgaXNUeXBlZEFycmF5ID0gX2RlcmVxXygnLi4vbGFuZy9pc1R5cGVkQXJyYXknKSwKICAgIHRvUGxhaW5PYmplY3QgPSBfZGVyZXFfKCcuLi9sYW5nL3RvUGxhaW5PYmplY3QnKTsKCi8qKgogKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VNZXJnZWAgZm9yIGFycmF5cyBhbmQgb2JqZWN0cyB3aGljaCBwZXJmb3JtcwogKiBkZWVwIG1lcmdlcyBhbmQgdHJhY2tzIHRyYXZlcnNlZCBvYmplY3RzIGVuYWJsaW5nIG9iamVjdHMgd2l0aCBjaXJjdWxhcgogKiByZWZlcmVuY2VzIHRvIGJlIG1lcmdlZC4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LgogKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2JqZWN0LgogKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIG1lcmdlLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBtZXJnZUZ1bmMgVGhlIGZ1bmN0aW9uIHRvIG1lcmdlIHZhbHVlcy4KICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgbWVyZ2VkIHZhbHVlcy4KICogQHBhcmFtIHtBcnJheX0gW3N0YWNrQT1bXV0gVHJhY2tzIHRyYXZlcnNlZCBzb3VyY2Ugb2JqZWN0cy4KICogQHBhcmFtIHtBcnJheX0gW3N0YWNrQj1bXV0gQXNzb2NpYXRlcyB2YWx1ZXMgd2l0aCBzb3VyY2UgY291bnRlcnBhcnRzLgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC4KICovCmZ1bmN0aW9uIGJhc2VNZXJnZURlZXAob2JqZWN0LCBzb3VyY2UsIGtleSwgbWVyZ2VGdW5jLCBjdXN0b21pemVyLCBzdGFja0EsIHN0YWNrQikgewogIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoLAogICAgICBzcmNWYWx1ZSA9IHNvdXJjZVtrZXldOwoKICB3aGlsZSAobGVuZ3RoLS0pIHsKICAgIGlmIChzdGFja0FbbGVuZ3RoXSA9PSBzcmNWYWx1ZSkgewogICAgICBvYmplY3Rba2V5XSA9IHN0YWNrQltsZW5ndGhdOwogICAgICByZXR1cm47CiAgICB9CiAgfQogIHZhciB2YWx1ZSA9IG9iamVjdFtrZXldLAogICAgICByZXN1bHQgPSBjdXN0b21pemVyID8gY3VzdG9taXplcih2YWx1ZSwgc3JjVmFsdWUsIGtleSwgb2JqZWN0LCBzb3VyY2UpIDogdW5kZWZpbmVkLAogICAgICBpc0NvbW1vbiA9IHJlc3VsdCA9PT0gdW5kZWZpbmVkOwoKICBpZiAoaXNDb21tb24pIHsKICAgIHJlc3VsdCA9IHNyY1ZhbHVlOwogICAgaWYgKGlzQXJyYXlMaWtlKHNyY1ZhbHVlKSAmJiAoaXNBcnJheShzcmNWYWx1ZSkgfHwgaXNUeXBlZEFycmF5KHNyY1ZhbHVlKSkpIHsKICAgICAgcmVzdWx0ID0gaXNBcnJheSh2YWx1ZSkKICAgICAgICA/IHZhbHVlCiAgICAgICAgOiAoaXNBcnJheUxpa2UodmFsdWUpID8gYXJyYXlDb3B5KHZhbHVlKSA6IFtdKTsKICAgIH0KICAgIGVsc2UgaWYgKGlzUGxhaW5PYmplY3Qoc3JjVmFsdWUpIHx8IGlzQXJndW1lbnRzKHNyY1ZhbHVlKSkgewogICAgICByZXN1bHQgPSBpc0FyZ3VtZW50cyh2YWx1ZSkKICAgICAgICA/IHRvUGxhaW5PYmplY3QodmFsdWUpCiAgICAgICAgOiAoaXNQbGFpbk9iamVjdCh2YWx1ZSkgPyB2YWx1ZSA6IHt9KTsKICAgIH0KICAgIGVsc2UgewogICAgICBpc0NvbW1vbiA9IGZhbHNlOwogICAgfQogIH0KICAvLyBBZGQgdGhlIHNvdXJjZSB2YWx1ZSB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMgYW5kIGFzc29jaWF0ZQogIC8vIGl0IHdpdGggaXRzIG1lcmdlZCB2YWx1ZS4KICBzdGFja0EucHVzaChzcmNWYWx1ZSk7CiAgc3RhY2tCLnB1c2gocmVzdWx0KTsKCiAgaWYgKGlzQ29tbW9uKSB7CiAgICAvLyBSZWN1cnNpdmVseSBtZXJnZSBvYmplY3RzIGFuZCBhcnJheXMgKHN1c2NlcHRpYmxlIHRvIGNhbGwgc3RhY2sgbGltaXRzKS4KICAgIG9iamVjdFtrZXldID0gbWVyZ2VGdW5jKHJlc3VsdCwgc3JjVmFsdWUsIGN1c3RvbWl6ZXIsIHN0YWNrQSwgc3RhY2tCKTsKICB9IGVsc2UgaWYgKHJlc3VsdCA9PT0gcmVzdWx0ID8gKHJlc3VsdCAhPT0gdmFsdWUpIDogKHZhbHVlID09PSB2YWx1ZSkpIHsKICAgIG9iamVjdFtrZXldID0gcmVzdWx0OwogIH0KfQoKbW9kdWxlLmV4cG9ydHMgPSBiYXNlTWVyZ2VEZWVwOwoKfSx7Ii4uL2xhbmcvaXNBcmd1bWVudHMiOjI5LCIuLi9sYW5nL2lzQXJyYXkiOjMwLCIuLi9sYW5nL2lzUGxhaW5PYmplY3QiOjM0LCIuLi9sYW5nL2lzVHlwZWRBcnJheSI6MzYsIi4uL2xhbmcvdG9QbGFpbk9iamVjdCI6MzcsIi4vYXJyYXlDb3B5Ijo4LCIuL2lzQXJyYXlMaWtlIjoyMX1dLDE1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIHRvT2JqZWN0ID0gX2RlcmVxXygnLi90b09iamVjdCcpOwoKLyoqCiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnByb3BlcnR5YCB3aXRob3V0IHN1cHBvcnQgZm9yIGRlZXAgcGF0aHMuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LgogKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi4KICovCmZ1bmN0aW9uIGJhc2VQcm9wZXJ0eShrZXkpIHsKICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0KSB7CiAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiB0b09iamVjdChvYmplY3QpW2tleV07CiAgfTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBiYXNlUHJvcGVydHk7Cgp9LHsiLi90b09iamVjdCI6Mjh9XSwxNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBpZGVudGl0eSA9IF9kZXJlcV8oJy4uL3V0aWxpdHkvaWRlbnRpdHknKTsKCi8qKgogKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VDYWxsYmFja2Agd2hpY2ggb25seSBzdXBwb3J0cyBgdGhpc2AgYmluZGluZwogKiBhbmQgc3BlY2lmeWluZyB0aGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBwcm92aWRlIHRvIGBmdW5jYC4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYmluZC4KICogQHBhcmFtIHsqfSB0aGlzQXJnIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuCiAqIEBwYXJhbSB7bnVtYmVyfSBbYXJnQ291bnRdIFRoZSBudW1iZXIgb2YgYXJndW1lbnRzIHRvIHByb3ZpZGUgdG8gYGZ1bmNgLgogKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIGNhbGxiYWNrLgogKi8KZnVuY3Rpb24gYmluZENhbGxiYWNrKGZ1bmMsIHRoaXNBcmcsIGFyZ0NvdW50KSB7CiAgaWYgKHR5cGVvZiBmdW5jICE9ICdmdW5jdGlvbicpIHsKICAgIHJldHVybiBpZGVudGl0eTsKICB9CiAgaWYgKHRoaXNBcmcgPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIGZ1bmM7CiAgfQogIHN3aXRjaCAoYXJnQ291bnQpIHsKICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgdmFsdWUpOwogICAgfTsKICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikgewogICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7CiAgICB9OwogICAgY2FzZSA0OiByZXR1cm4gZnVuY3Rpb24oYWNjdW11bGF0b3IsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikgewogICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pOwogICAgfTsKICAgIGNhc2UgNTogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBvdGhlciwga2V5LCBvYmplY3QsIHNvdXJjZSkgewogICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBvdGhlciwga2V5LCBvYmplY3QsIHNvdXJjZSk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmd1bWVudHMpOwogIH07Cn0KCm1vZHVsZS5leHBvcnRzID0gYmluZENhbGxiYWNrOwoKfSx7Ii4uL3V0aWxpdHkvaWRlbnRpdHkiOjQyfV0sMTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgYmluZENhbGxiYWNrID0gX2RlcmVxXygnLi9iaW5kQ2FsbGJhY2snKSwKICAgIGlzSXRlcmF0ZWVDYWxsID0gX2RlcmVxXygnLi9pc0l0ZXJhdGVlQ2FsbCcpLAogICAgcmVzdFBhcmFtID0gX2RlcmVxXygnLi4vZnVuY3Rpb24vcmVzdFBhcmFtJyk7CgovKioKICogQ3JlYXRlcyBhIGBfLmFzc2lnbmAsIGBfLmRlZmF1bHRzYCwgb3IgYF8ubWVyZ2VgIGZ1bmN0aW9uLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBhc3NpZ25lciBUaGUgZnVuY3Rpb24gdG8gYXNzaWduIHZhbHVlcy4KICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYXNzaWduZXIgZnVuY3Rpb24uCiAqLwpmdW5jdGlvbiBjcmVhdGVBc3NpZ25lcihhc3NpZ25lcikgewogIHJldHVybiByZXN0UGFyYW0oZnVuY3Rpb24ob2JqZWN0LCBzb3VyY2VzKSB7CiAgICB2YXIgaW5kZXggPSAtMSwKICAgICAgICBsZW5ndGggPSBvYmplY3QgPT0gbnVsbCA/IDAgOiBzb3VyY2VzLmxlbmd0aCwKICAgICAgICBjdXN0b21pemVyID0gbGVuZ3RoID4gMiA/IHNvdXJjZXNbbGVuZ3RoIC0gMl0gOiB1bmRlZmluZWQsCiAgICAgICAgZ3VhcmQgPSBsZW5ndGggPiAyID8gc291cmNlc1syXSA6IHVuZGVmaW5lZCwKICAgICAgICB0aGlzQXJnID0gbGVuZ3RoID4gMSA/IHNvdXJjZXNbbGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQ7CgogICAgaWYgKHR5cGVvZiBjdXN0b21pemVyID09ICdmdW5jdGlvbicpIHsKICAgICAgY3VzdG9taXplciA9IGJpbmRDYWxsYmFjayhjdXN0b21pemVyLCB0aGlzQXJnLCA1KTsKICAgICAgbGVuZ3RoIC09IDI7CiAgICB9IGVsc2UgewogICAgICBjdXN0b21pemVyID0gdHlwZW9mIHRoaXNBcmcgPT0gJ2Z1bmN0aW9uJyA/IHRoaXNBcmcgOiB1bmRlZmluZWQ7CiAgICAgIGxlbmd0aCAtPSAoY3VzdG9taXplciA/IDEgOiAwKTsKICAgIH0KICAgIGlmIChndWFyZCAmJiBpc0l0ZXJhdGVlQ2FsbChzb3VyY2VzWzBdLCBzb3VyY2VzWzFdLCBndWFyZCkpIHsKICAgICAgY3VzdG9taXplciA9IGxlbmd0aCA8IDMgPyB1bmRlZmluZWQgOiBjdXN0b21pemVyOwogICAgICBsZW5ndGggPSAxOwogICAgfQogICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHsKICAgICAgdmFyIHNvdXJjZSA9IHNvdXJjZXNbaW5kZXhdOwogICAgICBpZiAoc291cmNlKSB7CiAgICAgICAgYXNzaWduZXIob2JqZWN0LCBzb3VyY2UsIGN1c3RvbWl6ZXIpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gb2JqZWN0OwogIH0pOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUFzc2lnbmVyOwoKfSx7Ii4uL2Z1bmN0aW9uL3Jlc3RQYXJhbSI6NiwiLi9iaW5kQ2FsbGJhY2siOjE2LCIuL2lzSXRlcmF0ZWVDYWxsIjoyNH1dLDE4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIHRvT2JqZWN0ID0gX2RlcmVxXygnLi90b09iamVjdCcpOwoKLyoqCiAqIENyZWF0ZXMgYSBiYXNlIGZ1bmN0aW9uIGZvciBgXy5mb3JJbmAgb3IgYF8uZm9ySW5SaWdodGAuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2Zyb21SaWdodF0gU3BlY2lmeSBpdGVyYXRpbmcgZnJvbSByaWdodCB0byBsZWZ0LgogKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBiYXNlIGZ1bmN0aW9uLgogKi8KZnVuY3Rpb24gY3JlYXRlQmFzZUZvcihmcm9tUmlnaHQpIHsKICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBpdGVyYXRlZSwga2V5c0Z1bmMpIHsKICAgIHZhciBpdGVyYWJsZSA9IHRvT2JqZWN0KG9iamVjdCksCiAgICAgICAgcHJvcHMgPSBrZXlzRnVuYyhvYmplY3QpLAogICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aCwKICAgICAgICBpbmRleCA9IGZyb21SaWdodCA/IGxlbmd0aCA6IC0xOwoKICAgIHdoaWxlICgoZnJvbVJpZ2h0ID8gaW5kZXgtLSA6ICsraW5kZXggPCBsZW5ndGgpKSB7CiAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07CiAgICAgIGlmIChpdGVyYXRlZShpdGVyYWJsZVtrZXldLCBrZXksIGl0ZXJhYmxlKSA9PT0gZmFsc2UpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgcmV0dXJuIG9iamVjdDsKICB9Owp9Cgptb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUJhc2VGb3I7Cgp9LHsiLi90b09iamVjdCI6Mjh9XSwxOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBiYXNlUHJvcGVydHkgPSBfZGVyZXFfKCcuL2Jhc2VQcm9wZXJ0eScpOwoKLyoqCiAqIEdldHMgdGhlICJsZW5ndGgiIHByb3BlcnR5IHZhbHVlIG9mIGBvYmplY3RgLgogKgogKiAqKk5vdGU6KiogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGF2b2lkIGEgW0pJVCBidWddKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNDI3OTIpCiAqIHRoYXQgYWZmZWN0cyBTYWZhcmkgb24gYXQgbGVhc3QgaU9TIDguMS04LjMgQVJNNjQuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS4KICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlICJsZW5ndGgiIHZhbHVlLgogKi8KdmFyIGdldExlbmd0aCA9IGJhc2VQcm9wZXJ0eSgnbGVuZ3RoJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGdldExlbmd0aDsKCn0seyIuL2Jhc2VQcm9wZXJ0eSI6MTV9XSwyMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBpc05hdGl2ZSA9IF9kZXJlcV8oJy4uL2xhbmcvaXNOYXRpdmUnKTsKCi8qKgogKiBHZXRzIHRoZSBuYXRpdmUgZnVuY3Rpb24gYXQgYGtleWAgb2YgYG9iamVjdGAuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS4KICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QgdG8gZ2V0LgogKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZnVuY3Rpb24gaWYgaXQncyBuYXRpdmUsIGVsc2UgYHVuZGVmaW5lZGAuCiAqLwpmdW5jdGlvbiBnZXROYXRpdmUob2JqZWN0LCBrZXkpIHsKICB2YXIgdmFsdWUgPSBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdFtrZXldOwogIHJldHVybiBpc05hdGl2ZSh2YWx1ZSkgPyB2YWx1ZSA6IHVuZGVmaW5lZDsKfQoKbW9kdWxlLmV4cG9ydHMgPSBnZXROYXRpdmU7Cgp9LHsiLi4vbGFuZy9pc05hdGl2ZSI6MzJ9XSwyMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBnZXRMZW5ndGggPSBfZGVyZXFfKCcuL2dldExlbmd0aCcpLAogICAgaXNMZW5ndGggPSBfZGVyZXFfKCcuL2lzTGVuZ3RoJyk7CgovKioKICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYXJyYXktbGlrZS4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFycmF5LWxpa2UsIGVsc2UgYGZhbHNlYC4KICovCmZ1bmN0aW9uIGlzQXJyYXlMaWtlKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgaXNMZW5ndGgoZ2V0TGVuZ3RoKHZhbHVlKSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gaXNBcnJheUxpa2U7Cgp9LHsiLi9nZXRMZW5ndGgiOjE5LCIuL2lzTGVuZ3RoIjoyNX1dLDIyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgaG9zdCBvYmplY3QgaW4gSUUgPCA5LgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay4KICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBob3N0IG9iamVjdCwgZWxzZSBgZmFsc2VgLgogKi8KdmFyIGlzSG9zdE9iamVjdCA9IChmdW5jdGlvbigpIHsKICB0cnkgewogICAgT2JqZWN0KHsgJ3RvU3RyaW5nJzogMCB9ICsgJycpOwogIH0gY2F0Y2goZSkgewogICAgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH07CiAgfQogIHJldHVybiBmdW5jdGlvbih2YWx1ZSkgewogICAgLy8gSUUgPCA5IHByZXNlbnRzIG1hbnkgaG9zdCBvYmplY3RzIGFzIGBPYmplY3RgIG9iamVjdHMgdGhhdCBjYW4gY29lcmNlCiAgICAvLyB0byBzdHJpbmdzIGRlc3BpdGUgaGF2aW5nIGltcHJvcGVybHkgZGVmaW5lZCBgdG9TdHJpbmdgIG1ldGhvZHMuCiAgICByZXR1cm4gdHlwZW9mIHZhbHVlLnRvU3RyaW5nICE9ICdmdW5jdGlvbicgJiYgdHlwZW9mICh2YWx1ZSArICcnKSA9PSAnc3RyaW5nJzsKICB9Owp9KCkpOwoKbW9kdWxlLmV4cG9ydHMgPSBpc0hvc3RPYmplY3Q7Cgp9LHt9XSwyMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKiBVc2VkIHRvIGRldGVjdCB1bnNpZ25lZCBpbnRlZ2VyIHZhbHVlcy4gKi8KdmFyIHJlSXNVaW50ID0gL15cZCskLzsKCi8qKgogKiBVc2VkIGFzIHRoZSBbbWF4aW11bSBsZW5ndGhdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLW51bWJlci5tYXhfc2FmZV9pbnRlZ2VyKQogKiBvZiBhbiBhcnJheS1saWtlIHZhbHVlLgogKi8KdmFyIE1BWF9TQUZFX0lOVEVHRVIgPSA5MDA3MTk5MjU0NzQwOTkxOwoKLyoqCiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgYXJyYXktbGlrZSBpbmRleC4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEBwYXJhbSB7bnVtYmVyfSBbbGVuZ3RoPU1BWF9TQUZFX0lOVEVHRVJdIFRoZSB1cHBlciBib3VuZHMgb2YgYSB2YWxpZCBpbmRleC4KICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBpbmRleCwgZWxzZSBgZmFsc2VgLgogKi8KZnVuY3Rpb24gaXNJbmRleCh2YWx1ZSwgbGVuZ3RoKSB7CiAgdmFsdWUgPSAodHlwZW9mIHZhbHVlID09ICdudW1iZXInIHx8IHJlSXNVaW50LnRlc3QodmFsdWUpKSA/ICt2YWx1ZSA6IC0xOwogIGxlbmd0aCA9IGxlbmd0aCA9PSBudWxsID8gTUFYX1NBRkVfSU5URUdFUiA6IGxlbmd0aDsKICByZXR1cm4gdmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8IGxlbmd0aDsKfQoKbW9kdWxlLmV4cG9ydHMgPSBpc0luZGV4OwoKfSx7fV0sMjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgaXNBcnJheUxpa2UgPSBfZGVyZXFfKCcuL2lzQXJyYXlMaWtlJyksCiAgICBpc0luZGV4ID0gX2RlcmVxXygnLi9pc0luZGV4JyksCiAgICBpc09iamVjdCA9IF9kZXJlcV8oJy4uL2xhbmcvaXNPYmplY3QnKTsKCi8qKgogKiBDaGVja3MgaWYgdGhlIHByb3ZpZGVkIGFyZ3VtZW50cyBhcmUgZnJvbSBhbiBpdGVyYXRlZSBjYWxsLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSBwb3RlbnRpYWwgaXRlcmF0ZWUgdmFsdWUgYXJndW1lbnQuCiAqIEBwYXJhbSB7Kn0gaW5kZXggVGhlIHBvdGVudGlhbCBpdGVyYXRlZSBpbmRleCBvciBrZXkgYXJndW1lbnQuCiAqIEBwYXJhbSB7Kn0gb2JqZWN0IFRoZSBwb3RlbnRpYWwgaXRlcmF0ZWUgb2JqZWN0IGFyZ3VtZW50LgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGFyZ3VtZW50cyBhcmUgZnJvbSBhbiBpdGVyYXRlZSBjYWxsLCBlbHNlIGBmYWxzZWAuCiAqLwpmdW5jdGlvbiBpc0l0ZXJhdGVlQ2FsbCh2YWx1ZSwgaW5kZXgsIG9iamVjdCkgewogIGlmICghaXNPYmplY3Qob2JqZWN0KSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICB2YXIgdHlwZSA9IHR5cGVvZiBpbmRleDsKICBpZiAodHlwZSA9PSAnbnVtYmVyJwogICAgICA/IChpc0FycmF5TGlrZShvYmplY3QpICYmIGlzSW5kZXgoaW5kZXgsIG9iamVjdC5sZW5ndGgpKQogICAgICA6ICh0eXBlID09ICdzdHJpbmcnICYmIGluZGV4IGluIG9iamVjdCkpIHsKICAgIHZhciBvdGhlciA9IG9iamVjdFtpbmRleF07CiAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlID8gKHZhbHVlID09PSBvdGhlcikgOiAob3RoZXIgIT09IG90aGVyKTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlzSXRlcmF0ZWVDYWxsOwoKfSx7Ii4uL2xhbmcvaXNPYmplY3QiOjMzLCIuL2lzQXJyYXlMaWtlIjoyMSwiLi9pc0luZGV4IjoyM31dLDI1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIFVzZWQgYXMgdGhlIFttYXhpbXVtIGxlbmd0aF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNi4wLyNzZWMtbnVtYmVyLm1heF9zYWZlX2ludGVnZXIpCiAqIG9mIGFuIGFycmF5LWxpa2UgdmFsdWUuCiAqLwp2YXIgTUFYX1NBRkVfSU5URUdFUiA9IDkwMDcxOTkyNTQ3NDA5OTE7CgovKioKICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBhcnJheS1saWtlIGxlbmd0aC4KICoKICogKipOb3RlOioqIFRoaXMgZnVuY3Rpb24gaXMgYmFzZWQgb24gW2BUb0xlbmd0aGBdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLXRvbGVuZ3RoKS4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgbGVuZ3RoLCBlbHNlIGBmYWxzZWAuCiAqLwpmdW5jdGlvbiBpc0xlbmd0aCh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgJiYgdmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8PSBNQVhfU0FGRV9JTlRFR0VSOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlzTGVuZ3RoOwoKfSx7fV0sMjY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgb2JqZWN0LWxpa2UuCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZSwgZWxzZSBgZmFsc2VgLgogKi8KZnVuY3Rpb24gaXNPYmplY3RMaWtlKHZhbHVlKSB7CiAgcmV0dXJuICEhdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlzT2JqZWN0TGlrZTsKCn0se31dLDI3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGlzQXJndW1lbnRzID0gX2RlcmVxXygnLi4vbGFuZy9pc0FyZ3VtZW50cycpLAogICAgaXNBcnJheSA9IF9kZXJlcV8oJy4uL2xhbmcvaXNBcnJheScpLAogICAgaXNJbmRleCA9IF9kZXJlcV8oJy4vaXNJbmRleCcpLAogICAgaXNMZW5ndGggPSBfZGVyZXFfKCcuL2lzTGVuZ3RoJyksCiAgICBpc1N0cmluZyA9IF9kZXJlcV8oJy4uL2xhbmcvaXNTdHJpbmcnKSwKICAgIGtleXNJbiA9IF9kZXJlcV8oJy4uL29iamVjdC9rZXlzSW4nKTsKCi8qKiBVc2VkIGZvciBuYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMuICovCnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7CgovKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi8KdmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7CgovKioKICogQSBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbiBvZiBgT2JqZWN0LmtleXNgIHdoaWNoIGNyZWF0ZXMgYW4gYXJyYXkgb2YgdGhlCiAqIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIGBvYmplY3RgLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuCiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuCiAqLwpmdW5jdGlvbiBzaGltS2V5cyhvYmplY3QpIHsKICB2YXIgcHJvcHMgPSBrZXlzSW4ob2JqZWN0KSwKICAgICAgcHJvcHNMZW5ndGggPSBwcm9wcy5sZW5ndGgsCiAgICAgIGxlbmd0aCA9IHByb3BzTGVuZ3RoICYmIG9iamVjdC5sZW5ndGg7CgogIHZhciBhbGxvd0luZGV4ZXMgPSAhIWxlbmd0aCAmJiBpc0xlbmd0aChsZW5ndGgpICYmCiAgICAoaXNBcnJheShvYmplY3QpIHx8IGlzQXJndW1lbnRzKG9iamVjdCkgfHwgaXNTdHJpbmcob2JqZWN0KSk7CgogIHZhciBpbmRleCA9IC0xLAogICAgICByZXN1bHQgPSBbXTsKCiAgd2hpbGUgKCsraW5kZXggPCBwcm9wc0xlbmd0aCkgewogICAgdmFyIGtleSA9IHByb3BzW2luZGV4XTsKICAgIGlmICgoYWxsb3dJbmRleGVzICYmIGlzSW5kZXgoa2V5LCBsZW5ndGgpKSB8fCBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSkgewogICAgICByZXN1bHQucHVzaChrZXkpOwogICAgfQogIH0KICByZXR1cm4gcmVzdWx0Owp9Cgptb2R1bGUuZXhwb3J0cyA9IHNoaW1LZXlzOwoKfSx7Ii4uL2xhbmcvaXNBcmd1bWVudHMiOjI5LCIuLi9sYW5nL2lzQXJyYXkiOjMwLCIuLi9sYW5nL2lzU3RyaW5nIjozNSwiLi4vb2JqZWN0L2tleXNJbiI6MzksIi4vaXNJbmRleCI6MjMsIi4vaXNMZW5ndGgiOjI1fV0sMjg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgaXNPYmplY3QgPSBfZGVyZXFfKCcuLi9sYW5nL2lzT2JqZWN0JyksCiAgICBpc1N0cmluZyA9IF9kZXJlcV8oJy4uL2xhbmcvaXNTdHJpbmcnKSwKICAgIHN1cHBvcnQgPSBfZGVyZXFfKCcuLi9zdXBwb3J0Jyk7CgovKioKICogQ29udmVydHMgYHZhbHVlYCB0byBhbiBvYmplY3QgaWYgaXQncyBub3Qgb25lLgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwcm9jZXNzLgogKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBvYmplY3QuCiAqLwpmdW5jdGlvbiB0b09iamVjdCh2YWx1ZSkgewogIGlmIChzdXBwb3J0LnVuaW5kZXhlZENoYXJzICYmIGlzU3RyaW5nKHZhbHVlKSkgewogICAgdmFyIGluZGV4ID0gLTEsCiAgICAgICAgbGVuZ3RoID0gdmFsdWUubGVuZ3RoLAogICAgICAgIHJlc3VsdCA9IE9iamVjdCh2YWx1ZSk7CgogICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHsKICAgICAgcmVzdWx0W2luZGV4XSA9IHZhbHVlLmNoYXJBdChpbmRleCk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICByZXR1cm4gaXNPYmplY3QodmFsdWUpID8gdmFsdWUgOiBPYmplY3QodmFsdWUpOwp9Cgptb2R1bGUuZXhwb3J0cyA9IHRvT2JqZWN0OwoKfSx7Ii4uL2xhbmcvaXNPYmplY3QiOjMzLCIuLi9sYW5nL2lzU3RyaW5nIjozNSwiLi4vc3VwcG9ydCI6NDF9XSwyOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBpc0FycmF5TGlrZSA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2lzQXJyYXlMaWtlJyksCiAgICBpc09iamVjdExpa2UgPSBfZGVyZXFfKCcuLi9pbnRlcm5hbC9pc09iamVjdExpa2UnKTsKCi8qKiBVc2VkIGZvciBuYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMuICovCnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7CgovKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi8KdmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7CgovKiogTmF0aXZlIG1ldGhvZCByZWZlcmVuY2VzLiAqLwp2YXIgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKgogKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGFuIGBhcmd1bWVudHNgIG9iamVjdC4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAY2F0ZWdvcnkgTGFuZwogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay4KICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgY29ycmVjdGx5IGNsYXNzaWZpZWQsIGVsc2UgYGZhbHNlYC4KICogQGV4YW1wbGUKICoKICogXy5pc0FyZ3VtZW50cyhmdW5jdGlvbigpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKTsKICogLy8gPT4gdHJ1ZQogKgogKiBfLmlzQXJndW1lbnRzKFsxLCAyLCAzXSk7CiAqIC8vID0+IGZhbHNlCiAqLwpmdW5jdGlvbiBpc0FyZ3VtZW50cyh2YWx1ZSkgewogIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGlzQXJyYXlMaWtlKHZhbHVlKSAmJgogICAgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpICYmICFwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHZhbHVlLCAnY2FsbGVlJyk7Cn0KCm1vZHVsZS5leHBvcnRzID0gaXNBcmd1bWVudHM7Cgp9LHsiLi4vaW50ZXJuYWwvaXNBcnJheUxpa2UiOjIxLCIuLi9pbnRlcm5hbC9pc09iamVjdExpa2UiOjI2fV0sMzA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgZ2V0TmF0aXZlID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvZ2V0TmF0aXZlJyksCiAgICBpc0xlbmd0aCA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2lzTGVuZ3RoJyksCiAgICBpc09iamVjdExpa2UgPSBfZGVyZXFfKCcuLi9pbnRlcm5hbC9pc09iamVjdExpa2UnKTsKCi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi8KdmFyIGFycmF5VGFnID0gJ1tvYmplY3QgQXJyYXldJzsKCi8qKiBVc2VkIGZvciBuYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMuICovCnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7CgovKioKICogVXNlZCB0byByZXNvbHZlIHRoZSBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNi4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZykKICogb2YgdmFsdWVzLgogKi8KdmFyIG9ialRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7CgovKiBOYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqLwp2YXIgbmF0aXZlSXNBcnJheSA9IGdldE5hdGl2ZShBcnJheSwgJ2lzQXJyYXknKTsKCi8qKgogKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGFuIGBBcnJheWAgb2JqZWN0LgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBMYW5nCiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBjb3JyZWN0bHkgY2xhc3NpZmllZCwgZWxzZSBgZmFsc2VgLgogKiBAZXhhbXBsZQogKgogKiBfLmlzQXJyYXkoWzEsIDIsIDNdKTsKICogLy8gPT4gdHJ1ZQogKgogKiBfLmlzQXJyYXkoZnVuY3Rpb24oKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSk7CiAqIC8vID0+IGZhbHNlCiAqLwp2YXIgaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24odmFsdWUpIHsKICByZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmIG9ialRvU3RyaW5nLmNhbGwodmFsdWUpID09IGFycmF5VGFnOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBpc0FycmF5OwoKfSx7Ii4uL2ludGVybmFsL2dldE5hdGl2ZSI6MjAsIi4uL2ludGVybmFsL2lzTGVuZ3RoIjoyNSwiLi4vaW50ZXJuYWwvaXNPYmplY3RMaWtlIjoyNn1dLDMxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGlzT2JqZWN0ID0gX2RlcmVxXygnLi9pc09iamVjdCcpOwoKLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqLwp2YXIgZnVuY1RhZyA9ICdbb2JqZWN0IEZ1bmN0aW9uXSc7CgovKiogVXNlZCBmb3IgbmF0aXZlIG1ldGhvZCByZWZlcmVuY2VzLiAqLwp2YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKLyoqCiAqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgW2B0b1N0cmluZ1RhZ2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLW9iamVjdC5wcm90b3R5cGUudG9zdHJpbmcpCiAqIG9mIHZhbHVlcy4KICovCnZhciBvYmpUb1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nOwoKLyoqCiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYSBgRnVuY3Rpb25gIG9iamVjdC4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAY2F0ZWdvcnkgTGFuZwogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay4KICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgY29ycmVjdGx5IGNsYXNzaWZpZWQsIGVsc2UgYGZhbHNlYC4KICogQGV4YW1wbGUKICoKICogXy5pc0Z1bmN0aW9uKF8pOwogKiAvLyA9PiB0cnVlCiAqCiAqIF8uaXNGdW5jdGlvbigvYWJjLyk7CiAqIC8vID0+IGZhbHNlCiAqLwpmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7CiAgLy8gVGhlIHVzZSBvZiBgT2JqZWN0I3RvU3RyaW5nYCBhdm9pZHMgaXNzdWVzIHdpdGggdGhlIGB0eXBlb2ZgIG9wZXJhdG9yCiAgLy8gaW4gb2xkZXIgdmVyc2lvbnMgb2YgQ2hyb21lIGFuZCBTYWZhcmkgd2hpY2ggcmV0dXJuICdmdW5jdGlvbicgZm9yIHJlZ2V4ZXMKICAvLyBhbmQgU2FmYXJpIDggd2hpY2ggcmV0dXJucyAnb2JqZWN0JyBmb3IgdHlwZWQgYXJyYXkgY29uc3RydWN0b3JzLgogIHJldHVybiBpc09iamVjdCh2YWx1ZSkgJiYgb2JqVG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gZnVuY1RhZzsKfQoKbW9kdWxlLmV4cG9ydHMgPSBpc0Z1bmN0aW9uOwoKfSx7Ii4vaXNPYmplY3QiOjMzfV0sMzI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgaXNGdW5jdGlvbiA9IF9kZXJlcV8oJy4vaXNGdW5jdGlvbicpLAogICAgaXNIb3N0T2JqZWN0ID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvaXNIb3N0T2JqZWN0JyksCiAgICBpc09iamVjdExpa2UgPSBfZGVyZXFfKCcuLi9pbnRlcm5hbC9pc09iamVjdExpa2UnKTsKCi8qKiBVc2VkIHRvIGRldGVjdCBob3N0IGNvbnN0cnVjdG9ycyAoU2FmYXJpID4gNSkuICovCnZhciByZUlzSG9zdEN0b3IgPSAvXlxbb2JqZWN0IC4rP0NvbnN0cnVjdG9yXF0kLzsKCi8qKiBVc2VkIGZvciBuYXRpdmUgbWV0aG9kIHJlZmVyZW5jZXMuICovCnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7CgovKiogVXNlZCB0byByZXNvbHZlIHRoZSBkZWNvbXBpbGVkIHNvdXJjZSBvZiBmdW5jdGlvbnMuICovCnZhciBmblRvU3RyaW5nID0gRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nOwoKLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovCnZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5OwoKLyoqIFVzZWQgdG8gZGV0ZWN0IGlmIGEgbWV0aG9kIGlzIG5hdGl2ZS4gKi8KdmFyIHJlSXNOYXRpdmUgPSBSZWdFeHAoJ14nICsKICBmblRvU3RyaW5nLmNhbGwoaGFzT3duUHJvcGVydHkpLnJlcGxhY2UoL1tcXF4kLiorPygpW1xde318XS9nLCAnXFwkJicpCiAgLnJlcGxhY2UoL2hhc093blByb3BlcnR5fChmdW5jdGlvbikuKj8oPz1cXFwoKXwgZm9yIC4rPyg/PVxcXF0pL2csICckMS4qPycpICsgJyQnCik7CgovKioKICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBuYXRpdmUgZnVuY3Rpb24uCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IExhbmcKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbmF0aXZlIGZ1bmN0aW9uLCBlbHNlIGBmYWxzZWAuCiAqIEBleGFtcGxlCiAqCiAqIF8uaXNOYXRpdmUoQXJyYXkucHJvdG90eXBlLnB1c2gpOwogKiAvLyA9PiB0cnVlCiAqCiAqIF8uaXNOYXRpdmUoXyk7CiAqIC8vID0+IGZhbHNlCiAqLwpmdW5jdGlvbiBpc05hdGl2ZSh2YWx1ZSkgewogIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkgewogICAgcmV0dXJuIHJlSXNOYXRpdmUudGVzdChmblRvU3RyaW5nLmNhbGwodmFsdWUpKTsKICB9CiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgKGlzSG9zdE9iamVjdCh2YWx1ZSkgPyByZUlzTmF0aXZlIDogcmVJc0hvc3RDdG9yKS50ZXN0KHZhbHVlKTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBpc05hdGl2ZTsKCn0seyIuLi9pbnRlcm5hbC9pc0hvc3RPYmplY3QiOjIyLCIuLi9pbnRlcm5hbC9pc09iamVjdExpa2UiOjI2LCIuL2lzRnVuY3Rpb24iOjMxfV0sMzM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgdGhlIFtsYW5ndWFnZSB0eXBlXShodHRwczovL2VzNS5naXRodWIuaW8vI3g4KSBvZiBgT2JqZWN0YC4KICogKGUuZy4gYXJyYXlzLCBmdW5jdGlvbnMsIG9iamVjdHMsIHJlZ2V4ZXMsIGBuZXcgTnVtYmVyKDApYCwgYW5kIGBuZXcgU3RyaW5nKCcnKWApCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IExhbmcKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIG9iamVjdCwgZWxzZSBgZmFsc2VgLgogKiBAZXhhbXBsZQogKgogKiBfLmlzT2JqZWN0KHt9KTsKICogLy8gPT4gdHJ1ZQogKgogKiBfLmlzT2JqZWN0KFsxLCAyLCAzXSk7CiAqIC8vID0+IHRydWUKICoKICogXy5pc09iamVjdCgxKTsKICogLy8gPT4gZmFsc2UKICovCmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7CiAgLy8gQXZvaWQgYSBWOCBKSVQgYnVnIGluIENocm9tZSAxOS0yMC4KICAvLyBTZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTIyOTEgZm9yIG1vcmUgZGV0YWlscy4KICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTsKICByZXR1cm4gISF2YWx1ZSAmJiAodHlwZSA9PSAnb2JqZWN0JyB8fCB0eXBlID09ICdmdW5jdGlvbicpOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlzT2JqZWN0OwoKfSx7fV0sMzQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgYmFzZUZvckluID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvYmFzZUZvckluJyksCiAgICBpc0FyZ3VtZW50cyA9IF9kZXJlcV8oJy4vaXNBcmd1bWVudHMnKSwKICAgIGlzSG9zdE9iamVjdCA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2lzSG9zdE9iamVjdCcpLAogICAgaXNPYmplY3RMaWtlID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvaXNPYmplY3RMaWtlJyksCiAgICBzdXBwb3J0ID0gX2RlcmVxXygnLi4vc3VwcG9ydCcpOwoKLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqLwp2YXIgb2JqZWN0VGFnID0gJ1tvYmplY3QgT2JqZWN0XSc7CgovKiogVXNlZCBmb3IgbmF0aXZlIG1ldGhvZCByZWZlcmVuY2VzLiAqLwp2YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovCnZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5OwoKLyoqCiAqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgW2B0b1N0cmluZ1RhZ2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLW9iamVjdC5wcm90b3R5cGUudG9zdHJpbmcpCiAqIG9mIHZhbHVlcy4KICovCnZhciBvYmpUb1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nOwoKLyoqCiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgcGxhaW4gb2JqZWN0LCB0aGF0IGlzLCBhbiBvYmplY3QgY3JlYXRlZCBieSB0aGUKICogYE9iamVjdGAgY29uc3RydWN0b3Igb3Igb25lIHdpdGggYSBgW1tQcm90b3R5cGVdXWAgb2YgYG51bGxgLgogKgogKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgYXNzdW1lcyBvYmplY3RzIGNyZWF0ZWQgYnkgdGhlIGBPYmplY3RgIGNvbnN0cnVjdG9yCiAqIGhhdmUgbm8gaW5oZXJpdGVkIGVudW1lcmFibGUgcHJvcGVydGllcy4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAY2F0ZWdvcnkgTGFuZwogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay4KICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBwbGFpbiBvYmplY3QsIGVsc2UgYGZhbHNlYC4KICogQGV4YW1wbGUKICoKICogZnVuY3Rpb24gRm9vKCkgewogKiAgIHRoaXMuYSA9IDE7CiAqIH0KICoKICogXy5pc1BsYWluT2JqZWN0KG5ldyBGb28pOwogKiAvLyA9PiBmYWxzZQogKgogKiBfLmlzUGxhaW5PYmplY3QoWzEsIDIsIDNdKTsKICogLy8gPT4gZmFsc2UKICoKICogXy5pc1BsYWluT2JqZWN0KHsgJ3gnOiAwLCAneSc6IDAgfSk7CiAqIC8vID0+IHRydWUKICoKICogXy5pc1BsYWluT2JqZWN0KE9iamVjdC5jcmVhdGUobnVsbCkpOwogKiAvLyA9PiB0cnVlCiAqLwpmdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbHVlKSB7CiAgdmFyIEN0b3I7CgogIC8vIEV4aXQgZWFybHkgZm9yIG5vbiBgT2JqZWN0YCBvYmplY3RzLgogIGlmICghKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgb2JqVG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gb2JqZWN0VGFnICYmICFpc0hvc3RPYmplY3QodmFsdWUpICYmICFpc0FyZ3VtZW50cyh2YWx1ZSkpIHx8CiAgICAgICghaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NvbnN0cnVjdG9yJykgJiYgKEN0b3IgPSB2YWx1ZS5jb25zdHJ1Y3RvciwgdHlwZW9mIEN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiAhKEN0b3IgaW5zdGFuY2VvZiBDdG9yKSkpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIC8vIElFIDwgOSBpdGVyYXRlcyBpbmhlcml0ZWQgcHJvcGVydGllcyBiZWZvcmUgb3duIHByb3BlcnRpZXMuIElmIHRoZSBmaXJzdAogIC8vIGl0ZXJhdGVkIHByb3BlcnR5IGlzIGFuIG9iamVjdCdzIG93biBwcm9wZXJ0eSB0aGVuIHRoZXJlIGFyZSBubyBpbmhlcml0ZWQKICAvLyBlbnVtZXJhYmxlIHByb3BlcnRpZXMuCiAgdmFyIHJlc3VsdDsKICBpZiAoc3VwcG9ydC5vd25MYXN0KSB7CiAgICBiYXNlRm9ySW4odmFsdWUsIGZ1bmN0aW9uKHN1YlZhbHVlLCBrZXksIG9iamVjdCkgewogICAgICByZXN1bHQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0ICE9PSBmYWxzZTsKICB9CiAgLy8gSW4gbW9zdCBlbnZpcm9ubWVudHMgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgYXJlIGl0ZXJhdGVkIGJlZm9yZQogIC8vIGl0cyBpbmhlcml0ZWQgcHJvcGVydGllcy4gSWYgdGhlIGxhc3QgaXRlcmF0ZWQgcHJvcGVydHkgaXMgYW4gb2JqZWN0J3MKICAvLyBvd24gcHJvcGVydHkgdGhlbiB0aGVyZSBhcmUgbm8gaW5oZXJpdGVkIGVudW1lcmFibGUgcHJvcGVydGllcy4KICBiYXNlRm9ySW4odmFsdWUsIGZ1bmN0aW9uKHN1YlZhbHVlLCBrZXkpIHsKICAgIHJlc3VsdCA9IGtleTsKICB9KTsKICByZXR1cm4gcmVzdWx0ID09PSB1bmRlZmluZWQgfHwgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgcmVzdWx0KTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBpc1BsYWluT2JqZWN0OwoKfSx7Ii4uL2ludGVybmFsL2Jhc2VGb3JJbiI6MTIsIi4uL2ludGVybmFsL2lzSG9zdE9iamVjdCI6MjIsIi4uL2ludGVybmFsL2lzT2JqZWN0TGlrZSI6MjYsIi4uL3N1cHBvcnQiOjQxLCIuL2lzQXJndW1lbnRzIjoyOX1dLDM1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGlzT2JqZWN0TGlrZSA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2lzT2JqZWN0TGlrZScpOwoKLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqLwp2YXIgc3RyaW5nVGFnID0gJ1tvYmplY3QgU3RyaW5nXSc7CgovKiogVXNlZCBmb3IgbmF0aXZlIG1ldGhvZCByZWZlcmVuY2VzLiAqLwp2YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKLyoqCiAqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgW2B0b1N0cmluZ1RhZ2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLW9iamVjdC5wcm90b3R5cGUudG9zdHJpbmcpCiAqIG9mIHZhbHVlcy4KICovCnZhciBvYmpUb1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nOwoKLyoqCiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYSBgU3RyaW5nYCBwcmltaXRpdmUgb3Igb2JqZWN0LgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBMYW5nCiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLgogKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBjb3JyZWN0bHkgY2xhc3NpZmllZCwgZWxzZSBgZmFsc2VgLgogKiBAZXhhbXBsZQogKgogKiBfLmlzU3RyaW5nKCdhYmMnKTsKICogLy8gPT4gdHJ1ZQogKgogKiBfLmlzU3RyaW5nKDEpOwogKiAvLyA9PiBmYWxzZQogKi8KZnVuY3Rpb24gaXNTdHJpbmcodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnIHx8IChpc09iamVjdExpa2UodmFsdWUpICYmIG9ialRvU3RyaW5nLmNhbGwodmFsdWUpID09IHN0cmluZ1RhZyk7Cn0KCm1vZHVsZS5leHBvcnRzID0gaXNTdHJpbmc7Cgp9LHsiLi4vaW50ZXJuYWwvaXNPYmplY3RMaWtlIjoyNn1dLDM2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGlzTGVuZ3RoID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvaXNMZW5ndGgnKSwKICAgIGlzT2JqZWN0TGlrZSA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2lzT2JqZWN0TGlrZScpOwoKLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqLwp2YXIgYXJnc1RhZyA9ICdbb2JqZWN0IEFyZ3VtZW50c10nLAogICAgYXJyYXlUYWcgPSAnW29iamVjdCBBcnJheV0nLAogICAgYm9vbFRhZyA9ICdbb2JqZWN0IEJvb2xlYW5dJywKICAgIGRhdGVUYWcgPSAnW29iamVjdCBEYXRlXScsCiAgICBlcnJvclRhZyA9ICdbb2JqZWN0IEVycm9yXScsCiAgICBmdW5jVGFnID0gJ1tvYmplY3QgRnVuY3Rpb25dJywKICAgIG1hcFRhZyA9ICdbb2JqZWN0IE1hcF0nLAogICAgbnVtYmVyVGFnID0gJ1tvYmplY3QgTnVtYmVyXScsCiAgICBvYmplY3RUYWcgPSAnW29iamVjdCBPYmplY3RdJywKICAgIHJlZ2V4cFRhZyA9ICdbb2JqZWN0IFJlZ0V4cF0nLAogICAgc2V0VGFnID0gJ1tvYmplY3QgU2V0XScsCiAgICBzdHJpbmdUYWcgPSAnW29iamVjdCBTdHJpbmddJywKICAgIHdlYWtNYXBUYWcgPSAnW29iamVjdCBXZWFrTWFwXSc7Cgp2YXIgYXJyYXlCdWZmZXJUYWcgPSAnW29iamVjdCBBcnJheUJ1ZmZlcl0nLAogICAgZmxvYXQzMlRhZyA9ICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nLAogICAgZmxvYXQ2NFRhZyA9ICdbb2JqZWN0IEZsb2F0NjRBcnJheV0nLAogICAgaW50OFRhZyA9ICdbb2JqZWN0IEludDhBcnJheV0nLAogICAgaW50MTZUYWcgPSAnW29iamVjdCBJbnQxNkFycmF5XScsCiAgICBpbnQzMlRhZyA9ICdbb2JqZWN0IEludDMyQXJyYXldJywKICAgIHVpbnQ4VGFnID0gJ1tvYmplY3QgVWludDhBcnJheV0nLAogICAgdWludDhDbGFtcGVkVGFnID0gJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJywKICAgIHVpbnQxNlRhZyA9ICdbb2JqZWN0IFVpbnQxNkFycmF5XScsCiAgICB1aW50MzJUYWcgPSAnW29iamVjdCBVaW50MzJBcnJheV0nOwoKLyoqIFVzZWQgdG8gaWRlbnRpZnkgYHRvU3RyaW5nVGFnYCB2YWx1ZXMgb2YgdHlwZWQgYXJyYXlzLiAqLwp2YXIgdHlwZWRBcnJheVRhZ3MgPSB7fTsKdHlwZWRBcnJheVRhZ3NbZmxvYXQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1tmbG9hdDY0VGFnXSA9CnR5cGVkQXJyYXlUYWdzW2ludDhUYWddID0gdHlwZWRBcnJheVRhZ3NbaW50MTZUYWddID0KdHlwZWRBcnJheVRhZ3NbaW50MzJUYWddID0gdHlwZWRBcnJheVRhZ3NbdWludDhUYWddID0KdHlwZWRBcnJheVRhZ3NbdWludDhDbGFtcGVkVGFnXSA9IHR5cGVkQXJyYXlUYWdzW3VpbnQxNlRhZ10gPQp0eXBlZEFycmF5VGFnc1t1aW50MzJUYWddID0gdHJ1ZTsKdHlwZWRBcnJheVRhZ3NbYXJnc1RhZ10gPSB0eXBlZEFycmF5VGFnc1thcnJheVRhZ10gPQp0eXBlZEFycmF5VGFnc1thcnJheUJ1ZmZlclRhZ10gPSB0eXBlZEFycmF5VGFnc1tib29sVGFnXSA9CnR5cGVkQXJyYXlUYWdzW2RhdGVUYWddID0gdHlwZWRBcnJheVRhZ3NbZXJyb3JUYWddID0KdHlwZWRBcnJheVRhZ3NbZnVuY1RhZ10gPSB0eXBlZEFycmF5VGFnc1ttYXBUYWddID0KdHlwZWRBcnJheVRhZ3NbbnVtYmVyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW29iamVjdFRhZ10gPQp0eXBlZEFycmF5VGFnc1tyZWdleHBUYWddID0gdHlwZWRBcnJheVRhZ3Nbc2V0VGFnXSA9CnR5cGVkQXJyYXlUYWdzW3N0cmluZ1RhZ10gPSB0eXBlZEFycmF5VGFnc1t3ZWFrTWFwVGFnXSA9IGZhbHNlOwoKLyoqIFVzZWQgZm9yIG5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcy4gKi8KdmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKCi8qKgogKiBVc2VkIHRvIHJlc29sdmUgdGhlIFtgdG9TdHJpbmdUYWdgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi82LjAvI3NlYy1vYmplY3QucHJvdG90eXBlLnRvc3RyaW5nKQogKiBvZiB2YWx1ZXMuCiAqLwp2YXIgb2JqVG9TdHJpbmcgPSBvYmplY3RQcm90by50b1N0cmluZzsKCi8qKgogKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgdHlwZWQgYXJyYXkuCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IExhbmcKICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suCiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGNvcnJlY3RseSBjbGFzc2lmaWVkLCBlbHNlIGBmYWxzZWAuCiAqIEBleGFtcGxlCiAqCiAqIF8uaXNUeXBlZEFycmF5KG5ldyBVaW50OEFycmF5KTsKICogLy8gPT4gdHJ1ZQogKgogKiBfLmlzVHlwZWRBcnJheShbXSk7CiAqIC8vID0+IGZhbHNlCiAqLwpmdW5jdGlvbiBpc1R5cGVkQXJyYXkodmFsdWUpIHsKICByZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmICEhdHlwZWRBcnJheVRhZ3Nbb2JqVG9TdHJpbmcuY2FsbCh2YWx1ZSldOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlzVHlwZWRBcnJheTsKCn0seyIuLi9pbnRlcm5hbC9pc0xlbmd0aCI6MjUsIi4uL2ludGVybmFsL2lzT2JqZWN0TGlrZSI6MjZ9XSwzNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CnZhciBiYXNlQ29weSA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2Jhc2VDb3B5JyksCiAgICBrZXlzSW4gPSBfZGVyZXFfKCcuLi9vYmplY3Qva2V5c0luJyk7CgovKioKICogQ29udmVydHMgYHZhbHVlYCB0byBhIHBsYWluIG9iamVjdCBmbGF0dGVuaW5nIGluaGVyaXRlZCBlbnVtZXJhYmxlCiAqIHByb3BlcnRpZXMgb2YgYHZhbHVlYCB0byBvd24gcHJvcGVydGllcyBvZiB0aGUgcGxhaW4gb2JqZWN0LgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBMYW5nCiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuCiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBwbGFpbiBvYmplY3QuCiAqIEBleGFtcGxlCiAqCiAqIGZ1bmN0aW9uIEZvbygpIHsKICogICB0aGlzLmIgPSAyOwogKiB9CiAqCiAqIEZvby5wcm90b3R5cGUuYyA9IDM7CiAqCiAqIF8uYXNzaWduKHsgJ2EnOiAxIH0sIG5ldyBGb28pOwogKiAvLyA9PiB7ICdhJzogMSwgJ2InOiAyIH0KICoKICogXy5hc3NpZ24oeyAnYSc6IDEgfSwgXy50b1BsYWluT2JqZWN0KG5ldyBGb28pKTsKICogLy8gPT4geyAnYSc6IDEsICdiJzogMiwgJ2MnOiAzIH0KICovCmZ1bmN0aW9uIHRvUGxhaW5PYmplY3QodmFsdWUpIHsKICByZXR1cm4gYmFzZUNvcHkodmFsdWUsIGtleXNJbih2YWx1ZSkpOwp9Cgptb2R1bGUuZXhwb3J0cyA9IHRvUGxhaW5PYmplY3Q7Cgp9LHsiLi4vaW50ZXJuYWwvYmFzZUNvcHkiOjEwLCIuLi9vYmplY3Qva2V5c0luIjozOX1dLDM4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGdldE5hdGl2ZSA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2dldE5hdGl2ZScpLAogICAgaXNBcnJheUxpa2UgPSBfZGVyZXFfKCcuLi9pbnRlcm5hbC9pc0FycmF5TGlrZScpLAogICAgaXNPYmplY3QgPSBfZGVyZXFfKCcuLi9sYW5nL2lzT2JqZWN0JyksCiAgICBzaGltS2V5cyA9IF9kZXJlcV8oJy4uL2ludGVybmFsL3NoaW1LZXlzJyksCiAgICBzdXBwb3J0ID0gX2RlcmVxXygnLi4vc3VwcG9ydCcpOwoKLyogTmF0aXZlIG1ldGhvZCByZWZlcmVuY2VzIGZvciB0aG9zZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcy4gKi8KdmFyIG5hdGl2ZUtleXMgPSBnZXROYXRpdmUoT2JqZWN0LCAna2V5cycpOwoKLyoqCiAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgdGhlIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIGBvYmplY3RgLgogKgogKiAqKk5vdGU6KiogTm9uLW9iamVjdCB2YWx1ZXMgYXJlIGNvZXJjZWQgdG8gb2JqZWN0cy4gU2VlIHRoZQogKiBbRVMgc3BlY10oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNi4wLyNzZWMtb2JqZWN0LmtleXMpCiAqIGZvciBtb3JlIGRldGFpbHMuCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IE9iamVjdAogKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuCiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuCiAqIEBleGFtcGxlCiAqCiAqIGZ1bmN0aW9uIEZvbygpIHsKICogICB0aGlzLmEgPSAxOwogKiAgIHRoaXMuYiA9IDI7CiAqIH0KICoKICogRm9vLnByb3RvdHlwZS5jID0gMzsKICoKICogXy5rZXlzKG5ldyBGb28pOwogKiAvLyA9PiBbJ2EnLCAnYiddIChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpCiAqCiAqIF8ua2V5cygnaGknKTsKICogLy8gPT4gWycwJywgJzEnXQogKi8KdmFyIGtleXMgPSAhbmF0aXZlS2V5cyA/IHNoaW1LZXlzIDogZnVuY3Rpb24ob2JqZWN0KSB7CiAgdmFyIEN0b3IgPSBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdC5jb25zdHJ1Y3RvcjsKICBpZiAoKHR5cGVvZiBDdG9yID09ICdmdW5jdGlvbicgJiYgQ3Rvci5wcm90b3R5cGUgPT09IG9iamVjdCkgfHwKICAgICAgKHR5cGVvZiBvYmplY3QgPT0gJ2Z1bmN0aW9uJyA/IHN1cHBvcnQuZW51bVByb3RvdHlwZXMgOiBpc0FycmF5TGlrZShvYmplY3QpKSkgewogICAgcmV0dXJuIHNoaW1LZXlzKG9iamVjdCk7CiAgfQogIHJldHVybiBpc09iamVjdChvYmplY3QpID8gbmF0aXZlS2V5cyhvYmplY3QpIDogW107Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGtleXM7Cgp9LHsiLi4vaW50ZXJuYWwvZ2V0TmF0aXZlIjoyMCwiLi4vaW50ZXJuYWwvaXNBcnJheUxpa2UiOjIxLCIuLi9pbnRlcm5hbC9zaGltS2V5cyI6MjcsIi4uL2xhbmcvaXNPYmplY3QiOjMzLCIuLi9zdXBwb3J0Ijo0MX1dLDM5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGFycmF5RWFjaCA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2FycmF5RWFjaCcpLAogICAgaXNBcmd1bWVudHMgPSBfZGVyZXFfKCcuLi9sYW5nL2lzQXJndW1lbnRzJyksCiAgICBpc0FycmF5ID0gX2RlcmVxXygnLi4vbGFuZy9pc0FycmF5JyksCiAgICBpc0Z1bmN0aW9uID0gX2RlcmVxXygnLi4vbGFuZy9pc0Z1bmN0aW9uJyksCiAgICBpc0luZGV4ID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvaXNJbmRleCcpLAogICAgaXNMZW5ndGggPSBfZGVyZXFfKCcuLi9pbnRlcm5hbC9pc0xlbmd0aCcpLAogICAgaXNPYmplY3QgPSBfZGVyZXFfKCcuLi9sYW5nL2lzT2JqZWN0JyksCiAgICBpc1N0cmluZyA9IF9kZXJlcV8oJy4uL2xhbmcvaXNTdHJpbmcnKSwKICAgIHN1cHBvcnQgPSBfZGVyZXFfKCcuLi9zdXBwb3J0Jyk7CgovKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHJlZmVyZW5jZXMuICovCnZhciBhcnJheVRhZyA9ICdbb2JqZWN0IEFycmF5XScsCiAgICBib29sVGFnID0gJ1tvYmplY3QgQm9vbGVhbl0nLAogICAgZGF0ZVRhZyA9ICdbb2JqZWN0IERhdGVdJywKICAgIGVycm9yVGFnID0gJ1tvYmplY3QgRXJyb3JdJywKICAgIGZ1bmNUYWcgPSAnW29iamVjdCBGdW5jdGlvbl0nLAogICAgbnVtYmVyVGFnID0gJ1tvYmplY3QgTnVtYmVyXScsCiAgICBvYmplY3RUYWcgPSAnW29iamVjdCBPYmplY3RdJywKICAgIHJlZ2V4cFRhZyA9ICdbb2JqZWN0IFJlZ0V4cF0nLAogICAgc3RyaW5nVGFnID0gJ1tvYmplY3QgU3RyaW5nXSc7CgovKiogVXNlZCB0byBmaXggdGhlIEpTY3JpcHQgYFtbRG9udEVudW1dXWAgYnVnLiAqLwp2YXIgc2hhZG93UHJvcHMgPSBbCiAgJ2NvbnN0cnVjdG9yJywgJ2hhc093blByb3BlcnR5JywgJ2lzUHJvdG90eXBlT2YnLCAncHJvcGVydHlJc0VudW1lcmFibGUnLAogICd0b0xvY2FsZVN0cmluZycsICd0b1N0cmluZycsICd2YWx1ZU9mJwpdOwoKLyoqIFVzZWQgZm9yIG5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcy4gKi8KdmFyIGVycm9yUHJvdG8gPSBFcnJvci5wcm90b3R5cGUsCiAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGUsCiAgICBzdHJpbmdQcm90byA9IFN0cmluZy5wcm90b3R5cGU7CgovKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi8KdmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7CgovKioKICogVXNlZCB0byByZXNvbHZlIHRoZSBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNi4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZykKICogb2YgdmFsdWVzLgogKi8KdmFyIG9ialRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7CgovKiogVXNlZCB0byBhdm9pZCBpdGVyYXRpbmcgb3ZlciBub24tZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGluIElFIDwgOS4gKi8KdmFyIG5vbkVudW1Qcm9wcyA9IHt9Owpub25FbnVtUHJvcHNbYXJyYXlUYWddID0gbm9uRW51bVByb3BzW2RhdGVUYWddID0gbm9uRW51bVByb3BzW251bWJlclRhZ10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b0xvY2FsZVN0cmluZyc6IHRydWUsICd0b1N0cmluZyc6IHRydWUsICd2YWx1ZU9mJzogdHJ1ZSB9Owpub25FbnVtUHJvcHNbYm9vbFRhZ10gPSBub25FbnVtUHJvcHNbc3RyaW5nVGFnXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSwgJ3RvU3RyaW5nJzogdHJ1ZSwgJ3ZhbHVlT2YnOiB0cnVlIH07Cm5vbkVudW1Qcm9wc1tlcnJvclRhZ10gPSBub25FbnVtUHJvcHNbZnVuY1RhZ10gPSBub25FbnVtUHJvcHNbcmVnZXhwVGFnXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSwgJ3RvU3RyaW5nJzogdHJ1ZSB9Owpub25FbnVtUHJvcHNbb2JqZWN0VGFnXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSB9OwoKYXJyYXlFYWNoKHNoYWRvd1Byb3BzLCBmdW5jdGlvbihrZXkpIHsKICBmb3IgKHZhciB0YWcgaW4gbm9uRW51bVByb3BzKSB7CiAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChub25FbnVtUHJvcHMsIHRhZykpIHsKICAgICAgdmFyIHByb3BzID0gbm9uRW51bVByb3BzW3RhZ107CiAgICAgIHByb3BzW2tleV0gPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3BzLCBrZXkpOwogICAgfQogIH0KfSk7CgovKioKICogQ3JlYXRlcyBhbiBhcnJheSBvZiB0aGUgb3duIGFuZCBpbmhlcml0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBvZiBgb2JqZWN0YC4KICoKICogKipOb3RlOioqIE5vbi1vYmplY3QgdmFsdWVzIGFyZSBjb2VyY2VkIHRvIG9iamVjdHMuCiAqCiAqIEBzdGF0aWMKICogQG1lbWJlck9mIF8KICogQGNhdGVnb3J5IE9iamVjdAogKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuCiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuCiAqIEBleGFtcGxlCiAqCiAqIGZ1bmN0aW9uIEZvbygpIHsKICogICB0aGlzLmEgPSAxOwogKiAgIHRoaXMuYiA9IDI7CiAqIH0KICoKICogRm9vLnByb3RvdHlwZS5jID0gMzsKICoKICogXy5rZXlzSW4obmV3IEZvbyk7CiAqIC8vID0+IFsnYScsICdiJywgJ2MnXSAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKQogKi8KZnVuY3Rpb24ga2V5c0luKG9iamVjdCkgewogIGlmIChvYmplY3QgPT0gbnVsbCkgewogICAgcmV0dXJuIFtdOwogIH0KICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHsKICAgIG9iamVjdCA9IE9iamVjdChvYmplY3QpOwogIH0KICB2YXIgbGVuZ3RoID0gb2JqZWN0Lmxlbmd0aDsKCiAgbGVuZ3RoID0gKGxlbmd0aCAmJiBpc0xlbmd0aChsZW5ndGgpICYmCiAgICAoaXNBcnJheShvYmplY3QpIHx8IGlzQXJndW1lbnRzKG9iamVjdCkgfHwgaXNTdHJpbmcob2JqZWN0KSkgJiYgbGVuZ3RoKSB8fCAwOwoKICB2YXIgQ3RvciA9IG9iamVjdC5jb25zdHJ1Y3RvciwKICAgICAgaW5kZXggPSAtMSwKICAgICAgcHJvdG8gPSAoaXNGdW5jdGlvbihDdG9yKSAmJiBDdG9yLnByb3RvdHlwZSkgfHwgb2JqZWN0UHJvdG8sCiAgICAgIGlzUHJvdG8gPSBwcm90byA9PT0gb2JqZWN0LAogICAgICByZXN1bHQgPSBBcnJheShsZW5ndGgpLAogICAgICBza2lwSW5kZXhlcyA9IGxlbmd0aCA+IDAsCiAgICAgIHNraXBFcnJvclByb3BzID0gc3VwcG9ydC5lbnVtRXJyb3JQcm9wcyAmJiAob2JqZWN0ID09PSBlcnJvclByb3RvIHx8IG9iamVjdCBpbnN0YW5jZW9mIEVycm9yKSwKICAgICAgc2tpcFByb3RvID0gc3VwcG9ydC5lbnVtUHJvdG90eXBlcyAmJiBpc0Z1bmN0aW9uKG9iamVjdCk7CgogIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7CiAgICByZXN1bHRbaW5kZXhdID0gKGluZGV4ICsgJycpOwogIH0KICAvLyBsb2Rhc2ggc2tpcHMgdGhlIGBjb25zdHJ1Y3RvcmAgcHJvcGVydHkgd2hlbiBpdCBpbmZlcnMgaXQncyBpdGVyYXRpbmcKICAvLyBvdmVyIGEgYHByb3RvdHlwZWAgb2JqZWN0IGJlY2F1c2UgSUUgPCA5IGNhbid0IHNldCB0aGUgYFtbRW51bWVyYWJsZV1dYAogIC8vIGF0dHJpYnV0ZSBvZiBhbiBleGlzdGluZyBwcm9wZXJ0eSBhbmQgdGhlIGBjb25zdHJ1Y3RvcmAgcHJvcGVydHkgb2YgYQogIC8vIHByb3RvdHlwZSBkZWZhdWx0cyB0byBub24tZW51bWVyYWJsZS4KICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7CiAgICBpZiAoIShza2lwUHJvdG8gJiYga2V5ID09ICdwcm90b3R5cGUnKSAmJgogICAgICAgICEoc2tpcEVycm9yUHJvcHMgJiYgKGtleSA9PSAnbWVzc2FnZScgfHwga2V5ID09ICduYW1lJykpICYmCiAgICAgICAgIShza2lwSW5kZXhlcyAmJiBpc0luZGV4KGtleSwgbGVuZ3RoKSkgJiYKICAgICAgICAhKGtleSA9PSAnY29uc3RydWN0b3InICYmIChpc1Byb3RvIHx8ICFoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSkpKSB7CiAgICAgIHJlc3VsdC5wdXNoKGtleSk7CiAgICB9CiAgfQogIGlmIChzdXBwb3J0Lm5vbkVudW1TaGFkb3dzICYmIG9iamVjdCAhPT0gb2JqZWN0UHJvdG8pIHsKICAgIHZhciB0YWcgPSBvYmplY3QgPT09IHN0cmluZ1Byb3RvID8gc3RyaW5nVGFnIDogKG9iamVjdCA9PT0gZXJyb3JQcm90byA/IGVycm9yVGFnIDogb2JqVG9TdHJpbmcuY2FsbChvYmplY3QpKSwKICAgICAgICBub25FbnVtcyA9IG5vbkVudW1Qcm9wc1t0YWddIHx8IG5vbkVudW1Qcm9wc1tvYmplY3RUYWddOwoKICAgIGlmICh0YWcgPT0gb2JqZWN0VGFnKSB7CiAgICAgIHByb3RvID0gb2JqZWN0UHJvdG87CiAgICB9CiAgICBsZW5ndGggPSBzaGFkb3dQcm9wcy5sZW5ndGg7CiAgICB3aGlsZSAobGVuZ3RoLS0pIHsKICAgICAga2V5ID0gc2hhZG93UHJvcHNbbGVuZ3RoXTsKICAgICAgdmFyIG5vbkVudW0gPSBub25FbnVtc1trZXldOwogICAgICBpZiAoIShpc1Byb3RvICYmIG5vbkVudW0pICYmCiAgICAgICAgICAobm9uRW51bSA/IGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpIDogb2JqZWN0W2tleV0gIT09IHByb3RvW2tleV0pKSB7CiAgICAgICAgcmVzdWx0LnB1c2goa2V5KTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gcmVzdWx0Owp9Cgptb2R1bGUuZXhwb3J0cyA9IGtleXNJbjsKCn0seyIuLi9pbnRlcm5hbC9hcnJheUVhY2giOjksIi4uL2ludGVybmFsL2lzSW5kZXgiOjIzLCIuLi9pbnRlcm5hbC9pc0xlbmd0aCI6MjUsIi4uL2xhbmcvaXNBcmd1bWVudHMiOjI5LCIuLi9sYW5nL2lzQXJyYXkiOjMwLCIuLi9sYW5nL2lzRnVuY3Rpb24iOjMxLCIuLi9sYW5nL2lzT2JqZWN0IjozMywiLi4vbGFuZy9pc1N0cmluZyI6MzUsIi4uL3N1cHBvcnQiOjQxfV0sNDA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgYmFzZU1lcmdlID0gX2RlcmVxXygnLi4vaW50ZXJuYWwvYmFzZU1lcmdlJyksCiAgICBjcmVhdGVBc3NpZ25lciA9IF9kZXJlcV8oJy4uL2ludGVybmFsL2NyZWF0ZUFzc2lnbmVyJyk7CgovKioKICogUmVjdXJzaXZlbHkgbWVyZ2VzIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgb2YgdGhlIHNvdXJjZSBvYmplY3QocyksIHRoYXQKICogZG9uJ3QgcmVzb2x2ZSB0byBgdW5kZWZpbmVkYCBpbnRvIHRoZSBkZXN0aW5hdGlvbiBvYmplY3QuIFN1YnNlcXVlbnQgc291cmNlcwogKiBvdmVyd3JpdGUgcHJvcGVydHkgYXNzaWdubWVudHMgb2YgcHJldmlvdXMgc291cmNlcy4gSWYgYGN1c3RvbWl6ZXJgIGlzCiAqIHByb3ZpZGVkIGl0J3MgaW52b2tlZCB0byBwcm9kdWNlIHRoZSBtZXJnZWQgdmFsdWVzIG9mIHRoZSBkZXN0aW5hdGlvbiBhbmQKICogc291cmNlIHByb3BlcnRpZXMuIElmIGBjdXN0b21pemVyYCByZXR1cm5zIGB1bmRlZmluZWRgIG1lcmdpbmcgaXMgaGFuZGxlZAogKiBieSB0aGUgbWV0aG9kIGluc3RlYWQuIFRoZSBgY3VzdG9taXplcmAgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkCiAqIHdpdGggZml2ZSBhcmd1bWVudHM6IChvYmplY3RWYWx1ZSwgc291cmNlVmFsdWUsIGtleSwgb2JqZWN0LCBzb3VyY2UpLgogKgogKiBAc3RhdGljCiAqIEBtZW1iZXJPZiBfCiAqIEBjYXRlZ29yeSBPYmplY3QKICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LgogKiBAcGFyYW0gey4uLk9iamVjdH0gW3NvdXJjZXNdIFRoZSBzb3VyY2Ugb2JqZWN0cy4KICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduZWQgdmFsdWVzLgogKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGN1c3RvbWl6ZXJgLgogKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLgogKiBAZXhhbXBsZQogKgogKiB2YXIgdXNlcnMgPSB7CiAqICAgJ2RhdGEnOiBbeyAndXNlcic6ICdiYXJuZXknIH0sIHsgJ3VzZXInOiAnZnJlZCcgfV0KICogfTsKICoKICogdmFyIGFnZXMgPSB7CiAqICAgJ2RhdGEnOiBbeyAnYWdlJzogMzYgfSwgeyAnYWdlJzogNDAgfV0KICogfTsKICoKICogXy5tZXJnZSh1c2VycywgYWdlcyk7CiAqIC8vID0+IHsgJ2RhdGEnOiBbeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYgfSwgeyAndXNlcic6ICdmcmVkJywgJ2FnZSc6IDQwIH1dIH0KICoKICogLy8gdXNpbmcgYSBjdXN0b21pemVyIGNhbGxiYWNrCiAqIHZhciBvYmplY3QgPSB7CiAqICAgJ2ZydWl0cyc6IFsnYXBwbGUnXSwKICogICAndmVnZXRhYmxlcyc6IFsnYmVldCddCiAqIH07CiAqCiAqIHZhciBvdGhlciA9IHsKICogICAnZnJ1aXRzJzogWydiYW5hbmEnXSwKICogICAndmVnZXRhYmxlcyc6IFsnY2Fycm90J10KICogfTsKICoKICogXy5tZXJnZShvYmplY3QsIG90aGVyLCBmdW5jdGlvbihhLCBiKSB7CiAqICAgaWYgKF8uaXNBcnJheShhKSkgewogKiAgICAgcmV0dXJuIGEuY29uY2F0KGIpOwogKiAgIH0KICogfSk7CiAqIC8vID0+IHsgJ2ZydWl0cyc6IFsnYXBwbGUnLCAnYmFuYW5hJ10sICd2ZWdldGFibGVzJzogWydiZWV0JywgJ2NhcnJvdCddIH0KICovCnZhciBtZXJnZSA9IGNyZWF0ZUFzc2lnbmVyKGJhc2VNZXJnZSk7Cgptb2R1bGUuZXhwb3J0cyA9IG1lcmdlOwoKfSx7Ii4uL2ludGVybmFsL2Jhc2VNZXJnZSI6MTMsIi4uL2ludGVybmFsL2NyZWF0ZUFzc2lnbmVyIjoxN31dLDQxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqIFVzZWQgZm9yIG5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcy4gKi8KdmFyIGFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGUsCiAgICBlcnJvclByb3RvID0gRXJyb3IucHJvdG90eXBlLAogICAgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKLyoqIE5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcy4gKi8KdmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gb2JqZWN0UHJvdG8ucHJvcGVydHlJc0VudW1lcmFibGUsCiAgICBzcGxpY2UgPSBhcnJheVByb3RvLnNwbGljZTsKCi8qKgogKiBBbiBvYmplY3QgZW52aXJvbm1lbnQgZmVhdHVyZSBmbGFncy4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAdHlwZSBPYmplY3QKICovCnZhciBzdXBwb3J0ID0ge307CgooZnVuY3Rpb24oeCkgewogIHZhciBDdG9yID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IHg7IH0sCiAgICAgIG9iamVjdCA9IHsgJzAnOiB4LCAnbGVuZ3RoJzogeCB9LAogICAgICBwcm9wcyA9IFtdOwoKICBDdG9yLnByb3RvdHlwZSA9IHsgJ3ZhbHVlT2YnOiB4LCAneSc6IHggfTsKICBmb3IgKHZhciBrZXkgaW4gbmV3IEN0b3IpIHsgcHJvcHMucHVzaChrZXkpOyB9CgogIC8qKgogICAqIERldGVjdCBpZiBgbmFtZWAgb3IgYG1lc3NhZ2VgIHByb3BlcnRpZXMgb2YgYEVycm9yLnByb3RvdHlwZWAgYXJlCiAgICogZW51bWVyYWJsZSBieSBkZWZhdWx0IChJRSA8IDksIFNhZmFyaSA8IDUuMSkuCiAgICoKICAgKiBAbWVtYmVyT2YgXy5zdXBwb3J0CiAgICogQHR5cGUgYm9vbGVhbgogICAqLwogIHN1cHBvcnQuZW51bUVycm9yUHJvcHMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGVycm9yUHJvdG8sICdtZXNzYWdlJykgfHwKICAgIHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ25hbWUnKTsKCiAgLyoqCiAgICogRGV0ZWN0IGlmIGBwcm90b3R5cGVgIHByb3BlcnRpZXMgYXJlIGVudW1lcmFibGUgYnkgZGVmYXVsdC4KICAgKgogICAqIEZpcmVmb3ggPCAzLjYsIE9wZXJhID4gOS41MCAtIE9wZXJhIDwgMTEuNjAsIGFuZCBTYWZhcmkgPCA1LjEKICAgKiAoaWYgdGhlIHByb3RvdHlwZSBvciBhIHByb3BlcnR5IG9uIHRoZSBwcm90b3R5cGUgaGFzIGJlZW4gc2V0KQogICAqIGluY29ycmVjdGx5IHNldCB0aGUgYFtbRW51bWVyYWJsZV1dYCB2YWx1ZSBvZiBhIGZ1bmN0aW9uJ3MgYHByb3RvdHlwZWAKICAgKiBwcm9wZXJ0eSB0byBgdHJ1ZWAuCiAgICoKICAgKiBAbWVtYmVyT2YgXy5zdXBwb3J0CiAgICogQHR5cGUgYm9vbGVhbgogICAqLwogIHN1cHBvcnQuZW51bVByb3RvdHlwZXMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKEN0b3IsICdwcm90b3R5cGUnKTsKCiAgLyoqCiAgICogRGV0ZWN0IGlmIHByb3BlcnRpZXMgc2hhZG93aW5nIHRob3NlIG9uIGBPYmplY3QucHJvdG90eXBlYCBhcmUgbm9uLWVudW1lcmFibGUuCiAgICoKICAgKiBJbiBJRSA8IDkgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMsIHNoYWRvd2luZyBub24tZW51bWVyYWJsZSBvbmVzLAogICAqIGFyZSBtYWRlIG5vbi1lbnVtZXJhYmxlIGFzIHdlbGwgKGEuay5hIHRoZSBKU2NyaXB0IGBbW0RvbnRFbnVtXV1gIGJ1ZykuCiAgICoKICAgKiBAbWVtYmVyT2YgXy5zdXBwb3J0CiAgICogQHR5cGUgYm9vbGVhbgogICAqLwogIHN1cHBvcnQubm9uRW51bVNoYWRvd3MgPSAhL3ZhbHVlT2YvLnRlc3QocHJvcHMpOwoKICAvKioKICAgKiBEZXRlY3QgaWYgb3duIHByb3BlcnRpZXMgYXJlIGl0ZXJhdGVkIGFmdGVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIChJRSA8IDkpLgogICAqCiAgICogQG1lbWJlck9mIF8uc3VwcG9ydAogICAqIEB0eXBlIGJvb2xlYW4KICAgKi8KICBzdXBwb3J0Lm93bkxhc3QgPSBwcm9wc1swXSAhPSAneCc7CgogIC8qKgogICAqIERldGVjdCBpZiBgQXJyYXkjc2hpZnRgIGFuZCBgQXJyYXkjc3BsaWNlYCBhdWdtZW50IGFycmF5LWxpa2Ugb2JqZWN0cwogICAqIGNvcnJlY3RseS4KICAgKgogICAqIEZpcmVmb3ggPCAxMCwgY29tcGF0aWJpbGl0eSBtb2RlcyBvZiBJRSA4LCBhbmQgSUUgPCA5IGhhdmUgYnVnZ3kgQXJyYXkKICAgKiBgc2hpZnQoKWAgYW5kIGBzcGxpY2UoKWAgZnVuY3Rpb25zIHRoYXQgZmFpbCB0byByZW1vdmUgdGhlIGxhc3QgZWxlbWVudCwKICAgKiBgdmFsdWVbMF1gLCBvZiBhcnJheS1saWtlIG9iamVjdHMgZXZlbiB0aG91Z2ggdGhlICJsZW5ndGgiIHByb3BlcnR5IGlzCiAgICogc2V0IHRvIGAwYC4gVGhlIGBzaGlmdCgpYCBtZXRob2QgaXMgYnVnZ3kgaW4gY29tcGF0aWJpbGl0eSBtb2RlcyBvZiBJRSA4LAogICAqIHdoaWxlIGBzcGxpY2UoKWAgaXMgYnVnZ3kgcmVnYXJkbGVzcyBvZiBtb2RlIGluIElFIDwgOS4KICAgKgogICAqIEBtZW1iZXJPZiBfLnN1cHBvcnQKICAgKiBAdHlwZSBib29sZWFuCiAgICovCiAgc3VwcG9ydC5zcGxpY2VPYmplY3RzID0gKHNwbGljZS5jYWxsKG9iamVjdCwgMCwgMSksICFvYmplY3RbMF0pOwoKICAvKioKICAgKiBEZXRlY3QgbGFjayBvZiBzdXBwb3J0IGZvciBhY2Nlc3Npbmcgc3RyaW5nIGNoYXJhY3RlcnMgYnkgaW5kZXguCiAgICoKICAgKiBJRSA8IDggY2FuJ3QgYWNjZXNzIGNoYXJhY3RlcnMgYnkgaW5kZXguIElFIDggY2FuIG9ubHkgYWNjZXNzIGNoYXJhY3RlcnMKICAgKiBieSBpbmRleCBvbiBzdHJpbmcgbGl0ZXJhbHMsIG5vdCBzdHJpbmcgb2JqZWN0cy4KICAgKgogICAqIEBtZW1iZXJPZiBfLnN1cHBvcnQKICAgKiBAdHlwZSBib29sZWFuCiAgICovCiAgc3VwcG9ydC51bmluZGV4ZWRDaGFycyA9ICgneCdbMF0gKyBPYmplY3QoJ3gnKVswXSkgIT0gJ3h4JzsKfSgxLCAwKSk7Cgptb2R1bGUuZXhwb3J0cyA9IHN1cHBvcnQ7Cgp9LHt9XSw0MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBUaGlzIG1ldGhvZCByZXR1cm5zIHRoZSBmaXJzdCBhcmd1bWVudCBwcm92aWRlZCB0byBpdC4KICoKICogQHN0YXRpYwogKiBAbWVtYmVyT2YgXwogKiBAY2F0ZWdvcnkgVXRpbGl0eQogKiBAcGFyYW0geyp9IHZhbHVlIEFueSB2YWx1ZS4KICogQHJldHVybnMgeyp9IFJldHVybnMgYHZhbHVlYC4KICogQGV4YW1wbGUKICoKICogdmFyIG9iamVjdCA9IHsgJ3VzZXInOiAnZnJlZCcgfTsKICoKICogXy5pZGVudGl0eShvYmplY3QpID09PSBvYmplY3Q7CiAqIC8vID0+IHRydWUKICovCmZ1bmN0aW9uIGlkZW50aXR5KHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGlkZW50aXR5OwoKfSx7fV0sNDM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7Cgp2YXIga2V5cyA9IF9kZXJlcV8oJ29iamVjdC1rZXlzJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGhhc1N5bWJvbHMoKSB7CglpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAhPT0gJ2Z1bmN0aW9uJykgeyByZXR1cm4gZmFsc2U7IH0KCWlmICh0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAnc3ltYm9sJykgeyByZXR1cm4gdHJ1ZTsgfQoKCXZhciBvYmogPSB7fTsKCXZhciBzeW0gPSBTeW1ib2woJ3Rlc3QnKTsKCWlmICh0eXBlb2Ygc3ltID09PSAnc3RyaW5nJykgeyByZXR1cm4gZmFsc2U7IH0KCgkvLyB0ZW1wIGRpc2FibGVkIHBlciBodHRwczovL2dpdGh1Yi5jb20vbGpoYXJiL29iamVjdC5hc3NpZ24vaXNzdWVzLzE3CgkvLyBpZiAoc3ltIGluc3RhbmNlb2YgU3ltYm9sKSB7IHJldHVybiBmYWxzZTsgfQoJLy8gdGVtcCBkaXNhYmxlZCBwZXIgaHR0cHM6Ly9naXRodWIuY29tL1dlYlJlZmxlY3Rpb24vZ2V0LW93bi1wcm9wZXJ0eS1zeW1ib2xzL2lzc3Vlcy80CgkvLyBpZiAoIShPYmplY3Qoc3ltKSBpbnN0YW5jZW9mIFN5bWJvbCkpIHsgcmV0dXJuIGZhbHNlOyB9CgoJdmFyIHN5bVZhbCA9IDQyOwoJb2JqW3N5bV0gPSBzeW1WYWw7Cglmb3IgKHN5bSBpbiBvYmopIHsgcmV0dXJuIGZhbHNlOyB9CglpZiAoa2V5cyhvYmopLmxlbmd0aCAhPT0gMCkgeyByZXR1cm4gZmFsc2U7IH0KCWlmICh0eXBlb2YgT2JqZWN0LmtleXMgPT09ICdmdW5jdGlvbicgJiYgT2JqZWN0LmtleXMob2JqKS5sZW5ndGggIT09IDApIHsgcmV0dXJuIGZhbHNlOyB9CgoJaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyA9PT0gJ2Z1bmN0aW9uJyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmxlbmd0aCAhPT0gMCkgeyByZXR1cm4gZmFsc2U7IH0KCgl2YXIgc3ltcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqKTsKCWlmIChzeW1zLmxlbmd0aCAhPT0gMSB8fCBzeW1zWzBdICE9PSBzeW0pIHsgcmV0dXJuIGZhbHNlOyB9CgoJaWYgKCFPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwob2JqLCBzeW0pKSB7IHJldHVybiBmYWxzZTsgfQoKCWlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA9PT0gJ2Z1bmN0aW9uJykgewoJCXZhciBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIHN5bSk7CgkJaWYgKGRlc2NyaXB0b3IudmFsdWUgIT09IHN5bVZhbCB8fCBkZXNjcmlwdG9yLmVudW1lcmFibGUgIT09IHRydWUpIHsgcmV0dXJuIGZhbHNlOyB9Cgl9CgoJcmV0dXJuIHRydWU7Cn07Cgp9LHsib2JqZWN0LWtleXMiOjQ5fV0sNDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgovLyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy9lczYtc2hpbQp2YXIga2V5cyA9IF9kZXJlcV8oJ29iamVjdC1rZXlzJyk7CnZhciBiaW5kID0gX2RlcmVxXygnZnVuY3Rpb24tYmluZCcpOwp2YXIgY2FuQmVPYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7CglyZXR1cm4gdHlwZW9mIG9iaiAhPT0gJ3VuZGVmaW5lZCcgJiYgb2JqICE9PSBudWxsOwp9Owp2YXIgaGFzU3ltYm9scyA9IF9kZXJlcV8oJy4vaGFzU3ltYm9scycpKCk7CnZhciB0b09iamVjdCA9IE9iamVjdDsKdmFyIHB1c2ggPSBiaW5kLmNhbGwoRnVuY3Rpb24uY2FsbCwgQXJyYXkucHJvdG90eXBlLnB1c2gpOwp2YXIgcHJvcElzRW51bWVyYWJsZSA9IGJpbmQuY2FsbChGdW5jdGlvbi5jYWxsLCBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlMSkgewoJaWYgKCFjYW5CZU9iamVjdCh0YXJnZXQpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ3RhcmdldCBtdXN0IGJlIGFuIG9iamVjdCcpOyB9Cgl2YXIgb2JqVGFyZ2V0ID0gdG9PYmplY3QodGFyZ2V0KTsKCXZhciBzLCBzb3VyY2UsIGksIHByb3BzLCBzeW1zLCB2YWx1ZSwga2V5OwoJZm9yIChzID0gMTsgcyA8IGFyZ3VtZW50cy5sZW5ndGg7ICsrcykgewoJCXNvdXJjZSA9IHRvT2JqZWN0KGFyZ3VtZW50c1tzXSk7CgkJcHJvcHMgPSBrZXlzKHNvdXJjZSk7CgkJaWYgKGhhc1N5bWJvbHMgJiYgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewoJCQlzeW1zID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpOwoJCQlmb3IgKGkgPSAwOyBpIDwgc3ltcy5sZW5ndGg7ICsraSkgewoJCQkJa2V5ID0gc3ltc1tpXTsKCQkJCWlmIChwcm9wSXNFbnVtZXJhYmxlKHNvdXJjZSwga2V5KSkgewoJCQkJCXB1c2gocHJvcHMsIGtleSk7CgkJCQl9CgkJCX0KCQl9CgkJZm9yIChpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgKytpKSB7CgkJCWtleSA9IHByb3BzW2ldOwoJCQl2YWx1ZSA9IHNvdXJjZVtrZXldOwoJCQlpZiAocHJvcElzRW51bWVyYWJsZShzb3VyY2UsIGtleSkpIHsKCQkJCW9ialRhcmdldFtrZXldID0gdmFsdWU7CgkJCX0KCQl9Cgl9CglyZXR1cm4gb2JqVGFyZ2V0Owp9OwoKfSx7Ii4vaGFzU3ltYm9scyI6NDMsImZ1bmN0aW9uLWJpbmQiOjQ4LCJvYmplY3Qta2V5cyI6NDl9XSw0NTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBkZWZpbmVQcm9wZXJ0aWVzID0gX2RlcmVxXygnZGVmaW5lLXByb3BlcnRpZXMnKTsKCnZhciBpbXBsZW1lbnRhdGlvbiA9IF9kZXJlcV8oJy4vaW1wbGVtZW50YXRpb24nKTsKdmFyIGdldFBvbHlmaWxsID0gX2RlcmVxXygnLi9wb2x5ZmlsbCcpOwp2YXIgc2hpbSA9IF9kZXJlcV8oJy4vc2hpbScpOwoKZGVmaW5lUHJvcGVydGllcyhpbXBsZW1lbnRhdGlvbiwgewoJaW1wbGVtZW50YXRpb246IGltcGxlbWVudGF0aW9uLAoJZ2V0UG9seWZpbGw6IGdldFBvbHlmaWxsLAoJc2hpbTogc2hpbQp9KTsKCm1vZHVsZS5leHBvcnRzID0gaW1wbGVtZW50YXRpb247Cgp9LHsiLi9pbXBsZW1lbnRhdGlvbiI6NDQsIi4vcG9seWZpbGwiOjUxLCIuL3NoaW0iOjUyLCJkZWZpbmUtcHJvcGVydGllcyI6NDZ9XSw0NjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBrZXlzID0gX2RlcmVxXygnb2JqZWN0LWtleXMnKTsKdmFyIGZvcmVhY2ggPSBfZGVyZXFfKCdmb3JlYWNoJyk7CnZhciBoYXNTeW1ib2xzID0gdHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgU3ltYm9sKCkgPT09ICdzeW1ib2wnOwoKdmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCnZhciBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gKGZuKSB7CglyZXR1cm4gdHlwZW9mIGZuID09PSAnZnVuY3Rpb24nICYmIHRvU3RyLmNhbGwoZm4pID09PSAnW29iamVjdCBGdW5jdGlvbl0nOwp9OwoKdmFyIGFyZVByb3BlcnR5RGVzY3JpcHRvcnNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7Cgl2YXIgb2JqID0ge307Cgl0cnkgewoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosICd4JywgeyBlbnVtZXJhYmxlOiBmYWxzZSwgdmFsdWU6IG9iaiB9KTsKICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtdmFycywgbm8tcmVzdHJpY3RlZC1zeW50YXggKi8KICAgICAgICBmb3IgKHZhciBfIGluIG9iaikgeyByZXR1cm4gZmFsc2U7IH0KICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLXVudXNlZC12YXJzLCBuby1yZXN0cmljdGVkLXN5bnRheCAqLwoJCXJldHVybiBvYmoueCA9PT0gb2JqOwoJfSBjYXRjaCAoZSkgeyAvKiB0aGlzIGlzIElFIDguICovCgkJcmV0dXJuIGZhbHNlOwoJfQp9Owp2YXIgc3VwcG9ydHNEZXNjcmlwdG9ycyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBhcmVQcm9wZXJ0eURlc2NyaXB0b3JzU3VwcG9ydGVkKCk7Cgp2YXIgZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lLCB2YWx1ZSwgcHJlZGljYXRlKSB7CglpZiAobmFtZSBpbiBvYmplY3QgJiYgKCFpc0Z1bmN0aW9uKHByZWRpY2F0ZSkgfHwgIXByZWRpY2F0ZSgpKSkgewoJCXJldHVybjsKCX0KCWlmIChzdXBwb3J0c0Rlc2NyaXB0b3JzKSB7CgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdCwgbmFtZSwgewoJCQljb25maWd1cmFibGU6IHRydWUsCgkJCWVudW1lcmFibGU6IGZhbHNlLAoJCQl2YWx1ZTogdmFsdWUsCgkJCXdyaXRhYmxlOiB0cnVlCgkJfSk7Cgl9IGVsc2UgewoJCW9iamVjdFtuYW1lXSA9IHZhbHVlOwoJfQp9OwoKdmFyIGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAob2JqZWN0LCBtYXApIHsKCXZhciBwcmVkaWNhdGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB7fTsKCXZhciBwcm9wcyA9IGtleXMobWFwKTsKCWlmIChoYXNTeW1ib2xzKSB7CgkJcHJvcHMgPSBwcm9wcy5jb25jYXQoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhtYXApKTsKCX0KCWZvcmVhY2gocHJvcHMsIGZ1bmN0aW9uIChuYW1lKSB7CgkJZGVmaW5lUHJvcGVydHkob2JqZWN0LCBuYW1lLCBtYXBbbmFtZV0sIHByZWRpY2F0ZXNbbmFtZV0pOwoJfSk7Cn07CgpkZWZpbmVQcm9wZXJ0aWVzLnN1cHBvcnRzRGVzY3JpcHRvcnMgPSAhIXN1cHBvcnRzRGVzY3JpcHRvcnM7Cgptb2R1bGUuZXhwb3J0cyA9IGRlZmluZVByb3BlcnRpZXM7Cgp9LHsiZm9yZWFjaCI6NDcsIm9iamVjdC1rZXlzIjo0OX1dLDQ3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKCnZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5Owp2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBmb3JFYWNoIChvYmosIGZuLCBjdHgpIHsKICAgIGlmICh0b1N0cmluZy5jYWxsKGZuKSAhPT0gJ1tvYmplY3QgRnVuY3Rpb25dJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2l0ZXJhdG9yIG11c3QgYmUgYSBmdW5jdGlvbicpOwogICAgfQogICAgdmFyIGwgPSBvYmoubGVuZ3RoOwogICAgaWYgKGwgPT09ICtsKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgZm4uY2FsbChjdHgsIG9ialtpXSwgaSwgb2JqKTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGZvciAodmFyIGsgaW4gb2JqKSB7CiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChvYmosIGspKSB7CiAgICAgICAgICAgICAgICBmbi5jYWxsKGN0eCwgb2JqW2tdLCBrLCBvYmopOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9OwoKCn0se31dLDQ4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIEVSUk9SX01FU1NBR0UgPSAnRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgY2FsbGVkIG9uIGluY29tcGF0aWJsZSAnOwp2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CnZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CnZhciBmdW5jVHlwZSA9ICdbb2JqZWN0IEZ1bmN0aW9uXSc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJpbmQodGhhdCkgewogICAgdmFyIHRhcmdldCA9IHRoaXM7CiAgICBpZiAodHlwZW9mIHRhcmdldCAhPT0gJ2Z1bmN0aW9uJyB8fCB0b1N0ci5jYWxsKHRhcmdldCkgIT09IGZ1bmNUeXBlKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihFUlJPUl9NRVNTQUdFICsgdGFyZ2V0KTsKICAgIH0KICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoKICAgIHZhciBiaW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBib3VuZCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGFyZ2V0LmFwcGx5KAogICAgICAgICAgICAgICAgdGhpcywKICAgICAgICAgICAgICAgIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKE9iamVjdChyZXN1bHQpID09PSByZXN1bHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5hcHBseSgKICAgICAgICAgICAgICAgIHRoYXQsCiAgICAgICAgICAgICAgICBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgYm91bmRMZW5ndGggPSBNYXRoLm1heCgwLCB0YXJnZXQubGVuZ3RoIC0gYXJncy5sZW5ndGgpOwogICAgdmFyIGJvdW5kQXJncyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib3VuZExlbmd0aDsgaSsrKSB7CiAgICAgICAgYm91bmRBcmdzLnB1c2goJyQnICsgaSk7CiAgICB9CgogICAgdmFyIGJvdW5kID0gRnVuY3Rpb24oJ2JpbmRlcicsICdyZXR1cm4gZnVuY3Rpb24gKCcgKyBib3VuZEFyZ3Muam9pbignLCcpICsgJyl7IHJldHVybiBiaW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpOyB9JykoYmluZGVyKTsKCiAgICBpZiAodGFyZ2V0LnByb3RvdHlwZSkgewogICAgICAgIHZhciBFbXB0eSA9IGZ1bmN0aW9uIEVtcHR5KCkge307CiAgICAgICAgRW1wdHkucHJvdG90eXBlID0gdGFyZ2V0LnByb3RvdHlwZTsKICAgICAgICBib3VuZC5wcm90b3R5cGUgPSBuZXcgRW1wdHkoKTsKICAgICAgICBFbXB0eS5wcm90b3R5cGUgPSBudWxsOwogICAgfQoKICAgIHJldHVybiBib3VuZDsKfTsKCgp9LHt9XSw0OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCi8vIG1vZGlmaWVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2VzLXNoaW1zL2VzNS1zaGltCnZhciBoYXMgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5Owp2YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwp2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CnZhciBpc0FyZ3MgPSBfZGVyZXFfKCcuL2lzQXJndW1lbnRzJyk7CnZhciBoYXNEb250RW51bUJ1ZyA9ICEoeyB0b1N0cmluZzogbnVsbCB9KS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKTsKdmFyIGhhc1Byb3RvRW51bUJ1ZyA9IGZ1bmN0aW9uICgpIHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCdwcm90b3R5cGUnKTsKdmFyIGRvbnRFbnVtcyA9IFsKCSd0b1N0cmluZycsCgkndG9Mb2NhbGVTdHJpbmcnLAoJJ3ZhbHVlT2YnLAoJJ2hhc093blByb3BlcnR5JywKCSdpc1Byb3RvdHlwZU9mJywKCSdwcm9wZXJ0eUlzRW51bWVyYWJsZScsCgknY29uc3RydWN0b3InCl07CnZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSA9IGZ1bmN0aW9uIChvKSB7Cgl2YXIgY3RvciA9IG8uY29uc3RydWN0b3I7CglyZXR1cm4gY3RvciAmJiBjdG9yLnByb3RvdHlwZSA9PT0gbzsKfTsKdmFyIGJsYWNrbGlzdGVkS2V5cyA9IHsKCSRjb25zb2xlOiB0cnVlLAoJJGZyYW1lOiB0cnVlLAoJJGZyYW1lRWxlbWVudDogdHJ1ZSwKCSRmcmFtZXM6IHRydWUsCgkkcGFyZW50OiB0cnVlLAoJJHNlbGY6IHRydWUsCgkkd2Via2l0SW5kZXhlZERCOiB0cnVlLAoJJHdlYmtpdFN0b3JhZ2VJbmZvOiB0cnVlLAoJJHdpbmRvdzogdHJ1ZQp9Owp2YXIgaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnID0gKGZ1bmN0aW9uICgpIHsKCS8qIGdsb2JhbCB3aW5kb3cgKi8KCWlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZmFsc2U7IH0KCWZvciAodmFyIGsgaW4gd2luZG93KSB7CgkJdHJ5IHsKCQkJaWYgKCFibGFja2xpc3RlZEtleXNbJyQnICsga10gJiYgaGFzLmNhbGwod2luZG93LCBrKSAmJiB3aW5kb3dba10gIT09IG51bGwgJiYgdHlwZW9mIHdpbmRvd1trXSA9PT0gJ29iamVjdCcpIHsKCQkJCXRyeSB7CgkJCQkJZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGUod2luZG93W2tdKTsKCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCX0KCQkJfQoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIHRydWU7CgkJfQoJfQoJcmV0dXJuIGZhbHNlOwp9KCkpOwp2YXIgZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGVJZk5vdEJ1Z2d5ID0gZnVuY3Rpb24gKG8pIHsKCS8qIGdsb2JhbCB3aW5kb3cgKi8KCWlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnKSB7CgkJcmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlKG8pOwoJfQoJdHJ5IHsKCQlyZXR1cm4gZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGUobyk7Cgl9IGNhdGNoIChlKSB7CgkJcmV0dXJuIGZhbHNlOwoJfQp9OwoKdmFyIGtleXNTaGltID0gZnVuY3Rpb24ga2V5cyhvYmplY3QpIHsKCXZhciBpc09iamVjdCA9IG9iamVjdCAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JzsKCXZhciBpc0Z1bmN0aW9uID0gdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBGdW5jdGlvbl0nOwoJdmFyIGlzQXJndW1lbnRzID0gaXNBcmdzKG9iamVjdCk7Cgl2YXIgaXNTdHJpbmcgPSBpc09iamVjdCAmJiB0b1N0ci5jYWxsKG9iamVjdCkgPT09ICdbb2JqZWN0IFN0cmluZ10nOwoJdmFyIHRoZUtleXMgPSBbXTsKCglpZiAoIWlzT2JqZWN0ICYmICFpc0Z1bmN0aW9uICYmICFpc0FyZ3VtZW50cykgewoJCXRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3QnKTsKCX0KCgl2YXIgc2tpcFByb3RvID0gaGFzUHJvdG9FbnVtQnVnICYmIGlzRnVuY3Rpb247CglpZiAoaXNTdHJpbmcgJiYgb2JqZWN0Lmxlbmd0aCA+IDAgJiYgIWhhcy5jYWxsKG9iamVjdCwgMCkpIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdC5sZW5ndGg7ICsraSkgewoJCQl0aGVLZXlzLnB1c2goU3RyaW5nKGkpKTsKCQl9Cgl9CgoJaWYgKGlzQXJndW1lbnRzICYmIG9iamVjdC5sZW5ndGggPiAwKSB7CgkJZm9yICh2YXIgaiA9IDA7IGogPCBvYmplY3QubGVuZ3RoOyArK2opIHsKCQkJdGhlS2V5cy5wdXNoKFN0cmluZyhqKSk7CgkJfQoJfSBlbHNlIHsKCQlmb3IgKHZhciBuYW1lIGluIG9iamVjdCkgewoJCQlpZiAoIShza2lwUHJvdG8gJiYgbmFtZSA9PT0gJ3Byb3RvdHlwZScpICYmIGhhcy5jYWxsKG9iamVjdCwgbmFtZSkpIHsKCQkJCXRoZUtleXMucHVzaChTdHJpbmcobmFtZSkpOwoJCQl9CgkJfQoJfQoKCWlmIChoYXNEb250RW51bUJ1ZykgewoJCXZhciBza2lwQ29uc3RydWN0b3IgPSBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZUlmTm90QnVnZ3kob2JqZWN0KTsKCgkJZm9yICh2YXIgayA9IDA7IGsgPCBkb250RW51bXMubGVuZ3RoOyArK2spIHsKCQkJaWYgKCEoc2tpcENvbnN0cnVjdG9yICYmIGRvbnRFbnVtc1trXSA9PT0gJ2NvbnN0cnVjdG9yJykgJiYgaGFzLmNhbGwob2JqZWN0LCBkb250RW51bXNba10pKSB7CgkJCQl0aGVLZXlzLnB1c2goZG9udEVudW1zW2tdKTsKCQkJfQoJCX0KCX0KCXJldHVybiB0aGVLZXlzOwp9OwoKa2V5c1NoaW0uc2hpbSA9IGZ1bmN0aW9uIHNoaW1PYmplY3RLZXlzKCkgewoJaWYgKE9iamVjdC5rZXlzKSB7CgkJdmFyIGtleXNXb3Jrc1dpdGhBcmd1bWVudHMgPSAoZnVuY3Rpb24gKCkgewoJCQkvLyBTYWZhcmkgNS4wIGJ1ZwoJCQlyZXR1cm4gKE9iamVjdC5rZXlzKGFyZ3VtZW50cykgfHwgJycpLmxlbmd0aCA9PT0gMjsKCQl9KDEsIDIpKTsKCQlpZiAoIWtleXNXb3Jrc1dpdGhBcmd1bWVudHMpIHsKCQkJdmFyIG9yaWdpbmFsS2V5cyA9IE9iamVjdC5rZXlzOwoJCQlPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIGtleXMob2JqZWN0KSB7CgkJCQlpZiAoaXNBcmdzKG9iamVjdCkpIHsKCQkJCQlyZXR1cm4gb3JpZ2luYWxLZXlzKHNsaWNlLmNhbGwob2JqZWN0KSk7CgkJCQl9IGVsc2UgewoJCQkJCXJldHVybiBvcmlnaW5hbEtleXMob2JqZWN0KTsKCQkJCX0KCQkJfTsKCQl9Cgl9IGVsc2UgewoJCU9iamVjdC5rZXlzID0ga2V5c1NoaW07Cgl9CglyZXR1cm4gT2JqZWN0LmtleXMgfHwga2V5c1NoaW07Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGtleXNTaGltOwoKfSx7Ii4vaXNBcmd1bWVudHMiOjUwfV0sNTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7Cgp2YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0FyZ3VtZW50cyh2YWx1ZSkgewoJdmFyIHN0ciA9IHRvU3RyLmNhbGwodmFsdWUpOwoJdmFyIGlzQXJncyA9IHN0ciA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7CglpZiAoIWlzQXJncykgewoJCWlzQXJncyA9IHN0ciAhPT0gJ1tvYmplY3QgQXJyYXldJyAmJgoJCQl2YWx1ZSAhPT0gbnVsbCAmJgoJCQl0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmCgkJCXR5cGVvZiB2YWx1ZS5sZW5ndGggPT09ICdudW1iZXInICYmCgkJCXZhbHVlLmxlbmd0aCA+PSAwICYmCgkJCXRvU3RyLmNhbGwodmFsdWUuY2FsbGVlKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJzsKCX0KCXJldHVybiBpc0FyZ3M7Cn07Cgp9LHt9XSw1MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBpbXBsZW1lbnRhdGlvbiA9IF9kZXJlcV8oJy4vaW1wbGVtZW50YXRpb24nKTsKCnZhciBsYWNrc1Byb3BlckVudW1lcmF0aW9uT3JkZXIgPSBmdW5jdGlvbiAoKSB7CglpZiAoIU9iamVjdC5hc3NpZ24pIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgkvLyB2OCwgc3BlY2lmaWNhbGx5IGluIG5vZGUgNC54LCBoYXMgYSBidWcgd2l0aCBpbmNvcnJlY3QgcHJvcGVydHkgZW51bWVyYXRpb24gb3JkZXIKCS8vIG5vdGU6IHRoaXMgZG9lcyBub3QgZGV0ZWN0IHRoZSBidWcgdW5sZXNzIHRoZXJlJ3MgMjAgY2hhcmFjdGVycwoJdmFyIHN0ciA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdCc7Cgl2YXIgbGV0dGVycyA9IHN0ci5zcGxpdCgnJyk7Cgl2YXIgbWFwID0ge307Cglmb3IgKHZhciBpID0gMDsgaSA8IGxldHRlcnMubGVuZ3RoOyArK2kpIHsKCQltYXBbbGV0dGVyc1tpXV0gPSBsZXR0ZXJzW2ldOwoJfQoJdmFyIG9iaiA9IE9iamVjdC5hc3NpZ24oe30sIG1hcCk7Cgl2YXIgYWN0dWFsID0gJyc7Cglmb3IgKHZhciBrIGluIG9iaikgewoJCWFjdHVhbCArPSBrOwoJfQoJcmV0dXJuIHN0ciAhPT0gYWN0dWFsOwp9OwoKdmFyIGFzc2lnbkhhc1BlbmRpbmdFeGNlcHRpb25zID0gZnVuY3Rpb24gKCkgewoJaWYgKCFPYmplY3QuYXNzaWduIHx8ICFPYmplY3QucHJldmVudEV4dGVuc2lvbnMpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgkvLyBGaXJlZm94IDM3IHN0aWxsIGhhcyAicGVuZGluZyBleGNlcHRpb24iIGxvZ2ljIGluIGl0cyBPYmplY3QuYXNzaWduIGltcGxlbWVudGF0aW9uLAoJLy8gd2hpY2ggaXMgNzIlIHNsb3dlciB0aGFuIG91ciBzaGltLCBhbmQgRmlyZWZveCA0MCdzIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbi4KCXZhciB0aHJvd2VyID0gT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHsgMTogMiB9KTsKCXRyeSB7CgkJT2JqZWN0LmFzc2lnbih0aHJvd2VyLCAneHknKTsKCX0gY2F0Y2ggKGUpIHsKCQlyZXR1cm4gdGhyb3dlclsxXSA9PT0gJ3knOwoJfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRQb2x5ZmlsbCgpIHsKCWlmICghT2JqZWN0LmFzc2lnbikgewoJCXJldHVybiBpbXBsZW1lbnRhdGlvbjsKCX0KCWlmIChsYWNrc1Byb3BlckVudW1lcmF0aW9uT3JkZXIoKSkgewoJCXJldHVybiBpbXBsZW1lbnRhdGlvbjsKCX0KCWlmIChhc3NpZ25IYXNQZW5kaW5nRXhjZXB0aW9ucygpKSB7CgkJcmV0dXJuIGltcGxlbWVudGF0aW9uOwoJfQoJcmV0dXJuIE9iamVjdC5hc3NpZ247Cn07Cgp9LHsiLi9pbXBsZW1lbnRhdGlvbiI6NDR9XSw1MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBkZWZpbmUgPSBfZGVyZXFfKCdkZWZpbmUtcHJvcGVydGllcycpOwp2YXIgZ2V0UG9seWZpbGwgPSBfZGVyZXFfKCcuL3BvbHlmaWxsJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNoaW1Bc3NpZ24oKSB7Cgl2YXIgcG9seWZpbGwgPSBnZXRQb2x5ZmlsbCgpOwoJZGVmaW5lKAoJCU9iamVjdCwKCQl7IGFzc2lnbjogcG9seWZpbGwgfSwKCQl7IGFzc2lnbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gT2JqZWN0LmFzc2lnbiAhPT0gcG9seWZpbGw7IH0gfQoJKTsKCXJldHVybiBwb2x5ZmlsbDsKfTsKCn0seyIuL3BvbHlmaWxsIjo1MSwiZGVmaW5lLXByb3BlcnRpZXMiOjQ2fV0sNTM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cyA9IFNhZmVQYXJzZVR1cGxlCgpmdW5jdGlvbiBTYWZlUGFyc2VUdXBsZShvYmosIHJldml2ZXIpIHsKICAgIHZhciBqc29uCiAgICB2YXIgZXJyb3IgPSBudWxsCgogICAgdHJ5IHsKICAgICAgICBqc29uID0gSlNPTi5wYXJzZShvYmosIHJldml2ZXIpCiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBlcnJvciA9IGVycgogICAgfQoKICAgIHJldHVybiBbZXJyb3IsIGpzb25dCn0KCn0se31dLDU0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKZnVuY3Rpb24gY2xlYW4gKHMpIHsKICByZXR1cm4gcy5yZXBsYWNlKC9cblxyP1xzKi9nLCAnJykKfQoKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gdHNtbCAoc2EpIHsKICB2YXIgcyA9ICcnCiAgICAsIGkgPSAwCgogIGZvciAoOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKQogICAgcyArPSBjbGVhbihzYVtpXSkgKyAoYXJndW1lbnRzW2kgKyAxXSB8fCAnJykKCiAgcmV0dXJuIHMKfQp9LHt9XSw1NTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKdmFyIHdpbmRvdyA9IF9kZXJlcV8oImdsb2JhbC93aW5kb3ciKQp2YXIgb25jZSA9IF9kZXJlcV8oIm9uY2UiKQp2YXIgaXNGdW5jdGlvbiA9IF9kZXJlcV8oImlzLWZ1bmN0aW9uIikKdmFyIHBhcnNlSGVhZGVycyA9IF9kZXJlcV8oInBhcnNlLWhlYWRlcnMiKQp2YXIgeHRlbmQgPSBfZGVyZXFfKCJ4dGVuZCIpCgptb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVhIUgpjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QgPSB3aW5kb3cuWE1MSHR0cFJlcXVlc3QgfHwgbm9vcApjcmVhdGVYSFIuWERvbWFpblJlcXVlc3QgPSAid2l0aENyZWRlbnRpYWxzIiBpbiAobmV3IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCgpKSA/IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCA6IHdpbmRvdy5YRG9tYWluUmVxdWVzdAoKZm9yRWFjaEFycmF5KFsiZ2V0IiwgInB1dCIsICJwb3N0IiwgInBhdGNoIiwgImhlYWQiLCAiZGVsZXRlIl0sIGZ1bmN0aW9uKG1ldGhvZCkgewogICAgY3JlYXRlWEhSW21ldGhvZCA9PT0gImRlbGV0ZSIgPyAiZGVsIiA6IG1ldGhvZF0gPSBmdW5jdGlvbih1cmksIG9wdGlvbnMsIGNhbGxiYWNrKSB7CiAgICAgICAgb3B0aW9ucyA9IGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaykKICAgICAgICBvcHRpb25zLm1ldGhvZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpCiAgICAgICAgcmV0dXJuIF9jcmVhdGVYSFIob3B0aW9ucykKICAgIH0KfSkKCmZ1bmN0aW9uIGZvckVhY2hBcnJheShhcnJheSwgaXRlcmF0b3IpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICBpdGVyYXRvcihhcnJheVtpXSkKICAgIH0KfQoKZnVuY3Rpb24gaXNFbXB0eShvYmopewogICAgZm9yKHZhciBpIGluIG9iail7CiAgICAgICAgaWYob2JqLmhhc093blByb3BlcnR5KGkpKSByZXR1cm4gZmFsc2UKICAgIH0KICAgIHJldHVybiB0cnVlCn0KCmZ1bmN0aW9uIGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgdmFyIHBhcmFtcyA9IHVyaQoKICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMpKSB7CiAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zCiAgICAgICAgaWYgKHR5cGVvZiB1cmkgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgIHBhcmFtcyA9IHt1cmk6dXJpfQogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgcGFyYW1zID0geHRlbmQob3B0aW9ucywge3VyaTogdXJpfSkKICAgIH0KCiAgICBwYXJhbXMuY2FsbGJhY2sgPSBjYWxsYmFjawogICAgcmV0dXJuIHBhcmFtcwp9CgpmdW5jdGlvbiBjcmVhdGVYSFIodXJpLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgb3B0aW9ucyA9IGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaykKICAgIHJldHVybiBfY3JlYXRlWEhSKG9wdGlvbnMpCn0KCmZ1bmN0aW9uIF9jcmVhdGVYSFIob3B0aW9ucykgewogICAgdmFyIGNhbGxiYWNrID0gb3B0aW9ucy5jYWxsYmFjawogICAgaWYodHlwZW9mIGNhbGxiYWNrID09PSAidW5kZWZpbmVkIil7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjYWxsYmFjayBhcmd1bWVudCBtaXNzaW5nIikKICAgIH0KICAgIGNhbGxiYWNrID0gb25jZShjYWxsYmFjaykKCiAgICBmdW5jdGlvbiByZWFkeXN0YXRlY2hhbmdlKCkgewogICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkgewogICAgICAgICAgICBsb2FkRnVuYygpCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJvZHkoKSB7CiAgICAgICAgLy8gQ2hyb21lIHdpdGggcmVxdWVzdFR5cGU9YmxvYiB0aHJvd3MgZXJyb3JzIGFycm91bmQgd2hlbiBldmVuIHRlc3RpbmcgYWNjZXNzIHRvIHJlc3BvbnNlVGV4dAogICAgICAgIHZhciBib2R5ID0gdW5kZWZpbmVkCgogICAgICAgIGlmICh4aHIucmVzcG9uc2UpIHsKICAgICAgICAgICAgYm9keSA9IHhoci5yZXNwb25zZQogICAgICAgIH0gZWxzZSBpZiAoeGhyLnJlc3BvbnNlVHlwZSA9PT0gInRleHQiIHx8ICF4aHIucmVzcG9uc2VUeXBlKSB7CiAgICAgICAgICAgIGJvZHkgPSB4aHIucmVzcG9uc2VUZXh0IHx8IHhoci5yZXNwb25zZVhNTAogICAgICAgIH0KCiAgICAgICAgaWYgKGlzSnNvbikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYm9keSA9IEpTT04ucGFyc2UoYm9keSkKICAgICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICB9CgogICAgICAgIHJldHVybiBib2R5CiAgICB9CgogICAgdmFyIGZhaWx1cmVSZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgIGJvZHk6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHt9LAogICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogMCwKICAgICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLAogICAgICAgICAgICAgICAgdXJsOiB1cmksCiAgICAgICAgICAgICAgICByYXdSZXF1ZXN0OiB4aHIKICAgICAgICAgICAgfQoKICAgIGZ1bmN0aW9uIGVycm9yRnVuYyhldnQpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKQogICAgICAgIGlmKCEoZXZ0IGluc3RhbmNlb2YgRXJyb3IpKXsKICAgICAgICAgICAgZXZ0ID0gbmV3IEVycm9yKCIiICsgKGV2dCB8fCAiVW5rbm93biBYTUxIdHRwUmVxdWVzdCBFcnJvciIpICkKICAgICAgICB9CiAgICAgICAgZXZ0LnN0YXR1c0NvZGUgPSAwCiAgICAgICAgY2FsbGJhY2soZXZ0LCBmYWlsdXJlUmVzcG9uc2UpCiAgICB9CgogICAgLy8gd2lsbCBsb2FkIHRoZSBkYXRhICYgcHJvY2VzcyB0aGUgcmVzcG9uc2UgaW4gYSBzcGVjaWFsIHJlc3BvbnNlIG9iamVjdAogICAgZnVuY3Rpb24gbG9hZEZ1bmMoKSB7CiAgICAgICAgaWYgKGFib3J0ZWQpIHJldHVybgogICAgICAgIHZhciBzdGF0dXMKICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKQogICAgICAgIGlmKG9wdGlvbnMudXNlWERSICYmIHhoci5zdGF0dXM9PT11bmRlZmluZWQpIHsKICAgICAgICAgICAgLy9JRTggQ09SUyBHRVQgc3VjY2Vzc2Z1bCByZXNwb25zZSBkb2Vzbid0IGhhdmUgYSBzdGF0dXMgZmllbGQsIGJ1dCBib2R5IGlzIGZpbmUKICAgICAgICAgICAgc3RhdHVzID0gMjAwCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdHVzID0gKHhoci5zdGF0dXMgPT09IDEyMjMgPyAyMDQgOiB4aHIuc3RhdHVzKQogICAgICAgIH0KICAgICAgICB2YXIgcmVzcG9uc2UgPSBmYWlsdXJlUmVzcG9uc2UKICAgICAgICB2YXIgZXJyID0gbnVsbAoKICAgICAgICBpZiAoc3RhdHVzICE9PSAwKXsKICAgICAgICAgICAgcmVzcG9uc2UgPSB7CiAgICAgICAgICAgICAgICBib2R5OiBnZXRCb2R5KCksCiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXMsCiAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHt9LAogICAgICAgICAgICAgICAgdXJsOiB1cmksCiAgICAgICAgICAgICAgICByYXdSZXF1ZXN0OiB4aHIKICAgICAgICAgICAgfQogICAgICAgICAgICBpZih4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKXsgLy9yZW1lbWJlciB4aHIgY2FuIGluIGZhY3QgYmUgWERSIGZvciBDT1JTIGluIElFCiAgICAgICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzID0gcGFyc2VIZWFkZXJzKHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVyciA9IG5ldyBFcnJvcigiSW50ZXJuYWwgWE1MSHR0cFJlcXVlc3QgRXJyb3IiKQogICAgICAgIH0KICAgICAgICBjYWxsYmFjayhlcnIsIHJlc3BvbnNlLCByZXNwb25zZS5ib2R5KQoKICAgIH0KCiAgICB2YXIgeGhyID0gb3B0aW9ucy54aHIgfHwgbnVsbAoKICAgIGlmICgheGhyKSB7CiAgICAgICAgaWYgKG9wdGlvbnMuY29ycyB8fCBvcHRpb25zLnVzZVhEUikgewogICAgICAgICAgICB4aHIgPSBuZXcgY3JlYXRlWEhSLlhEb21haW5SZXF1ZXN0KCkKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCgpCiAgICAgICAgfQogICAgfQoKICAgIHZhciBrZXkKICAgIHZhciBhYm9ydGVkCiAgICB2YXIgdXJpID0geGhyLnVybCA9IG9wdGlvbnMudXJpIHx8IG9wdGlvbnMudXJsCiAgICB2YXIgbWV0aG9kID0geGhyLm1ldGhvZCA9IG9wdGlvbnMubWV0aG9kIHx8ICJHRVQiCiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keSB8fCBvcHRpb25zLmRhdGEgfHwgbnVsbAogICAgdmFyIGhlYWRlcnMgPSB4aHIuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fQogICAgdmFyIHN5bmMgPSAhIW9wdGlvbnMuc3luYwogICAgdmFyIGlzSnNvbiA9IGZhbHNlCiAgICB2YXIgdGltZW91dFRpbWVyCgogICAgaWYgKCJqc29uIiBpbiBvcHRpb25zKSB7CiAgICAgICAgaXNKc29uID0gdHJ1ZQogICAgICAgIGhlYWRlcnNbImFjY2VwdCJdIHx8IGhlYWRlcnNbIkFjY2VwdCJdIHx8IChoZWFkZXJzWyJBY2NlcHQiXSA9ICJhcHBsaWNhdGlvbi9qc29uIikgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXIKICAgICAgICBpZiAobWV0aG9kICE9PSAiR0VUIiAmJiBtZXRob2QgIT09ICJIRUFEIikgewogICAgICAgICAgICBoZWFkZXJzWyJjb250ZW50LXR5cGUiXSB8fCBoZWFkZXJzWyJDb250ZW50LVR5cGUiXSB8fCAoaGVhZGVyc1siQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIpIC8vRG9uJ3Qgb3ZlcnJpZGUgZXhpc3RpbmcgYWNjZXB0IGhlYWRlciBkZWNsYXJlZCBieSB1c2VyCiAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLmpzb24pCiAgICAgICAgfQogICAgfQoKICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSByZWFkeXN0YXRlY2hhbmdlCiAgICB4aHIub25sb2FkID0gbG9hZEZ1bmMKICAgIHhoci5vbmVycm9yID0gZXJyb3JGdW5jCiAgICAvLyBJRTkgbXVzdCBoYXZlIG9ucHJvZ3Jlc3MgYmUgc2V0IHRvIGEgdW5pcXVlIGZ1bmN0aW9uLgogICAgeGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gSUUgbXVzdCBkaWUKICAgIH0KICAgIHhoci5vbnRpbWVvdXQgPSBlcnJvckZ1bmMKICAgIHhoci5vcGVuKG1ldGhvZCwgdXJpLCAhc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZCkKICAgIC8vaGFzIHRvIGJlIGFmdGVyIG9wZW4KICAgIGlmKCFzeW5jKSB7CiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9ICEhb3B0aW9ucy53aXRoQ3JlZGVudGlhbHMKICAgIH0KICAgIC8vIENhbm5vdCBzZXQgdGltZW91dCB3aXRoIHN5bmMgcmVxdWVzdAogICAgLy8gbm90IHNldHRpbmcgdGltZW91dCBvbiB0aGUgeGhyIG9iamVjdCwgYmVjYXVzZSBvZiBvbGQgd2Via2l0cyBldGMuIG5vdCBoYW5kbGluZyB0aGF0IGNvcnJlY3RseQogICAgLy8gYm90aCBucG0ncyByZXF1ZXN0IGFuZCBqcXVlcnkgMS54IHVzZSB0aGlzIGtpbmQgb2YgdGltZW91dCwgc28gdGhpcyBpcyBiZWluZyBjb25zaXN0ZW50CiAgICBpZiAoIXN5bmMgJiYgb3B0aW9ucy50aW1lb3V0ID4gMCApIHsKICAgICAgICB0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFib3J0ZWQ9dHJ1ZS8vSUU5IG1heSBzdGlsbCBjYWxsIHJlYWR5c3RhdGVjaGFuZ2UKICAgICAgICAgICAgeGhyLmFib3J0KCJ0aW1lb3V0IikKICAgICAgICAgICAgdmFyIGUgPSBuZXcgRXJyb3IoIlhNTEh0dHBSZXF1ZXN0IHRpbWVvdXQiKQogICAgICAgICAgICBlLmNvZGUgPSAiRVRJTUVET1VUIgogICAgICAgICAgICBlcnJvckZ1bmMoZSkKICAgICAgICB9LCBvcHRpb25zLnRpbWVvdXQgKQogICAgfQoKICAgIGlmICh4aHIuc2V0UmVxdWVzdEhlYWRlcikgewogICAgICAgIGZvcihrZXkgaW4gaGVhZGVycyl7CiAgICAgICAgICAgIGlmKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSl7CiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAob3B0aW9ucy5oZWFkZXJzICYmICFpc0VtcHR5KG9wdGlvbnMuaGVhZGVycykpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkhlYWRlcnMgY2Fubm90IGJlIHNldCBvbiBhbiBYRG9tYWluUmVxdWVzdCBvYmplY3QiKQogICAgfQoKICAgIGlmICgicmVzcG9uc2VUeXBlIiBpbiBvcHRpb25zKSB7CiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IG9wdGlvbnMucmVzcG9uc2VUeXBlCiAgICB9CgogICAgaWYgKCJiZWZvcmVTZW5kIiBpbiBvcHRpb25zICYmCiAgICAgICAgdHlwZW9mIG9wdGlvbnMuYmVmb3JlU2VuZCA9PT0gImZ1bmN0aW9uIgogICAgKSB7CiAgICAgICAgb3B0aW9ucy5iZWZvcmVTZW5kKHhocikKICAgIH0KCiAgICB4aHIuc2VuZChib2R5KQoKICAgIHJldHVybiB4aHIKCgp9CgpmdW5jdGlvbiBub29wKCkge30KCn0seyJnbG9iYWwvd2luZG93IjoyLCJpcy1mdW5jdGlvbiI6NTYsIm9uY2UiOjU3LCJwYXJzZS1oZWFkZXJzIjo2MCwieHRlbmQiOjYxfV0sNTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cyA9IGlzRnVuY3Rpb24KCnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcKCmZ1bmN0aW9uIGlzRnVuY3Rpb24gKGZuKSB7CiAgdmFyIHN0cmluZyA9IHRvU3RyaW5nLmNhbGwoZm4pCiAgcmV0dXJuIHN0cmluZyA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJyB8fAogICAgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiBzdHJpbmcgIT09ICdbb2JqZWN0IFJlZ0V4cF0nKSB8fAogICAgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmCiAgICAgLy8gSUU4IGFuZCBiZWxvdwogICAgIChmbiA9PT0gd2luZG93LnNldFRpbWVvdXQgfHwKICAgICAgZm4gPT09IHdpbmRvdy5hbGVydCB8fAogICAgICBmbiA9PT0gd2luZG93LmNvbmZpcm0gfHwKICAgICAgZm4gPT09IHdpbmRvdy5wcm9tcHQpKQp9OwoKfSx7fV0sNTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cyA9IG9uY2UKCm9uY2UucHJvdG8gPSBvbmNlKGZ1bmN0aW9uICgpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnVuY3Rpb24ucHJvdG90eXBlLCAnb25jZScsIHsKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBvbmNlKHRoaXMpCiAgICB9LAogICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSkKfSkKCmZ1bmN0aW9uIG9uY2UgKGZuKSB7CiAgdmFyIGNhbGxlZCA9IGZhbHNlCiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIGlmIChjYWxsZWQpIHJldHVybgogICAgY2FsbGVkID0gdHJ1ZQogICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykKICB9Cn0KCn0se31dLDU4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKdmFyIGlzRnVuY3Rpb24gPSBfZGVyZXFfKCdpcy1mdW5jdGlvbicpCgptb2R1bGUuZXhwb3J0cyA9IGZvckVhY2gKCnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcKdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eQoKZnVuY3Rpb24gZm9yRWFjaChsaXN0LCBpdGVyYXRvciwgY29udGV4dCkgewogICAgaWYgKCFpc0Z1bmN0aW9uKGl0ZXJhdG9yKSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2l0ZXJhdG9yIG11c3QgYmUgYSBmdW5jdGlvbicpCiAgICB9CgogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7CiAgICAgICAgY29udGV4dCA9IHRoaXMKICAgIH0KICAgIAogICAgaWYgKHRvU3RyaW5nLmNhbGwobGlzdCkgPT09ICdbb2JqZWN0IEFycmF5XScpCiAgICAgICAgZm9yRWFjaEFycmF5KGxpc3QsIGl0ZXJhdG9yLCBjb250ZXh0KQogICAgZWxzZSBpZiAodHlwZW9mIGxpc3QgPT09ICdzdHJpbmcnKQogICAgICAgIGZvckVhY2hTdHJpbmcobGlzdCwgaXRlcmF0b3IsIGNvbnRleHQpCiAgICBlbHNlCiAgICAgICAgZm9yRWFjaE9iamVjdChsaXN0LCBpdGVyYXRvciwgY29udGV4dCkKfQoKZnVuY3Rpb24gZm9yRWFjaEFycmF5KGFycmF5LCBpdGVyYXRvciwgY29udGV4dCkgewogICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYXJyYXksIGkpKSB7CiAgICAgICAgICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgYXJyYXlbaV0sIGksIGFycmF5KQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gZm9yRWFjaFN0cmluZyhzdHJpbmcsIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3RyaW5nLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgLy8gbm8gc3VjaCB0aGluZyBhcyBhIHNwYXJzZSBzdHJpbmcuCiAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBzdHJpbmcuY2hhckF0KGkpLCBpLCBzdHJpbmcpCiAgICB9Cn0KCmZ1bmN0aW9uIGZvckVhY2hPYmplY3Qob2JqZWN0LCBpdGVyYXRvciwgY29udGV4dCkgewogICAgZm9yICh2YXIgayBpbiBvYmplY3QpIHsKICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGspKSB7CiAgICAgICAgICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqZWN0W2tdLCBrLCBvYmplY3QpCiAgICAgICAgfQogICAgfQp9Cgp9LHsiaXMtZnVuY3Rpb24iOjU2fV0sNTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewoKZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gdHJpbTsKCmZ1bmN0aW9uIHRyaW0oc3RyKXsKICByZXR1cm4gc3RyLnJlcGxhY2UoL15ccyp8XHMqJC9nLCAnJyk7Cn0KCmV4cG9ydHMubGVmdCA9IGZ1bmN0aW9uKHN0cil7CiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXHMqLywgJycpOwp9OwoKZXhwb3J0cy5yaWdodCA9IGZ1bmN0aW9uKHN0cil7CiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9ccyokLywgJycpOwp9OwoKfSx7fV0sNjA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewp2YXIgdHJpbSA9IF9kZXJlcV8oJ3RyaW0nKQogICwgZm9yRWFjaCA9IF9kZXJlcV8oJ2Zvci1lYWNoJykKICAsIGlzQXJyYXkgPSBmdW5jdGlvbihhcmcpIHsKICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmcpID09PSAnW29iamVjdCBBcnJheV0nOwogICAgfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaGVhZGVycykgewogIGlmICghaGVhZGVycykKICAgIHJldHVybiB7fQoKICB2YXIgcmVzdWx0ID0ge30KCiAgZm9yRWFjaCgKICAgICAgdHJpbShoZWFkZXJzKS5zcGxpdCgnXG4nKQogICAgLCBmdW5jdGlvbiAocm93KSB7CiAgICAgICAgdmFyIGluZGV4ID0gcm93LmluZGV4T2YoJzonKQogICAgICAgICAgLCBrZXkgPSB0cmltKHJvdy5zbGljZSgwLCBpbmRleCkpLnRvTG93ZXJDYXNlKCkKICAgICAgICAgICwgdmFsdWUgPSB0cmltKHJvdy5zbGljZShpbmRleCArIDEpKQoKICAgICAgICBpZiAodHlwZW9mKHJlc3VsdFtrZXldKSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWUKICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkocmVzdWx0W2tleV0pKSB7CiAgICAgICAgICByZXN1bHRba2V5XS5wdXNoKHZhbHVlKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHRba2V5XSA9IFsgcmVzdWx0W2tleV0sIHZhbHVlIF0KICAgICAgICB9CiAgICAgIH0KICApCgogIHJldHVybiByZXN1bHQKfQp9LHsiZm9yLWVhY2giOjU4LCJ0cmltIjo1OX1dLDYxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKbW9kdWxlLmV4cG9ydHMgPSBleHRlbmQKCnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CgpmdW5jdGlvbiBleHRlbmQoKSB7CiAgICB2YXIgdGFyZ2V0ID0ge30KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0KCiAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsKICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0Cn0KCn0se31dLDYyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGJpZy1wbGF5LWJ1dHRvbi5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfYnV0dG9uSnMgPSBfZGVyZXFfKCcuL2J1dHRvbi5qcycpOwoKdmFyIF9idXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9idXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKLyoqCiAqIEluaXRpYWwgcGxheSBidXR0b24uIFNob3dzIGJlZm9yZSB0aGUgdmlkZW8gaGFzIHBsYXllZC4gVGhlIGhpZGluZyBvZiB0aGUKICogYmlnIHBsYXkgYnV0dG9uIGlzIGRvbmUgdmlhIENTUyBhbmQgcGxheWVyIHN0YXRlcy4KICoKICogQHBhcmFtIHtPYmplY3R9IHBsYXllciAgTWFpbiBQbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zIE9iamVjdCBvZiBvcHRpb24gbmFtZXMgYW5kIHZhbHVlcwogKiBAZXh0ZW5kcyBCdXR0b24KICogQGNsYXNzIEJpZ1BsYXlCdXR0b24KICovCgp2YXIgQmlnUGxheUJ1dHRvbiA9IChmdW5jdGlvbiAoX0J1dHRvbikgewogIF9pbmhlcml0cyhCaWdQbGF5QnV0dG9uLCBfQnV0dG9uKTsKCiAgZnVuY3Rpb24gQmlnUGxheUJ1dHRvbihwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCaWdQbGF5QnV0dG9uKTsKCiAgICBfQnV0dG9uLmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKICB9CgogIC8qKgogICAqIEFsbG93IHN1YiBjb21wb25lbnRzIHRvIHN0YWNrIENTUyBjbGFzcyBuYW1lcwogICAqCiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgY29uc3RydWN0ZWQgY2xhc3MgbmFtZQogICAqIEBtZXRob2QgYnVpbGRDU1NDbGFzcwogICAqLwoKICBCaWdQbGF5QnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIHJldHVybiAndmpzLWJpZy1wbGF5LWJ1dHRvbic7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlcyBjbGljayBmb3IgcGxheQogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBCaWdQbGF5QnV0dG9uLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgdGhpcy5wbGF5ZXJfLnBsYXkoKTsKICB9OwoKICByZXR1cm4gQmlnUGxheUJ1dHRvbjsKfSkoX2J1dHRvbkpzMlsnZGVmYXVsdCddKTsKCkJpZ1BsYXlCdXR0b24ucHJvdG90eXBlLmNvbnRyb2xUZXh0XyA9ICdQbGF5IFZpZGVvJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnQmlnUGxheUJ1dHRvbicsIEJpZ1BsYXlCdXR0b24pOwpleHBvcnRzWydkZWZhdWx0J10gPSBCaWdQbGF5QnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuL2J1dHRvbi5qcyI6NjMsIi4vY29tcG9uZW50LmpzIjo2NX1dLDYzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGJ1dHRvbi5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudCA9IF9kZXJlcV8oJy4vY29tcG9uZW50Jyk7Cgp2YXIgX2NvbXBvbmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnQpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi91dGlscy9kb20uanMnKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb21Kcyk7Cgp2YXIgX3V0aWxzRXZlbnRzSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2V2ZW50cy5qcycpOwoKdmFyIEV2ZW50cyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0V2ZW50c0pzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCnZhciBfb2JqZWN0QXNzaWduID0gX2RlcmVxXygnb2JqZWN0LmFzc2lnbicpOwoKdmFyIF9vYmplY3RBc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKTsKCi8qKgogKiBCYXNlIGNsYXNzIGZvciBhbGwgYnV0dG9ucwogKgogKiBAcGFyYW0ge09iamVjdH0gcGxheWVyICBNYWluIFBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMgT2JqZWN0IG9mIG9wdGlvbiBuYW1lcyBhbmQgdmFsdWVzCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgQnV0dG9uCiAqLwoKdmFyIEJ1dHRvbiA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhCdXR0b24sIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBCdXR0b24ocGxheWVyLCBvcHRpb25zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnV0dG9uKTsKCiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB0aGlzLmVtaXRUYXBFdmVudHMoKTsKCiAgICB0aGlzLm9uKCd0YXAnLCB0aGlzLmhhbmRsZUNsaWNrKTsKICAgIHRoaXMub24oJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljayk7CiAgICB0aGlzLm9uKCdmb2N1cycsIHRoaXMuaGFuZGxlRm9jdXMpOwogICAgdGhpcy5vbignYmx1cicsIHRoaXMuaGFuZGxlQmx1cik7CiAgfQoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcGFyYW0ge1N0cmluZz19IHR5cGUgRWxlbWVudCdzIG5vZGUgdHlwZS4gZS5nLiAnZGl2JwogICAqIEBwYXJhbSB7T2JqZWN0PX0gcHJvcHMgQW4gb2JqZWN0IG9mIGVsZW1lbnQgYXR0cmlidXRlcyB0aGF0IHNob3VsZCBiZSBzZXQgb24gdGhlIGVsZW1lbnQgVGFnIG5hbWUKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgQnV0dG9uLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgdmFyIHRhZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/ICdidXR0b24nIDogYXJndW1lbnRzWzBdOwogICAgdmFyIHByb3BzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CiAgICB2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzJdOwoKICAgIHByb3BzID0gX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXSh7CiAgICAgIGNsYXNzTmFtZTogdGhpcy5idWlsZENTU0NsYXNzKCksCiAgICAgIHRhYkluZGV4OiAwCiAgICB9LCBwcm9wcyk7CgogICAgLy8gQWRkIHN0YW5kYXJkIEFyaWEgaW5mbwogICAgYXR0cmlidXRlcyA9IF9vYmplY3RBc3NpZ24yWydkZWZhdWx0J10oewogICAgICByb2xlOiAnYnV0dG9uJywKICAgICAgdHlwZTogJ2J1dHRvbicsIC8vIE5lY2Vzc2FyeSBzaW5jZSB0aGUgZGVmYXVsdCBidXR0b24gdHlwZSBpcyAic3VibWl0IgogICAgICAnYXJpYS1saXZlJzogJ3BvbGl0ZScgLy8gbGV0IHRoZSBzY3JlZW4gcmVhZGVyIHVzZXIga25vdyB0aGF0IHRoZSB0ZXh0IG9mIHRoZSBidXR0b24gbWF5IGNoYW5nZQogICAgfSwgYXR0cmlidXRlcyk7CgogICAgdmFyIGVsID0gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCB0YWcsIHByb3BzLCBhdHRyaWJ1dGVzKTsKCiAgICB0aGlzLmNvbnRyb2xUZXh0RWxfID0gRG9tLmNyZWF0ZUVsKCdzcGFuJywgewogICAgICBjbGFzc05hbWU6ICd2anMtY29udHJvbC10ZXh0JwogICAgfSk7CgogICAgZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250cm9sVGV4dEVsXyk7CgogICAgdGhpcy5jb250cm9sVGV4dCh0aGlzLmNvbnRyb2xUZXh0Xyk7CgogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIENvbnRyb2xzIHRleHQgLSBib3RoIHJlcXVlc3QgYW5kIGxvY2FsaXplCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdGV4dCBUZXh0IGZvciBidXR0b24KICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBjb250cm9sVGV4dAogICAqLwoKICBCdXR0b24ucHJvdG90eXBlLmNvbnRyb2xUZXh0ID0gZnVuY3Rpb24gY29udHJvbFRleHQodGV4dCkgewogICAgaWYgKCF0ZXh0KSByZXR1cm4gdGhpcy5jb250cm9sVGV4dF8gfHwgJ05lZWQgVGV4dCc7CgogICAgdGhpcy5jb250cm9sVGV4dF8gPSB0ZXh0OwogICAgdGhpcy5jb250cm9sVGV4dEVsXy5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKHRoaXMuY29udHJvbFRleHRfKTsKCiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBBbGxvd3Mgc3ViIGNvbXBvbmVudHMgdG8gc3RhY2sgQ1NTIGNsYXNzIG5hbWVzCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBidWlsZENTU0NsYXNzCiAgICovCgogIEJ1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1jb250cm9sIHZqcy1idXR0b24gJyArIF9Db21wb25lbnQucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgQ2xpY2sgLSBPdmVycmlkZSB3aXRoIHNwZWNpZmljIGZ1bmN0aW9uYWxpdHkgZm9yIGJ1dHRvbgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBCdXR0b24ucHJvdG90eXBlLmhhbmRsZUNsaWNrID0gZnVuY3Rpb24gaGFuZGxlQ2xpY2soKSB7fTsKCiAgLyoqCiAgICogSGFuZGxlIEZvY3VzIC0gQWRkIGtleWJvYXJkIGZ1bmN0aW9uYWxpdHkgdG8gZWxlbWVudAogICAqCiAgICogQG1ldGhvZCBoYW5kbGVGb2N1cwogICAqLwoKICBCdXR0b24ucHJvdG90eXBlLmhhbmRsZUZvY3VzID0gZnVuY3Rpb24gaGFuZGxlRm9jdXMoKSB7CiAgICBFdmVudHMub24oX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAna2V5ZG93bicsIEZuLmJpbmQodGhpcywgdGhpcy5oYW5kbGVLZXlQcmVzcykpOwogIH07CgogIC8qKgogICAqIEhhbmRsZSBLZXlQcmVzcyAoZG9jdW1lbnQgbGV2ZWwpIC0gVHJpZ2dlciBjbGljayB3aGVuIGtleXMgYXJlIHByZXNzZWQKICAgKgogICAqIEBtZXRob2QgaGFuZGxlS2V5UHJlc3MKICAgKi8KCiAgQnV0dG9uLnByb3RvdHlwZS5oYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uIGhhbmRsZUtleVByZXNzKGV2ZW50KSB7CiAgICAvLyBDaGVjayBmb3Igc3BhY2UgYmFyICgzMikgb3IgZW50ZXIgKDEzKSBrZXlzCiAgICBpZiAoZXZlbnQud2hpY2ggPT09IDMyIHx8IGV2ZW50LndoaWNoID09PSAxMykgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLmhhbmRsZUNsaWNrKGV2ZW50KTsKICAgIH0KICB9OwoKICAvKioKICAgKiBIYW5kbGUgQmx1ciAtIFJlbW92ZSBrZXlib2FyZCB0cmlnZ2VycwogICAqCiAgICogQG1ldGhvZCBoYW5kbGVCbHVyCiAgICovCgogIEJ1dHRvbi5wcm90b3R5cGUuaGFuZGxlQmx1ciA9IGZ1bmN0aW9uIGhhbmRsZUJsdXIoKSB7CiAgICBFdmVudHMub2ZmKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXSwgJ2tleWRvd24nLCBGbi5iaW5kKHRoaXMsIHRoaXMuaGFuZGxlS2V5UHJlc3MpKTsKICB9OwoKICByZXR1cm4gQnV0dG9uOwp9KShfY29tcG9uZW50MlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnQyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ0J1dHRvbicsIEJ1dHRvbik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IEJ1dHRvbjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9jb21wb25lbnQiOjY1LCIuL3V0aWxzL2RvbS5qcyI6MTI4LCIuL3V0aWxzL2V2ZW50cy5qcyI6MTI5LCIuL3V0aWxzL2ZuLmpzIjoxMzAsImdsb2JhbC9kb2N1bWVudCI6MSwib2JqZWN0LmFzc2lnbiI6NDV9XSw2NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2J1dHRvbiA9IF9kZXJlcV8oJy4vYnV0dG9uJyk7Cgp2YXIgX2J1dHRvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9idXR0b24pOwoKdmFyIF9jb21wb25lbnQgPSBfZGVyZXFfKCcuL2NvbXBvbmVudCcpOwoKdmFyIF9jb21wb25lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50KTsKCi8qKgogKiBUaGUgYENsb3NlQnV0dG9uYCBjb21wb25lbnQgaXMgYSBidXR0b24gd2hpY2ggZmlyZXMgYSAiY2xvc2UiIGV2ZW50CiAqIHdoZW4gaXQgaXMgYWN0aXZhdGVkLgogKgogKiBAZXh0ZW5kcyBCdXR0b24KICogQGNsYXNzIENsb3NlQnV0dG9uCiAqLwoKdmFyIENsb3NlQnV0dG9uID0gKGZ1bmN0aW9uIChfQnV0dG9uKSB7CiAgX2luaGVyaXRzKENsb3NlQnV0dG9uLCBfQnV0dG9uKTsKCiAgZnVuY3Rpb24gQ2xvc2VCdXR0b24ocGxheWVyLCBvcHRpb25zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2xvc2VCdXR0b24pOwoKICAgIF9CdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwogICAgdGhpcy5jb250cm9sVGV4dChvcHRpb25zICYmIG9wdGlvbnMuY29udHJvbFRleHQgfHwgdGhpcy5sb2NhbGl6ZSgnQ2xvc2UnKSk7CiAgfQoKICBDbG9zZUJ1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1jbG9zZS1idXR0b24gJyArIF9CdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKTsKICB9OwoKICBDbG9zZUJ1dHRvbi5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIHRoaXMudHJpZ2dlcih7IHR5cGU6ICdjbG9zZScsIGJ1YmJsZXM6IGZhbHNlIH0pOwogIH07CgogIHJldHVybiBDbG9zZUJ1dHRvbjsKfSkoX2J1dHRvbjJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdDbG9zZUJ1dHRvbicsIENsb3NlQnV0dG9uKTsKZXhwb3J0c1snZGVmYXVsdCddID0gQ2xvc2VCdXR0b247Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vYnV0dG9uIjo2MywiLi9jb21wb25lbnQiOjY1fV0sNjU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgY29tcG9uZW50LmpzCiAqCiAqIFBsYXllciBDb21wb25lbnQgLSBCYXNlIGNsYXNzIGZvciBhbGwgVUkgb2JqZWN0cwogKi8KCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9Cgp2YXIgX2dsb2JhbFdpbmRvdyA9IF9kZXJlcV8oJ2dsb2JhbC93aW5kb3cnKTsKCnZhciBfZ2xvYmFsV2luZG93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbFdpbmRvdyk7Cgp2YXIgX3V0aWxzRG9tSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2RvbS5qcycpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbUpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX3V0aWxzR3VpZEpzID0gX2RlcmVxXygnLi91dGlscy9ndWlkLmpzJyk7Cgp2YXIgR3VpZCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0d1aWRKcyk7Cgp2YXIgX3V0aWxzRXZlbnRzSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2V2ZW50cy5qcycpOwoKdmFyIEV2ZW50cyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0V2ZW50c0pzKTsKCnZhciBfdXRpbHNMb2dKcyA9IF9kZXJlcV8oJy4vdXRpbHMvbG9nLmpzJyk7Cgp2YXIgX3V0aWxzTG9nSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNMb2dKcyk7Cgp2YXIgX3V0aWxzVG9UaXRsZUNhc2VKcyA9IF9kZXJlcV8oJy4vdXRpbHMvdG8tdGl0bGUtY2FzZS5qcycpOwoKdmFyIF91dGlsc1RvVGl0bGVDYXNlSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNUb1RpdGxlQ2FzZUpzKTsKCnZhciBfb2JqZWN0QXNzaWduID0gX2RlcmVxXygnb2JqZWN0LmFzc2lnbicpOwoKdmFyIF9vYmplY3RBc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKTsKCnZhciBfdXRpbHNNZXJnZU9wdGlvbnNKcyA9IF9kZXJlcV8oJy4vdXRpbHMvbWVyZ2Utb3B0aW9ucy5qcycpOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uc0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzTWVyZ2VPcHRpb25zSnMpOwoKLyoqCiAqIEJhc2UgVUkgQ29tcG9uZW50IGNsYXNzCiAqIENvbXBvbmVudHMgYXJlIGVtYmVkZGFibGUgVUkgb2JqZWN0cyB0aGF0IGFyZSByZXByZXNlbnRlZCBieSBib3RoIGEKICogamF2YXNjcmlwdCBvYmplY3QgYW5kIGFuIGVsZW1lbnQgaW4gdGhlIERPTS4gVGhleSBjYW4gYmUgY2hpbGRyZW4gb2Ygb3RoZXIKICogY29tcG9uZW50cywgYW5kIGNhbiBoYXZlIG1hbnkgY2hpbGRyZW4gdGhlbXNlbHZlcy4KICogYGBganMKICogICAgIC8vIGFkZGluZyBhIGJ1dHRvbiB0byB0aGUgcGxheWVyCiAqICAgICB2YXIgYnV0dG9uID0gcGxheWVyLmFkZENoaWxkKCdidXR0b24nKTsKICogICAgIGJ1dHRvbi5lbCgpOyAvLyAtPiBidXR0b24gZWxlbWVudAogKiBgYGAKICogYGBgaHRtbAogKiAgICAgPGRpdiBjbGFzcz0idmlkZW8tanMiPgogKiAgICAgICA8ZGl2IGNsYXNzPSJ2anMtYnV0dG9uIj5CdXR0b248L2Rpdj4KICogICAgIDwvZGl2PgogKiBgYGAKICogQ29tcG9uZW50cyBhcmUgYWxzbyBldmVudCB0YXJnZXRzLgogKiBgYGBqcwogKiAgICAgYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7CiAqICAgICAgIGNvbnNvbGUubG9nKCdCdXR0b24gQ2xpY2tlZCEnKTsKICogICAgIH0pOwogKiAgICAgYnV0dG9uLnRyaWdnZXIoJ2N1c3RvbWV2ZW50Jyk7CiAqIGBgYAogKgogKiBAcGFyYW0ge09iamVjdH0gcGxheWVyICBNYWluIFBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMgT2JqZWN0IG9mIG9wdGlvbiBuYW1lcyBhbmQgdmFsdWVzCiAqIEBwYXJhbSB7RnVuY3Rpb249fSByZWFkeSAgICBSZWFkeSBjYWxsYmFjayBmdW5jdGlvbgogKiBAY2xhc3MgQ29tcG9uZW50CiAqLwoKdmFyIENvbXBvbmVudCA9IChmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ29tcG9uZW50KHBsYXllciwgb3B0aW9ucywgcmVhZHkpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wb25lbnQpOwoKICAgIC8vIFRoZSBjb21wb25lbnQgbWlnaHQgYmUgdGhlIHBsYXllciBpdHNlbGYgYW5kIHdlIGNhbid0IHBhc3MgYHRoaXNgIHRvIHN1cGVyCiAgICBpZiAoIXBsYXllciAmJiB0aGlzLnBsYXkpIHsKICAgICAgdGhpcy5wbGF5ZXJfID0gcGxheWVyID0gdGhpczsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBsYXllcl8gPSBwbGF5ZXI7CiAgICAgIH0KCiAgICAvLyBNYWtlIGEgY29weSBvZiBwcm90b3R5cGUub3B0aW9uc18gdG8gcHJvdGVjdCBhZ2FpbnN0IG92ZXJyaWRpbmcgZGVmYXVsdHMKICAgIHRoaXMub3B0aW9uc18gPSBfdXRpbHNNZXJnZU9wdGlvbnNKczJbJ2RlZmF1bHQnXSh7fSwgdGhpcy5vcHRpb25zXyk7CgogICAgLy8gVXBkYXRlZCBvcHRpb25zIHdpdGggc3VwcGxpZWQgb3B0aW9ucwogICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uc18gPSBfdXRpbHNNZXJnZU9wdGlvbnNKczJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnNfLCBvcHRpb25zKTsKCiAgICAvLyBHZXQgSUQgZnJvbSBvcHRpb25zIG9yIG9wdGlvbnMgZWxlbWVudCBpZiBvbmUgaXMgc3VwcGxpZWQKICAgIHRoaXMuaWRfID0gb3B0aW9ucy5pZCB8fCBvcHRpb25zLmVsICYmIG9wdGlvbnMuZWwuaWQ7CgogICAgLy8gSWYgdGhlcmUgd2FzIG5vIElEIGZyb20gdGhlIG9wdGlvbnMsIGdlbmVyYXRlIG9uZQogICAgaWYgKCF0aGlzLmlkXykgewogICAgICAvLyBEb24ndCByZXF1aXJlIHRoZSBwbGF5ZXIgSUQgZnVuY3Rpb24gaW4gdGhlIGNhc2Ugb2YgbW9jayBwbGF5ZXJzCiAgICAgIHZhciBpZCA9IHBsYXllciAmJiBwbGF5ZXIuaWQgJiYgcGxheWVyLmlkKCkgfHwgJ25vX3BsYXllcic7CgogICAgICB0aGlzLmlkXyA9IGlkICsgJ19jb21wb25lbnRfJyArIEd1aWQubmV3R1VJRCgpOwogICAgfQoKICAgIHRoaXMubmFtZV8gPSBvcHRpb25zLm5hbWUgfHwgbnVsbDsKCiAgICAvLyBDcmVhdGUgZWxlbWVudCBpZiBvbmUgd2Fzbid0IHByb3ZpZGVkIGluIG9wdGlvbnMKICAgIGlmIChvcHRpb25zLmVsKSB7CiAgICAgIHRoaXMuZWxfID0gb3B0aW9ucy5lbDsKICAgIH0gZWxzZSBpZiAob3B0aW9ucy5jcmVhdGVFbCAhPT0gZmFsc2UpIHsKICAgICAgdGhpcy5lbF8gPSB0aGlzLmNyZWF0ZUVsKCk7CiAgICB9CgogICAgdGhpcy5jaGlsZHJlbl8gPSBbXTsKICAgIHRoaXMuY2hpbGRJbmRleF8gPSB7fTsKICAgIHRoaXMuY2hpbGROYW1lSW5kZXhfID0ge307CgogICAgLy8gQWRkIGFueSBjaGlsZCBjb21wb25lbnRzIGluIG9wdGlvbnMKICAgIGlmIChvcHRpb25zLmluaXRDaGlsZHJlbiAhPT0gZmFsc2UpIHsKICAgICAgdGhpcy5pbml0Q2hpbGRyZW4oKTsKICAgIH0KCiAgICB0aGlzLnJlYWR5KHJlYWR5KTsKICAgIC8vIERvbid0IHdhbnQgdG8gdHJpZ2dlciByZWFkeSBoZXJlIG9yIGl0IHdpbGwgYmVmb3JlIGluaXQgaXMgYWN0dWFsbHkKICAgIC8vIGZpbmlzaGVkIGZvciBhbGwgY2hpbGRyZW4gdGhhdCBydW4gdGhpcyBjb25zdHJ1Y3RvcgoKICAgIGlmIChvcHRpb25zLnJlcG9ydFRvdWNoQWN0aXZpdHkgIT09IGZhbHNlKSB7CiAgICAgIHRoaXMuZW5hYmxlVG91Y2hBY3Rpdml0eSgpOwogICAgfQogIH0KCiAgLyoqCiAgICogRGlzcG9zZSBvZiB0aGUgY29tcG9uZW50IGFuZCBhbGwgY2hpbGQgY29tcG9uZW50cwogICAqCiAgICogQG1ldGhvZCBkaXNwb3NlCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICB0aGlzLnRyaWdnZXIoeyB0eXBlOiAnZGlzcG9zZScsIGJ1YmJsZXM6IGZhbHNlIH0pOwoKICAgIC8vIERpc3Bvc2UgYWxsIGNoaWxkcmVuLgogICAgaWYgKHRoaXMuY2hpbGRyZW5fKSB7CiAgICAgIGZvciAodmFyIGkgPSB0aGlzLmNoaWxkcmVuXy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGlmICh0aGlzLmNoaWxkcmVuX1tpXS5kaXNwb3NlKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuX1tpXS5kaXNwb3NlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgLy8gRGVsZXRlIGNoaWxkIHJlZmVyZW5jZXMKICAgIHRoaXMuY2hpbGRyZW5fID0gbnVsbDsKICAgIHRoaXMuY2hpbGRJbmRleF8gPSBudWxsOwogICAgdGhpcy5jaGlsZE5hbWVJbmRleF8gPSBudWxsOwoKICAgIC8vIFJlbW92ZSBhbGwgZXZlbnQgbGlzdGVuZXJzLgogICAgdGhpcy5vZmYoKTsKCiAgICAvLyBSZW1vdmUgZWxlbWVudCBmcm9tIERPTQogICAgaWYgKHRoaXMuZWxfLnBhcmVudE5vZGUpIHsKICAgICAgdGhpcy5lbF8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsXyk7CiAgICB9CgogICAgRG9tLnJlbW92ZUVsRGF0YSh0aGlzLmVsXyk7CiAgICB0aGlzLmVsXyA9IG51bGw7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJuIHRoZSBjb21wb25lbnQncyBwbGF5ZXIKICAgKgogICAqIEByZXR1cm4ge1BsYXllcn0KICAgKiBAbWV0aG9kIHBsYXllcgogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnBsYXllciA9IGZ1bmN0aW9uIHBsYXllcigpIHsKICAgIHJldHVybiB0aGlzLnBsYXllcl87CiAgfTsKCiAgLyoqCiAgICogRGVlcCBtZXJnZSBvZiBvcHRpb25zIG9iamVjdHMKICAgKiBXaGVuZXZlciBhIHByb3BlcnR5IGlzIGFuIG9iamVjdCBvbiBib3RoIG9wdGlvbnMgb2JqZWN0cwogICAqIHRoZSB0d28gcHJvcGVydGllcyB3aWxsIGJlIG1lcmdlZCB1c2luZyBtZXJnZU9wdGlvbnMuCiAgICoKICAgKiBgYGBqcwogICAqICAgICBQYXJlbnQucHJvdG90eXBlLm9wdGlvbnNfID0gewogICAqICAgICAgIG9wdGlvblNldDogewogICAqICAgICAgICAgJ2NoaWxkT25lJzogeyAnZm9vJzogJ2JhcicsICdhc2RmJzogJ2Zkc2EnIH0sCiAgICogICAgICAgICAnY2hpbGRUd28nOiB7fSwKICAgKiAgICAgICAgICdjaGlsZFRocmVlJzoge30KICAgKiAgICAgICB9CiAgICogICAgIH0KICAgKiAgICAgbmV3T3B0aW9ucyA9IHsKICAgKiAgICAgICBvcHRpb25TZXQ6IHsKICAgKiAgICAgICAgICdjaGlsZE9uZSc6IHsgJ2Zvbyc6ICdiYXonLCAnYWJjJzogJzEyMycgfQogICAqICAgICAgICAgJ2NoaWxkVHdvJzogbnVsbCwKICAgKiAgICAgICAgICdjaGlsZEZvdXInOiB7fQogICAqICAgICAgIH0KICAgKiAgICAgfQogICAqCiAgICogICAgIHRoaXMub3B0aW9ucyhuZXdPcHRpb25zKTsKICAgKiBgYGAKICAgKiBSRVNVTFQKICAgKiBgYGBqcwogICAqICAgICB7CiAgICogICAgICAgb3B0aW9uU2V0OiB7CiAgICogICAgICAgICAnY2hpbGRPbmUnOiB7ICdmb28nOiAnYmF6JywgJ2FzZGYnOiAnZmRzYScsICdhYmMnOiAnMTIzJyB9LAogICAqICAgICAgICAgJ2NoaWxkVHdvJzogbnVsbCwgLy8gRGlzYWJsZWQuIFdvbid0IGJlIGluaXRpYWxpemVkLgogICAqICAgICAgICAgJ2NoaWxkVGhyZWUnOiB7fSwKICAgKiAgICAgICAgICdjaGlsZEZvdXInOiB7fQogICAqICAgICAgIH0KICAgKiAgICAgfQogICAqIGBgYAogICAqCiAgICogQHBhcmFtICB7T2JqZWN0fSBvYmogT2JqZWN0IG9mIG5ldyBvcHRpb24gdmFsdWVzCiAgICogQHJldHVybiB7T2JqZWN0fSAgICAgQSBORVcgb2JqZWN0IG9mIHRoaXMub3B0aW9uc18gYW5kIG9iaiBtZXJnZWQKICAgKiBAbWV0aG9kIG9wdGlvbnMKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5vcHRpb25zID0gZnVuY3Rpb24gb3B0aW9ucyhvYmopIHsKICAgIF91dGlsc0xvZ0pzMlsnZGVmYXVsdCddLndhcm4oJ3RoaXMub3B0aW9ucygpIGhhcyBiZWVuIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgbW92ZWQgdG8gdGhlIGNvbnN0cnVjdG9yIGluIDYuMCcpOwoKICAgIGlmICghb2JqKSB7CiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNfOwogICAgfQoKICAgIHRoaXMub3B0aW9uc18gPSBfdXRpbHNNZXJnZU9wdGlvbnNKczJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnNfLCBvYmopOwogICAgcmV0dXJuIHRoaXMub3B0aW9uc187CiAgfTsKCiAgLyoqCiAgICogR2V0IHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqIGBgYGpzCiAgICogICAgIHZhciBkb21FbCA9IG15Q29tcG9uZW50LmVsKCk7CiAgICogYGBgCiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgZWwKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5lbCA9IGZ1bmN0aW9uIGVsKCkgewogICAgcmV0dXJuIHRoaXMuZWxfOwogIH07CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSAge1N0cmluZz19IHRhZ05hbWUgIEVsZW1lbnQncyBub2RlIHR5cGUuIGUuZy4gJ2RpdicKICAgKiBAcGFyYW0gIHtPYmplY3Q9fSBwcm9wZXJ0aWVzIEFuIG9iamVjdCBvZiBwcm9wZXJ0aWVzIHRoYXQgc2hvdWxkIGJlIHNldAogICAqIEBwYXJhbSAge09iamVjdD19IGF0dHJpYnV0ZXMgQW4gb2JqZWN0IG9mIGF0dHJpYnV0ZXMgdGhhdCBzaG91bGQgYmUgc2V0CiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCh0YWdOYW1lLCBwcm9wZXJ0aWVzLCBhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gRG9tLmNyZWF0ZUVsKHRhZ05hbWUsIHByb3BlcnRpZXMsIGF0dHJpYnV0ZXMpOwogIH07CgogIENvbXBvbmVudC5wcm90b3R5cGUubG9jYWxpemUgPSBmdW5jdGlvbiBsb2NhbGl6ZShzdHJpbmcpIHsKICAgIHZhciBjb2RlID0gdGhpcy5wbGF5ZXJfLmxhbmd1YWdlICYmIHRoaXMucGxheWVyXy5sYW5ndWFnZSgpOwogICAgdmFyIGxhbmd1YWdlcyA9IHRoaXMucGxheWVyXy5sYW5ndWFnZXMgJiYgdGhpcy5wbGF5ZXJfLmxhbmd1YWdlcygpOwoKICAgIGlmICghY29kZSB8fCAhbGFuZ3VhZ2VzKSB7CiAgICAgIHJldHVybiBzdHJpbmc7CiAgICB9CgogICAgdmFyIGxhbmd1YWdlID0gbGFuZ3VhZ2VzW2NvZGVdOwoKICAgIGlmIChsYW5ndWFnZSAmJiBsYW5ndWFnZVtzdHJpbmddKSB7CiAgICAgIHJldHVybiBsYW5ndWFnZVtzdHJpbmddOwogICAgfQoKICAgIHZhciBwcmltYXJ5Q29kZSA9IGNvZGUuc3BsaXQoJy0nKVswXTsKICAgIHZhciBwcmltYXJ5TGFuZyA9IGxhbmd1YWdlc1twcmltYXJ5Q29kZV07CgogICAgaWYgKHByaW1hcnlMYW5nICYmIHByaW1hcnlMYW5nW3N0cmluZ10pIHsKICAgICAgcmV0dXJuIHByaW1hcnlMYW5nW3N0cmluZ107CiAgICB9CgogICAgcmV0dXJuIHN0cmluZzsKICB9OwoKICAvKioKICAgKiBSZXR1cm4gdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50IHdoZXJlIGNoaWxkcmVuIGFyZSBpbnNlcnRlZC4KICAgKiBXaWxsIGVpdGhlciBiZSB0aGUgc2FtZSBhcyBlbCgpIG9yIGEgbmV3IGVsZW1lbnQgZGVmaW5lZCBpbiBjcmVhdGVFbCgpLgogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNvbnRlbnRFbAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmNvbnRlbnRFbCA9IGZ1bmN0aW9uIGNvbnRlbnRFbCgpIHsKICAgIHJldHVybiB0aGlzLmNvbnRlbnRFbF8gfHwgdGhpcy5lbF87CiAgfTsKCiAgLyoqCiAgICogR2V0IHRoZSBjb21wb25lbnQncyBJRAogICAqIGBgYGpzCiAgICogICAgIHZhciBpZCA9IG15Q29tcG9uZW50LmlkKCk7CiAgICogYGBgCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBpZAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmlkID0gZnVuY3Rpb24gaWQoKSB7CiAgICByZXR1cm4gdGhpcy5pZF87CiAgfTsKCiAgLyoqCiAgICogR2V0IHRoZSBjb21wb25lbnQncyBuYW1lLiBUaGUgbmFtZSBpcyBvZnRlbiB1c2VkIHRvIHJlZmVyZW5jZSB0aGUgY29tcG9uZW50LgogICAqIGBgYGpzCiAgICogICAgIHZhciBuYW1lID0gbXlDb21wb25lbnQubmFtZSgpOwogICAqIGBgYAogICAqCiAgICogQHJldHVybiB7U3RyaW5nfQogICAqIEBtZXRob2QgbmFtZQogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLm5hbWUgPSBmdW5jdGlvbiBuYW1lKCkgewogICAgcmV0dXJuIHRoaXMubmFtZV87CiAgfTsKCiAgLyoqCiAgICogR2V0IGFuIGFycmF5IG9mIGFsbCBjaGlsZCBjb21wb25lbnRzCiAgICogYGBganMKICAgKiAgICAgdmFyIGtpZHMgPSBteUNvbXBvbmVudC5jaGlsZHJlbigpOwogICAqIGBgYAogICAqCiAgICogQHJldHVybiB7QXJyYXl9IFRoZSBjaGlsZHJlbgogICAqIEBtZXRob2QgY2hpbGRyZW4KICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5jaGlsZHJlbiA9IGZ1bmN0aW9uIGNoaWxkcmVuKCkgewogICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5fOwogIH07CgogIC8qKgogICAqIFJldHVybnMgYSBjaGlsZCBjb21wb25lbnQgd2l0aCB0aGUgcHJvdmlkZWQgSUQKICAgKgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAbWV0aG9kIGdldENoaWxkQnlJZAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmdldENoaWxkQnlJZCA9IGZ1bmN0aW9uIGdldENoaWxkQnlJZChpZCkgewogICAgcmV0dXJuIHRoaXMuY2hpbGRJbmRleF9baWRdOwogIH07CgogIC8qKgogICAqIFJldHVybnMgYSBjaGlsZCBjb21wb25lbnQgd2l0aCB0aGUgcHJvdmlkZWQgbmFtZQogICAqCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2QgZ2V0Q2hpbGQKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDaGlsZCA9IGZ1bmN0aW9uIGdldENoaWxkKG5hbWUpIHsKICAgIHJldHVybiB0aGlzLmNoaWxkTmFtZUluZGV4X1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBBZGRzIGEgY2hpbGQgY29tcG9uZW50IGluc2lkZSB0aGlzIGNvbXBvbmVudAogICAqIGBgYGpzCiAgICogICAgIG15Q29tcG9uZW50LmVsKCk7CiAgICogICAgIC8vIC0+IDxkaXYgY2xhc3M9J215LWNvbXBvbmVudCc+PC9kaXY+CiAgICogICAgIG15Q29tcG9uZW50LmNoaWxkcmVuKCk7CiAgICogICAgIC8vIFtlbXB0eSBhcnJheV0KICAgKgogICAqICAgICB2YXIgbXlCdXR0b24gPSBteUNvbXBvbmVudC5hZGRDaGlsZCgnTXlCdXR0b24nKTsKICAgKiAgICAgLy8gLT4gPGRpdiBjbGFzcz0nbXktY29tcG9uZW50Jz48ZGl2IGNsYXNzPSJteS1idXR0b24iPm15QnV0dG9uPGRpdj48L2Rpdj4KICAgKiAgICAgLy8gLT4gbXlCdXR0b24gPT09IG15Q29tcG9uZW50LmNoaWxkcmVuKClbMF07CiAgICogYGBgCiAgICogUGFzcyBpbiBvcHRpb25zIGZvciBjaGlsZCBjb25zdHJ1Y3RvcnMgYW5kIG9wdGlvbnMgZm9yIGNoaWxkcmVuIG9mIHRoZSBjaGlsZAogICAqIGBgYGpzCiAgICogICAgIHZhciBteUJ1dHRvbiA9IG15Q29tcG9uZW50LmFkZENoaWxkKCdNeUJ1dHRvbicsIHsKICAgKiAgICAgICB0ZXh0OiAnUHJlc3MgTWUnLAogICAqICAgICAgIGJ1dHRvbkNoaWxkRXhhbXBsZTogewogICAqICAgICAgICAgYnV0dG9uQ2hpbGRPcHRpb246IHRydWUKICAgKiAgICAgICB9CiAgICogICAgIH0pOwogICAqIGBgYAogICAqCiAgICogQHBhcmFtIHtTdHJpbmd8Q29tcG9uZW50fSBjaGlsZCBUaGUgY2xhc3MgbmFtZSBvciBpbnN0YW5jZSBvZiBhIGNoaWxkIHRvIGFkZAogICAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyBPcHRpb25zLCBpbmNsdWRpbmcgb3B0aW9ucyB0byBiZSBwYXNzZWQgdG8gY2hpbGRyZW4gb2YgdGhlIGNoaWxkLgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0gVGhlIGNoaWxkIGNvbXBvbmVudCAoY3JlYXRlZCBieSB0aGlzIHByb2Nlc3MgaWYgYSBzdHJpbmcgd2FzIHVzZWQpCiAgICogQG1ldGhvZCBhZGRDaGlsZAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gYWRkQ2hpbGQoY2hpbGQpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CgogICAgdmFyIGNvbXBvbmVudCA9IHVuZGVmaW5lZDsKICAgIHZhciBjb21wb25lbnROYW1lID0gdW5kZWZpbmVkOwoKICAgIC8vIElmIGNoaWxkIGlzIGEgc3RyaW5nLCBjcmVhdGUgbnQgd2l0aCBvcHRpb25zCiAgICBpZiAodHlwZW9mIGNoaWxkID09PSAnc3RyaW5nJykgewogICAgICBjb21wb25lbnROYW1lID0gY2hpbGQ7CgogICAgICAvLyBPcHRpb25zIGNhbiBhbHNvIGJlIHNwZWNpZmllZCBhcyBhIGJvb2xlYW4sIHNvIGNvbnZlcnQgdG8gYW4gZW1wdHkgb2JqZWN0IGlmIGZhbHNlLgogICAgICBpZiAoIW9wdGlvbnMpIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIC8vIFNhbWUgYXMgYWJvdmUsIGJ1dCB0cnVlIGlzIGRlcHJlY2F0ZWQgc28gc2hvdyBhIHdhcm5pbmcuCiAgICAgIGlmIChvcHRpb25zID09PSB0cnVlKSB7CiAgICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10ud2FybignSW5pdGlhbGl6aW5nIGEgY2hpbGQgY29tcG9uZW50IHdpdGggYHRydWVgIGlzIGRlcHJlY2F0ZWQuIENoaWxkcmVuIHNob3VsZCBiZSBkZWZpbmVkIGluIGFuIGFycmF5IHdoZW4gcG9zc2libGUsIGJ1dCBpZiBuZWNlc3NhcnkgdXNlIGFuIG9iamVjdCBpbnN0ZWFkIG9mIGB0cnVlYC4nKTsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIC8vIElmIG5vIGNvbXBvbmVudENsYXNzIGluIG9wdGlvbnMsIGFzc3VtZSBjb21wb25lbnRDbGFzcyBpcyB0aGUgbmFtZSBsb3dlcmNhc2VkCiAgICAgIC8vIChlLmcuIHBsYXlCdXR0b24pCiAgICAgIHZhciBjb21wb25lbnRDbGFzc05hbWUgPSBvcHRpb25zLmNvbXBvbmVudENsYXNzIHx8IF91dGlsc1RvVGl0bGVDYXNlSnMyWydkZWZhdWx0J10oY29tcG9uZW50TmFtZSk7CgogICAgICAvLyBTZXQgbmFtZSB0aHJvdWdoIG9wdGlvbnMKICAgICAgb3B0aW9ucy5uYW1lID0gY29tcG9uZW50TmFtZTsKCiAgICAgIC8vIENyZWF0ZSBhIG5ldyBvYmplY3QgJiBlbGVtZW50IGZvciB0aGlzIGNvbnRyb2xzIHNldAogICAgICAvLyBJZiB0aGVyZSdzIG5vIC5wbGF5ZXJfLCB0aGlzIGlzIGEgcGxheWVyCiAgICAgIHZhciBDb21wb25lbnRDbGFzcyA9IENvbXBvbmVudC5nZXRDb21wb25lbnQoY29tcG9uZW50Q2xhc3NOYW1lKTsKCiAgICAgIGlmICghQ29tcG9uZW50Q2xhc3MpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCAnICsgY29tcG9uZW50Q2xhc3NOYW1lICsgJyBkb2VzIG5vdCBleGlzdCcpOwogICAgICB9CgogICAgICAvLyBkYXRhIHN0b3JlZCBkaXJlY3RseSBvbiB0aGUgdmlkZW9qcyBvYmplY3QgbWF5IGJlCiAgICAgIC8vIG1pc2lkZW50aWZpZWQgYXMgYSBjb21wb25lbnQgdG8gcmV0YWluCiAgICAgIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IHdpdGggNC54LiBjaGVjayB0byBtYWtlIHN1cmUgdGhlCiAgICAgIC8vIGNvbXBvbmVudCBjbGFzcyBjYW4gYmUgaW5zdGFudGlhdGVkLgogICAgICBpZiAodHlwZW9mIENvbXBvbmVudENsYXNzICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbXBvbmVudCA9IG5ldyBDb21wb25lbnRDbGFzcyh0aGlzLnBsYXllcl8gfHwgdGhpcywgb3B0aW9ucyk7CgogICAgICAvLyBjaGlsZCBpcyBhIGNvbXBvbmVudCBpbnN0YW5jZQogICAgfSBlbHNlIHsKICAgICAgICBjb21wb25lbnQgPSBjaGlsZDsKICAgICAgfQoKICAgIHRoaXMuY2hpbGRyZW5fLnB1c2goY29tcG9uZW50KTsKCiAgICBpZiAodHlwZW9mIGNvbXBvbmVudC5pZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB0aGlzLmNoaWxkSW5kZXhfW2NvbXBvbmVudC5pZCgpXSA9IGNvbXBvbmVudDsKICAgIH0KCiAgICAvLyBJZiBhIG5hbWUgd2Fzbid0IHVzZWQgdG8gY3JlYXRlIHRoZSBjb21wb25lbnQsIGNoZWNrIGlmIHdlIGNhbiB1c2UgdGhlCiAgICAvLyBuYW1lIGZ1bmN0aW9uIG9mIHRoZSBjb21wb25lbnQKICAgIGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnROYW1lIHx8IGNvbXBvbmVudC5uYW1lICYmIGNvbXBvbmVudC5uYW1lKCk7CgogICAgaWYgKGNvbXBvbmVudE5hbWUpIHsKICAgICAgdGhpcy5jaGlsZE5hbWVJbmRleF9bY29tcG9uZW50TmFtZV0gPSBjb21wb25lbnQ7CiAgICB9CgogICAgLy8gQWRkIHRoZSBVSSBvYmplY3QncyBlbGVtZW50IHRvIHRoZSBjb250YWluZXIgZGl2IChib3gpCiAgICAvLyBIYXZpbmcgYW4gZWxlbWVudCBpcyBub3QgcmVxdWlyZWQKICAgIGlmICh0eXBlb2YgY29tcG9uZW50LmVsID09PSAnZnVuY3Rpb24nICYmIGNvbXBvbmVudC5lbCgpKSB7CiAgICAgIHRoaXMuY29udGVudEVsKCkuYXBwZW5kQ2hpbGQoY29tcG9uZW50LmVsKCkpOwogICAgfQoKICAgIC8vIFJldHVybiBzbyBpdCBjYW4gc3RvcmVkIG9uIHBhcmVudCBvYmplY3QgaWYgZGVzaXJlZC4KICAgIHJldHVybiBjb21wb25lbnQ7CiAgfTsKCiAgLyoqCiAgICogUmVtb3ZlIGEgY2hpbGQgY29tcG9uZW50IGZyb20gdGhpcyBjb21wb25lbnQncyBsaXN0IG9mIGNoaWxkcmVuLCBhbmQgdGhlCiAgICogY2hpbGQgY29tcG9uZW50J3MgZWxlbWVudCBmcm9tIHRoaXMgY29tcG9uZW50J3MgZWxlbWVudAogICAqCiAgICogQHBhcmFtICB7Q29tcG9uZW50fSBjb21wb25lbnQgQ29tcG9uZW50IHRvIHJlbW92ZQogICAqIEBtZXRob2QgcmVtb3ZlQ2hpbGQKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9IGZ1bmN0aW9uIHJlbW92ZUNoaWxkKGNvbXBvbmVudCkgewogICAgaWYgKHR5cGVvZiBjb21wb25lbnQgPT09ICdzdHJpbmcnKSB7CiAgICAgIGNvbXBvbmVudCA9IHRoaXMuZ2V0Q2hpbGQoY29tcG9uZW50KTsKICAgIH0KCiAgICBpZiAoIWNvbXBvbmVudCB8fCAhdGhpcy5jaGlsZHJlbl8pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBjaGlsZEZvdW5kID0gZmFsc2U7CgogICAgZm9yICh2YXIgaSA9IHRoaXMuY2hpbGRyZW5fLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgIGlmICh0aGlzLmNoaWxkcmVuX1tpXSA9PT0gY29tcG9uZW50KSB7CiAgICAgICAgY2hpbGRGb3VuZCA9IHRydWU7CiAgICAgICAgdGhpcy5jaGlsZHJlbl8uc3BsaWNlKGksIDEpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKCFjaGlsZEZvdW5kKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmNoaWxkSW5kZXhfW2NvbXBvbmVudC5pZCgpXSA9IG51bGw7CiAgICB0aGlzLmNoaWxkTmFtZUluZGV4X1tjb21wb25lbnQubmFtZSgpXSA9IG51bGw7CgogICAgdmFyIGNvbXBFbCA9IGNvbXBvbmVudC5lbCgpOwoKICAgIGlmIChjb21wRWwgJiYgY29tcEVsLnBhcmVudE5vZGUgPT09IHRoaXMuY29udGVudEVsKCkpIHsKICAgICAgdGhpcy5jb250ZW50RWwoKS5yZW1vdmVDaGlsZChjb21wb25lbnQuZWwoKSk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQWRkIGFuZCBpbml0aWFsaXplIGRlZmF1bHQgY2hpbGQgY29tcG9uZW50cyBmcm9tIG9wdGlvbnMKICAgKiBgYGBqcwogICAqICAgICAvLyB3aGVuIGFuIGluc3RhbmNlIG9mIE15Q29tcG9uZW50IGlzIGNyZWF0ZWQsIGFsbCBjaGlsZHJlbiBpbiBvcHRpb25zCiAgICogICAgIC8vIHdpbGwgYmUgYWRkZWQgdG8gdGhlIGluc3RhbmNlIGJ5IHRoZWlyIG5hbWUgc3RyaW5ncyBhbmQgb3B0aW9ucwogICAqICAgICBNeUNvbXBvbmVudC5wcm90b3R5cGUub3B0aW9uc18gPSB7CiAgICogICAgICAgY2hpbGRyZW46IFsKICAgKiAgICAgICAgICdteUNoaWxkQ29tcG9uZW50JwogICAqICAgICAgIF0sCiAgICogICAgICAgbXlDaGlsZENvbXBvbmVudDogewogICAqICAgICAgICAgbXlDaGlsZE9wdGlvbjogdHJ1ZQogICAqICAgICAgIH0KICAgKiAgICAgfTsKICAgKgogICAqICAgICAvLyBPciB3aGVuIGNyZWF0aW5nIHRoZSBjb21wb25lbnQKICAgKiAgICAgdmFyIG15Q29tcCA9IG5ldyBNeUNvbXBvbmVudChwbGF5ZXIsIHsKICAgKiAgICAgICBjaGlsZHJlbjogWwogICAqICAgICAgICAgJ215Q2hpbGRDb21wb25lbnQnCiAgICogICAgICAgXSwKICAgKiAgICAgICBteUNoaWxkQ29tcG9uZW50OiB7CiAgICogICAgICAgICBteUNoaWxkT3B0aW9uOiB0cnVlCiAgICogICAgICAgfQogICAqICAgICB9KTsKICAgKiBgYGAKICAgKiBUaGUgY2hpbGRyZW4gb3B0aW9uIGNhbiBhbHNvIGJlIGFuIGFycmF5IG9mCiAgICogY2hpbGQgb3B0aW9ucyBvYmplY3RzICh0aGF0IGFsc28gaW5jbHVkZSBhICduYW1lJyBrZXkpLgogICAqIFRoaXMgY2FuIGJlIHVzZWQgaWYgeW91IGhhdmUgdHdvIGNoaWxkIGNvbXBvbmVudHMgb2YgdGhlCiAgICogc2FtZSB0eXBlIHRoYXQgbmVlZCBkaWZmZXJlbnQgb3B0aW9ucy4KICAgKiBgYGBqcwogICAqICAgICB2YXIgbXlDb21wID0gbmV3IE15Q29tcG9uZW50KHBsYXllciwgewogICAqICAgICAgIGNoaWxkcmVuOiBbCiAgICogICAgICAgICAnYnV0dG9uJywKICAgKiAgICAgICAgIHsKICAgKiAgICAgICAgICAgbmFtZTogJ2J1dHRvbicsCiAgICogICAgICAgICAgIHNvbWVPdGhlck9wdGlvbjogdHJ1ZQogICAqICAgICAgICAgfSwKICAgKiAgICAgICAgIHsKICAgKiAgICAgICAgICAgbmFtZTogJ2J1dHRvbicsCiAgICogICAgICAgICAgIHNvbWVPdGhlck9wdGlvbjogZmFsc2UKICAgKiAgICAgICAgIH0KICAgKiAgICAgICBdCiAgICogICAgIH0pOwogICAqIGBgYAogICAqCiAgICogQG1ldGhvZCBpbml0Q2hpbGRyZW4KICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5pbml0Q2hpbGRyZW4gPSBmdW5jdGlvbiBpbml0Q2hpbGRyZW4oKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBjaGlsZHJlbiA9IHRoaXMub3B0aW9uc18uY2hpbGRyZW47CgogICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gYHRoaXNgIGlzIGBwYXJlbnRgCiAgICAgICAgdmFyIHBhcmVudE9wdGlvbnMgPSBfdGhpcy5vcHRpb25zXzsKCiAgICAgICAgdmFyIGhhbmRsZUFkZCA9IGZ1bmN0aW9uIGhhbmRsZUFkZChjaGlsZCkgewogICAgICAgICAgdmFyIG5hbWUgPSBjaGlsZC5uYW1lOwogICAgICAgICAgdmFyIG9wdHMgPSBjaGlsZC5vcHRzOwoKICAgICAgICAgIC8vIEFsbG93IG9wdGlvbnMgZm9yIGNoaWxkcmVuIHRvIGJlIHNldCBhdCB0aGUgcGFyZW50IG9wdGlvbnMKICAgICAgICAgIC8vIGUuZy4gdmlkZW9qcyhpZCwgeyBjb250cm9sQmFyOiBmYWxzZSB9KTsKICAgICAgICAgIC8vIGluc3RlYWQgb2YgdmlkZW9qcyhpZCwgeyBjaGlsZHJlbjogeyBjb250cm9sQmFyOiBmYWxzZSB9KTsKICAgICAgICAgIGlmIChwYXJlbnRPcHRpb25zW25hbWVdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgb3B0cyA9IHBhcmVudE9wdGlvbnNbbmFtZV07CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWxsb3cgZm9yIGRpc2FibGluZyBkZWZhdWx0IGNvbXBvbmVudHMKICAgICAgICAgIC8vIGUuZy4gb3B0aW9uc1snY2hpbGRyZW4nXVsncG9zdGVySW1hZ2UnXSA9IGZhbHNlCiAgICAgICAgICBpZiAob3B0cyA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEFsbG93IG9wdGlvbnMgdG8gYmUgcGFzc2VkIGFzIGEgc2ltcGxlIGJvb2xlYW4gaWYgbm8gY29uZmlndXJhdGlvbgogICAgICAgICAgLy8gaXMgbmVjZXNzYXJ5LgogICAgICAgICAgaWYgKG9wdHMgPT09IHRydWUpIHsKICAgICAgICAgICAgb3B0cyA9IHt9OwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFdlIGFsc28gd2FudCB0byBwYXNzIHRoZSBvcmlnaW5hbCBwbGF5ZXIgb3B0aW9ucyB0byBlYWNoIGNvbXBvbmVudCBhcyB3ZWxsIHNvIHRoZXkgZG9uJ3QgbmVlZCB0bwogICAgICAgICAgLy8gcmVhY2ggYmFjayBpbnRvIHRoZSBwbGF5ZXIgZm9yIG9wdGlvbnMgbGF0ZXIuCiAgICAgICAgICBvcHRzLnBsYXllck9wdGlvbnMgPSBfdGhpcy5vcHRpb25zXy5wbGF5ZXJPcHRpb25zOwoKICAgICAgICAgIC8vIENyZWF0ZSBhbmQgYWRkIHRoZSBjaGlsZCBjb21wb25lbnQuCiAgICAgICAgICAvLyBBZGQgYSBkaXJlY3QgcmVmZXJlbmNlIHRvIHRoZSBjaGlsZCBieSBuYW1lIG9uIHRoZSBwYXJlbnQgaW5zdGFuY2UuCiAgICAgICAgICAvLyBJZiB0d28gb2YgdGhlIHNhbWUgY29tcG9uZW50IGFyZSB1c2VkLCBkaWZmZXJlbnQgbmFtZXMgc2hvdWxkIGJlIHN1cHBsaWVkCiAgICAgICAgICAvLyBmb3IgZWFjaAogICAgICAgICAgdmFyIG5ld0NoaWxkID0gX3RoaXMuYWRkQ2hpbGQobmFtZSwgb3B0cyk7CiAgICAgICAgICBpZiAobmV3Q2hpbGQpIHsKICAgICAgICAgICAgX3RoaXNbbmFtZV0gPSBuZXdDaGlsZDsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICAvLyBBbGxvdyBmb3IgYW4gYXJyYXkgb2YgY2hpbGRyZW4gZGV0YWlscyB0byBwYXNzZWQgaW4gdGhlIG9wdGlvbnMKICAgICAgICB2YXIgd29ya2luZ0NoaWxkcmVuID0gdW5kZWZpbmVkOwogICAgICAgIHZhciBUZWNoID0gQ29tcG9uZW50LmdldENvbXBvbmVudCgnVGVjaCcpOwoKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjaGlsZHJlbikpIHsKICAgICAgICAgIHdvcmtpbmdDaGlsZHJlbiA9IGNoaWxkcmVuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3b3JraW5nQ2hpbGRyZW4gPSBPYmplY3Qua2V5cyhjaGlsZHJlbik7CiAgICAgICAgfQoKICAgICAgICB3b3JraW5nQ2hpbGRyZW4KICAgICAgICAvLyBjaGlsZHJlbiB0aGF0IGFyZSBpbiB0aGlzLm9wdGlvbnNfIGJ1dCBhbHNvIGluIHdvcmtpbmdDaGlsZHJlbiAgd291bGQKICAgICAgICAvLyBnaXZlIHVzIGV4dHJhIGNoaWxkcmVuIHdlIGRvIG5vdCB3YW50LiBTbywgd2Ugd2FudCB0byBmaWx0ZXIgdGhlbSBvdXQuCiAgICAgICAgLmNvbmNhdChPYmplY3Qua2V5cyhfdGhpcy5vcHRpb25zXykuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgcmV0dXJuICF3b3JraW5nQ2hpbGRyZW4uc29tZShmdW5jdGlvbiAod2NoaWxkKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2NoaWxkID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgIHJldHVybiBjaGlsZCA9PT0gd2NoaWxkOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybiBjaGlsZCA9PT0gd2NoaWxkLm5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pKS5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICB2YXIgbmFtZSA9IHVuZGVmaW5lZCwKICAgICAgICAgICAgICBvcHRzID0gdW5kZWZpbmVkOwoKICAgICAgICAgIGlmICh0eXBlb2YgY2hpbGQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIG5hbWUgPSBjaGlsZDsKICAgICAgICAgICAgb3B0cyA9IGNoaWxkcmVuW25hbWVdIHx8IF90aGlzLm9wdGlvbnNfW25hbWVdIHx8IHt9OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmFtZSA9IGNoaWxkLm5hbWU7CiAgICAgICAgICAgIG9wdHMgPSBjaGlsZDsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4geyBuYW1lOiBuYW1lLCBvcHRzOiBvcHRzIH07CiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgLy8gd2UgaGF2ZSB0byBtYWtlIHN1cmUgdGhhdCBjaGlsZC5uYW1lIGlzbid0IGluIHRoZSB0ZWNoT3JkZXIgc2luY2UKICAgICAgICAgIC8vIHRlY2hzIGFyZSByZWdpc3RlcmQgYXMgQ29tcG9uZW50cyBidXQgY2FuJ3QgYXJlbid0IGNvbXBhdGlibGUKICAgICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdmlkZW9qcy92aWRlby5qcy9pc3N1ZXMvMjc3MgogICAgICAgICAgdmFyIGMgPSBDb21wb25lbnQuZ2V0Q29tcG9uZW50KGNoaWxkLm9wdHMuY29tcG9uZW50Q2xhc3MgfHwgX3V0aWxzVG9UaXRsZUNhc2VKczJbJ2RlZmF1bHQnXShjaGlsZC5uYW1lKSk7CiAgICAgICAgICByZXR1cm4gYyAmJiAhVGVjaC5pc1RlY2goYyk7CiAgICAgICAgfSkuZm9yRWFjaChoYW5kbGVBZGQpOwogICAgICB9KSgpOwogICAgfQogIH07CgogIC8qKgogICAqIEFsbG93cyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIC8vIENoaWxkIGNsYXNzZXMgY2FuIGluY2x1ZGUgYSBmdW5jdGlvbiB0aGF0IGRvZXM6CiAgICAvLyByZXR1cm4gJ0NMQVNTIE5BTUUnICsgdGhpcy5fc3VwZXIoKTsKICAgIHJldHVybiAnJzsKICB9OwoKICAvKioKICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhpcyBjb21wb25lbnQncyBlbGVtZW50CiAgICogYGBganMKICAgKiAgICAgdmFyIG15RnVuYyA9IGZ1bmN0aW9uKCl7CiAgICogICAgICAgdmFyIG15Q29tcG9uZW50ID0gdGhpczsKICAgKiAgICAgICAvLyBEbyBzb21ldGhpbmcgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWQKICAgKiAgICAgfTsKICAgKgogICAqICAgICBteUNvbXBvbmVudC5vbignZXZlbnRUeXBlJywgbXlGdW5jKTsKICAgKiBgYGAKICAgKiBUaGUgY29udGV4dCBvZiBteUZ1bmMgd2lsbCBiZSBteUNvbXBvbmVudCB1bmxlc3MgcHJldmlvdXNseSBib3VuZC4KICAgKiBBbHRlcm5hdGl2ZWx5LCB5b3UgY2FuIGFkZCBhIGxpc3RlbmVyIHRvIGFub3RoZXIgZWxlbWVudCBvciBjb21wb25lbnQuCiAgICogYGBganMKICAgKiAgICAgbXlDb21wb25lbnQub24ob3RoZXJFbGVtZW50LCAnZXZlbnROYW1lJywgbXlGdW5jKTsKICAgKiAgICAgbXlDb21wb25lbnQub24ob3RoZXJDb21wb25lbnQsICdldmVudE5hbWUnLCBteUZ1bmMpOwogICAqIGBgYAogICAqIFRoZSBiZW5lZml0IG9mIHVzaW5nIHRoaXMgb3ZlciBgVmpzRXZlbnRzLm9uKG90aGVyRWxlbWVudCwgJ2V2ZW50TmFtZScsIG15RnVuYylgCiAgICogYW5kIGBvdGhlckNvbXBvbmVudC5vbignZXZlbnROYW1lJywgbXlGdW5jKWAgaXMgdGhhdCB0aGlzIHdheSB0aGUgbGlzdGVuZXJzCiAgICogd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGNsZWFuZWQgdXAgd2hlbiBlaXRoZXIgY29tcG9uZW50IGlzIGRpc3Bvc2VkLgogICAqIEl0IHdpbGwgYWxzbyBiaW5kIG15Q29tcG9uZW50IGFzIHRoZSBjb250ZXh0IG9mIG15RnVuYy4KICAgKiAqKk5PVEUqKjogV2hlbiB1c2luZyB0aGlzIG9uIGVsZW1lbnRzIGluIHRoZSBwYWdlIG90aGVyIHRoYW4gd2luZG93CiAgICogYW5kIGRvY3VtZW50IChib3RoIHBlcm1hbmVudCksIGlmIHlvdSByZW1vdmUgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NCiAgICogeW91IG5lZWQgdG8gY2FsbCBgbXlDb21wb25lbnQudHJpZ2dlcihlbCwgJ2Rpc3Bvc2UnKWAgb24gaXQgdG8gY2xlYW4gdXAKICAgKiByZWZlcmVuY2VzIHRvIGl0IGFuZCBhbGxvdyB0aGUgYnJvd3NlciB0byBnYXJiYWdlIGNvbGxlY3QgaXQuCiAgICoKICAgKiBAcGFyYW0gIHtTdHJpbmd8Q29tcG9uZW50fSBmaXJzdCAgIFRoZSBldmVudCB0eXBlIG9yIG90aGVyIGNvbXBvbmVudAogICAqIEBwYXJhbSAge0Z1bmN0aW9ufFN0cmluZ30gICAgICBzZWNvbmQgIFRoZSBldmVudCBoYW5kbGVyIG9yIGV2ZW50IHR5cGUKICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gICAgICAgICAgICAgdGhpcmQgICBUaGUgZXZlbnQgaGFuZGxlcgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAbWV0aG9kIG9uCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUub24gPSBmdW5jdGlvbiBvbihmaXJzdCwgc2Vjb25kLCB0aGlyZCkgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgaWYgKHR5cGVvZiBmaXJzdCA9PT0gJ3N0cmluZycgfHwgQXJyYXkuaXNBcnJheShmaXJzdCkpIHsKICAgICAgRXZlbnRzLm9uKHRoaXMuZWxfLCBmaXJzdCwgRm4uYmluZCh0aGlzLCBzZWNvbmQpKTsKCiAgICAgIC8vIFRhcmdldGluZyBhbm90aGVyIGNvbXBvbmVudCBvciBlbGVtZW50CiAgICB9IGVsc2UgewogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdGFyZ2V0ID0gZmlyc3Q7CiAgICAgICAgICB2YXIgdHlwZSA9IHNlY29uZDsKICAgICAgICAgIHZhciBmbiA9IEZuLmJpbmQoX3RoaXMyLCB0aGlyZCk7CgogICAgICAgICAgLy8gV2hlbiB0aGlzIGNvbXBvbmVudCBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSBsaXN0ZW5lciBmcm9tIHRoZSBvdGhlciBjb21wb25lbnQKICAgICAgICAgIHZhciByZW1vdmVPbkRpc3Bvc2UgPSBmdW5jdGlvbiByZW1vdmVPbkRpc3Bvc2UoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczIub2ZmKHRhcmdldCwgdHlwZSwgZm4pOwogICAgICAgICAgfTsKCiAgICAgICAgICAvLyBVc2UgdGhlIHNhbWUgZnVuY3Rpb24gSUQgc28gd2UgY2FuIHJlbW92ZSBpdCBsYXRlciBpdCB1c2luZyB0aGUgSUQKICAgICAgICAgIC8vIG9mIHRoZSBvcmlnaW5hbCBsaXN0ZW5lcgogICAgICAgICAgcmVtb3ZlT25EaXNwb3NlLmd1aWQgPSBmbi5ndWlkOwogICAgICAgICAgX3RoaXMyLm9uKCdkaXNwb3NlJywgcmVtb3ZlT25EaXNwb3NlKTsKCiAgICAgICAgICAvLyBJZiB0aGUgb3RoZXIgY29tcG9uZW50IGlzIGRpc3Bvc2VkIGZpcnN0IHdlIG5lZWQgdG8gY2xlYW4gdGhlIHJlZmVyZW5jZQogICAgICAgICAgLy8gdG8gdGhlIG90aGVyIGNvbXBvbmVudCBpbiB0aGlzIGNvbXBvbmVudCdzIHJlbW92ZU9uRGlzcG9zZSBsaXN0ZW5lcgogICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIGNyZWF0ZSBhIG1lbW9yeSBsZWFrLgogICAgICAgICAgdmFyIGNsZWFuUmVtb3ZlciA9IGZ1bmN0aW9uIGNsZWFuUmVtb3ZlcigpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5vZmYoJ2Rpc3Bvc2UnLCByZW1vdmVPbkRpc3Bvc2UpOwogICAgICAgICAgfTsKCiAgICAgICAgICAvLyBBZGQgdGhlIHNhbWUgZnVuY3Rpb24gSUQgc28gd2UgY2FuIGVhc2lseSByZW1vdmUgaXQgbGF0ZXIKICAgICAgICAgIGNsZWFuUmVtb3Zlci5ndWlkID0gZm4uZ3VpZDsKCiAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgRE9NIG5vZGUKICAgICAgICAgIGlmIChmaXJzdC5ub2RlTmFtZSkgewogICAgICAgICAgICAvLyBBZGQgdGhlIGxpc3RlbmVyIHRvIHRoZSBvdGhlciBlbGVtZW50CiAgICAgICAgICAgIEV2ZW50cy5vbih0YXJnZXQsIHR5cGUsIGZuKTsKICAgICAgICAgICAgRXZlbnRzLm9uKHRhcmdldCwgJ2Rpc3Bvc2UnLCBjbGVhblJlbW92ZXIpOwoKICAgICAgICAgICAgLy8gU2hvdWxkIGJlIGEgY29tcG9uZW50CiAgICAgICAgICAgIC8vIE5vdCB1c2luZyBgaW5zdGFuY2VvZiBDb21wb25lbnRgIGJlY2F1c2UgaXQgbWFrZXMgbW9jayBwbGF5ZXJzIGRpZmZpY3VsdAogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZmlyc3Qub24gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAvLyBBZGQgdGhlIGxpc3RlbmVyIHRvIHRoZSBvdGhlciBjb21wb25lbnQKICAgICAgICAgICAgICB0YXJnZXQub24odHlwZSwgZm4pOwogICAgICAgICAgICAgIHRhcmdldC5vbignZGlzcG9zZScsIGNsZWFuUmVtb3Zlcik7CiAgICAgICAgICAgIH0KICAgICAgICB9KSgpOwogICAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogUmVtb3ZlIGFuIGV2ZW50IGxpc3RlbmVyIGZyb20gdGhpcyBjb21wb25lbnQncyBlbGVtZW50CiAgICogYGBganMKICAgKiAgICAgbXlDb21wb25lbnQub2ZmKCdldmVudFR5cGUnLCBteUZ1bmMpOwogICAqIGBgYAogICAqIElmIG15RnVuYyBpcyBleGNsdWRlZCwgQUxMIGxpc3RlbmVycyBmb3IgdGhlIGV2ZW50IHR5cGUgd2lsbCBiZSByZW1vdmVkLgogICAqIElmIGV2ZW50VHlwZSBpcyBleGNsdWRlZCwgQUxMIGxpc3RlbmVycyB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgY29tcG9uZW50LgogICAqIEFsdGVybmF0aXZlbHkgeW91IGNhbiB1c2UgYG9mZmAgdG8gcmVtb3ZlIGxpc3RlbmVycyB0aGF0IHdlcmUgYWRkZWQgdG8gb3RoZXIKICAgKiBlbGVtZW50cyBvciBjb21wb25lbnRzIHVzaW5nIGBteUNvbXBvbmVudC5vbihvdGhlckNvbXBvbmVudC4uLmAuCiAgICogSW4gdGhpcyBjYXNlIGJvdGggdGhlIGV2ZW50IHR5cGUgYW5kIGxpc3RlbmVyIGZ1bmN0aW9uIGFyZSBSRVFVSVJFRC4KICAgKiBgYGBqcwogICAqICAgICBteUNvbXBvbmVudC5vZmYob3RoZXJFbGVtZW50LCAnZXZlbnRUeXBlJywgbXlGdW5jKTsKICAgKiAgICAgbXlDb21wb25lbnQub2ZmKG90aGVyQ29tcG9uZW50LCAnZXZlbnRUeXBlJywgbXlGdW5jKTsKICAgKiBgYGAKICAgKgogICAqIEBwYXJhbSAge1N0cmluZz18Q29tcG9uZW50fSAgZmlyc3QgIFRoZSBldmVudCB0eXBlIG9yIG90aGVyIGNvbXBvbmVudAogICAqIEBwYXJhbSAge0Z1bmN0aW9uPXxTdHJpbmd9ICAgICAgIHNlY29uZCBUaGUgbGlzdGVuZXIgZnVuY3Rpb24gb3IgZXZlbnQgdHlwZQogICAqIEBwYXJhbSAge0Z1bmN0aW9uPX0gICAgICAgICAgICAgIHRoaXJkICBUaGUgbGlzdGVuZXIgZm9yIG90aGVyIGNvbXBvbmVudAogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAbWV0aG9kIG9mZgogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIG9mZihmaXJzdCwgc2Vjb25kLCB0aGlyZCkgewogICAgaWYgKCFmaXJzdCB8fCB0eXBlb2YgZmlyc3QgPT09ICdzdHJpbmcnIHx8IEFycmF5LmlzQXJyYXkoZmlyc3QpKSB7CiAgICAgIEV2ZW50cy5vZmYodGhpcy5lbF8sIGZpcnN0LCBzZWNvbmQpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHRhcmdldCA9IGZpcnN0OwogICAgICB2YXIgdHlwZSA9IHNlY29uZDsKICAgICAgLy8gRW5zdXJlIHRoZXJlJ3MgYXQgbGVhc3QgYSBndWlkLCBldmVuIGlmIHRoZSBmdW5jdGlvbiBoYXNuJ3QgYmVlbiB1c2VkCiAgICAgIHZhciBmbiA9IEZuLmJpbmQodGhpcywgdGhpcmQpOwoKICAgICAgLy8gUmVtb3ZlIHRoZSBkaXNwb3NlIGxpc3RlbmVyIG9uIHRoaXMgY29tcG9uZW50LAogICAgICAvLyB3aGljaCB3YXMgZ2l2ZW4gdGhlIHNhbWUgZ3VpZCBhcyB0aGUgZXZlbnQgbGlzdGVuZXIKICAgICAgdGhpcy5vZmYoJ2Rpc3Bvc2UnLCBmbik7CgogICAgICBpZiAoZmlyc3Qubm9kZU5hbWUpIHsKICAgICAgICAvLyBSZW1vdmUgdGhlIGxpc3RlbmVyCiAgICAgICAgRXZlbnRzLm9mZih0YXJnZXQsIHR5cGUsIGZuKTsKICAgICAgICAvLyBSZW1vdmUgdGhlIGxpc3RlbmVyIGZvciBjbGVhbmluZyB0aGUgZGlzcG9zZSBsaXN0ZW5lcgogICAgICAgIEV2ZW50cy5vZmYodGFyZ2V0LCAnZGlzcG9zZScsIGZuKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXQub2ZmKHR5cGUsIGZuKTsKICAgICAgICB0YXJnZXQub2ZmKCdkaXNwb3NlJywgZm4pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyIHRvIGJlIHRyaWdnZXJlZCBvbmx5IG9uY2UgYW5kIHRoZW4gcmVtb3ZlZAogICAqIGBgYGpzCiAgICogICAgIG15Q29tcG9uZW50Lm9uZSgnZXZlbnROYW1lJywgbXlGdW5jKTsKICAgKiBgYGAKICAgKiBBbHRlcm5hdGl2ZWx5IHlvdSBjYW4gYWRkIGEgbGlzdGVuZXIgdG8gYW5vdGhlciBlbGVtZW50IG9yIGNvbXBvbmVudAogICAqIHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgb25seSBvbmNlLgogICAqIGBgYGpzCiAgICogICAgIG15Q29tcG9uZW50Lm9uZShvdGhlckVsZW1lbnQsICdldmVudE5hbWUnLCBteUZ1bmMpOwogICAqICAgICBteUNvbXBvbmVudC5vbmUob3RoZXJDb21wb25lbnQsICdldmVudE5hbWUnLCBteUZ1bmMpOwogICAqIGBgYAogICAqCiAgICogQHBhcmFtICB7U3RyaW5nfENvbXBvbmVudH0gIGZpcnN0ICAgVGhlIGV2ZW50IHR5cGUgb3Igb3RoZXIgY29tcG9uZW50CiAgICogQHBhcmFtICB7RnVuY3Rpb258U3RyaW5nfSAgICAgICBzZWNvbmQgIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiBvciBldmVudCB0eXBlCiAgICogQHBhcmFtICB7RnVuY3Rpb249fSAgICAgICAgICAgICB0aGlyZCAgIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiBmb3Igb3RoZXIgY29tcG9uZW50CiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2Qgb25lCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUub25lID0gZnVuY3Rpb24gb25lKGZpcnN0LCBzZWNvbmQsIHRoaXJkKSB7CiAgICB2YXIgX3RoaXMzID0gdGhpcywKICAgICAgICBfYXJndW1lbnRzID0gYXJndW1lbnRzOwoKICAgIGlmICh0eXBlb2YgZmlyc3QgPT09ICdzdHJpbmcnIHx8IEFycmF5LmlzQXJyYXkoZmlyc3QpKSB7CiAgICAgIEV2ZW50cy5vbmUodGhpcy5lbF8sIGZpcnN0LCBGbi5iaW5kKHRoaXMsIHNlY29uZCkpOwogICAgfSBlbHNlIHsKICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gZmlyc3Q7CiAgICAgICAgdmFyIHR5cGUgPSBzZWNvbmQ7CiAgICAgICAgdmFyIGZuID0gRm4uYmluZChfdGhpczMsIHRoaXJkKTsKCiAgICAgICAgdmFyIG5ld0Z1bmMgPSBmdW5jdGlvbiBuZXdGdW5jKCkgewogICAgICAgICAgX3RoaXMzLm9mZih0YXJnZXQsIHR5cGUsIG5ld0Z1bmMpOwogICAgICAgICAgZm4uYXBwbHkobnVsbCwgX2FyZ3VtZW50cyk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gS2VlcCB0aGUgc2FtZSBmdW5jdGlvbiBJRCBzbyB3ZSBjYW4gcmVtb3ZlIGl0IGxhdGVyCiAgICAgICAgbmV3RnVuYy5ndWlkID0gZm4uZ3VpZDsKCiAgICAgICAgX3RoaXMzLm9uKHRhcmdldCwgdHlwZSwgbmV3RnVuYyk7CiAgICAgIH0pKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogVHJpZ2dlciBhbiBldmVudCBvbiBhbiBlbGVtZW50CiAgICogYGBganMKICAgKiAgICAgbXlDb21wb25lbnQudHJpZ2dlcignZXZlbnROYW1lJyk7CiAgICogICAgIG15Q29tcG9uZW50LnRyaWdnZXIoeyd0eXBlJzonZXZlbnROYW1lJ30pOwogICAqICAgICBteUNvbXBvbmVudC50cmlnZ2VyKCdldmVudE5hbWUnLCB7ZGF0YTogJ3NvbWUgZGF0YSd9KTsKICAgKiAgICAgbXlDb21wb25lbnQudHJpZ2dlcih7J3R5cGUnOidldmVudE5hbWUnfSwge2RhdGE6ICdzb21lIGRhdGEnfSk7CiAgICogYGBgCiAgICoKICAgKiBAcGFyYW0gIHtFdmVudHxPYmplY3R8U3RyaW5nfSBldmVudCAgQSBzdHJpbmcgKHRoZSB0eXBlKSBvciBhbiBldmVudCBvYmplY3Qgd2l0aCBhIHR5cGUgYXR0cmlidXRlCiAgICogQHBhcmFtICB7T2JqZWN0fSBbaGFzaF0gZGF0YSBoYXNoIHRvIHBhc3MgYWxvbmcgd2l0aCB0aGUgZXZlbnQKICAgKiBAcmV0dXJuIHtDb21wb25lbnR9ICAgICAgIHNlbGYKICAgKiBAbWV0aG9kIHRyaWdnZXIKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gdHJpZ2dlcihldmVudCwgaGFzaCkgewogICAgRXZlbnRzLnRyaWdnZXIodGhpcy5lbF8sIGV2ZW50LCBoYXNoKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIEJpbmQgYSBsaXN0ZW5lciB0byB0aGUgY29tcG9uZW50J3MgcmVhZHkgc3RhdGUuCiAgICogRGlmZmVyZW50IGZyb20gZXZlbnQgbGlzdGVuZXJzIGluIHRoYXQgaWYgdGhlIHJlYWR5IGV2ZW50IGhhcyBhbHJlYWR5IGhhcHBlbmVkCiAgICogaXQgd2lsbCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBpbW1lZGlhdGVseS4KICAgKgogICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiBSZWFkeSBsaXN0ZW5lcgogICAqIEBwYXJhbSAge0Jvb2xlYW59IHN5bmMgRXhlYyB0aGUgbGlzdGVuZXIgc3luY2hyb25vdXNseSBpZiBjb21wb25lbnQgaXMgcmVhZHkKICAgKiBAcmV0dXJuIHtDb21wb25lbnR9CiAgICogQG1ldGhvZCByZWFkeQogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnJlYWR5ID0gZnVuY3Rpb24gcmVhZHkoZm4pIHsKICAgIHZhciBzeW5jID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbMV07CgogICAgaWYgKGZuKSB7CiAgICAgIGlmICh0aGlzLmlzUmVhZHlfKSB7CiAgICAgICAgaWYgKHN5bmMpIHsKICAgICAgICAgIGZuLmNhbGwodGhpcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIENhbGwgdGhlIGZ1bmN0aW9uIGFzeW5jaHJvbm91c2x5IGJ5IGRlZmF1bHQgZm9yIGNvbnNpc3RlbmN5CiAgICAgICAgICB0aGlzLnNldFRpbWVvdXQoZm4sIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlYWR5UXVldWVfID0gdGhpcy5yZWFkeVF1ZXVlXyB8fCBbXTsKICAgICAgICB0aGlzLnJlYWR5UXVldWVfLnB1c2goZm4pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBUcmlnZ2VyIHRoZSByZWFkeSBsaXN0ZW5lcnMKICAgKgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAbWV0aG9kIHRyaWdnZXJSZWFkeQogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnRyaWdnZXJSZWFkeSA9IGZ1bmN0aW9uIHRyaWdnZXJSZWFkeSgpIHsKICAgIHRoaXMuaXNSZWFkeV8gPSB0cnVlOwoKICAgIC8vIEVuc3VyZSByZWFkeSBpcyB0cmlnZ2VyZCBhc3luY2hyb25vdXNseQogICAgdGhpcy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJlYWR5UXVldWUgPSB0aGlzLnJlYWR5UXVldWVfOwoKICAgICAgLy8gUmVzZXQgUmVhZHkgUXVldWUKICAgICAgdGhpcy5yZWFkeVF1ZXVlXyA9IFtdOwoKICAgICAgaWYgKHJlYWR5UXVldWUgJiYgcmVhZHlRdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgcmVhZHlRdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uIChmbikgewogICAgICAgICAgZm4uY2FsbCh0aGlzKTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfQoKICAgICAgLy8gQWxsb3cgZm9yIHVzaW5nIGV2ZW50IGxpc3RlbmVycyBhbHNvCiAgICAgIHRoaXMudHJpZ2dlcigncmVhZHknKTsKICAgIH0sIDEpOwogIH07CgogIC8qKgogICAqIEZpbmRzIGEgc2luZ2xlIERPTSBlbGVtZW50IG1hdGNoaW5nIGBzZWxlY3RvcmAgd2l0aGluIHRoZSBjb21wb25lbnQncwogICAqIGBjb250ZW50RWxgIG9yIGFub3RoZXIgY3VzdG9tIGNvbnRleHQuCiAgICoKICAgKiBAbWV0aG9kICQKICAgKiBAcGFyYW0gIHtTdHJpbmd9IHNlbGVjdG9yCiAgICogICAgICAgICBBIHZhbGlkIENTUyBzZWxlY3Rvciwgd2hpY2ggd2lsbCBiZSBwYXNzZWQgdG8gYHF1ZXJ5U2VsZWN0b3JgLgogICAqCiAgICogQHBhcmFtICB7RWxlbWVudHxTdHJpbmd9IFtjb250ZXh0PWRvY3VtZW50XQogICAqICAgICAgICAgQSBET00gZWxlbWVudCB3aXRoaW4gd2hpY2ggdG8gcXVlcnkuIENhbiBhbHNvIGJlIGEgc2VsZWN0b3IKICAgKiAgICAgICAgIHN0cmluZyBpbiB3aGljaCBjYXNlIHRoZSBmaXJzdCBtYXRjaGluZyBlbGVtZW50IHdpbGwgYmUgdXNlZAogICAqICAgICAgICAgYXMgY29udGV4dC4gSWYgbWlzc2luZyAob3Igbm8gZWxlbWVudCBtYXRjaGVzIHNlbGVjdG9yKSwgZmFsbHMKICAgKiAgICAgICAgIGJhY2sgdG8gYGRvY3VtZW50YC4KICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR8bnVsbH0KICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS4kID0gZnVuY3Rpb24gJChzZWxlY3RvciwgY29udGV4dCkgewogICAgcmV0dXJuIERvbS4kKHNlbGVjdG9yLCBjb250ZXh0IHx8IHRoaXMuY29udGVudEVsKCkpOwogIH07CgogIC8qKgogICAqIEZpbmRzIGEgYWxsIERPTSBlbGVtZW50cyBtYXRjaGluZyBgc2VsZWN0b3JgIHdpdGhpbiB0aGUgY29tcG9uZW50J3MKICAgKiBgY29udGVudEVsYCBvciBhbm90aGVyIGN1c3RvbSBjb250ZXh0LgogICAqCiAgICogQG1ldGhvZCAkJAogICAqIEBwYXJhbSAge1N0cmluZ30gc2VsZWN0b3IKICAgKiAgICAgICAgIEEgdmFsaWQgQ1NTIHNlbGVjdG9yLCB3aGljaCB3aWxsIGJlIHBhc3NlZCB0byBgcXVlcnlTZWxlY3RvckFsbGAuCiAgICoKICAgKiBAcGFyYW0gIHtFbGVtZW50fFN0cmluZ30gW2NvbnRleHQ9ZG9jdW1lbnRdCiAgICogICAgICAgICBBIERPTSBlbGVtZW50IHdpdGhpbiB3aGljaCB0byBxdWVyeS4gQ2FuIGFsc28gYmUgYSBzZWxlY3RvcgogICAqICAgICAgICAgc3RyaW5nIGluIHdoaWNoIGNhc2UgdGhlIGZpcnN0IG1hdGNoaW5nIGVsZW1lbnQgd2lsbCBiZSB1c2VkCiAgICogICAgICAgICBhcyBjb250ZXh0LiBJZiBtaXNzaW5nIChvciBubyBlbGVtZW50IG1hdGNoZXMgc2VsZWN0b3IpLCBmYWxscwogICAqICAgICAgICAgYmFjayB0byBgZG9jdW1lbnRgLgogICAqCiAgICogQHJldHVybiB7Tm9kZUxpc3R9CiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuJCQgPSBmdW5jdGlvbiAkJChzZWxlY3RvciwgY29udGV4dCkgewogICAgcmV0dXJuIERvbS4kJChzZWxlY3RvciwgY29udGV4dCB8fCB0aGlzLmNvbnRlbnRFbCgpKTsKICB9OwoKICAvKioKICAgKiBDaGVjayBpZiBhIGNvbXBvbmVudCdzIGVsZW1lbnQgaGFzIGEgQ1NTIGNsYXNzIG5hbWUKICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvQ2hlY2sgQ2xhc3NuYW1lIHRvIGNoZWNrCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2QgaGFzQ2xhc3MKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5oYXNDbGFzcyA9IGZ1bmN0aW9uIGhhc0NsYXNzKGNsYXNzVG9DaGVjaykgewogICAgcmV0dXJuIERvbS5oYXNFbENsYXNzKHRoaXMuZWxfLCBjbGFzc1RvQ2hlY2spOwogIH07CgogIC8qKgogICAqIEFkZCBhIENTUyBjbGFzcyBuYW1lIHRvIHRoZSBjb21wb25lbnQncyBlbGVtZW50CiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gY2xhc3NUb0FkZCBDbGFzc25hbWUgdG8gYWRkCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2QgYWRkQ2xhc3MKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5hZGRDbGFzcyA9IGZ1bmN0aW9uIGFkZENsYXNzKGNsYXNzVG9BZGQpIHsKICAgIERvbS5hZGRFbENsYXNzKHRoaXMuZWxfLCBjbGFzc1RvQWRkKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIFJlbW92ZSBhIENTUyBjbGFzcyBuYW1lIGZyb20gdGhlIGNvbXBvbmVudCdzIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvUmVtb3ZlIENsYXNzbmFtZSB0byByZW1vdmUKICAgKiBAcmV0dXJuIHtDb21wb25lbnR9CiAgICogQG1ldGhvZCByZW1vdmVDbGFzcwogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoY2xhc3NUb1JlbW92ZSkgewogICAgRG9tLnJlbW92ZUVsQ2xhc3ModGhpcy5lbF8sIGNsYXNzVG9SZW1vdmUpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogQWRkIG9yIHJlbW92ZSBhIENTUyBjbGFzcyBuYW1lIGZyb20gdGhlIGNvbXBvbmVudCdzIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSAge1N0cmluZ30gY2xhc3NUb1RvZ2dsZQogICAqIEBwYXJhbSAge0Jvb2xlYW58RnVuY3Rpb259IFtwcmVkaWNhdGVdCiAgICogICAgICAgICBDYW4gYmUgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBCb29sZWFuLiBJZiBgdHJ1ZWAsIHRoZSBjbGFzcwogICAqICAgICAgICAgd2lsbCBiZSBhZGRlZDsgaWYgYGZhbHNlYCwgdGhlIGNsYXNzIHdpbGwgYmUgcmVtb3ZlZC4gSWYgbm90CiAgICogICAgICAgICBnaXZlbiwgdGhlIGNsYXNzIHdpbGwgYmUgYWRkZWQgaWYgbm90IHByZXNlbnQgYW5kIHZpY2UgdmVyc2EuCiAgICoKICAgKiBAcmV0dXJuIHtDb21wb25lbnR9CiAgICogQG1ldGhvZCB0b2dnbGVDbGFzcwogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnRvZ2dsZUNsYXNzID0gZnVuY3Rpb24gdG9nZ2xlQ2xhc3MoY2xhc3NUb1RvZ2dsZSwgcHJlZGljYXRlKSB7CiAgICBEb20udG9nZ2xlRWxDbGFzcyh0aGlzLmVsXywgY2xhc3NUb1RvZ2dsZSwgcHJlZGljYXRlKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIFNob3cgdGhlIGNvbXBvbmVudCBlbGVtZW50IGlmIGhpZGRlbgogICAqCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2Qgc2hvdwogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiBzaG93KCkgewogICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWhpZGRlbicpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogSGlkZSB0aGUgY29tcG9uZW50IGVsZW1lbnQgaWYgY3VycmVudGx5IHNob3dpbmcKICAgKgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAbWV0aG9kIGhpZGUKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gaGlkZSgpIHsKICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1oaWRkZW4nKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIExvY2sgYW4gaXRlbSBpbiBpdHMgdmlzaWJsZSBzdGF0ZQogICAqIFRvIGJlIHVzZWQgd2l0aCBmYWRlSW4vZmFkZU91dC4KICAgKgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgbG9ja1Nob3dpbmcKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5sb2NrU2hvd2luZyA9IGZ1bmN0aW9uIGxvY2tTaG93aW5nKCkgewogICAgdGhpcy5hZGRDbGFzcygndmpzLWxvY2stc2hvd2luZycpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogVW5sb2NrIGFuIGl0ZW0gdG8gYmUgaGlkZGVuCiAgICogVG8gYmUgdXNlZCB3aXRoIGZhZGVJbi9mYWRlT3V0LgogICAqCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCB1bmxvY2tTaG93aW5nCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUudW5sb2NrU2hvd2luZyA9IGZ1bmN0aW9uIHVubG9ja1Nob3dpbmcoKSB7CiAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtbG9jay1zaG93aW5nJyk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBTZXQgb3IgZ2V0IHRoZSB3aWR0aCBvZiB0aGUgY29tcG9uZW50IChDU1MgdmFsdWVzKQogICAqIFNldHRpbmcgdGhlIHZpZGVvIHRhZyBkaW1lbnNpb24gdmFsdWVzIG9ubHkgd29ya3Mgd2l0aCB2YWx1ZXMgaW4gcGl4ZWxzLgogICAqIFBlcmNlbnQgdmFsdWVzIHdpbGwgbm90IHdvcmsuCiAgICogU29tZSBwZXJjZW50cyBjYW4gYmUgdXNlZCwgYnV0IHdpZHRoKCkvaGVpZ2h0KCkgd2lsbCByZXR1cm4gdGhlIG51bWJlciArICUsCiAgICogbm90IHRoZSBhY3R1YWwgY29tcHV0ZWQgd2lkdGgvaGVpZ2h0LgogICAqCiAgICogQHBhcmFtICB7TnVtYmVyfFN0cmluZz19IG51bSAgIE9wdGlvbmFsIHdpZHRoIG51bWJlcgogICAqIEBwYXJhbSAge0Jvb2xlYW59IHNraXBMaXN0ZW5lcnMgU2tpcCB0aGUgJ3Jlc2l6ZScgZXZlbnQgdHJpZ2dlcgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0gVGhpcyBjb21wb25lbnQsIHdoZW4gc2V0dGluZyB0aGUgd2lkdGgKICAgKiBAcmV0dXJuIHtOdW1iZXJ8U3RyaW5nfSBUaGUgd2lkdGgsIHdoZW4gZ2V0dGluZwogICAqIEBtZXRob2Qgd2lkdGgKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS53aWR0aCA9IGZ1bmN0aW9uIHdpZHRoKG51bSwgc2tpcExpc3RlbmVycykgewogICAgcmV0dXJuIHRoaXMuZGltZW5zaW9uKCd3aWR0aCcsIG51bSwgc2tpcExpc3RlbmVycyk7CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgaGVpZ2h0IG9mIHRoZSBjb21wb25lbnQgKENTUyB2YWx1ZXMpCiAgICogU2V0dGluZyB0aGUgdmlkZW8gdGFnIGRpbWVuc2lvbiB2YWx1ZXMgb25seSB3b3JrcyB3aXRoIHZhbHVlcyBpbiBwaXhlbHMuCiAgICogUGVyY2VudCB2YWx1ZXMgd2lsbCBub3Qgd29yay4KICAgKiBTb21lIHBlcmNlbnRzIGNhbiBiZSB1c2VkLCBidXQgd2lkdGgoKS9oZWlnaHQoKSB3aWxsIHJldHVybiB0aGUgbnVtYmVyICsgJSwKICAgKiBub3QgdGhlIGFjdHVhbCBjb21wdXRlZCB3aWR0aC9oZWlnaHQuCiAgICoKICAgKiBAcGFyYW0gIHtOdW1iZXJ8U3RyaW5nPX0gbnVtICAgICBOZXcgY29tcG9uZW50IGhlaWdodAogICAqIEBwYXJhbSAge0Jvb2xlYW49fSBza2lwTGlzdGVuZXJzIFNraXAgdGhlIHJlc2l6ZSBldmVudCB0cmlnZ2VyCiAgICogQHJldHVybiB7Q29tcG9uZW50fSBUaGlzIGNvbXBvbmVudCwgd2hlbiBzZXR0aW5nIHRoZSBoZWlnaHQKICAgKiBAcmV0dXJuIHtOdW1iZXJ8U3RyaW5nfSBUaGUgaGVpZ2h0LCB3aGVuIGdldHRpbmcKICAgKiBAbWV0aG9kIGhlaWdodAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmhlaWdodCA9IGZ1bmN0aW9uIGhlaWdodChudW0sIHNraXBMaXN0ZW5lcnMpIHsKICAgIHJldHVybiB0aGlzLmRpbWVuc2lvbignaGVpZ2h0JywgbnVtLCBza2lwTGlzdGVuZXJzKTsKICB9OwoKICAvKioKICAgKiBTZXQgYm90aCB3aWR0aCBhbmQgaGVpZ2h0IGF0IHRoZSBzYW1lIHRpbWUKICAgKgogICAqIEBwYXJhbSAge051bWJlcnxTdHJpbmd9IHdpZHRoIFdpZHRoIG9mIHBsYXllcgogICAqIEBwYXJhbSAge051bWJlcnxTdHJpbmd9IGhlaWdodCBIZWlnaHQgb2YgcGxheWVyCiAgICogQHJldHVybiB7Q29tcG9uZW50fSBUaGUgY29tcG9uZW50CiAgICogQG1ldGhvZCBkaW1lbnNpb25zCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuZGltZW5zaW9ucyA9IGZ1bmN0aW9uIGRpbWVuc2lvbnMod2lkdGgsIGhlaWdodCkgewogICAgLy8gU2tpcCByZXNpemUgbGlzdGVuZXJzIG9uIHdpZHRoIGZvciBvcHRpbWl6YXRpb24KICAgIHJldHVybiB0aGlzLndpZHRoKHdpZHRoLCB0cnVlKS5oZWlnaHQoaGVpZ2h0KTsKICB9OwoKICAvKioKICAgKiBHZXQgb3Igc2V0IHdpZHRoIG9yIGhlaWdodAogICAqIFRoaXMgaXMgdGhlIHNoYXJlZCBjb2RlIGZvciB0aGUgd2lkdGgoKSBhbmQgaGVpZ2h0KCkgbWV0aG9kcy4KICAgKiBBbGwgZm9yIGFuIGludGVnZXIsIGludGVnZXIgKyAncHgnIG9yIGludGVnZXIgKyAnJSc7CiAgICogS25vd24gaXNzdWU6IEhpZGRlbiBlbGVtZW50cyBvZmZpY2lhbGx5IGhhdmUgYSB3aWR0aCBvZiAwLiBXZSdyZSBkZWZhdWx0aW5nCiAgICogdG8gdGhlIHN0eWxlLndpZHRoIHZhbHVlIGFuZCBmYWxsaW5nIGJhY2sgdG8gY29tcHV0ZWRTdHlsZSB3aGljaCBoYXMgdGhlCiAgICogaGlkZGVuIGVsZW1lbnQgaXNzdWUuIEluZm8sIGJ1dCBwcm9iYWJseSBub3QgYW4gZWZmaWNpZW50IGZpeDoKICAgKiBodHRwOi8vd3d3LmZvbGlvdGVrLmNvbS9kZXZibG9nL2dldHRpbmctdGhlLXdpZHRoLW9mLWEtaGlkZGVuLWVsZW1lbnQtd2l0aC1qcXVlcnktdXNpbmctd2lkdGgvCiAgICoKICAgKiBAcGFyYW0gIHtTdHJpbmd9IHdpZHRoT3JIZWlnaHQgICd3aWR0aCcgb3IgJ2hlaWdodCcKICAgKiBAcGFyYW0gIHtOdW1iZXJ8U3RyaW5nPX0gbnVtICAgICBOZXcgZGltZW5zaW9uCiAgICogQHBhcmFtICB7Qm9vbGVhbj19IHNraXBMaXN0ZW5lcnMgU2tpcCByZXNpemUgZXZlbnQgdHJpZ2dlcgogICAqIEByZXR1cm4ge0NvbXBvbmVudH0gVGhlIGNvbXBvbmVudCBpZiBhIGRpbWVuc2lvbiB3YXMgc2V0CiAgICogQHJldHVybiB7TnVtYmVyfFN0cmluZ30gVGhlIGRpbWVuc2lvbiBpZiBub3RoaW5nIHdhcyBzZXQKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgZGltZW5zaW9uCiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuZGltZW5zaW9uID0gZnVuY3Rpb24gZGltZW5zaW9uKHdpZHRoT3JIZWlnaHQsIG51bSwgc2tpcExpc3RlbmVycykgewogICAgaWYgKG51bSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIC8vIFNldCB0byB6ZXJvIGlmIG51bGwgb3IgbGl0ZXJhbGx5IE5hTiAoTmFOICE9PSBOYU4pCiAgICAgIGlmIChudW0gPT09IG51bGwgfHwgbnVtICE9PSBudW0pIHsKICAgICAgICBudW0gPSAwOwogICAgICB9CgogICAgICAvLyBDaGVjayBpZiB1c2luZyBjc3Mgd2lkdGgvaGVpZ2h0ICglIG9yIHB4KSBhbmQgYWRqdXN0CiAgICAgIGlmICgoJycgKyBudW0pLmluZGV4T2YoJyUnKSAhPT0gLTEgfHwgKCcnICsgbnVtKS5pbmRleE9mKCdweCcpICE9PSAtMSkgewogICAgICAgIHRoaXMuZWxfLnN0eWxlW3dpZHRoT3JIZWlnaHRdID0gbnVtOwogICAgICB9IGVsc2UgaWYgKG51bSA9PT0gJ2F1dG8nKSB7CiAgICAgICAgdGhpcy5lbF8uc3R5bGVbd2lkdGhPckhlaWdodF0gPSAnJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmVsXy5zdHlsZVt3aWR0aE9ySGVpZ2h0XSA9IG51bSArICdweCc7CiAgICAgIH0KCiAgICAgIC8vIHNraXBMaXN0ZW5lcnMgYWxsb3dzIHVzIHRvIGF2b2lkIHRyaWdnZXJpbmcgdGhlIHJlc2l6ZSBldmVudCB3aGVuIHNldHRpbmcgYm90aCB3aWR0aCBhbmQgaGVpZ2h0CiAgICAgIGlmICghc2tpcExpc3RlbmVycykgewogICAgICAgIHRoaXMudHJpZ2dlcigncmVzaXplJyk7CiAgICAgIH0KCiAgICAgIC8vIFJldHVybiBjb21wb25lbnQKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLy8gTm90IHNldHRpbmcgYSB2YWx1ZSwgc28gZ2V0dGluZyBpdAogICAgLy8gTWFrZSBzdXJlIGVsZW1lbnQgZXhpc3RzCiAgICBpZiAoIXRoaXMuZWxfKSB7CiAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8vIEdldCBkaW1lbnNpb24gdmFsdWUgZnJvbSBzdHlsZQogICAgdmFyIHZhbCA9IHRoaXMuZWxfLnN0eWxlW3dpZHRoT3JIZWlnaHRdOwogICAgdmFyIHB4SW5kZXggPSB2YWwuaW5kZXhPZigncHgnKTsKCiAgICBpZiAocHhJbmRleCAhPT0gLTEpIHsKICAgICAgLy8gUmV0dXJuIHRoZSBwaXhlbCB2YWx1ZSB3aXRoIG5vICdweCcKICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbC5zbGljZSgwLCBweEluZGV4KSwgMTApOwogICAgfQoKICAgIC8vIE5vIHB4IHNvIHVzaW5nICUgb3Igbm8gc3R5bGUgd2FzIHNldCwgc28gZmFsbGluZyBiYWNrIHRvIG9mZnNldFdpZHRoL2hlaWdodAogICAgLy8gSWYgY29tcG9uZW50IGhhcyBkaXNwbGF5Om5vbmUsIG9mZnNldCB3aWxsIHJldHVybiAwCiAgICAvLyBUT0RPOiBoYW5kbGUgZGlzcGxheTpub25lIGFuZCBubyBkaW1lbnNpb24gc3R5bGUgdXNpbmcgcHgKICAgIHJldHVybiBwYXJzZUludCh0aGlzLmVsX1snb2Zmc2V0JyArIF91dGlsc1RvVGl0bGVDYXNlSnMyWydkZWZhdWx0J10od2lkdGhPckhlaWdodCldLCAxMCk7CiAgfTsKCiAgLyoqCiAgICogRW1pdCAndGFwJyBldmVudHMgd2hlbiB0b3VjaCBldmVudHMgYXJlIHN1cHBvcnRlZAogICAqIFRoaXMgaXMgdXNlZCB0byBzdXBwb3J0IHRvZ2dsaW5nIHRoZSBjb250cm9scyB0aHJvdWdoIGEgdGFwIG9uIHRoZSB2aWRlby4KICAgKiBXZSdyZSByZXF1aXJpbmcgdGhlbSB0byBiZSBlbmFibGVkIGJlY2F1c2Ugb3RoZXJ3aXNlIGV2ZXJ5IGNvbXBvbmVudCB3b3VsZAogICAqIGhhdmUgdGhpcyBleHRyYSBvdmVyaGVhZCB1bm5lY2Vzc2FyaWx5LCBvbiBtb2JpbGUgZGV2aWNlcyB3aGVyZSBleHRyYQogICAqIG92ZXJoZWFkIGlzIGVzcGVjaWFsbHkgYmFkLgogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGVtaXRUYXBFdmVudHMKICAgKi8KCiAgQ29tcG9uZW50LnByb3RvdHlwZS5lbWl0VGFwRXZlbnRzID0gZnVuY3Rpb24gZW1pdFRhcEV2ZW50cygpIHsKICAgIC8vIFRyYWNrIHRoZSBzdGFydCB0aW1lIHNvIHdlIGNhbiBkZXRlcm1pbmUgaG93IGxvbmcgdGhlIHRvdWNoIGxhc3RlZAogICAgdmFyIHRvdWNoU3RhcnQgPSAwOwogICAgdmFyIGZpcnN0VG91Y2ggPSBudWxsOwoKICAgIC8vIE1heGltdW0gbW92ZW1lbnQgYWxsb3dlZCBkdXJpbmcgYSB0b3VjaCBldmVudCB0byBzdGlsbCBiZSBjb25zaWRlcmVkIGEgdGFwCiAgICAvLyBPdGhlciBwb3B1bGFyIGxpYnMgdXNlIGFueXdoZXJlIGZyb20gMiAoaGFtbWVyLmpzKSB0byAxNSwgc28gMTAgc2VlbXMgbGlrZSBhIG5pY2UsIHJvdW5kIG51bWJlci4KICAgIHZhciB0YXBNb3ZlbWVudFRocmVzaG9sZCA9IDEwOwoKICAgIC8vIFRoZSBtYXhpbXVtIGxlbmd0aCBhIHRvdWNoIGNhbiBiZSB3aGlsZSBzdGlsbCBiZWluZyBjb25zaWRlcmVkIGEgdGFwCiAgICB2YXIgdG91Y2hUaW1lVGhyZXNob2xkID0gMjAwOwoKICAgIHZhciBjb3VsZEJlVGFwID0gdW5kZWZpbmVkOwoKICAgIHRoaXMub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgLy8gSWYgbW9yZSB0aGFuIG9uZSBmaW5nZXIsIGRvbid0IGNvbnNpZGVyIHRyZWF0aW5nIHRoaXMgYXMgYSBjbGljawogICAgICBpZiAoZXZlbnQudG91Y2hlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAvLyBDb3B5IHRoZSB0b3VjaGVzIG9iamVjdCB0byBwcmV2ZW50IG1vZGlmeWluZyB0aGUgb3JpZ2luYWwKICAgICAgICBmaXJzdFRvdWNoID0gX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXSh7fSwgZXZlbnQudG91Y2hlc1swXSk7CiAgICAgICAgLy8gUmVjb3JkIHN0YXJ0IHRpbWUgc28gd2UgY2FuIGRldGVjdCBhIHRhcCB2cy4gInRvdWNoIGFuZCBob2xkIgogICAgICAgIHRvdWNoU3RhcnQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAvLyBSZXNldCBjb3VsZEJlVGFwIHRyYWNraW5nCiAgICAgICAgY291bGRCZVRhcCA9IHRydWU7CiAgICAgIH0KICAgIH0pOwoKICAgIHRoaXMub24oJ3RvdWNobW92ZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAvLyBJZiBtb3JlIHRoYW4gb25lIGZpbmdlciwgZG9uJ3QgY29uc2lkZXIgdHJlYXRpbmcgdGhpcyBhcyBhIGNsaWNrCiAgICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCA+IDEpIHsKICAgICAgICBjb3VsZEJlVGFwID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAoZmlyc3RUb3VjaCkgewogICAgICAgIC8vIFNvbWUgZGV2aWNlcyB3aWxsIHRocm93IHRvdWNobW92ZXMgZm9yIGFsbCBidXQgdGhlIHNsaWdodGVzdCBvZiB0YXBzLgogICAgICAgIC8vIFNvLCBpZiB3ZSBtb3ZlZCBvbmx5IGEgc21hbGwgZGlzdGFuY2UsIHRoaXMgY291bGQgc3RpbGwgYmUgYSB0YXAKICAgICAgICB2YXIgeGRpZmYgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VYIC0gZmlyc3RUb3VjaC5wYWdlWDsKICAgICAgICB2YXIgeWRpZmYgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VZIC0gZmlyc3RUb3VjaC5wYWdlWTsKICAgICAgICB2YXIgdG91Y2hEaXN0YW5jZSA9IE1hdGguc3FydCh4ZGlmZiAqIHhkaWZmICsgeWRpZmYgKiB5ZGlmZik7CgogICAgICAgIGlmICh0b3VjaERpc3RhbmNlID4gdGFwTW92ZW1lbnRUaHJlc2hvbGQpIHsKICAgICAgICAgIGNvdWxkQmVUYXAgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIHZhciBub1RhcCA9IGZ1bmN0aW9uIG5vVGFwKCkgewogICAgICBjb3VsZEJlVGFwID0gZmFsc2U7CiAgICB9OwoKICAgIC8vIFRPRE86IExpc3RlbiB0byB0aGUgb3JpZ2luYWwgdGFyZ2V0LiBodHRwOi8veW91dHUuYmUvRHVqZnBYT0tVcDg/dD0xM204cwogICAgdGhpcy5vbigndG91Y2hsZWF2ZScsIG5vVGFwKTsKICAgIHRoaXMub24oJ3RvdWNoY2FuY2VsJywgbm9UYXApOwoKICAgIC8vIFdoZW4gdGhlIHRvdWNoIGVuZHMsIG1lYXN1cmUgaG93IGxvbmcgaXQgdG9vayBhbmQgdHJpZ2dlciB0aGUgYXBwcm9wcmlhdGUKICAgIC8vIGV2ZW50CiAgICB0aGlzLm9uKCd0b3VjaGVuZCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBmaXJzdFRvdWNoID0gbnVsbDsKICAgICAgLy8gUHJvY2VlZCBvbmx5IGlmIHRoZSB0b3VjaG1vdmUvbGVhdmUvY2FuY2VsIGV2ZW50IGRpZG4ndCBoYXBwZW4KICAgICAgaWYgKGNvdWxkQmVUYXAgPT09IHRydWUpIHsKICAgICAgICAvLyBNZWFzdXJlIGhvdyBsb25nIHRoZSB0b3VjaCBsYXN0ZWQKICAgICAgICB2YXIgdG91Y2hUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSB0b3VjaFN0YXJ0OwoKICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHRvdWNoIHdhcyBsZXNzIHRoYW4gdGhlIHRocmVzaG9sZCB0byBiZSBjb25zaWRlcmVkIGEgdGFwCiAgICAgICAgaWYgKHRvdWNoVGltZSA8IHRvdWNoVGltZVRocmVzaG9sZCkgewogICAgICAgICAgLy8gRG9uJ3QgbGV0IGJyb3dzZXIgdHVybiB0aGlzIGludG8gYSBjbGljawogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIHRoaXMudHJpZ2dlcigndGFwJyk7CiAgICAgICAgICAvLyBJdCBtYXkgYmUgZ29vZCB0byBjb3B5IHRoZSB0b3VjaGVuZCBldmVudCBvYmplY3QgYW5kIGNoYW5nZSB0aGUKICAgICAgICAgIC8vIHR5cGUgdG8gdGFwLCBpZiB0aGUgb3RoZXIgZXZlbnQgcHJvcGVydGllcyBhcmVuJ3QgZXhhY3QgYWZ0ZXIKICAgICAgICAgIC8vIEV2ZW50cy5maXhFdmVudCBydW5zIChlLmcuIGV2ZW50LnRhcmdldCkKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH07CgogIC8qKgogICAqIFJlcG9ydCB1c2VyIHRvdWNoIGFjdGl2aXR5IHdoZW4gdG91Y2ggZXZlbnRzIG9jY3VyCiAgICogVXNlciBhY3Rpdml0eSBpcyB1c2VkIHRvIGRldGVybWluZSB3aGVuIGNvbnRyb2xzIHNob3VsZCBzaG93L2hpZGUuIEl0J3MKICAgKiByZWxhdGl2ZWx5IHNpbXBsZSB3aGVuIGl0IGNvbWVzIHRvIG1vdXNlIGV2ZW50cywgYmVjYXVzZSBhbnkgbW91c2UgZXZlbnQKICAgKiBzaG91bGQgc2hvdyB0aGUgY29udHJvbHMuIFNvIHdlIGNhcHR1cmUgbW91c2UgZXZlbnRzIHRoYXQgYnViYmxlIHVwIHRvIHRoZQogICAqIHBsYXllciBhbmQgcmVwb3J0IGFjdGl2aXR5IHdoZW4gdGhhdCBoYXBwZW5zLgogICAqIFdpdGggdG91Y2ggZXZlbnRzIGl0IGlzbid0IGFzIGVhc3kuIFdlIGNhbid0IHJlbHkgb24gdG91Y2ggZXZlbnRzIGF0IHRoZQogICAqIHBsYXllciBsZXZlbCwgYmVjYXVzZSBhIHRhcCAodG91Y2hzdGFydCArIHRvdWNoZW5kKSBvbiB0aGUgdmlkZW8gaXRzZWxmIG9uCiAgICogbW9iaWxlIGRldmljZXMgaXMgbWVhbnQgdG8gdHVybiBjb250cm9scyBvZmYgKGFuZCBvbikuIFVzZXIgYWN0aXZpdHkgaXMKICAgKiBjaGVja2VkIGFzeW5jaHJvbm91c2x5LCBzbyB3aGF0IGNvdWxkIGhhcHBlbiBpcyBhIHRhcCBldmVudCBvbiB0aGUgdmlkZW8KICAgKiB0dXJucyB0aGUgY29udHJvbHMgb2ZmLCB0aGVuIHRoZSB0b3VjaGVuZCBldmVudCBidWJibGVzIHVwIHRvIHRoZSBwbGF5ZXIsCiAgICogd2hpY2ggaWYgaXQgcmVwb3J0ZWQgdXNlciBhY3Rpdml0eSwgd291bGQgdHVybiB0aGUgY29udHJvbHMgcmlnaHQgYmFjayBvbi4KICAgKiAoV2UgYWxzbyBkb24ndCB3YW50IHRvIGNvbXBsZXRlbHkgYmxvY2sgdG91Y2ggZXZlbnRzIGZyb20gYnViYmxpbmcgdXApCiAgICogQWxzbyBhIHRvdWNobW92ZSwgdG91Y2graG9sZCwgYW5kIGFueXRoaW5nIG90aGVyIHRoYW4gYSB0YXAgaXMgbm90IHN1cHBvc2VkCiAgICogdG8gdHVybiB0aGUgY29udHJvbHMgYmFjayBvbiBvbiBhIG1vYmlsZSBkZXZpY2UuCiAgICogSGVyZSB3ZSdyZSBzZXR0aW5nIHRoZSBkZWZhdWx0IGNvbXBvbmVudCBiZWhhdmlvciB0byByZXBvcnQgdXNlciBhY3Rpdml0eQogICAqIHdoZW5ldmVyIHRvdWNoIGV2ZW50cyBoYXBwZW4sIGFuZCB0aGlzIGNhbiBiZSB0dXJuZWQgb2ZmIGJ5IGNvbXBvbmVudHMgdGhhdAogICAqIHdhbnQgdG91Y2ggZXZlbnRzIHRvIGFjdCBkaWZmZXJlbnRseS4KICAgKgogICAqIEBtZXRob2QgZW5hYmxlVG91Y2hBY3Rpdml0eQogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmVuYWJsZVRvdWNoQWN0aXZpdHkgPSBmdW5jdGlvbiBlbmFibGVUb3VjaEFjdGl2aXR5KCkgewogICAgLy8gRG9uJ3QgY29udGludWUgaWYgdGhlIHJvb3QgcGxheWVyIGRvZXNuJ3Qgc3VwcG9ydCByZXBvcnRpbmcgdXNlciBhY3Rpdml0eQogICAgaWYgKCF0aGlzLnBsYXllcigpIHx8ICF0aGlzLnBsYXllcigpLnJlcG9ydFVzZXJBY3Rpdml0eSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gbGlzdGVuZXIgZm9yIHJlcG9ydGluZyB0aGF0IHRoZSB1c2VyIGlzIGFjdGl2ZQogICAgdmFyIHJlcG9ydCA9IEZuLmJpbmQodGhpcy5wbGF5ZXIoKSwgdGhpcy5wbGF5ZXIoKS5yZXBvcnRVc2VyQWN0aXZpdHkpOwoKICAgIHZhciB0b3VjaEhvbGRpbmcgPSB1bmRlZmluZWQ7CgogICAgdGhpcy5vbigndG91Y2hzdGFydCcsIGZ1bmN0aW9uICgpIHsKICAgICAgcmVwb3J0KCk7CiAgICAgIC8vIEZvciBhcyBsb25nIGFzIHRoZSB0aGV5IGFyZSB0b3VjaGluZyB0aGUgZGV2aWNlIG9yIGhhdmUgdGhlaXIgbW91c2UgZG93biwKICAgICAgLy8gd2UgY29uc2lkZXIgdGhlbSBhY3RpdmUgZXZlbiBpZiB0aGV5J3JlIG5vdCBtb3ZpbmcgdGhlaXIgZmluZ2VyIG9yIG1vdXNlLgogICAgICAvLyBTbyB3ZSB3YW50IHRvIGNvbnRpbnVlIHRvIHVwZGF0ZSB0aGF0IHRoZXkgYXJlIGFjdGl2ZQogICAgICB0aGlzLmNsZWFySW50ZXJ2YWwodG91Y2hIb2xkaW5nKTsKICAgICAgLy8gcmVwb3J0IGF0IHRoZSBzYW1lIGludGVydmFsIGFzIGFjdGl2aXR5Q2hlY2sKICAgICAgdG91Y2hIb2xkaW5nID0gdGhpcy5zZXRJbnRlcnZhbChyZXBvcnQsIDI1MCk7CiAgICB9KTsKCiAgICB2YXIgdG91Y2hFbmQgPSBmdW5jdGlvbiB0b3VjaEVuZChldmVudCkgewogICAgICByZXBvcnQoKTsKICAgICAgLy8gc3RvcCB0aGUgaW50ZXJ2YWwgdGhhdCBtYWludGFpbnMgYWN0aXZpdHkgaWYgdGhlIHRvdWNoIGlzIGhvbGRpbmcKICAgICAgdGhpcy5jbGVhckludGVydmFsKHRvdWNoSG9sZGluZyk7CiAgICB9OwoKICAgIHRoaXMub24oJ3RvdWNobW92ZScsIHJlcG9ydCk7CiAgICB0aGlzLm9uKCd0b3VjaGVuZCcsIHRvdWNoRW5kKTsKICAgIHRoaXMub24oJ3RvdWNoY2FuY2VsJywgdG91Y2hFbmQpOwogIH07CgogIC8qKgogICAqIENyZWF0ZXMgdGltZW91dCBhbmQgc2V0cyB1cCBkaXNwb3NhbCBhdXRvbWF0aWNhbGx5LgogICAqCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZnRlciB0aGUgdGltZW91dC4KICAgKiBAcGFyYW0ge051bWJlcn0gdGltZW91dCBOdW1iZXIgb2YgbXMgdG8gZGVsYXkgYmVmb3JlIGV4ZWN1dGluZyBzcGVjaWZpZWQgZnVuY3Rpb24uCiAgICogQHJldHVybiB7TnVtYmVyfSBSZXR1cm5zIHRoZSB0aW1lb3V0IElECiAgICogQG1ldGhvZCBzZXRUaW1lb3V0CiAgICovCgogIENvbXBvbmVudC5wcm90b3R5cGUuc2V0VGltZW91dCA9IGZ1bmN0aW9uIHNldFRpbWVvdXQoZm4sIHRpbWVvdXQpIHsKICAgIGZuID0gRm4uYmluZCh0aGlzLCBmbik7CgogICAgLy8gd2luZG93LnNldFRpbWVvdXQgd291bGQgYmUgcHJlZmVyYWJsZSBoZXJlLCBidXQgZHVlIHRvIHNvbWUgYml6YXJyZSBpc3N1ZSB3aXRoIFNpbm9uIGFuZC9vciBQaGFudG9tanMsIHdlIGNhbid0LgogICAgdmFyIHRpbWVvdXRJZCA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10uc2V0VGltZW91dChmbiwgdGltZW91dCk7CgogICAgdmFyIGRpc3Bvc2VGbiA9IGZ1bmN0aW9uIGRpc3Bvc2VGbigpIHsKICAgICAgdGhpcy5jbGVhclRpbWVvdXQodGltZW91dElkKTsKICAgIH07CgogICAgZGlzcG9zZUZuLmd1aWQgPSAndmpzLXRpbWVvdXQtJyArIHRpbWVvdXRJZDsKCiAgICB0aGlzLm9uKCdkaXNwb3NlJywgZGlzcG9zZUZuKTsKCiAgICByZXR1cm4gdGltZW91dElkOwogIH07CgogIC8qKgogICAqIENsZWFycyBhIHRpbWVvdXQgYW5kIHJlbW92ZXMgdGhlIGFzc29jaWF0ZWQgZGlzcG9zZSBsaXN0ZW5lcgogICAqCiAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWVvdXRJZCBUaGUgaWQgb2YgdGhlIHRpbWVvdXQgdG8gY2xlYXIKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFJldHVybnMgdGhlIHRpbWVvdXQgSUQKICAgKiBAbWV0aG9kIGNsZWFyVGltZW91dAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyVGltZW91dCA9IGZ1bmN0aW9uIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpIHsKICAgIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10uY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7CgogICAgdmFyIGRpc3Bvc2VGbiA9IGZ1bmN0aW9uIGRpc3Bvc2VGbigpIHt9OwoKICAgIGRpc3Bvc2VGbi5ndWlkID0gJ3Zqcy10aW1lb3V0LScgKyB0aW1lb3V0SWQ7CgogICAgdGhpcy5vZmYoJ2Rpc3Bvc2UnLCBkaXNwb3NlRm4pOwoKICAgIHJldHVybiB0aW1lb3V0SWQ7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlcyBhbiBpbnRlcnZhbCBhbmQgc2V0cyB1cCBkaXNwb3NhbCBhdXRvbWF0aWNhbGx5LgogICAqCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIHJ1biBldmVyeSBOIHNlY29uZHMuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGludGVydmFsIE51bWJlciBvZiBtcyB0byBkZWxheSBiZWZvcmUgZXhlY3V0aW5nIHNwZWNpZmllZCBmdW5jdGlvbi4KICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFJldHVybnMgdGhlIGludGVydmFsIElECiAgICogQG1ldGhvZCBzZXRJbnRlcnZhbAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnNldEludGVydmFsID0gZnVuY3Rpb24gc2V0SW50ZXJ2YWwoZm4sIGludGVydmFsKSB7CiAgICBmbiA9IEZuLmJpbmQodGhpcywgZm4pOwoKICAgIHZhciBpbnRlcnZhbElkID0gX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5zZXRJbnRlcnZhbChmbiwgaW50ZXJ2YWwpOwoKICAgIHZhciBkaXNwb3NlRm4gPSBmdW5jdGlvbiBkaXNwb3NlRm4oKSB7CiAgICAgIHRoaXMuY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsKICAgIH07CgogICAgZGlzcG9zZUZuLmd1aWQgPSAndmpzLWludGVydmFsLScgKyBpbnRlcnZhbElkOwoKICAgIHRoaXMub24oJ2Rpc3Bvc2UnLCBkaXNwb3NlRm4pOwoKICAgIHJldHVybiBpbnRlcnZhbElkOwogIH07CgogIC8qKgogICAqIENsZWFycyBhbiBpbnRlcnZhbCBhbmQgcmVtb3ZlcyB0aGUgYXNzb2NpYXRlZCBkaXNwb3NlIGxpc3RlbmVyCiAgICoKICAgKiBAcGFyYW0ge051bWJlcn0gaW50ZXJ2YWxJZCBUaGUgaWQgb2YgdGhlIGludGVydmFsIHRvIGNsZWFyCiAgICogQHJldHVybiB7TnVtYmVyfSBSZXR1cm5zIHRoZSBpbnRlcnZhbCBJRAogICAqIEBtZXRob2QgY2xlYXJJbnRlcnZhbAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbiBjbGVhckludGVydmFsKGludGVydmFsSWQpIHsKICAgIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10uY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsKCiAgICB2YXIgZGlzcG9zZUZuID0gZnVuY3Rpb24gZGlzcG9zZUZuKCkge307CgogICAgZGlzcG9zZUZuLmd1aWQgPSAndmpzLWludGVydmFsLScgKyBpbnRlcnZhbElkOwoKICAgIHRoaXMub2ZmKCdkaXNwb3NlJywgZGlzcG9zZUZuKTsKCiAgICByZXR1cm4gaW50ZXJ2YWxJZDsKICB9OwoKICAvKioKICAgKiBSZWdpc3RlcnMgYSBjb21wb25lbnQKICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIE5hbWUgb2YgdGhlIGNvbXBvbmVudCB0byByZWdpc3RlcgogICAqIEBwYXJhbSB7T2JqZWN0fSBjb21wIFRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXIKICAgKiBAc3RhdGljCiAgICogQG1ldGhvZCByZWdpc3RlckNvbXBvbmVudAogICAqLwoKICBDb21wb25lbnQucmVnaXN0ZXJDb21wb25lbnQgPSBmdW5jdGlvbiByZWdpc3RlckNvbXBvbmVudChuYW1lLCBjb21wKSB7CiAgICBpZiAoIUNvbXBvbmVudC5jb21wb25lbnRzXykgewogICAgICBDb21wb25lbnQuY29tcG9uZW50c18gPSB7fTsKICAgIH0KCiAgICBDb21wb25lbnQuY29tcG9uZW50c19bbmFtZV0gPSBjb21wOwogICAgcmV0dXJuIGNvbXA7CiAgfTsKCiAgLyoqCiAgICogR2V0cyBhIGNvbXBvbmVudCBieSBuYW1lCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBOYW1lIG9mIHRoZSBjb21wb25lbnQgdG8gZ2V0CiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBzdGF0aWMKICAgKiBAbWV0aG9kIGdldENvbXBvbmVudAogICAqLwoKICBDb21wb25lbnQuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gZ2V0Q29tcG9uZW50KG5hbWUpIHsKICAgIGlmIChDb21wb25lbnQuY29tcG9uZW50c18gJiYgQ29tcG9uZW50LmNvbXBvbmVudHNfW25hbWVdKSB7CiAgICAgIHJldHVybiBDb21wb25lbnQuY29tcG9uZW50c19bbmFtZV07CiAgICB9CgogICAgaWYgKF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10gJiYgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS52aWRlb2pzICYmIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10udmlkZW9qc1tuYW1lXSkgewogICAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS53YXJuKCdUaGUgJyArIG5hbWUgKyAnIGNvbXBvbmVudCB3YXMgYWRkZWQgdG8gdGhlIHZpZGVvanMgb2JqZWN0IHdoZW4gaXQgc2hvdWxkIGJlIHJlZ2lzdGVyZWQgdXNpbmcgdmlkZW9qcy5yZWdpc3RlckNvbXBvbmVudChuYW1lLCBjb21wb25lbnQpJyk7CiAgICAgIHJldHVybiBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanNbbmFtZV07CiAgICB9CiAgfTsKCiAgLyoqCiAgICogU2V0cyB1cCB0aGUgY29uc3RydWN0b3IgdXNpbmcgdGhlIHN1cHBsaWVkIGluaXQgbWV0aG9kCiAgICogb3IgdXNlcyB0aGUgaW5pdCBvZiB0aGUgcGFyZW50IG9iamVjdAogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzIEFuIG9iamVjdCBvZiBwcm9wZXJ0aWVzCiAgICogQHN0YXRpYwogICAqIEBkZXByZWNhdGVkCiAgICogQG1ldGhvZCBleHRlbmQKICAgKi8KCiAgQ29tcG9uZW50LmV4dGVuZCA9IGZ1bmN0aW9uIGV4dGVuZChwcm9wcykgewogICAgcHJvcHMgPSBwcm9wcyB8fCB7fTsKCiAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS53YXJuKCdDb21wb25lbnQuZXh0ZW5kKHt9KSBoYXMgYmVlbiBkZXByZWNhdGVkLCB1c2UgdmlkZW9qcy5leHRlbmQoQ29tcG9uZW50LCB7fSkgaW5zdGVhZCcpOwoKICAgIC8vIFNldCB1cCB0aGUgY29uc3RydWN0b3IgdXNpbmcgdGhlIHN1cHBsaWVkIGluaXQgbWV0aG9kCiAgICAvLyBvciB1c2luZyB0aGUgaW5pdCBvZiB0aGUgcGFyZW50IG9iamVjdAogICAgLy8gTWFrZSBzdXJlIHRvIGNoZWNrIHRoZSB1bm9iZnVzY2F0ZWQgdmVyc2lvbiBmb3IgZXh0ZXJuYWwgbGlicwogICAgdmFyIGluaXQgPSBwcm9wcy5pbml0IHx8IHByb3BzLmluaXQgfHwgdGhpcy5wcm90b3R5cGUuaW5pdCB8fCB0aGlzLnByb3RvdHlwZS5pbml0IHx8IGZ1bmN0aW9uICgpIHt9OwogICAgLy8gSW4gUmVzaWcncyBzaW1wbGUgY2xhc3MgaW5oZXJpdGFuY2UgKHByZXZpb3VzbHkgdXNlZCkgdGhlIGNvbnN0cnVjdG9yCiAgICAvLyAgaXMgYSBmdW5jdGlvbiB0aGF0IGNhbGxzIGB0aGlzLmluaXQuYXBwbHkoYXJndW1lbnRzKWAKICAgIC8vIEhvd2V2ZXIgdGhhdCB3b3VsZCBwcmV2ZW50IHVzIGZyb20gdXNpbmcgYFBhcmVudE9iamVjdC5jYWxsKHRoaXMpO2AKICAgIC8vICBpbiBhIENoaWxkIGNvbnN0cnVjdG9yIGJlY2F1c2UgdGhlIGB0aGlzYCBpbiBgdGhpcy5pbml0YAogICAgLy8gIHdvdWxkIHN0aWxsIHJlZmVyIHRvIHRoZSBDaGlsZCBhbmQgY2F1c2UgYW4gaW5maW5pdGUgbG9vcC4KICAgIC8vIFdlIHdvdWxkIGluc3RlYWQgaGF2ZSB0byBkbwogICAgLy8gICAgYFBhcmVudE9iamVjdC5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO2AKICAgIC8vICBCbGVoLiBXZSdyZSBub3QgY3JlYXRpbmcgYSBfc3VwZXIoKSBmdW5jdGlvbiwgc28gaXQncyBnb29kIHRvIGtlZXAKICAgIC8vICB0aGUgcGFyZW50IGNvbnN0cnVjdG9yIHJlZmVyZW5jZSBzaW1wbGUuCiAgICB2YXIgc3ViT2JqID0gZnVuY3Rpb24gc3ViT2JqKCkgewogICAgICBpbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIC8vIEluaGVyaXQgZnJvbSB0aGlzIG9iamVjdCdzIHByb3RvdHlwZQogICAgc3ViT2JqLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUodGhpcy5wcm90b3R5cGUpOwogICAgLy8gUmVzZXQgdGhlIGNvbnN0cnVjdG9yIHByb3BlcnR5IGZvciBzdWJPYmogb3RoZXJ3aXNlCiAgICAvLyBpbnN0YW5jZXMgb2Ygc3ViT2JqIHdvdWxkIGhhdmUgdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBwYXJlbnQgT2JqZWN0CiAgICBzdWJPYmoucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViT2JqOwoKICAgIC8vIE1ha2UgdGhlIGNsYXNzIGV4dGVuZGFibGUKICAgIHN1Yk9iai5leHRlbmQgPSBDb21wb25lbnQuZXh0ZW5kOwoKICAgIC8vIEV4dGVuZCBzdWJPYmoncyBwcm90b3R5cGUgd2l0aCBmdW5jdGlvbnMgYW5kIG90aGVyIHByb3BlcnRpZXMgZnJvbSBwcm9wcwogICAgZm9yICh2YXIgX25hbWUgaW4gcHJvcHMpIHsKICAgICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KF9uYW1lKSkgewogICAgICAgIHN1Yk9iai5wcm90b3R5cGVbX25hbWVdID0gcHJvcHNbX25hbWVdOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHN1Yk9iajsKICB9OwoKICByZXR1cm4gQ29tcG9uZW50Owp9KSgpOwoKQ29tcG9uZW50LnJlZ2lzdGVyQ29tcG9uZW50KCdDb21wb25lbnQnLCBDb21wb25lbnQpOwpleHBvcnRzWydkZWZhdWx0J10gPSBDb21wb25lbnQ7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vdXRpbHMvZG9tLmpzIjoxMjgsIi4vdXRpbHMvZXZlbnRzLmpzIjoxMjksIi4vdXRpbHMvZm4uanMiOjEzMCwiLi91dGlscy9ndWlkLmpzIjoxMzIsIi4vdXRpbHMvbG9nLmpzIjoxMzMsIi4vdXRpbHMvbWVyZ2Utb3B0aW9ucy5qcyI6MTM0LCIuL3V0aWxzL3RvLXRpdGxlLWNhc2UuanMiOjEzNywiZ2xvYmFsL3dpbmRvdyI6Miwib2JqZWN0LmFzc2lnbiI6NDV9XSw2NjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBjb250cm9sLWJhci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKLy8gUmVxdWlyZWQgY2hpbGRyZW4KCnZhciBfcGxheVRvZ2dsZUpzID0gX2RlcmVxXygnLi9wbGF5LXRvZ2dsZS5qcycpOwoKdmFyIF9wbGF5VG9nZ2xlSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGxheVRvZ2dsZUpzKTsKCnZhciBfdGltZUNvbnRyb2xzQ3VycmVudFRpbWVEaXNwbGF5SnMgPSBfZGVyZXFfKCcuL3RpbWUtY29udHJvbHMvY3VycmVudC10aW1lLWRpc3BsYXkuanMnKTsKCnZhciBfdGltZUNvbnRyb2xzQ3VycmVudFRpbWVEaXNwbGF5SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGltZUNvbnRyb2xzQ3VycmVudFRpbWVEaXNwbGF5SnMpOwoKdmFyIF90aW1lQ29udHJvbHNEdXJhdGlvbkRpc3BsYXlKcyA9IF9kZXJlcV8oJy4vdGltZS1jb250cm9scy9kdXJhdGlvbi1kaXNwbGF5LmpzJyk7Cgp2YXIgX3RpbWVDb250cm9sc0R1cmF0aW9uRGlzcGxheUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RpbWVDb250cm9sc0R1cmF0aW9uRGlzcGxheUpzKTsKCnZhciBfdGltZUNvbnRyb2xzVGltZURpdmlkZXJKcyA9IF9kZXJlcV8oJy4vdGltZS1jb250cm9scy90aW1lLWRpdmlkZXIuanMnKTsKCnZhciBfdGltZUNvbnRyb2xzVGltZURpdmlkZXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90aW1lQ29udHJvbHNUaW1lRGl2aWRlckpzKTsKCnZhciBfdGltZUNvbnRyb2xzUmVtYWluaW5nVGltZURpc3BsYXlKcyA9IF9kZXJlcV8oJy4vdGltZS1jb250cm9scy9yZW1haW5pbmctdGltZS1kaXNwbGF5LmpzJyk7Cgp2YXIgX3RpbWVDb250cm9sc1JlbWFpbmluZ1RpbWVEaXNwbGF5SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGltZUNvbnRyb2xzUmVtYWluaW5nVGltZURpc3BsYXlKcyk7Cgp2YXIgX2xpdmVEaXNwbGF5SnMgPSBfZGVyZXFfKCcuL2xpdmUtZGlzcGxheS5qcycpOwoKdmFyIF9saXZlRGlzcGxheUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xpdmVEaXNwbGF5SnMpOwoKdmFyIF9wcm9ncmVzc0NvbnRyb2xQcm9ncmVzc0NvbnRyb2xKcyA9IF9kZXJlcV8oJy4vcHJvZ3Jlc3MtY29udHJvbC9wcm9ncmVzcy1jb250cm9sLmpzJyk7Cgp2YXIgX3Byb2dyZXNzQ29udHJvbFByb2dyZXNzQ29udHJvbEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb2dyZXNzQ29udHJvbFByb2dyZXNzQ29udHJvbEpzKTsKCnZhciBfZnVsbHNjcmVlblRvZ2dsZUpzID0gX2RlcmVxXygnLi9mdWxsc2NyZWVuLXRvZ2dsZS5qcycpOwoKdmFyIF9mdWxsc2NyZWVuVG9nZ2xlSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZnVsbHNjcmVlblRvZ2dsZUpzKTsKCnZhciBfdm9sdW1lQ29udHJvbFZvbHVtZUNvbnRyb2xKcyA9IF9kZXJlcV8oJy4vdm9sdW1lLWNvbnRyb2wvdm9sdW1lLWNvbnRyb2wuanMnKTsKCnZhciBfdm9sdW1lQ29udHJvbFZvbHVtZUNvbnRyb2xKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92b2x1bWVDb250cm9sVm9sdW1lQ29udHJvbEpzKTsKCnZhciBfdm9sdW1lTWVudUJ1dHRvbkpzID0gX2RlcmVxXygnLi92b2x1bWUtbWVudS1idXR0b24uanMnKTsKCnZhciBfdm9sdW1lTWVudUJ1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZvbHVtZU1lbnVCdXR0b25Kcyk7Cgp2YXIgX211dGVUb2dnbGVKcyA9IF9kZXJlcV8oJy4vbXV0ZS10b2dnbGUuanMnKTsKCnZhciBfbXV0ZVRvZ2dsZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX211dGVUb2dnbGVKcyk7Cgp2YXIgX3RleHRUcmFja0NvbnRyb2xzQ2hhcHRlcnNCdXR0b25KcyA9IF9kZXJlcV8oJy4vdGV4dC10cmFjay1jb250cm9scy9jaGFwdGVycy1idXR0b24uanMnKTsKCnZhciBfdGV4dFRyYWNrQ29udHJvbHNDaGFwdGVyc0J1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RleHRUcmFja0NvbnRyb2xzQ2hhcHRlcnNCdXR0b25Kcyk7Cgp2YXIgX3RleHRUcmFja0NvbnRyb2xzU3VidGl0bGVzQnV0dG9uSnMgPSBfZGVyZXFfKCcuL3RleHQtdHJhY2stY29udHJvbHMvc3VidGl0bGVzLWJ1dHRvbi5qcycpOwoKdmFyIF90ZXh0VHJhY2tDb250cm9sc1N1YnRpdGxlc0J1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RleHRUcmFja0NvbnRyb2xzU3VidGl0bGVzQnV0dG9uSnMpOwoKdmFyIF90ZXh0VHJhY2tDb250cm9sc0NhcHRpb25zQnV0dG9uSnMgPSBfZGVyZXFfKCcuL3RleHQtdHJhY2stY29udHJvbHMvY2FwdGlvbnMtYnV0dG9uLmpzJyk7Cgp2YXIgX3RleHRUcmFja0NvbnRyb2xzQ2FwdGlvbnNCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZXh0VHJhY2tDb250cm9sc0NhcHRpb25zQnV0dG9uSnMpOwoKdmFyIF9wbGF5YmFja1JhdGVNZW51UGxheWJhY2tSYXRlTWVudUJ1dHRvbkpzID0gX2RlcmVxXygnLi9wbGF5YmFjay1yYXRlLW1lbnUvcGxheWJhY2stcmF0ZS1tZW51LWJ1dHRvbi5qcycpOwoKdmFyIF9wbGF5YmFja1JhdGVNZW51UGxheWJhY2tSYXRlTWVudUJ1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BsYXliYWNrUmF0ZU1lbnVQbGF5YmFja1JhdGVNZW51QnV0dG9uSnMpOwoKdmFyIF9zcGFjZXJDb250cm9sc0N1c3RvbUNvbnRyb2xTcGFjZXJKcyA9IF9kZXJlcV8oJy4vc3BhY2VyLWNvbnRyb2xzL2N1c3RvbS1jb250cm9sLXNwYWNlci5qcycpOwoKdmFyIF9zcGFjZXJDb250cm9sc0N1c3RvbUNvbnRyb2xTcGFjZXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcGFjZXJDb250cm9sc0N1c3RvbUNvbnRyb2xTcGFjZXJKcyk7CgovKioKICogQ29udGFpbmVyIG9mIG1haW4gY29udHJvbHMKICoKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBDb250cm9sQmFyCiAqLwoKdmFyIENvbnRyb2xCYXIgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQ29udHJvbEJhciwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIENvbnRyb2xCYXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29udHJvbEJhcik7CgogICAgX0NvbXBvbmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIENvbnRyb2xCYXIucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtY29udHJvbC1iYXInCiAgICB9KTsKICB9OwoKICByZXR1cm4gQ29udHJvbEJhcjsKfSkoX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddKTsKCkNvbnRyb2xCYXIucHJvdG90eXBlLm9wdGlvbnNfID0gewogIGxvYWRFdmVudDogJ3BsYXknLAogIGNoaWxkcmVuOiBbJ3BsYXlUb2dnbGUnLCAndm9sdW1lTWVudUJ1dHRvbicsICdjdXJyZW50VGltZURpc3BsYXknLCAndGltZURpdmlkZXInLCAnZHVyYXRpb25EaXNwbGF5JywgJ3Byb2dyZXNzQ29udHJvbCcsICdsaXZlRGlzcGxheScsICdyZW1haW5pbmdUaW1lRGlzcGxheScsICdjdXN0b21Db250cm9sU3BhY2VyJywgJ3BsYXliYWNrUmF0ZU1lbnVCdXR0b24nLCAnY2hhcHRlcnNCdXR0b24nLCAnc3VidGl0bGVzQnV0dG9uJywgJ2NhcHRpb25zQnV0dG9uJywgJ2Z1bGxzY3JlZW5Ub2dnbGUnXQp9OwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdDb250cm9sQmFyJywgQ29udHJvbEJhcik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IENvbnRyb2xCYXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2NvbXBvbmVudC5qcyI6NjUsIi4vZnVsbHNjcmVlbi10b2dnbGUuanMiOjY3LCIuL2xpdmUtZGlzcGxheS5qcyI6NjgsIi4vbXV0ZS10b2dnbGUuanMiOjY5LCIuL3BsYXktdG9nZ2xlLmpzIjo3MCwiLi9wbGF5YmFjay1yYXRlLW1lbnUvcGxheWJhY2stcmF0ZS1tZW51LWJ1dHRvbi5qcyI6NzEsIi4vcHJvZ3Jlc3MtY29udHJvbC9wcm9ncmVzcy1jb250cm9sLmpzIjo3NiwiLi9zcGFjZXItY29udHJvbHMvY3VzdG9tLWNvbnRyb2wtc3BhY2VyLmpzIjo3OCwiLi90ZXh0LXRyYWNrLWNvbnRyb2xzL2NhcHRpb25zLWJ1dHRvbi5qcyI6ODEsIi4vdGV4dC10cmFjay1jb250cm9scy9jaGFwdGVycy1idXR0b24uanMiOjgyLCIuL3RleHQtdHJhY2stY29udHJvbHMvc3VidGl0bGVzLWJ1dHRvbi5qcyI6ODUsIi4vdGltZS1jb250cm9scy9jdXJyZW50LXRpbWUtZGlzcGxheS5qcyI6ODgsIi4vdGltZS1jb250cm9scy9kdXJhdGlvbi1kaXNwbGF5LmpzIjo4OSwiLi90aW1lLWNvbnRyb2xzL3JlbWFpbmluZy10aW1lLWRpc3BsYXkuanMiOjkwLCIuL3RpbWUtY29udHJvbHMvdGltZS1kaXZpZGVyLmpzIjo5MSwiLi92b2x1bWUtY29udHJvbC92b2x1bWUtY29udHJvbC5qcyI6OTMsIi4vdm9sdW1lLW1lbnUtYnV0dG9uLmpzIjo5NX1dLDY3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGZ1bGxzY3JlZW4tdG9nZ2xlLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9idXR0b25KcyA9IF9kZXJlcV8oJy4uL2J1dHRvbi5qcycpOwoKdmFyIF9idXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9idXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBUb2dnbGUgZnVsbHNjcmVlbiB2aWRlbwogKgogKiBAZXh0ZW5kcyBCdXR0b24KICogQGNsYXNzIEZ1bGxzY3JlZW5Ub2dnbGUKICovCgp2YXIgRnVsbHNjcmVlblRvZ2dsZSA9IChmdW5jdGlvbiAoX0J1dHRvbikgewogIF9pbmhlcml0cyhGdWxsc2NyZWVuVG9nZ2xlLCBfQnV0dG9uKTsKCiAgZnVuY3Rpb24gRnVsbHNjcmVlblRvZ2dsZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGdWxsc2NyZWVuVG9nZ2xlKTsKCiAgICBfQnV0dG9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgRnVsbHNjcmVlblRvZ2dsZS5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1mdWxsc2NyZWVuLWNvbnRyb2wgJyArIF9CdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGVzIGNsaWNrIGZvciBmdWxsIHNjcmVlbgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBGdWxsc2NyZWVuVG9nZ2xlLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgaWYgKCF0aGlzLnBsYXllcl8uaXNGdWxsc2NyZWVuKCkpIHsKICAgICAgdGhpcy5wbGF5ZXJfLnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICAgIHRoaXMuY29udHJvbFRleHQoJ05vbi1GdWxsc2NyZWVuJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnBsYXllcl8uZXhpdEZ1bGxzY3JlZW4oKTsKICAgICAgdGhpcy5jb250cm9sVGV4dCgnRnVsbHNjcmVlbicpOwogICAgfQogIH07CgogIHJldHVybiBGdWxsc2NyZWVuVG9nZ2xlOwp9KShfYnV0dG9uSnMyWydkZWZhdWx0J10pOwoKRnVsbHNjcmVlblRvZ2dsZS5wcm90b3R5cGUuY29udHJvbFRleHRfID0gJ0Z1bGxzY3JlZW4nOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdGdWxsc2NyZWVuVG9nZ2xlJywgRnVsbHNjcmVlblRvZ2dsZSk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IEZ1bGxzY3JlZW5Ub2dnbGU7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2J1dHRvbi5qcyI6NjMsIi4uL2NvbXBvbmVudC5qcyI6NjV9XSw2ODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBsaXZlLWRpc3BsYXkuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9jb21wb25lbnQgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQnKTsKCnZhciBfY29tcG9uZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudCk7Cgp2YXIgX3V0aWxzRG9tSnMgPSBfZGVyZXFfKCcuLi91dGlscy9kb20uanMnKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb21Kcyk7CgovKioKICogRGlzcGxheXMgdGhlIGxpdmUgaW5kaWNhdG9yCiAqIFRPRE8gLSBGdXR1cmUgbWFrZSBpdCBjbGljayB0byBzbmFwIHRvIGxpdmUKICoKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBMaXZlRGlzcGxheQogKi8KCnZhciBMaXZlRGlzcGxheSA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhMaXZlRGlzcGxheSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIExpdmVEaXNwbGF5KHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpdmVEaXNwbGF5KTsKCiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB0aGlzLnVwZGF0ZVNob3dpbmcoKTsKICAgIHRoaXMub24odGhpcy5wbGF5ZXIoKSwgJ2R1cmF0aW9uY2hhbmdlJywgdGhpcy51cGRhdGVTaG93aW5nKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBMaXZlRGlzcGxheS5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHZhciBlbCA9IF9Db21wb25lbnQucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLWxpdmUtY29udHJvbCB2anMtY29udHJvbCcKICAgIH0pOwoKICAgIHRoaXMuY29udGVudEVsXyA9IERvbS5jcmVhdGVFbCgnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtbGl2ZS1kaXNwbGF5JywKICAgICAgaW5uZXJIVE1MOiAnPHNwYW4gY2xhc3M9InZqcy1jb250cm9sLXRleHQiPicgKyB0aGlzLmxvY2FsaXplKCdTdHJlYW0gVHlwZScpICsgJzwvc3Bhbj4nICsgdGhpcy5sb2NhbGl6ZSgnTElWRScpCiAgICB9LCB7CiAgICAgICdhcmlhLWxpdmUnOiAnb2ZmJwogICAgfSk7CgogICAgZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50RWxfKTsKICAgIHJldHVybiBlbDsKICB9OwoKICBMaXZlRGlzcGxheS5wcm90b3R5cGUudXBkYXRlU2hvd2luZyA9IGZ1bmN0aW9uIHVwZGF0ZVNob3dpbmcoKSB7CiAgICBpZiAodGhpcy5wbGF5ZXIoKS5kdXJhdGlvbigpID09PSBJbmZpbml0eSkgewogICAgICB0aGlzLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaGlkZSgpOwogICAgfQogIH07CgogIHJldHVybiBMaXZlRGlzcGxheTsKfSkoX2NvbXBvbmVudDJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdMaXZlRGlzcGxheScsIExpdmVEaXNwbGF5KTsKZXhwb3J0c1snZGVmYXVsdCddID0gTGl2ZURpc3BsYXk7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2NvbXBvbmVudCI6NjUsIi4uL3V0aWxzL2RvbS5qcyI6MTI4fV0sNjk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgbXV0ZS10b2dnbGUuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9idXR0b24gPSBfZGVyZXFfKCcuLi9idXR0b24nKTsKCnZhciBfYnV0dG9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2J1dHRvbik7Cgp2YXIgX2NvbXBvbmVudCA9IF9kZXJlcV8oJy4uL2NvbXBvbmVudCcpOwoKdmFyIF9jb21wb25lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50KTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2RvbS5qcycpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbUpzKTsKCi8qKgogKiBBIGJ1dHRvbiBjb21wb25lbnQgZm9yIG11dGluZyB0aGUgYXVkaW8KICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIEJ1dHRvbgogKiBAY2xhc3MgTXV0ZVRvZ2dsZQogKi8KCnZhciBNdXRlVG9nZ2xlID0gKGZ1bmN0aW9uIChfQnV0dG9uKSB7CiAgX2luaGVyaXRzKE11dGVUb2dnbGUsIF9CdXR0b24pOwoKICBmdW5jdGlvbiBNdXRlVG9nZ2xlKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE11dGVUb2dnbGUpOwoKICAgIF9CdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwoKICAgIHRoaXMub24ocGxheWVyLCAndm9sdW1lY2hhbmdlJywgdGhpcy51cGRhdGUpOwoKICAgIC8vIGhpZGUgbXV0ZSB0b2dnbGUgaWYgdGhlIGN1cnJlbnQgdGVjaCBkb2Vzbid0IHN1cHBvcnQgdm9sdW1lIGNvbnRyb2wKICAgIGlmIChwbGF5ZXIudGVjaF8gJiYgcGxheWVyLnRlY2hfWydmZWF0dXJlc1ZvbHVtZUNvbnRyb2wnXSA9PT0gZmFsc2UpIHsKICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWhpZGRlbicpOwogICAgfQoKICAgIHRoaXMub24ocGxheWVyLCAnbG9hZHN0YXJ0JywgZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnVwZGF0ZSgpOyAvLyBXZSBuZWVkIHRvIHVwZGF0ZSB0aGUgYnV0dG9uIHRvIGFjY291bnQgZm9yIGEgZGVmYXVsdCBtdXRlZCBzdGF0ZS4KCiAgICAgIGlmIChwbGF5ZXIudGVjaF9bJ2ZlYXR1cmVzVm9sdW1lQ29udHJvbCddID09PSBmYWxzZSkgewogICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1oaWRkZW4nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtaGlkZGVuJyk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyoqCiAgICogQWxsb3cgc3ViIGNvbXBvbmVudHMgdG8gc3RhY2sgQ1NTIGNsYXNzIG5hbWVzCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBjb25zdHJ1Y3RlZCBjbGFzcyBuYW1lCiAgICogQG1ldGhvZCBidWlsZENTU0NsYXNzCiAgICovCgogIE11dGVUb2dnbGUucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MgPSBmdW5jdGlvbiBidWlsZENTU0NsYXNzKCkgewogICAgcmV0dXJuICd2anMtbXV0ZS1jb250cm9sICcgKyBfQnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGNsaWNrIG9uIG11dGUKICAgKgogICAqIEBtZXRob2QgaGFuZGxlQ2xpY2sKICAgKi8KCiAgTXV0ZVRvZ2dsZS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIHRoaXMucGxheWVyXy5tdXRlZCh0aGlzLnBsYXllcl8ubXV0ZWQoKSA/IGZhbHNlIDogdHJ1ZSk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIHZvbHVtZQogICAqCiAgICogQG1ldGhvZCB1cGRhdGUKICAgKi8KCiAgTXV0ZVRvZ2dsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKCkgewogICAgdmFyIHZvbCA9IHRoaXMucGxheWVyXy52b2x1bWUoKSwKICAgICAgICBsZXZlbCA9IDM7CgogICAgaWYgKHZvbCA9PT0gMCB8fCB0aGlzLnBsYXllcl8ubXV0ZWQoKSkgewogICAgICBsZXZlbCA9IDA7CiAgICB9IGVsc2UgaWYgKHZvbCA8IDAuMzMpIHsKICAgICAgbGV2ZWwgPSAxOwogICAgfSBlbHNlIGlmICh2b2wgPCAwLjY3KSB7CiAgICAgIGxldmVsID0gMjsKICAgIH0KCiAgICAvLyBEb24ndCByZXdyaXRlIHRoZSBidXR0b24gdGV4dCBpZiB0aGUgYWN0dWFsIHRleHQgZG9lc24ndCBjaGFuZ2UuCiAgICAvLyBUaGlzIGNhdXNlcyB1bm5lY2Vzc2FyeSBhbmQgY29uZnVzaW5nIGluZm9ybWF0aW9uIGZvciBzY3JlZW4gcmVhZGVyIHVzZXJzLgogICAgLy8gVGhpcyBjaGVjayBpcyBuZWVkZWQgYmVjYXVzZSB0aGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGV2ZXJ5IHRpbWUgdGhlIHZvbHVtZSBsZXZlbCBpcyBjaGFuZ2VkLgogICAgdmFyIHRvTXV0ZSA9IHRoaXMucGxheWVyXy5tdXRlZCgpID8gJ1VubXV0ZScgOiAnTXV0ZSc7CiAgICB2YXIgbG9jYWxpemVkTXV0ZSA9IHRoaXMubG9jYWxpemUodG9NdXRlKTsKICAgIGlmICh0aGlzLmNvbnRyb2xUZXh0KCkgIT09IGxvY2FsaXplZE11dGUpIHsKICAgICAgdGhpcy5jb250cm9sVGV4dChsb2NhbGl6ZWRNdXRlKTsKICAgIH0KCiAgICAvKiBUT0RPIGltcHJvdmUgbXV0ZWQgaWNvbiBjbGFzc2VzICovCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICBEb20ucmVtb3ZlRWxDbGFzcyh0aGlzLmVsXywgJ3Zqcy12b2wtJyArIGkpOwogICAgfQogICAgRG9tLmFkZEVsQ2xhc3ModGhpcy5lbF8sICd2anMtdm9sLScgKyBsZXZlbCk7CiAgfTsKCiAgcmV0dXJuIE11dGVUb2dnbGU7Cn0pKF9idXR0b24yWydkZWZhdWx0J10pOwoKTXV0ZVRvZ2dsZS5wcm90b3R5cGUuY29udHJvbFRleHRfID0gJ011dGUnOwoKX2NvbXBvbmVudDJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnTXV0ZVRvZ2dsZScsIE11dGVUb2dnbGUpOwpleHBvcnRzWydkZWZhdWx0J10gPSBNdXRlVG9nZ2xlOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9idXR0b24iOjYzLCIuLi9jb21wb25lbnQiOjY1LCIuLi91dGlscy9kb20uanMiOjEyOH1dLDcwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHBsYXktdG9nZ2xlLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9idXR0b25KcyA9IF9kZXJlcV8oJy4uL2J1dHRvbi5qcycpOwoKdmFyIF9idXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9idXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBCdXR0b24gdG8gdG9nZ2xlIGJldHdlZW4gcGxheSBhbmQgcGF1c2UKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIEJ1dHRvbgogKiBAY2xhc3MgUGxheVRvZ2dsZQogKi8KCnZhciBQbGF5VG9nZ2xlID0gKGZ1bmN0aW9uIChfQnV0dG9uKSB7CiAgX2luaGVyaXRzKFBsYXlUb2dnbGUsIF9CdXR0b24pOwoKICBmdW5jdGlvbiBQbGF5VG9nZ2xlKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBsYXlUb2dnbGUpOwoKICAgIF9CdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwoKICAgIHRoaXMub24ocGxheWVyLCAncGxheScsIHRoaXMuaGFuZGxlUGxheSk7CiAgICB0aGlzLm9uKHBsYXllciwgJ3BhdXNlJywgdGhpcy5oYW5kbGVQYXVzZSk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgUGxheVRvZ2dsZS5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1wbGF5LWNvbnRyb2wgJyArIF9CdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgY2xpY2sgdG8gdG9nZ2xlIGJldHdlZW4gcGxheSBhbmQgcGF1c2UKICAgKgogICAqIEBtZXRob2QgaGFuZGxlQ2xpY2sKICAgKi8KCiAgUGxheVRvZ2dsZS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIGlmICh0aGlzLnBsYXllcl8ucGF1c2VkKCkpIHsKICAgICAgdGhpcy5wbGF5ZXJfLnBsYXkoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucGxheWVyXy5wYXVzZSgpOwogICAgfQogIH07CgogIC8qKgogICAqIEFkZCB0aGUgdmpzLXBsYXlpbmcgY2xhc3MgdG8gdGhlIGVsZW1lbnQgc28gaXQgY2FuIGNoYW5nZSBhcHBlYXJhbmNlCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZVBsYXkKICAgKi8KCiAgUGxheVRvZ2dsZS5wcm90b3R5cGUuaGFuZGxlUGxheSA9IGZ1bmN0aW9uIGhhbmRsZVBsYXkoKSB7CiAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtcGF1c2VkJyk7CiAgICB0aGlzLmFkZENsYXNzKCd2anMtcGxheWluZycpOwogICAgdGhpcy5jb250cm9sVGV4dCgnUGF1c2UnKTsgLy8gY2hhbmdlIHRoZSBidXR0b24gdGV4dCB0byAiUGF1c2UiCiAgfTsKCiAgLyoqCiAgICogQWRkIHRoZSB2anMtcGF1c2VkIGNsYXNzIHRvIHRoZSBlbGVtZW50IHNvIGl0IGNhbiBjaGFuZ2UgYXBwZWFyYW5jZQogICAqCiAgICogQG1ldGhvZCBoYW5kbGVQYXVzZQogICAqLwoKICBQbGF5VG9nZ2xlLnByb3RvdHlwZS5oYW5kbGVQYXVzZSA9IGZ1bmN0aW9uIGhhbmRsZVBhdXNlKCkgewogICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLXBsYXlpbmcnKTsKICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1wYXVzZWQnKTsKICAgIHRoaXMuY29udHJvbFRleHQoJ1BsYXknKTsgLy8gY2hhbmdlIHRoZSBidXR0b24gdGV4dCB0byAiUGxheSIKICB9OwoKICByZXR1cm4gUGxheVRvZ2dsZTsKfSkoX2J1dHRvbkpzMlsnZGVmYXVsdCddKTsKClBsYXlUb2dnbGUucHJvdG90eXBlLmNvbnRyb2xUZXh0XyA9ICdQbGF5JzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnUGxheVRvZ2dsZScsIFBsYXlUb2dnbGUpOwpleHBvcnRzWydkZWZhdWx0J10gPSBQbGF5VG9nZ2xlOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9idXR0b24uanMiOjYzLCIuLi9jb21wb25lbnQuanMiOjY1fV0sNzE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgcGxheWJhY2stcmF0ZS1tZW51LWJ1dHRvbi5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX21lbnVNZW51QnV0dG9uSnMgPSBfZGVyZXFfKCcuLi8uLi9tZW51L21lbnUtYnV0dG9uLmpzJyk7Cgp2YXIgX21lbnVNZW51QnV0dG9uSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVudU1lbnVCdXR0b25Kcyk7Cgp2YXIgX21lbnVNZW51SnMgPSBfZGVyZXFfKCcuLi8uLi9tZW51L21lbnUuanMnKTsKCnZhciBfbWVudU1lbnVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUpzKTsKCnZhciBfcGxheWJhY2tSYXRlTWVudUl0ZW1KcyA9IF9kZXJlcV8oJy4vcGxheWJhY2stcmF0ZS1tZW51LWl0ZW0uanMnKTsKCnZhciBfcGxheWJhY2tSYXRlTWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbGF5YmFja1JhdGVNZW51SXRlbUpzKTsKCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKLyoqCiAqIFRoZSBjb21wb25lbnQgZm9yIGNvbnRyb2xsaW5nIHRoZSBwbGF5YmFjayByYXRlCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBNZW51QnV0dG9uCiAqIEBjbGFzcyBQbGF5YmFja1JhdGVNZW51QnV0dG9uCiAqLwoKdmFyIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24gPSAoZnVuY3Rpb24gKF9NZW51QnV0dG9uKSB7CiAgX2luaGVyaXRzKFBsYXliYWNrUmF0ZU1lbnVCdXR0b24sIF9NZW51QnV0dG9uKTsKCiAgZnVuY3Rpb24gUGxheWJhY2tSYXRlTWVudUJ1dHRvbihwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbGF5YmFja1JhdGVNZW51QnV0dG9uKTsKCiAgICBfTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgdGhpcy51cGRhdGVWaXNpYmlsaXR5KCk7CiAgICB0aGlzLnVwZGF0ZUxhYmVsKCk7CgogICAgdGhpcy5vbihwbGF5ZXIsICdsb2Fkc3RhcnQnLCB0aGlzLnVwZGF0ZVZpc2liaWxpdHkpOwogICAgdGhpcy5vbihwbGF5ZXIsICdyYXRlY2hhbmdlJywgdGhpcy51cGRhdGVMYWJlbCk7CiAgfQoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgUGxheWJhY2tSYXRlTWVudUJ1dHRvbi5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHZhciBlbCA9IF9NZW51QnV0dG9uLnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMpOwoKICAgIHRoaXMubGFiZWxFbF8gPSBEb20uY3JlYXRlRWwoJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLXBsYXliYWNrLXJhdGUtdmFsdWUnLAogICAgICBpbm5lckhUTUw6IDEuMAogICAgfSk7CgogICAgZWwuYXBwZW5kQ2hpbGQodGhpcy5sYWJlbEVsXyk7CgogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIEFsbG93IHN1YiBjb21wb25lbnRzIHRvIHN0YWNrIENTUyBjbGFzcyBuYW1lcwogICAqCiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgY29uc3RydWN0ZWQgY2xhc3MgbmFtZQogICAqIEBtZXRob2QgYnVpbGRDU1NDbGFzcwogICAqLwoKICBQbGF5YmFja1JhdGVNZW51QnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIHJldHVybiAndmpzLXBsYXliYWNrLXJhdGUgJyArIF9NZW51QnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBwbGF5YmFjayByYXRlIG1lbnUKICAgKgogICAqIEByZXR1cm4ge01lbnV9IE1lbnUgb2JqZWN0IHBvcHVsYXRlZCB3aXRoIGl0ZW1zCiAgICogQG1ldGhvZCBjcmVhdGVNZW51CiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU1lbnUgPSBmdW5jdGlvbiBjcmVhdGVNZW51KCkgewogICAgdmFyIG1lbnUgPSBuZXcgX21lbnVNZW51SnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXIoKSk7CiAgICB2YXIgcmF0ZXMgPSB0aGlzLnBsYXliYWNrUmF0ZXMoKTsKCiAgICBpZiAocmF0ZXMpIHsKICAgICAgZm9yICh2YXIgaSA9IHJhdGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgbWVudS5hZGRDaGlsZChuZXcgX3BsYXliYWNrUmF0ZU1lbnVJdGVtSnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXIoKSwgeyAncmF0ZSc6IHJhdGVzW2ldICsgJ3gnIH0pKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBtZW51OwogIH07CgogIC8qKgogICAqIFVwZGF0ZXMgQVJJQSBhY2Nlc3NpYmlsaXR5IGF0dHJpYnV0ZXMKICAgKgogICAqIEBtZXRob2QgdXBkYXRlQVJJQUF0dHJpYnV0ZXMKICAgKi8KCiAgUGxheWJhY2tSYXRlTWVudUJ1dHRvbi5wcm90b3R5cGUudXBkYXRlQVJJQUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiB1cGRhdGVBUklBQXR0cmlidXRlcygpIHsKICAgIC8vIEN1cnJlbnQgcGxheWJhY2sgcmF0ZQogICAgdGhpcy5lbCgpLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHRoaXMucGxheWVyKCkucGxheWJhY2tSYXRlKCkpOwogIH07CgogIC8qKgogICAqIEhhbmRsZSBtZW51IGl0ZW0gY2xpY2sKICAgKgogICAqIEBtZXRob2QgaGFuZGxlQ2xpY2sKICAgKi8KCiAgUGxheWJhY2tSYXRlTWVudUJ1dHRvbi5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIC8vIHNlbGVjdCBuZXh0IHJhdGUgb3B0aW9uCiAgICB2YXIgY3VycmVudFJhdGUgPSB0aGlzLnBsYXllcigpLnBsYXliYWNrUmF0ZSgpOwogICAgdmFyIHJhdGVzID0gdGhpcy5wbGF5YmFja1JhdGVzKCk7CgogICAgLy8gdGhpcyB3aWxsIHNlbGVjdCBmaXJzdCBvbmUgaWYgdGhlIGxhc3Qgb25lIGN1cnJlbnRseSBzZWxlY3RlZAogICAgdmFyIG5ld1JhdGUgPSByYXRlc1swXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmF0ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHJhdGVzW2ldID4gY3VycmVudFJhdGUpIHsKICAgICAgICBuZXdSYXRlID0gcmF0ZXNbaV07CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIHRoaXMucGxheWVyKCkucGxheWJhY2tSYXRlKG5ld1JhdGUpOwogIH07CgogIC8qKgogICAqIEdldCBwb3NzaWJsZSBwbGF5YmFjayByYXRlcwogICAqCiAgICogQHJldHVybiB7QXJyYXl9IFBvc3NpYmxlIHBsYXliYWNrIHJhdGVzCiAgICogQG1ldGhvZCBwbGF5YmFja1JhdGVzCiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24ucHJvdG90eXBlLnBsYXliYWNrUmF0ZXMgPSBmdW5jdGlvbiBwbGF5YmFja1JhdGVzKCkgewogICAgcmV0dXJuIHRoaXMub3B0aW9uc19bJ3BsYXliYWNrUmF0ZXMnXSB8fCB0aGlzLm9wdGlvbnNfLnBsYXllck9wdGlvbnMgJiYgdGhpcy5vcHRpb25zXy5wbGF5ZXJPcHRpb25zWydwbGF5YmFja1JhdGVzJ107CiAgfTsKCiAgLyoqCiAgICogR2V0IHN1cHBvcnRlZCBwbGF5YmFjayByYXRlcwogICAqCiAgICogQHJldHVybiB7QXJyYXl9IFN1cHBvcnRlZCBwbGF5YmFjayByYXRlcwogICAqIEBtZXRob2QgcGxheWJhY2tSYXRlU3VwcG9ydGVkCiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24ucHJvdG90eXBlLnBsYXliYWNrUmF0ZVN1cHBvcnRlZCA9IGZ1bmN0aW9uIHBsYXliYWNrUmF0ZVN1cHBvcnRlZCgpIHsKICAgIHJldHVybiB0aGlzLnBsYXllcigpLnRlY2hfICYmIHRoaXMucGxheWVyKCkudGVjaF9bJ2ZlYXR1cmVzUGxheWJhY2tSYXRlJ10gJiYgdGhpcy5wbGF5YmFja1JhdGVzKCkgJiYgdGhpcy5wbGF5YmFja1JhdGVzKCkubGVuZ3RoID4gMDsKICB9OwoKICAvKioKICAgKiBIaWRlIHBsYXliYWNrIHJhdGUgY29udHJvbHMgd2hlbiB0aGV5J3JlIG5vIHBsYXliYWNrIHJhdGUgb3B0aW9ucyB0byBzZWxlY3QKICAgKgogICAqIEBtZXRob2QgdXBkYXRlVmlzaWJpbGl0eQogICAqLwoKICBQbGF5YmFja1JhdGVNZW51QnV0dG9uLnByb3RvdHlwZS51cGRhdGVWaXNpYmlsaXR5ID0gZnVuY3Rpb24gdXBkYXRlVmlzaWJpbGl0eSgpIHsKICAgIGlmICh0aGlzLnBsYXliYWNrUmF0ZVN1cHBvcnRlZCgpKSB7CiAgICAgIHRoaXMucmVtb3ZlQ2xhc3MoJ3Zqcy1oaWRkZW4nKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1oaWRkZW4nKTsKICAgIH0KICB9OwoKICAvKioKICAgKiBVcGRhdGUgYnV0dG9uIGxhYmVsIHdoZW4gcmF0ZSBjaGFuZ2VkCiAgICoKICAgKiBAbWV0aG9kIHVwZGF0ZUxhYmVsCiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24ucHJvdG90eXBlLnVwZGF0ZUxhYmVsID0gZnVuY3Rpb24gdXBkYXRlTGFiZWwoKSB7CiAgICBpZiAodGhpcy5wbGF5YmFja1JhdGVTdXBwb3J0ZWQoKSkgewogICAgICB0aGlzLmxhYmVsRWxfLmlubmVySFRNTCA9IHRoaXMucGxheWVyKCkucGxheWJhY2tSYXRlKCkgKyAneCc7CiAgICB9CiAgfTsKCiAgcmV0dXJuIFBsYXliYWNrUmF0ZU1lbnVCdXR0b247Cn0pKF9tZW51TWVudUJ1dHRvbkpzMlsnZGVmYXVsdCddKTsKClBsYXliYWNrUmF0ZU1lbnVCdXR0b24ucHJvdG90eXBlLmNvbnRyb2xUZXh0XyA9ICdQbGF5YmFjayBSYXRlJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnUGxheWJhY2tSYXRlTWVudUJ1dHRvbicsIFBsYXliYWNrUmF0ZU1lbnVCdXR0b24pOwpleHBvcnRzWydkZWZhdWx0J10gPSBQbGF5YmFja1JhdGVNZW51QnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuLi8uLi9tZW51L21lbnUtYnV0dG9uLmpzIjoxMDIsIi4uLy4uL21lbnUvbWVudS5qcyI6MTA0LCIuLi8uLi91dGlscy9kb20uanMiOjEyOCwiLi9wbGF5YmFjay1yYXRlLW1lbnUtaXRlbS5qcyI6NzJ9XSw3MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBwbGF5YmFjay1yYXRlLW1lbnUtaXRlbS5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfbWVudU1lbnVJdGVtSnMgPSBfZGVyZXFfKCcuLi8uLi9tZW51L21lbnUtaXRlbS5qcycpOwoKdmFyIF9tZW51TWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUl0ZW1Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBUaGUgc3BlY2lmaWMgbWVudSBpdGVtIHR5cGUgZm9yIHNlbGVjdGluZyBhIHBsYXliYWNrIHJhdGUKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIE1lbnVJdGVtCiAqIEBjbGFzcyBQbGF5YmFja1JhdGVNZW51SXRlbQogKi8KCnZhciBQbGF5YmFja1JhdGVNZW51SXRlbSA9IChmdW5jdGlvbiAoX01lbnVJdGVtKSB7CiAgX2luaGVyaXRzKFBsYXliYWNrUmF0ZU1lbnVJdGVtLCBfTWVudUl0ZW0pOwoKICBmdW5jdGlvbiBQbGF5YmFja1JhdGVNZW51SXRlbShwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbGF5YmFja1JhdGVNZW51SXRlbSk7CgogICAgdmFyIGxhYmVsID0gb3B0aW9uc1sncmF0ZSddOwogICAgdmFyIHJhdGUgPSBwYXJzZUZsb2F0KGxhYmVsLCAxMCk7CgogICAgLy8gTW9kaWZ5IG9wdGlvbnMgZm9yIHBhcmVudCBNZW51SXRlbSBjbGFzcydzIGluaXQuCiAgICBvcHRpb25zWydsYWJlbCddID0gbGFiZWw7CiAgICBvcHRpb25zWydzZWxlY3RlZCddID0gcmF0ZSA9PT0gMTsKICAgIF9NZW51SXRlbS5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgdGhpcy5sYWJlbCA9IGxhYmVsOwogICAgdGhpcy5yYXRlID0gcmF0ZTsKCiAgICB0aGlzLm9uKHBsYXllciwgJ3JhdGVjaGFuZ2UnLCB0aGlzLnVwZGF0ZSk7CiAgfQoKICAvKioKICAgKiBIYW5kbGUgY2xpY2sgb24gbWVudSBpdGVtCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUNsaWNrCiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVJdGVtLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgX01lbnVJdGVtLnByb3RvdHlwZS5oYW5kbGVDbGljay5jYWxsKHRoaXMpOwogICAgdGhpcy5wbGF5ZXIoKS5wbGF5YmFja1JhdGUodGhpcy5yYXRlKTsKICB9OwoKICAvKioKICAgKiBVcGRhdGUgcGxheWJhY2sgcmF0ZSB3aXRoIHNlbGVjdGVkIHJhdGUKICAgKgogICAqIEBtZXRob2QgdXBkYXRlCiAgICovCgogIFBsYXliYWNrUmF0ZU1lbnVJdGVtLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICB0aGlzLnNlbGVjdGVkKHRoaXMucGxheWVyKCkucGxheWJhY2tSYXRlKCkgPT09IHRoaXMucmF0ZSk7CiAgfTsKCiAgcmV0dXJuIFBsYXliYWNrUmF0ZU1lbnVJdGVtOwp9KShfbWVudU1lbnVJdGVtSnMyWydkZWZhdWx0J10pOwoKUGxheWJhY2tSYXRlTWVudUl0ZW0ucHJvdG90eXBlLmNvbnRlbnRFbFR5cGUgPSAnYnV0dG9uJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnUGxheWJhY2tSYXRlTWVudUl0ZW0nLCBQbGF5YmFja1JhdGVNZW51SXRlbSk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IFBsYXliYWNrUmF0ZU1lbnVJdGVtOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuLi8uLi9tZW51L21lbnUtaXRlbS5qcyI6MTAzfV0sNzM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgbG9hZC1wcm9ncmVzcy1iYXIuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uLy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7Cgp2YXIgX3V0aWxzRG9tSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9kb20uanMnKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb21Kcyk7CgovKioKICogU2hvd3MgbG9hZCBwcm9ncmVzcwogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBMb2FkUHJvZ3Jlc3NCYXIKICovCgp2YXIgTG9hZFByb2dyZXNzQmFyID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKExvYWRQcm9ncmVzc0JhciwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIExvYWRQcm9ncmVzc0JhcihwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2FkUHJvZ3Jlc3NCYXIpOwoKICAgIF9Db21wb25lbnQuY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwogICAgdGhpcy5vbihwbGF5ZXIsICdwcm9ncmVzcycsIHRoaXMudXBkYXRlKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBMb2FkUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtbG9hZC1wcm9ncmVzcycsCiAgICAgIGlubmVySFRNTDogJzxzcGFuIGNsYXNzPSJ2anMtY29udHJvbC10ZXh0Ij48c3Bhbj4nICsgdGhpcy5sb2NhbGl6ZSgnTG9hZGVkJykgKyAnPC9zcGFuPjogMCU8L3NwYW4+JwogICAgfSk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIHByb2dyZXNzIGJhcgogICAqCiAgICogQG1ldGhvZCB1cGRhdGUKICAgKi8KCiAgTG9hZFByb2dyZXNzQmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICB2YXIgYnVmZmVyZWQgPSB0aGlzLnBsYXllcl8uYnVmZmVyZWQoKTsKICAgIHZhciBkdXJhdGlvbiA9IHRoaXMucGxheWVyXy5kdXJhdGlvbigpOwogICAgdmFyIGJ1ZmZlcmVkRW5kID0gdGhpcy5wbGF5ZXJfLmJ1ZmZlcmVkRW5kKCk7CiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmVsXy5jaGlsZHJlbjsKCiAgICAvLyBnZXQgdGhlIHBlcmNlbnQgd2lkdGggb2YgYSB0aW1lIGNvbXBhcmVkIHRvIHRoZSB0b3RhbCBlbmQKICAgIHZhciBwZXJjZW50aWZ5ID0gZnVuY3Rpb24gcGVyY2VudGlmeSh0aW1lLCBlbmQpIHsKICAgICAgdmFyIHBlcmNlbnQgPSB0aW1lIC8gZW5kIHx8IDA7IC8vIG5vIE5hTgogICAgICByZXR1cm4gKHBlcmNlbnQgPj0gMSA/IDEgOiBwZXJjZW50KSAqIDEwMCArICclJzsKICAgIH07CgogICAgLy8gdXBkYXRlIHRoZSB3aWR0aCBvZiB0aGUgcHJvZ3Jlc3MgYmFyCiAgICB0aGlzLmVsXy5zdHlsZS53aWR0aCA9IHBlcmNlbnRpZnkoYnVmZmVyZWRFbmQsIGR1cmF0aW9uKTsKCiAgICAvLyBhZGQgY2hpbGQgZWxlbWVudHMgdG8gcmVwcmVzZW50IHRoZSBpbmRpdmlkdWFsIGJ1ZmZlcmVkIHRpbWUgcmFuZ2VzCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzdGFydCA9IGJ1ZmZlcmVkLnN0YXJ0KGkpOwogICAgICB2YXIgZW5kID0gYnVmZmVyZWQuZW5kKGkpOwogICAgICB2YXIgcGFydCA9IGNoaWxkcmVuW2ldOwoKICAgICAgaWYgKCFwYXJ0KSB7CiAgICAgICAgcGFydCA9IHRoaXMuZWxfLmFwcGVuZENoaWxkKERvbS5jcmVhdGVFbCgpKTsKICAgICAgfQoKICAgICAgLy8gc2V0IHRoZSBwZXJjZW50IGJhc2VkIG9uIHRoZSB3aWR0aCBvZiB0aGUgcHJvZ3Jlc3MgYmFyIChidWZmZXJlZEVuZCkKICAgICAgcGFydC5zdHlsZS5sZWZ0ID0gcGVyY2VudGlmeShzdGFydCwgYnVmZmVyZWRFbmQpOwogICAgICBwYXJ0LnN0eWxlLndpZHRoID0gcGVyY2VudGlmeShlbmQgLSBzdGFydCwgYnVmZmVyZWRFbmQpOwogICAgfQoKICAgIC8vIHJlbW92ZSB1bnVzZWQgYnVmZmVyZWQgcmFuZ2UgZWxlbWVudHMKICAgIGZvciAodmFyIGkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPiBidWZmZXJlZC5sZW5ndGg7IGktLSkgewogICAgICB0aGlzLmVsXy5yZW1vdmVDaGlsZChjaGlsZHJlbltpIC0gMV0pOwogICAgfQogIH07CgogIHJldHVybiBMb2FkUHJvZ3Jlc3NCYXI7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ0xvYWRQcm9ncmVzc0JhcicsIExvYWRQcm9ncmVzc0Jhcik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IExvYWRQcm9ncmVzc0JhcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vLi4vdXRpbHMvZG9tLmpzIjoxMjh9XSw3NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBtb3VzZS10aW1lLWRpc3BsYXkuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uLy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7Cgp2YXIgX3V0aWxzRG9tSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9kb20uanMnKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb21Kcyk7Cgp2YXIgX3V0aWxzRm5KcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNGb3JtYXRUaW1lSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9mb3JtYXQtdGltZS5qcycpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0Zvcm1hdFRpbWVKcyk7Cgp2YXIgX2xvZGFzaENvbXBhdEZ1bmN0aW9uVGhyb3R0bGUgPSBfZGVyZXFfKCdsb2Rhc2gtY29tcGF0L2Z1bmN0aW9uL3Rocm90dGxlJyk7Cgp2YXIgX2xvZGFzaENvbXBhdEZ1bmN0aW9uVGhyb3R0bGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9kYXNoQ29tcGF0RnVuY3Rpb25UaHJvdHRsZSk7CgovKioKICogVGhlIE1vdXNlIFRpbWUgRGlzcGxheSBjb21wb25lbnQgc2hvd3MgdGhlIHRpbWUgeW91IHdpbGwgc2VlayB0bwogKiB3aGVuIGhvdmVyaW5nIG92ZXIgdGhlIHByb2dyZXNzIGJhcgogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBNb3VzZVRpbWVEaXNwbGF5CiAqLwoKdmFyIE1vdXNlVGltZURpc3BsYXkgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoTW91c2VUaW1lRGlzcGxheSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIE1vdXNlVGltZURpc3BsYXkocGxheWVyLCBvcHRpb25zKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNb3VzZVRpbWVEaXNwbGF5KTsKCiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB0aGlzLnVwZGF0ZSgwLCAwKTsKCiAgICBwbGF5ZXIub24oJ3JlYWR5JywgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5vbihwbGF5ZXIuY29udHJvbEJhci5wcm9ncmVzc0NvbnRyb2wuZWwoKSwgJ21vdXNlbW92ZScsIF9sb2Rhc2hDb21wYXRGdW5jdGlvblRocm90dGxlMlsnZGVmYXVsdCddKEZuLmJpbmQoX3RoaXMsIF90aGlzLmhhbmRsZU1vdXNlTW92ZSksIDI1KSk7CiAgICB9KTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBNb3VzZVRpbWVEaXNwbGF5LnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgcmV0dXJuIF9Db21wb25lbnQucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLW1vdXNlLWRpc3BsYXknCiAgICB9KTsKICB9OwoKICBNb3VzZVRpbWVEaXNwbGF5LnByb3RvdHlwZS5oYW5kbGVNb3VzZU1vdmUgPSBmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmUoZXZlbnQpIHsKICAgIHZhciBkdXJhdGlvbiA9IHRoaXMucGxheWVyXy5kdXJhdGlvbigpOwogICAgdmFyIG5ld1RpbWUgPSB0aGlzLmNhbGN1bGF0ZURpc3RhbmNlKGV2ZW50KSAqIGR1cmF0aW9uOwogICAgdmFyIHBvc2l0aW9uID0gZXZlbnQucGFnZVggLSBEb20uZmluZEVsUG9zaXRpb24odGhpcy5lbCgpLnBhcmVudE5vZGUpLmxlZnQ7CgogICAgdGhpcy51cGRhdGUobmV3VGltZSwgcG9zaXRpb24pOwogIH07CgogIE1vdXNlVGltZURpc3BsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShuZXdUaW1lLCBwb3NpdGlvbikgewogICAgdmFyIHRpbWUgPSBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J10obmV3VGltZSwgdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCkpOwoKICAgIHRoaXMuZWwoKS5zdHlsZS5sZWZ0ID0gcG9zaXRpb24gKyAncHgnOwogICAgdGhpcy5lbCgpLnNldEF0dHJpYnV0ZSgnZGF0YS1jdXJyZW50LXRpbWUnLCB0aW1lKTsKICB9OwoKICBNb3VzZVRpbWVEaXNwbGF5LnByb3RvdHlwZS5jYWxjdWxhdGVEaXN0YW5jZSA9IGZ1bmN0aW9uIGNhbGN1bGF0ZURpc3RhbmNlKGV2ZW50KSB7CiAgICByZXR1cm4gRG9tLmdldFBvaW50ZXJQb3NpdGlvbih0aGlzLmVsKCkucGFyZW50Tm9kZSwgZXZlbnQpLng7CiAgfTsKCiAgcmV0dXJuIE1vdXNlVGltZURpc3BsYXk7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ01vdXNlVGltZURpc3BsYXknLCBNb3VzZVRpbWVEaXNwbGF5KTsKZXhwb3J0c1snZGVmYXVsdCddID0gTW91c2VUaW1lRGlzcGxheTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uLy4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzIjoxMzEsImxvZGFzaC1jb21wYXQvZnVuY3Rpb24vdGhyb3R0bGUiOjd9XSw3NTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBwbGF5LXByb2dyZXNzLWJhci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzJyk7Cgp2YXIgX3V0aWxzRm9ybWF0VGltZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzRm9ybWF0VGltZUpzKTsKCi8qKgogKiBTaG93cyBwbGF5IHByb2dyZXNzCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBDb21wb25lbnQKICogQGNsYXNzIFBsYXlQcm9ncmVzc0JhcgogKi8KCnZhciBQbGF5UHJvZ3Jlc3NCYXIgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoUGxheVByb2dyZXNzQmFyLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gUGxheVByb2dyZXNzQmFyKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBsYXlQcm9ncmVzc0Jhcik7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLnVwZGF0ZURhdGFBdHRyKCk7CiAgICB0aGlzLm9uKHBsYXllciwgJ3RpbWV1cGRhdGUnLCB0aGlzLnVwZGF0ZURhdGFBdHRyKTsKICAgIHBsYXllci5yZWFkeShGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlRGF0YUF0dHIpKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBQbGF5UHJvZ3Jlc3NCYXIucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtcGxheS1wcm9ncmVzcyB2anMtc2xpZGVyLWJhcicsCiAgICAgIGlubmVySFRNTDogJzxzcGFuIGNsYXNzPSJ2anMtY29udHJvbC10ZXh0Ij48c3Bhbj4nICsgdGhpcy5sb2NhbGl6ZSgnUHJvZ3Jlc3MnKSArICc8L3NwYW4+OiAwJTwvc3Bhbj4nCiAgICB9KTsKICB9OwoKICBQbGF5UHJvZ3Jlc3NCYXIucHJvdG90eXBlLnVwZGF0ZURhdGFBdHRyID0gZnVuY3Rpb24gdXBkYXRlRGF0YUF0dHIoKSB7CiAgICB2YXIgdGltZSA9IHRoaXMucGxheWVyXy5zY3J1YmJpbmcoKSA/IHRoaXMucGxheWVyXy5nZXRDYWNoZSgpLmN1cnJlbnRUaW1lIDogdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCk7CiAgICB0aGlzLmVsXy5zZXRBdHRyaWJ1dGUoJ2RhdGEtY3VycmVudC10aW1lJywgX3V0aWxzRm9ybWF0VGltZUpzMlsnZGVmYXVsdCddKHRpbWUsIHRoaXMucGxheWVyXy5kdXJhdGlvbigpKSk7CiAgfTsKCiAgcmV0dXJuIFBsYXlQcm9ncmVzc0JhcjsKfSkoX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnUGxheVByb2dyZXNzQmFyJywgUGxheVByb2dyZXNzQmFyKTsKZXhwb3J0c1snZGVmYXVsdCddID0gUGxheVByb2dyZXNzQmFyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuLi8uLi91dGlscy9mbi5qcyI6MTMwLCIuLi8uLi91dGlscy9mb3JtYXQtdGltZS5qcyI6MTMxfV0sNzY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgcHJvZ3Jlc3MtY29udHJvbC5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF9zZWVrQmFySnMgPSBfZGVyZXFfKCcuL3NlZWstYmFyLmpzJyk7Cgp2YXIgX3NlZWtCYXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWVrQmFySnMpOwoKdmFyIF9tb3VzZVRpbWVEaXNwbGF5SnMgPSBfZGVyZXFfKCcuL21vdXNlLXRpbWUtZGlzcGxheS5qcycpOwoKdmFyIF9tb3VzZVRpbWVEaXNwbGF5SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbW91c2VUaW1lRGlzcGxheUpzKTsKCi8qKgogKiBUaGUgUHJvZ3Jlc3MgQ29udHJvbCBjb21wb25lbnQgY29udGFpbnMgdGhlIHNlZWsgYmFyLCBsb2FkIHByb2dyZXNzLAogKiBhbmQgcGxheSBwcm9ncmVzcwogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBQcm9ncmVzc0NvbnRyb2wKICovCgp2YXIgUHJvZ3Jlc3NDb250cm9sID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFByb2dyZXNzQ29udHJvbCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFByb2dyZXNzQ29udHJvbCgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQcm9ncmVzc0NvbnRyb2wpOwoKICAgIF9Db21wb25lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBQcm9ncmVzc0NvbnRyb2wucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtcHJvZ3Jlc3MtY29udHJvbCB2anMtY29udHJvbCcKICAgIH0pOwogIH07CgogIHJldHVybiBQcm9ncmVzc0NvbnRyb2w7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpQcm9ncmVzc0NvbnRyb2wucHJvdG90eXBlLm9wdGlvbnNfID0gewogIGNoaWxkcmVuOiBbJ3NlZWtCYXInXQp9OwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdQcm9ncmVzc0NvbnRyb2wnLCBQcm9ncmVzc0NvbnRyb2wpOwpleHBvcnRzWydkZWZhdWx0J10gPSBQcm9ncmVzc0NvbnRyb2w7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4vbW91c2UtdGltZS1kaXNwbGF5LmpzIjo3NCwiLi9zZWVrLWJhci5qcyI6Nzd9XSw3NzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBzZWVrLWJhci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3NsaWRlclNsaWRlckpzID0gX2RlcmVxXygnLi4vLi4vc2xpZGVyL3NsaWRlci5qcycpOwoKdmFyIF9zbGlkZXJTbGlkZXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zbGlkZXJTbGlkZXJKcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfbG9hZFByb2dyZXNzQmFySnMgPSBfZGVyZXFfKCcuL2xvYWQtcHJvZ3Jlc3MtYmFyLmpzJyk7Cgp2YXIgX2xvYWRQcm9ncmVzc0JhckpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvYWRQcm9ncmVzc0JhckpzKTsKCnZhciBfcGxheVByb2dyZXNzQmFySnMgPSBfZGVyZXFfKCcuL3BsYXktcHJvZ3Jlc3MtYmFyLmpzJyk7Cgp2YXIgX3BsYXlQcm9ncmVzc0JhckpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BsYXlQcm9ncmVzc0JhckpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzJyk7Cgp2YXIgX3V0aWxzRm9ybWF0VGltZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzRm9ybWF0VGltZUpzKTsKCnZhciBfb2JqZWN0QXNzaWduID0gX2RlcmVxXygnb2JqZWN0LmFzc2lnbicpOwoKdmFyIF9vYmplY3RBc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKTsKCi8qKgogKiBTZWVrIEJhciBhbmQgaG9sZGVyIGZvciB0aGUgcHJvZ3Jlc3MgYmFycwogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgU2xpZGVyCiAqIEBjbGFzcyBTZWVrQmFyCiAqLwoKdmFyIFNlZWtCYXIgPSAoZnVuY3Rpb24gKF9TbGlkZXIpIHsKICBfaW5oZXJpdHMoU2Vla0JhciwgX1NsaWRlcik7CgogIGZ1bmN0aW9uIFNlZWtCYXIocGxheWVyLCBvcHRpb25zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2Vla0Jhcik7CgogICAgX1NsaWRlci5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLm9uKHBsYXllciwgJ3RpbWV1cGRhdGUnLCB0aGlzLnVwZGF0ZUFSSUFBdHRyaWJ1dGVzKTsKICAgIHBsYXllci5yZWFkeShGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlQVJJQUF0dHJpYnV0ZXMpKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBTZWVrQmFyLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgcmV0dXJuIF9TbGlkZXIucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLXByb2dyZXNzLWhvbGRlcicKICAgIH0sIHsKICAgICAgJ2FyaWEtbGFiZWwnOiAndmlkZW8gcHJvZ3Jlc3MgYmFyJwogICAgfSk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIEFSSUEgYWNjZXNzaWJpbGl0eSBhdHRyaWJ1dGVzCiAgICoKICAgKiBAbWV0aG9kIHVwZGF0ZUFSSUFBdHRyaWJ1dGVzCiAgICovCgogIFNlZWtCYXIucHJvdG90eXBlLnVwZGF0ZUFSSUFBdHRyaWJ1dGVzID0gZnVuY3Rpb24gdXBkYXRlQVJJQUF0dHJpYnV0ZXMoKSB7CiAgICAvLyBBbGxvd3MgZm9yIHNtb290aCBzY3J1YmJpbmcsIHdoZW4gcGxheWVyIGNhbid0IGtlZXAgdXAuCiAgICB2YXIgdGltZSA9IHRoaXMucGxheWVyXy5zY3J1YmJpbmcoKSA/IHRoaXMucGxheWVyXy5nZXRDYWNoZSgpLmN1cnJlbnRUaW1lIDogdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCk7CiAgICB0aGlzLmVsXy5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCAodGhpcy5nZXRQZXJjZW50KCkgKiAxMDApLnRvRml4ZWQoMikpOyAvLyBtYWNoaW5lIHJlYWRhYmxlIHZhbHVlIG9mIHByb2dyZXNzIGJhciAocGVyY2VudGFnZSBjb21wbGV0ZSkKICAgIHRoaXMuZWxfLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J10odGltZSwgdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCkpKTsgLy8gaHVtYW4gcmVhZGFibGUgdmFsdWUgb2YgcHJvZ3Jlc3MgYmFyICh0aW1lIGNvbXBsZXRlKQogIH07CgogIC8qKgogICAqIEdldCBwZXJjZW50YWdlIG9mIHZpZGVvIHBsYXllZAogICAqCiAgICogQHJldHVybiB7TnVtYmVyfSBQZXJjZW50YWdlIHBsYXllZAogICAqIEBtZXRob2QgZ2V0UGVyY2VudAogICAqLwoKICBTZWVrQmFyLnByb3RvdHlwZS5nZXRQZXJjZW50ID0gZnVuY3Rpb24gZ2V0UGVyY2VudCgpIHsKICAgIHZhciBwZXJjZW50ID0gdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCkgLyB0aGlzLnBsYXllcl8uZHVyYXRpb24oKTsKICAgIHJldHVybiBwZXJjZW50ID49IDEgPyAxIDogcGVyY2VudDsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgbW91c2UgZG93biBvbiBzZWVrIGJhcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVNb3VzZURvd24KICAgKi8KCiAgU2Vla0Jhci5wcm90b3R5cGUuaGFuZGxlTW91c2VEb3duID0gZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duKGV2ZW50KSB7CiAgICBfU2xpZGVyLnByb3RvdHlwZS5oYW5kbGVNb3VzZURvd24uY2FsbCh0aGlzLCBldmVudCk7CgogICAgdGhpcy5wbGF5ZXJfLnNjcnViYmluZyh0cnVlKTsKCiAgICB0aGlzLnZpZGVvV2FzUGxheWluZyA9ICF0aGlzLnBsYXllcl8ucGF1c2VkKCk7CiAgICB0aGlzLnBsYXllcl8ucGF1c2UoKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgbW91c2UgbW92ZSBvbiBzZWVrIGJhcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVNb3VzZU1vdmUKICAgKi8KCiAgU2Vla0Jhci5wcm90b3R5cGUuaGFuZGxlTW91c2VNb3ZlID0gZnVuY3Rpb24gaGFuZGxlTW91c2VNb3ZlKGV2ZW50KSB7CiAgICB2YXIgbmV3VGltZSA9IHRoaXMuY2FsY3VsYXRlRGlzdGFuY2UoZXZlbnQpICogdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCk7CgogICAgLy8gRG9uJ3QgbGV0IHZpZGVvIGVuZCB3aGlsZSBzY3J1YmJpbmcuCiAgICBpZiAobmV3VGltZSA9PT0gdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCkpIHsKICAgICAgbmV3VGltZSA9IG5ld1RpbWUgLSAwLjE7CiAgICB9CgogICAgLy8gU2V0IG5ldyB0aW1lICh0ZWxsIHBsYXllciB0byBzZWVrIHRvIG5ldyB0aW1lKQogICAgdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKG5ld1RpbWUpOwogIH07CgogIC8qKgogICAqIEhhbmRsZSBtb3VzZSB1cCBvbiBzZWVrIGJhcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVNb3VzZVVwCiAgICovCgogIFNlZWtCYXIucHJvdG90eXBlLmhhbmRsZU1vdXNlVXAgPSBmdW5jdGlvbiBoYW5kbGVNb3VzZVVwKGV2ZW50KSB7CiAgICBfU2xpZGVyLnByb3RvdHlwZS5oYW5kbGVNb3VzZVVwLmNhbGwodGhpcywgZXZlbnQpOwoKICAgIHRoaXMucGxheWVyXy5zY3J1YmJpbmcoZmFsc2UpOwogICAgaWYgKHRoaXMudmlkZW9XYXNQbGF5aW5nKSB7CiAgICAgIHRoaXMucGxheWVyXy5wbGF5KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogTW92ZSBtb3JlIHF1aWNrbHkgZmFzdCBmb3J3YXJkIGZvciBrZXlib2FyZC1vbmx5IHVzZXJzCiAgICoKICAgKiBAbWV0aG9kIHN0ZXBGb3J3YXJkCiAgICovCgogIFNlZWtCYXIucHJvdG90eXBlLnN0ZXBGb3J3YXJkID0gZnVuY3Rpb24gc3RlcEZvcndhcmQoKSB7CiAgICB0aGlzLnBsYXllcl8uY3VycmVudFRpbWUodGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCkgKyA1KTsgLy8gbW9yZSBxdWlja2x5IGZhc3QgZm9yd2FyZCBmb3Iga2V5Ym9hcmQtb25seSB1c2VycwogIH07CgogIC8qKgogICAqIE1vdmUgbW9yZSBxdWlja2x5IHJld2luZCBmb3Iga2V5Ym9hcmQtb25seSB1c2VycwogICAqCiAgICogQG1ldGhvZCBzdGVwQmFjawogICAqLwoKICBTZWVrQmFyLnByb3RvdHlwZS5zdGVwQmFjayA9IGZ1bmN0aW9uIHN0ZXBCYWNrKCkgewogICAgdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKHRoaXMucGxheWVyXy5jdXJyZW50VGltZSgpIC0gNSk7IC8vIG1vcmUgcXVpY2tseSByZXdpbmQgZm9yIGtleWJvYXJkLW9ubHkgdXNlcnMKICB9OwoKICByZXR1cm4gU2Vla0JhcjsKfSkoX3NsaWRlclNsaWRlckpzMlsnZGVmYXVsdCddKTsKClNlZWtCYXIucHJvdG90eXBlLm9wdGlvbnNfID0gewogIGNoaWxkcmVuOiBbJ2xvYWRQcm9ncmVzc0JhcicsICdtb3VzZVRpbWVEaXNwbGF5JywgJ3BsYXlQcm9ncmVzc0JhciddLAogICdiYXJOYW1lJzogJ3BsYXlQcm9ncmVzc0JhcicKfTsKClNlZWtCYXIucHJvdG90eXBlLnBsYXllckV2ZW50ID0gJ3RpbWV1cGRhdGUnOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdTZWVrQmFyJywgU2Vla0Jhcik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IFNlZWtCYXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4uLy4uL3NsaWRlci9zbGlkZXIuanMiOjExMCwiLi4vLi4vdXRpbHMvZm4uanMiOjEzMCwiLi4vLi4vdXRpbHMvZm9ybWF0LXRpbWUuanMiOjEzMSwiLi9sb2FkLXByb2dyZXNzLWJhci5qcyI6NzMsIi4vcGxheS1wcm9ncmVzcy1iYXIuanMiOjc1LCJvYmplY3QuYXNzaWduIjo0NX1dLDc4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGN1c3RvbS1jb250cm9sLXNwYWNlci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfc3BhY2VySnMgPSBfZGVyZXFfKCcuL3NwYWNlci5qcycpOwoKdmFyIF9zcGFjZXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcGFjZXJKcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBTcGFjZXIgc3BlY2lmaWNhbGx5IG1lYW50IHRvIGJlIHVzZWQgYXMgYW4gaW5zZXJ0aW9uIHBvaW50IGZvciBuZXcgcGx1Z2lucywgZXRjLgogKgogKiBAZXh0ZW5kcyBTcGFjZXIKICogQGNsYXNzIEN1c3RvbUNvbnRyb2xTcGFjZXIKICovCgp2YXIgQ3VzdG9tQ29udHJvbFNwYWNlciA9IChmdW5jdGlvbiAoX1NwYWNlcikgewogIF9pbmhlcml0cyhDdXN0b21Db250cm9sU3BhY2VyLCBfU3BhY2VyKTsKCiAgZnVuY3Rpb24gQ3VzdG9tQ29udHJvbFNwYWNlcigpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDdXN0b21Db250cm9sU3BhY2VyKTsKCiAgICBfU3BhY2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgQ3VzdG9tQ29udHJvbFNwYWNlci5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1jdXN0b20tY29udHJvbC1zcGFjZXIgJyArIF9TcGFjZXIucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgQ3VzdG9tQ29udHJvbFNwYWNlci5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHZhciBlbCA9IF9TcGFjZXIucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgewogICAgICBjbGFzc05hbWU6IHRoaXMuYnVpbGRDU1NDbGFzcygpCiAgICB9KTsKCiAgICAvLyBOby1mbGV4L3RhYmxlLWNlbGwgbW9kZSByZXF1aXJlcyB0aGVyZSBiZSBzb21lIGNvbnRlbnQKICAgIC8vIGluIHRoZSBjZWxsIHRvIGZpbGwgdGhlIHJlbWFpbmluZyBzcGFjZSBvZiB0aGUgdGFibGUuCiAgICBlbC5pbm5lckhUTUwgPSAnJm5ic3A7JzsKICAgIHJldHVybiBlbDsKICB9OwoKICByZXR1cm4gQ3VzdG9tQ29udHJvbFNwYWNlcjsKfSkoX3NwYWNlckpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnQ3VzdG9tQ29udHJvbFNwYWNlcicsIEN1c3RvbUNvbnRyb2xTcGFjZXIpOwpleHBvcnRzWydkZWZhdWx0J10gPSBDdXN0b21Db250cm9sU3BhY2VyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuL3NwYWNlci5qcyI6Nzl9XSw3OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBzcGFjZXIuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBKdXN0IGFuIGVtcHR5IHNwYWNlciBlbGVtZW50IHRoYXQgY2FuIGJlIHVzZWQgYXMgYW4gYXBwZW5kIHBvaW50IGZvciBwbHVnaW5zLCBldGMuCiAqIEFsc28gY2FuIGJlIHVzZWQgdG8gY3JlYXRlIHNwYWNlIGJldHdlZW4gZWxlbWVudHMgd2hlbiBuZWNlc3NhcnkuCiAqCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgU3BhY2VyCiAqLwoKdmFyIFNwYWNlciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhTcGFjZXIsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBTcGFjZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3BhY2VyKTsKCiAgICBfQ29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgU3BhY2VyLnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIHJldHVybiAndmpzLXNwYWNlciAnICsgX0NvbXBvbmVudC5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcy5jYWxsKHRoaXMpOwogIH07CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBTcGFjZXIucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6IHRoaXMuYnVpbGRDU1NDbGFzcygpCiAgICB9KTsKICB9OwoKICByZXR1cm4gU3BhY2VyOwp9KShfY29tcG9uZW50SnMyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdTcGFjZXInLCBTcGFjZXIpOwoKZXhwb3J0c1snZGVmYXVsdCddID0gU3BhY2VyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1fV0sODA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgY2FwdGlvbi1zZXR0aW5ncy1tZW51LWl0ZW0uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3RleHRUcmFja01lbnVJdGVtSnMgPSBfZGVyZXFfKCcuL3RleHQtdHJhY2stbWVudS1pdGVtLmpzJyk7Cgp2YXIgX3RleHRUcmFja01lbnVJdGVtSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGV4dFRyYWNrTWVudUl0ZW1Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBUaGUgbWVudSBpdGVtIGZvciBjYXB0aW9uIHRyYWNrIHNldHRpbmdzIG1lbnUKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIFRleHRUcmFja01lbnVJdGVtCiAqIEBjbGFzcyBDYXB0aW9uU2V0dGluZ3NNZW51SXRlbQogKi8KCnZhciBDYXB0aW9uU2V0dGluZ3NNZW51SXRlbSA9IChmdW5jdGlvbiAoX1RleHRUcmFja01lbnVJdGVtKSB7CiAgX2luaGVyaXRzKENhcHRpb25TZXR0aW5nc01lbnVJdGVtLCBfVGV4dFRyYWNrTWVudUl0ZW0pOwoKICBmdW5jdGlvbiBDYXB0aW9uU2V0dGluZ3NNZW51SXRlbShwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDYXB0aW9uU2V0dGluZ3NNZW51SXRlbSk7CgogICAgb3B0aW9uc1sndHJhY2snXSA9IHsKICAgICAgJ2tpbmQnOiBvcHRpb25zWydraW5kJ10sCiAgICAgICdwbGF5ZXInOiBwbGF5ZXIsCiAgICAgICdsYWJlbCc6IG9wdGlvbnNbJ2tpbmQnXSArICcgc2V0dGluZ3MnLAogICAgICAnZGVmYXVsdCc6IGZhbHNlLAogICAgICBtb2RlOiAnZGlzYWJsZWQnCiAgICB9OwoKICAgIF9UZXh0VHJhY2tNZW51SXRlbS5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLmFkZENsYXNzKCd2anMtdGV4dHRyYWNrLXNldHRpbmdzJyk7CiAgfQoKICAvKioKICAgKiBIYW5kbGUgY2xpY2sgb24gbWVudSBpdGVtCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUNsaWNrCiAgICovCgogIENhcHRpb25TZXR0aW5nc01lbnVJdGVtLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgdGhpcy5wbGF5ZXIoKS5nZXRDaGlsZCgndGV4dFRyYWNrU2V0dGluZ3MnKS5zaG93KCk7CiAgfTsKCiAgcmV0dXJuIENhcHRpb25TZXR0aW5nc01lbnVJdGVtOwp9KShfdGV4dFRyYWNrTWVudUl0ZW1KczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ0NhcHRpb25TZXR0aW5nc01lbnVJdGVtJywgQ2FwdGlvblNldHRpbmdzTWVudUl0ZW0pOwpleHBvcnRzWydkZWZhdWx0J10gPSBDYXB0aW9uU2V0dGluZ3NNZW51SXRlbTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi90ZXh0LXRyYWNrLW1lbnUtaXRlbS5qcyI6ODd9XSw4MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBjYXB0aW9ucy1idXR0b24uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3RleHRUcmFja0J1dHRvbkpzID0gX2RlcmVxXygnLi90ZXh0LXRyYWNrLWJ1dHRvbi5qcycpOwoKdmFyIF90ZXh0VHJhY2tCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZXh0VHJhY2tCdXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfY2FwdGlvblNldHRpbmdzTWVudUl0ZW1KcyA9IF9kZXJlcV8oJy4vY2FwdGlvbi1zZXR0aW5ncy1tZW51LWl0ZW0uanMnKTsKCnZhciBfY2FwdGlvblNldHRpbmdzTWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jYXB0aW9uU2V0dGluZ3NNZW51SXRlbUpzKTsKCi8qKgogKiBUaGUgYnV0dG9uIGNvbXBvbmVudCBmb3IgdG9nZ2xpbmcgYW5kIHNlbGVjdGluZyBjYXB0aW9ucwogKgogKiBAcGFyYW0ge09iamVjdH0gcGxheWVyICBQbGF5ZXIgb2JqZWN0CiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyBPYmplY3Qgb2Ygb3B0aW9uIG5hbWVzIGFuZCB2YWx1ZXMKICogQHBhcmFtIHtGdW5jdGlvbj19IHJlYWR5ICAgIFJlYWR5IGNhbGxiYWNrIGZ1bmN0aW9uCiAqIEBleHRlbmRzIFRleHRUcmFja0J1dHRvbgogKiBAY2xhc3MgQ2FwdGlvbnNCdXR0b24KICovCgp2YXIgQ2FwdGlvbnNCdXR0b24gPSAoZnVuY3Rpb24gKF9UZXh0VHJhY2tCdXR0b24pIHsKICBfaW5oZXJpdHMoQ2FwdGlvbnNCdXR0b24sIF9UZXh0VHJhY2tCdXR0b24pOwoKICBmdW5jdGlvbiBDYXB0aW9uc0J1dHRvbihwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2FwdGlvbnNCdXR0b24pOwoKICAgIF9UZXh0VHJhY2tCdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KTsKICAgIHRoaXMuZWxfLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDYXB0aW9ucyBNZW51Jyk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgQ2FwdGlvbnNCdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MgPSBmdW5jdGlvbiBidWlsZENTU0NsYXNzKCkgewogICAgcmV0dXJuICd2anMtY2FwdGlvbnMtYnV0dG9uICcgKyBfVGV4dFRyYWNrQnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIGNhcHRpb24gbWVudSBpdGVtcwogICAqCiAgICogQG1ldGhvZCB1cGRhdGUKICAgKi8KCiAgQ2FwdGlvbnNCdXR0b24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgIHZhciB0aHJlc2hvbGQgPSAyOwogICAgX1RleHRUcmFja0J1dHRvbi5wcm90b3R5cGUudXBkYXRlLmNhbGwodGhpcyk7CgogICAgLy8gaWYgbmF0aXZlLCB0aGVuIHRocmVzaG9sZCBpcyAxIGJlY2F1c2Ugbm8gc2V0dGluZ3MgYnV0dG9uCiAgICBpZiAodGhpcy5wbGF5ZXIoKS50ZWNoXyAmJiB0aGlzLnBsYXllcigpLnRlY2hfWydmZWF0dXJlc05hdGl2ZVRleHRUcmFja3MnXSkgewogICAgICB0aHJlc2hvbGQgPSAxOwogICAgfQoKICAgIGlmICh0aGlzLml0ZW1zICYmIHRoaXMuaXRlbXMubGVuZ3RoID4gdGhyZXNob2xkKSB7CiAgICAgIHRoaXMuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5oaWRlKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIGNhcHRpb24gbWVudSBpdGVtcwogICAqCiAgICogQHJldHVybiB7QXJyYXl9IEFycmF5IG9mIG1lbnUgaXRlbXMKICAgKiBAbWV0aG9kIGNyZWF0ZUl0ZW1zCiAgICovCgogIENhcHRpb25zQnV0dG9uLnByb3RvdHlwZS5jcmVhdGVJdGVtcyA9IGZ1bmN0aW9uIGNyZWF0ZUl0ZW1zKCkgewogICAgdmFyIGl0ZW1zID0gW107CgogICAgaWYgKCEodGhpcy5wbGF5ZXIoKS50ZWNoXyAmJiB0aGlzLnBsYXllcigpLnRlY2hfWydmZWF0dXJlc05hdGl2ZVRleHRUcmFja3MnXSkpIHsKICAgICAgaXRlbXMucHVzaChuZXcgX2NhcHRpb25TZXR0aW5nc01lbnVJdGVtSnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXJfLCB7ICdraW5kJzogdGhpcy5raW5kXyB9KSk7CiAgICB9CgogICAgcmV0dXJuIF9UZXh0VHJhY2tCdXR0b24ucHJvdG90eXBlLmNyZWF0ZUl0ZW1zLmNhbGwodGhpcywgaXRlbXMpOwogIH07CgogIHJldHVybiBDYXB0aW9uc0J1dHRvbjsKfSkoX3RleHRUcmFja0J1dHRvbkpzMlsnZGVmYXVsdCddKTsKCkNhcHRpb25zQnV0dG9uLnByb3RvdHlwZS5raW5kXyA9ICdjYXB0aW9ucyc7CkNhcHRpb25zQnV0dG9uLnByb3RvdHlwZS5jb250cm9sVGV4dF8gPSAnQ2FwdGlvbnMnOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdDYXB0aW9uc0J1dHRvbicsIENhcHRpb25zQnV0dG9uKTsKZXhwb3J0c1snZGVmYXVsdCddID0gQ2FwdGlvbnNCdXR0b247Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4vY2FwdGlvbi1zZXR0aW5ncy1tZW51LWl0ZW0uanMiOjgwLCIuL3RleHQtdHJhY2stYnV0dG9uLmpzIjo4Nn1dLDgyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGNoYXB0ZXJzLWJ1dHRvbi5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3RleHRUcmFja0J1dHRvbkpzID0gX2RlcmVxXygnLi90ZXh0LXRyYWNrLWJ1dHRvbi5qcycpOwoKdmFyIF90ZXh0VHJhY2tCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZXh0VHJhY2tCdXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfdGV4dFRyYWNrTWVudUl0ZW1KcyA9IF9kZXJlcV8oJy4vdGV4dC10cmFjay1tZW51LWl0ZW0uanMnKTsKCnZhciBfdGV4dFRyYWNrTWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZXh0VHJhY2tNZW51SXRlbUpzKTsKCnZhciBfY2hhcHRlcnNUcmFja01lbnVJdGVtSnMgPSBfZGVyZXFfKCcuL2NoYXB0ZXJzLXRyYWNrLW1lbnUtaXRlbS5qcycpOwoKdmFyIF9jaGFwdGVyc1RyYWNrTWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFwdGVyc1RyYWNrTWVudUl0ZW1Kcyk7Cgp2YXIgX21lbnVNZW51SnMgPSBfZGVyZXFfKCcuLi8uLi9tZW51L21lbnUuanMnKTsKCnZhciBfbWVudU1lbnVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUpzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2RvbS5qcycpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbUpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF91dGlsc1RvVGl0bGVDYXNlSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy90by10aXRsZS1jYXNlLmpzJyk7Cgp2YXIgX3V0aWxzVG9UaXRsZUNhc2VKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc1RvVGl0bGVDYXNlSnMpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKLyoqCiAqIFRoZSBidXR0b24gY29tcG9uZW50IGZvciB0b2dnbGluZyBhbmQgc2VsZWN0aW5nIGNoYXB0ZXJzCiAqIENoYXB0ZXJzIGFjdCBtdWNoIGRpZmZlcmVudGx5IHRoYW4gb3RoZXIgdGV4dCB0cmFja3MKICogQ3VlcyBhcmUgbmF2aWdhdGlvbiB2cy4gb3RoZXIgdHJhY2tzIG9mIGFsdGVybmF0aXZlIGxhbmd1YWdlcwogKgogKiBAcGFyYW0ge09iamVjdH0gcGxheWVyICBQbGF5ZXIgb2JqZWN0CiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyBPYmplY3Qgb2Ygb3B0aW9uIG5hbWVzIGFuZCB2YWx1ZXMKICogQHBhcmFtIHtGdW5jdGlvbj19IHJlYWR5ICAgIFJlYWR5IGNhbGxiYWNrIGZ1bmN0aW9uCiAqIEBleHRlbmRzIFRleHRUcmFja0J1dHRvbgogKiBAY2xhc3MgQ2hhcHRlcnNCdXR0b24KICovCgp2YXIgQ2hhcHRlcnNCdXR0b24gPSAoZnVuY3Rpb24gKF9UZXh0VHJhY2tCdXR0b24pIHsKICBfaW5oZXJpdHMoQ2hhcHRlcnNCdXR0b24sIF9UZXh0VHJhY2tCdXR0b24pOwoKICBmdW5jdGlvbiBDaGFwdGVyc0J1dHRvbihwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hhcHRlcnNCdXR0b24pOwoKICAgIF9UZXh0VHJhY2tCdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KTsKICAgIHRoaXMuZWxfLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDaGFwdGVycyBNZW51Jyk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgQ2hhcHRlcnNCdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MgPSBmdW5jdGlvbiBidWlsZENTU0NsYXNzKCkgewogICAgcmV0dXJuICd2anMtY2hhcHRlcnMtYnV0dG9uICcgKyBfVGV4dFRyYWNrQnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIGEgbWVudSBpdGVtIGZvciBlYWNoIHRleHQgdHJhY2sKICAgKgogICAqIEByZXR1cm4ge0FycmF5fSBBcnJheSBvZiBtZW51IGl0ZW1zCiAgICogQG1ldGhvZCBjcmVhdGVJdGVtcwogICAqLwoKICBDaGFwdGVyc0J1dHRvbi5wcm90b3R5cGUuY3JlYXRlSXRlbXMgPSBmdW5jdGlvbiBjcmVhdGVJdGVtcygpIHsKICAgIHZhciBpdGVtcyA9IFtdOwoKICAgIHZhciB0cmFja3MgPSB0aGlzLnBsYXllcl8udGV4dFRyYWNrcygpOwoKICAgIGlmICghdHJhY2tzKSB7CiAgICAgIHJldHVybiBpdGVtczsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgdHJhY2sgPSB0cmFja3NbaV07CiAgICAgIGlmICh0cmFja1sna2luZCddID09PSB0aGlzLmtpbmRfKSB7CiAgICAgICAgaXRlbXMucHVzaChuZXcgX3RleHRUcmFja01lbnVJdGVtSnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXJfLCB7CiAgICAgICAgICAndHJhY2snOiB0cmFjawogICAgICAgIH0pKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBpdGVtczsKICB9OwoKICAvKioKICAgKiBDcmVhdGUgbWVudSBmcm9tIGNoYXB0ZXIgYnV0dG9ucwogICAqCiAgICogQHJldHVybiB7TWVudX0gTWVudSBvZiBjaGFwdGVyIGJ1dHRvbnMKICAgKiBAbWV0aG9kIGNyZWF0ZU1lbnUKICAgKi8KCiAgQ2hhcHRlcnNCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU1lbnUgPSBmdW5jdGlvbiBjcmVhdGVNZW51KCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgdHJhY2tzID0gdGhpcy5wbGF5ZXJfLnRleHRUcmFja3MoKSB8fCBbXTsKICAgIHZhciBjaGFwdGVyc1RyYWNrID0gdW5kZWZpbmVkOwogICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwLCBfbGVuZ3RoID0gdHJhY2tzLmxlbmd0aDsgaSA8IF9sZW5ndGg7IGkrKykgewogICAgICB2YXIgdHJhY2sgPSB0cmFja3NbaV07CgogICAgICBpZiAodHJhY2tbJ2tpbmQnXSA9PT0gdGhpcy5raW5kXykgewogICAgICAgIGNoYXB0ZXJzVHJhY2sgPSB0cmFjazsKCiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgbWVudSA9IHRoaXMubWVudTsKICAgIGlmIChtZW51ID09PSB1bmRlZmluZWQpIHsKICAgICAgbWVudSA9IG5ldyBfbWVudU1lbnVKczJbJ2RlZmF1bHQnXSh0aGlzLnBsYXllcl8pOwogICAgICBtZW51LmNvbnRlbnRFbCgpLmFwcGVuZENoaWxkKERvbS5jcmVhdGVFbCgnbGknLCB7CiAgICAgICAgY2xhc3NOYW1lOiAndmpzLW1lbnUtdGl0bGUnLAogICAgICAgIGlubmVySFRNTDogX3V0aWxzVG9UaXRsZUNhc2VKczJbJ2RlZmF1bHQnXSh0aGlzLmtpbmRfKSwKICAgICAgICB0YWJJbmRleDogLTEKICAgICAgfSkpOwogICAgfQoKICAgIGlmIChjaGFwdGVyc1RyYWNrICYmIGNoYXB0ZXJzVHJhY2suY3VlcyA9PSBudWxsKSB7CiAgICAgIGNoYXB0ZXJzVHJhY2tbJ21vZGUnXSA9ICdoaWRkZW4nOwoKICAgICAgdmFyIHJlbW90ZVRleHRUcmFja0VsID0gdGhpcy5wbGF5ZXJfLnJlbW90ZVRleHRUcmFja0VscygpLmdldFRyYWNrRWxlbWVudEJ5VHJhY2tfKGNoYXB0ZXJzVHJhY2spOwoKICAgICAgaWYgKHJlbW90ZVRleHRUcmFja0VsKSB7CiAgICAgICAgcmVtb3RlVGV4dFRyYWNrRWwuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZSgpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgaWYgKGNoYXB0ZXJzVHJhY2sgJiYgY2hhcHRlcnNUcmFjay5jdWVzICYmIGNoYXB0ZXJzVHJhY2suY3Vlcy5sZW5ndGggPiAwKSB7CiAgICAgIHZhciBjdWVzID0gY2hhcHRlcnNUcmFja1snY3VlcyddLAogICAgICAgICAgY3VlID0gdW5kZWZpbmVkOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjdWVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGN1ZSA9IGN1ZXNbaV07CgogICAgICAgIHZhciBtaSA9IG5ldyBfY2hhcHRlcnNUcmFja01lbnVJdGVtSnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXJfLCB7CiAgICAgICAgICAndHJhY2snOiBjaGFwdGVyc1RyYWNrLAogICAgICAgICAgJ2N1ZSc6IGN1ZQogICAgICAgIH0pOwoKICAgICAgICBpdGVtcy5wdXNoKG1pKTsKCiAgICAgICAgbWVudS5hZGRDaGlsZChtaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuYWRkQ2hpbGQobWVudSk7CiAgICB9CgogICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID4gMCkgewogICAgICB0aGlzLnNob3coKTsKICAgIH0KCiAgICByZXR1cm4gbWVudTsKICB9OwoKICByZXR1cm4gQ2hhcHRlcnNCdXR0b247Cn0pKF90ZXh0VHJhY2tCdXR0b25KczJbJ2RlZmF1bHQnXSk7CgpDaGFwdGVyc0J1dHRvbi5wcm90b3R5cGUua2luZF8gPSAnY2hhcHRlcnMnOwpDaGFwdGVyc0J1dHRvbi5wcm90b3R5cGUuY29udHJvbFRleHRfID0gJ0NoYXB0ZXJzJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnQ2hhcHRlcnNCdXR0b24nLCBDaGFwdGVyc0J1dHRvbik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IENoYXB0ZXJzQnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuLi8uLi9tZW51L21lbnUuanMiOjEwNCwiLi4vLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uLy4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uLy4uL3V0aWxzL3RvLXRpdGxlLWNhc2UuanMiOjEzNywiLi9jaGFwdGVycy10cmFjay1tZW51LWl0ZW0uanMiOjgzLCIuL3RleHQtdHJhY2stYnV0dG9uLmpzIjo4NiwiLi90ZXh0LXRyYWNrLW1lbnUtaXRlbS5qcyI6ODcsImdsb2JhbC93aW5kb3ciOjJ9XSw4MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBjaGFwdGVycy10cmFjay1tZW51LWl0ZW0uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9tZW51TWVudUl0ZW1KcyA9IF9kZXJlcV8oJy4uLy4uL21lbnUvbWVudS1pdGVtLmpzJyk7Cgp2YXIgX21lbnVNZW51SXRlbUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lbnVNZW51SXRlbUpzKTsKCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7CgovKioKICogVGhlIGNoYXB0ZXIgdHJhY2sgbWVudSBpdGVtCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBNZW51SXRlbQogKiBAY2xhc3MgQ2hhcHRlcnNUcmFja01lbnVJdGVtCiAqLwoKdmFyIENoYXB0ZXJzVHJhY2tNZW51SXRlbSA9IChmdW5jdGlvbiAoX01lbnVJdGVtKSB7CiAgX2luaGVyaXRzKENoYXB0ZXJzVHJhY2tNZW51SXRlbSwgX01lbnVJdGVtKTsKCiAgZnVuY3Rpb24gQ2hhcHRlcnNUcmFja01lbnVJdGVtKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENoYXB0ZXJzVHJhY2tNZW51SXRlbSk7CgogICAgdmFyIHRyYWNrID0gb3B0aW9uc1sndHJhY2snXTsKICAgIHZhciBjdWUgPSBvcHRpb25zWydjdWUnXTsKICAgIHZhciBjdXJyZW50VGltZSA9IHBsYXllci5jdXJyZW50VGltZSgpOwoKICAgIC8vIE1vZGlmeSBvcHRpb25zIGZvciBwYXJlbnQgTWVudUl0ZW0gY2xhc3MncyBpbml0LgogICAgb3B0aW9uc1snbGFiZWwnXSA9IGN1ZS50ZXh0OwogICAgb3B0aW9uc1snc2VsZWN0ZWQnXSA9IGN1ZVsnc3RhcnRUaW1lJ10gPD0gY3VycmVudFRpbWUgJiYgY3VycmVudFRpbWUgPCBjdWVbJ2VuZFRpbWUnXTsKICAgIF9NZW51SXRlbS5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgdGhpcy50cmFjayA9IHRyYWNrOwogICAgdGhpcy5jdWUgPSBjdWU7CiAgICB0cmFjay5hZGRFdmVudExpc3RlbmVyKCdjdWVjaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlKSk7CiAgfQoKICAvKioKICAgKiBIYW5kbGUgY2xpY2sgb24gbWVudSBpdGVtCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUNsaWNrCiAgICovCgogIENoYXB0ZXJzVHJhY2tNZW51SXRlbS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIF9NZW51SXRlbS5wcm90b3R5cGUuaGFuZGxlQ2xpY2suY2FsbCh0aGlzKTsKICAgIHRoaXMucGxheWVyXy5jdXJyZW50VGltZSh0aGlzLmN1ZS5zdGFydFRpbWUpOwogICAgdGhpcy51cGRhdGUodGhpcy5jdWUuc3RhcnRUaW1lKTsKICB9OwoKICAvKioKICAgKiBVcGRhdGUgY2hhcHRlciBtZW51IGl0ZW0KICAgKgogICAqIEBtZXRob2QgdXBkYXRlCiAgICovCgogIENoYXB0ZXJzVHJhY2tNZW51SXRlbS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKCkgewogICAgdmFyIGN1ZSA9IHRoaXMuY3VlOwogICAgdmFyIGN1cnJlbnRUaW1lID0gdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCk7CgogICAgLy8gdmpzLmxvZyhjdXJyZW50VGltZSwgY3VlLnN0YXJ0VGltZSk7CiAgICB0aGlzLnNlbGVjdGVkKGN1ZVsnc3RhcnRUaW1lJ10gPD0gY3VycmVudFRpbWUgJiYgY3VycmVudFRpbWUgPCBjdWVbJ2VuZFRpbWUnXSk7CiAgfTsKCiAgcmV0dXJuIENoYXB0ZXJzVHJhY2tNZW51SXRlbTsKfSkoX21lbnVNZW51SXRlbUpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnQ2hhcHRlcnNUcmFja01lbnVJdGVtJywgQ2hhcHRlcnNUcmFja01lbnVJdGVtKTsKZXhwb3J0c1snZGVmYXVsdCddID0gQ2hhcHRlcnNUcmFja01lbnVJdGVtOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuLi8uLi9tZW51L21lbnUtaXRlbS5qcyI6MTAzLCIuLi8uLi91dGlscy9mbi5qcyI6MTMwfV0sODQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgb2ZmLXRleHQtdHJhY2stbWVudS1pdGVtLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF90ZXh0VHJhY2tNZW51SXRlbUpzID0gX2RlcmVxXygnLi90ZXh0LXRyYWNrLW1lbnUtaXRlbS5qcycpOwoKdmFyIF90ZXh0VHJhY2tNZW51SXRlbUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RleHRUcmFja01lbnVJdGVtSnMpOwoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uLy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7CgovKioKICogQSBzcGVjaWFsIG1lbnUgaXRlbSBmb3IgdHVybmluZyBvZiBhIHNwZWNpZmljIHR5cGUgb2YgdGV4dCB0cmFjawogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgVGV4dFRyYWNrTWVudUl0ZW0KICogQGNsYXNzIE9mZlRleHRUcmFja01lbnVJdGVtCiAqLwoKdmFyIE9mZlRleHRUcmFja01lbnVJdGVtID0gKGZ1bmN0aW9uIChfVGV4dFRyYWNrTWVudUl0ZW0pIHsKICBfaW5oZXJpdHMoT2ZmVGV4dFRyYWNrTWVudUl0ZW0sIF9UZXh0VHJhY2tNZW51SXRlbSk7CgogIGZ1bmN0aW9uIE9mZlRleHRUcmFja01lbnVJdGVtKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9mZlRleHRUcmFja01lbnVJdGVtKTsKCiAgICAvLyBDcmVhdGUgcHNldWRvIHRyYWNrIGluZm8KICAgIC8vIFJlcXVpcmVzIG9wdGlvbnNbJ2tpbmQnXQogICAgb3B0aW9uc1sndHJhY2snXSA9IHsKICAgICAgJ2tpbmQnOiBvcHRpb25zWydraW5kJ10sCiAgICAgICdwbGF5ZXInOiBwbGF5ZXIsCiAgICAgICdsYWJlbCc6IG9wdGlvbnNbJ2tpbmQnXSArICcgb2ZmJywKICAgICAgJ2RlZmF1bHQnOiBmYWxzZSwKICAgICAgJ21vZGUnOiAnZGlzYWJsZWQnCiAgICB9OwoKICAgIF9UZXh0VHJhY2tNZW51SXRlbS5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLnNlbGVjdGVkKHRydWUpOwogIH0KCiAgLyoqCiAgICogSGFuZGxlIHRleHQgdHJhY2sgY2hhbmdlCiAgICoKICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnQgRXZlbnQgb2JqZWN0CiAgICogQG1ldGhvZCBoYW5kbGVUcmFja3NDaGFuZ2UKICAgKi8KCiAgT2ZmVGV4dFRyYWNrTWVudUl0ZW0ucHJvdG90eXBlLmhhbmRsZVRyYWNrc0NoYW5nZSA9IGZ1bmN0aW9uIGhhbmRsZVRyYWNrc0NoYW5nZShldmVudCkgewogICAgdmFyIHRyYWNrcyA9IHRoaXMucGxheWVyKCkudGV4dFRyYWNrcygpOwogICAgdmFyIHNlbGVjdGVkID0gdHJ1ZTsKCiAgICBmb3IgKHZhciBpID0gMCwgbCA9IHRyYWNrcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW2ldOwogICAgICBpZiAodHJhY2tbJ2tpbmQnXSA9PT0gdGhpcy50cmFja1sna2luZCddICYmIHRyYWNrWydtb2RlJ10gPT09ICdzaG93aW5nJykgewogICAgICAgIHNlbGVjdGVkID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnNlbGVjdGVkKHNlbGVjdGVkKTsKICB9OwoKICByZXR1cm4gT2ZmVGV4dFRyYWNrTWVudUl0ZW07Cn0pKF90ZXh0VHJhY2tNZW51SXRlbUpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnT2ZmVGV4dFRyYWNrTWVudUl0ZW0nLCBPZmZUZXh0VHJhY2tNZW51SXRlbSk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IE9mZlRleHRUcmFja01lbnVJdGVtOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuL3RleHQtdHJhY2stbWVudS1pdGVtLmpzIjo4N31dLDg1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHN1YnRpdGxlcy1idXR0b24uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3RleHRUcmFja0J1dHRvbkpzID0gX2RlcmVxXygnLi90ZXh0LXRyYWNrLWJ1dHRvbi5qcycpOwoKdmFyIF90ZXh0VHJhY2tCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZXh0VHJhY2tCdXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBUaGUgYnV0dG9uIGNvbXBvbmVudCBmb3IgdG9nZ2xpbmcgYW5kIHNlbGVjdGluZyBzdWJ0aXRsZXMKICoKICogQHBhcmFtIHtPYmplY3R9IHBsYXllciAgUGxheWVyIG9iamVjdAogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMgT2JqZWN0IG9mIG9wdGlvbiBuYW1lcyBhbmQgdmFsdWVzCiAqIEBwYXJhbSB7RnVuY3Rpb249fSByZWFkeSAgICBSZWFkeSBjYWxsYmFjayBmdW5jdGlvbgogKiBAZXh0ZW5kcyBUZXh0VHJhY2tCdXR0b24KICogQGNsYXNzIFN1YnRpdGxlc0J1dHRvbgogKi8KCnZhciBTdWJ0aXRsZXNCdXR0b24gPSAoZnVuY3Rpb24gKF9UZXh0VHJhY2tCdXR0b24pIHsKICBfaW5oZXJpdHMoU3VidGl0bGVzQnV0dG9uLCBfVGV4dFRyYWNrQnV0dG9uKTsKCiAgZnVuY3Rpb24gU3VidGl0bGVzQnV0dG9uKHBsYXllciwgb3B0aW9ucywgcmVhZHkpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdWJ0aXRsZXNCdXR0b24pOwoKICAgIF9UZXh0VHJhY2tCdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KTsKICAgIHRoaXMuZWxfLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdTdWJ0aXRsZXMgTWVudScpOwogIH0KCiAgLyoqCiAgICogQWxsb3cgc3ViIGNvbXBvbmVudHMgdG8gc3RhY2sgQ1NTIGNsYXNzIG5hbWVzCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBjb25zdHJ1Y3RlZCBjbGFzcyBuYW1lCiAgICogQG1ldGhvZCBidWlsZENTU0NsYXNzCiAgICovCgogIFN1YnRpdGxlc0J1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICByZXR1cm4gJ3Zqcy1zdWJ0aXRsZXMtYnV0dG9uICcgKyBfVGV4dFRyYWNrQnV0dG9uLnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgcmV0dXJuIFN1YnRpdGxlc0J1dHRvbjsKfSkoX3RleHRUcmFja0J1dHRvbkpzMlsnZGVmYXVsdCddKTsKClN1YnRpdGxlc0J1dHRvbi5wcm90b3R5cGUua2luZF8gPSAnc3VidGl0bGVzJzsKU3VidGl0bGVzQnV0dG9uLnByb3RvdHlwZS5jb250cm9sVGV4dF8gPSAnU3VidGl0bGVzJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnU3VidGl0bGVzQnV0dG9uJywgU3VidGl0bGVzQnV0dG9uKTsKZXhwb3J0c1snZGVmYXVsdCddID0gU3VidGl0bGVzQnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi8uLi9jb21wb25lbnQuanMiOjY1LCIuL3RleHQtdHJhY2stYnV0dG9uLmpzIjo4Nn1dLDg2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHRleHQtdHJhY2stYnV0dG9uLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfbWVudU1lbnVCdXR0b25KcyA9IF9kZXJlcV8oJy4uLy4uL21lbnUvbWVudS1idXR0b24uanMnKTsKCnZhciBfbWVudU1lbnVCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUJ1dHRvbkpzKTsKCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX3RleHRUcmFja01lbnVJdGVtSnMgPSBfZGVyZXFfKCcuL3RleHQtdHJhY2stbWVudS1pdGVtLmpzJyk7Cgp2YXIgX3RleHRUcmFja01lbnVJdGVtSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGV4dFRyYWNrTWVudUl0ZW1Kcyk7Cgp2YXIgX29mZlRleHRUcmFja01lbnVJdGVtSnMgPSBfZGVyZXFfKCcuL29mZi10ZXh0LXRyYWNrLW1lbnUtaXRlbS5qcycpOwoKdmFyIF9vZmZUZXh0VHJhY2tNZW51SXRlbUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29mZlRleHRUcmFja01lbnVJdGVtSnMpOwoKLyoqCiAqIFRoZSBiYXNlIGNsYXNzIGZvciBidXR0b25zIHRoYXQgdG9nZ2xlIHNwZWNpZmljIHRleHQgdHJhY2sgdHlwZXMgKGUuZy4gc3VidGl0bGVzKQogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgTWVudUJ1dHRvbgogKiBAY2xhc3MgVGV4dFRyYWNrQnV0dG9uCiAqLwoKdmFyIFRleHRUcmFja0J1dHRvbiA9IChmdW5jdGlvbiAoX01lbnVCdXR0b24pIHsKICBfaW5oZXJpdHMoVGV4dFRyYWNrQnV0dG9uLCBfTWVudUJ1dHRvbik7CgogIGZ1bmN0aW9uIFRleHRUcmFja0J1dHRvbihwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUZXh0VHJhY2tCdXR0b24pOwoKICAgIF9NZW51QnV0dG9uLmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB2YXIgdHJhY2tzID0gdGhpcy5wbGF5ZXJfLnRleHRUcmFja3MoKTsKCiAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGggPD0gMSkgewogICAgICB0aGlzLmhpZGUoKTsKICAgIH0KCiAgICBpZiAoIXRyYWNrcykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHVwZGF0ZUhhbmRsZXIgPSBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlKTsKICAgIHRyYWNrcy5hZGRFdmVudExpc3RlbmVyKCdyZW1vdmV0cmFjaycsIHVwZGF0ZUhhbmRsZXIpOwogICAgdHJhY2tzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHRyYWNrJywgdXBkYXRlSGFuZGxlcik7CgogICAgdGhpcy5wbGF5ZXJfLm9uKCdkaXNwb3NlJywgZnVuY3Rpb24gKCkgewogICAgICB0cmFja3MucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVtb3ZldHJhY2snLCB1cGRhdGVIYW5kbGVyKTsKICAgICAgdHJhY2tzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHRyYWNrJywgdXBkYXRlSGFuZGxlcik7CiAgICB9KTsKICB9CgogIC8vIENyZWF0ZSBhIG1lbnUgaXRlbSBmb3IgZWFjaCB0ZXh0IHRyYWNrCgogIFRleHRUcmFja0J1dHRvbi5wcm90b3R5cGUuY3JlYXRlSXRlbXMgPSBmdW5jdGlvbiBjcmVhdGVJdGVtcygpIHsKICAgIHZhciBpdGVtcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IFtdIDogYXJndW1lbnRzWzBdOwoKICAgIC8vIEFkZCBhbiBPRkYgbWVudSBpdGVtIHRvIHR1cm4gYWxsIHRyYWNrcyBvZmYKICAgIGl0ZW1zLnB1c2gobmV3IF9vZmZUZXh0VHJhY2tNZW51SXRlbUpzMlsnZGVmYXVsdCddKHRoaXMucGxheWVyXywgeyAna2luZCc6IHRoaXMua2luZF8gfSkpOwoKICAgIHZhciB0cmFja3MgPSB0aGlzLnBsYXllcl8udGV4dFRyYWNrcygpOwoKICAgIGlmICghdHJhY2tzKSB7CiAgICAgIHJldHVybiBpdGVtczsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgdHJhY2sgPSB0cmFja3NbaV07CgogICAgICAvLyBvbmx5IGFkZCB0cmFja3MgdGhhdCBhcmUgb2YgdGhlIGFwcHJvcHJpYXRlIGtpbmQgYW5kIGhhdmUgYSBsYWJlbAogICAgICBpZiAodHJhY2tbJ2tpbmQnXSA9PT0gdGhpcy5raW5kXykgewogICAgICAgIGl0ZW1zLnB1c2gobmV3IF90ZXh0VHJhY2tNZW51SXRlbUpzMlsnZGVmYXVsdCddKHRoaXMucGxheWVyXywgewogICAgICAgICAgJ3RyYWNrJzogdHJhY2sKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gaXRlbXM7CiAgfTsKCiAgcmV0dXJuIFRleHRUcmFja0J1dHRvbjsKfSkoX21lbnVNZW51QnV0dG9uSnMyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdUZXh0VHJhY2tCdXR0b24nLCBUZXh0VHJhY2tCdXR0b24pOwpleHBvcnRzWydkZWZhdWx0J10gPSBUZXh0VHJhY2tCdXR0b247Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4uLy4uL21lbnUvbWVudS1idXR0b24uanMiOjEwMiwiLi4vLi4vdXRpbHMvZm4uanMiOjEzMCwiLi9vZmYtdGV4dC10cmFjay1tZW51LWl0ZW0uanMiOjg0LCIuL3RleHQtdHJhY2stbWVudS1pdGVtLmpzIjo4N31dLDg3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHRleHQtdHJhY2stbWVudS1pdGVtLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfbWVudU1lbnVJdGVtSnMgPSBfZGVyZXFfKCcuLi8uLi9tZW51L21lbnUtaXRlbS5qcycpOwoKdmFyIF9tZW51TWVudUl0ZW1KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUl0ZW1Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7CgovKioKICogVGhlIHNwZWNpZmljIG1lbnUgaXRlbSB0eXBlIGZvciBzZWxlY3RpbmcgYSBsYW5ndWFnZSB3aXRoaW4gYSB0ZXh0IHRyYWNrIGtpbmQKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIE1lbnVJdGVtCiAqIEBjbGFzcyBUZXh0VHJhY2tNZW51SXRlbQogKi8KCnZhciBUZXh0VHJhY2tNZW51SXRlbSA9IChmdW5jdGlvbiAoX01lbnVJdGVtKSB7CiAgX2luaGVyaXRzKFRleHRUcmFja01lbnVJdGVtLCBfTWVudUl0ZW0pOwoKICBmdW5jdGlvbiBUZXh0VHJhY2tNZW51SXRlbShwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRleHRUcmFja01lbnVJdGVtKTsKCiAgICB2YXIgdHJhY2sgPSBvcHRpb25zWyd0cmFjayddOwogICAgdmFyIHRyYWNrcyA9IHBsYXllci50ZXh0VHJhY2tzKCk7CgogICAgLy8gTW9kaWZ5IG9wdGlvbnMgZm9yIHBhcmVudCBNZW51SXRlbSBjbGFzcydzIGluaXQuCiAgICBvcHRpb25zWydsYWJlbCddID0gdHJhY2tbJ2xhYmVsJ10gfHwgdHJhY2tbJ2xhbmd1YWdlJ10gfHwgJ1Vua25vd24nOwogICAgb3B0aW9uc1snc2VsZWN0ZWQnXSA9IHRyYWNrWydkZWZhdWx0J10gfHwgdHJhY2tbJ21vZGUnXSA9PT0gJ3Nob3dpbmcnOwogICAgX01lbnVJdGVtLmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB0aGlzLnRyYWNrID0gdHJhY2s7CgogICAgaWYgKHRyYWNrcykgewogICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjaGFuZ2VIYW5kbGVyID0gRm4uYmluZChfdGhpcywgX3RoaXMuaGFuZGxlVHJhY2tzQ2hhbmdlKTsKCiAgICAgICAgdHJhY2tzLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNoYW5nZUhhbmRsZXIpOwogICAgICAgIF90aGlzLm9uKCdkaXNwb3NlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgdHJhY2tzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNoYW5nZUhhbmRsZXIpOwogICAgICAgIH0pOwogICAgICB9KSgpOwogICAgfQoKICAgIC8vIGlPUzcgZG9lc24ndCBkaXNwYXRjaCBjaGFuZ2UgZXZlbnRzIHRvIFRleHRUcmFja0xpc3RzIHdoZW4gYW4KICAgIC8vIGFzc29jaWF0ZWQgdHJhY2sncyBtb2RlIGNoYW5nZXMuIFdpdGhvdXQgc29tZXRoaW5nIGxpa2UKICAgIC8vIE9iamVjdC5vYnNlcnZlKCkgKGFsc28gbm90IHByZXNlbnQgb24gaU9TNyksIGl0J3Mgbm90CiAgICAvLyBwb3NzaWJsZSB0byBkZXRlY3QgY2hhbmdlcyB0byB0aGUgbW9kZSBhdHRyaWJ1dGUgYW5kIHBvbHlmaWxsCiAgICAvLyB0aGUgY2hhbmdlIGV2ZW50LiBBcyBhIHBvb3Igc3Vic3RpdHV0ZSwgd2UgbWFudWFsbHkgZGlzcGF0Y2gKICAgIC8vIGNoYW5nZSBldmVudHMgd2hlbmV2ZXIgdGhlIGNvbnRyb2xzIG1vZGlmeSB0aGUgbW9kZS4KICAgIGlmICh0cmFja3MgJiYgdHJhY2tzLm9uY2hhbmdlID09PSB1bmRlZmluZWQpIHsKICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZXZlbnQgPSB1bmRlZmluZWQ7CgogICAgICAgIF90aGlzLm9uKFsndGFwJywgJ2NsaWNrJ10sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICh0eXBlb2YgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5FdmVudCAhPT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgLy8gQW5kcm9pZCAyLjMgdGhyb3dzIGFuIElsbGVnYWwgQ29uc3RydWN0b3IgZXJyb3IgZm9yIHdpbmRvdy5FdmVudAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGV2ZW50ID0gbmV3IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10uRXZlbnQoJ2NoYW5nZScpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHt9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFldmVudCkgewogICAgICAgICAgICBldmVudCA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFdmVudCgnRXZlbnQnKTsKICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KCdjaGFuZ2UnLCB0cnVlLCB0cnVlKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0cmFja3MuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pKCk7CiAgICB9CiAgfQoKICAvKioKICAgKiBIYW5kbGUgY2xpY2sgb24gdGV4dCB0cmFjawogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBUZXh0VHJhY2tNZW51SXRlbS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkgewogICAgdmFyIGtpbmQgPSB0aGlzLnRyYWNrWydraW5kJ107CiAgICB2YXIgdHJhY2tzID0gdGhpcy5wbGF5ZXJfLnRleHRUcmFja3MoKTsKCiAgICBfTWVudUl0ZW0ucHJvdG90eXBlLmhhbmRsZUNsaWNrLmNhbGwodGhpcywgZXZlbnQpOwoKICAgIGlmICghdHJhY2tzKSByZXR1cm47CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW2ldOwoKICAgICAgaWYgKHRyYWNrWydraW5kJ10gIT09IGtpbmQpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKHRyYWNrID09PSB0aGlzLnRyYWNrKSB7CiAgICAgICAgdHJhY2tbJ21vZGUnXSA9ICdzaG93aW5nJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmFja1snbW9kZSddID0gJ2Rpc2FibGVkJzsKICAgICAgfQogICAgfQogIH07CgogIC8qKgogICAqIEhhbmRsZSB0ZXh0IHRyYWNrIGNoYW5nZQogICAqCiAgICogQG1ldGhvZCBoYW5kbGVUcmFja3NDaGFuZ2UKICAgKi8KCiAgVGV4dFRyYWNrTWVudUl0ZW0ucHJvdG90eXBlLmhhbmRsZVRyYWNrc0NoYW5nZSA9IGZ1bmN0aW9uIGhhbmRsZVRyYWNrc0NoYW5nZShldmVudCkgewogICAgdGhpcy5zZWxlY3RlZCh0aGlzLnRyYWNrWydtb2RlJ10gPT09ICdzaG93aW5nJyk7CiAgfTsKCiAgcmV0dXJuIFRleHRUcmFja01lbnVJdGVtOwp9KShfbWVudU1lbnVJdGVtSnMyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdUZXh0VHJhY2tNZW51SXRlbScsIFRleHRUcmFja01lbnVJdGVtKTsKZXhwb3J0c1snZGVmYXVsdCddID0gVGV4dFRyYWNrTWVudUl0ZW07Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4uLy4uL21lbnUvbWVudS1pdGVtLmpzIjoxMDMsIi4uLy4uL3V0aWxzL2ZuLmpzIjoxMzAsImdsb2JhbC9kb2N1bWVudCI6MSwiZ2xvYmFsL3dpbmRvdyI6Mn1dLDg4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGN1cnJlbnQtdGltZS1kaXNwbGF5LmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzJyk7Cgp2YXIgX3V0aWxzRm9ybWF0VGltZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzRm9ybWF0VGltZUpzKTsKCi8qKgogKiBEaXNwbGF5cyB0aGUgY3VycmVudCB0aW1lCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBDb21wb25lbnQKICogQGNsYXNzIEN1cnJlbnRUaW1lRGlzcGxheQogKi8KCnZhciBDdXJyZW50VGltZURpc3BsYXkgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQ3VycmVudFRpbWVEaXNwbGF5LCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gQ3VycmVudFRpbWVEaXNwbGF5KHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEN1cnJlbnRUaW1lRGlzcGxheSk7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgdGhpcy5vbihwbGF5ZXIsICd0aW1ldXBkYXRlJywgdGhpcy51cGRhdGVDb250ZW50KTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBDdXJyZW50VGltZURpc3BsYXkucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICB2YXIgZWwgPSBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy1jdXJyZW50LXRpbWUgdmpzLXRpbWUtY29udHJvbCB2anMtY29udHJvbCcKICAgIH0pOwoKICAgIHRoaXMuY29udGVudEVsXyA9IERvbS5jcmVhdGVFbCgnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtY3VycmVudC10aW1lLWRpc3BsYXknLAogICAgICAvLyBsYWJlbCB0aGUgY3VycmVudCB0aW1lIGZvciBzY3JlZW4gcmVhZGVyIHVzZXJzCiAgICAgIGlubmVySFRNTDogJzxzcGFuIGNsYXNzPSJ2anMtY29udHJvbC10ZXh0Ij5DdXJyZW50IFRpbWUgPC9zcGFuPicgKyAnMDowMCcKICAgIH0sIHsKICAgICAgLy8gdGVsbCBzY3JlZW4gcmVhZGVycyBub3QgdG8gYXV0b21hdGljYWxseSByZWFkIHRoZSB0aW1lIGFzIGl0IGNoYW5nZXMKICAgICAgJ2FyaWEtbGl2ZSc6ICdvZmYnCiAgICB9KTsKCiAgICBlbC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnRFbF8pOwogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIFVwZGF0ZSBjdXJyZW50IHRpbWUgZGlzcGxheQogICAqCiAgICogQG1ldGhvZCB1cGRhdGVDb250ZW50CiAgICovCgogIEN1cnJlbnRUaW1lRGlzcGxheS5wcm90b3R5cGUudXBkYXRlQ29udGVudCA9IGZ1bmN0aW9uIHVwZGF0ZUNvbnRlbnQoKSB7CiAgICAvLyBBbGxvd3MgZm9yIHNtb290aCBzY3J1YmJpbmcsIHdoZW4gcGxheWVyIGNhbid0IGtlZXAgdXAuCiAgICB2YXIgdGltZSA9IHRoaXMucGxheWVyXy5zY3J1YmJpbmcoKSA/IHRoaXMucGxheWVyXy5nZXRDYWNoZSgpLmN1cnJlbnRUaW1lIDogdGhpcy5wbGF5ZXJfLmN1cnJlbnRUaW1lKCk7CiAgICB2YXIgbG9jYWxpemVkVGV4dCA9IHRoaXMubG9jYWxpemUoJ0N1cnJlbnQgVGltZScpOwogICAgdmFyIGZvcm1hdHRlZFRpbWUgPSBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J10odGltZSwgdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCkpOwogICAgdGhpcy5jb250ZW50RWxfLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0idmpzLWNvbnRyb2wtdGV4dCI+JyArIGxvY2FsaXplZFRleHQgKyAnPC9zcGFuPiAnICsgZm9ybWF0dGVkVGltZTsKICB9OwoKICByZXR1cm4gQ3VycmVudFRpbWVEaXNwbGF5Owp9KShfY29tcG9uZW50SnMyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdDdXJyZW50VGltZURpc3BsYXknLCBDdXJyZW50VGltZURpc3BsYXkpOwpleHBvcnRzWydkZWZhdWx0J10gPSBDdXJyZW50VGltZURpc3BsYXk7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uLy4uL2NvbXBvbmVudC5qcyI6NjUsIi4uLy4uL3V0aWxzL2RvbS5qcyI6MTI4LCIuLi8uLi91dGlscy9mb3JtYXQtdGltZS5qcyI6MTMxfV0sODk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgZHVyYXRpb24tZGlzcGxheS5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2RvbS5qcycpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbUpzKTsKCnZhciBfdXRpbHNGb3JtYXRUaW1lSnMgPSBfZGVyZXFfKCcuLi8uLi91dGlscy9mb3JtYXQtdGltZS5qcycpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0Zvcm1hdFRpbWVKcyk7CgovKioKICogRGlzcGxheXMgdGhlIGR1cmF0aW9uCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBDb21wb25lbnQKICogQGNsYXNzIER1cmF0aW9uRGlzcGxheQogKi8KCnZhciBEdXJhdGlvbkRpc3BsYXkgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoRHVyYXRpb25EaXNwbGF5LCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gRHVyYXRpb25EaXNwbGF5KHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIER1cmF0aW9uRGlzcGxheSk7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgLy8gdGhpcyBtaWdodCBuZWVkIHRvIGJlIGNoYW5nZWQgdG8gJ2R1cmF0aW9uY2hhbmdlJyBpbnN0ZWFkIG9mICd0aW1ldXBkYXRlJyBldmVudHVhbGx5LAogICAgLy8gaG93ZXZlciB0aGUgZHVyYXRpb25jaGFuZ2UgZXZlbnQgZmlyZXMgYmVmb3JlIHRoaXMucGxheWVyXy5kdXJhdGlvbigpIGlzIHNldCwKICAgIC8vIHNvIHRoZSB2YWx1ZSBjYW5ub3QgYmUgd3JpdHRlbiBvdXQgdXNpbmcgdGhpcyBtZXRob2QuCiAgICAvLyBPbmNlIHRoZSBvcmRlciBvZiBkdXJhdGlvbmNoYW5nZSBhbmQgdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCkgYmVpbmcgc2V0IGlzIGZpZ3VyZWQgb3V0LAogICAgLy8gdGhpcyBjYW4gYmUgdXBkYXRlZC4KICAgIHRoaXMub24ocGxheWVyLCAndGltZXVwZGF0ZScsIHRoaXMudXBkYXRlQ29udGVudCk7CiAgICB0aGlzLm9uKHBsYXllciwgJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy51cGRhdGVDb250ZW50KTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBEdXJhdGlvbkRpc3BsYXkucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICB2YXIgZWwgPSBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy1kdXJhdGlvbiB2anMtdGltZS1jb250cm9sIHZqcy1jb250cm9sJwogICAgfSk7CgogICAgdGhpcy5jb250ZW50RWxfID0gRG9tLmNyZWF0ZUVsKCdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy1kdXJhdGlvbi1kaXNwbGF5JywKICAgICAgLy8gbGFiZWwgdGhlIGR1cmF0aW9uIHRpbWUgZm9yIHNjcmVlbiByZWFkZXIgdXNlcnMKICAgICAgaW5uZXJIVE1MOiAnPHNwYW4gY2xhc3M9InZqcy1jb250cm9sLXRleHQiPicgKyB0aGlzLmxvY2FsaXplKCdEdXJhdGlvbiBUaW1lJykgKyAnPC9zcGFuPiAwOjAwJwogICAgfSwgewogICAgICAvLyB0ZWxsIHNjcmVlbiByZWFkZXJzIG5vdCB0byBhdXRvbWF0aWNhbGx5IHJlYWQgdGhlIHRpbWUgYXMgaXQgY2hhbmdlcwogICAgICAnYXJpYS1saXZlJzogJ29mZicKICAgIH0pOwoKICAgIGVsLmFwcGVuZENoaWxkKHRoaXMuY29udGVudEVsXyk7CiAgICByZXR1cm4gZWw7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIGR1cmF0aW9uIHRpbWUgZGlzcGxheQogICAqCiAgICogQG1ldGhvZCB1cGRhdGVDb250ZW50CiAgICovCgogIER1cmF0aW9uRGlzcGxheS5wcm90b3R5cGUudXBkYXRlQ29udGVudCA9IGZ1bmN0aW9uIHVwZGF0ZUNvbnRlbnQoKSB7CiAgICB2YXIgZHVyYXRpb24gPSB0aGlzLnBsYXllcl8uZHVyYXRpb24oKTsKICAgIGlmIChkdXJhdGlvbikgewogICAgICB2YXIgbG9jYWxpemVkVGV4dCA9IHRoaXMubG9jYWxpemUoJ0R1cmF0aW9uIFRpbWUnKTsKICAgICAgdmFyIGZvcm1hdHRlZFRpbWUgPSBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J10oZHVyYXRpb24pOwogICAgICB0aGlzLmNvbnRlbnRFbF8uaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPSJ2anMtY29udHJvbC10ZXh0Ij4nICsgbG9jYWxpemVkVGV4dCArICc8L3NwYW4+ICcgKyBmb3JtYXR0ZWRUaW1lOyAvLyBsYWJlbCB0aGUgZHVyYXRpb24gdGltZSBmb3Igc2NyZWVuIHJlYWRlciB1c2VycwogICAgfQogIH07CgogIHJldHVybiBEdXJhdGlvbkRpc3BsYXk7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ0R1cmF0aW9uRGlzcGxheScsIER1cmF0aW9uRGlzcGxheSk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IER1cmF0aW9uRGlzcGxheTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzIjoxMzF9XSw5MDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSByZW1haW5pbmctdGltZS1kaXNwbGF5LmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzJyk7Cgp2YXIgX3V0aWxzRm9ybWF0VGltZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzRm9ybWF0VGltZUpzKTsKCi8qKgogKiBEaXNwbGF5cyB0aGUgdGltZSBsZWZ0IGluIHRoZSB2aWRlbwogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBSZW1haW5pbmdUaW1lRGlzcGxheQogKi8KCnZhciBSZW1haW5pbmdUaW1lRGlzcGxheSA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhSZW1haW5pbmdUaW1lRGlzcGxheSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFJlbWFpbmluZ1RpbWVEaXNwbGF5KHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbWFpbmluZ1RpbWVEaXNwbGF5KTsKCiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICB0aGlzLm9uKHBsYXllciwgJ3RpbWV1cGRhdGUnLCB0aGlzLnVwZGF0ZUNvbnRlbnQpOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIFJlbWFpbmluZ1RpbWVEaXNwbGF5LnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgdmFyIGVsID0gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtcmVtYWluaW5nLXRpbWUgdmpzLXRpbWUtY29udHJvbCB2anMtY29udHJvbCcKICAgIH0pOwoKICAgIHRoaXMuY29udGVudEVsXyA9IERvbS5jcmVhdGVFbCgnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtcmVtYWluaW5nLXRpbWUtZGlzcGxheScsCiAgICAgIC8vIGxhYmVsIHRoZSByZW1haW5pbmcgdGltZSBmb3Igc2NyZWVuIHJlYWRlciB1c2VycwogICAgICBpbm5lckhUTUw6ICc8c3BhbiBjbGFzcz0idmpzLWNvbnRyb2wtdGV4dCI+JyArIHRoaXMubG9jYWxpemUoJ1JlbWFpbmluZyBUaW1lJykgKyAnPC9zcGFuPiAtMDowMCcKICAgIH0sIHsKICAgICAgLy8gdGVsbCBzY3JlZW4gcmVhZGVycyBub3QgdG8gYXV0b21hdGljYWxseSByZWFkIHRoZSB0aW1lIGFzIGl0IGNoYW5nZXMKICAgICAgJ2FyaWEtbGl2ZSc6ICdvZmYnCiAgICB9KTsKCiAgICBlbC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnRFbF8pOwogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIFVwZGF0ZSByZW1haW5pbmcgdGltZSBkaXNwbGF5CiAgICoKICAgKiBAbWV0aG9kIHVwZGF0ZUNvbnRlbnQKICAgKi8KCiAgUmVtYWluaW5nVGltZURpc3BsYXkucHJvdG90eXBlLnVwZGF0ZUNvbnRlbnQgPSBmdW5jdGlvbiB1cGRhdGVDb250ZW50KCkgewogICAgaWYgKHRoaXMucGxheWVyXy5kdXJhdGlvbigpKSB7CiAgICAgIHZhciBsb2NhbGl6ZWRUZXh0ID0gdGhpcy5sb2NhbGl6ZSgnUmVtYWluaW5nIFRpbWUnKTsKICAgICAgdmFyIGZvcm1hdHRlZFRpbWUgPSBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXJfLnJlbWFpbmluZ1RpbWUoKSk7CiAgICAgIHRoaXMuY29udGVudEVsXy5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9InZqcy1jb250cm9sLXRleHQiPicgKyBsb2NhbGl6ZWRUZXh0ICsgJzwvc3Bhbj4gLScgKyBmb3JtYXR0ZWRUaW1lOwogICAgfQoKICAgIC8vIEFsbG93cyBmb3Igc21vb3RoIHNjcnViYmluZywgd2hlbiBwbGF5ZXIgY2FuJ3Qga2VlcCB1cC4KICAgIC8vIHZhciB0aW1lID0gKHRoaXMucGxheWVyXy5zY3J1YmJpbmcoKSkgPyB0aGlzLnBsYXllcl8uZ2V0Q2FjaGUoKS5jdXJyZW50VGltZSA6IHRoaXMucGxheWVyXy5jdXJyZW50VGltZSgpOwogICAgLy8gdGhpcy5jb250ZW50RWxfLmlubmVySFRNTCA9IHZqcy5mb3JtYXRUaW1lKHRpbWUsIHRoaXMucGxheWVyXy5kdXJhdGlvbigpKTsKICB9OwoKICByZXR1cm4gUmVtYWluaW5nVGltZURpc3BsYXk7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1JlbWFpbmluZ1RpbWVEaXNwbGF5JywgUmVtYWluaW5nVGltZURpc3BsYXkpOwpleHBvcnRzWydkZWZhdWx0J10gPSBSZW1haW5pbmdUaW1lRGlzcGxheTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uLy4uL3V0aWxzL2Zvcm1hdC10aW1lLmpzIjoxMzF9XSw5MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSB0aW1lLWRpdmlkZXIuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCi8qKgogKiBUaGUgc2VwYXJhdG9yIGJldHdlZW4gdGhlIGN1cnJlbnQgdGltZSBhbmQgZHVyYXRpb24uCiAqIENhbiBiZSBoaWRkZW4gaWYgaXQncyBub3QgbmVlZGVkIGluIHRoZSBkZXNpZ24uCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBDb21wb25lbnQKICogQGNsYXNzIFRpbWVEaXZpZGVyCiAqLwoKdmFyIFRpbWVEaXZpZGVyID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFRpbWVEaXZpZGVyLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVGltZURpdmlkZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGltZURpdmlkZXIpOwoKICAgIF9Db21wb25lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBUaW1lRGl2aWRlci5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHJldHVybiBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy10aW1lLWNvbnRyb2wgdmpzLXRpbWUtZGl2aWRlcicsCiAgICAgIGlubmVySFRNTDogJzxkaXY+PHNwYW4+Lzwvc3Bhbj48L2Rpdj4nCiAgICB9KTsKICB9OwoKICByZXR1cm4gVGltZURpdmlkZXI7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1RpbWVEaXZpZGVyJywgVGltZURpdmlkZXIpOwpleHBvcnRzWydkZWZhdWx0J10gPSBUaW1lRGl2aWRlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NX1dLDkyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHZvbHVtZS1iYXIuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9zbGlkZXJTbGlkZXJKcyA9IF9kZXJlcV8oJy4uLy4uL3NsaWRlci9zbGlkZXIuanMnKTsKCnZhciBfc2xpZGVyU2xpZGVySnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2xpZGVyU2xpZGVySnMpOwoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uLy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7Cgp2YXIgX3V0aWxzRm5KcyA9IF9kZXJlcV8oJy4uLy4uL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCi8vIFJlcXVpcmVkIGNoaWxkcmVuCgp2YXIgX3ZvbHVtZUxldmVsSnMgPSBfZGVyZXFfKCcuL3ZvbHVtZS1sZXZlbC5qcycpOwoKdmFyIF92b2x1bWVMZXZlbEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZvbHVtZUxldmVsSnMpOwoKLyoqCiAqIFRoZSBiYXIgdGhhdCBjb250YWlucyB0aGUgdm9sdW1lIGxldmVsIGFuZCBjYW4gYmUgY2xpY2tlZCBvbiB0byBhZGp1c3QgdGhlIGxldmVsCiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBTbGlkZXIKICogQGNsYXNzIFZvbHVtZUJhcgogKi8KCnZhciBWb2x1bWVCYXIgPSAoZnVuY3Rpb24gKF9TbGlkZXIpIHsKICBfaW5oZXJpdHMoVm9sdW1lQmFyLCBfU2xpZGVyKTsKCiAgZnVuY3Rpb24gVm9sdW1lQmFyKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZvbHVtZUJhcik7CgogICAgX1NsaWRlci5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLm9uKHBsYXllciwgJ3ZvbHVtZWNoYW5nZScsIHRoaXMudXBkYXRlQVJJQUF0dHJpYnV0ZXMpOwogICAgcGxheWVyLnJlYWR5KEZuLmJpbmQodGhpcywgdGhpcy51cGRhdGVBUklBQXR0cmlidXRlcykpOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIFZvbHVtZUJhci5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHJldHVybiBfU2xpZGVyLnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy12b2x1bWUtYmFyIHZqcy1zbGlkZXItYmFyJwogICAgfSwgewogICAgICAnYXJpYS1sYWJlbCc6ICd2b2x1bWUgbGV2ZWwnCiAgICB9KTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgbW91c2UgbW92ZSBvbiB2b2x1bWUgYmFyCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZU1vdXNlTW92ZQogICAqLwoKICBWb2x1bWVCYXIucHJvdG90eXBlLmhhbmRsZU1vdXNlTW92ZSA9IGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZShldmVudCkgewogICAgaWYgKHRoaXMucGxheWVyXy5tdXRlZCgpKSB7CiAgICAgIHRoaXMucGxheWVyXy5tdXRlZChmYWxzZSk7CiAgICB9CgogICAgdGhpcy5wbGF5ZXJfLnZvbHVtZSh0aGlzLmNhbGN1bGF0ZURpc3RhbmNlKGV2ZW50KSk7CiAgfTsKCiAgLyoqCiAgICogR2V0IHBlcmNlbnQgb2Ygdm9sdW1lIGxldmVsCiAgICoKICAgKiBAcmV0dW4ge051bWJlcn0gVm9sdW1lIGxldmVsIHBlcmNlbnQKICAgKiBAbWV0aG9kIGdldFBlcmNlbnQKICAgKi8KCiAgVm9sdW1lQmFyLnByb3RvdHlwZS5nZXRQZXJjZW50ID0gZnVuY3Rpb24gZ2V0UGVyY2VudCgpIHsKICAgIGlmICh0aGlzLnBsYXllcl8ubXV0ZWQoKSkgewogICAgICByZXR1cm4gMDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBsYXllcl8udm9sdW1lKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogSW5jcmVhc2Ugdm9sdW1lIGxldmVsIGZvciBrZXlib2FyZCB1c2VycwogICAqCiAgICogQG1ldGhvZCBzdGVwRm9yd2FyZAogICAqLwoKICBWb2x1bWVCYXIucHJvdG90eXBlLnN0ZXBGb3J3YXJkID0gZnVuY3Rpb24gc3RlcEZvcndhcmQoKSB7CiAgICB0aGlzLnBsYXllcl8udm9sdW1lKHRoaXMucGxheWVyXy52b2x1bWUoKSArIDAuMSk7CiAgfTsKCiAgLyoqCiAgICogRGVjcmVhc2Ugdm9sdW1lIGxldmVsIGZvciBrZXlib2FyZCB1c2VycwogICAqCiAgICogQG1ldGhvZCBzdGVwQmFjawogICAqLwoKICBWb2x1bWVCYXIucHJvdG90eXBlLnN0ZXBCYWNrID0gZnVuY3Rpb24gc3RlcEJhY2soKSB7CiAgICB0aGlzLnBsYXllcl8udm9sdW1lKHRoaXMucGxheWVyXy52b2x1bWUoKSAtIDAuMSk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIEFSSUEgYWNjZXNzaWJpbGl0eSBhdHRyaWJ1dGVzCiAgICoKICAgKiBAbWV0aG9kIHVwZGF0ZUFSSUFBdHRyaWJ1dGVzCiAgICovCgogIFZvbHVtZUJhci5wcm90b3R5cGUudXBkYXRlQVJJQUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiB1cGRhdGVBUklBQXR0cmlidXRlcygpIHsKICAgIC8vIEN1cnJlbnQgdmFsdWUgb2Ygdm9sdW1lIGJhciBhcyBhIHBlcmNlbnRhZ2UKICAgIHZhciB2b2x1bWUgPSAodGhpcy5wbGF5ZXJfLnZvbHVtZSgpICogMTAwKS50b0ZpeGVkKDIpOwogICAgdGhpcy5lbF8uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93Jywgdm9sdW1lKTsKICAgIHRoaXMuZWxfLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCB2b2x1bWUgKyAnJScpOwogIH07CgogIHJldHVybiBWb2x1bWVCYXI7Cn0pKF9zbGlkZXJTbGlkZXJKczJbJ2RlZmF1bHQnXSk7CgpWb2x1bWVCYXIucHJvdG90eXBlLm9wdGlvbnNfID0gewogIGNoaWxkcmVuOiBbJ3ZvbHVtZUxldmVsJ10sCiAgJ2Jhck5hbWUnOiAndm9sdW1lTGV2ZWwnCn07CgpWb2x1bWVCYXIucHJvdG90eXBlLnBsYXllckV2ZW50ID0gJ3ZvbHVtZWNoYW5nZSc7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1ZvbHVtZUJhcicsIFZvbHVtZUJhcik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IFZvbHVtZUJhcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vLi4vc2xpZGVyL3NsaWRlci5qcyI6MTEwLCIuLi8uLi91dGlscy9mbi5qcyI6MTMwLCIuL3ZvbHVtZS1sZXZlbC5qcyI6OTR9XSw5MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSB2b2x1bWUtY29udHJvbC5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKLy8gUmVxdWlyZWQgY2hpbGRyZW4KCnZhciBfdm9sdW1lQmFySnMgPSBfZGVyZXFfKCcuL3ZvbHVtZS1iYXIuanMnKTsKCnZhciBfdm9sdW1lQmFySnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdm9sdW1lQmFySnMpOwoKLyoqCiAqIFRoZSBjb21wb25lbnQgZm9yIGNvbnRyb2xsaW5nIHRoZSB2b2x1bWUgbGV2ZWwKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgVm9sdW1lQ29udHJvbAogKi8KCnZhciBWb2x1bWVDb250cm9sID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFZvbHVtZUNvbnRyb2wsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBWb2x1bWVDb250cm9sKHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZvbHVtZUNvbnRyb2wpOwoKICAgIF9Db21wb25lbnQuY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwoKICAgIC8vIGhpZGUgdm9sdW1lIGNvbnRyb2xzIHdoZW4gdGhleSdyZSBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IHRlY2gKICAgIGlmIChwbGF5ZXIudGVjaF8gJiYgcGxheWVyLnRlY2hfWydmZWF0dXJlc1ZvbHVtZUNvbnRyb2wnXSA9PT0gZmFsc2UpIHsKICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWhpZGRlbicpOwogICAgfQogICAgdGhpcy5vbihwbGF5ZXIsICdsb2Fkc3RhcnQnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChwbGF5ZXIudGVjaF9bJ2ZlYXR1cmVzVm9sdW1lQ29udHJvbCddID09PSBmYWxzZSkgewogICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1oaWRkZW4nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtaGlkZGVuJyk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIFZvbHVtZUNvbnRyb2wucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtdm9sdW1lLWNvbnRyb2wgdmpzLWNvbnRyb2wnCiAgICB9KTsKICB9OwoKICByZXR1cm4gVm9sdW1lQ29udHJvbDsKfSkoX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddKTsKClZvbHVtZUNvbnRyb2wucHJvdG90eXBlLm9wdGlvbnNfID0gewogIGNoaWxkcmVuOiBbJ3ZvbHVtZUJhciddCn07CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1ZvbHVtZUNvbnRyb2wnLCBWb2x1bWVDb250cm9sKTsKZXhwb3J0c1snZGVmYXVsdCddID0gVm9sdW1lQ29udHJvbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NSwiLi92b2x1bWUtYmFyLmpzIjo5Mn1dLDk0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHZvbHVtZS1sZXZlbC5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi8uLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKLyoqCiAqIFNob3dzIHZvbHVtZSBsZXZlbAogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBWb2x1bWVMZXZlbAogKi8KCnZhciBWb2x1bWVMZXZlbCA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhWb2x1bWVMZXZlbCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFZvbHVtZUxldmVsKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZvbHVtZUxldmVsKTsKCiAgICBfQ29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgVm9sdW1lTGV2ZWwucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtdm9sdW1lLWxldmVsJywKICAgICAgaW5uZXJIVE1MOiAnPHNwYW4gY2xhc3M9InZqcy1jb250cm9sLXRleHQiPjwvc3Bhbj4nCiAgICB9KTsKICB9OwoKICByZXR1cm4gVm9sdW1lTGV2ZWw7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1ZvbHVtZUxldmVsJywgVm9sdW1lTGV2ZWwpOwpleHBvcnRzWydkZWZhdWx0J10gPSBWb2x1bWVMZXZlbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vY29tcG9uZW50LmpzIjo2NX1dLDk1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHZvbHVtZS1tZW51LWJ1dHRvbi5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfYnV0dG9uSnMgPSBfZGVyZXFfKCcuLi9idXR0b24uanMnKTsKCnZhciBfYnV0dG9uSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnV0dG9uSnMpOwoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7Cgp2YXIgX21lbnVNZW51SnMgPSBfZGVyZXFfKCcuLi9tZW51L21lbnUuanMnKTsKCnZhciBfbWVudU1lbnVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUpzKTsKCnZhciBfbWVudU1lbnVCdXR0b25KcyA9IF9kZXJlcV8oJy4uL21lbnUvbWVudS1idXR0b24uanMnKTsKCnZhciBfbWVudU1lbnVCdXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZW51TWVudUJ1dHRvbkpzKTsKCnZhciBfbXV0ZVRvZ2dsZUpzID0gX2RlcmVxXygnLi9tdXRlLXRvZ2dsZS5qcycpOwoKdmFyIF9tdXRlVG9nZ2xlSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXV0ZVRvZ2dsZUpzKTsKCnZhciBfdm9sdW1lQ29udHJvbFZvbHVtZUJhckpzID0gX2RlcmVxXygnLi92b2x1bWUtY29udHJvbC92b2x1bWUtYmFyLmpzJyk7Cgp2YXIgX3ZvbHVtZUNvbnRyb2xWb2x1bWVCYXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92b2x1bWVDb250cm9sVm9sdW1lQmFySnMpOwoKLyoqCiAqIEJ1dHRvbiBmb3Igdm9sdW1lIG1lbnUKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIE1lbnVCdXR0b24KICogQGNsYXNzIFZvbHVtZU1lbnVCdXR0b24KICovCgp2YXIgVm9sdW1lTWVudUJ1dHRvbiA9IChmdW5jdGlvbiAoX01lbnVCdXR0b24pIHsKICBfaW5oZXJpdHMoVm9sdW1lTWVudUJ1dHRvbiwgX01lbnVCdXR0b24pOwoKICBmdW5jdGlvbiBWb2x1bWVNZW51QnV0dG9uKHBsYXllcikgewogICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVm9sdW1lTWVudUJ1dHRvbik7CgogICAgLy8gRGVmYXVsdCB0byBpbmxpbmUKICAgIGlmIChvcHRpb25zLmlubGluZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wdGlvbnMuaW5saW5lID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBJZiB0aGUgdmVydGljYWwgb3B0aW9uIGlzbid0IHBhc3NlZCBhdCBhbGwsIGRlZmF1bHQgdG8gdHJ1ZS4KICAgIGlmIChvcHRpb25zLnZlcnRpY2FsID09PSB1bmRlZmluZWQpIHsKICAgICAgLy8gSWYgYW4gaW5saW5lIHZvbHVtZU1lbnVCdXR0b24gaXMgdXNlZCwgd2Ugc2hvdWxkIGRlZmF1bHQgdG8gdXNpbmcKICAgICAgLy8gYSBob3Jpem9udGFsIHNsaWRlciBmb3Igb2J2aW91cyByZWFzb25zLgogICAgICBpZiAob3B0aW9ucy5pbmxpbmUpIHsKICAgICAgICBvcHRpb25zLnZlcnRpY2FsID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3B0aW9ucy52ZXJ0aWNhbCA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICAvLyBUaGUgdmVydGljYWwgb3B0aW9uIG5lZWRzIHRvIGJlIHNldCBvbiB0aGUgdm9sdW1lQmFyIGFzIHdlbGwsCiAgICAvLyBzaW5jZSB0aGF0IHdpbGwgbmVlZCB0byBiZSBwYXNzZWQgYWxvbmcgdG8gdGhlIFZvbHVtZUJhciBjb25zdHJ1Y3RvcgogICAgb3B0aW9ucy52b2x1bWVCYXIgPSBvcHRpb25zLnZvbHVtZUJhciB8fCB7fTsKICAgIG9wdGlvbnMudm9sdW1lQmFyLnZlcnRpY2FsID0gISFvcHRpb25zLnZlcnRpY2FsOwoKICAgIF9NZW51QnV0dG9uLmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKCiAgICAvLyBTYW1lIGxpc3RlbmVycyBhcyBNdXRlVG9nZ2xlCiAgICB0aGlzLm9uKHBsYXllciwgJ3ZvbHVtZWNoYW5nZScsIHRoaXMudm9sdW1lVXBkYXRlKTsKICAgIHRoaXMub24ocGxheWVyLCAnbG9hZHN0YXJ0JywgdGhpcy52b2x1bWVVcGRhdGUpOwoKICAgIC8vIGhpZGUgbXV0ZSB0b2dnbGUgaWYgdGhlIGN1cnJlbnQgdGVjaCBkb2Vzbid0IHN1cHBvcnQgdm9sdW1lIGNvbnRyb2wKICAgIGZ1bmN0aW9uIHVwZGF0ZVZpc2liaWxpdHkoKSB7CiAgICAgIGlmIChwbGF5ZXIudGVjaF8gJiYgcGxheWVyLnRlY2hfWydmZWF0dXJlc1ZvbHVtZUNvbnRyb2wnXSA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLmFkZENsYXNzKCd2anMtaGlkZGVuJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWhpZGRlbicpOwogICAgICB9CiAgICB9CgogICAgdXBkYXRlVmlzaWJpbGl0eS5jYWxsKHRoaXMpOwogICAgdGhpcy5vbihwbGF5ZXIsICdsb2Fkc3RhcnQnLCB1cGRhdGVWaXNpYmlsaXR5KTsKCiAgICB0aGlzLm9uKHRoaXMudm9sdW1lQmFyLCBbJ3NsaWRlcmFjdGl2ZScsICdmb2N1cyddLCBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1zbGlkZXItYWN0aXZlJyk7CiAgICB9KTsKCiAgICB0aGlzLm9uKHRoaXMudm9sdW1lQmFyLCBbJ3NsaWRlcmluYWN0aXZlJywgJ2JsdXInXSwgZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtc2xpZGVyLWFjdGl2ZScpOwogICAgfSk7CiAgfQoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgVm9sdW1lTWVudUJ1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICB2YXIgb3JpZW50YXRpb25DbGFzcyA9ICcnOwogICAgaWYgKCEhdGhpcy5vcHRpb25zXy52ZXJ0aWNhbCkgewogICAgICBvcmllbnRhdGlvbkNsYXNzID0gJ3Zqcy12b2x1bWUtbWVudS1idXR0b24tdmVydGljYWwnOwogICAgfSBlbHNlIHsKICAgICAgb3JpZW50YXRpb25DbGFzcyA9ICd2anMtdm9sdW1lLW1lbnUtYnV0dG9uLWhvcml6b250YWwnOwogICAgfQoKICAgIHJldHVybiAndmpzLXZvbHVtZS1tZW51LWJ1dHRvbiAnICsgX01lbnVCdXR0b24ucHJvdG90eXBlLmJ1aWxkQ1NTQ2xhc3MuY2FsbCh0aGlzKSArICcgJyArIG9yaWVudGF0aW9uQ2xhc3M7CiAgfTsKCiAgLyoqCiAgICogQWxsb3cgc3ViIGNvbXBvbmVudHMgdG8gc3RhY2sgQ1NTIGNsYXNzIG5hbWVzCiAgICoKICAgKiBAcmV0dXJuIHtNZW51fSBUaGUgdm9sdW1lIG1lbnUgYnV0dG9uCiAgICogQG1ldGhvZCBjcmVhdGVNZW51CiAgICovCgogIFZvbHVtZU1lbnVCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU1lbnUgPSBmdW5jdGlvbiBjcmVhdGVNZW51KCkgewogICAgdmFyIG1lbnUgPSBuZXcgX21lbnVNZW51SnMyWydkZWZhdWx0J10odGhpcy5wbGF5ZXJfLCB7CiAgICAgIGNvbnRlbnRFbFR5cGU6ICdkaXYnCiAgICB9KTsKCiAgICB2YXIgdmIgPSBuZXcgX3ZvbHVtZUNvbnRyb2xWb2x1bWVCYXJKczJbJ2RlZmF1bHQnXSh0aGlzLnBsYXllcl8sIHRoaXMub3B0aW9uc18udm9sdW1lQmFyKTsKCiAgICBtZW51LmFkZENoaWxkKHZiKTsKCiAgICB0aGlzLnZvbHVtZUJhciA9IHZiOwogICAgcmV0dXJuIG1lbnU7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGNsaWNrIG9uIHZvbHVtZSBtZW51IGFuZCBjYWxscyBzdXBlcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBWb2x1bWVNZW51QnV0dG9uLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgX211dGVUb2dnbGVKczJbJ2RlZmF1bHQnXS5wcm90b3R5cGUuaGFuZGxlQ2xpY2suY2FsbCh0aGlzKTsKICAgIF9NZW51QnV0dG9uLnByb3RvdHlwZS5oYW5kbGVDbGljay5jYWxsKHRoaXMpOwogIH07CgogIHJldHVybiBWb2x1bWVNZW51QnV0dG9uOwp9KShfbWVudU1lbnVCdXR0b25KczJbJ2RlZmF1bHQnXSk7CgpWb2x1bWVNZW51QnV0dG9uLnByb3RvdHlwZS52b2x1bWVVcGRhdGUgPSBfbXV0ZVRvZ2dsZUpzMlsnZGVmYXVsdCddLnByb3RvdHlwZS51cGRhdGU7ClZvbHVtZU1lbnVCdXR0b24ucHJvdG90eXBlLmNvbnRyb2xUZXh0XyA9ICdNdXRlJzsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnVm9sdW1lTWVudUJ1dHRvbicsIFZvbHVtZU1lbnVCdXR0b24pOwpleHBvcnRzWydkZWZhdWx0J10gPSBWb2x1bWVNZW51QnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9idXR0b24uanMiOjYzLCIuLi9jb21wb25lbnQuanMiOjY1LCIuLi9tZW51L21lbnUtYnV0dG9uLmpzIjoxMDIsIi4uL21lbnUvbWVudS5qcyI6MTA0LCIuL211dGUtdG9nZ2xlLmpzIjo2OSwiLi92b2x1bWUtY29udHJvbC92b2x1bWUtYmFyLmpzIjo5Mn1dLDk2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGVycm9yLWRpc3BsYXkuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfQoKdmFyIF9jb21wb25lbnQgPSBfZGVyZXFfKCcuL2NvbXBvbmVudCcpOwoKdmFyIF9jb21wb25lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50KTsKCnZhciBfbW9kYWxEaWFsb2cgPSBfZGVyZXFfKCcuL21vZGFsLWRpYWxvZycpOwoKdmFyIF9tb2RhbERpYWxvZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb2RhbERpYWxvZyk7Cgp2YXIgX3V0aWxzRG9tID0gX2RlcmVxXygnLi91dGlscy9kb20nKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb20pOwoKdmFyIF91dGlsc01lcmdlT3B0aW9ucyA9IF9kZXJlcV8oJy4vdXRpbHMvbWVyZ2Utb3B0aW9ucycpOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc01lcmdlT3B0aW9ucyk7CgovKioKICogRGlzcGxheSB0aGF0IGFuIGVycm9yIGhhcyBvY2N1cnJlZCBtYWtpbmcgdGhlIHZpZGVvIHVucGxheWFibGUuCiAqCiAqIEBleHRlbmRzIE1vZGFsRGlhbG9nCiAqIEBjbGFzcyBFcnJvckRpc3BsYXkKICovCgp2YXIgRXJyb3JEaXNwbGF5ID0gKGZ1bmN0aW9uIChfTW9kYWxEaWFsb2cpIHsKICBfaW5oZXJpdHMoRXJyb3JEaXNwbGF5LCBfTW9kYWxEaWFsb2cpOwoKICAvKioKICAgKiBDb25zdHJ1Y3RvciBmb3IgZXJyb3IgZGlzcGxheSBtb2RhbC4KICAgKgogICAqIEBwYXJhbSAge1BsYXllcn0gcGxheWVyCiAgICogQHBhcmFtICB7T2JqZWN0fSBbb3B0aW9uc10KICAgKi8KCiAgZnVuY3Rpb24gRXJyb3JEaXNwbGF5KHBsYXllciwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVycm9yRGlzcGxheSk7CgogICAgX01vZGFsRGlhbG9nLmNhbGwodGhpcywgcGxheWVyLCBvcHRpb25zKTsKICAgIHRoaXMub24ocGxheWVyLCAnZXJyb3InLCB0aGlzLm9wZW4pOwogIH0KCiAgLyoqCiAgICogSW5jbHVkZSB0aGUgb2xkIGNsYXNzIGZvciBiYWNrd2FyZC1jb21wYXRpYmlsaXR5LgogICAqCiAgICogVGhpcyBjYW4gYmUgcmVtb3ZlZCBpbiA2LjAuCiAgICoKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKiBAZGVwcmVjYXRlZAogICAqIEByZXR1cm4ge1N0cmluZ30KICAgKi8KCiAgRXJyb3JEaXNwbGF5LnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIHJldHVybiAndmpzLWVycm9yLWRpc3BsYXkgJyArIF9Nb2RhbERpYWxvZy5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcy5jYWxsKHRoaXMpOwogIH07CgogIC8qKgogICAqIEdlbmVyYXRlcyB0aGUgbW9kYWwgY29udGVudCBiYXNlZCBvbiB0aGUgcGxheWVyIGVycm9yLgogICAqCiAgICogQHJldHVybiB7U3RyaW5nfE51bGx9CiAgICovCgogIEVycm9yRGlzcGxheS5wcm90b3R5cGUuY29udGVudCA9IGZ1bmN0aW9uIGNvbnRlbnQoKSB7CiAgICB2YXIgZXJyb3IgPSB0aGlzLnBsYXllcigpLmVycm9yKCk7CiAgICByZXR1cm4gZXJyb3IgPyB0aGlzLmxvY2FsaXplKGVycm9yLm1lc3NhZ2UpIDogJyc7CiAgfTsKCiAgcmV0dXJuIEVycm9yRGlzcGxheTsKfSkoX21vZGFsRGlhbG9nMlsnZGVmYXVsdCddKTsKCkVycm9yRGlzcGxheS5wcm90b3R5cGUub3B0aW9uc18gPSBfdXRpbHNNZXJnZU9wdGlvbnMyWydkZWZhdWx0J10oX21vZGFsRGlhbG9nMlsnZGVmYXVsdCddLnByb3RvdHlwZS5vcHRpb25zXywgewogIGZpbGxBbHdheXM6IHRydWUsCiAgdW5jbG9zZWFibGU6IHRydWUKfSk7CgpfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdFcnJvckRpc3BsYXknLCBFcnJvckRpc3BsYXkpOwpleHBvcnRzWydkZWZhdWx0J10gPSBFcnJvckRpc3BsYXk7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vY29tcG9uZW50Ijo2NSwiLi9tb2RhbC1kaWFsb2ciOjEwNSwiLi91dGlscy9kb20iOjEyOCwiLi91dGlscy9tZXJnZS1vcHRpb25zIjoxMzR9XSw5NzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBldmVudC10YXJnZXQuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKdmFyIF91dGlsc0V2ZW50c0pzID0gX2RlcmVxXygnLi91dGlscy9ldmVudHMuanMnKTsKCnZhciBFdmVudHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNFdmVudHNKcyk7Cgp2YXIgRXZlbnRUYXJnZXQgPSBmdW5jdGlvbiBFdmVudFRhcmdldCgpIHt9OwoKRXZlbnRUYXJnZXQucHJvdG90eXBlLmFsbG93ZWRFdmVudHNfID0ge307CgpFdmVudFRhcmdldC5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAodHlwZSwgZm4pIHsKICAvLyBSZW1vdmUgdGhlIGFkZEV2ZW50TGlzdGVuZXIgYWxpYXMgYmVmb3JlIGNhbGxpbmcgRXZlbnRzLm9uCiAgLy8gc28gd2UgZG9uJ3QgZ2V0IGludG8gYW4gaW5maW5pdGUgdHlwZSBsb29wCiAgdmFyIGFlbCA9IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcjsKICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBGdW5jdGlvbi5wcm90b3R5cGU7CiAgRXZlbnRzLm9uKHRoaXMsIHR5cGUsIGZuKTsKICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIgPSBhZWw7Cn07CkV2ZW50VGFyZ2V0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gRXZlbnRUYXJnZXQucHJvdG90eXBlLm9uOwoKRXZlbnRUYXJnZXQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uICh0eXBlLCBmbikgewogIEV2ZW50cy5vZmYodGhpcywgdHlwZSwgZm4pOwp9OwpFdmVudFRhcmdldC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IEV2ZW50VGFyZ2V0LnByb3RvdHlwZS5vZmY7CgpFdmVudFRhcmdldC5wcm90b3R5cGUub25lID0gZnVuY3Rpb24gKHR5cGUsIGZuKSB7CiAgRXZlbnRzLm9uZSh0aGlzLCB0eXBlLCBmbik7Cn07CgpFdmVudFRhcmdldC5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uIChldmVudCkgewogIHZhciB0eXBlID0gZXZlbnQudHlwZSB8fCBldmVudDsKCiAgaWYgKHR5cGVvZiBldmVudCA9PT0gJ3N0cmluZycpIHsKICAgIGV2ZW50ID0gewogICAgICB0eXBlOiB0eXBlCiAgICB9OwogIH0KICBldmVudCA9IEV2ZW50cy5maXhFdmVudChldmVudCk7CgogIGlmICh0aGlzLmFsbG93ZWRFdmVudHNfW3R5cGVdICYmIHRoaXNbJ29uJyArIHR5cGVdKSB7CiAgICB0aGlzWydvbicgKyB0eXBlXShldmVudCk7CiAgfQoKICBFdmVudHMudHJpZ2dlcih0aGlzLCBldmVudCk7Cn07Ci8vIFRoZSBzdGFuZGFyZCBET00gRXZlbnRUYXJnZXQuZGlzcGF0Y2hFdmVudCgpIGlzIGFsaWFzZWQgdG8gdHJpZ2dlcigpCkV2ZW50VGFyZ2V0LnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gRXZlbnRUYXJnZXQucHJvdG90eXBlLnRyaWdnZXI7CgpleHBvcnRzWydkZWZhdWx0J10gPSBFdmVudFRhcmdldDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi91dGlscy9ldmVudHMuanMiOjEyOX1dLDk4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfdXRpbHNMb2cgPSBfZGVyZXFfKCcuL3V0aWxzL2xvZycpOwoKdmFyIF91dGlsc0xvZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0xvZyk7CgovKgogKiBAZmlsZSBleHRlbmQuanMKICoKICogQSBjb21iaW5hdGlvbiBvZiBub2RlIGluaGVyaXRzIGFuZCBiYWJlbCdzIGluaGVyaXRzIChhZnRlciB0cmFuc3BpbGUpLgogKiBCb3RoIHdvcmsgdGhlIHNhbWUgYnV0IG5vZGUgYWRkcyBgc3VwZXJfYCB0byB0aGUgc3ViQ2xhc3MKICogYW5kIEJhYmxlIGFkZHMgdGhlIHN1cGVyQ2xhc3MgYXMgX19wcm90b19fLiBCb3RoIHNlZW0gdXNlZnVsLgogKi8KdmFyIF9pbmhlcml0cyA9IGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKCiAgaWYgKHN1cGVyQ2xhc3MpIHsKICAgIC8vIG5vZGUKICAgIHN1YkNsYXNzLnN1cGVyXyA9IHN1cGVyQ2xhc3M7CiAgfQp9OwoKLyoKICogRnVuY3Rpb24gZm9yIHN1YmNsYXNzaW5nIHVzaW5nIHRoZSBzYW1lIGluaGVyaXRhbmNlIHRoYXQKICogdmlkZW9qcyB1c2VzIGludGVybmFsbHkKICogYGBganMKICogdmFyIEJ1dHRvbiA9IHZpZGVvanMuZ2V0Q29tcG9uZW50KCdCdXR0b24nKTsKICogYGBgCiAqIGBgYGpzCiAqIHZhciBNeUJ1dHRvbiA9IHZpZGVvanMuZXh0ZW5kKEJ1dHRvbiwgewogKiAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihwbGF5ZXIsIG9wdGlvbnMpIHsKICogICAgIEJ1dHRvbi5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAqICAgfSwKICogICBvbkNsaWNrOiBmdW5jdGlvbigpIHsKICogICAgIC8vIGRvU29tZXRoaW5nCiAqICAgfQogKiB9KTsKICogYGBgCiAqLwp2YXIgZXh0ZW5kRm4gPSBmdW5jdGlvbiBleHRlbmRGbihzdXBlckNsYXNzKSB7CiAgdmFyIHN1YkNsYXNzTWV0aG9kcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdOwoKICB2YXIgc3ViQ2xhc3MgPSBmdW5jdGlvbiBzdWJDbGFzcygpIHsKICAgIHN1cGVyQ2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9OwogIHZhciBtZXRob2RzID0ge307CgogIGlmICh0eXBlb2Ygc3ViQ2xhc3NNZXRob2RzID09PSAnb2JqZWN0JykgewogICAgaWYgKHR5cGVvZiBzdWJDbGFzc01ldGhvZHMuaW5pdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBfdXRpbHNMb2cyWydkZWZhdWx0J10ud2FybignQ29uc3RydWN0b3IgbG9naWMgdmlhIGluaXQoKSBpcyBkZXByZWNhdGVkOyBwbGVhc2UgdXNlIGNvbnN0cnVjdG9yKCkgaW5zdGVhZC4nKTsKICAgICAgc3ViQ2xhc3NNZXRob2RzLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3NNZXRob2RzLmluaXQ7CiAgICB9CiAgICBpZiAoc3ViQ2xhc3NNZXRob2RzLmNvbnN0cnVjdG9yICE9PSBPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yKSB7CiAgICAgIHN1YkNsYXNzID0gc3ViQ2xhc3NNZXRob2RzLmNvbnN0cnVjdG9yOwogICAgfQogICAgbWV0aG9kcyA9IHN1YkNsYXNzTWV0aG9kczsKICB9IGVsc2UgaWYgKHR5cGVvZiBzdWJDbGFzc01ldGhvZHMgPT09ICdmdW5jdGlvbicpIHsKICAgIHN1YkNsYXNzID0gc3ViQ2xhc3NNZXRob2RzOwogIH0KCiAgX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKCiAgLy8gRXh0ZW5kIHN1Yk9iaidzIHByb3RvdHlwZSB3aXRoIGZ1bmN0aW9ucyBhbmQgb3RoZXIgcHJvcGVydGllcyBmcm9tIHByb3BzCiAgZm9yICh2YXIgbmFtZSBpbiBtZXRob2RzKSB7CiAgICBpZiAobWV0aG9kcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICBzdWJDbGFzcy5wcm90b3R5cGVbbmFtZV0gPSBtZXRob2RzW25hbWVdOwogICAgfQogIH0KCiAgcmV0dXJuIHN1YkNsYXNzOwp9OwoKZXhwb3J0c1snZGVmYXVsdCddID0gZXh0ZW5kRm47Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vdXRpbHMvbG9nIjoxMzN9XSw5OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBmdWxsc2NyZWVuLWFwaS5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKLyoKICogU3RvcmUgdGhlIGJyb3dzZXItc3BlY2lmaWMgbWV0aG9kcyBmb3IgdGhlIGZ1bGxzY3JlZW4gQVBJCiAqIEB0eXBlIHtPYmplY3R8dW5kZWZpbmVkfQogKiBAcHJpdmF0ZQogKi8KdmFyIEZ1bGxzY3JlZW5BcGkgPSB7fTsKCi8vIGJyb3dzZXIgQVBJIG1ldGhvZHMKLy8gbWFwIGFwcHJvYWNoIGZyb20gU2NyZWVuZnVsLmpzIC0gaHR0cHM6Ly9naXRodWIuY29tL3NpbmRyZXNvcmh1cy9zY3JlZW5mdWxsLmpzCnZhciBhcGlNYXAgPSBbCi8vIFNwZWM6IGh0dHBzOi8vZHZjcy53My5vcmcvaGcvZnVsbHNjcmVlbi9yYXctZmlsZS90aXAvT3ZlcnZpZXcuaHRtbApbJ3JlcXVlc3RGdWxsc2NyZWVuJywgJ2V4aXRGdWxsc2NyZWVuJywgJ2Z1bGxzY3JlZW5FbGVtZW50JywgJ2Z1bGxzY3JlZW5FbmFibGVkJywgJ2Z1bGxzY3JlZW5jaGFuZ2UnLCAnZnVsbHNjcmVlbmVycm9yJ10sCi8vIFdlYktpdApbJ3dlYmtpdFJlcXVlc3RGdWxsc2NyZWVuJywgJ3dlYmtpdEV4aXRGdWxsc2NyZWVuJywgJ3dlYmtpdEZ1bGxzY3JlZW5FbGVtZW50JywgJ3dlYmtpdEZ1bGxzY3JlZW5FbmFibGVkJywgJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCAnd2Via2l0ZnVsbHNjcmVlbmVycm9yJ10sCi8vIE9sZCBXZWJLaXQgKFNhZmFyaSA1LjEpClsnd2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4nLCAnd2Via2l0Q2FuY2VsRnVsbFNjcmVlbicsICd3ZWJraXRDdXJyZW50RnVsbFNjcmVlbkVsZW1lbnQnLCAnd2Via2l0Q2FuY2VsRnVsbFNjcmVlbicsICd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgJ3dlYmtpdGZ1bGxzY3JlZW5lcnJvciddLAovLyBNb3ppbGxhClsnbW96UmVxdWVzdEZ1bGxTY3JlZW4nLCAnbW96Q2FuY2VsRnVsbFNjcmVlbicsICdtb3pGdWxsU2NyZWVuRWxlbWVudCcsICdtb3pGdWxsU2NyZWVuRW5hYmxlZCcsICdtb3pmdWxsc2NyZWVuY2hhbmdlJywgJ21vemZ1bGxzY3JlZW5lcnJvciddLAovLyBNaWNyb3NvZnQKWydtc1JlcXVlc3RGdWxsc2NyZWVuJywgJ21zRXhpdEZ1bGxzY3JlZW4nLCAnbXNGdWxsc2NyZWVuRWxlbWVudCcsICdtc0Z1bGxzY3JlZW5FbmFibGVkJywgJ01TRnVsbHNjcmVlbkNoYW5nZScsICdNU0Z1bGxzY3JlZW5FcnJvciddXTsKCnZhciBzcGVjQXBpID0gYXBpTWFwWzBdOwp2YXIgYnJvd3NlckFwaSA9IHVuZGVmaW5lZDsKCi8vIGRldGVybWluZSB0aGUgc3VwcG9ydGVkIHNldCBvZiBmdW5jdGlvbnMKZm9yICh2YXIgaSA9IDA7IGkgPCBhcGlNYXAubGVuZ3RoOyBpKyspIHsKICAvLyBjaGVjayBmb3IgZXhpdEZ1bGxzY3JlZW4gZnVuY3Rpb24KICBpZiAoYXBpTWFwW2ldWzFdIGluIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXSkgewogICAgYnJvd3NlckFwaSA9IGFwaU1hcFtpXTsKICAgIGJyZWFrOwogIH0KfQoKLy8gbWFwIHRoZSBicm93c2VyIEFQSSBuYW1lcyB0byB0aGUgc3BlYyBBUEkgbmFtZXMKaWYgKGJyb3dzZXJBcGkpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IGJyb3dzZXJBcGkubGVuZ3RoOyBpKyspIHsKICAgIEZ1bGxzY3JlZW5BcGlbc3BlY0FwaVtpXV0gPSBicm93c2VyQXBpW2ldOwogIH0KfQoKZXhwb3J0c1snZGVmYXVsdCddID0gRnVsbHNjcmVlbkFwaTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiZ2xvYmFsL2RvY3VtZW50IjoxfV0sMTAwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGxvYWRpbmctc3Bpbm5lci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50ID0gX2RlcmVxXygnLi9jb21wb25lbnQnKTsKCnZhciBfY29tcG9uZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudCk7CgovKiBMb2FkaW5nIFNwaW5uZXIKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KLyoqCiAqIExvYWRpbmcgc3Bpbm5lciBmb3Igd2FpdGluZyBldmVudHMKICoKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBMb2FkaW5nU3Bpbm5lcgogKi8KCnZhciBMb2FkaW5nU3Bpbm5lciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhMb2FkaW5nU3Bpbm5lciwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIExvYWRpbmdTcGlubmVyKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvYWRpbmdTcGlubmVyKTsKCiAgICBfQ29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIExvYWRpbmdTcGlubmVyLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgcmV0dXJuIF9Db21wb25lbnQucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLWxvYWRpbmctc3Bpbm5lcicKICAgIH0pOwogIH07CgogIHJldHVybiBMb2FkaW5nU3Bpbm5lcjsKfSkoX2NvbXBvbmVudDJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdMb2FkaW5nU3Bpbm5lcicsIExvYWRpbmdTcGlubmVyKTsKZXhwb3J0c1snZGVmYXVsdCddID0gTG9hZGluZ1NwaW5uZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vY29tcG9uZW50Ijo2NX1dLDEwMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBtZWRpYS1lcnJvci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfb2JqZWN0QXNzaWduID0gX2RlcmVxXygnb2JqZWN0LmFzc2lnbicpOwoKdmFyIF9vYmplY3RBc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKTsKCi8qCiAqIEN1c3RvbSBNZWRpYUVycm9yIHRvIG1pbWljIHRoZSBIVE1MNSBNZWRpYUVycm9yCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIFRoZSBtZWRpYSBlcnJvciBjb2RlCiAqLwp2YXIgTWVkaWFFcnJvciA9IGZ1bmN0aW9uIE1lZGlhRXJyb3IoY29kZSkgewogIGlmICh0eXBlb2YgY29kZSA9PT0gJ251bWJlcicpIHsKICAgIHRoaXMuY29kZSA9IGNvZGU7CiAgfSBlbHNlIGlmICh0eXBlb2YgY29kZSA9PT0gJ3N0cmluZycpIHsKICAgIC8vIGRlZmF1bHQgY29kZSBpcyB6ZXJvLCBzbyB0aGlzIGlzIGEgY3VzdG9tIGVycm9yCiAgICB0aGlzLm1lc3NhZ2UgPSBjb2RlOwogIH0gZWxzZSBpZiAodHlwZW9mIGNvZGUgPT09ICdvYmplY3QnKSB7CiAgICAvLyBvYmplY3QKICAgIF9vYmplY3RBc3NpZ24yWydkZWZhdWx0J10odGhpcywgY29kZSk7CiAgfQoKICBpZiAoIXRoaXMubWVzc2FnZSkgewogICAgdGhpcy5tZXNzYWdlID0gTWVkaWFFcnJvci5kZWZhdWx0TWVzc2FnZXNbdGhpcy5jb2RlXSB8fCAnJzsKICB9Cn07CgovKgogKiBUaGUgZXJyb3IgY29kZSB0aGF0IHJlZmVycyB0d28gb25lIG9mIHRoZSBkZWZpbmVkCiAqIE1lZGlhRXJyb3IgdHlwZXMKICoKICogQHR5cGUge051bWJlcn0KICovCk1lZGlhRXJyb3IucHJvdG90eXBlLmNvZGUgPSAwOwoKLyoKICogQW4gb3B0aW9uYWwgbWVzc2FnZSB0byBiZSBzaG93biB3aXRoIHRoZSBlcnJvci4KICogTWVzc2FnZSBpcyBub3QgcGFydCBvZiB0aGUgSFRNTDUgdmlkZW8gc3BlYwogKiBidXQgYWxsb3dzIGZvciBtb3JlIGluZm9ybWF0aXZlIGN1c3RvbSBlcnJvcnMuCiAqCiAqIEB0eXBlIHtTdHJpbmd9CiAqLwpNZWRpYUVycm9yLnByb3RvdHlwZS5tZXNzYWdlID0gJyc7CgovKgogKiBBbiBvcHRpb25hbCBzdGF0dXMgY29kZSB0aGF0IGNhbiBiZSBzZXQgYnkgcGx1Z2lucwogKiB0byBhbGxvdyBldmVuIG1vcmUgZGV0YWlsIGFib3V0IHRoZSBlcnJvci4KICogRm9yIGV4YW1wbGUgdGhlIEhMUyBwbHVnaW4gbWlnaHQgcHJvdmlkZSB0aGUgc3BlY2lmaWMKICogSFRUUCBzdGF0dXMgY29kZSB0aGF0IHdhcyByZXR1cm5lZCB3aGVuIHRoZSBlcnJvcgogKiBvY2N1cnJlZCwgdGhlbiBhbGxvd2luZyBhIGN1c3RvbSBlcnJvciBvdmVybGF5CiAqIHRvIGRpc3BsYXkgbW9yZSBpbmZvcm1hdGlvbi4KICoKICogQHR5cGUge0FycmF5fQogKi8KTWVkaWFFcnJvci5wcm90b3R5cGUuc3RhdHVzID0gbnVsbDsKCk1lZGlhRXJyb3IuZXJyb3JUeXBlcyA9IFsnTUVESUFfRVJSX0NVU1RPTScsIC8vID0gMAonTUVESUFfRVJSX0FCT1JURUQnLCAvLyA9IDEKJ01FRElBX0VSUl9ORVRXT1JLJywgLy8gPSAyCidNRURJQV9FUlJfREVDT0RFJywgLy8gPSAzCidNRURJQV9FUlJfU1JDX05PVF9TVVBQT1JURUQnLCAvLyA9IDQKJ01FRElBX0VSUl9FTkNSWVBURUQnIC8vID0gNQpdOwoKTWVkaWFFcnJvci5kZWZhdWx0TWVzc2FnZXMgPSB7CiAgMTogJ1lvdSBhYm9ydGVkIHRoZSBtZWRpYSBwbGF5YmFjaycsCiAgMjogJ0EgbmV0d29yayBlcnJvciBjYXVzZWQgdGhlIG1lZGlhIGRvd25sb2FkIHRvIGZhaWwgcGFydC13YXkuJywKICAzOiAnVGhlIG1lZGlhIHBsYXliYWNrIHdhcyBhYm9ydGVkIGR1ZSB0byBhIGNvcnJ1cHRpb24gcHJvYmxlbSBvciBiZWNhdXNlIHRoZSBtZWRpYSB1c2VkIGZlYXR1cmVzIHlvdXIgYnJvd3NlciBkaWQgbm90IHN1cHBvcnQuJywKICA0OiAnVGhlIG1lZGlhIGNvdWxkIG5vdCBiZSBsb2FkZWQsIGVpdGhlciBiZWNhdXNlIHRoZSBzZXJ2ZXIgb3IgbmV0d29yayBmYWlsZWQgb3IgYmVjYXVzZSB0aGUgZm9ybWF0IGlzIG5vdCBzdXBwb3J0ZWQuJywKICA1OiAnVGhlIG1lZGlhIGlzIGVuY3J5cHRlZCBhbmQgd2UgZG8gbm90IGhhdmUgdGhlIGtleXMgdG8gZGVjcnlwdCBpdC4nCn07CgovLyBBZGQgdHlwZXMgYXMgcHJvcGVydGllcyBvbiBNZWRpYUVycm9yCi8vIGUuZy4gTWVkaWFFcnJvci5NRURJQV9FUlJfU1JDX05PVF9TVVBQT1JURUQgPSA0Owpmb3IgKHZhciBlcnJOdW0gPSAwOyBlcnJOdW0gPCBNZWRpYUVycm9yLmVycm9yVHlwZXMubGVuZ3RoOyBlcnJOdW0rKykgewogIE1lZGlhRXJyb3JbTWVkaWFFcnJvci5lcnJvclR5cGVzW2Vyck51bV1dID0gZXJyTnVtOwogIC8vIHZhbHVlcyBzaG91bGQgYmUgYWNjZXNzaWJsZSBvbiBib3RoIHRoZSBjbGFzcyBhbmQgaW5zdGFuY2UKICBNZWRpYUVycm9yLnByb3RvdHlwZVtNZWRpYUVycm9yLmVycm9yVHlwZXNbZXJyTnVtXV0gPSBlcnJOdW07Cn0KCmV4cG9ydHNbJ2RlZmF1bHQnXSA9IE1lZGlhRXJyb3I7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Im9iamVjdC5hc3NpZ24iOjQ1fV0sMTAyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIG1lbnUtYnV0dG9uLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfYnV0dG9uSnMgPSBfZGVyZXFfKCcuLi9idXR0b24uanMnKTsKCnZhciBfYnV0dG9uSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnV0dG9uSnMpOwoKdmFyIF9jb21wb25lbnRKcyA9IF9kZXJlcV8oJy4uL2NvbXBvbmVudC5qcycpOwoKdmFyIF9jb21wb25lbnRKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRKcyk7Cgp2YXIgX21lbnVKcyA9IF9kZXJlcV8oJy4vbWVudS5qcycpOwoKdmFyIF9tZW51SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVudUpzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2RvbS5qcycpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbUpzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF91dGlsc1RvVGl0bGVDYXNlSnMgPSBfZGVyZXFfKCcuLi91dGlscy90by10aXRsZS1jYXNlLmpzJyk7Cgp2YXIgX3V0aWxzVG9UaXRsZUNhc2VKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc1RvVGl0bGVDYXNlSnMpOwoKLyoqCiAqIEEgYnV0dG9uIGNsYXNzIHdpdGggYSBwb3B1cCBtZW51CiAqCiAqIEBwYXJhbSB7UGxheWVyfE9iamVjdH0gcGxheWVyCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucwogKiBAZXh0ZW5kcyBCdXR0b24KICogQGNsYXNzIE1lbnVCdXR0b24KICovCgp2YXIgTWVudUJ1dHRvbiA9IChmdW5jdGlvbiAoX0J1dHRvbikgewogIF9pbmhlcml0cyhNZW51QnV0dG9uLCBfQnV0dG9uKTsKCiAgZnVuY3Rpb24gTWVudUJ1dHRvbihwbGF5ZXIpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lbnVCdXR0b24pOwoKICAgIF9CdXR0b24uY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwoKICAgIHRoaXMudXBkYXRlKCk7CgogICAgdGhpcy5vbigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5UHJlc3MpOwogICAgdGhpcy5lbF8uc2V0QXR0cmlidXRlKCdhcmlhLWhhc3BvcHVwJywgdHJ1ZSk7CiAgICB0aGlzLmVsXy5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnYnV0dG9uJyk7CiAgfQoKICAvKioKICAgKiBVcGRhdGUgbWVudQogICAqCiAgICogQG1ldGhvZCB1cGRhdGUKICAgKi8KCiAgTWVudUJ1dHRvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKCkgewogICAgdmFyIG1lbnUgPSB0aGlzLmNyZWF0ZU1lbnUoKTsKCiAgICBpZiAodGhpcy5tZW51KSB7CiAgICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5tZW51KTsKICAgIH0KCiAgICB0aGlzLm1lbnUgPSBtZW51OwogICAgdGhpcy5hZGRDaGlsZChtZW51KTsKCiAgICAvKioKICAgICAqIFRyYWNrIHRoZSBzdGF0ZSBvZiB0aGUgbWVudSBidXR0b24KICAgICAqCiAgICAgKiBAdHlwZSB7Qm9vbGVhbn0KICAgICAqIEBwcml2YXRlCiAgICAgKi8KICAgIHRoaXMuYnV0dG9uUHJlc3NlZF8gPSBmYWxzZTsKCiAgICBpZiAodGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICB0aGlzLmhpZGUoKTsKICAgIH0gZWxzZSBpZiAodGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zLmxlbmd0aCA+IDEpIHsKICAgICAgdGhpcy5zaG93KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIG1lbnUKICAgKgogICAqIEByZXR1cm4ge01lbnV9IFRoZSBjb25zdHJ1Y3RlZCBtZW51CiAgICogQG1ldGhvZCBjcmVhdGVNZW51CiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU1lbnUgPSBmdW5jdGlvbiBjcmVhdGVNZW51KCkgewogICAgdmFyIG1lbnUgPSBuZXcgX21lbnVKczJbJ2RlZmF1bHQnXSh0aGlzLnBsYXllcl8pOwoKICAgIC8vIEFkZCBhIHRpdGxlIGxpc3QgaXRlbSB0byB0aGUgdG9wCiAgICBpZiAodGhpcy5vcHRpb25zXy50aXRsZSkgewogICAgICBtZW51LmNvbnRlbnRFbCgpLmFwcGVuZENoaWxkKERvbS5jcmVhdGVFbCgnbGknLCB7CiAgICAgICAgY2xhc3NOYW1lOiAndmpzLW1lbnUtdGl0bGUnLAogICAgICAgIGlubmVySFRNTDogX3V0aWxzVG9UaXRsZUNhc2VKczJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnNfLnRpdGxlKSwKICAgICAgICB0YWJJbmRleDogLTEKICAgICAgfSkpOwogICAgfQoKICAgIHRoaXMuaXRlbXMgPSB0aGlzWydjcmVhdGVJdGVtcyddKCk7CgogICAgaWYgKHRoaXMuaXRlbXMpIHsKICAgICAgLy8gQWRkIG1lbnUgaXRlbXMgdG8gdGhlIG1lbnUKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbWVudS5hZGRJdGVtKHRoaXMuaXRlbXNbaV0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG1lbnU7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBsaXN0IG9mIG1lbnUgaXRlbXMuIFNwZWNpZmljIHRvIGVhY2ggc3ViY2xhc3MuCiAgICoKICAgKiBAbWV0aG9kIGNyZWF0ZUl0ZW1zCiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLmNyZWF0ZUl0ZW1zID0gZnVuY3Rpb24gY3JlYXRlSXRlbXMoKSB7fTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0J1dHRvbi5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6IHRoaXMuYnVpbGRDU1NDbGFzcygpCiAgICB9KTsKICB9OwoKICAvKioKICAgKiBBbGxvdyBzdWIgY29tcG9uZW50cyB0byBzdGFjayBDU1MgY2xhc3MgbmFtZXMKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGNvbnN0cnVjdGVkIGNsYXNzIG5hbWUKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKi8KCiAgTWVudUJ1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcyA9IGZ1bmN0aW9uIGJ1aWxkQ1NTQ2xhc3MoKSB7CiAgICB2YXIgbWVudUJ1dHRvbkNsYXNzID0gJ3Zqcy1tZW51LWJ1dHRvbic7CgogICAgLy8gSWYgdGhlIGlubGluZSBvcHRpb24gaXMgcGFzc2VkLCB3ZSB3YW50IHRvIHVzZSBkaWZmZXJlbnQgc3R5bGVzIGFsdG9nZXRoZXIuCiAgICBpZiAodGhpcy5vcHRpb25zXy5pbmxpbmUgPT09IHRydWUpIHsKICAgICAgbWVudUJ1dHRvbkNsYXNzICs9ICctaW5saW5lJzsKICAgIH0gZWxzZSB7CiAgICAgIG1lbnVCdXR0b25DbGFzcyArPSAnLXBvcHVwJzsKICAgIH0KCiAgICByZXR1cm4gJ3Zqcy1tZW51LWJ1dHRvbiAnICsgbWVudUJ1dHRvbkNsYXNzICsgJyAnICsgX0J1dHRvbi5wcm90b3R5cGUuYnVpbGRDU1NDbGFzcy5jYWxsKHRoaXMpOwogIH07CgogIC8qKgogICAqIEZvY3VzIC0gQWRkIGtleWJvYXJkIGZ1bmN0aW9uYWxpdHkgdG8gZWxlbWVudAogICAqIFRoaXMgZnVuY3Rpb24gaXMgbm90IG5lZWRlZCBhbnltb3JlLiBJbnN0ZWFkLCB0aGUKICAgKiBrZXlib2FyZCBmdW5jdGlvbmFsaXR5IGlzIGhhbmRsZWQgYnkKICAgKiB0cmVhdGluZyB0aGUgYnV0dG9uIGFzIHRyaWdnZXJpbmcgYSBzdWJtZW51LgogICAqIFdoZW4gdGhlIGJ1dHRvbiBpcyBwcmVzc2VkLCB0aGUgc3VibWVudQogICAqIGFwcGVhcnMuIFByZXNzaW5nIHRoZSBidXR0b24gYWdhaW4gbWFrZXMKICAgKiB0aGUgc3VibWVudSBkaXNhcHBlYXIuCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUZvY3VzCiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLmhhbmRsZUZvY3VzID0gZnVuY3Rpb24gaGFuZGxlRm9jdXMoKSB7fTsKCiAgLyoqCiAgICogQ2FuJ3QgdHVybiBvZmYgbGlzdCBkaXNwbGF5IHRoYXQgd2UgdHVybmVkCiAgICogb24gd2l0aCBmb2N1cywgYmVjYXVzZSBsaXN0IHdvdWxkIGdvIGF3YXkuCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUJsdXIKICAgKi8KCiAgTWVudUJ1dHRvbi5wcm90b3R5cGUuaGFuZGxlQmx1ciA9IGZ1bmN0aW9uIGhhbmRsZUJsdXIoKSB7fTsKCiAgLyoqCiAgICogV2hlbiB5b3UgY2xpY2sgdGhlIGJ1dHRvbiBpdCBhZGRzIGZvY3VzLCB3aGljaAogICAqIHdpbGwgc2hvdyB0aGUgbWVudSBpbmRlZmluaXRlbHkuCiAgICogU28gd2UnbGwgcmVtb3ZlIGZvY3VzIHdoZW4gdGhlIG1vdXNlIGxlYXZlcyB0aGUgYnV0dG9uLgogICAqIEZvY3VzIGlzIG5lZWRlZCBmb3IgdGFiIG5hdmlnYXRpb24uCiAgICogQWxsb3cgc3ViIGNvbXBvbmVudHMgdG8gc3RhY2sgQ1NTIGNsYXNzIG5hbWVzCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUNsaWNrCiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLmhhbmRsZUNsaWNrID0gZnVuY3Rpb24gaGFuZGxlQ2xpY2soKSB7CiAgICB0aGlzLm9uZSgnbW91c2VvdXQnLCBGbi5iaW5kKHRoaXMsIGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5tZW51LnVubG9ja1Nob3dpbmcoKTsKICAgICAgdGhpcy5lbF8uYmx1cigpOwogICAgfSkpOwogICAgaWYgKHRoaXMuYnV0dG9uUHJlc3NlZF8pIHsKICAgICAgdGhpcy51bnByZXNzQnV0dG9uKCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnByZXNzQnV0dG9uKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGtleSBwcmVzcyBvbiBtZW51CiAgICoKICAgKiBAcGFyYW0ge09iamVjdH0gS2V5IHByZXNzIGV2ZW50CiAgICogQG1ldGhvZCBoYW5kbGVLZXlQcmVzcwogICAqLwoKICBNZW51QnV0dG9uLnByb3RvdHlwZS5oYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uIGhhbmRsZUtleVByZXNzKGV2ZW50KSB7CgogICAgLy8gQ2hlY2sgZm9yIHNwYWNlIGJhciAoMzIpIG9yIGVudGVyICgxMykga2V5cwogICAgaWYgKGV2ZW50LndoaWNoID09PSAzMiB8fCBldmVudC53aGljaCA9PT0gMTMpIHsKICAgICAgaWYgKHRoaXMuYnV0dG9uUHJlc3NlZF8pIHsKICAgICAgICB0aGlzLnVucHJlc3NCdXR0b24oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnByZXNzQnV0dG9uKCk7CiAgICAgIH0KICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgLy8gQ2hlY2sgZm9yIGVzY2FwZSAoMjcpIGtleQogICAgfSBlbHNlIGlmIChldmVudC53aGljaCA9PT0gMjcpIHsKICAgICAgICBpZiAodGhpcy5idXR0b25QcmVzc2VkXykgewogICAgICAgICAgdGhpcy51bnByZXNzQnV0dG9uKCk7CiAgICAgICAgfQogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICB9OwoKICAvKioKICAgKiBNYWtlcyBjaGFuZ2VzIGJhc2VkIG9uIGJ1dHRvbiBwcmVzc2VkCiAgICoKICAgKiBAbWV0aG9kIHByZXNzQnV0dG9uCiAgICovCgogIE1lbnVCdXR0b24ucHJvdG90eXBlLnByZXNzQnV0dG9uID0gZnVuY3Rpb24gcHJlc3NCdXR0b24oKSB7CiAgICB0aGlzLmJ1dHRvblByZXNzZWRfID0gdHJ1ZTsKICAgIHRoaXMubWVudS5sb2NrU2hvd2luZygpOwogICAgdGhpcy5lbF8uc2V0QXR0cmlidXRlKCdhcmlhLXByZXNzZWQnLCB0cnVlKTsKICAgIGlmICh0aGlzLml0ZW1zICYmIHRoaXMuaXRlbXMubGVuZ3RoID4gMCkgewogICAgICB0aGlzLml0ZW1zWzBdLmVsKCkuZm9jdXMoKTsgLy8gc2V0IHRoZSBmb2N1cyB0byB0aGUgdGl0bGUgb2YgdGhlIHN1Ym1lbnUKICAgIH0KICB9OwoKICAvKioKICAgKiBNYWtlcyBjaGFuZ2VzIGJhc2VkIG9uIGJ1dHRvbiB1bnByZXNzZWQKICAgKgogICAqIEBtZXRob2QgdW5wcmVzc0J1dHRvbgogICAqLwoKICBNZW51QnV0dG9uLnByb3RvdHlwZS51bnByZXNzQnV0dG9uID0gZnVuY3Rpb24gdW5wcmVzc0J1dHRvbigpIHsKICAgIHRoaXMuYnV0dG9uUHJlc3NlZF8gPSBmYWxzZTsKICAgIHRoaXMubWVudS51bmxvY2tTaG93aW5nKCk7CiAgICB0aGlzLmVsXy5zZXRBdHRyaWJ1dGUoJ2FyaWEtcHJlc3NlZCcsIGZhbHNlKTsKICB9OwoKICByZXR1cm4gTWVudUJ1dHRvbjsKfSkoX2J1dHRvbkpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnTWVudUJ1dHRvbicsIE1lbnVCdXR0b24pOwpleHBvcnRzWydkZWZhdWx0J10gPSBNZW51QnV0dG9uOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9idXR0b24uanMiOjYzLCIuLi9jb21wb25lbnQuanMiOjY1LCIuLi91dGlscy9kb20uanMiOjEyOCwiLi4vdXRpbHMvZm4uanMiOjEzMCwiLi4vdXRpbHMvdG8tdGl0bGUtY2FzZS5qcyI6MTM3LCIuL21lbnUuanMiOjEwNH1dLDEwMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBtZW51LWl0ZW0uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2J1dHRvbkpzID0gX2RlcmVxXygnLi4vYnV0dG9uLmpzJyk7Cgp2YXIgX2J1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2J1dHRvbkpzKTsKCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF9vYmplY3RBc3NpZ24gPSBfZGVyZXFfKCdvYmplY3QuYXNzaWduJyk7Cgp2YXIgX29iamVjdEFzc2lnbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9vYmplY3RBc3NpZ24pOwoKLyoqCiAqIFRoZSBjb21wb25lbnQgZm9yIGEgbWVudSBpdGVtLiBgPGxpPmAKICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIEJ1dHRvbgogKiBAY2xhc3MgTWVudUl0ZW0KICovCgp2YXIgTWVudUl0ZW0gPSAoZnVuY3Rpb24gKF9CdXR0b24pIHsKICBfaW5oZXJpdHMoTWVudUl0ZW0sIF9CdXR0b24pOwoKICBmdW5jdGlvbiBNZW51SXRlbShwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZW51SXRlbSk7CgogICAgX0J1dHRvbi5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLnNlbGVjdGVkKG9wdGlvbnNbJ3NlbGVjdGVkJ10pOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHBhcmFtIHtTdHJpbmc9fSB0eXBlIERlc2MKICAgKiBAcGFyYW0ge09iamVjdD19IHByb3BzIERlc2MKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgTWVudUl0ZW0ucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwodHlwZSwgcHJvcHMsIGF0dHJzKSB7CiAgICByZXR1cm4gX0J1dHRvbi5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnbGknLCBfb2JqZWN0QXNzaWduMlsnZGVmYXVsdCddKHsKICAgICAgY2xhc3NOYW1lOiAndmpzLW1lbnUtaXRlbScsCiAgICAgIGlubmVySFRNTDogdGhpcy5sb2NhbGl6ZSh0aGlzLm9wdGlvbnNfWydsYWJlbCddKQogICAgfSwgcHJvcHMpLCBhdHRycyk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGEgY2xpY2sgb24gdGhlIG1lbnUgaXRlbSwgYW5kIHNldCBpdCB0byBzZWxlY3RlZAogICAqCiAgICogQG1ldGhvZCBoYW5kbGVDbGljawogICAqLwoKICBNZW51SXRlbS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVDbGljaygpIHsKICAgIHRoaXMuc2VsZWN0ZWQodHJ1ZSk7CiAgfTsKCiAgLyoqCiAgICogU2V0IHRoaXMgbWVudSBpdGVtIGFzIHNlbGVjdGVkIG9yIG5vdAogICAqCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gc2VsZWN0ZWQKICAgKiBAbWV0aG9kIHNlbGVjdGVkCiAgICovCgogIE1lbnVJdGVtLnByb3RvdHlwZS5zZWxlY3RlZCA9IGZ1bmN0aW9uIHNlbGVjdGVkKF9zZWxlY3RlZCkgewogICAgaWYgKF9zZWxlY3RlZCkgewogICAgICB0aGlzLmFkZENsYXNzKCd2anMtc2VsZWN0ZWQnKTsKICAgICAgdGhpcy5lbF8uc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgdHJ1ZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtc2VsZWN0ZWQnKTsKICAgICAgdGhpcy5lbF8uc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgZmFsc2UpOwogICAgfQogIH07CgogIHJldHVybiBNZW51SXRlbTsKfSkoX2J1dHRvbkpzMlsnZGVmYXVsdCddKTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnTWVudUl0ZW0nLCBNZW51SXRlbSk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IE1lbnVJdGVtOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9idXR0b24uanMiOjYzLCIuLi9jb21wb25lbnQuanMiOjY1LCJvYmplY3QuYXNzaWduIjo0NX1dLDEwNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBtZW51LmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX3V0aWxzRXZlbnRzSnMgPSBfZGVyZXFfKCcuLi91dGlscy9ldmVudHMuanMnKTsKCnZhciBFdmVudHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNFdmVudHNKcyk7CgovKioKICogVGhlIE1lbnUgY29tcG9uZW50IGlzIHVzZWQgdG8gYnVpbGQgcG9wIHVwIG1lbnVzLCBpbmNsdWRpbmcgc3VidGl0bGUgYW5kCiAqIGNhcHRpb25zIHNlbGVjdGlvbiBtZW51cy4KICoKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBNZW51CiAqLwoKdmFyIE1lbnUgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoTWVudSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIE1lbnUoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVudSk7CgogICAgX0NvbXBvbmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgLyoqCiAgICogQWRkIGEgbWVudSBpdGVtIHRvIHRoZSBtZW51CiAgICoKICAgKiBAcGFyYW0ge09iamVjdHxTdHJpbmd9IGNvbXBvbmVudCBDb21wb25lbnQgb3IgY29tcG9uZW50IHR5cGUgdG8gYWRkCiAgICogQG1ldGhvZCBhZGRJdGVtCiAgICovCgogIE1lbnUucHJvdG90eXBlLmFkZEl0ZW0gPSBmdW5jdGlvbiBhZGRJdGVtKGNvbXBvbmVudCkgewogICAgdGhpcy5hZGRDaGlsZChjb21wb25lbnQpOwogICAgY29tcG9uZW50Lm9uKCdjbGljaycsIEZuLmJpbmQodGhpcywgZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnVubG9ja1Nob3dpbmcoKTsKICAgIH0pKTsKICB9OwoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgTWVudS5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHZhciBjb250ZW50RWxUeXBlID0gdGhpcy5vcHRpb25zXy5jb250ZW50RWxUeXBlIHx8ICd1bCc7CiAgICB0aGlzLmNvbnRlbnRFbF8gPSBEb20uY3JlYXRlRWwoY29udGVudEVsVHlwZSwgewogICAgICBjbGFzc05hbWU6ICd2anMtbWVudS1jb250ZW50JwogICAgfSk7CiAgICB2YXIgZWwgPSBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGFwcGVuZDogdGhpcy5jb250ZW50RWxfLAogICAgICBjbGFzc05hbWU6ICd2anMtbWVudScKICAgIH0pOwogICAgZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50RWxfKTsKCiAgICAvLyBQcmV2ZW50IGNsaWNrcyBmcm9tIGJ1YmJsaW5nIHVwLiBOZWVkZWQgZm9yIE1lbnUgQnV0dG9ucywKICAgIC8vIHdoZXJlIGEgY2xpY2sgb24gdGhlIHBhcmVudCBpcyBzaWduaWZpY2FudAogICAgRXZlbnRzLm9uKGVsLCAnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7CiAgICB9KTsKCiAgICByZXR1cm4gZWw7CiAgfTsKCiAgcmV0dXJuIE1lbnU7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ01lbnUnLCBNZW51KTsKZXhwb3J0c1snZGVmYXVsdCddID0gTWVudTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uL3V0aWxzL2V2ZW50cy5qcyI6MTI5LCIuLi91dGlscy9mbi5qcyI6MTMwfV0sMTA1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIG1vZGFsLWRpYWxvZy5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCnZhciBfdXRpbHNEb20gPSBfZGVyZXFfKCcuL3V0aWxzL2RvbScpOwoKdmFyIERvbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0RvbSk7Cgp2YXIgX3V0aWxzRm4gPSBfZGVyZXFfKCcuL3V0aWxzL2ZuJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbik7Cgp2YXIgX3V0aWxzTG9nID0gX2RlcmVxXygnLi91dGlscy9sb2cnKTsKCnZhciBfdXRpbHNMb2cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNMb2cpOwoKdmFyIF9jb21wb25lbnQgPSBfZGVyZXFfKCcuL2NvbXBvbmVudCcpOwoKdmFyIF9jb21wb25lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50KTsKCnZhciBfY2xvc2VCdXR0b24gPSBfZGVyZXFfKCcuL2Nsb3NlLWJ1dHRvbicpOwoKdmFyIF9jbG9zZUJ1dHRvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbG9zZUJ1dHRvbik7Cgp2YXIgTU9EQUxfQ0xBU1NfTkFNRSA9ICd2anMtbW9kYWwtZGlhbG9nJzsKdmFyIEVTQyA9IDI3OwoKLyoqCiAqIFRoZSBgTW9kYWxEaWFsb2dgIGRpc3BsYXlzIG92ZXIgdGhlIHZpZGVvIGFuZCBpdHMgY29udHJvbHMsIHdoaWNoIGJsb2NrcwogKiBpbnRlcmFjdGlvbiB3aXRoIHRoZSBwbGF5ZXIgdW50aWwgaXQgaXMgY2xvc2VkLgogKgogKiBNb2RhbCBkaWFsb2dzIGluY2x1ZGUgYSAiQ2xvc2UiIGJ1dHRvbiBhbmQgd2lsbCBjbG9zZSB3aGVuIHRoYXQgYnV0dG9uCiAqIGlzIGFjdGl2YXRlZCAtIG9yIHdoZW4gRVNDIGlzIHByZXNzZWQgYW55d2hlcmUuCiAqCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgTW9kYWxEaWFsb2cKICovCgp2YXIgTW9kYWxEaWFsb2cgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoTW9kYWxEaWFsb2csIF9Db21wb25lbnQpOwoKICAvKioKICAgKiBDb25zdHJ1Y3RvciBmb3IgbW9kYWxzLgogICAqCiAgICogQHBhcmFtICB7UGxheWVyfSBwbGF5ZXIKICAgKiBAcGFyYW0gIHtPYmplY3R9IFtvcHRpb25zXQogICAqIEBwYXJhbSAge01peGVkfSBbb3B0aW9ucy5jb250ZW50PXVuZGVmaW5lZF0KICAgKiAgICAgICAgIFByb3ZpZGUgY3VzdG9taXplZCBjb250ZW50IGZvciB0aGlzIG1vZGFsLgogICAqCiAgICogQHBhcmFtICB7U3RyaW5nfSBbb3B0aW9ucy5kZXNjcmlwdGlvbl0KICAgKiAgICAgICAgIEEgdGV4dCBkZXNjcmlwdGlvbiBmb3IgdGhlIG1vZGFsLCBwcmltYXJpbHkgZm9yIGFjY2Vzc2liaWxpdHkuCiAgICoKICAgKiBAcGFyYW0gIHtCb29sZWFufSBbb3B0aW9ucy5maWxsQWx3YXlzPWZhbHNlXQogICAqICAgICAgICAgTm9ybWFsbHksIG1vZGFscyBhcmUgYXV0b21hdGljYWxseSBmaWxsZWQgb25seSB0aGUgZmlyc3QgdGltZQogICAqICAgICAgICAgdGhleSBvcGVuLiBUaGlzIHRlbGxzIHRoZSBtb2RhbCB0byByZWZyZXNoIGl0cyBjb250ZW50CiAgICogICAgICAgICBldmVyeSB0aW1lIGl0IG9wZW5zLgogICAqCiAgICogQHBhcmFtICB7U3RyaW5nfSBbb3B0aW9ucy5sYWJlbF0KICAgKiAgICAgICAgIEEgdGV4dCBsYWJlbCBmb3IgdGhlIG1vZGFsLCBwcmltYXJpbHkgZm9yIGFjY2Vzc2liaWxpdHkuCiAgICoKICAgKiBAcGFyYW0gIHtCb29sZWFufSBbb3B0aW9ucy50ZW1wb3Jhcnk9dHJ1ZV0KICAgKiAgICAgICAgIElmIGB0cnVlYCwgdGhlIG1vZGFsIGNhbiBvbmx5IGJlIG9wZW5lZCBvbmNlOyBpdCB3aWxsIGJlCiAgICogICAgICAgICBkaXNwb3NlZCBhcyBzb29uIGFzIGl0J3MgY2xvc2VkLgogICAqCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gW29wdGlvbnMudW5jbG9zZWFibGU9ZmFsc2VdCiAgICogICAgICAgICBJZiBgdHJ1ZWAsIHRoZSB1c2VyIHdpbGwgbm90IGJlIGFibGUgdG8gY2xvc2UgdGhlIG1vZGFsCiAgICogICAgICAgICB0aHJvdWdoIHRoZSBVSSBpbiB0aGUgbm9ybWFsIHdheXMuIFByb2dyYW1tYXRpYyBjbG9zaW5nIGlzCiAgICogICAgICAgICBzdGlsbCBwb3NzaWJsZS4KICAgKgogICAqLwoKICBmdW5jdGlvbiBNb2RhbERpYWxvZyhwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNb2RhbERpYWxvZyk7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLm9wZW5lZF8gPSB0aGlzLmhhc0JlZW5PcGVuZWRfID0gdGhpcy5oYXNCZWVuRmlsbGVkXyA9IGZhbHNlOwoKICAgIHRoaXMuY2xvc2VhYmxlKCF0aGlzLm9wdGlvbnNfLnVuY2xvc2VhYmxlKTsKICAgIHRoaXMuY29udGVudCh0aGlzLm9wdGlvbnNfLmNvbnRlbnQpOwoKICAgIC8vIE1ha2Ugc3VyZSB0aGUgY29udGVudEVsIGlzIGRlZmluZWQgQUZURVIgYW55IGNoaWxkcmVuIGFyZSBpbml0aWFsaXplZAogICAgLy8gYmVjYXVzZSB3ZSBvbmx5IHdhbnQgdGhlIGNvbnRlbnRzIG9mIHRoZSBtb2RhbCBpbiB0aGUgY29udGVudEVsCiAgICAvLyAobm90IHRoZSBVSSBlbGVtZW50cyBsaWtlIHRoZSBjbG9zZSBidXR0b24pLgogICAgdGhpcy5jb250ZW50RWxfID0gRG9tLmNyZWF0ZUVsKCdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogTU9EQUxfQ0xBU1NfTkFNRSArICctY29udGVudCcKICAgIH0sIHsKICAgICAgcm9sZTogJ2RvY3VtZW50JwogICAgfSk7CgogICAgdGhpcy5kZXNjRWxfID0gRG9tLmNyZWF0ZUVsKCdwJywgewogICAgICBjbGFzc05hbWU6IE1PREFMX0NMQVNTX05BTUUgKyAnLWRlc2NyaXB0aW9uIHZqcy1vZmZzY3JlZW4nLAogICAgICBpZDogdGhpcy5lbCgpLmdldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScpCiAgICB9KTsKCiAgICBEb20udGV4dENvbnRlbnQodGhpcy5kZXNjRWxfLCB0aGlzLmRlc2NyaXB0aW9uKCkpOwogICAgdGhpcy5lbF8uYXBwZW5kQ2hpbGQodGhpcy5kZXNjRWxfKTsKICAgIHRoaXMuZWxfLmFwcGVuZENoaWxkKHRoaXMuY29udGVudEVsXyk7CiAgfQoKICAvKgogICAqIE1vZGFsIGRpYWxvZyBkZWZhdWx0IG9wdGlvbnMuCiAgICoKICAgKiBAdHlwZSB7T2JqZWN0fQogICAqIEBwcml2YXRlCiAgICovCgogIC8qKgogICAqIENyZWF0ZSB0aGUgbW9kYWwncyBET00gZWxlbWVudAogICAqCiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgcmV0dXJuIF9Db21wb25lbnQucHJvdG90eXBlLmNyZWF0ZUVsLmNhbGwodGhpcywgJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiB0aGlzLmJ1aWxkQ1NTQ2xhc3MoKSwKICAgICAgdGFiSW5kZXg6IC0xCiAgICB9LCB7CiAgICAgICdhcmlhLWRlc2NyaWJlZGJ5JzogdGhpcy5pZCgpICsgJ19kZXNjcmlwdGlvbicsCiAgICAgICdhcmlhLWhpZGRlbic6ICd0cnVlJywKICAgICAgJ2FyaWEtbGFiZWwnOiB0aGlzLmxhYmVsKCksCiAgICAgIHJvbGU6ICdkaWFsb2cnCiAgICB9KTsKICB9OwoKICAvKioKICAgKiBCdWlsZCB0aGUgbW9kYWwncyBDU1MgY2xhc3MuCiAgICoKICAgKiBAbWV0aG9kIGJ1aWxkQ1NTQ2xhc3MKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5idWlsZENTU0NsYXNzID0gZnVuY3Rpb24gYnVpbGRDU1NDbGFzcygpIHsKICAgIHJldHVybiBNT0RBTF9DTEFTU19OQU1FICsgJyB2anMtaGlkZGVuICcgKyBfQ29tcG9uZW50LnByb3RvdHlwZS5idWlsZENTU0NsYXNzLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlcyBrZXkgcHJlc3NlcyBvbiB0aGUgZG9jdW1lbnQsIGxvb2tpbmcgZm9yIEVTQywgd2hpY2ggY2xvc2VzCiAgICogdGhlIG1vZGFsLgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVLZXlQcmVzcwogICAqIEBwYXJhbSAge0V2ZW50fSBlCiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5oYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uIGhhbmRsZUtleVByZXNzKGUpIHsKICAgIGlmIChlLndoaWNoID09PSBFU0MgJiYgdGhpcy5jbG9zZWFibGUoKSkgewogICAgICB0aGlzLmNsb3NlKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB0aGUgbGFiZWwgc3RyaW5nIGZvciB0aGlzIG1vZGFsLiBQcmltYXJpbHkgdXNlZCBmb3IgYWNjZXNzaWJpbGl0eS4KICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30KICAgKi8KCiAgTW9kYWxEaWFsb2cucHJvdG90eXBlLmxhYmVsID0gZnVuY3Rpb24gbGFiZWwoKSB7CiAgICByZXR1cm4gdGhpcy5vcHRpb25zXy5sYWJlbCB8fCB0aGlzLmxvY2FsaXplKCdNb2RhbCBXaW5kb3cnKTsKICB9OwoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBkZXNjcmlwdGlvbiBzdHJpbmcgZm9yIHRoaXMgbW9kYWwuIFByaW1hcmlseSB1c2VkIGZvcgogICAqIGFjY2Vzc2liaWxpdHkuCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5kZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGRlc2NyaXB0aW9uKCkgewogICAgdmFyIGRlc2MgPSB0aGlzLm9wdGlvbnNfLmRlc2NyaXB0aW9uIHx8IHRoaXMubG9jYWxpemUoJ1RoaXMgaXMgYSBtb2RhbCB3aW5kb3cuJyk7CgogICAgLy8gQXBwZW5kIGEgdW5pdmVyc2FsIGNsb3NlYWJpbGl0eSBtZXNzYWdlIGlmIHRoZSBtb2RhbCBpcyBjbG9zZWFibGUuCiAgICBpZiAodGhpcy5jbG9zZWFibGUoKSkgewogICAgICBkZXNjICs9ICcgJyArIHRoaXMubG9jYWxpemUoJ1RoaXMgbW9kYWwgY2FuIGJlIGNsb3NlZCBieSBwcmVzc2luZyB0aGUgRXNjYXBlIGtleSBvciBhY3RpdmF0aW5nIHRoZSBjbG9zZSBidXR0b24uJyk7CiAgICB9CgogICAgcmV0dXJuIGRlc2M7CiAgfTsKCiAgLyoqCiAgICogT3BlbnMgdGhlIG1vZGFsLgogICAqCiAgICogQG1ldGhvZCBvcGVuCiAgICogQHJldHVybiB7TW9kYWxEaWFsb2d9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIGlmICghdGhpcy5vcGVuZWRfKSB7CiAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnBsYXllcigpOwoKICAgICAgdGhpcy50cmlnZ2VyKCdiZWZvcmVtb2RhbG9wZW4nKTsKICAgICAgdGhpcy5vcGVuZWRfID0gdHJ1ZTsKCiAgICAgIC8vIEZpbGwgY29udGVudCBpZiB0aGUgbW9kYWwgaGFzIG5ldmVyIG9wZW5lZCBiZWZvcmUgYW5kCiAgICAgIC8vIG5ldmVyIGJlZW4gZmlsbGVkLgogICAgICBpZiAodGhpcy5vcHRpb25zXy5maWxsQWx3YXlzIHx8ICF0aGlzLmhhc0JlZW5PcGVuZWRfICYmICF0aGlzLmhhc0JlZW5GaWxsZWRfKSB7CiAgICAgICAgdGhpcy5maWxsKCk7CiAgICAgIH0KCiAgICAgIC8vIElmIHRoZSBwbGF5ZXIgd2FzIHBsYXlpbmcsIHBhdXNlIGl0IGFuZCB0YWtlIG5vdGUgb2YgaXRzIHByZXZpb3VzbHkKICAgICAgLy8gcGxheWluZyBzdGF0ZS4KICAgICAgdGhpcy53YXNQbGF5aW5nXyA9ICFwbGF5ZXIucGF1c2VkKCk7CgogICAgICBpZiAodGhpcy53YXNQbGF5aW5nXykgewogICAgICAgIHBsYXllci5wYXVzZSgpOwogICAgICB9CgogICAgICBpZiAodGhpcy5jbG9zZWFibGUoKSkgewogICAgICAgIHRoaXMub24oX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAna2V5ZG93bicsIEZuLmJpbmQodGhpcywgdGhpcy5oYW5kbGVLZXlQcmVzcykpOwogICAgICB9CgogICAgICBwbGF5ZXIuY29udHJvbHMoZmFsc2UpOwogICAgICB0aGlzLnNob3coKTsKICAgICAgdGhpcy5lbCgpLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTsKICAgICAgdGhpcy50cmlnZ2VyKCdtb2RhbG9wZW4nKTsKICAgICAgdGhpcy5oYXNCZWVuT3BlbmVkXyA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBXaGV0aGVyIG9yIG5vdCB0aGUgbW9kYWwgaXMgb3BlbmVkIGN1cnJlbnRseS4KICAgKgogICAqIEBtZXRob2Qgb3BlbmVkCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gW3ZhbHVlXQogICAqICAgICAgICAgSWYgZ2l2ZW4sIGl0IHdpbGwgb3BlbiAoYHRydWVgKSBvciBjbG9zZSAoYGZhbHNlYCkgdGhlIG1vZGFsLgogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKi8KCiAgTW9kYWxEaWFsb2cucHJvdG90eXBlLm9wZW5lZCA9IGZ1bmN0aW9uIG9wZW5lZCh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgIHRoaXNbdmFsdWUgPyAnb3BlbicgOiAnY2xvc2UnXSgpOwogICAgfQogICAgcmV0dXJuIHRoaXMub3BlbmVkXzsKICB9OwoKICAvKioKICAgKiBDbG9zZXMgdGhlIG1vZGFsLgogICAqCiAgICogQG1ldGhvZCBjbG9zZQogICAqIEByZXR1cm4ge01vZGFsRGlhbG9nfQogICAqLwoKICBNb2RhbERpYWxvZy5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgIGlmICh0aGlzLm9wZW5lZF8pIHsKICAgICAgdmFyIHBsYXllciA9IHRoaXMucGxheWVyKCk7CgogICAgICB0aGlzLnRyaWdnZXIoJ2JlZm9yZW1vZGFsY2xvc2UnKTsKICAgICAgdGhpcy5vcGVuZWRfID0gZmFsc2U7CgogICAgICBpZiAodGhpcy53YXNQbGF5aW5nXykgewogICAgICAgIHBsYXllci5wbGF5KCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmNsb3NlYWJsZSgpKSB7CiAgICAgICAgdGhpcy5vZmYoX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAna2V5ZG93bicsIEZuLmJpbmQodGhpcywgdGhpcy5oYW5kbGVLZXlQcmVzcykpOwogICAgICB9CgogICAgICBwbGF5ZXIuY29udHJvbHModHJ1ZSk7CiAgICAgIHRoaXMuaGlkZSgpOwogICAgICB0aGlzLmVsKCkuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgIHRoaXMudHJpZ2dlcignbW9kYWxjbG9zZScpOwoKICAgICAgaWYgKHRoaXMub3B0aW9uc18udGVtcG9yYXJ5KSB7CiAgICAgICAgdGhpcy5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIFdoZXRoZXIgb3Igbm90IHRoZSBtb2RhbCBpcyBjbG9zZWFibGUgdmlhIHRoZSBVSS4KICAgKgogICAqIEBtZXRob2QgY2xvc2VhYmxlCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gW3ZhbHVlXQogICAqICAgICAgICAgSWYgZ2l2ZW4gYXMgYSBCb29sZWFuLCBpdCB3aWxsIHNldCB0aGUgYGNsb3NlYWJsZWAgb3B0aW9uLgogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKi8KCiAgTW9kYWxEaWFsb2cucHJvdG90eXBlLmNsb3NlYWJsZSA9IGZ1bmN0aW9uIGNsb3NlYWJsZSh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgIHZhciBjbG9zZWFibGUgPSB0aGlzLmNsb3NlYWJsZV8gPSAhIXZhbHVlOwogICAgICB2YXIgX2Nsb3NlID0gdGhpcy5nZXRDaGlsZCgnY2xvc2VCdXR0b24nKTsKCiAgICAgIC8vIElmIHRoaXMgaXMgYmVpbmcgbWFkZSBjbG9zZWFibGUgYW5kIGhhcyBubyBjbG9zZSBidXR0b24sIGFkZCBvbmUuCiAgICAgIGlmIChjbG9zZWFibGUgJiYgIV9jbG9zZSkgewoKICAgICAgICAvLyBUaGUgY2xvc2UgYnV0dG9uIHNob3VsZCBiZSBhIGNoaWxkIG9mIHRoZSBtb2RhbCAtIG5vdCBpdHMKICAgICAgICAvLyBjb250ZW50IGVsZW1lbnQsIHNvIHRlbXBvcmFyaWx5IGNoYW5nZSB0aGUgY29udGVudCBlbGVtZW50LgogICAgICAgIHZhciB0ZW1wID0gdGhpcy5jb250ZW50RWxfOwogICAgICAgIHRoaXMuY29udGVudEVsXyA9IHRoaXMuZWxfOwogICAgICAgIF9jbG9zZSA9IHRoaXMuYWRkQ2hpbGQoJ2Nsb3NlQnV0dG9uJyk7CiAgICAgICAgdGhpcy5jb250ZW50RWxfID0gdGVtcDsKICAgICAgICB0aGlzLm9uKF9jbG9zZSwgJ2Nsb3NlJywgdGhpcy5jbG9zZSk7CiAgICAgIH0KCiAgICAgIC8vIElmIHRoaXMgaXMgYmVpbmcgbWFkZSB1bmNsb3NlYWJsZSBhbmQgaGFzIGEgY2xvc2UgYnV0dG9uLCByZW1vdmUgaXQuCiAgICAgIGlmICghY2xvc2VhYmxlICYmIF9jbG9zZSkgewogICAgICAgIHRoaXMub2ZmKF9jbG9zZSwgJ2Nsb3NlJywgdGhpcy5jbG9zZSk7CiAgICAgICAgdGhpcy5yZW1vdmVDaGlsZChfY2xvc2UpOwogICAgICAgIF9jbG9zZS5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0aGlzLmNsb3NlYWJsZV87CiAgfTsKCiAgLyoqCiAgICogRmlsbCB0aGUgbW9kYWwncyBjb250ZW50IGVsZW1lbnQgd2l0aCB0aGUgbW9kYWwncyAiY29udGVudCIgb3B0aW9uLgogICAqCiAgICogVGhlIGNvbnRlbnQgZWxlbWVudCB3aWxsIGJlIGVtcHRpZWQgYmVmb3JlIHRoaXMgY2hhbmdlIHRha2VzIHBsYWNlLgogICAqCiAgICogQG1ldGhvZCBmaWxsCiAgICogQHJldHVybiB7TW9kYWxEaWFsb2d9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCgpIHsKICAgIHJldHVybiB0aGlzLmZpbGxXaXRoKHRoaXMuY29udGVudCgpKTsKICB9OwoKICAvKioKICAgKiBGaWxsIHRoZSBtb2RhbCdzIGNvbnRlbnQgZWxlbWVudCB3aXRoIGFyYml0cmFyeSBjb250ZW50LgogICAqCiAgICogVGhlIGNvbnRlbnQgZWxlbWVudCB3aWxsIGJlIGVtcHRpZWQgYmVmb3JlIHRoaXMgY2hhbmdlIHRha2VzIHBsYWNlLgogICAqCiAgICogQG1ldGhvZCBmaWxsV2l0aAogICAqIEBwYXJhbSAge01peGVkfSBbY29udGVudF0KICAgKiAgICAgICAgIFRoZSBzYW1lIHJ1bGVzIGFwcGx5IHRvIHRoaXMgYXMgYXBwbHkgdG8gdGhlIGBjb250ZW50YCBvcHRpb24uCiAgICoKICAgKiBAcmV0dXJuIHtNb2RhbERpYWxvZ30KICAgKi8KCiAgTW9kYWxEaWFsb2cucHJvdG90eXBlLmZpbGxXaXRoID0gZnVuY3Rpb24gZmlsbFdpdGgoY29udGVudCkgewogICAgdmFyIGNvbnRlbnRFbCA9IHRoaXMuY29udGVudEVsKCk7CiAgICB2YXIgcGFyZW50RWwgPSBjb250ZW50RWwucGFyZW50Tm9kZTsKICAgIHZhciBuZXh0U2libGluZ0VsID0gY29udGVudEVsLm5leHRTaWJsaW5nOwoKICAgIHRoaXMudHJpZ2dlcignYmVmb3JlbW9kYWxmaWxsJyk7CiAgICB0aGlzLmhhc0JlZW5GaWxsZWRfID0gdHJ1ZTsKCiAgICAvLyBEZXRhY2ggdGhlIGNvbnRlbnQgZWxlbWVudCBmcm9tIHRoZSBET00gYmVmb3JlIHBlcmZvcm1pbmcKICAgIC8vIG1hbmlwdWxhdGlvbiB0byBhdm9pZCBtb2RpZnlpbmcgdGhlIGxpdmUgRE9NIG11bHRpcGxlIHRpbWVzLgogICAgcGFyZW50RWwucmVtb3ZlQ2hpbGQoY29udGVudEVsKTsKICAgIHRoaXMuZW1wdHkoKTsKICAgIERvbS5pbnNlcnRDb250ZW50KGNvbnRlbnRFbCwgY29udGVudCk7CiAgICB0aGlzLnRyaWdnZXIoJ21vZGFsZmlsbCcpOwoKICAgIC8vIFJlLWluamVjdCB0aGUgcmUtZmlsbGVkIGNvbnRlbnQgZWxlbWVudC4KICAgIGlmIChuZXh0U2libGluZ0VsKSB7CiAgICAgIHBhcmVudEVsLmluc2VydEJlZm9yZShjb250ZW50RWwsIG5leHRTaWJsaW5nRWwpOwogICAgfSBlbHNlIHsKICAgICAgcGFyZW50RWwuYXBwZW5kQ2hpbGQoY29udGVudEVsKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBFbXB0aWVzIHRoZSBjb250ZW50IGVsZW1lbnQuCiAgICoKICAgKiBUaGlzIGhhcHBlbnMgYXV0b21hdGljYWxseSBhbnl0aW1lIHRoZSBtb2RhbCBpcyBmaWxsZWQuCiAgICoKICAgKiBAbWV0aG9kIGVtcHR5CiAgICogQHJldHVybiB7TW9kYWxEaWFsb2d9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5lbXB0eSA9IGZ1bmN0aW9uIGVtcHR5KCkgewogICAgdGhpcy50cmlnZ2VyKCdiZWZvcmVtb2RhbGVtcHR5Jyk7CiAgICBEb20uZW1wdHlFbCh0aGlzLmNvbnRlbnRFbCgpKTsKICAgIHRoaXMudHJpZ2dlcignbW9kYWxlbXB0eScpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogR2V0cyBvciBzZXRzIHRoZSBtb2RhbCBjb250ZW50LCB3aGljaCBnZXRzIG5vcm1hbGl6ZWQgYmVmb3JlIGJlaW5nCiAgICogcmVuZGVyZWQgaW50byB0aGUgRE9NLgogICAqCiAgICogVGhpcyBkb2VzIG5vdCB1cGRhdGUgdGhlIERPTSBvciBmaWxsIHRoZSBtb2RhbCwgYnV0IGl0IGlzIGNhbGxlZCBkdXJpbmcKICAgKiB0aGF0IHByb2Nlc3MuCiAgICoKICAgKiBAbWV0aG9kIGNvbnRlbnQKICAgKiBAcGFyYW0gIHtNaXhlZH0gW3ZhbHVlXQogICAqICAgICAgICAgSWYgZGVmaW5lZCwgc2V0cyB0aGUgaW50ZXJuYWwgY29udGVudCB2YWx1ZSB0byBiZSB1c2VkIG9uIHRoZQogICAqICAgICAgICAgbmV4dCBjYWxsKHMpIHRvIGBmaWxsYC4gVGhpcyB2YWx1ZSBpcyBub3JtYWxpemVkIGJlZm9yZSBiZWluZwogICAqICAgICAgICAgaW5zZXJ0ZWQuIFRvICJjbGVhciIgdGhlIGludGVybmFsIGNvbnRlbnQgdmFsdWUsIHBhc3MgYG51bGxgLgogICAqCiAgICogQHJldHVybiB7TWl4ZWR9CiAgICovCgogIE1vZGFsRGlhbG9nLnByb3RvdHlwZS5jb250ZW50ID0gZnVuY3Rpb24gY29udGVudCh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgdGhpcy5jb250ZW50XyA9IHZhbHVlOwogICAgfQogICAgcmV0dXJuIHRoaXMuY29udGVudF87CiAgfTsKCiAgcmV0dXJuIE1vZGFsRGlhbG9nOwp9KShfY29tcG9uZW50MlsnZGVmYXVsdCddKTsKCk1vZGFsRGlhbG9nLnByb3RvdHlwZS5vcHRpb25zXyA9IHsKICB0ZW1wb3Jhcnk6IHRydWUKfTsKCl9jb21wb25lbnQyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ01vZGFsRGlhbG9nJywgTW9kYWxEaWFsb2cpOwpleHBvcnRzWydkZWZhdWx0J10gPSBNb2RhbERpYWxvZzsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9jbG9zZS1idXR0b24iOjY0LCIuL2NvbXBvbmVudCI6NjUsIi4vdXRpbHMvZG9tIjoxMjgsIi4vdXRpbHMvZm4iOjEzMCwiLi91dGlscy9sb2ciOjEzMywiZ2xvYmFsL2RvY3VtZW50IjoxfV0sMTA2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHBsYXllci5qcwogKi8KLy8gU3ViY2xhc3NlcyBDb21wb25lbnQKJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgX2dsb2JhbFdpbmRvdyA9IF9kZXJlcV8oJ2dsb2JhbC93aW5kb3cnKTsKCnZhciBfZ2xvYmFsV2luZG93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbFdpbmRvdyk7Cgp2YXIgX3V0aWxzRXZlbnRzSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2V2ZW50cy5qcycpOwoKdmFyIEV2ZW50cyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0V2ZW50c0pzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNHdWlkSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2d1aWQuanMnKTsKCnZhciBHdWlkID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzR3VpZEpzKTsKCnZhciBfdXRpbHNCcm93c2VySnMgPSBfZGVyZXFfKCcuL3V0aWxzL2Jyb3dzZXIuanMnKTsKCnZhciBicm93c2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzQnJvd3NlckpzKTsKCnZhciBfdXRpbHNMb2dKcyA9IF9kZXJlcV8oJy4vdXRpbHMvbG9nLmpzJyk7Cgp2YXIgX3V0aWxzTG9nSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNMb2dKcyk7Cgp2YXIgX3V0aWxzVG9UaXRsZUNhc2VKcyA9IF9kZXJlcV8oJy4vdXRpbHMvdG8tdGl0bGUtY2FzZS5qcycpOwoKdmFyIF91dGlsc1RvVGl0bGVDYXNlSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNUb1RpdGxlQ2FzZUpzKTsKCnZhciBfdXRpbHNUaW1lUmFuZ2VzSnMgPSBfZGVyZXFfKCcuL3V0aWxzL3RpbWUtcmFuZ2VzLmpzJyk7Cgp2YXIgX3V0aWxzQnVmZmVySnMgPSBfZGVyZXFfKCcuL3V0aWxzL2J1ZmZlci5qcycpOwoKdmFyIF91dGlsc1N0eWxlc2hlZXRKcyA9IF9kZXJlcV8oJy4vdXRpbHMvc3R5bGVzaGVldC5qcycpOwoKdmFyIHN0eWxlc2hlZXQgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNTdHlsZXNoZWV0SnMpOwoKdmFyIF9mdWxsc2NyZWVuQXBpSnMgPSBfZGVyZXFfKCcuL2Z1bGxzY3JlZW4tYXBpLmpzJyk7Cgp2YXIgX2Z1bGxzY3JlZW5BcGlKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mdWxsc2NyZWVuQXBpSnMpOwoKdmFyIF9tZWRpYUVycm9ySnMgPSBfZGVyZXFfKCcuL21lZGlhLWVycm9yLmpzJyk7Cgp2YXIgX21lZGlhRXJyb3JKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZWRpYUVycm9ySnMpOwoKdmFyIF9zYWZlSnNvblBhcnNlVHVwbGUgPSBfZGVyZXFfKCdzYWZlLWpzb24tcGFyc2UvdHVwbGUnKTsKCnZhciBfc2FmZUpzb25QYXJzZVR1cGxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NhZmVKc29uUGFyc2VUdXBsZSk7Cgp2YXIgX29iamVjdEFzc2lnbiA9IF9kZXJlcV8oJ29iamVjdC5hc3NpZ24nKTsKCnZhciBfb2JqZWN0QXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdEFzc2lnbik7Cgp2YXIgX3V0aWxzTWVyZ2VPcHRpb25zSnMgPSBfZGVyZXFfKCcuL3V0aWxzL21lcmdlLW9wdGlvbnMuanMnKTsKCnZhciBfdXRpbHNNZXJnZU9wdGlvbnNKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc01lcmdlT3B0aW9uc0pzKTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrTGlzdENvbnZlcnRlckpzID0gX2RlcmVxXygnLi90cmFja3MvdGV4dC10cmFjay1saXN0LWNvbnZlcnRlci5qcycpOwoKdmFyIF90cmFja3NUZXh0VHJhY2tMaXN0Q29udmVydGVySnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhY2tzVGV4dFRyYWNrTGlzdENvbnZlcnRlckpzKTsKCi8vIEluY2x1ZGUgcmVxdWlyZWQgY2hpbGQgY29tcG9uZW50cyAoaW1wb3J0aW5nIGFsc28gcmVnaXN0ZXJzIHRoZW0pCgp2YXIgX3RlY2hMb2FkZXJKcyA9IF9kZXJlcV8oJy4vdGVjaC9sb2FkZXIuanMnKTsKCnZhciBfdGVjaExvYWRlckpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlY2hMb2FkZXJKcyk7Cgp2YXIgX3Bvc3RlckltYWdlSnMgPSBfZGVyZXFfKCcuL3Bvc3Rlci1pbWFnZS5qcycpOwoKdmFyIF9wb3N0ZXJJbWFnZUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3RlckltYWdlSnMpOwoKdmFyIF90cmFja3NUZXh0VHJhY2tEaXNwbGF5SnMgPSBfZGVyZXFfKCcuL3RyYWNrcy90ZXh0LXRyYWNrLWRpc3BsYXkuanMnKTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrRGlzcGxheUpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYWNrc1RleHRUcmFja0Rpc3BsYXlKcyk7Cgp2YXIgX2xvYWRpbmdTcGlubmVySnMgPSBfZGVyZXFfKCcuL2xvYWRpbmctc3Bpbm5lci5qcycpOwoKdmFyIF9sb2FkaW5nU3Bpbm5lckpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvYWRpbmdTcGlubmVySnMpOwoKdmFyIF9iaWdQbGF5QnV0dG9uSnMgPSBfZGVyZXFfKCcuL2JpZy1wbGF5LWJ1dHRvbi5qcycpOwoKdmFyIF9iaWdQbGF5QnV0dG9uSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmlnUGxheUJ1dHRvbkpzKTsKCnZhciBfY29udHJvbEJhckNvbnRyb2xCYXJKcyA9IF9kZXJlcV8oJy4vY29udHJvbC1iYXIvY29udHJvbC1iYXIuanMnKTsKCnZhciBfY29udHJvbEJhckNvbnRyb2xCYXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb250cm9sQmFyQ29udHJvbEJhckpzKTsKCnZhciBfZXJyb3JEaXNwbGF5SnMgPSBfZGVyZXFfKCcuL2Vycm9yLWRpc3BsYXkuanMnKTsKCnZhciBfZXJyb3JEaXNwbGF5SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXJyb3JEaXNwbGF5SnMpOwoKdmFyIF90cmFja3NUZXh0VHJhY2tTZXR0aW5nc0pzID0gX2RlcmVxXygnLi90cmFja3MvdGV4dC10cmFjay1zZXR0aW5ncy5qcycpOwoKdmFyIF90cmFja3NUZXh0VHJhY2tTZXR0aW5nc0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYWNrc1RleHRUcmFja1NldHRpbmdzSnMpOwoKdmFyIF9tb2RhbERpYWxvZyA9IF9kZXJlcV8oJy4vbW9kYWwtZGlhbG9nJyk7Cgp2YXIgX21vZGFsRGlhbG9nMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21vZGFsRGlhbG9nKTsKCi8vIFJlcXVpcmUgaHRtbDUgdGVjaCwgYXQgbGVhc3QgZm9yIGRpc3Bvc2luZyB0aGUgb3JpZ2luYWwgdmlkZW8gdGFnCgp2YXIgX3RlY2hUZWNoSnMgPSBfZGVyZXFfKCcuL3RlY2gvdGVjaC5qcycpOwoKdmFyIF90ZWNoVGVjaEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlY2hUZWNoSnMpOwoKdmFyIF90ZWNoSHRtbDVKcyA9IF9kZXJlcV8oJy4vdGVjaC9odG1sNS5qcycpOwoKdmFyIF90ZWNoSHRtbDVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWNoSHRtbDVKcyk7CgovKioKICogQW4gaW5zdGFuY2Ugb2YgdGhlIGBQbGF5ZXJgIGNsYXNzIGlzIGNyZWF0ZWQgd2hlbiBhbnkgb2YgdGhlIFZpZGVvLmpzIHNldHVwIG1ldGhvZHMgYXJlIHVzZWQgdG8gaW5pdGlhbGl6ZSBhIHZpZGVvLgogKiBgYGBqcwogKiB2YXIgbXlQbGF5ZXIgPSB2aWRlb2pzKCdleGFtcGxlX3ZpZGVvXzEnKTsKICogYGBgCiAqIEluIHRoZSBmb2xsb3dpbmcgZXhhbXBsZSwgdGhlIGBkYXRhLXNldHVwYCBhdHRyaWJ1dGUgdGVsbHMgdGhlIFZpZGVvLmpzIGxpYnJhcnkgdG8gY3JlYXRlIGEgcGxheWVyIGluc3RhbmNlIHdoZW4gdGhlIGxpYnJhcnkgaXMgcmVhZHkuCiAqIGBgYGh0bWwKICogPHZpZGVvIGlkPSJleGFtcGxlX3ZpZGVvXzEiIGRhdGEtc2V0dXA9J3t9JyBjb250cm9scz4KICogICA8c291cmNlIHNyYz0ibXktc291cmNlLm1wNCIgdHlwZT0idmlkZW8vbXA0Ij4KICogPC92aWRlbz4KICogYGBgCiAqIEFmdGVyIGFuIGluc3RhbmNlIGhhcyBiZWVuIGNyZWF0ZWQgaXQgY2FuIGJlIGFjY2Vzc2VkIGdsb2JhbGx5IHVzaW5nIGBWaWRlbygnZXhhbXBsZV92aWRlb18xJylgLgogKgogKiBAcGFyYW0ge0VsZW1lbnR9IHRhZyAgICAgICAgVGhlIG9yaWdpbmFsIHZpZGVvIHRhZyB1c2VkIGZvciBjb25maWd1cmluZyBvcHRpb25zCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyAgICBPYmplY3Qgb2Ygb3B0aW9uIG5hbWVzIGFuZCB2YWx1ZXMKICogQHBhcmFtIHtGdW5jdGlvbj19IHJlYWR5ICAgIFJlYWR5IGNhbGxiYWNrIGZ1bmN0aW9uCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgUGxheWVyCiAqLwoKdmFyIFBsYXllciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhQbGF5ZXIsIF9Db21wb25lbnQpOwoKICAvKioKICAgKiBwbGF5ZXIncyBjb25zdHJ1Y3RvciBmdW5jdGlvbgogICAqCiAgICogQGNvbnN0cnVjdHMKICAgKiBAbWV0aG9kIGluaXQKICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhZyAgICAgICAgVGhlIG9yaWdpbmFsIHZpZGVvIHRhZyB1c2VkIGZvciBjb25maWd1cmluZyBvcHRpb25zCiAgICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zICAgIFBsYXllciBvcHRpb25zCiAgICogQHBhcmFtIHtGdW5jdGlvbj19IHJlYWR5ICAgIFJlYWR5IGNhbGxiYWNrIGZ1bmN0aW9uCiAgICovCgogIGZ1bmN0aW9uIFBsYXllcih0YWcsIG9wdGlvbnMsIHJlYWR5KSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbGF5ZXIpOwoKICAgIC8vIE1ha2Ugc3VyZSB0YWcgSUQgZXhpc3RzCiAgICB0YWcuaWQgPSB0YWcuaWQgfHwgJ3Zqc192aWRlb18nICsgR3VpZC5uZXdHVUlEKCk7CgogICAgLy8gU2V0IE9wdGlvbnMKICAgIC8vIFRoZSBvcHRpb25zIGFyZ3VtZW50IG92ZXJyaWRlcyBvcHRpb25zIHNldCBpbiB0aGUgdmlkZW8gdGFnCiAgICAvLyB3aGljaCBvdmVycmlkZXMgZ2xvYmFsbHkgc2V0IG9wdGlvbnMuCiAgICAvLyBUaGlzIGxhdHRlciBwYXJ0IGNvaW5jaWRlcyB3aXRoIHRoZSBsb2FkIG9yZGVyCiAgICAvLyAodGFnIG11c3QgZXhpc3QgYmVmb3JlIFBsYXllcikKICAgIG9wdGlvbnMgPSBfb2JqZWN0QXNzaWduMlsnZGVmYXVsdCddKFBsYXllci5nZXRUYWdTZXR0aW5ncyh0YWcpLCBvcHRpb25zKTsKCiAgICAvLyBEZWxheSB0aGUgaW5pdGlhbGl6YXRpb24gb2YgY2hpbGRyZW4gYmVjYXVzZSB3ZSBuZWVkIHRvIHNldCB1cAogICAgLy8gcGxheWVyIHByb3BlcnRpZXMgZmlyc3QsIGFuZCBjYW4ndCB1c2UgYHRoaXNgIGJlZm9yZSBgc3VwZXIoKWAKICAgIG9wdGlvbnMuaW5pdENoaWxkcmVuID0gZmFsc2U7CgogICAgLy8gU2FtZSB3aXRoIGNyZWF0aW5nIHRoZSBlbGVtZW50CiAgICBvcHRpb25zLmNyZWF0ZUVsID0gZmFsc2U7CgogICAgLy8gd2UgZG9uJ3Qgd2FudCB0aGUgcGxheWVyIHRvIHJlcG9ydCB0b3VjaCBhY3Rpdml0eSBvbiBpdHNlbGYKICAgIC8vIHNlZSBlbmFibGVUb3VjaEFjdGl2aXR5IGluIENvbXBvbmVudAogICAgb3B0aW9ucy5yZXBvcnRUb3VjaEFjdGl2aXR5ID0gZmFsc2U7CgogICAgLy8gUnVuIGJhc2UgY29tcG9uZW50IGluaXRpYWxpemluZyB3aXRoIG5ldyBvcHRpb25zCiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgbnVsbCwgb3B0aW9ucywgcmVhZHkpOwoKICAgIC8vIGlmIHRoZSBnbG9iYWwgb3B0aW9uIG9iamVjdCB3YXMgYWNjaWRlbnRhbGx5IGJsb3duIGF3YXkgYnkKICAgIC8vIHNvbWVvbmUsIGJhaWwgZWFybHkgd2l0aCBhbiBpbmZvcm1hdGl2ZSBlcnJvcgogICAgaWYgKCF0aGlzLm9wdGlvbnNfIHx8ICF0aGlzLm9wdGlvbnNfLnRlY2hPcmRlciB8fCAhdGhpcy5vcHRpb25zXy50ZWNoT3JkZXIubGVuZ3RoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdGVjaE9yZGVyIHNwZWNpZmllZC4gRGlkIHlvdSBvdmVyd3JpdGUgJyArICd2aWRlb2pzLm9wdGlvbnMgaW5zdGVhZCBvZiBqdXN0IGNoYW5naW5nIHRoZSAnICsgJ3Byb3BlcnRpZXMgeW91IHdhbnQgdG8gb3ZlcnJpZGU/Jyk7CiAgICB9CgogICAgdGhpcy50YWcgPSB0YWc7IC8vIFN0b3JlIHRoZSBvcmlnaW5hbCB0YWcgdXNlZCB0byBzZXQgb3B0aW9ucwoKICAgIC8vIFN0b3JlIHRoZSB0YWcgYXR0cmlidXRlcyB1c2VkIHRvIHJlc3RvcmUgaHRtbDUgZWxlbWVudAogICAgdGhpcy50YWdBdHRyaWJ1dGVzID0gdGFnICYmIERvbS5nZXRFbEF0dHJpYnV0ZXModGFnKTsKCiAgICAvLyBVcGRhdGUgY3VycmVudCBsYW5ndWFnZQogICAgdGhpcy5sYW5ndWFnZSh0aGlzLm9wdGlvbnNfLmxhbmd1YWdlKTsKCiAgICAvLyBVcGRhdGUgU3VwcG9ydGVkIExhbmd1YWdlcwogICAgaWYgKG9wdGlvbnMubGFuZ3VhZ2VzKSB7CiAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gTm9ybWFsaXNlIHBsYXllciBvcHRpb24gbGFuZ3VhZ2VzIHRvIGxvd2VyY2FzZQogICAgICAgIHZhciBsYW5ndWFnZXNUb0xvd2VyID0ge307CgogICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9wdGlvbnMubGFuZ3VhZ2VzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICBsYW5ndWFnZXNUb0xvd2VyW25hbWUudG9Mb3dlckNhc2UoKV0gPSBvcHRpb25zLmxhbmd1YWdlc1tuYW1lXTsKICAgICAgICB9KTsKICAgICAgICBfdGhpcy5sYW5ndWFnZXNfID0gbGFuZ3VhZ2VzVG9Mb3dlcjsKICAgICAgfSkoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubGFuZ3VhZ2VzXyA9IFBsYXllci5wcm90b3R5cGUub3B0aW9uc18ubGFuZ3VhZ2VzOwogICAgfQoKICAgIC8vIENhY2hlIGZvciB2aWRlbyBwcm9wZXJ0eSB2YWx1ZXMuCiAgICB0aGlzLmNhY2hlXyA9IHt9OwoKICAgIC8vIFNldCBwb3N0ZXIKICAgIHRoaXMucG9zdGVyXyA9IG9wdGlvbnMucG9zdGVyIHx8ICcnOwoKICAgIC8vIFNldCBjb250cm9scwogICAgdGhpcy5jb250cm9sc18gPSAhIW9wdGlvbnMuY29udHJvbHM7CgogICAgLy8gT3JpZ2luYWwgdGFnIHNldHRpbmdzIHN0b3JlZCBpbiBvcHRpb25zCiAgICAvLyBub3cgcmVtb3ZlIGltbWVkaWF0ZWx5IHNvIG5hdGl2ZSBjb250cm9scyBkb24ndCBmbGFzaC4KICAgIC8vIE1heSBiZSB0dXJuZWQgYmFjayBvbiBieSBIVE1MNSB0ZWNoIGlmIG5hdGl2ZUNvbnRyb2xzRm9yVG91Y2ggaXMgdHJ1ZQogICAgdGFnLmNvbnRyb2xzID0gZmFsc2U7CgogICAgLyoKICAgICAqIFN0b3JlIHRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBzY3J1YmJpbmcKICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybiB7Qm9vbGVhbn0gVHJ1ZSBpZiB0aGUgdXNlciBpcyBzY3J1YmJpbmcKICAgICAqLwogICAgdGhpcy5zY3J1YmJpbmdfID0gZmFsc2U7CgogICAgdGhpcy5lbF8gPSB0aGlzLmNyZWF0ZUVsKCk7CgogICAgLy8gV2UgYWxzbyB3YW50IHRvIHBhc3MgdGhlIG9yaWdpbmFsIHBsYXllciBvcHRpb25zIHRvIGVhY2ggY29tcG9uZW50IGFuZCBwbHVnaW4KICAgIC8vIGFzIHdlbGwgc28gdGhleSBkb24ndCBuZWVkIHRvIHJlYWNoIGJhY2sgaW50byB0aGUgcGxheWVyIGZvciBvcHRpb25zIGxhdGVyLgogICAgLy8gV2UgYWxzbyBuZWVkIHRvIGRvIGFub3RoZXIgY29weSBvZiB0aGlzLm9wdGlvbnNfIHNvIHdlIGRvbid0IGVuZCB1cCB3aXRoCiAgICAvLyBhbiBpbmZpbml0ZSBsb29wLgogICAgdmFyIHBsYXllck9wdGlvbnNDb3B5ID0gX3V0aWxzTWVyZ2VPcHRpb25zSnMyWydkZWZhdWx0J10odGhpcy5vcHRpb25zXyk7CgogICAgLy8gTG9hZCBwbHVnaW5zCiAgICBpZiAob3B0aW9ucy5wbHVnaW5zKSB7CiAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHBsdWdpbnMgPSBvcHRpb25zLnBsdWdpbnM7CgogICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHBsdWdpbnMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIGlmICh0eXBlb2YgdGhpc1tuYW1lXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB0aGlzW25hbWVdKHBsdWdpbnNbbmFtZV0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10uZXJyb3IoJ1VuYWJsZSB0byBmaW5kIHBsdWdpbjonLCBuYW1lKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfdGhpcyk7CiAgICAgIH0pKCk7CiAgICB9CgogICAgdGhpcy5vcHRpb25zXy5wbGF5ZXJPcHRpb25zID0gcGxheWVyT3B0aW9uc0NvcHk7CgogICAgdGhpcy5pbml0Q2hpbGRyZW4oKTsKCiAgICAvLyBTZXQgaXNBdWRpbyBiYXNlZCBvbiB3aGV0aGVyIG9yIG5vdCBhbiBhdWRpbyB0YWcgd2FzIHVzZWQKICAgIHRoaXMuaXNBdWRpbyh0YWcubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2F1ZGlvJyk7CgogICAgLy8gVXBkYXRlIGNvbnRyb2xzIGNsYXNzTmFtZS4gQ2FuJ3QgZG8gdGhpcyB3aGVuIHRoZSBjb250cm9scyBhcmUgaW5pdGlhbGx5CiAgICAvLyBzZXQgYmVjYXVzZSB0aGUgZWxlbWVudCBkb2Vzbid0IGV4aXN0IHlldC4KICAgIGlmICh0aGlzLmNvbnRyb2xzKCkpIHsKICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWNvbnRyb2xzLWVuYWJsZWQnKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1jb250cm9scy1kaXNhYmxlZCcpOwogICAgfQoKICAgIGlmICh0aGlzLmlzQXVkaW8oKSkgewogICAgICB0aGlzLmFkZENsYXNzKCd2anMtYXVkaW8nKTsKICAgIH0KCiAgICBpZiAodGhpcy5mbGV4Tm90U3VwcG9ydGVkXygpKSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1uby1mbGV4Jyk7CiAgICB9CgogICAgLy8gVE9ETzogTWFrZSB0aGlzIHNtYXJ0ZXIuIFRvZ2dsZSB1c2VyIHN0YXRlIGJldHdlZW4gdG91Y2hpbmcvbW91c2luZwogICAgLy8gdXNpbmcgZXZlbnRzLCBzaW5jZSBkZXZpY2VzIGNhbiBoYXZlIGJvdGggdG91Y2ggYW5kIG1vdXNlIGV2ZW50cy4KICAgIC8vIGlmIChicm93c2VyLlRPVUNIX0VOQUJMRUQpIHsKICAgIC8vICAgdGhpcy5hZGRDbGFzcygndmpzLXRvdWNoLWVuYWJsZWQnKTsKICAgIC8vIH0KCiAgICAvLyBNYWtlIHBsYXllciBlYXNpbHkgZmluZGFibGUgYnkgSUQKICAgIFBsYXllci5wbGF5ZXJzW3RoaXMuaWRfXSA9IHRoaXM7CgogICAgLy8gV2hlbiB0aGUgcGxheWVyIGlzIGZpcnN0IGluaXRpYWxpemVkLCB0cmlnZ2VyIGFjdGl2aXR5IHNvIGNvbXBvbmVudHMKICAgIC8vIGxpa2UgdGhlIGNvbnRyb2wgYmFyIHNob3cgdGhlbXNlbHZlcyBpZiBuZWVkZWQKICAgIHRoaXMudXNlckFjdGl2ZSh0cnVlKTsKICAgIHRoaXMucmVwb3J0VXNlckFjdGl2aXR5KCk7CiAgICB0aGlzLmxpc3RlbkZvclVzZXJBY3Rpdml0eV8oKTsKCiAgICB0aGlzLm9uKCdmdWxsc2NyZWVuY2hhbmdlJywgdGhpcy5oYW5kbGVGdWxsc2NyZWVuQ2hhbmdlXyk7CiAgICB0aGlzLm9uKCdzdGFnZWNsaWNrJywgdGhpcy5oYW5kbGVTdGFnZUNsaWNrXyk7CiAgfQoKICAvKgogICAqIEdsb2JhbCBwbGF5ZXIgbGlzdAogICAqCiAgICogQHR5cGUge09iamVjdH0KICAgKi8KCiAgLyoqCiAgICogRGVzdHJveXMgdGhlIHZpZGVvIHBsYXllciBhbmQgZG9lcyBhbnkgbmVjZXNzYXJ5IGNsZWFudXAKICAgKiBgYGBqcwogICAqICAgICBteVBsYXllci5kaXNwb3NlKCk7CiAgICogYGBgCiAgICogVGhpcyBpcyBlc3BlY2lhbGx5IGhlbHBmdWwgaWYgeW91IGFyZSBkeW5hbWljYWxseSBhZGRpbmcgYW5kIHJlbW92aW5nIHZpZGVvcwogICAqIHRvL2Zyb20gdGhlIERPTS4KICAgKgogICAqIEBtZXRob2QgZGlzcG9zZQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgdGhpcy50cmlnZ2VyKCdkaXNwb3NlJyk7CiAgICAvLyBwcmV2ZW50IGRpc3Bvc2UgZnJvbSBiZWluZyBjYWxsZWQgdHdpY2UKICAgIHRoaXMub2ZmKCdkaXNwb3NlJyk7CgogICAgaWYgKHRoaXMuc3R5bGVFbF8pIHsKICAgICAgdGhpcy5zdHlsZUVsXy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuc3R5bGVFbF8pOwogICAgfQoKICAgIC8vIEtpbGwgcmVmZXJlbmNlIHRvIHRoaXMgcGxheWVyCiAgICBQbGF5ZXIucGxheWVyc1t0aGlzLmlkX10gPSBudWxsOwogICAgaWYgKHRoaXMudGFnICYmIHRoaXMudGFnLnBsYXllcikgewogICAgICB0aGlzLnRhZy5wbGF5ZXIgPSBudWxsOwogICAgfQogICAgaWYgKHRoaXMuZWxfICYmIHRoaXMuZWxfLnBsYXllcikgewogICAgICB0aGlzLmVsXy5wbGF5ZXIgPSBudWxsOwogICAgfQoKICAgIGlmICh0aGlzLnRlY2hfKSB7CiAgICAgIHRoaXMudGVjaF8uZGlzcG9zZSgpOwogICAgfQoKICAgIF9Db21wb25lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBDcmVhdGUgdGhlIGNvbXBvbmVudCdzIERPTSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgdmFyIGVsID0gdGhpcy5lbF8gPSBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnKTsKICAgIHZhciB0YWcgPSB0aGlzLnRhZzsKCiAgICAvLyBSZW1vdmUgd2lkdGgvaGVpZ2h0IGF0dHJzIGZyb20gdGFnIHNvIENTUyBjYW4gbWFrZSBpdCAxMDAlIHdpZHRoL2hlaWdodAogICAgdGFnLnJlbW92ZUF0dHJpYnV0ZSgnd2lkdGgnKTsKICAgIHRhZy5yZW1vdmVBdHRyaWJ1dGUoJ2hlaWdodCcpOwoKICAgIC8vIENvcHkgb3ZlciBhbGwgdGhlIGF0dHJpYnV0ZXMgZnJvbSB0aGUgdGFnLCBpbmNsdWRpbmcgSUQgYW5kIGNsYXNzCiAgICAvLyBJRCB3aWxsIG5vdyByZWZlcmVuY2UgcGxheWVyIGJveCwgbm90IHRoZSB2aWRlbyB0YWcKICAgIHZhciBhdHRycyA9IERvbS5nZXRFbEF0dHJpYnV0ZXModGFnKTsKCiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhdHRycykuZm9yRWFjaChmdW5jdGlvbiAoYXR0cikgewogICAgICAvLyB3b3JrYXJvdW5kIHNvIHdlIGRvbid0IHRvdGFsbHkgYnJlYWsgSUU3CiAgICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzY1MzQ0NC9jc3Mtc3R5bGVzLW5vdC1hcHBsaWVkLW9uLWR5bmFtaWMtZWxlbWVudHMtaW4taW50ZXJuZXQtZXhwbG9yZXItNwogICAgICBpZiAoYXR0ciA9PT0gJ2NsYXNzJykgewogICAgICAgIGVsLmNsYXNzTmFtZSA9IGF0dHJzW2F0dHJdOwogICAgICB9IGVsc2UgewogICAgICAgIGVsLnNldEF0dHJpYnV0ZShhdHRyLCBhdHRyc1thdHRyXSk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIFVwZGF0ZSB0YWcgaWQvY2xhc3MgZm9yIHVzZSBhcyBIVE1MNSBwbGF5YmFjayB0ZWNoCiAgICAvLyBNaWdodCB0aGluayB3ZSBzaG91bGQgZG8gdGhpcyBhZnRlciBlbWJlZGRpbmcgaW4gY29udGFpbmVyIHNvIC52anMtdGVjaCBjbGFzcwogICAgLy8gZG9lc24ndCBmbGFzaCAxMDAlIHdpZHRoL2hlaWdodCwgYnV0IGNsYXNzIG9ubHkgYXBwbGllcyB3aXRoIC52aWRlby1qcyBwYXJlbnQKICAgIHRhZy5pZCArPSAnX2h0bWw1X2FwaSc7CiAgICB0YWcuY2xhc3NOYW1lID0gJ3Zqcy10ZWNoJzsKCiAgICAvLyBNYWtlIHBsYXllciBmaW5kYWJsZSBvbiBlbGVtZW50cwogICAgdGFnLnBsYXllciA9IGVsLnBsYXllciA9IHRoaXM7CiAgICAvLyBEZWZhdWx0IHN0YXRlIG9mIHZpZGVvIGlzIHBhdXNlZAogICAgdGhpcy5hZGRDbGFzcygndmpzLXBhdXNlZCcpOwoKICAgIC8vIEFkZCBhIHN0eWxlIGVsZW1lbnQgaW4gdGhlIHBsYXllciB0aGF0IHdlJ2xsIHVzZSB0byBzZXQgdGhlIHdpZHRoL2hlaWdodAogICAgLy8gb2YgdGhlIHBsYXllciBpbiBhIHdheSB0aGF0J3Mgc3RpbGwgb3ZlcnJpZGVhYmxlIGJ5IENTUywganVzdCBsaWtlIHRoZQogICAgLy8gdmlkZW8gZWxlbWVudAogICAgdGhpcy5zdHlsZUVsXyA9IHN0eWxlc2hlZXQuY3JlYXRlU3R5bGVFbGVtZW50KCd2anMtc3R5bGVzLWRpbWVuc2lvbnMnKTsKICAgIHZhciBkZWZhdWx0c1N0eWxlRWwgPSBEb20uJCgnLnZqcy1zdHlsZXMtZGVmYXVsdHMnKTsKICAgIHZhciBoZWFkID0gRG9tLiQoJ2hlYWQnKTsKICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHRoaXMuc3R5bGVFbF8sIGRlZmF1bHRzU3R5bGVFbCA/IGRlZmF1bHRzU3R5bGVFbC5uZXh0U2libGluZyA6IGhlYWQuZmlyc3RDaGlsZCk7CgogICAgLy8gUGFzcyBpbiB0aGUgd2lkdGgvaGVpZ2h0L2FzcGVjdFJhdGlvIG9wdGlvbnMgd2hpY2ggd2lsbCB1cGRhdGUgdGhlIHN0eWxlIGVsCiAgICB0aGlzLndpZHRoKHRoaXMub3B0aW9uc18ud2lkdGgpOwogICAgdGhpcy5oZWlnaHQodGhpcy5vcHRpb25zXy5oZWlnaHQpOwogICAgdGhpcy5mbHVpZCh0aGlzLm9wdGlvbnNfLmZsdWlkKTsKICAgIHRoaXMuYXNwZWN0UmF0aW8odGhpcy5vcHRpb25zXy5hc3BlY3RSYXRpbyk7CgogICAgLy8gaW5zZXJ0RWxGaXJzdCBzZWVtcyB0byBjYXVzZSB0aGUgbmV0d29ya1N0YXRlIHRvIGZsaWNrZXIgZnJvbSAzIHRvIDIsIHNvCiAgICAvLyBrZWVwIHRyYWNrIG9mIHRoZSBvcmlnaW5hbCBmb3IgbGF0ZXIgc28gd2UgY2FuIGtub3cgaWYgdGhlIHNvdXJjZSBvcmlnaW5hbGx5IGZhaWxlZAogICAgdGFnLmluaXROZXR3b3JrU3RhdGVfID0gdGFnLm5ldHdvcmtTdGF0ZTsKCiAgICAvLyBXcmFwIHZpZGVvIHRhZyBpbiBkaXYgKGVsL2JveCkgY29udGFpbmVyCiAgICBpZiAodGFnLnBhcmVudE5vZGUpIHsKICAgICAgdGFnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGVsLCB0YWcpOwogICAgfQogICAgRG9tLmluc2VydEVsRmlyc3QodGFnLCBlbCk7IC8vIEJyZWFrcyBpUGhvbmUsIGZpeGVkIGluIEhUTUw1IHNldHVwLgoKICAgIHRoaXMuZWxfID0gZWw7CgogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIEdldC9zZXQgcGxheWVyIHdpZHRoCiAgICoKICAgKiBAcGFyYW0ge051bWJlcj19IHZhbHVlIFZhbHVlIGZvciB3aWR0aAogICAqIEByZXR1cm4ge051bWJlcn0gV2lkdGggd2hlbiBnZXR0aW5nCiAgICogQG1ldGhvZCB3aWR0aAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLndpZHRoID0gZnVuY3Rpb24gd2lkdGgodmFsdWUpIHsKICAgIHJldHVybiB0aGlzLmRpbWVuc2lvbignd2lkdGgnLCB2YWx1ZSk7CiAgfTsKCiAgLyoqCiAgICogR2V0L3NldCBwbGF5ZXIgaGVpZ2h0CiAgICoKICAgKiBAcGFyYW0ge051bWJlcj19IHZhbHVlIFZhbHVlIGZvciBoZWlnaHQKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IEhlaWdodCB3aGVuIGdldHRpbmcKICAgKiBAbWV0aG9kIGhlaWdodAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhlaWdodCA9IGZ1bmN0aW9uIGhlaWdodCh2YWx1ZSkgewogICAgcmV0dXJuIHRoaXMuZGltZW5zaW9uKCdoZWlnaHQnLCB2YWx1ZSk7CiAgfTsKCiAgLyoqCiAgICogR2V0L3NldCBkaW1lbnNpb24gZm9yIHBsYXllcgogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IGRpbWVuc2lvbiBFaXRoZXIgd2lkdGggb3IgaGVpZ2h0CiAgICogQHBhcmFtIHtOdW1iZXI9fSB2YWx1ZSBWYWx1ZSBmb3IgZGltZW5zaW9uCiAgICogQHJldHVybiB7Q29tcG9uZW50fQogICAqIEBtZXRob2QgZGltZW5zaW9uCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuZGltZW5zaW9uID0gZnVuY3Rpb24gZGltZW5zaW9uKF9kaW1lbnNpb24sIHZhbHVlKSB7CiAgICB2YXIgcHJpdkRpbWVuc2lvbiA9IF9kaW1lbnNpb24gKyAnXyc7CgogICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXNbcHJpdkRpbWVuc2lvbl0gfHwgMDsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgIC8vIElmIGFuIGVtcHR5IHN0cmluZyBpcyBnaXZlbiwgcmVzZXQgdGhlIGRpbWVuc2lvbiB0byBiZSBhdXRvbWF0aWMKICAgICAgdGhpc1twcml2RGltZW5zaW9uXSA9IHVuZGVmaW5lZDsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBwYXJzZWRWYWwgPSBwYXJzZUZsb2F0KHZhbHVlKTsKCiAgICAgIGlmIChpc05hTihwYXJzZWRWYWwpKSB7CiAgICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10uZXJyb3IoJ0ltcHJvcGVyIHZhbHVlICInICsgdmFsdWUgKyAnIiBzdXBwbGllZCBmb3IgZm9yICcgKyBfZGltZW5zaW9uKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgdGhpc1twcml2RGltZW5zaW9uXSA9IHBhcnNlZFZhbDsKICAgIH0KCiAgICB0aGlzLnVwZGF0ZVN0eWxlRWxfKCk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBBZGQvcmVtb3ZlIHRoZSB2anMtZmx1aWQgY2xhc3MKICAgKgogICAqIEBwYXJhbSB7Qm9vbGVhbn0gYm9vbCBWYWx1ZSBvZiB0cnVlIGFkZHMgdGhlIGNsYXNzLCB2YWx1ZSBvZiBmYWxzZSByZW1vdmVzIHRoZSBjbGFzcwogICAqIEBtZXRob2QgZmx1aWQKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5mbHVpZCA9IGZ1bmN0aW9uIGZsdWlkKGJvb2wpIHsKICAgIGlmIChib29sID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuICEhdGhpcy5mbHVpZF87CiAgICB9CgogICAgdGhpcy5mbHVpZF8gPSAhIWJvb2w7CgogICAgaWYgKGJvb2wpIHsKICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWZsdWlkJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtZmx1aWQnKTsKICAgIH0KICB9OwoKICAvKioKICAgKiBHZXQvU2V0IHRoZSBhc3BlY3QgcmF0aW8KICAgKgogICAqIEBwYXJhbSB7U3RyaW5nPX0gcmF0aW8gQXNwZWN0IHJhdGlvIGZvciBwbGF5ZXIKICAgKiBAcmV0dXJuIGFzcGVjdFJhdGlvCiAgICogQG1ldGhvZCBhc3BlY3RSYXRpbwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmFzcGVjdFJhdGlvID0gZnVuY3Rpb24gYXNwZWN0UmF0aW8ocmF0aW8pIHsKICAgIGlmIChyYXRpbyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzLmFzcGVjdFJhdGlvXzsKICAgIH0KCiAgICAvLyBDaGVjayBmb3Igd2lkdGg6aGVpZ2h0IGZvcm1hdAogICAgaWYgKCEvXlxkK1w6XGQrJC8udGVzdChyYXRpbykpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXByb3BlciB2YWx1ZSBzdXBwbGllZCBmb3IgYXNwZWN0IHJhdGlvLiBUaGUgZm9ybWF0IHNob3VsZCBiZSB3aWR0aDpoZWlnaHQsIGZvciBleGFtcGxlIDE2OjkuJyk7CiAgICB9CiAgICB0aGlzLmFzcGVjdFJhdGlvXyA9IHJhdGlvOwoKICAgIC8vIFdlJ3JlIGFzc3VtaW5nIGlmIHlvdSBzZXQgYW4gYXNwZWN0IHJhdGlvIHlvdSB3YW50IGZsdWlkIG1vZGUsCiAgICAvLyBiZWNhdXNlIGluIGZpeGVkIG1vZGUgeW91IGNvdWxkIGNhbGN1bGF0ZSB3aWR0aCBhbmQgaGVpZ2h0IHlvdXJzZWxmLgogICAgdGhpcy5mbHVpZCh0cnVlKTsKCiAgICB0aGlzLnVwZGF0ZVN0eWxlRWxfKCk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIHN0eWxlcyBvZiB0aGUgcGxheWVyIGVsZW1lbnQgKGhlaWdodCwgd2lkdGggYW5kIGFzcGVjdCByYXRpbykKICAgKgogICAqIEBtZXRob2QgdXBkYXRlU3R5bGVFbF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS51cGRhdGVTdHlsZUVsXyA9IGZ1bmN0aW9uIHVwZGF0ZVN0eWxlRWxfKCkgewogICAgdmFyIHdpZHRoID0gdW5kZWZpbmVkOwogICAgdmFyIGhlaWdodCA9IHVuZGVmaW5lZDsKICAgIHZhciBhc3BlY3RSYXRpbyA9IHVuZGVmaW5lZDsKICAgIHZhciBpZENsYXNzID0gdW5kZWZpbmVkOwoKICAgIC8vIFRoZSBhc3BlY3QgcmF0aW8gaXMgZWl0aGVyIHVzZWQgZGlyZWN0bHkgb3IgdG8gY2FsY3VsYXRlIHdpZHRoIGFuZCBoZWlnaHQuCiAgICBpZiAodGhpcy5hc3BlY3RSYXRpb18gIT09IHVuZGVmaW5lZCAmJiB0aGlzLmFzcGVjdFJhdGlvXyAhPT0gJ2F1dG8nKSB7CiAgICAgIC8vIFVzZSBhbnkgYXNwZWN0UmF0aW8gdGhhdCdzIGJlZW4gc3BlY2lmaWNhbGx5IHNldAogICAgICBhc3BlY3RSYXRpbyA9IHRoaXMuYXNwZWN0UmF0aW9fOwogICAgfSBlbHNlIGlmICh0aGlzLnZpZGVvV2lkdGgoKSkgewogICAgICAvLyBPdGhlcndpc2UgdHJ5IHRvIGdldCB0aGUgYXNwZWN0IHJhdGlvIGZyb20gdGhlIHZpZGVvIG1ldGFkYXRhCiAgICAgIGFzcGVjdFJhdGlvID0gdGhpcy52aWRlb1dpZHRoKCkgKyAnOicgKyB0aGlzLnZpZGVvSGVpZ2h0KCk7CiAgICB9IGVsc2UgewogICAgICAvLyBPciB1c2UgYSBkZWZhdWx0LiBUaGUgdmlkZW8gZWxlbWVudCdzIGlzIDI6MSwgYnV0IDE2OjkgaXMgbW9yZSBjb21tb24uCiAgICAgIGFzcGVjdFJhdGlvID0gJzE2OjknOwogICAgfQoKICAgIC8vIEdldCB0aGUgcmF0aW8gYXMgYSBkZWNpbWFsIHdlIGNhbiB1c2UgdG8gY2FsY3VsYXRlIGRpbWVuc2lvbnMKICAgIHZhciByYXRpb1BhcnRzID0gYXNwZWN0UmF0aW8uc3BsaXQoJzonKTsKICAgIHZhciByYXRpb011bHRpcGxpZXIgPSByYXRpb1BhcnRzWzFdIC8gcmF0aW9QYXJ0c1swXTsKCiAgICBpZiAodGhpcy53aWR0aF8gIT09IHVuZGVmaW5lZCkgewogICAgICAvLyBVc2UgYW55IHdpZHRoIHRoYXQncyBiZWVuIHNwZWNpZmljYWxseSBzZXQKICAgICAgd2lkdGggPSB0aGlzLndpZHRoXzsKICAgIH0gZWxzZSBpZiAodGhpcy5oZWlnaHRfICE9PSB1bmRlZmluZWQpIHsKICAgICAgLy8gT3IgY2FsdWxhdGUgdGhlIHdpZHRoIGZyb20gdGhlIGFzcGVjdCByYXRpbyBpZiBhIGhlaWdodCBoYXMgYmVlbiBzZXQKICAgICAgd2lkdGggPSB0aGlzLmhlaWdodF8gLyByYXRpb011bHRpcGxpZXI7CiAgICB9IGVsc2UgewogICAgICAvLyBPciB1c2UgdGhlIHZpZGVvJ3MgbWV0YWRhdGEsIG9yIHVzZSB0aGUgdmlkZW8gZWwncyBkZWZhdWx0IG9mIDMwMAogICAgICB3aWR0aCA9IHRoaXMudmlkZW9XaWR0aCgpIHx8IDMwMDsKICAgIH0KCiAgICBpZiAodGhpcy5oZWlnaHRfICE9PSB1bmRlZmluZWQpIHsKICAgICAgLy8gVXNlIGFueSBoZWlnaHQgdGhhdCdzIGJlZW4gc3BlY2lmaWNhbGx5IHNldAogICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodF87CiAgICB9IGVsc2UgewogICAgICAvLyBPdGhlcndpc2UgY2FsY3VsYXRlIHRoZSBoZWlnaHQgZnJvbSB0aGUgcmF0aW8gYW5kIHRoZSB3aWR0aAogICAgICBoZWlnaHQgPSB3aWR0aCAqIHJhdGlvTXVsdGlwbGllcjsKICAgIH0KCiAgICAvLyBFbnN1cmUgdGhlIENTUyBjbGFzcyBpcyB2YWxpZCBieSBzdGFydGluZyB3aXRoIGFuIGFscGhhIGNoYXJhY3RlcgogICAgaWYgKC9eW15hLXpBLVpdLy50ZXN0KHRoaXMuaWQoKSkpIHsKICAgICAgaWRDbGFzcyA9ICdkaW1lbnNpb25zLScgKyB0aGlzLmlkKCk7CiAgICB9IGVsc2UgewogICAgICBpZENsYXNzID0gdGhpcy5pZCgpICsgJy1kaW1lbnNpb25zJzsKICAgIH0KCiAgICAvLyBFbnN1cmUgdGhlIHJpZ2h0IGNsYXNzIGlzIHN0aWxsIG9uIHRoZSBwbGF5ZXIgZm9yIHRoZSBzdHlsZSBlbGVtZW50CiAgICB0aGlzLmFkZENsYXNzKGlkQ2xhc3MpOwoKICAgIHN0eWxlc2hlZXQuc2V0VGV4dENvbnRlbnQodGhpcy5zdHlsZUVsXywgJ1xuICAgICAgLicgKyBpZENsYXNzICsgJyB7XG4gICAgICAgIHdpZHRoOiAnICsgd2lkdGggKyAncHg7XG4gICAgICAgIGhlaWdodDogJyArIGhlaWdodCArICdweDtcbiAgICAgIH1cblxuICAgICAgLicgKyBpZENsYXNzICsgJy52anMtZmx1aWQge1xuICAgICAgICBwYWRkaW5nLXRvcDogJyArIHJhdGlvTXVsdGlwbGllciAqIDEwMCArICclO1xuICAgICAgfVxuICAgICcpOwogIH07CgogIC8qKgogICAqIExvYWQgdGhlIE1lZGlhIFBsYXliYWNrIFRlY2hub2xvZ3kgKHRlY2gpCiAgICogTG9hZC9DcmVhdGUgYW4gaW5zdGFuY2Ugb2YgcGxheWJhY2sgdGVjaG5vbG9neSBpbmNsdWRpbmcgZWxlbWVudCBhbmQgQVBJIG1ldGhvZHMKICAgKiBBbmQgYXBwZW5kIHBsYXliYWNrIGVsZW1lbnQgaW4gcGxheWVyIGRpdi4KICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSB0ZWNoTmFtZSBOYW1lIG9mIHRoZSBwbGF5YmFjayB0ZWNobm9sb2d5CiAgICogQHBhcmFtIHtTdHJpbmd9IHNvdXJjZSBWaWRlbyBzb3VyY2UKICAgKiBAbWV0aG9kIGxvYWRUZWNoXwogICAqIEBwcml2YXRlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUubG9hZFRlY2hfID0gZnVuY3Rpb24gbG9hZFRlY2hfKHRlY2hOYW1lLCBzb3VyY2UpIHsKCiAgICAvLyBQYXVzZSBhbmQgcmVtb3ZlIGN1cnJlbnQgcGxheWJhY2sgdGVjaG5vbG9neQogICAgaWYgKHRoaXMudGVjaF8pIHsKICAgICAgdGhpcy51bmxvYWRUZWNoXygpOwogICAgfQoKICAgIC8vIGdldCByaWQgb2YgdGhlIEhUTUw1IHZpZGVvIHRhZyBhcyBzb29uIGFzIHdlIGFyZSB1c2luZyBhbm90aGVyIHRlY2gKICAgIGlmICh0ZWNoTmFtZSAhPT0gJ0h0bWw1JyAmJiB0aGlzLnRhZykgewogICAgICBfdGVjaFRlY2hKczJbJ2RlZmF1bHQnXS5nZXRUZWNoKCdIdG1sNScpLmRpc3Bvc2VNZWRpYUVsZW1lbnQodGhpcy50YWcpOwogICAgICB0aGlzLnRhZy5wbGF5ZXIgPSBudWxsOwogICAgICB0aGlzLnRhZyA9IG51bGw7CiAgICB9CgogICAgdGhpcy50ZWNoTmFtZV8gPSB0ZWNoTmFtZTsKCiAgICAvLyBUdXJuIG9mZiBBUEkgYWNjZXNzIGJlY2F1c2Ugd2UncmUgbG9hZGluZyBhIG5ldyB0ZWNoIHRoYXQgbWlnaHQgbG9hZCBhc3luY2hyb25vdXNseQogICAgdGhpcy5pc1JlYWR5XyA9IGZhbHNlOwoKICAgIC8vIEdyYWIgdGVjaC1zcGVjaWZpYyBvcHRpb25zIGZyb20gcGxheWVyIG9wdGlvbnMgYW5kIGFkZCBzb3VyY2UgYW5kIHBhcmVudCBlbGVtZW50IHRvIHVzZS4KICAgIHZhciB0ZWNoT3B0aW9ucyA9IF9vYmplY3RBc3NpZ24yWydkZWZhdWx0J10oewogICAgICAnbmF0aXZlQ29udHJvbHNGb3JUb3VjaCc6IHRoaXMub3B0aW9uc18ubmF0aXZlQ29udHJvbHNGb3JUb3VjaCwKICAgICAgJ3NvdXJjZSc6IHNvdXJjZSwKICAgICAgJ3BsYXllcklkJzogdGhpcy5pZCgpLAogICAgICAndGVjaElkJzogdGhpcy5pZCgpICsgJ18nICsgdGVjaE5hbWUgKyAnX2FwaScsCiAgICAgICd0ZXh0VHJhY2tzJzogdGhpcy50ZXh0VHJhY2tzXywKICAgICAgJ2F1dG9wbGF5JzogdGhpcy5vcHRpb25zXy5hdXRvcGxheSwKICAgICAgJ3ByZWxvYWQnOiB0aGlzLm9wdGlvbnNfLnByZWxvYWQsCiAgICAgICdsb29wJzogdGhpcy5vcHRpb25zXy5sb29wLAogICAgICAnbXV0ZWQnOiB0aGlzLm9wdGlvbnNfLm11dGVkLAogICAgICAncG9zdGVyJzogdGhpcy5wb3N0ZXIoKSwKICAgICAgJ2xhbmd1YWdlJzogdGhpcy5sYW5ndWFnZSgpLAogICAgICAndnR0LmpzJzogdGhpcy5vcHRpb25zX1sndnR0LmpzJ10KICAgIH0sIHRoaXMub3B0aW9uc19bdGVjaE5hbWUudG9Mb3dlckNhc2UoKV0pOwoKICAgIGlmICh0aGlzLnRhZykgewogICAgICB0ZWNoT3B0aW9ucy50YWcgPSB0aGlzLnRhZzsKICAgIH0KCiAgICBpZiAoc291cmNlKSB7CiAgICAgIHRoaXMuY3VycmVudFR5cGVfID0gc291cmNlLnR5cGU7CiAgICAgIGlmIChzb3VyY2Uuc3JjID09PSB0aGlzLmNhY2hlXy5zcmMgJiYgdGhpcy5jYWNoZV8uY3VycmVudFRpbWUgPiAwKSB7CiAgICAgICAgdGVjaE9wdGlvbnMuc3RhcnRUaW1lID0gdGhpcy5jYWNoZV8uY3VycmVudFRpbWU7CiAgICAgIH0KCiAgICAgIHRoaXMuY2FjaGVfLnNyYyA9IHNvdXJjZS5zcmM7CiAgICB9CgogICAgLy8gSW5pdGlhbGl6ZSB0ZWNoIGluc3RhbmNlCiAgICB2YXIgdGVjaENvbXBvbmVudCA9IF90ZWNoVGVjaEpzMlsnZGVmYXVsdCddLmdldFRlY2godGVjaE5hbWUpOwogICAgLy8gU3VwcG9ydCBvbGQgYmVoYXZpb3Igb2YgdGVjaHMgYmVpbmcgcmVnaXN0ZXJlZCBhcyBjb21wb25lbnRzLgogICAgLy8gUmVtb3ZlIG9uY2UgdGhhdCBkZXByZWNhdGVkIGJlaGF2aW9yIGlzIHJlbW92ZWQuCiAgICBpZiAoIXRlY2hDb21wb25lbnQpIHsKICAgICAgdGVjaENvbXBvbmVudCA9IF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5nZXRDb21wb25lbnQodGVjaE5hbWUpOwogICAgfQogICAgdGhpcy50ZWNoXyA9IG5ldyB0ZWNoQ29tcG9uZW50KHRlY2hPcHRpb25zKTsKCiAgICAvLyBwbGF5ZXIudHJpZ2dlclJlYWR5IGlzIGFsd2F5cyBhc3luYywgc28gZG9uJ3QgbmVlZCB0aGlzIHRvIGJlIGFzeW5jCiAgICB0aGlzLnRlY2hfLnJlYWR5KEZuLmJpbmQodGhpcywgdGhpcy5oYW5kbGVUZWNoUmVhZHlfKSwgdHJ1ZSk7CgogICAgX3RyYWNrc1RleHRUcmFja0xpc3RDb252ZXJ0ZXJKczJbJ2RlZmF1bHQnXS5qc29uVG9UZXh0VHJhY2tzKHRoaXMudGV4dFRyYWNrc0pzb25fIHx8IFtdLCB0aGlzLnRlY2hfKTsKCiAgICAvLyBMaXN0ZW4gdG8gYWxsIEhUTUw1LWRlZmluZWQgZXZlbnRzIGFuZCB0cmlnZ2VyIHRoZW0gb24gdGhlIHBsYXllcgogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnbG9hZHN0YXJ0JywgdGhpcy5oYW5kbGVUZWNoTG9hZFN0YXJ0Xyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICd3YWl0aW5nJywgdGhpcy5oYW5kbGVUZWNoV2FpdGluZ18pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnY2FucGxheScsIHRoaXMuaGFuZGxlVGVjaENhblBsYXlfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ2NhbnBsYXl0aHJvdWdoJywgdGhpcy5oYW5kbGVUZWNoQ2FuUGxheVRocm91Z2hfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ3BsYXlpbmcnLCB0aGlzLmhhbmRsZVRlY2hQbGF5aW5nXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdlbmRlZCcsIHRoaXMuaGFuZGxlVGVjaEVuZGVkXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdzZWVraW5nJywgdGhpcy5oYW5kbGVUZWNoU2Vla2luZ18pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnc2Vla2VkJywgdGhpcy5oYW5kbGVUZWNoU2Vla2VkXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdwbGF5JywgdGhpcy5oYW5kbGVUZWNoUGxheV8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnZmlyc3RwbGF5JywgdGhpcy5oYW5kbGVUZWNoRmlyc3RQbGF5Xyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdwYXVzZScsIHRoaXMuaGFuZGxlVGVjaFBhdXNlXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdwcm9ncmVzcycsIHRoaXMuaGFuZGxlVGVjaFByb2dyZXNzXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdkdXJhdGlvbmNoYW5nZScsIHRoaXMuaGFuZGxlVGVjaER1cmF0aW9uQ2hhbmdlXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdmdWxsc2NyZWVuY2hhbmdlJywgdGhpcy5oYW5kbGVUZWNoRnVsbHNjcmVlbkNoYW5nZV8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnZXJyb3InLCB0aGlzLmhhbmRsZVRlY2hFcnJvcl8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnc3VzcGVuZCcsIHRoaXMuaGFuZGxlVGVjaFN1c3BlbmRfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ2Fib3J0JywgdGhpcy5oYW5kbGVUZWNoQWJvcnRfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ2VtcHRpZWQnLCB0aGlzLmhhbmRsZVRlY2hFbXB0aWVkXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdzdGFsbGVkJywgdGhpcy5oYW5kbGVUZWNoU3RhbGxlZF8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmhhbmRsZVRlY2hMb2FkZWRNZXRhRGF0YV8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAnbG9hZGVkZGF0YScsIHRoaXMuaGFuZGxlVGVjaExvYWRlZERhdGFfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ3RpbWV1cGRhdGUnLCB0aGlzLmhhbmRsZVRlY2hUaW1lVXBkYXRlXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdyYXRlY2hhbmdlJywgdGhpcy5oYW5kbGVUZWNoUmF0ZUNoYW5nZV8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAndm9sdW1lY2hhbmdlJywgdGhpcy5oYW5kbGVUZWNoVm9sdW1lQ2hhbmdlXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICd0ZXh0dHJhY2tjaGFuZ2UnLCB0aGlzLmhhbmRsZVRlY2hUZXh0VHJhY2tDaGFuZ2VfKTsKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy51cGRhdGVTdHlsZUVsXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdwb3N0ZXJjaGFuZ2UnLCB0aGlzLmhhbmRsZVRlY2hQb3N0ZXJDaGFuZ2VfKTsKCiAgICB0aGlzLnVzaW5nTmF0aXZlQ29udHJvbHModGhpcy50ZWNoR2V0XygnY29udHJvbHMnKSk7CgogICAgaWYgKHRoaXMuY29udHJvbHMoKSAmJiAhdGhpcy51c2luZ05hdGl2ZUNvbnRyb2xzKCkpIHsKICAgICAgdGhpcy5hZGRUZWNoQ29udHJvbHNMaXN0ZW5lcnNfKCk7CiAgICB9CgogICAgLy8gQWRkIHRoZSB0ZWNoIGVsZW1lbnQgaW4gdGhlIERPTSBpZiBpdCB3YXMgbm90IGFscmVhZHkgdGhlcmUKICAgIC8vIE1ha2Ugc3VyZSB0byBub3QgaW5zZXJ0IHRoZSBvcmlnaW5hbCB2aWRlbyBlbGVtZW50IGlmIHVzaW5nIEh0bWw1CiAgICBpZiAodGhpcy50ZWNoXy5lbCgpLnBhcmVudE5vZGUgIT09IHRoaXMuZWwoKSAmJiAodGVjaE5hbWUgIT09ICdIdG1sNScgfHwgIXRoaXMudGFnKSkgewogICAgICBEb20uaW5zZXJ0RWxGaXJzdCh0aGlzLnRlY2hfLmVsKCksIHRoaXMuZWwoKSk7CiAgICB9CgogICAgLy8gR2V0IHJpZCBvZiB0aGUgb3JpZ2luYWwgdmlkZW8gdGFnIHJlZmVyZW5jZSBhZnRlciB0aGUgZmlyc3QgdGVjaCBpcyBsb2FkZWQKICAgIGlmICh0aGlzLnRhZykgewogICAgICB0aGlzLnRhZy5wbGF5ZXIgPSBudWxsOwogICAgICB0aGlzLnRhZyA9IG51bGw7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogVW5sb2FkIHBsYXliYWNrIHRlY2hub2xvZ3kKICAgKgogICAqIEBtZXRob2QgdW5sb2FkVGVjaF8KICAgKiBAcHJpdmF0ZQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnVubG9hZFRlY2hfID0gZnVuY3Rpb24gdW5sb2FkVGVjaF8oKSB7CiAgICAvLyBTYXZlIHRoZSBjdXJyZW50IHRleHQgdHJhY2tzIHNvIHRoYXQgd2UgY2FuIHJldXNlIHRoZSBzYW1lIHRleHQgdHJhY2tzIHdpdGggdGhlIG5leHQgdGVjaAogICAgdGhpcy50ZXh0VHJhY2tzXyA9IHRoaXMudGV4dFRyYWNrcygpOwogICAgdGhpcy50ZXh0VHJhY2tzSnNvbl8gPSBfdHJhY2tzVGV4dFRyYWNrTGlzdENvbnZlcnRlckpzMlsnZGVmYXVsdCddLnRleHRUcmFja3NUb0pzb24odGhpcy50ZWNoXyk7CgogICAgdGhpcy5pc1JlYWR5XyA9IGZhbHNlOwoKICAgIHRoaXMudGVjaF8uZGlzcG9zZSgpOwoKICAgIHRoaXMudGVjaF8gPSBmYWxzZTsKICB9OwoKICAvKioKICAgKiBSZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgdGVjaC4KICAgKiBJdCB3aWxsIG9ubHkgcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSB0ZWNoIGlmIGdpdmVuIGFuIG9iamVjdCB3aXRoIHRoZQogICAqIGBJV2lsbE5vdFVzZVRoaXNJblBsdWdpbnNgIHByb3BlcnR5IG9uIGl0LiBUaGlzIGlzIHRyeSBhbmQgcHJldmVudCBtaXN1c2UKICAgKiBvZiB0ZWNocyBieSBwbHVnaW5zLgogICAqCiAgICogQHBhcmFtIHtPYmplY3R9CiAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgVGVjaAogICAqIEBtZXRob2QgdGVjaAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnRlY2ggPSBmdW5jdGlvbiB0ZWNoKHNhZmV0eSkgewogICAgaWYgKHNhZmV0eSAmJiBzYWZldHkuSVdpbGxOb3RVc2VUaGlzSW5QbHVnaW5zKSB7CiAgICAgIHJldHVybiB0aGlzLnRlY2hfOwogICAgfQogICAgdmFyIGVycm9yVGV4dCA9ICdcbiAgICAgIFBsZWFzZSBtYWtlIHN1cmUgdGhhdCB5b3UgYXJlIG5vdCB1c2luZyB0aGlzIGluc2lkZSBvZiBhIHBsdWdpbi5cbiAgICAgIFRvIGRpc2FibGUgdGhpcyBhbGVydCBhbmQgZXJyb3IsIHBsZWFzZSBwYXNzIGluIGFuIG9iamVjdCB3aXRoXG4gICAgICBgSVdpbGxOb3RVc2VUaGlzSW5QbHVnaW5zYCB0byB0aGUgYHRlY2hgIG1ldGhvZC4gU2VlXG4gICAgICBodHRwczovL2dpdGh1Yi5jb20vdmlkZW9qcy92aWRlby5qcy9pc3N1ZXMvMjYxNyBmb3IgbW9yZSBpbmZvLlxuICAgICc7CiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLmFsZXJ0KGVycm9yVGV4dCk7CiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JUZXh0KTsKICB9OwoKICAvKioKICAgKiBTZXQgdXAgY2xpY2sgYW5kIHRvdWNoIGxpc3RlbmVycyBmb3IgdGhlIHBsYXliYWNrIGVsZW1lbnQKICAgKgogICAqIE9uIGRlc2t0b3BzLCBhIGNsaWNrIG9uIHRoZSB2aWRlbyBpdHNlbGYgd2lsbCB0b2dnbGUgcGxheWJhY2ssCiAgICogb24gYSBtb2JpbGUgZGV2aWNlIGEgY2xpY2sgb24gdGhlIHZpZGVvIHRvZ2dsZXMgY29udHJvbHMuCiAgICogKHRvZ2dsaW5nIGNvbnRyb2xzIGlzIGRvbmUgYnkgdG9nZ2xpbmcgdGhlIHVzZXIgc3RhdGUgYmV0d2VlbiBhY3RpdmUgYW5kCiAgICogaW5hY3RpdmUpCiAgICogQSB0YXAgY2FuIHNpZ25hbCB0aGF0IGEgdXNlciBoYXMgYmVjb21lIGFjdGl2ZSwgb3IgaGFzIGJlY29tZSBpbmFjdGl2ZQogICAqIGUuZy4gYSBxdWljayB0YXAgb24gYW4gaVBob25lIG1vdmllIHNob3VsZCByZXZlYWwgdGhlIGNvbnRyb2xzLiBBbm90aGVyCiAgICogcXVpY2sgdGFwIHNob3VsZCBoaWRlIHRoZW0gYWdhaW4gKHNpZ25hbGluZyB0aGUgdXNlciBpcyBpbiBhbiBpbmFjdGl2ZQogICAqIHZpZXdpbmcgc3RhdGUpCiAgICogSW4gYWRkaXRpb24gdG8gdGhpcywgd2Ugc3RpbGwgd2FudCB0aGUgdXNlciB0byBiZSBjb25zaWRlcmVkIGluYWN0aXZlIGFmdGVyCiAgICogYSBmZXcgc2Vjb25kcyBvZiBpbmFjdGl2aXR5LgogICAqIE5vdGU6IHRoZSBvbmx5IHBhcnQgb2YgaU9TIGludGVyYWN0aW9uIHdlIGNhbid0IG1pbWljIHdpdGggdGhpcyBzZXR1cAogICAqIGlzIGEgdG91Y2ggYW5kIGhvbGQgb24gdGhlIHZpZGVvIGVsZW1lbnQgY291bnRpbmcgYXMgYWN0aXZpdHkgaW4gb3JkZXIgdG8KICAgKiBrZWVwIHRoZSBjb250cm9scyBzaG93aW5nLCBidXQgdGhhdCBzaG91bGRuJ3QgYmUgYW4gaXNzdWUuIEEgdG91Y2ggYW5kIGhvbGQKICAgKiBvbiBhbnkgY29udHJvbHMgd2lsbCBzdGlsbCBrZWVwIHRoZSB1c2VyIGFjdGl2ZQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGFkZFRlY2hDb250cm9sc0xpc3RlbmVyc18KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5hZGRUZWNoQ29udHJvbHNMaXN0ZW5lcnNfID0gZnVuY3Rpb24gYWRkVGVjaENvbnRyb2xzTGlzdGVuZXJzXygpIHsKICAgIC8vIE1ha2Ugc3VyZSB0byByZW1vdmUgYWxsIHRoZSBwcmV2aW91cyBsaXN0ZW5lcnMgaW4gY2FzZSB3ZSBhcmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLgogICAgdGhpcy5yZW1vdmVUZWNoQ29udHJvbHNMaXN0ZW5lcnNfKCk7CgogICAgLy8gU29tZSBicm93c2VycyAoQ2hyb21lICYgSUUpIGRvbid0IHRyaWdnZXIgYSBjbGljayBvbiBhIGZsYXNoIHN3ZiwgYnV0IGRvCiAgICAvLyB0cmlnZ2VyIG1vdXNlZG93bi91cC4KICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTQ0NDU2Mi9qYXZhc2NyaXB0LW9uY2xpY2stZXZlbnQtb3Zlci1mbGFzaC1vYmplY3QKICAgIC8vIEFueSB0b3VjaCBldmVudHMgYXJlIHNldCB0byBibG9jayB0aGUgbW91c2Vkb3duIGV2ZW50IGZyb20gaGFwcGVuaW5nCiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZVRlY2hDbGlja18pOwoKICAgIC8vIElmIHRoZSBjb250cm9scyB3ZXJlIGhpZGRlbiB3ZSBkb24ndCB3YW50IHRoYXQgdG8gY2hhbmdlIHdpdGhvdXQgYSB0YXAgZXZlbnQKICAgIC8vIHNvIHdlJ2xsIGNoZWNrIGlmIHRoZSBjb250cm9scyB3ZXJlIGFscmVhZHkgc2hvd2luZyBiZWZvcmUgcmVwb3J0aW5nIHVzZXIKICAgIC8vIGFjdGl2aXR5CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICd0b3VjaHN0YXJ0JywgdGhpcy5oYW5kbGVUZWNoVG91Y2hTdGFydF8pOwogICAgdGhpcy5vbih0aGlzLnRlY2hfLCAndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVUZWNoVG91Y2hNb3ZlXyk7CiAgICB0aGlzLm9uKHRoaXMudGVjaF8sICd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlVGVjaFRvdWNoRW5kXyk7CgogICAgLy8gVGhlIHRhcCBsaXN0ZW5lciBuZWVkcyB0byBjb21lIGFmdGVyIHRoZSB0b3VjaGVuZCBsaXN0ZW5lciBiZWNhdXNlIHRoZSB0YXAKICAgIC8vIGxpc3RlbmVyIGNhbmNlbHMgb3V0IGFueSByZXBvcnRlZFVzZXJBY3Rpdml0eSB3aGVuIHNldHRpbmcgdXNlckFjdGl2ZShmYWxzZSkKICAgIHRoaXMub24odGhpcy50ZWNoXywgJ3RhcCcsIHRoaXMuaGFuZGxlVGVjaFRhcF8pOwogIH07CgogIC8qKgogICAqIFJlbW92ZSB0aGUgbGlzdGVuZXJzIHVzZWQgZm9yIGNsaWNrIGFuZCB0YXAgY29udHJvbHMuIFRoaXMgaXMgbmVlZGVkIGZvcgogICAqIHRvZ2dsaW5nIHRvIGNvbnRyb2xzIGRpc2FibGVkLCB3aGVyZSBhIHRhcC90b3VjaCBzaG91bGQgZG8gbm90aGluZy4KICAgKgogICAqIEBtZXRob2QgcmVtb3ZlVGVjaENvbnRyb2xzTGlzdGVuZXJzXwogICAqIEBwcml2YXRlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUucmVtb3ZlVGVjaENvbnRyb2xzTGlzdGVuZXJzXyA9IGZ1bmN0aW9uIHJlbW92ZVRlY2hDb250cm9sc0xpc3RlbmVyc18oKSB7CiAgICAvLyBXZSBkb24ndCB3YW50IHRvIGp1c3QgdXNlIGB0aGlzLm9mZigpYCBiZWNhdXNlIHRoZXJlIG1pZ2h0IGJlIG90aGVyIG5lZWRlZAogICAgLy8gbGlzdGVuZXJzIGFkZGVkIGJ5IHRlY2hzIHRoYXQgZXh0ZW5kIHRoaXMuCiAgICB0aGlzLm9mZih0aGlzLnRlY2hfLCAndGFwJywgdGhpcy5oYW5kbGVUZWNoVGFwXyk7CiAgICB0aGlzLm9mZih0aGlzLnRlY2hfLCAndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlVGVjaFRvdWNoU3RhcnRfKTsKICAgIHRoaXMub2ZmKHRoaXMudGVjaF8sICd0b3VjaG1vdmUnLCB0aGlzLmhhbmRsZVRlY2hUb3VjaE1vdmVfKTsKICAgIHRoaXMub2ZmKHRoaXMudGVjaF8sICd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlVGVjaFRvdWNoRW5kXyk7CiAgICB0aGlzLm9mZih0aGlzLnRlY2hfLCAnbW91c2Vkb3duJywgdGhpcy5oYW5kbGVUZWNoQ2xpY2tfKTsKICB9OwoKICAvKioKICAgKiBQbGF5ZXIgd2FpdHMgZm9yIHRoZSB0ZWNoIHRvIGJlIHJlYWR5CiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hSZWFkeV8KICAgKiBAcHJpdmF0ZQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hSZWFkeV8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoUmVhZHlfKCkgewogICAgdGhpcy50cmlnZ2VyUmVhZHkoKTsKCiAgICAvLyBLZWVwIHRoZSBzYW1lIHZvbHVtZSBhcyBiZWZvcmUKICAgIGlmICh0aGlzLmNhY2hlXy52b2x1bWUpIHsKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldFZvbHVtZScsIHRoaXMuY2FjaGVfLnZvbHVtZSk7CiAgICB9CgogICAgLy8gTG9vayBpZiB0aGUgdGVjaCBmb3VuZCBhIGhpZ2hlciByZXNvbHV0aW9uIHBvc3RlciB3aGlsZSBsb2FkaW5nCiAgICB0aGlzLmhhbmRsZVRlY2hQb3N0ZXJDaGFuZ2VfKCk7CgogICAgLy8gVXBkYXRlIHRoZSBkdXJhdGlvbiBpZiBhdmFpbGFibGUKICAgIHRoaXMuaGFuZGxlVGVjaER1cmF0aW9uQ2hhbmdlXygpOwoKICAgIC8vIENocm9tZSBhbmQgU2FmYXJpIGJvdGggaGF2ZSBpc3N1ZXMgd2l0aCBhdXRvcGxheS4KICAgIC8vIEluIFNhZmFyaSAoNS4xLjEpLCB3aGVuIHdlIG1vdmUgdGhlIHZpZGVvIGVsZW1lbnQgaW50byB0aGUgY29udGFpbmVyIGRpdiwgYXV0b3BsYXkgZG9lc24ndCB3b3JrLgogICAgLy8gSW4gQ2hyb21lICgxNSksIGlmIHlvdSBoYXZlIGF1dG9wbGF5ICsgYSBwb3N0ZXIgKyBubyBjb250cm9scywgdGhlIHZpZGVvIGdldHMgaGlkZGVuIChidXQgYXVkaW8gcGxheXMpCiAgICAvLyBUaGlzIGZpeGVzIGJvdGggaXNzdWVzLiBOZWVkIHRvIHdhaXQgZm9yIEFQSSwgc28gaXQgdXBkYXRlcyBkaXNwbGF5cyBjb3JyZWN0bHkKICAgIGlmICh0aGlzLnRhZyAmJiB0aGlzLm9wdGlvbnNfLmF1dG9wbGF5ICYmIHRoaXMucGF1c2VkKCkpIHsKICAgICAgZGVsZXRlIHRoaXMudGFnLnBvc3RlcjsgLy8gQ2hyb21lIEZpeC4gRml4ZWQgaW4gQ2hyb21lIHYxNi4KICAgICAgdGhpcy5wbGF5KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogRmlyZWQgd2hlbiB0aGUgdXNlciBhZ2VudCBiZWdpbnMgbG9va2luZyBmb3IgbWVkaWEgZGF0YQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hMb2FkU3RhcnRfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaExvYWRTdGFydF8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoTG9hZFN0YXJ0XygpIHsKICAgIC8vIFRPRE86IFVwZGF0ZSB0byB1c2UgYGVtcHRpZWRgIGV2ZW50IGluc3RlYWQuIFNlZSAjMTI3Ny4KCiAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtZW5kZWQnKTsKCiAgICAvLyByZXNldCB0aGUgZXJyb3Igc3RhdGUKICAgIHRoaXMuZXJyb3IobnVsbCk7CgogICAgLy8gSWYgaXQncyBhbHJlYWR5IHBsYXlpbmcgd2Ugd2FudCB0byB0cmlnZ2VyIGEgZmlyc3RwbGF5IGV2ZW50IG5vdy4KICAgIC8vIFRoZSBmaXJzdHBsYXkgZXZlbnQgcmVsaWVzIG9uIGJvdGggdGhlIHBsYXkgYW5kIGxvYWRzdGFydCBldmVudHMKICAgIC8vIHdoaWNoIGNhbiBoYXBwZW4gaW4gYW55IG9yZGVyIGZvciBhIG5ldyBzb3VyY2UKICAgIGlmICghdGhpcy5wYXVzZWQoKSkgewogICAgICB0aGlzLnRyaWdnZXIoJ2xvYWRzdGFydCcpOwogICAgICB0aGlzLnRyaWdnZXIoJ2ZpcnN0cGxheScpOwogICAgfSBlbHNlIHsKICAgICAgLy8gcmVzZXQgdGhlIGhhc1N0YXJ0ZWQgc3RhdGUKICAgICAgdGhpcy5oYXNTdGFydGVkKGZhbHNlKTsKICAgICAgdGhpcy50cmlnZ2VyKCdsb2Fkc3RhcnQnKTsKICAgIH0KICB9OwoKICAvKioKICAgKiBBZGQvcmVtb3ZlIHRoZSB2anMtaGFzLXN0YXJ0ZWQgY2xhc3MKICAgKgogICAqIEBwYXJhbSB7Qm9vbGVhbn0gaGFzU3RhcnRlZCBUaGUgdmFsdWUgb2YgdHJ1ZSBhZGRzIHRoZSBjbGFzcyB0aGUgdmFsdWUgb2YgZmFsc2UgcmVtb3ZlIHRoZSBjbGFzcwogICAqIEByZXR1cm4ge0Jvb2xlYW59IEJvb2xlYW4gdmFsdWUgaWYgaGFzIHN0YXJ0ZWQKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFzU3RhcnRlZAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhc1N0YXJ0ZWQgPSBmdW5jdGlvbiBoYXNTdGFydGVkKF9oYXNTdGFydGVkKSB7CiAgICBpZiAoX2hhc1N0YXJ0ZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAvLyBvbmx5IHVwZGF0ZSBpZiB0aGlzIGlzIGEgbmV3IHZhbHVlCiAgICAgIGlmICh0aGlzLmhhc1N0YXJ0ZWRfICE9PSBfaGFzU3RhcnRlZCkgewogICAgICAgIHRoaXMuaGFzU3RhcnRlZF8gPSBfaGFzU3RhcnRlZDsKICAgICAgICBpZiAoX2hhc1N0YXJ0ZWQpIHsKICAgICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1oYXMtc3RhcnRlZCcpOwogICAgICAgICAgLy8gdHJpZ2dlciB0aGUgZmlyc3RwbGF5IGV2ZW50IGlmIHRoaXMgbmV3bHkgaGFzIHBsYXllZAogICAgICAgICAgdGhpcy50cmlnZ2VyKCdmaXJzdHBsYXknKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWhhcy1zdGFydGVkJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgcmV0dXJuICEhdGhpcy5oYXNTdGFydGVkXzsKICB9OwoKICAvKioKICAgKiBGaXJlZCB3aGVuZXZlciB0aGUgbWVkaWEgYmVnaW5zIG9yIHJlc3VtZXMgcGxheWJhY2sKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoUGxheV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoUGxheV8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoUGxheV8oKSB7CiAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtZW5kZWQnKTsKICAgIHRoaXMucmVtb3ZlQ2xhc3MoJ3Zqcy1wYXVzZWQnKTsKICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1wbGF5aW5nJyk7CgogICAgLy8gaGlkZSB0aGUgcG9zdGVyIHdoZW4gdGhlIHVzZXIgaGl0cyBwbGF5CiAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9lbWJlZGRlZC1jb250ZW50Lmh0bWwjZG9tLW1lZGlhLXBsYXkKICAgIHRoaXMuaGFzU3RhcnRlZCh0cnVlKTsKCiAgICB0aGlzLnRyaWdnZXIoJ3BsYXknKTsKICB9OwoKICAvKioKICAgKiBGaXJlZCB3aGVuZXZlciB0aGUgbWVkaWEgYmVnaW5zIHdhaXRpbmcKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoV2FpdGluZ18KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoV2FpdGluZ18gPSBmdW5jdGlvbiBoYW5kbGVUZWNoV2FpdGluZ18oKSB7CiAgICB0aGlzLmFkZENsYXNzKCd2anMtd2FpdGluZycpOwogICAgdGhpcy50cmlnZ2VyKCd3YWl0aW5nJyk7CiAgfTsKCiAgLyoqCiAgICogQSBoYW5kbGVyIGZvciBldmVudHMgdGhhdCBzaWduYWwgdGhhdCB3YWl0aW5nIGhhcyBlbmRlZAogICAqIHdoaWNoIGlzIG5vdCBjb25zaXN0ZW50IGJldHdlZW4gYnJvd3NlcnMuIFNlZSAjMTM1MQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hDYW5QbGF5XwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hDYW5QbGF5XyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hDYW5QbGF5XygpIHsKICAgIHRoaXMucmVtb3ZlQ2xhc3MoJ3Zqcy13YWl0aW5nJyk7CiAgICB0aGlzLnRyaWdnZXIoJ2NhbnBsYXknKTsKICB9OwoKICAvKioKICAgKiBBIGhhbmRsZXIgZm9yIGV2ZW50cyB0aGF0IHNpZ25hbCB0aGF0IHdhaXRpbmcgaGFzIGVuZGVkCiAgICogd2hpY2ggaXMgbm90IGNvbnNpc3RlbnQgYmV0d2VlbiBicm93c2Vycy4gU2VlICMxMzUxCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaENhblBsYXlUaHJvdWdoXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hDYW5QbGF5VGhyb3VnaF8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoQ2FuUGxheVRocm91Z2hfKCkgewogICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLXdhaXRpbmcnKTsKICAgIHRoaXMudHJpZ2dlcignY2FucGxheXRocm91Z2gnKTsKICB9OwoKICAvKioKICAgKiBBIGhhbmRsZXIgZm9yIGV2ZW50cyB0aGF0IHNpZ25hbCB0aGF0IHdhaXRpbmcgaGFzIGVuZGVkCiAgICogd2hpY2ggaXMgbm90IGNvbnNpc3RlbnQgYmV0d2VlbiBicm93c2Vycy4gU2VlICMxMzUxCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFBsYXlpbmdfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaFBsYXlpbmdfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFBsYXlpbmdfKCkgewogICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLXdhaXRpbmcnKTsKICAgIHRoaXMudHJpZ2dlcigncGxheWluZycpOwogIH07CgogIC8qKgogICAqIEZpcmVkIHdoZW5ldmVyIHRoZSBwbGF5ZXIgaXMganVtcGluZyB0byBhIG5ldyB0aW1lCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFNlZWtpbmdfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaFNlZWtpbmdfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFNlZWtpbmdfKCkgewogICAgdGhpcy5hZGRDbGFzcygndmpzLXNlZWtpbmcnKTsKICAgIHRoaXMudHJpZ2dlcignc2Vla2luZycpOwogIH07CgogIC8qKgogICAqIEZpcmVkIHdoZW4gdGhlIHBsYXllciBoYXMgZmluaXNoZWQganVtcGluZyB0byBhIG5ldyB0aW1lCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFNlZWtlZF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoU2Vla2VkXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hTZWVrZWRfKCkgewogICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLXNlZWtpbmcnKTsKICAgIHRoaXMudHJpZ2dlcignc2Vla2VkJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZWQgdGhlIGZpcnN0IHRpbWUgYSB2aWRlbyBpcyBwbGF5ZWQKICAgKiBOb3QgcGFydCBvZiB0aGUgSExTIHNwZWMsIGFuZCB3ZSdyZSBub3Qgc3VyZSBpZiB0aGlzIGlzIHRoZSBiZXN0CiAgICogaW1wbGVtZW50YXRpb24geWV0LCBzbyB1c2Ugc3BhcmluZ2x5LiBJZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYXNvbiB0bwogICAqIHByZXZlbnQgcGxheWJhY2ssIHVzZSBgbXlQbGF5ZXIub25lKCdwbGF5Jyk7YCBpbnN0ZWFkLgogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hGaXJzdFBsYXlfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaEZpcnN0UGxheV8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoRmlyc3RQbGF5XygpIHsKICAgIC8vSWYgdGhlIGZpcnN0IHN0YXJ0dGltZSBhdHRyaWJ1dGUgaXMgc3BlY2lmaWVkCiAgICAvL3RoZW4gd2Ugd2lsbCBzdGFydCBhdCB0aGUgZ2l2ZW4gb2Zmc2V0IGluIHNlY29uZHMKICAgIGlmICh0aGlzLm9wdGlvbnNfLnN0YXJ0dGltZSkgewogICAgICB0aGlzLmN1cnJlbnRUaW1lKHRoaXMub3B0aW9uc18uc3RhcnR0aW1lKTsKICAgIH0KCiAgICB0aGlzLmFkZENsYXNzKCd2anMtaGFzLXN0YXJ0ZWQnKTsKICAgIHRoaXMudHJpZ2dlcignZmlyc3RwbGF5Jyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZWQgd2hlbmV2ZXIgdGhlIG1lZGlhIGhhcyBiZWVuIHBhdXNlZAogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hQYXVzZV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoUGF1c2VfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFBhdXNlXygpIHsKICAgIHRoaXMucmVtb3ZlQ2xhc3MoJ3Zqcy1wbGF5aW5nJyk7CiAgICB0aGlzLmFkZENsYXNzKCd2anMtcGF1c2VkJyk7CiAgICB0aGlzLnRyaWdnZXIoJ3BhdXNlJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZWQgd2hpbGUgdGhlIHVzZXIgYWdlbnQgaXMgZG93bmxvYWRpbmcgbWVkaWEgZGF0YQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hQcm9ncmVzc18KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoUHJvZ3Jlc3NfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFByb2dyZXNzXygpIHsKICAgIHRoaXMudHJpZ2dlcigncHJvZ3Jlc3MnKTsKICB9OwoKICAvKioKICAgKiBGaXJlZCB3aGVuIHRoZSBlbmQgb2YgdGhlIG1lZGlhIHJlc291cmNlIGlzIHJlYWNoZWQgKGN1cnJlbnRUaW1lID09IGR1cmF0aW9uKQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hFbmRlZF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoRW5kZWRfID0gZnVuY3Rpb24gaGFuZGxlVGVjaEVuZGVkXygpIHsKICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1lbmRlZCcpOwogICAgaWYgKHRoaXMub3B0aW9uc18ubG9vcCkgewogICAgICB0aGlzLmN1cnJlbnRUaW1lKDApOwogICAgICB0aGlzLnBsYXkoKTsKICAgIH0gZWxzZSBpZiAoIXRoaXMucGF1c2VkKCkpIHsKICAgICAgdGhpcy5wYXVzZSgpOwogICAgfQoKICAgIHRoaXMudHJpZ2dlcignZW5kZWQnKTsKICB9OwoKICAvKioKICAgKiBGaXJlZCB3aGVuIHRoZSBkdXJhdGlvbiBvZiB0aGUgbWVkaWEgcmVzb3VyY2UgaXMgZmlyc3Qga25vd24gb3IgY2hhbmdlZAogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hEdXJhdGlvbkNoYW5nZV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoRHVyYXRpb25DaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVGVjaER1cmF0aW9uQ2hhbmdlXygpIHsKICAgIHRoaXMuZHVyYXRpb24odGhpcy50ZWNoR2V0XygnZHVyYXRpb24nKSk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGEgY2xpY2sgb24gdGhlIG1lZGlhIGVsZW1lbnQgdG8gcGxheS9wYXVzZQogICAqCiAgICogQHBhcmFtIHtPYmplY3Q9fSBldmVudCBFdmVudCBvYmplY3QKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaENsaWNrXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hDbGlja18gPSBmdW5jdGlvbiBoYW5kbGVUZWNoQ2xpY2tfKGV2ZW50KSB7CiAgICAvLyBXZSdyZSB1c2luZyBtb3VzZWRvd24gdG8gZGV0ZWN0IGNsaWNrcyB0aGFua3MgdG8gRmxhc2gsIGJ1dCBtb3VzZWRvd24KICAgIC8vIHdpbGwgYWxzbyBiZSB0cmlnZ2VyZWQgd2l0aCByaWdodC1jbGlja3MsIHNvIHdlIG5lZWQgdG8gcHJldmVudCB0aGF0CiAgICBpZiAoZXZlbnQuYnV0dG9uICE9PSAwKSByZXR1cm47CgogICAgLy8gV2hlbiBjb250cm9scyBhcmUgZGlzYWJsZWQgYSBjbGljayBzaG91bGQgbm90IHRvZ2dsZSBwbGF5YmFjayBiZWNhdXNlCiAgICAvLyB0aGUgY2xpY2sgaXMgY29uc2lkZXJlZCBhIGNvbnRyb2wKICAgIGlmICh0aGlzLmNvbnRyb2xzKCkpIHsKICAgICAgaWYgKHRoaXMucGF1c2VkKCkpIHsKICAgICAgICB0aGlzLnBsYXkoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhdXNlKCk7CiAgICAgIH0KICAgIH0KICB9OwoKICAvKioKICAgKiBIYW5kbGUgYSB0YXAgb24gdGhlIG1lZGlhIGVsZW1lbnQuIEl0IHdpbGwgdG9nZ2xlIHRoZSB1c2VyCiAgICogYWN0aXZpdHkgc3RhdGUsIHdoaWNoIGhpZGVzIGFuZCBzaG93cyB0aGUgY29udHJvbHMuCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFRhcF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoVGFwXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hUYXBfKCkgewogICAgdGhpcy51c2VyQWN0aXZlKCF0aGlzLnVzZXJBY3RpdmUoKSk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIHRvdWNoIHRvIHN0YXJ0CiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFRvdWNoU3RhcnRfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaFRvdWNoU3RhcnRfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFRvdWNoU3RhcnRfKCkgewogICAgdGhpcy51c2VyV2FzQWN0aXZlID0gdGhpcy51c2VyQWN0aXZlKCk7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIHRvdWNoIHRvIG1vdmUKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoVG91Y2hNb3ZlXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hUb3VjaE1vdmVfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFRvdWNoTW92ZV8oKSB7CiAgICBpZiAodGhpcy51c2VyV2FzQWN0aXZlKSB7CiAgICAgIHRoaXMucmVwb3J0VXNlckFjdGl2aXR5KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIHRvdWNoIHRvIGVuZAogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hUb3VjaEVuZF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoVG91Y2hFbmRfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFRvdWNoRW5kXyhldmVudCkgewogICAgLy8gU3RvcCB0aGUgbW91c2UgZXZlbnRzIGZyb20gYWxzbyBoYXBwZW5pbmcKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgfTsKCiAgLyoqCiAgICogRmlyZWQgd2hlbiB0aGUgcGxheWVyIHN3aXRjaGVzIGluIG9yIG91dCBvZiBmdWxsc2NyZWVuIG1vZGUKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlRnVsbHNjcmVlbkNoYW5nZV8oKSB7CiAgICBpZiAodGhpcy5pc0Z1bGxzY3JlZW4oKSkgewogICAgICB0aGlzLmFkZENsYXNzKCd2anMtZnVsbHNjcmVlbicpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWZ1bGxzY3JlZW4nKTsKICAgIH0KICB9OwoKICAvKioKICAgKiBuYXRpdmUgY2xpY2sgZXZlbnRzIG9uIHRoZSBTV0YgYXJlbid0IHRyaWdnZXJlZCBvbiBJRTExLCBXaW44LjFSVAogICAqIHVzZSBzdGFnZWNsaWNrIGV2ZW50cyB0cmlnZ2VyZWQgZnJvbSBpbnNpZGUgdGhlIFNXRiBpbnN0ZWFkCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlU3RhZ2VDbGlja18KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVTdGFnZUNsaWNrXyA9IGZ1bmN0aW9uIGhhbmRsZVN0YWdlQ2xpY2tfKCkgewogICAgdGhpcy5yZXBvcnRVc2VyQWN0aXZpdHkoKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgVGVjaCBGdWxsc2NyZWVuIENoYW5nZQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hGdWxsc2NyZWVuQ2hhbmdlXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hGdWxsc2NyZWVuQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hGdWxsc2NyZWVuQ2hhbmdlXyhldmVudCwgZGF0YSkgewogICAgaWYgKGRhdGEpIHsKICAgICAgdGhpcy5pc0Z1bGxzY3JlZW4oZGF0YS5pc0Z1bGxzY3JlZW4pOwogICAgfQogICAgdGhpcy50cmlnZ2VyKCdmdWxsc2NyZWVuY2hhbmdlJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZXMgd2hlbiBhbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgdGhlIGxvYWRpbmcgb2YgYW4gYXVkaW8vdmlkZW8KICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoRXJyb3JfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaEVycm9yXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hFcnJvcl8oKSB7CiAgICB2YXIgZXJyb3IgPSB0aGlzLnRlY2hfLmVycm9yKCk7CiAgICB0aGlzLmVycm9yKGVycm9yICYmIGVycm9yLmNvZGUpOwogIH07CgogIC8qKgogICAqIEZpcmVzIHdoZW4gdGhlIGJyb3dzZXIgaXMgaW50ZW50aW9uYWxseSBub3QgZ2V0dGluZyBtZWRpYSBkYXRhCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFN1c3BlbmRfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaFN1c3BlbmRfID0gZnVuY3Rpb24gaGFuZGxlVGVjaFN1c3BlbmRfKCkgewogICAgdGhpcy50cmlnZ2VyKCdzdXNwZW5kJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZXMgd2hlbiB0aGUgbG9hZGluZyBvZiBhbiBhdWRpby92aWRlbyBpcyBhYm9ydGVkCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaEFib3J0XwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hBYm9ydF8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoQWJvcnRfKCkgewogICAgdGhpcy50cmlnZ2VyKCdhYm9ydCcpOwogIH07CgogIC8qKgogICAqIEZpcmVzIHdoZW4gdGhlIGN1cnJlbnQgcGxheWxpc3QgaXMgZW1wdHkKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoRW1wdGllZF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoRW1wdGllZF8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoRW1wdGllZF8oKSB7CiAgICB0aGlzLnRyaWdnZXIoJ2VtcHRpZWQnKTsKICB9OwoKICAvKioKICAgKiBGaXJlcyB3aGVuIHRoZSBicm93c2VyIGlzIHRyeWluZyB0byBnZXQgbWVkaWEgZGF0YSwgYnV0IGRhdGEgaXMgbm90IGF2YWlsYWJsZQogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hTdGFsbGVkXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hTdGFsbGVkXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hTdGFsbGVkXygpIHsKICAgIHRoaXMudHJpZ2dlcignc3RhbGxlZCcpOwogIH07CgogIC8qKgogICAqIEZpcmVzIHdoZW4gdGhlIGJyb3dzZXIgaGFzIGxvYWRlZCBtZXRhIGRhdGEgZm9yIHRoZSBhdWRpby92aWRlbwogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hMb2FkZWRNZXRhRGF0YV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoTG9hZGVkTWV0YURhdGFfID0gZnVuY3Rpb24gaGFuZGxlVGVjaExvYWRlZE1ldGFEYXRhXygpIHsKICAgIHRoaXMudHJpZ2dlcignbG9hZGVkbWV0YWRhdGEnKTsKICB9OwoKICAvKioKICAgKiBGaXJlcyB3aGVuIHRoZSBicm93c2VyIGhhcyBsb2FkZWQgdGhlIGN1cnJlbnQgZnJhbWUgb2YgdGhlIGF1ZGlvL3ZpZGVvCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaExvYWRlZERhdGFfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaExvYWRlZERhdGFfID0gZnVuY3Rpb24gaGFuZGxlVGVjaExvYWRlZERhdGFfKCkgewogICAgdGhpcy50cmlnZ2VyKCdsb2FkZWRkYXRhJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZXMgd2hlbiB0aGUgY3VycmVudCBwbGF5YmFjayBwb3NpdGlvbiBoYXMgY2hhbmdlZAogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hUaW1lVXBkYXRlXwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hUaW1lVXBkYXRlXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hUaW1lVXBkYXRlXygpIHsKICAgIHRoaXMudHJpZ2dlcigndGltZXVwZGF0ZScpOwogIH07CgogIC8qKgogICAqIEZpcmVzIHdoZW4gdGhlIHBsYXlpbmcgc3BlZWQgb2YgdGhlIGF1ZGlvL3ZpZGVvIGlzIGNoYW5nZWQKICAgKgogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBoYW5kbGVUZWNoUmF0ZUNoYW5nZV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoUmF0ZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoUmF0ZUNoYW5nZV8oKSB7CiAgICB0aGlzLnRyaWdnZXIoJ3JhdGVjaGFuZ2UnKTsKICB9OwoKICAvKioKICAgKiBGaXJlcyB3aGVuIHRoZSB2b2x1bWUgaGFzIGJlZW4gY2hhbmdlZAogICAqCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIGhhbmRsZVRlY2hWb2x1bWVDaGFuZ2VfCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuaGFuZGxlVGVjaFZvbHVtZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVUZWNoVm9sdW1lQ2hhbmdlXygpIHsKICAgIHRoaXMudHJpZ2dlcigndm9sdW1lY2hhbmdlJyk7CiAgfTsKCiAgLyoqCiAgICogRmlyZXMgd2hlbiB0aGUgdGV4dCB0cmFjayBoYXMgYmVlbiBjaGFuZ2VkCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFRleHRUcmFja0NoYW5nZV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoVGV4dFRyYWNrQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hUZXh0VHJhY2tDaGFuZ2VfKCkgewogICAgdGhpcy50cmlnZ2VyKCd0ZXh0dHJhY2tjaGFuZ2UnKTsKICB9OwoKICAvKioKICAgKiBHZXQgb2JqZWN0IGZvciBjYWNoZWQgdmFsdWVzLgogICAqCiAgICogQHJldHVybiB7T2JqZWN0fQogICAqIEBtZXRob2QgZ2V0Q2FjaGUKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5nZXRDYWNoZSA9IGZ1bmN0aW9uIGdldENhY2hlKCkgewogICAgcmV0dXJuIHRoaXMuY2FjaGVfOwogIH07CgogIC8qKgogICAqIFBhc3MgdmFsdWVzIHRvIHRoZSBwbGF5YmFjayB0ZWNoCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZz19IG1ldGhvZCBNZXRob2QKICAgKiBAcGFyYW0ge09iamVjdD19IGFyZyBBcmd1bWVudAogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCB0ZWNoQ2FsbF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS50ZWNoQ2FsbF8gPSBmdW5jdGlvbiB0ZWNoQ2FsbF8obWV0aG9kLCBhcmcpIHsKICAgIC8vIElmIGl0J3Mgbm90IHJlYWR5IHlldCwgY2FsbCBtZXRob2Qgd2hlbiBpdCBpcwogICAgaWYgKHRoaXMudGVjaF8gJiYgIXRoaXMudGVjaF8uaXNSZWFkeV8pIHsKICAgICAgdGhpcy50ZWNoXy5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpc1ttZXRob2RdKGFyZyk7CiAgICAgIH0sIHRydWUpOwoKICAgICAgLy8gT3RoZXJ3aXNlIGNhbGwgbWV0aG9kIG5vdwogICAgfSBlbHNlIHsKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy50ZWNoX1ttZXRob2RdKGFyZyk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10oZSk7CiAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0KICAgICAgfQogIH07CgogIC8qKgogICAqIEdldCBjYWxscyBjYW4ndCB3YWl0IGZvciB0aGUgdGVjaCwgYW5kIHNvbWV0aW1lcyBkb24ndCBuZWVkIHRvLgogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCBUZWNoIG1ldGhvZAogICAqIEByZXR1cm4ge01ldGhvZH0KICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgdGVjaEdldF8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS50ZWNoR2V0XyA9IGZ1bmN0aW9uIHRlY2hHZXRfKG1ldGhvZCkgewogICAgaWYgKHRoaXMudGVjaF8gJiYgdGhpcy50ZWNoXy5pc1JlYWR5XykgewoKICAgICAgLy8gRmxhc2ggbGlrZXMgdG8gZGllIGFuZCByZWxvYWQgd2hlbiB5b3UgaGlkZSBvciByZXBvc2l0aW9uIGl0LgogICAgICAvLyBJbiB0aGVzZSBjYXNlcyB0aGUgb2JqZWN0IG1ldGhvZHMgZ28gYXdheSBhbmQgd2UgZ2V0IGVycm9ycy4KICAgICAgLy8gV2hlbiB0aGF0IGhhcHBlbnMgd2UnbGwgY2F0Y2ggdGhlIGVycm9ycyBhbmQgaW5mb3JtIHRlY2ggdGhhdCBpdCdzIG5vdCByZWFkeSBhbnkgbW9yZS4KICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gdGhpcy50ZWNoX1ttZXRob2RdKCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBXaGVuIGJ1aWxkaW5nIGFkZGl0aW9uYWwgdGVjaCBsaWJzLCBhbiBleHBlY3RlZCBtZXRob2QgbWF5IG5vdCBiZSBkZWZpbmVkIHlldAogICAgICAgIGlmICh0aGlzLnRlY2hfW21ldGhvZF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10oJ1ZpZGVvLmpzOiAnICsgbWV0aG9kICsgJyBtZXRob2Qgbm90IGRlZmluZWQgZm9yICcgKyB0aGlzLnRlY2hOYW1lXyArICcgcGxheWJhY2sgdGVjaG5vbG9neS4nLCBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gV2hlbiBhIG1ldGhvZCBpc24ndCBhdmFpbGFibGUgb24gdGhlIG9iamVjdCBpdCB0aHJvd3MgYSBUeXBlRXJyb3IKICAgICAgICAgIGlmIChlLm5hbWUgPT09ICdUeXBlRXJyb3InKSB7CiAgICAgICAgICAgIF91dGlsc0xvZ0pzMlsnZGVmYXVsdCddKCdWaWRlby5qczogJyArIG1ldGhvZCArICcgdW5hdmFpbGFibGUgb24gJyArIHRoaXMudGVjaE5hbWVfICsgJyBwbGF5YmFjayB0ZWNobm9sb2d5IGVsZW1lbnQuJywgZSk7CiAgICAgICAgICAgIHRoaXMudGVjaF8uaXNSZWFkeV8gPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF91dGlsc0xvZ0pzMlsnZGVmYXVsdCddKGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuOwogIH07CgogIC8qKgogICAqIHN0YXJ0IG1lZGlhIHBsYXliYWNrCiAgICogYGBganMKICAgKiAgICAgbXlQbGF5ZXIucGxheSgpOwogICAqIGBgYAogICAqCiAgICogQHJldHVybiB7UGxheWVyfSBzZWxmCiAgICogQG1ldGhvZCBwbGF5CiAgICovCgogIFBsYXllci5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIHBsYXkoKSB7CiAgICB0aGlzLnRlY2hDYWxsXygncGxheScpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogUGF1c2UgdGhlIHZpZGVvIHBsYXliYWNrCiAgICogYGBganMKICAgKiAgICAgbXlQbGF5ZXIucGF1c2UoKTsKICAgKiBgYGAKICAgKgogICAqIEByZXR1cm4ge1BsYXllcn0gc2VsZgogICAqIEBtZXRob2QgcGF1c2UKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgdGhpcy50ZWNoQ2FsbF8oJ3BhdXNlJyk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBDaGVjayBpZiB0aGUgcGxheWVyIGlzIHBhdXNlZAogICAqIGBgYGpzCiAgICogICAgIHZhciBpc1BhdXNlZCA9IG15UGxheWVyLnBhdXNlZCgpOwogICAqICAgICB2YXIgaXNQbGF5aW5nID0gIW15UGxheWVyLnBhdXNlZCgpOwogICAqIGBgYAogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0gZmFsc2UgaWYgdGhlIG1lZGlhIGlzIGN1cnJlbnRseSBwbGF5aW5nLCBvciB0cnVlIG90aGVyd2lzZQogICAqIEBtZXRob2QgcGF1c2VkCiAgICovCgogIFBsYXllci5wcm90b3R5cGUucGF1c2VkID0gZnVuY3Rpb24gcGF1c2VkKCkgewogICAgLy8gVGhlIGluaXRpYWwgc3RhdGUgb2YgcGF1c2VkIHNob3VsZCBiZSB0cnVlIChpbiBTYWZhcmkgaXQncyBhY3R1YWxseSBmYWxzZSkKICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdwYXVzZWQnKSA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWU7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGUgdXNlciBpcyAic2NydWJiaW5nIi4gU2NydWJiaW5nIGlzIHdoZW4gdGhlIHVzZXIKICAgKiBoYXMgY2xpY2tlZCB0aGUgcHJvZ3Jlc3MgYmFyIGhhbmRsZSBhbmQgaXMgZHJhZ2dpbmcgaXQgYWxvbmcgdGhlIHByb2dyZXNzIGJhci4KICAgKgogICAqIEBwYXJhbSAge0Jvb2xlYW59IGlzU2NydWJiaW5nICAgVHJ1ZS9mYWxzZSB0aGUgdXNlciBpcyBzY3J1YmJpbmcKICAgKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICAgICAgICAgIFRoZSBzY3J1YmJpbmcgc3RhdHVzIHdoZW4gZ2V0dGluZwogICAqIEByZXR1cm4ge09iamVjdH0gICAgICAgICAgICAgICAgVGhlIHBsYXllciB3aGVuIHNldHRpbmcKICAgKiBAbWV0aG9kIHNjcnViYmluZwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnNjcnViYmluZyA9IGZ1bmN0aW9uIHNjcnViYmluZyhpc1NjcnViYmluZykgewogICAgaWYgKGlzU2NydWJiaW5nICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy5zY3J1YmJpbmdfID0gISFpc1NjcnViYmluZzsKCiAgICAgIGlmIChpc1NjcnViYmluZykgewogICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1zY3J1YmJpbmcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtc2NydWJiaW5nJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHJldHVybiB0aGlzLnNjcnViYmluZ187CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgY3VycmVudCB0aW1lIChpbiBzZWNvbmRzKQogICAqIGBgYGpzCiAgICogICAgIC8vIGdldAogICAqICAgICB2YXIgd2hlcmVZb3VBdCA9IG15UGxheWVyLmN1cnJlbnRUaW1lKCk7CiAgICogICAgIC8vIHNldAogICAqICAgICBteVBsYXllci5jdXJyZW50VGltZSgxMjApOyAvLyAyIG1pbnV0ZXMgaW50byB0aGUgdmlkZW8KICAgKiBgYGAKICAgKgogICAqIEBwYXJhbSAge051bWJlcnxTdHJpbmc9fSBzZWNvbmRzIFRoZSB0aW1lIHRvIHNlZWsgdG8KICAgKiBAcmV0dXJuIHtOdW1iZXJ9ICAgICAgICBUaGUgdGltZSBpbiBzZWNvbmRzLCB3aGVuIG5vdCBzZXR0aW5nCiAgICogQHJldHVybiB7UGxheWVyfSAgICBzZWxmLCB3aGVuIHRoZSBjdXJyZW50IHRpbWUgaXMgc2V0CiAgICogQG1ldGhvZCBjdXJyZW50VGltZQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmN1cnJlbnRUaW1lID0gZnVuY3Rpb24gY3VycmVudFRpbWUoc2Vjb25kcykgewogICAgaWYgKHNlY29uZHMgIT09IHVuZGVmaW5lZCkgewoKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldEN1cnJlbnRUaW1lJywgc2Vjb25kcyk7CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICAvLyBjYWNoZSBsYXN0IGN1cnJlbnRUaW1lIGFuZCByZXR1cm4uIGRlZmF1bHQgdG8gMCBzZWNvbmRzCiAgICAvLwogICAgLy8gQ2FjaGluZyB0aGUgY3VycmVudFRpbWUgaXMgbWVhbnQgdG8gcHJldmVudCBhIG1hc3NpdmUgYW1vdW50IG9mIHJlYWRzIG9uIHRoZSB0ZWNoJ3MKICAgIC8vIGN1cnJlbnRUaW1lIHdoZW4gc2NydWJiaW5nLCBidXQgbWF5IG5vdCBwcm92aWRlIG11Y2ggcGVyZm9ybWFuY2UgYmVuZWZpdCBhZnRlcmFsbC4KICAgIC8vIFNob3VsZCBiZSB0ZXN0ZWQuIEFsc28gc29tZXRoaW5nIGhhcyB0byByZWFkIHRoZSBhY3R1YWwgY3VycmVudCB0aW1lIG9yIHRoZSBjYWNoZSB3aWxsCiAgICAvLyBuZXZlciBnZXQgdXBkYXRlZC4KICAgIHJldHVybiB0aGlzLmNhY2hlXy5jdXJyZW50VGltZSA9IHRoaXMudGVjaEdldF8oJ2N1cnJlbnRUaW1lJykgfHwgMDsKICB9OwoKICAvKioKICAgKiBHZXQgdGhlIGxlbmd0aCBpbiB0aW1lIG9mIHRoZSB2aWRlbyBpbiBzZWNvbmRzCiAgICogYGBganMKICAgKiAgICAgdmFyIGxlbmd0aE9mVmlkZW8gPSBteVBsYXllci5kdXJhdGlvbigpOwogICAqIGBgYAogICAqICoqTk9URSoqOiBUaGUgdmlkZW8gbXVzdCBoYXZlIHN0YXJ0ZWQgbG9hZGluZyBiZWZvcmUgdGhlIGR1cmF0aW9uIGNhbiBiZQogICAqIGtub3duLCBhbmQgaW4gdGhlIGNhc2Ugb2YgRmxhc2gsIG1heSBub3QgYmUga25vd24gdW50aWwgdGhlIHZpZGVvIHN0YXJ0cwogICAqIHBsYXlpbmcuCiAgICoKICAgKiBAcGFyYW0ge051bWJlcn0gc2Vjb25kcyBEdXJhdGlvbiB3aGVuIHNldHRpbmcKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBkdXJhdGlvbiBvZiB0aGUgdmlkZW8gaW4gc2Vjb25kcyB3aGVuIGdldHRpbmcKICAgKiBAbWV0aG9kIGR1cmF0aW9uCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuZHVyYXRpb24gPSBmdW5jdGlvbiBkdXJhdGlvbihzZWNvbmRzKSB7CiAgICBpZiAoc2Vjb25kcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzLmNhY2hlXy5kdXJhdGlvbiB8fCAwOwogICAgfQoKICAgIHNlY29uZHMgPSBwYXJzZUZsb2F0KHNlY29uZHMpIHx8IDA7CgogICAgLy8gU3RhbmRhcmRpemUgb24gSW5pZml0eSBmb3Igc2lnbmFsaW5nIHZpZGVvIGlzIGxpdmUKICAgIGlmIChzZWNvbmRzIDwgMCkgewogICAgICBzZWNvbmRzID0gSW5maW5pdHk7CiAgICB9CgogICAgaWYgKHNlY29uZHMgIT09IHRoaXMuY2FjaGVfLmR1cmF0aW9uKSB7CiAgICAgIC8vIENhY2hlIHRoZSBsYXN0IHNldCB2YWx1ZSBmb3Igb3B0aW1pemVkIHNjcnViYmluZyAoZXNwLiBGbGFzaCkKICAgICAgdGhpcy5jYWNoZV8uZHVyYXRpb24gPSBzZWNvbmRzOwoKICAgICAgaWYgKHNlY29uZHMgPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWxpdmUnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtbGl2ZScpOwogICAgICB9CgogICAgICB0aGlzLnRyaWdnZXIoJ2R1cmF0aW9uY2hhbmdlJyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogQ2FsY3VsYXRlcyBob3cgbXVjaCB0aW1lIGlzIGxlZnQuCiAgICogYGBganMKICAgKiAgICAgdmFyIHRpbWVMZWZ0ID0gbXlQbGF5ZXIucmVtYWluaW5nVGltZSgpOwogICAqIGBgYAogICAqIE5vdCBhIG5hdGl2ZSB2aWRlbyBlbGVtZW50IGZ1bmN0aW9uLCBidXQgdXNlZnVsCiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSB0aW1lIHJlbWFpbmluZyBpbiBzZWNvbmRzCiAgICogQG1ldGhvZCByZW1haW5pbmdUaW1lCiAgICovCgogIFBsYXllci5wcm90b3R5cGUucmVtYWluaW5nVGltZSA9IGZ1bmN0aW9uIHJlbWFpbmluZ1RpbWUoKSB7CiAgICByZXR1cm4gdGhpcy5kdXJhdGlvbigpIC0gdGhpcy5jdXJyZW50VGltZSgpOwogIH07CgogIC8vIGh0dHA6Ly9kZXYudzMub3JnL2h0bWw1L3NwZWMvdmlkZW8uaHRtbCNkb20tbWVkaWEtYnVmZmVyZWQKICAvLyBCdWZmZXJlZCByZXR1cm5zIGEgdGltZXJhbmdlIG9iamVjdC4KICAvLyBLaW5kIG9mIGxpa2UgYW4gYXJyYXkgb2YgcG9ydGlvbnMgb2YgdGhlIHZpZGVvIHRoYXQgaGF2ZSBiZWVuIGRvd25sb2FkZWQuCgogIC8qKgogICAqIEdldCBhIFRpbWVSYW5nZSBvYmplY3Qgd2l0aCB0aGUgdGltZXMgb2YgdGhlIHZpZGVvIHRoYXQgaGF2ZSBiZWVuIGRvd25sb2FkZWQKICAgKiBJZiB5b3UganVzdCB3YW50IHRoZSBwZXJjZW50IG9mIHRoZSB2aWRlbyB0aGF0J3MgYmVlbiBkb3dubG9hZGVkLAogICAqIHVzZSBidWZmZXJlZFBlcmNlbnQuCiAgICogYGBganMKICAgKiAgICAgLy8gTnVtYmVyIG9mIGRpZmZlcmVudCByYW5nZXMgb2YgdGltZSBoYXZlIGJlZW4gYnVmZmVyZWQuIFVzdWFsbHkgMS4KICAgKiAgICAgbnVtYmVyT2ZSYW5nZXMgPSBidWZmZXJlZFRpbWVSYW5nZS5sZW5ndGgsCiAgICogICAgIC8vIFRpbWUgaW4gc2Vjb25kcyB3aGVuIHRoZSBmaXJzdCByYW5nZSBzdGFydHMuIFVzdWFsbHkgMC4KICAgKiAgICAgZmlyc3RSYW5nZVN0YXJ0ID0gYnVmZmVyZWRUaW1lUmFuZ2Uuc3RhcnQoMCksCiAgICogICAgIC8vIFRpbWUgaW4gc2Vjb25kcyB3aGVuIHRoZSBmaXJzdCByYW5nZSBlbmRzCiAgICogICAgIGZpcnN0UmFuZ2VFbmQgPSBidWZmZXJlZFRpbWVSYW5nZS5lbmQoMCksCiAgICogICAgIC8vIExlbmd0aCBpbiBzZWNvbmRzIG9mIHRoZSBmaXJzdCB0aW1lIHJhbmdlCiAgICogICAgIGZpcnN0UmFuZ2VMZW5ndGggPSBmaXJzdFJhbmdlRW5kIC0gZmlyc3RSYW5nZVN0YXJ0OwogICAqIGBgYAogICAqCiAgICogQHJldHVybiB7T2JqZWN0fSBBIG1vY2sgVGltZVJhbmdlIG9iamVjdCAoZm9sbG93aW5nIEhUTUwgc3BlYykKICAgKiBAbWV0aG9kIGJ1ZmZlcmVkCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuYnVmZmVyZWQgPSBmdW5jdGlvbiBidWZmZXJlZCgpIHsKICAgIHZhciBidWZmZXJlZCA9IHRoaXMudGVjaEdldF8oJ2J1ZmZlcmVkJyk7CgogICAgaWYgKCFidWZmZXJlZCB8fCAhYnVmZmVyZWQubGVuZ3RoKSB7CiAgICAgIGJ1ZmZlcmVkID0gX3V0aWxzVGltZVJhbmdlc0pzLmNyZWF0ZVRpbWVSYW5nZSgwLCAwKTsKICAgIH0KCiAgICByZXR1cm4gYnVmZmVyZWQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IHRoZSBwZXJjZW50IChhcyBhIGRlY2ltYWwpIG9mIHRoZSB2aWRlbyB0aGF0J3MgYmVlbiBkb3dubG9hZGVkCiAgICogYGBganMKICAgKiAgICAgdmFyIGhvd011Y2hJc0Rvd25sb2FkZWQgPSBteVBsYXllci5idWZmZXJlZFBlcmNlbnQoKTsKICAgKiBgYGAKICAgKiAwIG1lYW5zIG5vbmUsIDEgbWVhbnMgYWxsLgogICAqIChUaGlzIG1ldGhvZCBpc24ndCBpbiB0aGUgSFRNTDUgc3BlYywgYnV0IGl0J3MgdmVyeSBjb252ZW5pZW50KQogICAqCiAgICogQHJldHVybiB7TnVtYmVyfSBBIGRlY2ltYWwgYmV0d2VlbiAwIGFuZCAxIHJlcHJlc2VudGluZyB0aGUgcGVyY2VudAogICAqIEBtZXRob2QgYnVmZmVyZWRQZXJjZW50CiAgICovCgogIFBsYXllci5wcm90b3R5cGUuYnVmZmVyZWRQZXJjZW50ID0gZnVuY3Rpb24gYnVmZmVyZWRQZXJjZW50KCkgewogICAgcmV0dXJuIF91dGlsc0J1ZmZlckpzLmJ1ZmZlcmVkUGVyY2VudCh0aGlzLmJ1ZmZlcmVkKCksIHRoaXMuZHVyYXRpb24oKSk7CiAgfTsKCiAgLyoqCiAgICogR2V0IHRoZSBlbmRpbmcgdGltZSBvZiB0aGUgbGFzdCBidWZmZXJlZCB0aW1lIHJhbmdlCiAgICogVGhpcyBpcyB1c2VkIGluIHRoZSBwcm9ncmVzcyBiYXIgdG8gZW5jYXBzdWxhdGUgYWxsIHRpbWUgcmFuZ2VzLgogICAqCiAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgZW5kIG9mIHRoZSBsYXN0IGJ1ZmZlcmVkIHRpbWUgcmFuZ2UKICAgKiBAbWV0aG9kIGJ1ZmZlcmVkRW5kCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuYnVmZmVyZWRFbmQgPSBmdW5jdGlvbiBidWZmZXJlZEVuZCgpIHsKICAgIHZhciBidWZmZXJlZCA9IHRoaXMuYnVmZmVyZWQoKSwKICAgICAgICBkdXJhdGlvbiA9IHRoaXMuZHVyYXRpb24oKSwKICAgICAgICBlbmQgPSBidWZmZXJlZC5lbmQoYnVmZmVyZWQubGVuZ3RoIC0gMSk7CgogICAgaWYgKGVuZCA+IGR1cmF0aW9uKSB7CiAgICAgIGVuZCA9IGR1cmF0aW9uOwogICAgfQoKICAgIHJldHVybiBlbmQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgY3VycmVudCB2b2x1bWUgb2YgdGhlIG1lZGlhCiAgICogYGBganMKICAgKiAgICAgLy8gZ2V0CiAgICogICAgIHZhciBob3dMb3VkSXNJdCA9IG15UGxheWVyLnZvbHVtZSgpOwogICAqICAgICAvLyBzZXQKICAgKiAgICAgbXlQbGF5ZXIudm9sdW1lKDAuNSk7IC8vIFNldCB2b2x1bWUgdG8gaGFsZgogICAqIGBgYAogICAqIDAgaXMgb2ZmIChtdXRlZCksIDEuMCBpcyBhbGwgdGhlIHdheSB1cCwgMC41IGlzIGhhbGYgd2F5LgogICAqCiAgICogQHBhcmFtICB7TnVtYmVyfSBwZXJjZW50QXNEZWNpbWFsIFRoZSBuZXcgdm9sdW1lIGFzIGEgZGVjaW1hbCBwZXJjZW50CiAgICogQHJldHVybiB7TnVtYmVyfSAgICAgICAgICAgICAgVGhlIGN1cnJlbnQgdm9sdW1lIHdoZW4gZ2V0dGluZwogICAqIEByZXR1cm4ge1BsYXllcn0gICAgICAgICAgICAgIHNlbGYgd2hlbiBzZXR0aW5nCiAgICogQG1ldGhvZCB2b2x1bWUKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS52b2x1bWUgPSBmdW5jdGlvbiB2b2x1bWUocGVyY2VudEFzRGVjaW1hbCkgewogICAgdmFyIHZvbCA9IHVuZGVmaW5lZDsKCiAgICBpZiAocGVyY2VudEFzRGVjaW1hbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZvbCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHBhcnNlRmxvYXQocGVyY2VudEFzRGVjaW1hbCkpKTsgLy8gRm9yY2UgdmFsdWUgdG8gYmV0d2VlbiAwIGFuZCAxCiAgICAgIHRoaXMuY2FjaGVfLnZvbHVtZSA9IHZvbDsKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldFZvbHVtZScsIHZvbCk7CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICAvLyBEZWZhdWx0IHRvIDEgd2hlbiByZXR1cm5pbmcgY3VycmVudCB2b2x1bWUuCiAgICB2b2wgPSBwYXJzZUZsb2F0KHRoaXMudGVjaEdldF8oJ3ZvbHVtZScpKTsKICAgIHJldHVybiBpc05hTih2b2wpID8gMSA6IHZvbDsKICB9OwoKICAvKioKICAgKiBHZXQgdGhlIGN1cnJlbnQgbXV0ZWQgc3RhdGUsIG9yIHR1cm4gbXV0ZSBvbiBvciBvZmYKICAgKiBgYGBqcwogICAqICAgICAvLyBnZXQKICAgKiAgICAgdmFyIGlzVm9sdW1lTXV0ZWQgPSBteVBsYXllci5tdXRlZCgpOwogICAqICAgICAvLyBzZXQKICAgKiAgICAgbXlQbGF5ZXIubXV0ZWQodHJ1ZSk7IC8vIG11dGUgdGhlIHZvbHVtZQogICAqIGBgYAogICAqCiAgICogQHBhcmFtICB7Qm9vbGVhbj19IG11dGVkIFRydWUgdG8gbXV0ZSwgZmFsc2UgdG8gdW5tdXRlCiAgICogQHJldHVybiB7Qm9vbGVhbn0gVHJ1ZSBpZiBtdXRlIGlzIG9uLCBmYWxzZSBpZiBub3Qgd2hlbiBnZXR0aW5nCiAgICogQHJldHVybiB7UGxheWVyfSBzZWxmIHdoZW4gc2V0dGluZyBtdXRlCiAgICogQG1ldGhvZCBtdXRlZAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLm11dGVkID0gZnVuY3Rpb24gbXV0ZWQoX211dGVkKSB7CiAgICBpZiAoX211dGVkICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldE11dGVkJywgX211dGVkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICByZXR1cm4gdGhpcy50ZWNoR2V0XygnbXV0ZWQnKSB8fCBmYWxzZTsgLy8gRGVmYXVsdCB0byBmYWxzZQogIH07CgogIC8vIENoZWNrIGlmIGN1cnJlbnQgdGVjaCBjYW4gc3VwcG9ydCBuYXRpdmUgZnVsbHNjcmVlbgogIC8vIChlLmcuIHdpdGggYnVpbHQgaW4gY29udHJvbHMgbGlrZSBpT1MsIHNvIG5vdCBvdXIgZmxhc2ggc3dmKQogIC8qKgogICAqIENoZWNrIHRvIHNlZSBpZiBmdWxsc2NyZWVuIGlzIHN1cHBvcnRlZAogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKiBAbWV0aG9kIHN1cHBvcnRzRnVsbFNjcmVlbgogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnN1cHBvcnRzRnVsbFNjcmVlbiA9IGZ1bmN0aW9uIHN1cHBvcnRzRnVsbFNjcmVlbigpIHsKICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdzdXBwb3J0c0Z1bGxTY3JlZW4nKSB8fCBmYWxzZTsKICB9OwoKICAvKioKICAgKiBDaGVjayBpZiB0aGUgcGxheWVyIGlzIGluIGZ1bGxzY3JlZW4gbW9kZQogICAqIGBgYGpzCiAgICogICAgIC8vIGdldAogICAqICAgICB2YXIgZnVsbHNjcmVlbk9yTm90ID0gbXlQbGF5ZXIuaXNGdWxsc2NyZWVuKCk7CiAgICogICAgIC8vIHNldAogICAqICAgICBteVBsYXllci5pc0Z1bGxzY3JlZW4odHJ1ZSk7IC8vIHRlbGwgdGhlIHBsYXllciBpdCdzIGluIGZ1bGxzY3JlZW4KICAgKiBgYGAKICAgKiBOT1RFOiBBcyBvZiB0aGUgbGF0ZXN0IEhUTUw1IHNwZWMsIGlzRnVsbHNjcmVlbiBpcyBubyBsb25nZXIgYW4gb2ZmaWNpYWwKICAgKiBwcm9wZXJ0eSBhbmQgaW5zdGVhZCBkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCBpcyB1c2VkLiBCdXQgaXNGdWxsc2NyZWVuIGlzCiAgICogc3RpbGwgYSB2YWx1YWJsZSBwcm9wZXJ0eSBmb3IgaW50ZXJuYWwgcGxheWVyIHdvcmtpbmdzLgogICAqCiAgICogQHBhcmFtICB7Qm9vbGVhbj19IGlzRlMgVXBkYXRlIHRoZSBwbGF5ZXIncyBmdWxsc2NyZWVuIHN0YXRlCiAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBmdWxsc2NyZWVuIGZhbHNlIGlmIG5vdCB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9IHNlbGYgd2hlbiBzZXR0aW5nCiAgICogQG1ldGhvZCBpc0Z1bGxzY3JlZW4KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5pc0Z1bGxzY3JlZW4gPSBmdW5jdGlvbiBpc0Z1bGxzY3JlZW4oaXNGUykgewogICAgaWYgKGlzRlMgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmlzRnVsbHNjcmVlbl8gPSAhIWlzRlM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgcmV0dXJuICEhdGhpcy5pc0Z1bGxzY3JlZW5fOwogIH07CgogIC8qKgogICAqIEluY3JlYXNlIHRoZSBzaXplIG9mIHRoZSB2aWRlbyB0byBmdWxsIHNjcmVlbgogICAqIGBgYGpzCiAgICogICAgIG15UGxheWVyLnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICogYGBgCiAgICogSW4gc29tZSBicm93c2VycywgZnVsbCBzY3JlZW4gaXMgbm90IHN1cHBvcnRlZCBuYXRpdmVseSwgc28gaXQgZW50ZXJzCiAgICogImZ1bGwgd2luZG93IG1vZGUiLCB3aGVyZSB0aGUgdmlkZW8gZmlsbHMgdGhlIGJyb3dzZXIgd2luZG93LgogICAqIEluIGJyb3dzZXJzIGFuZCBkZXZpY2VzIHRoYXQgc3VwcG9ydCBuYXRpdmUgZnVsbCBzY3JlZW4sIHNvbWV0aW1lcyB0aGUKICAgKiBicm93c2VyJ3MgZGVmYXVsdCBjb250cm9scyB3aWxsIGJlIHNob3duLCBhbmQgbm90IHRoZSBWaWRlby5qcyBjdXN0b20gc2tpbi4KICAgKiBUaGlzIGluY2x1ZGVzIG1vc3QgbW9iaWxlIGRldmljZXMgKGlPUywgQW5kcm9pZCkgYW5kIG9sZGVyIHZlcnNpb25zIG9mCiAgICogU2FmYXJpLgogICAqCiAgICogQHJldHVybiB7UGxheWVyfSBzZWxmCiAgICogQG1ldGhvZCByZXF1ZXN0RnVsbHNjcmVlbgogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnJlcXVlc3RGdWxsc2NyZWVuID0gZnVuY3Rpb24gcmVxdWVzdEZ1bGxzY3JlZW4oKSB7CiAgICB2YXIgZnNBcGkgPSBfZnVsbHNjcmVlbkFwaUpzMlsnZGVmYXVsdCddOwoKICAgIHRoaXMuaXNGdWxsc2NyZWVuKHRydWUpOwoKICAgIGlmIChmc0FwaS5yZXF1ZXN0RnVsbHNjcmVlbikgewogICAgICAvLyB0aGUgYnJvd3NlciBzdXBwb3J0cyBnb2luZyBmdWxsc2NyZWVuIGF0IHRoZSBlbGVtZW50IGxldmVsIHNvIHdlIGNhbgogICAgICAvLyB0YWtlIHRoZSBjb250cm9scyBmdWxsc2NyZWVuIGFzIHdlbGwgYXMgdGhlIHZpZGVvCgogICAgICAvLyBUcmlnZ2VyIGZ1bGxzY3JlZW5jaGFuZ2UgZXZlbnQgYWZ0ZXIgY2hhbmdlCiAgICAgIC8vIFdlIGhhdmUgdG8gc3BlY2lmaWNhbGx5IGFkZCB0aGlzIGVhY2ggdGltZSwgYW5kIHJlbW92ZQogICAgICAvLyB3aGVuIGNhbmNlbGluZyBmdWxsc2NyZWVuLiBPdGhlcndpc2UgaWYgdGhlcmUncyBtdWx0aXBsZQogICAgICAvLyBwbGF5ZXJzIG9uIGEgcGFnZSwgdGhleSB3b3VsZCBhbGwgYmUgcmVhY3RpbmcgdG8gdGhlIHNhbWUgZnVsbHNjcmVlbgogICAgICAvLyBldmVudHMKICAgICAgRXZlbnRzLm9uKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXSwgZnNBcGkuZnVsbHNjcmVlbmNoYW5nZSwgRm4uYmluZCh0aGlzLCBmdW5jdGlvbiBkb2N1bWVudEZ1bGxzY3JlZW5DaGFuZ2UoZSkgewogICAgICAgIHRoaXMuaXNGdWxsc2NyZWVuKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXVtmc0FwaS5mdWxsc2NyZWVuRWxlbWVudF0pOwoKICAgICAgICAvLyBJZiBjYW5jZWxsaW5nIGZ1bGxzY3JlZW4sIHJlbW92ZSBldmVudCBsaXN0ZW5lci4KICAgICAgICBpZiAodGhpcy5pc0Z1bGxzY3JlZW4oKSA9PT0gZmFsc2UpIHsKICAgICAgICAgIEV2ZW50cy5vZmYoX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCBmc0FwaS5mdWxsc2NyZWVuY2hhbmdlLCBkb2N1bWVudEZ1bGxzY3JlZW5DaGFuZ2UpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50cmlnZ2VyKCdmdWxsc2NyZWVuY2hhbmdlJyk7CiAgICAgIH0pKTsKCiAgICAgIHRoaXMuZWxfW2ZzQXBpLnJlcXVlc3RGdWxsc2NyZWVuXSgpOwogICAgfSBlbHNlIGlmICh0aGlzLnRlY2hfLnN1cHBvcnRzRnVsbFNjcmVlbigpKSB7CiAgICAgIC8vIHdlIGNhbid0IHRha2UgdGhlIHZpZGVvLmpzIGNvbnRyb2xzIGZ1bGxzY3JlZW4gYnV0IHdlIGNhbiBnbyBmdWxsc2NyZWVuCiAgICAgIC8vIHdpdGggbmF0aXZlIGNvbnRyb2xzCiAgICAgIHRoaXMudGVjaENhbGxfKCdlbnRlckZ1bGxTY3JlZW4nKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGZ1bGxzY3JlZW4gaXNuJ3Qgc3VwcG9ydGVkIHNvIHdlJ2xsIGp1c3Qgc3RyZXRjaCB0aGUgdmlkZW8gZWxlbWVudCB0bwogICAgICAvLyBmaWxsIHRoZSB2aWV3cG9ydAogICAgICB0aGlzLmVudGVyRnVsbFdpbmRvdygpOwogICAgICB0aGlzLnRyaWdnZXIoJ2Z1bGxzY3JlZW5jaGFuZ2UnKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBSZXR1cm4gdGhlIHZpZGVvIHRvIGl0cyBub3JtYWwgc2l6ZSBhZnRlciBoYXZpbmcgYmVlbiBpbiBmdWxsIHNjcmVlbiBtb2RlCiAgICogYGBganMKICAgKiAgICAgbXlQbGF5ZXIuZXhpdEZ1bGxzY3JlZW4oKTsKICAgKiBgYGAKICAgKgogICAqIEByZXR1cm4ge1BsYXllcn0gc2VsZgogICAqIEBtZXRob2QgZXhpdEZ1bGxzY3JlZW4KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5leGl0RnVsbHNjcmVlbiA9IGZ1bmN0aW9uIGV4aXRGdWxsc2NyZWVuKCkgewogICAgdmFyIGZzQXBpID0gX2Z1bGxzY3JlZW5BcGlKczJbJ2RlZmF1bHQnXTsKICAgIHRoaXMuaXNGdWxsc2NyZWVuKGZhbHNlKTsKCiAgICAvLyBDaGVjayBmb3IgYnJvd3NlciBlbGVtZW50IGZ1bGxzY3JlZW4gc3VwcG9ydAogICAgaWYgKGZzQXBpLnJlcXVlc3RGdWxsc2NyZWVuKSB7CiAgICAgIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXVtmc0FwaS5leGl0RnVsbHNjcmVlbl0oKTsKICAgIH0gZWxzZSBpZiAodGhpcy50ZWNoXy5zdXBwb3J0c0Z1bGxTY3JlZW4oKSkgewogICAgICB0aGlzLnRlY2hDYWxsXygnZXhpdEZ1bGxTY3JlZW4nKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZXhpdEZ1bGxXaW5kb3coKTsKICAgICAgdGhpcy50cmlnZ2VyKCdmdWxsc2NyZWVuY2hhbmdlJyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogV2hlbiBmdWxsc2NyZWVuIGlzbid0IHN1cHBvcnRlZCB3ZSBjYW4gc3RyZXRjaCB0aGUgdmlkZW8gY29udGFpbmVyIHRvIGFzIHdpZGUgYXMgdGhlIGJyb3dzZXIgd2lsbCBsZXQgdXMuCiAgICoKICAgKiBAbWV0aG9kIGVudGVyRnVsbFdpbmRvdwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmVudGVyRnVsbFdpbmRvdyA9IGZ1bmN0aW9uIGVudGVyRnVsbFdpbmRvdygpIHsKICAgIHRoaXMuaXNGdWxsV2luZG93ID0gdHJ1ZTsKCiAgICAvLyBTdG9yaW5nIG9yaWdpbmFsIGRvYyBvdmVyZmxvdyB2YWx1ZSB0byByZXR1cm4gdG8gd2hlbiBmdWxsc2NyZWVuIGlzIG9mZgogICAgdGhpcy5kb2NPcmlnT3ZlcmZsb3cgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93OwoKICAgIC8vIEFkZCBsaXN0ZW5lciBmb3IgZXNjIGtleSB0byBleGl0IGZ1bGxzY3JlZW4KICAgIEV2ZW50cy5vbihfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10sICdrZXlkb3duJywgRm4uYmluZCh0aGlzLCB0aGlzLmZ1bGxXaW5kb3dPbkVzY0tleSkpOwoKICAgIC8vIEhpZGUgYW55IHNjcm9sbCBiYXJzCiAgICBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7CgogICAgLy8gQXBwbHkgZnVsbHNjcmVlbiBzdHlsZXMKICAgIERvbS5hZGRFbENsYXNzKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5ib2R5LCAndmpzLWZ1bGwtd2luZG93Jyk7CgogICAgdGhpcy50cmlnZ2VyKCdlbnRlckZ1bGxXaW5kb3cnKTsKICB9OwoKICAvKioKICAgKiBDaGVjayBmb3IgY2FsbCB0byBlaXRoZXIgZXhpdCBmdWxsIHdpbmRvdyBvciBmdWxsIHNjcmVlbiBvbiBFU0Mga2V5CiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgRXZlbnQgdG8gY2hlY2sgZm9yIGtleSBwcmVzcwogICAqIEBtZXRob2QgZnVsbFdpbmRvd09uRXNjS2V5CiAgICovCgogIFBsYXllci5wcm90b3R5cGUuZnVsbFdpbmRvd09uRXNjS2V5ID0gZnVuY3Rpb24gZnVsbFdpbmRvd09uRXNjS2V5KGV2ZW50KSB7CiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgaWYgKHRoaXMuaXNGdWxsc2NyZWVuKCkgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmV4aXRGdWxsc2NyZWVuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5leGl0RnVsbFdpbmRvdygpOwogICAgICB9CiAgICB9CiAgfTsKCiAgLyoqCiAgICogRXhpdCBmdWxsIHdpbmRvdwogICAqCiAgICogQG1ldGhvZCBleGl0RnVsbFdpbmRvdwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmV4aXRGdWxsV2luZG93ID0gZnVuY3Rpb24gZXhpdEZ1bGxXaW5kb3coKSB7CiAgICB0aGlzLmlzRnVsbFdpbmRvdyA9IGZhbHNlOwogICAgRXZlbnRzLm9mZihfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10sICdrZXlkb3duJywgdGhpcy5mdWxsV2luZG93T25Fc2NLZXkpOwoKICAgIC8vIFVuaGlkZSBzY3JvbGwgYmFycy4KICAgIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSB0aGlzLmRvY09yaWdPdmVyZmxvdzsKCiAgICAvLyBSZW1vdmUgZnVsbHNjcmVlbiBzdHlsZXMKICAgIERvbS5yZW1vdmVFbENsYXNzKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5ib2R5LCAndmpzLWZ1bGwtd2luZG93Jyk7CgogICAgLy8gUmVzaXplIHRoZSBib3gsIGNvbnRyb2xsZXIsIGFuZCBwb3N0ZXIgdG8gb3JpZ2luYWwgc2l6ZXMKICAgIC8vIHRoaXMucG9zaXRpb25BbGwoKTsKICAgIHRoaXMudHJpZ2dlcignZXhpdEZ1bGxXaW5kb3cnKTsKICB9OwoKICAvKioKICAgKiBDaGVjayB3aGV0aGVyIHRoZSBwbGF5ZXIgY2FuIHBsYXkgYSBnaXZlbiBtaW1ldHlwZQogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIG1pbWV0eXBlIHRvIGNoZWNrCiAgICogQHJldHVybiB7U3RyaW5nfSAncHJvYmFibHknLCAnbWF5YmUnLCBvciAnJyAoZW1wdHkgc3RyaW5nKQogICAqIEBtZXRob2QgY2FuUGxheVR5cGUKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5jYW5QbGF5VHlwZSA9IGZ1bmN0aW9uIGNhblBsYXlUeXBlKHR5cGUpIHsKICAgIHZhciBjYW4gPSB1bmRlZmluZWQ7CgogICAgLy8gTG9vcCB0aHJvdWdoIGVhY2ggcGxheWJhY2sgdGVjaG5vbG9neSBpbiB0aGUgb3B0aW9ucyBvcmRlcgogICAgZm9yICh2YXIgaSA9IDAsIGogPSB0aGlzLm9wdGlvbnNfLnRlY2hPcmRlcjsgaSA8IGoubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHRlY2hOYW1lID0gX3V0aWxzVG9UaXRsZUNhc2VKczJbJ2RlZmF1bHQnXShqW2ldKTsKICAgICAgdmFyIHRlY2ggPSBfdGVjaFRlY2hKczJbJ2RlZmF1bHQnXS5nZXRUZWNoKHRlY2hOYW1lKTsKCiAgICAgIC8vIFN1cHBvcnQgb2xkIGJlaGF2aW9yIG9mIHRlY2hzIGJlaW5nIHJlZ2lzdGVyZWQgYXMgY29tcG9uZW50cy4KICAgICAgLy8gUmVtb3ZlIG9uY2UgdGhhdCBkZXByZWNhdGVkIGJlaGF2aW9yIGlzIHJlbW92ZWQuCiAgICAgIGlmICghdGVjaCkgewogICAgICAgIHRlY2ggPSBfY29tcG9uZW50SnMyWydkZWZhdWx0J10uZ2V0Q29tcG9uZW50KHRlY2hOYW1lKTsKICAgICAgfQoKICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdGVjaCBpcyBkZWZpbmVkIGJlZm9yZSBjb250aW51aW5nCiAgICAgIGlmICghdGVjaCkgewogICAgICAgIF91dGlsc0xvZ0pzMlsnZGVmYXVsdCddLmVycm9yKCdUaGUgIicgKyB0ZWNoTmFtZSArICciIHRlY2ggaXMgdW5kZWZpbmVkLiBTa2lwcGVkIGJyb3dzZXIgc3VwcG9ydCBjaGVjayBmb3IgdGhhdCB0ZWNoLicpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICAvLyBDaGVjayBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0aGlzIHRlY2hub2xvZ3kKICAgICAgaWYgKHRlY2guaXNTdXBwb3J0ZWQoKSkgewogICAgICAgIGNhbiA9IHRlY2guY2FuUGxheVR5cGUodHlwZSk7CgogICAgICAgIGlmIChjYW4pIHsKICAgICAgICAgIHJldHVybiBjYW47CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuICcnOwogIH07CgogIC8qKgogICAqIFNlbGVjdCBzb3VyY2UgYmFzZWQgb24gdGVjaC1vcmRlciBvciBzb3VyY2Utb3JkZXIKICAgKiBVc2VzIHNvdXJjZS1vcmRlciBzZWxlY3Rpb24gaWYgYG9wdGlvbnMuc291cmNlT3JkZXJgIGlzIHRydXRoeS4gT3RoZXJ3aXNlLAogICAqIGRlZmF1bHRzIHRvIHRlY2gtb3JkZXIgc2VsZWN0aW9uCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBzb3VyY2VzIFRoZSBzb3VyY2VzIGZvciBhIG1lZGlhIGFzc2V0CiAgICogQHJldHVybiB7T2JqZWN0fEJvb2xlYW59IE9iamVjdCBvZiBzb3VyY2UgYW5kIHRlY2ggb3JkZXIsIG90aGVyd2lzZSBmYWxzZQogICAqIEBtZXRob2Qgc2VsZWN0U291cmNlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuc2VsZWN0U291cmNlID0gZnVuY3Rpb24gc2VsZWN0U291cmNlKHNvdXJjZXMpIHsKICAgIC8vIEdldCBvbmx5IHRoZSB0ZWNocyBzcGVjaWZpZWQgaW4gYHRlY2hPcmRlcmAgdGhhdCBleGlzdCBhbmQgYXJlIHN1cHBvcnRlZCBieSB0aGUKICAgIC8vIGN1cnJlbnQgcGxhdGZvcm0KICAgIHZhciB0ZWNocyA9IHRoaXMub3B0aW9uc18udGVjaE9yZGVyLm1hcChfdXRpbHNUb1RpdGxlQ2FzZUpzMlsnZGVmYXVsdCddKS5tYXAoZnVuY3Rpb24gKHRlY2hOYW1lKSB7CiAgICAgIC8vIGBDb21wb25lbnQuZ2V0Q29tcG9uZW50KC4uLilgIGlzIGZvciBzdXBwb3J0IG9mIG9sZCBiZWhhdmlvciBvZiB0ZWNocwogICAgICAvLyBiZWluZyByZWdpc3RlcmVkIGFzIGNvbXBvbmVudHMuCiAgICAgIC8vIFJlbW92ZSBvbmNlIHRoYXQgZGVwcmVjYXRlZCBiZWhhdmlvciBpcyByZW1vdmVkLgogICAgICByZXR1cm4gW3RlY2hOYW1lLCBfdGVjaFRlY2hKczJbJ2RlZmF1bHQnXS5nZXRUZWNoKHRlY2hOYW1lKSB8fCBfY29tcG9uZW50SnMyWydkZWZhdWx0J10uZ2V0Q29tcG9uZW50KHRlY2hOYW1lKV07CiAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgdmFyIHRlY2hOYW1lID0gX3JlZlswXTsKICAgICAgdmFyIHRlY2ggPSBfcmVmWzFdOwoKICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdGVjaCBpcyBkZWZpbmVkIGJlZm9yZSBjb250aW51aW5nCiAgICAgIGlmICh0ZWNoKSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgdGhpcyB0ZWNobm9sb2d5CiAgICAgICAgcmV0dXJuIHRlY2guaXNTdXBwb3J0ZWQoKTsKICAgICAgfQoKICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10uZXJyb3IoJ1RoZSAiJyArIHRlY2hOYW1lICsgJyIgdGVjaCBpcyB1bmRlZmluZWQuIFNraXBwZWQgYnJvd3NlciBzdXBwb3J0IGNoZWNrIGZvciB0aGF0IHRlY2guJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwoKICAgIC8vIEl0ZXJhdGUgb3ZlciBlYWNoIGBpbm5lckFycmF5YCBlbGVtZW50IG9uY2UgcGVyIGBvdXRlckFycmF5YCBlbGVtZW50IGFuZCBleGVjdXRlCiAgICAvLyBgdGVzdGVyYCB3aXRoIGJvdGguIElmIGB0ZXN0ZXJgIHJldHVybnMgYSBub24tZmFsc3kgdmFsdWUsIGV4aXQgZWFybHkgYW5kIHJldHVybgogICAgLy8gdGhhdCB2YWx1ZS4KICAgIHZhciBmaW5kRmlyc3RQYXNzaW5nVGVjaFNvdXJjZVBhaXIgPSBmdW5jdGlvbiBmaW5kRmlyc3RQYXNzaW5nVGVjaFNvdXJjZVBhaXIob3V0ZXJBcnJheSwgaW5uZXJBcnJheSwgdGVzdGVyKSB7CiAgICAgIHZhciBmb3VuZCA9IHVuZGVmaW5lZDsKCiAgICAgIG91dGVyQXJyYXkuc29tZShmdW5jdGlvbiAob3V0ZXJDaG9pY2UpIHsKICAgICAgICByZXR1cm4gaW5uZXJBcnJheS5zb21lKGZ1bmN0aW9uIChpbm5lckNob2ljZSkgewogICAgICAgICAgZm91bmQgPSB0ZXN0ZXIob3V0ZXJDaG9pY2UsIGlubmVyQ2hvaWNlKTsKCiAgICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGZvdW5kOwogICAgfTsKCiAgICB2YXIgZm91bmRTb3VyY2VBbmRUZWNoID0gdW5kZWZpbmVkOwogICAgdmFyIGZsaXAgPSBmdW5jdGlvbiBmbGlwKGZuKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgIHJldHVybiBmbihiLCBhKTsKICAgICAgfTsKICAgIH07CiAgICB2YXIgZmluZGVyID0gZnVuY3Rpb24gZmluZGVyKF9yZWYyLCBzb3VyY2UpIHsKICAgICAgdmFyIHRlY2hOYW1lID0gX3JlZjJbMF07CiAgICAgIHZhciB0ZWNoID0gX3JlZjJbMV07CgogICAgICBpZiAodGVjaC5jYW5QbGF5U291cmNlKHNvdXJjZSkpIHsKICAgICAgICByZXR1cm4geyBzb3VyY2U6IHNvdXJjZSwgdGVjaDogdGVjaE5hbWUgfTsKICAgICAgfQogICAgfTsKCiAgICAvLyBEZXBlbmRpbmcgb24gdGhlIHRydXRoaW5lc3Mgb2YgYG9wdGlvbnMuc291cmNlT3JkZXJgLCB3ZSBzd2FwIHRoZSBvcmRlciBvZiB0ZWNocyBhbmQgc291cmNlcwogICAgLy8gdG8gc2VsZWN0IGZyb20gdGhlbSBiYXNlZCBvbiB0aGVpciBwcmlvcml0eS4KICAgIGlmICh0aGlzLm9wdGlvbnNfLnNvdXJjZU9yZGVyKSB7CiAgICAgIC8vIFNvdXJjZS1maXJzdCBvcmRlcmluZwogICAgICBmb3VuZFNvdXJjZUFuZFRlY2ggPSBmaW5kRmlyc3RQYXNzaW5nVGVjaFNvdXJjZVBhaXIoc291cmNlcywgdGVjaHMsIGZsaXAoZmluZGVyKSk7CiAgICB9IGVsc2UgewogICAgICAvLyBUZWNoLWZpcnN0IG9yZGVyaW5nCiAgICAgIGZvdW5kU291cmNlQW5kVGVjaCA9IGZpbmRGaXJzdFBhc3NpbmdUZWNoU291cmNlUGFpcih0ZWNocywgc291cmNlcywgZmluZGVyKTsKICAgIH0KCiAgICByZXR1cm4gZm91bmRTb3VyY2VBbmRUZWNoIHx8IGZhbHNlOwogIH07CgogIC8qKgogICAqIFRoZSBzb3VyY2UgZnVuY3Rpb24gdXBkYXRlcyB0aGUgdmlkZW8gc291cmNlCiAgICogVGhlcmUgYXJlIHRocmVlIHR5cGVzIG9mIHZhcmlhYmxlcyB5b3UgY2FuIHBhc3MgYXMgdGhlIGFyZ3VtZW50LgogICAqICoqVVJMIFN0cmluZyoqOiBBIFVSTCB0byB0aGUgdGhlIHZpZGVvIGZpbGUuIFVzZSB0aGlzIG1ldGhvZCBpZiB5b3UgYXJlIHN1cmUKICAgKiB0aGUgY3VycmVudCBwbGF5YmFjayB0ZWNobm9sb2d5IChIVE1MNS9GbGFzaCkgY2FuIHN1cHBvcnQgdGhlIHNvdXJjZSB5b3UKICAgKiBwcm92aWRlLiBDdXJyZW50bHkgb25seSBNUDQgZmlsZXMgY2FuIGJlIHVzZWQgaW4gYm90aCBIVE1MNSBhbmQgRmxhc2guCiAgICogYGBganMKICAgKiAgICAgbXlQbGF5ZXIuc3JjKCJodHRwOi8vd3d3LmV4YW1wbGUuY29tL3BhdGgvdG8vdmlkZW8ubXA0Iik7CiAgICogYGBgCiAgICogKipTb3VyY2UgT2JqZWN0IChvciBlbGVtZW50KToqICogQSBqYXZhc2NyaXB0IG9iamVjdCBjb250YWluaW5nIGluZm9ybWF0aW9uCiAgICogYWJvdXQgdGhlIHNvdXJjZSBmaWxlLiBVc2UgdGhpcyBtZXRob2QgaWYgeW91IHdhbnQgdGhlIHBsYXllciB0byBkZXRlcm1pbmUgaWYKICAgKiBpdCBjYW4gc3VwcG9ydCB0aGUgZmlsZSB1c2luZyB0aGUgdHlwZSBpbmZvcm1hdGlvbi4KICAgKiBgYGBqcwogICAqICAgICBteVBsYXllci5zcmMoeyB0eXBlOiAidmlkZW8vbXA0Iiwgc3JjOiAiaHR0cDovL3d3dy5leGFtcGxlLmNvbS9wYXRoL3RvL3ZpZGVvLm1wNCIgfSk7CiAgICogYGBgCiAgICogKipBcnJheSBvZiBTb3VyY2UgT2JqZWN0czoqICogVG8gcHJvdmlkZSBtdWx0aXBsZSB2ZXJzaW9ucyBvZiB0aGUgc291cmNlIHNvCiAgICogdGhhdCBpdCBjYW4gYmUgcGxheWVkIHVzaW5nIEhUTUw1IGFjcm9zcyBicm93c2VycyB5b3UgY2FuIHVzZSBhbiBhcnJheSBvZgogICAqIHNvdXJjZSBvYmplY3RzLiBWaWRlby5qcyB3aWxsIGRldGVjdCB3aGljaCB2ZXJzaW9uIGlzIHN1cHBvcnRlZCBhbmQgbG9hZCB0aGF0CiAgICogZmlsZS4KICAgKiBgYGBqcwogICAqICAgICBteVBsYXllci5zcmMoWwogICAqICAgICAgIHsgdHlwZTogInZpZGVvL21wNCIsIHNyYzogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vcGF0aC90by92aWRlby5tcDQiIH0sCiAgICogICAgICAgeyB0eXBlOiAidmlkZW8vd2VibSIsIHNyYzogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vcGF0aC90by92aWRlby53ZWJtIiB9LAogICAqICAgICAgIHsgdHlwZTogInZpZGVvL29nZyIsIHNyYzogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vcGF0aC90by92aWRlby5vZ3YiIH0KICAgKiAgICAgXSk7CiAgICogYGBgCiAgICoKICAgKiBAcGFyYW0gIHtTdHJpbmd8T2JqZWN0fEFycmF5PX0gc291cmNlIFRoZSBzb3VyY2UgVVJMLCBvYmplY3QsIG9yIGFycmF5IG9mIHNvdXJjZXMKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBjdXJyZW50IHZpZGVvIHNvdXJjZSB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBwbGF5ZXIgd2hlbiBzZXR0aW5nCiAgICogQG1ldGhvZCBzcmMKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5zcmMgPSBmdW5jdGlvbiBzcmMoc291cmNlKSB7CiAgICBpZiAoc291cmNlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMudGVjaEdldF8oJ3NyYycpOwogICAgfQoKICAgIHZhciBjdXJyZW50VGVjaCA9IF90ZWNoVGVjaEpzMlsnZGVmYXVsdCddLmdldFRlY2godGhpcy50ZWNoTmFtZV8pOwogICAgLy8gU3VwcG9ydCBvbGQgYmVoYXZpb3Igb2YgdGVjaHMgYmVpbmcgcmVnaXN0ZXJlZCBhcyBjb21wb25lbnRzLgogICAgLy8gUmVtb3ZlIG9uY2UgdGhhdCBkZXByZWNhdGVkIGJlaGF2aW9yIGlzIHJlbW92ZWQuCiAgICBpZiAoIWN1cnJlbnRUZWNoKSB7CiAgICAgIGN1cnJlbnRUZWNoID0gX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLmdldENvbXBvbmVudCh0aGlzLnRlY2hOYW1lXyk7CiAgICB9CgogICAgLy8gY2FzZTogQXJyYXkgb2Ygc291cmNlIG9iamVjdHMgdG8gY2hvb3NlIGZyb20gYW5kIHBpY2sgdGhlIGJlc3QgdG8gcGxheQogICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlKSkgewogICAgICB0aGlzLnNvdXJjZUxpc3RfKHNvdXJjZSk7CgogICAgICAvLyBjYXNlOiBVUkwgU3RyaW5nIChodHRwOi8vbXl2aWRlby4uLikKICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAvLyBjcmVhdGUgYSBzb3VyY2Ugb2JqZWN0IGZyb20gdGhlIHN0cmluZwogICAgICAgIHRoaXMuc3JjKHsgc3JjOiBzb3VyY2UgfSk7CgogICAgICAgIC8vIGNhc2U6IFNvdXJjZSBvYmplY3QgeyBzcmM6ICcnLCB0eXBlOiAnJyAuLi4gfQogICAgICB9IGVsc2UgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIE9iamVjdCkgewogICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNvdXJjZSBoYXMgYSB0eXBlIGFuZCB0aGUgbG9hZGVkIHRlY2ggY2Fubm90IHBsYXkgdGhlIHNvdXJjZQogICAgICAgICAgLy8gaWYgdGhlcmUncyBubyB0eXBlIHdlJ2xsIGp1c3QgdHJ5IHRoZSBjdXJyZW50IHRlY2gKICAgICAgICAgIGlmIChzb3VyY2UudHlwZSAmJiAhY3VycmVudFRlY2guY2FuUGxheVNvdXJjZShzb3VyY2UpKSB7CiAgICAgICAgICAgIC8vIGNyZWF0ZSBhIHNvdXJjZSBsaXN0IHdpdGggdGhlIGN1cnJlbnQgc291cmNlIGFuZCBzZW5kIHRocm91Z2gKICAgICAgICAgICAgLy8gdGhlIHRlY2ggbG9vcCB0byBjaGVjayBmb3IgYSBjb21wYXRpYmxlIHRlY2hub2xvZ3kKICAgICAgICAgICAgdGhpcy5zb3VyY2VMaXN0Xyhbc291cmNlXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmNhY2hlXy5zcmMgPSBzb3VyY2Uuc3JjOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRUeXBlXyA9IHNvdXJjZS50eXBlIHx8ICcnOwoKICAgICAgICAgICAgLy8gd2FpdCB1bnRpbCB0aGUgdGVjaCBpcyByZWFkeSB0byBzZXQgdGhlIHNvdXJjZQogICAgICAgICAgICB0aGlzLnJlYWR5KGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAgICAgLy8gVGhlIHNldFNvdXJjZSB0ZWNoIG1ldGhvZCB3YXMgYWRkZWQgd2l0aCBzb3VyY2UgaGFuZGxlcnMKICAgICAgICAgICAgICAvLyBzbyBvbGRlciB0ZWNocyB3b24ndCBzdXBwb3J0IGl0CiAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBjaGVjayB0aGUgZGlyZWN0IHByb3RvdHlwZSBmb3IgdGhlIGNhc2Ugd2hlcmUgc3ViY2xhc3NlcwogICAgICAgICAgICAgIC8vIG9mIHRoZSB0ZWNoIGRvIG5vdCBzdXBwb3J0IHNvdXJjZSBoYW5kbGVycwogICAgICAgICAgICAgIGlmIChjdXJyZW50VGVjaC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkoJ3NldFNvdXJjZScpKSB7CiAgICAgICAgICAgICAgICB0aGlzLnRlY2hDYWxsXygnc2V0U291cmNlJywgc291cmNlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NyYycsIHNvdXJjZS5zcmMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uc18ucHJlbG9hZCA9PT0gJ2F1dG8nKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnNfLmF1dG9wbGF5KSB7CiAgICAgICAgICAgICAgICB0aGlzLnBsYXkoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIFNldCB0aGUgc291cmNlIHN5bmNocm9ub3VzbHkgaWYgcG9zc2libGUgKCMyMzI2KQogICAgICAgICAgICB9LCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIGFuIGFycmF5IG9mIHNvdXJjZSBvYmplY3RzCiAgICoKICAgKiBAcGFyYW0gIHtBcnJheX0gc291cmNlcyBBcnJheSBvZiBzb3VyY2Ugb2JqZWN0cwogICAqIEBwcml2YXRlCiAgICogQG1ldGhvZCBzb3VyY2VMaXN0XwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnNvdXJjZUxpc3RfID0gZnVuY3Rpb24gc291cmNlTGlzdF8oc291cmNlcykgewogICAgdmFyIHNvdXJjZVRlY2ggPSB0aGlzLnNlbGVjdFNvdXJjZShzb3VyY2VzKTsKCiAgICBpZiAoc291cmNlVGVjaCkgewogICAgICBpZiAoc291cmNlVGVjaC50ZWNoID09PSB0aGlzLnRlY2hOYW1lXykgewogICAgICAgIC8vIGlmIHRoaXMgdGVjaG5vbG9neSBpcyBhbHJlYWR5IGxvYWRlZCwgc2V0IHRoZSBzb3VyY2UKICAgICAgICB0aGlzLnNyYyhzb3VyY2VUZWNoLnNvdXJjZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbG9hZCB0aGlzIHRlY2hub2xvZ3kgd2l0aCB0aGUgY2hvc2VuIHNvdXJjZQogICAgICAgIHRoaXMubG9hZFRlY2hfKHNvdXJjZVRlY2gudGVjaCwgc291cmNlVGVjaC5zb3VyY2UpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBXZSBuZWVkIHRvIHdyYXAgdGhpcyBpbiBhIHRpbWVvdXQgdG8gZ2l2ZSBmb2xrcyBhIGNoYW5jZSB0byBhZGQgZXJyb3IgZXZlbnQgaGFuZGxlcnMKICAgICAgdGhpcy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmVycm9yKHsgY29kZTogNCwgbWVzc2FnZTogdGhpcy5sb2NhbGl6ZSh0aGlzLm9wdGlvbnNfLm5vdFN1cHBvcnRlZE1lc3NhZ2UpIH0pOwogICAgICB9LCAwKTsKCiAgICAgIC8vIHdlIGNvdWxkIG5vdCBmaW5kIGFuIGFwcHJvcHJpYXRlIHRlY2gsIGJ1dCBsZXQncyBzdGlsbCBub3RpZnkgdGhlIGRlbGVnYXRlIHRoYXQgdGhpcyBpcyBpdAogICAgICAvLyB0aGlzIG5lZWRzIGEgYmV0dGVyIGNvbW1lbnQgYWJvdXQgd2h5IHRoaXMgaXMgbmVlZGVkCiAgICAgIHRoaXMudHJpZ2dlclJlYWR5KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQmVnaW4gbG9hZGluZyB0aGUgc3JjIGRhdGEuCiAgICoKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9IFJldHVybnMgdGhlIHBsYXllcgogICAqIEBtZXRob2QgbG9hZAogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiBsb2FkKCkgewogICAgdGhpcy50ZWNoQ2FsbF8oJ2xvYWQnKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIFJlc2V0IHRoZSBwbGF5ZXIuIExvYWRzIHRoZSBmaXJzdCB0ZWNoIGluIHRoZSB0ZWNoT3JkZXIsCiAgICogYW5kIGNhbGxzIGByZXNldGAgb24gdGhlIHRlY2hgLgogICAqCiAgICogQHJldHVybiB7UGxheWVyfSBSZXR1cm5zIHRoZSBwbGF5ZXIKICAgKiBAbWV0aG9kIHJlc2V0CiAgICovCgogIFBsYXllci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHsKICAgIHRoaXMubG9hZFRlY2hfKF91dGlsc1RvVGl0bGVDYXNlSnMyWydkZWZhdWx0J10odGhpcy5vcHRpb25zXy50ZWNoT3JkZXJbMF0pLCBudWxsKTsKICAgIHRoaXMudGVjaENhbGxfKCdyZXNldCcpOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB0aGUgZnVsbHkgcXVhbGlmaWVkIFVSTCBvZiB0aGUgY3VycmVudCBzb3VyY2UgdmFsdWUgZS5nLiBodHRwOi8vbXlzaXRlLmNvbS92aWRlby5tcDQKICAgKiBDYW4gYmUgdXNlZCBpbiBjb25qdWN0aW9uIHdpdGggYGN1cnJlbnRUeXBlYCB0byBhc3Npc3QgaW4gcmVidWlsZGluZyB0aGUgY3VycmVudCBzb3VyY2Ugb2JqZWN0LgogICAqCiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgY3VycmVudCBzb3VyY2UKICAgKiBAbWV0aG9kIGN1cnJlbnRTcmMKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5jdXJyZW50U3JjID0gZnVuY3Rpb24gY3VycmVudFNyYygpIHsKICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdjdXJyZW50U3JjJykgfHwgdGhpcy5jYWNoZV8uc3JjIHx8ICcnOwogIH07CgogIC8qKgogICAqIEdldCB0aGUgY3VycmVudCBzb3VyY2UgdHlwZSBlLmcuIHZpZGVvL21wNAogICAqIFRoaXMgY2FuIGFsbG93IHlvdSByZWJ1aWxkIHRoZSBjdXJyZW50IHNvdXJjZSBvYmplY3Qgc28gdGhhdCB5b3UgY291bGQgbG9hZCB0aGUgc2FtZQogICAqIHNvdXJjZSBhbmQgdGVjaCBsYXRlcgogICAqCiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgc291cmNlIE1JTUUgdHlwZQogICAqIEBtZXRob2QgY3VycmVudFR5cGUKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5jdXJyZW50VHlwZSA9IGZ1bmN0aW9uIGN1cnJlbnRUeXBlKCkgewogICAgcmV0dXJuIHRoaXMuY3VycmVudFR5cGVfIHx8ICcnOwogIH07CgogIC8qKgogICAqIEdldCBvciBzZXQgdGhlIHByZWxvYWQgYXR0cmlidXRlCiAgICoKICAgKiBAcGFyYW0ge0Jvb2xlYW59IHZhbHVlIEJvb2xlYW4gdG8gZGV0ZXJtaW5lIGlmIHByZWxvYWQgc2hvdWxkIGJlIHVzZWQKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBwcmVsb2FkIGF0dHJpYnV0ZSB2YWx1ZSB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9IFJldHVybnMgdGhlIHBsYXllciB3aGVuIHNldHRpbmcKICAgKiBAbWV0aG9kIHByZWxvYWQKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24gcHJlbG9hZCh2YWx1ZSkgewogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldFByZWxvYWQnLCB2YWx1ZSk7CiAgICAgIHRoaXMub3B0aW9uc18ucHJlbG9hZCA9IHZhbHVlOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdwcmVsb2FkJyk7CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgYXV0b3BsYXkgYXR0cmlidXRlLgogICAqCiAgICogQHBhcmFtIHtCb29sZWFufSB2YWx1ZSBCb29sZWFuIHRvIGRldGVybWluZSBpZiBwcmVsb2FkIHNob3VsZCBiZSB1c2VkCiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgYXV0b3BsYXkgYXR0cmlidXRlIHZhbHVlIHdoZW4gZ2V0dGluZwogICAqIEByZXR1cm4ge1BsYXllcn0gUmV0dXJucyB0aGUgcGxheWVyIHdoZW4gc2V0dGluZwogICAqIEBtZXRob2QgYXV0b3BsYXkKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5hdXRvcGxheSA9IGZ1bmN0aW9uIGF1dG9wbGF5KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLnRlY2hDYWxsXygnc2V0QXV0b3BsYXknLCB2YWx1ZSk7CiAgICAgIHRoaXMub3B0aW9uc18uYXV0b3BsYXkgPSB2YWx1ZTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICByZXR1cm4gdGhpcy50ZWNoR2V0XygnYXV0b3BsYXknLCB2YWx1ZSk7CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgbG9vcCBhdHRyaWJ1dGUgb24gdGhlIHZpZGVvIGVsZW1lbnQuCiAgICoKICAgKiBAcGFyYW0ge0Jvb2xlYW59IHZhbHVlIEJvb2xlYW4gdG8gZGV0ZXJtaW5lIGlmIHByZWxvYWQgc2hvdWxkIGJlIHVzZWQKICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBsb29wIGF0dHJpYnV0ZSB2YWx1ZSB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9IFJldHVybnMgdGhlIHBsYXllciB3aGVuIHNldHRpbmcKICAgKiBAbWV0aG9kIGxvb3AKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5sb29wID0gZnVuY3Rpb24gbG9vcCh2YWx1ZSkgewogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy50ZWNoQ2FsbF8oJ3NldExvb3AnLCB2YWx1ZSk7CiAgICAgIHRoaXMub3B0aW9uc19bJ2xvb3AnXSA9IHZhbHVlOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdsb29wJyk7CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB0aGUgcG9zdGVyIGltYWdlIHNvdXJjZSB1cmwKICAgKgogICAqICMjIyMjIEVYQU1QTEU6CiAgICogYGBganMKICAgKiAgICAgLy8gZ2V0CiAgICogICAgIHZhciBjdXJyZW50UG9zdGVyID0gbXlQbGF5ZXIucG9zdGVyKCk7CiAgICogICAgIC8vIHNldAogICAqICAgICBteVBsYXllci5wb3N0ZXIoJ2h0dHA6Ly9leGFtcGxlLmNvbS9teUltYWdlLmpwZycpOwogICAqIGBgYAogICAqCiAgICogQHBhcmFtICB7U3RyaW5nPX0gc3JjIFBvc3RlciBpbWFnZSBzb3VyY2UgVVJMCiAgICogQHJldHVybiB7U3RyaW5nfSBwb3N0ZXIgVVJMIHdoZW4gZ2V0dGluZwogICAqIEByZXR1cm4ge1BsYXllcn0gc2VsZiB3aGVuIHNldHRpbmcKICAgKiBAbWV0aG9kIHBvc3RlcgogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnBvc3RlciA9IGZ1bmN0aW9uIHBvc3RlcihzcmMpIHsKICAgIGlmIChzcmMgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy5wb3N0ZXJfOwogICAgfQoKICAgIC8vIFRoZSBjb3JyZWN0IHdheSB0byByZW1vdmUgYSBwb3N0ZXIgaXMgdG8gc2V0IGFzIGFuIGVtcHR5IHN0cmluZwogICAgLy8gb3RoZXIgZmFsc2V5IHZhbHVlcyB3aWxsIHRocm93IGVycm9ycwogICAgaWYgKCFzcmMpIHsKICAgICAgc3JjID0gJyc7CiAgICB9CgogICAgLy8gdXBkYXRlIHRoZSBpbnRlcm5hbCBwb3N0ZXIgdmFyaWFibGUKICAgIHRoaXMucG9zdGVyXyA9IHNyYzsKCiAgICAvLyB1cGRhdGUgdGhlIHRlY2gncyBwb3N0ZXIKICAgIHRoaXMudGVjaENhbGxfKCdzZXRQb3N0ZXInLCBzcmMpOwoKICAgIC8vIGFsZXJ0IGNvbXBvbmVudHMgdGhhdCB0aGUgcG9zdGVyIGhhcyBiZWVuIHNldAogICAgdGhpcy50cmlnZ2VyKCdwb3N0ZXJjaGFuZ2UnKTsKCiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKioKICAgKiBTb21lIHRlY2hzIChlLmcuIFlvdVR1YmUpIGNhbiBwcm92aWRlIGEgcG9zdGVyIHNvdXJjZSBpbiBhbgogICAqIGFzeW5jaHJvbm91cyB3YXkuIFdlIHdhbnQgdGhlIHBvc3RlciBjb21wb25lbnQgdG8gdXNlIHRoaXMKICAgKiBwb3N0ZXIgc291cmNlIHNvIHRoYXQgaXQgY292ZXJzIHVwIHRoZSB0ZWNoJ3MgY29udHJvbHMuCiAgICogKFlvdVR1YmUncyBwbGF5IGJ1dHRvbikuIEhvd2V2ZXIgd2Ugb25seSB3YW50IHRvIHVzZSB0aGlzCiAgICogc29ydWNlIGlmIHRoZSBwbGF5ZXIgdXNlciBoYXNuJ3Qgc2V0IGEgcG9zdGVyIHRocm91Z2gKICAgKiB0aGUgbm9ybWFsIEFQSXMuCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaGFuZGxlVGVjaFBvc3RlckNoYW5nZV8KICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUZWNoUG9zdGVyQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVRlY2hQb3N0ZXJDaGFuZ2VfKCkgewogICAgaWYgKCF0aGlzLnBvc3Rlcl8gJiYgdGhpcy50ZWNoXyAmJiB0aGlzLnRlY2hfLnBvc3RlcikgewogICAgICB0aGlzLnBvc3Rlcl8gPSB0aGlzLnRlY2hfLnBvc3RlcigpIHx8ICcnOwoKICAgICAgLy8gTGV0IGNvbXBvbmVudHMga25vdyB0aGUgcG9zdGVyIGhhcyBjaGFuZ2VkCiAgICAgIHRoaXMudHJpZ2dlcigncG9zdGVyY2hhbmdlJyk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogR2V0IG9yIHNldCB3aGV0aGVyIG9yIG5vdCB0aGUgY29udHJvbHMgYXJlIHNob3dpbmcuCiAgICoKICAgKiBAcGFyYW0gIHtCb29sZWFufSBib29sIFNldCBjb250cm9scyB0byBzaG93aW5nIG9yIG5vdAogICAqIEByZXR1cm4ge0Jvb2xlYW59ICAgIENvbnRyb2xzIGFyZSBzaG93aW5nCiAgICogQG1ldGhvZCBjb250cm9scwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmNvbnRyb2xzID0gZnVuY3Rpb24gY29udHJvbHMoYm9vbCkgewogICAgaWYgKGJvb2wgIT09IHVuZGVmaW5lZCkgewogICAgICBib29sID0gISFib29sOyAvLyBmb3JjZSBib29sZWFuCiAgICAgIC8vIERvbid0IHRyaWdnZXIgYSBjaGFuZ2UgZXZlbnQgdW5sZXNzIGl0IGFjdHVhbGx5IGNoYW5nZWQKICAgICAgaWYgKHRoaXMuY29udHJvbHNfICE9PSBib29sKSB7CiAgICAgICAgdGhpcy5jb250cm9sc18gPSBib29sOwoKICAgICAgICBpZiAodGhpcy51c2luZ05hdGl2ZUNvbnRyb2xzKCkpIHsKICAgICAgICAgIHRoaXMudGVjaENhbGxfKCdzZXRDb250cm9scycsIGJvb2wpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJvb2wpIHsKICAgICAgICAgIHRoaXMucmVtb3ZlQ2xhc3MoJ3Zqcy1jb250cm9scy1kaXNhYmxlZCcpOwogICAgICAgICAgdGhpcy5hZGRDbGFzcygndmpzLWNvbnRyb2xzLWVuYWJsZWQnKTsKICAgICAgICAgIHRoaXMudHJpZ2dlcignY29udHJvbHNlbmFibGVkJyk7CgogICAgICAgICAgaWYgKCF0aGlzLnVzaW5nTmF0aXZlQ29udHJvbHMoKSkgewogICAgICAgICAgICB0aGlzLmFkZFRlY2hDb250cm9sc0xpc3RlbmVyc18oKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWNvbnRyb2xzLWVuYWJsZWQnKTsKICAgICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1jb250cm9scy1kaXNhYmxlZCcpOwogICAgICAgICAgdGhpcy50cmlnZ2VyKCdjb250cm9sc2Rpc2FibGVkJyk7CgogICAgICAgICAgaWYgKCF0aGlzLnVzaW5nTmF0aXZlQ29udHJvbHMoKSkgewogICAgICAgICAgICB0aGlzLnJlbW92ZVRlY2hDb250cm9sc0xpc3RlbmVyc18oKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICByZXR1cm4gISF0aGlzLmNvbnRyb2xzXzsKICB9OwoKICAvKioKICAgKiBUb2dnbGUgbmF0aXZlIGNvbnRyb2xzIG9uL29mZi4gTmF0aXZlIGNvbnRyb2xzIGFyZSB0aGUgY29udHJvbHMgYnVpbHQgaW50bwogICAqIGRldmljZXMgKGUuZy4gZGVmYXVsdCBpUGhvbmUgY29udHJvbHMpLCBGbGFzaCwgb3Igb3RoZXIgdGVjaHMKICAgKiAoZS5nLiBWaW1lbyBDb250cm9scykKICAgKiAqKlRoaXMgc2hvdWxkIG9ubHkgYmUgc2V0IGJ5IHRoZSBjdXJyZW50IHRlY2gsIGJlY2F1c2Ugb25seSB0aGUgdGVjaCBrbm93cwogICAqIGlmIGl0IGNhbiBzdXBwb3J0IG5hdGl2ZSBjb250cm9scyoqCiAgICoKICAgKiBAcGFyYW0gIHtCb29sZWFufSBib29sICAgIFRydWUgc2lnbmFscyB0aGF0IG5hdGl2ZSBjb250cm9scyBhcmUgb24KICAgKiBAcmV0dXJuIHtQbGF5ZXJ9ICAgICAgUmV0dXJucyB0aGUgcGxheWVyCiAgICogQHByaXZhdGUKICAgKiBAbWV0aG9kIHVzaW5nTmF0aXZlQ29udHJvbHMKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS51c2luZ05hdGl2ZUNvbnRyb2xzID0gZnVuY3Rpb24gdXNpbmdOYXRpdmVDb250cm9scyhib29sKSB7CiAgICBpZiAoYm9vbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvb2wgPSAhIWJvb2w7IC8vIGZvcmNlIGJvb2xlYW4KICAgICAgLy8gRG9uJ3QgdHJpZ2dlciBhIGNoYW5nZSBldmVudCB1bmxlc3MgaXQgYWN0dWFsbHkgY2hhbmdlZAogICAgICBpZiAodGhpcy51c2luZ05hdGl2ZUNvbnRyb2xzXyAhPT0gYm9vbCkgewogICAgICAgIHRoaXMudXNpbmdOYXRpdmVDb250cm9sc18gPSBib29sOwogICAgICAgIGlmIChib29sKSB7CiAgICAgICAgICB0aGlzLmFkZENsYXNzKCd2anMtdXNpbmctbmF0aXZlLWNvbnRyb2xzJyk7CgogICAgICAgICAgLyoqCiAgICAgICAgICAgICogcGxheWVyIGlzIHVzaW5nIHRoZSBuYXRpdmUgZGV2aWNlIGNvbnRyb2xzCiAgICAgICAgICAgKgogICAgICAgICAgICAqIEBldmVudCB1c2luZ25hdGl2ZWNvbnRyb2xzCiAgICAgICAgICAgICogQG1lbWJlcm9mIFBsYXllcgogICAgICAgICAgICAqIEBpbnN0YW5jZQogICAgICAgICAgICAqIEBwcml2YXRlCiAgICAgICAgICAgICovCiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3VzaW5nbmF0aXZlY29udHJvbHMnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLXVzaW5nLW5hdGl2ZS1jb250cm9scycpOwoKICAgICAgICAgIC8qKgogICAgICAgICAgICAqIHBsYXllciBpcyB1c2luZyB0aGUgY3VzdG9tIEhUTUwgY29udHJvbHMKICAgICAgICAgICAqCiAgICAgICAgICAgICogQGV2ZW50IHVzaW5nY3VzdG9tY29udHJvbHMKICAgICAgICAgICAgKiBAbWVtYmVyb2YgUGxheWVyCiAgICAgICAgICAgICogQGluc3RhbmNlCiAgICAgICAgICAgICogQHByaXZhdGUKICAgICAgICAgICAgKi8KICAgICAgICAgIHRoaXMudHJpZ2dlcigndXNpbmdjdXN0b21jb250cm9scycpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHJldHVybiAhIXRoaXMudXNpbmdOYXRpdmVDb250cm9sc187CiAgfTsKCiAgLyoqCiAgICogU2V0IG9yIGdldCB0aGUgY3VycmVudCBNZWRpYUVycm9yCiAgICoKICAgKiBAcGFyYW0gIHsqfSBlcnIgQSBNZWRpYUVycm9yIG9yIGEgU3RyaW5nL051bWJlciB0byBiZSB0dXJuZWQgaW50byBhIE1lZGlhRXJyb3IKICAgKiBAcmV0dXJuIHtNZWRpYUVycm9yfG51bGx9ICAgICB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9ICAgICAgICAgICAgICB3aGVuIHNldHRpbmcKICAgKiBAbWV0aG9kIGVycm9yCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiBlcnJvcihlcnIpIHsKICAgIGlmIChlcnIgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy5lcnJvcl8gfHwgbnVsbDsKICAgIH0KCiAgICAvLyByZXN0b3JpbmcgdG8gZGVmYXVsdAogICAgaWYgKGVyciA9PT0gbnVsbCkgewogICAgICB0aGlzLmVycm9yXyA9IGVycjsKICAgICAgdGhpcy5yZW1vdmVDbGFzcygndmpzLWVycm9yJyk7CiAgICAgIHRoaXMuZXJyb3JEaXNwbGF5LmNsb3NlKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8vIGVycm9yIGluc3RhbmNlCiAgICBpZiAoZXJyIGluc3RhbmNlb2YgX21lZGlhRXJyb3JKczJbJ2RlZmF1bHQnXSkgewogICAgICB0aGlzLmVycm9yXyA9IGVycjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZXJyb3JfID0gbmV3IF9tZWRpYUVycm9ySnMyWydkZWZhdWx0J10oZXJyKTsKICAgIH0KCiAgICAvLyBhZGQgdGhlIHZqcy1lcnJvciBjbGFzc25hbWUgdG8gdGhlIHBsYXllcgogICAgdGhpcy5hZGRDbGFzcygndmpzLWVycm9yJyk7CgogICAgLy8gbG9nIHRoZSBuYW1lIG9mIHRoZSBlcnJvciB0eXBlIGFuZCBhbnkgbWVzc2FnZQogICAgLy8gaWU4IGp1c3QgbG9ncyAiW29iamVjdCBvYmplY3RdIiBpZiB5b3UganVzdCBsb2cgdGhlIGVycm9yIG9iamVjdAogICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10uZXJyb3IoJyhDT0RFOicgKyB0aGlzLmVycm9yXy5jb2RlICsgJyAnICsgX21lZGlhRXJyb3JKczJbJ2RlZmF1bHQnXS5lcnJvclR5cGVzW3RoaXMuZXJyb3JfLmNvZGVdICsgJyknLCB0aGlzLmVycm9yXy5tZXNzYWdlLCB0aGlzLmVycm9yXyk7CgogICAgLy8gZmlyZSBhbiBlcnJvciBldmVudCBvbiB0aGUgcGxheWVyCiAgICB0aGlzLnRyaWdnZXIoJ2Vycm9yJyk7CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGUgcGxheWVyIGlzIGluIHRoZSAiZW5kZWQiIHN0YXRlLgogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0gVHJ1ZSBpZiB0aGUgcGxheWVyIGlzIGluIHRoZSBlbmRlZCBzdGF0ZSwgZmFsc2UgaWYgbm90LgogICAqIEBtZXRob2QgZW5kZWQKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5lbmRlZCA9IGZ1bmN0aW9uIGVuZGVkKCkgewogICAgcmV0dXJuIHRoaXMudGVjaEdldF8oJ2VuZGVkJyk7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGUgcGxheWVyIGlzIGluIHRoZSAic2Vla2luZyIgc3RhdGUuCiAgICoKICAgKiBAcmV0dXJuIHtCb29sZWFufSBUcnVlIGlmIHRoZSBwbGF5ZXIgaXMgaW4gdGhlIHNlZWtpbmcgc3RhdGUsIGZhbHNlIGlmIG5vdC4KICAgKiBAbWV0aG9kIHNlZWtpbmcKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5zZWVraW5nID0gZnVuY3Rpb24gc2Vla2luZygpIHsKICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdzZWVraW5nJyk7CiAgfTsKCiAgLyoqCiAgICogUmV0dXJucyB0aGUgVGltZVJhbmdlcyBvZiB0aGUgbWVkaWEgdGhhdCBhcmUgY3VycmVudGx5IGF2YWlsYWJsZQogICAqIGZvciBzZWVraW5nIHRvLgogICAqCiAgICogQHJldHVybiB7VGltZVJhbmdlc30gdGhlIHNlZWthYmxlIGludGVydmFscyBvZiB0aGUgbWVkaWEgdGltZWxpbmUKICAgKiBAbWV0aG9kIHNlZWthYmxlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUuc2Vla2FibGUgPSBmdW5jdGlvbiBzZWVrYWJsZSgpIHsKICAgIHJldHVybiB0aGlzLnRlY2hHZXRfKCdzZWVrYWJsZScpOwogIH07CgogIC8qKgogICAqIFJlcG9ydCB1c2VyIGFjdGl2aXR5CiAgICoKICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnQgRXZlbnQgb2JqZWN0CiAgICogQG1ldGhvZCByZXBvcnRVc2VyQWN0aXZpdHkKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5yZXBvcnRVc2VyQWN0aXZpdHkgPSBmdW5jdGlvbiByZXBvcnRVc2VyQWN0aXZpdHkoZXZlbnQpIHsKICAgIHRoaXMudXNlckFjdGl2aXR5XyA9IHRydWU7CiAgfTsKCiAgLyoqCiAgICogR2V0L3NldCBpZiB1c2VyIGlzIGFjdGl2ZQogICAqCiAgICogQHBhcmFtIHtCb29sZWFufSBib29sIFZhbHVlIHdoZW4gc2V0dGluZwogICAqIEByZXR1cm4ge0Jvb2xlYW59IFZhbHVlIGlmIHVzZXIgaXMgYWN0aXZlIHVzZXIgd2hlbiBnZXR0aW5nCiAgICogQG1ldGhvZCB1c2VyQWN0aXZlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUudXNlckFjdGl2ZSA9IGZ1bmN0aW9uIHVzZXJBY3RpdmUoYm9vbCkgewogICAgaWYgKGJvb2wgIT09IHVuZGVmaW5lZCkgewogICAgICBib29sID0gISFib29sOwogICAgICBpZiAoYm9vbCAhPT0gdGhpcy51c2VyQWN0aXZlXykgewogICAgICAgIHRoaXMudXNlckFjdGl2ZV8gPSBib29sOwogICAgICAgIGlmIChib29sKSB7CiAgICAgICAgICAvLyBJZiB0aGUgdXNlciB3YXMgaW5hY3RpdmUgYW5kIGlzIG5vdyBhY3RpdmUgd2Ugd2FudCB0byByZXNldCB0aGUKICAgICAgICAgIC8vIGluYWN0aXZpdHkgdGltZXIKICAgICAgICAgIHRoaXMudXNlckFjdGl2aXR5XyA9IHRydWU7CiAgICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtdXNlci1pbmFjdGl2ZScpOwogICAgICAgICAgdGhpcy5hZGRDbGFzcygndmpzLXVzZXItYWN0aXZlJyk7CiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3VzZXJhY3RpdmUnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gV2UncmUgc3dpdGNoaW5nIHRoZSBzdGF0ZSB0byBpbmFjdGl2ZSBtYW51YWxseSwgc28gZXJhc2UgYW55IG90aGVyCiAgICAgICAgICAvLyBhY3Rpdml0eQogICAgICAgICAgdGhpcy51c2VyQWN0aXZpdHlfID0gZmFsc2U7CgogICAgICAgICAgLy8gQ2hyb21lL1NhZmFyaS9JRSBoYXZlIGJ1Z3Mgd2hlcmUgd2hlbiB5b3UgY2hhbmdlIHRoZSBjdXJzb3IgaXQgY2FuCiAgICAgICAgICAvLyB0cmlnZ2VyIGEgbW91c2Vtb3ZlIGV2ZW50LiBUaGlzIGNhdXNlcyBhbiBpc3N1ZSB3aGVuIHlvdSdyZSBoaWRpbmcKICAgICAgICAgIC8vIHRoZSBjdXJzb3Igd2hlbiB0aGUgdXNlciBpcyBpbmFjdGl2ZSwgYW5kIGEgbW91c2Vtb3ZlIHNpZ25hbHMgdXNlcgogICAgICAgICAgLy8gYWN0aXZpdHkuIE1ha2luZyBpdCBpbXBvc3NpYmxlIHRvIGdvIGludG8gaW5hY3RpdmUgbW9kZS4gU3BlY2lmaWNhbGx5CiAgICAgICAgICAvLyB0aGlzIGhhcHBlbnMgaW4gZnVsbHNjcmVlbiB3aGVuIHdlIHJlYWxseSBuZWVkIHRvIGhpZGUgdGhlIGN1cnNvci4KICAgICAgICAgIC8vCiAgICAgICAgICAvLyBXaGVuIHRoaXMgZ2V0cyByZXNvbHZlZCBpbiBBTEwgYnJvd3NlcnMgaXQgY2FuIGJlIHJlbW92ZWQKICAgICAgICAgIC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0xMDMwNDEKICAgICAgICAgIGlmICh0aGlzLnRlY2hfKSB7CiAgICAgICAgICAgIHRoaXMudGVjaF8ub25lKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtdXNlci1hY3RpdmUnKTsKICAgICAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy11c2VyLWluYWN0aXZlJyk7CiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3VzZXJpbmFjdGl2ZScpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHJldHVybiB0aGlzLnVzZXJBY3RpdmVfOwogIH07CgogIC8qKgogICAqIExpc3RlbiBmb3IgdXNlciBhY3Rpdml0eSBiYXNlZCBvbiB0aW1lb3V0IHZhbHVlCiAgICoKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgbGlzdGVuRm9yVXNlckFjdGl2aXR5XwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmxpc3RlbkZvclVzZXJBY3Rpdml0eV8gPSBmdW5jdGlvbiBsaXN0ZW5Gb3JVc2VyQWN0aXZpdHlfKCkgewogICAgdmFyIG1vdXNlSW5Qcm9ncmVzcyA9IHVuZGVmaW5lZCwKICAgICAgICBsYXN0TW92ZVggPSB1bmRlZmluZWQsCiAgICAgICAgbGFzdE1vdmVZID0gdW5kZWZpbmVkOwoKICAgIHZhciBoYW5kbGVBY3Rpdml0eSA9IEZuLmJpbmQodGhpcywgdGhpcy5yZXBvcnRVc2VyQWN0aXZpdHkpOwoKICAgIHZhciBoYW5kbGVNb3VzZU1vdmUgPSBmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmUoZSkgewogICAgICAvLyAjMTA2OCAtIFByZXZlbnQgbW91c2Vtb3ZlIHNwYW1taW5nCiAgICAgIC8vIENocm9tZSBCdWc6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0zNjY5NzAKICAgICAgaWYgKGUuc2NyZWVuWCAhPT0gbGFzdE1vdmVYIHx8IGUuc2NyZWVuWSAhPT0gbGFzdE1vdmVZKSB7CiAgICAgICAgbGFzdE1vdmVYID0gZS5zY3JlZW5YOwogICAgICAgIGxhc3RNb3ZlWSA9IGUuc2NyZWVuWTsKICAgICAgICBoYW5kbGVBY3Rpdml0eSgpOwogICAgICB9CiAgICB9OwoKICAgIHZhciBoYW5kbGVNb3VzZURvd24gPSBmdW5jdGlvbiBoYW5kbGVNb3VzZURvd24oKSB7CiAgICAgIGhhbmRsZUFjdGl2aXR5KCk7CiAgICAgIC8vIEZvciBhcyBsb25nIGFzIHRoZSB0aGV5IGFyZSB0b3VjaGluZyB0aGUgZGV2aWNlIG9yIGhhdmUgdGhlaXIgbW91c2UgZG93biwKICAgICAgLy8gd2UgY29uc2lkZXIgdGhlbSBhY3RpdmUgZXZlbiBpZiB0aGV5J3JlIG5vdCBtb3ZpbmcgdGhlaXIgZmluZ2VyIG9yIG1vdXNlLgogICAgICAvLyBTbyB3ZSB3YW50IHRvIGNvbnRpbnVlIHRvIHVwZGF0ZSB0aGF0IHRoZXkgYXJlIGFjdGl2ZQogICAgICB0aGlzLmNsZWFySW50ZXJ2YWwobW91c2VJblByb2dyZXNzKTsKICAgICAgLy8gU2V0dGluZyB1c2VyQWN0aXZpdHk9dHJ1ZSBub3cgYW5kIHNldHRpbmcgdGhlIGludGVydmFsIHRvIHRoZSBzYW1lIHRpbWUKICAgICAgLy8gYXMgdGhlIGFjdGl2aXR5Q2hlY2sgaW50ZXJ2YWwgKDI1MCkgc2hvdWxkIGVuc3VyZSB3ZSBuZXZlciBtaXNzIHRoZQogICAgICAvLyBuZXh0IGFjdGl2aXR5Q2hlY2sKICAgICAgbW91c2VJblByb2dyZXNzID0gdGhpcy5zZXRJbnRlcnZhbChoYW5kbGVBY3Rpdml0eSwgMjUwKTsKICAgIH07CgogICAgdmFyIGhhbmRsZU1vdXNlVXAgPSBmdW5jdGlvbiBoYW5kbGVNb3VzZVVwKGV2ZW50KSB7CiAgICAgIGhhbmRsZUFjdGl2aXR5KCk7CiAgICAgIC8vIFN0b3AgdGhlIGludGVydmFsIHRoYXQgbWFpbnRhaW5zIGFjdGl2aXR5IGlmIHRoZSBtb3VzZS90b3VjaCBpcyBkb3duCiAgICAgIHRoaXMuY2xlYXJJbnRlcnZhbChtb3VzZUluUHJvZ3Jlc3MpOwogICAgfTsKCiAgICAvLyBBbnkgbW91c2UgbW92ZW1lbnQgd2lsbCBiZSBjb25zaWRlcmVkIHVzZXIgYWN0aXZpdHkKICAgIHRoaXMub24oJ21vdXNlZG93bicsIGhhbmRsZU1vdXNlRG93bik7CiAgICB0aGlzLm9uKCdtb3VzZW1vdmUnLCBoYW5kbGVNb3VzZU1vdmUpOwogICAgdGhpcy5vbignbW91c2V1cCcsIGhhbmRsZU1vdXNlVXApOwoKICAgIC8vIExpc3RlbiBmb3Iga2V5Ym9hcmQgbmF2aWdhdGlvbgogICAgLy8gU2hvdWxkbid0IG5lZWQgdG8gdXNlIGluUHJvZ3Jlc3MgaW50ZXJ2YWwgYmVjYXVzZSBvZiBrZXkgcmVwZWF0CiAgICB0aGlzLm9uKCdrZXlkb3duJywgaGFuZGxlQWN0aXZpdHkpOwogICAgdGhpcy5vbigna2V5dXAnLCBoYW5kbGVBY3Rpdml0eSk7CgogICAgLy8gUnVuIGFuIGludGVydmFsIGV2ZXJ5IDI1MCBtaWxsaXNlY29uZHMgaW5zdGVhZCBvZiBzdHVmZmluZyBldmVyeXRoaW5nIGludG8KICAgIC8vIHRoZSBtb3VzZW1vdmUvdG91Y2htb3ZlIGZ1bmN0aW9uIGl0c2VsZiwgdG8gcHJldmVudCBwZXJmb3JtYW5jZSBkZWdyYWRhdGlvbi4KICAgIC8vIGB0aGlzLnJlcG9ydFVzZXJBY3Rpdml0eWAgc2ltcGx5IHNldHMgdGhpcy51c2VyQWN0aXZpdHlfIHRvIHRydWUsIHdoaWNoCiAgICAvLyB0aGVuIGdldHMgcGlja2VkIHVwIGJ5IHRoaXMgbG9vcAogICAgLy8gaHR0cDovL2Vqb2huLm9yZy9ibG9nL2xlYXJuaW5nLWZyb20tdHdpdHRlci8KICAgIHZhciBpbmFjdGl2aXR5VGltZW91dCA9IHVuZGVmaW5lZDsKICAgIHZhciBhY3Rpdml0eUNoZWNrID0gdGhpcy5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiBtb3VzZS90b3VjaCBhY3Rpdml0eSBoYXMgaGFwcGVuZWQKICAgICAgaWYgKHRoaXMudXNlckFjdGl2aXR5XykgewogICAgICAgIC8vIFJlc2V0IHRoZSBhY3Rpdml0eSB0cmFja2VyCiAgICAgICAgdGhpcy51c2VyQWN0aXZpdHlfID0gZmFsc2U7CgogICAgICAgIC8vIElmIHRoZSB1c2VyIHN0YXRlIHdhcyBpbmFjdGl2ZSwgc2V0IHRoZSBzdGF0ZSB0byBhY3RpdmUKICAgICAgICB0aGlzLnVzZXJBY3RpdmUodHJ1ZSk7CgogICAgICAgIC8vIENsZWFyIGFueSBleGlzdGluZyBpbmFjdGl2aXR5IHRpbWVvdXQgdG8gc3RhcnQgdGhlIHRpbWVyIG92ZXIKICAgICAgICB0aGlzLmNsZWFyVGltZW91dChpbmFjdGl2aXR5VGltZW91dCk7CgogICAgICAgIHZhciB0aW1lb3V0ID0gdGhpcy5vcHRpb25zX1snaW5hY3Rpdml0eVRpbWVvdXQnXTsKICAgICAgICBpZiAodGltZW91dCA+IDApIHsKICAgICAgICAgIC8vIEluIDx0aW1lb3V0PiBtaWxsaXNlY29uZHMsIGlmIG5vIG1vcmUgYWN0aXZpdHkgaGFzIG9jY3VycmVkIHRoZQogICAgICAgICAgLy8gdXNlciB3aWxsIGJlIGNvbnNpZGVyZWQgaW5hY3RpdmUKICAgICAgICAgIGluYWN0aXZpdHlUaW1lb3V0ID0gdGhpcy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gUHJvdGVjdCBhZ2FpbnN0IHRoZSBjYXNlIHdoZXJlIHRoZSBpbmFjdGl2aXR5VGltZW91dCBjYW4gdHJpZ2dlciBqdXN0CiAgICAgICAgICAgIC8vIGJlZm9yZSB0aGUgbmV4dCB1c2VyIGFjdGl2aXR5IGlzIHBpY2tlZCB1cCBieSB0aGUgYWN0aXZpdHlDaGVjayBsb29wCiAgICAgICAgICAgIC8vIGNhdXNpbmcgYSBmbGlja2VyCiAgICAgICAgICAgIGlmICghdGhpcy51c2VyQWN0aXZpdHlfKSB7CiAgICAgICAgICAgICAgdGhpcy51c2VyQWN0aXZlKGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgdGltZW91dCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCAyNTApOwogIH07CgogIC8qKgogICAqIEdldHMgb3Igc2V0cyB0aGUgY3VycmVudCBwbGF5YmFjayByYXRlLiAgQSBwbGF5YmFjayByYXRlIG9mCiAgICogMS4wIHJlcHJlc2VudHMgbm9ybWFsIHNwZWVkIGFuZCAwLjUgd291bGQgaW5kaWNhdGUgaGFsZi1zcGVlZAogICAqIHBsYXliYWNrLCBmb3IgaW5zdGFuY2UuCiAgICogQHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9lbWJlZGRlZC1jb250ZW50Lmh0bWwjZG9tLW1lZGlhLXBsYXliYWNrcmF0ZQogICAqCiAgICogQHBhcmFtICB7TnVtYmVyfSByYXRlICAgIE5ldyBwbGF5YmFjayByYXRlIHRvIHNldC4KICAgKiBAcmV0dXJuIHtOdW1iZXJ9ICAgICAgICAgUmV0dXJucyB0aGUgbmV3IHBsYXliYWNrIHJhdGUgd2hlbiBzZXR0aW5nCiAgICogQHJldHVybiB7TnVtYmVyfSAgICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgcGxheWJhY2sgcmF0ZSB3aGVuIGdldHRpbmcKICAgKiBAbWV0aG9kIHBsYXliYWNrUmF0ZQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnBsYXliYWNrUmF0ZSA9IGZ1bmN0aW9uIHBsYXliYWNrUmF0ZShyYXRlKSB7CiAgICBpZiAocmF0ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHRoaXMudGVjaENhbGxfKCdzZXRQbGF5YmFja1JhdGUnLCByYXRlKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgaWYgKHRoaXMudGVjaF8gJiYgdGhpcy50ZWNoX1snZmVhdHVyZXNQbGF5YmFja1JhdGUnXSkgewogICAgICByZXR1cm4gdGhpcy50ZWNoR2V0XygncGxheWJhY2tSYXRlJyk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gMS4wOwogICAgfQogIH07CgogIC8qKgogICAqIEdldHMgb3Igc2V0cyB0aGUgYXVkaW8gZmxhZwogICAqCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gYm9vbCAgICBUcnVlIHNpZ25hbHMgdGhhdCB0aGlzIGlzIGFuIGF1ZGlvIHBsYXllci4KICAgKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICAgIFJldHVybnMgdHJ1ZSBpZiBwbGF5ZXIgaXMgYXVkaW8sIGZhbHNlIGlmIG5vdCB3aGVuIGdldHRpbmcKICAgKiBAcmV0dXJuIHtQbGF5ZXJ9ICAgICAgUmV0dXJucyB0aGUgcGxheWVyIGlmIHNldHRpbmcKICAgKiBAcHJpdmF0ZQogICAqIEBtZXRob2QgaXNBdWRpbwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmlzQXVkaW8gPSBmdW5jdGlvbiBpc0F1ZGlvKGJvb2wpIHsKICAgIGlmIChib29sICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy5pc0F1ZGlvXyA9ICEhYm9vbDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcmV0dXJuICEhdGhpcy5pc0F1ZGlvXzsKICB9OwoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0YXRlIG9mIG5ldHdvcmsgYWN0aXZpdHkgZm9yIHRoZSBlbGVtZW50LCBmcm9tCiAgICogdGhlIGNvZGVzIGluIHRoZSBsaXN0IGJlbG93LgogICAqIC0gTkVUV09SS19FTVBUWSAobnVtZXJpYyB2YWx1ZSAwKQogICAqICAgVGhlIGVsZW1lbnQgaGFzIG5vdCB5ZXQgYmVlbiBpbml0aWFsaXNlZC4gQWxsIGF0dHJpYnV0ZXMgYXJlIGluCiAgICogICB0aGVpciBpbml0aWFsIHN0YXRlcy4KICAgKiAtIE5FVFdPUktfSURMRSAobnVtZXJpYyB2YWx1ZSAxKQogICAqICAgVGhlIGVsZW1lbnQncyByZXNvdXJjZSBzZWxlY3Rpb24gYWxnb3JpdGhtIGlzIGFjdGl2ZSBhbmQgaGFzCiAgICogICBzZWxlY3RlZCBhIHJlc291cmNlLCBidXQgaXQgaXMgbm90IGFjdHVhbGx5IHVzaW5nIHRoZSBuZXR3b3JrIGF0CiAgICogICB0aGlzIHRpbWUuCiAgICogLSBORVRXT1JLX0xPQURJTkcgKG51bWVyaWMgdmFsdWUgMikKICAgKiAgIFRoZSB1c2VyIGFnZW50IGlzIGFjdGl2ZWx5IHRyeWluZyB0byBkb3dubG9hZCBkYXRhLgogICAqIC0gTkVUV09SS19OT19TT1VSQ0UgKG51bWVyaWMgdmFsdWUgMykKICAgKiAgIFRoZSBlbGVtZW50J3MgcmVzb3VyY2Ugc2VsZWN0aW9uIGFsZ29yaXRobSBpcyBhY3RpdmUsIGJ1dCBpdCBoYXMKICAgKiAgIG5vdCB5ZXQgZm91bmQgYSByZXNvdXJjZSB0byB1c2UuCiAgICoKICAgKiBAc2VlIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCNuZXR3b3JrLXN0YXRlcwogICAqIEByZXR1cm4ge051bWJlcn0gdGhlIGN1cnJlbnQgbmV0d29yayBhY3Rpdml0eSBzdGF0ZQogICAqIEBtZXRob2QgbmV0d29ya1N0YXRlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUubmV0d29ya1N0YXRlID0gZnVuY3Rpb24gbmV0d29ya1N0YXRlKCkgewogICAgcmV0dXJuIHRoaXMudGVjaEdldF8oJ25ldHdvcmtTdGF0ZScpOwogIH07CgogIC8qKgogICAqIFJldHVybnMgYSB2YWx1ZSB0aGF0IGV4cHJlc3NlcyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZWxlbWVudAogICAqIHdpdGggcmVzcGVjdCB0byByZW5kZXJpbmcgdGhlIGN1cnJlbnQgcGxheWJhY2sgcG9zaXRpb24sIGZyb20gdGhlCiAgICogY29kZXMgaW4gdGhlIGxpc3QgYmVsb3cuCiAgICogLSBIQVZFX05PVEhJTkcgKG51bWVyaWMgdmFsdWUgMCkKICAgKiAgIE5vIGluZm9ybWF0aW9uIHJlZ2FyZGluZyB0aGUgbWVkaWEgcmVzb3VyY2UgaXMgYXZhaWxhYmxlLgogICAqIC0gSEFWRV9NRVRBREFUQSAobnVtZXJpYyB2YWx1ZSAxKQogICAqICAgRW5vdWdoIG9mIHRoZSByZXNvdXJjZSBoYXMgYmVlbiBvYnRhaW5lZCB0aGF0IHRoZSBkdXJhdGlvbiBvZiB0aGUKICAgKiAgIHJlc291cmNlIGlzIGF2YWlsYWJsZS4KICAgKiAtIEhBVkVfQ1VSUkVOVF9EQVRBIChudW1lcmljIHZhbHVlIDIpCiAgICogICBEYXRhIGZvciB0aGUgaW1tZWRpYXRlIGN1cnJlbnQgcGxheWJhY2sgcG9zaXRpb24gaXMgYXZhaWxhYmxlLgogICAqIC0gSEFWRV9GVVRVUkVfREFUQSAobnVtZXJpYyB2YWx1ZSAzKQogICAqICAgRGF0YSBmb3IgdGhlIGltbWVkaWF0ZSBjdXJyZW50IHBsYXliYWNrIHBvc2l0aW9uIGlzIGF2YWlsYWJsZSwgYXMKICAgKiAgIHdlbGwgYXMgZW5vdWdoIGRhdGEgZm9yIHRoZSB1c2VyIGFnZW50IHRvIGFkdmFuY2UgdGhlIGN1cnJlbnQKICAgKiAgIHBsYXliYWNrIHBvc2l0aW9uIGluIHRoZSBkaXJlY3Rpb24gb2YgcGxheWJhY2suCiAgICogLSBIQVZFX0VOT1VHSF9EQVRBIChudW1lcmljIHZhbHVlIDQpCiAgICogICBUaGUgdXNlciBhZ2VudCBlc3RpbWF0ZXMgdGhhdCBlbm91Z2ggZGF0YSBpcyBhdmFpbGFibGUgZm9yCiAgICogICBwbGF5YmFjayB0byBwcm9jZWVkIHVuaW50ZXJydXB0ZWQuCiAgICoKICAgKiBAc2VlIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCNkb20tbWVkaWEtcmVhZHlzdGF0ZQogICAqIEByZXR1cm4ge051bWJlcn0gdGhlIGN1cnJlbnQgcGxheWJhY2sgcmVuZGVyaW5nIHN0YXRlCiAgICogQG1ldGhvZCByZWFkeVN0YXRlCiAgICovCgogIFBsYXllci5wcm90b3R5cGUucmVhZHlTdGF0ZSA9IGZ1bmN0aW9uIHJlYWR5U3RhdGUoKSB7CiAgICByZXR1cm4gdGhpcy50ZWNoR2V0XygncmVhZHlTdGF0ZScpOwogIH07CgogIC8qCiAgICAqIFRleHQgdHJhY2tzIGFyZSB0cmFja3Mgb2YgdGltZWQgdGV4dCBldmVudHMuCiAgICAqIENhcHRpb25zIC0gdGV4dCBkaXNwbGF5ZWQgb3ZlciB0aGUgdmlkZW8gZm9yIHRoZSBoZWFyaW5nIGltcGFpcmVkCiAgICAqIFN1YnRpdGxlcyAtIHRleHQgZGlzcGxheWVkIG92ZXIgdGhlIHZpZGVvIGZvciB0aG9zZSB3aG8gZG9uJ3QgdW5kZXJzdGFuZCBsYW5ndWFnZSBpbiB0aGUgdmlkZW8KICAgICogQ2hhcHRlcnMgLSB0ZXh0IGRpc3BsYXllZCBpbiBhIG1lbnUgYWxsb3dpbmcgdGhlIHVzZXIgdG8ganVtcCB0byBwYXJ0aWN1bGFyIHBvaW50cyAoY2hhcHRlcnMpIGluIHRoZSB2aWRlbwogICAgKiBEZXNjcmlwdGlvbnMgKG5vdCBzdXBwb3J0ZWQgeWV0KSAtIGF1ZGlvIGRlc2NyaXB0aW9ucyB0aGF0IGFyZSByZWFkIGJhY2sgdG8gdGhlIHVzZXIgYnkgYSBzY3JlZW4gcmVhZGluZyBkZXZpY2UKICAgICovCgogIC8qKgogICAqIEdldCBhbiBhcnJheSBvZiBhc3NvY2lhdGVkIHRleHQgdHJhY2tzLiBjYXB0aW9ucywgc3VidGl0bGVzLCBjaGFwdGVycywgZGVzY3JpcHRpb25zCiAgICogaHR0cDovL3d3dy53My5vcmcvaHRtbC93Zy9kcmFmdHMvaHRtbC9tYXN0ZXIvZW1iZWRkZWQtY29udGVudC0wLmh0bWwjZG9tLW1lZGlhLXRleHR0cmFja3MKICAgKgogICAqIEByZXR1cm4ge0FycmF5fSAgICAgICAgICAgQXJyYXkgb2YgdHJhY2sgb2JqZWN0cwogICAqIEBtZXRob2QgdGV4dFRyYWNrcwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnRleHRUcmFja3MgPSBmdW5jdGlvbiB0ZXh0VHJhY2tzKCkgewogICAgLy8gY2Fubm90IHVzZSB0ZWNoR2V0XyBkaXJlY3RseSBiZWNhdXNlIGl0IGNoZWNrcyB0byBzZWUgd2hldGhlciB0aGUgdGVjaCBpcyByZWFkeS4KICAgIC8vIEZsYXNoIGlzIHVubGlrZWx5IHRvIGJlIHJlYWR5IGluIHRpbWUgYnV0IHRleHRUcmFja3Mgc2hvdWxkIHN0aWxsIHdvcmsuCiAgICByZXR1cm4gdGhpcy50ZWNoXyAmJiB0aGlzLnRlY2hfWyd0ZXh0VHJhY2tzJ10oKTsKICB9OwoKICAvKioKICAgKiBHZXQgYW4gYXJyYXkgb2YgcmVtb3RlIHRleHQgdHJhY2tzCiAgICoKICAgKiBAcmV0dXJuIHtBcnJheX0KICAgKiBAbWV0aG9kIHJlbW90ZVRleHRUcmFja3MKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5yZW1vdGVUZXh0VHJhY2tzID0gZnVuY3Rpb24gcmVtb3RlVGV4dFRyYWNrcygpIHsKICAgIHJldHVybiB0aGlzLnRlY2hfICYmIHRoaXMudGVjaF9bJ3JlbW90ZVRleHRUcmFja3MnXSgpOwogIH07CgogIC8qKgogICAqIEdldCBhbiBhcnJheSBvZiByZW1vdGUgaHRtbCB0cmFjayBlbGVtZW50cwogICAqCiAgICogQHJldHVybiB7SFRNTFRyYWNrRWxlbWVudFtdfQogICAqIEBtZXRob2QgcmVtb3RlVGV4dFRyYWNrRWxzCiAgICovCgogIFBsYXllci5wcm90b3R5cGUucmVtb3RlVGV4dFRyYWNrRWxzID0gZnVuY3Rpb24gcmVtb3RlVGV4dFRyYWNrRWxzKCkgewogICAgcmV0dXJuIHRoaXMudGVjaF8gJiYgdGhpcy50ZWNoX1sncmVtb3RlVGV4dFRyYWNrRWxzJ10oKTsKICB9OwoKICAvKioKICAgKiBBZGQgYSB0ZXh0IHRyYWNrCiAgICogSW4gYWRkaXRpb24gdG8gdGhlIFczQyBzZXR0aW5ncyB3ZSBhbGxvdyBhZGRpbmcgYWRkaXRpb25hbCBpbmZvIHRocm91Z2ggb3B0aW9ucy4KICAgKiBodHRwOi8vd3d3LnczLm9yZy9odG1sL3dnL2RyYWZ0cy9odG1sL21hc3Rlci9lbWJlZGRlZC1jb250ZW50LTAuaHRtbCNkb20tbWVkaWEtYWRkdGV4dHRyYWNrCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gIGtpbmQgICAgICAgIENhcHRpb25zLCBzdWJ0aXRsZXMsIGNoYXB0ZXJzLCBkZXNjcmlwdGlvbnMsIG9yIG1ldGFkYXRhCiAgICogQHBhcmFtIHtTdHJpbmc9fSBsYWJlbCAgICAgICBPcHRpb25hbCBsYWJlbAogICAqIEBwYXJhbSB7U3RyaW5nPX0gbGFuZ3VhZ2UgICAgT3B0aW9uYWwgbGFuZ3VhZ2UKICAgKiBAbWV0aG9kIGFkZFRleHRUcmFjawogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmFkZFRleHRUcmFjayA9IGZ1bmN0aW9uIGFkZFRleHRUcmFjayhraW5kLCBsYWJlbCwgbGFuZ3VhZ2UpIHsKICAgIHJldHVybiB0aGlzLnRlY2hfICYmIHRoaXMudGVjaF9bJ2FkZFRleHRUcmFjayddKGtpbmQsIGxhYmVsLCBsYW5ndWFnZSk7CiAgfTsKCiAgLyoqCiAgICogQWRkIGEgcmVtb3RlIHRleHQgdHJhY2sKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zICAgIE9wdGlvbnMgZm9yIHJlbW90ZSB0ZXh0IHRyYWNrCiAgICogQG1ldGhvZCBhZGRSZW1vdGVUZXh0VHJhY2sKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5hZGRSZW1vdGVUZXh0VHJhY2sgPSBmdW5jdGlvbiBhZGRSZW1vdGVUZXh0VHJhY2sob3B0aW9ucykgewogICAgcmV0dXJuIHRoaXMudGVjaF8gJiYgdGhpcy50ZWNoX1snYWRkUmVtb3RlVGV4dFRyYWNrJ10ob3B0aW9ucyk7CiAgfTsKCiAgLyoqCiAgICogUmVtb3ZlIGEgcmVtb3RlIHRleHQgdHJhY2sKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSB0cmFjayAgICBSZW1vdGUgdGV4dCB0cmFjayB0byByZW1vdmUKICAgKiBAbWV0aG9kIHJlbW92ZVJlbW90ZVRleHRUcmFjawogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLnJlbW92ZVJlbW90ZVRleHRUcmFjayA9IGZ1bmN0aW9uIHJlbW92ZVJlbW90ZVRleHRUcmFjayh0cmFjaykgewogICAgdGhpcy50ZWNoXyAmJiB0aGlzLnRlY2hfWydyZW1vdmVSZW1vdGVUZXh0VHJhY2snXSh0cmFjayk7CiAgfTsKCiAgLyoqCiAgICogR2V0IHZpZGVvIHdpZHRoCiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFZpZGVvIHdpZHRoCiAgICogQG1ldGhvZCB2aWRlb1dpZHRoCiAgICovCgogIFBsYXllci5wcm90b3R5cGUudmlkZW9XaWR0aCA9IGZ1bmN0aW9uIHZpZGVvV2lkdGgoKSB7CiAgICByZXR1cm4gdGhpcy50ZWNoXyAmJiB0aGlzLnRlY2hfLnZpZGVvV2lkdGggJiYgdGhpcy50ZWNoXy52aWRlb1dpZHRoKCkgfHwgMDsKICB9OwoKICAvKioKICAgKiBHZXQgdmlkZW8gaGVpZ2h0CiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFZpZGVvIGhlaWdodAogICAqIEBtZXRob2QgdmlkZW9IZWlnaHQKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS52aWRlb0hlaWdodCA9IGZ1bmN0aW9uIHZpZGVvSGVpZ2h0KCkgewogICAgcmV0dXJuIHRoaXMudGVjaF8gJiYgdGhpcy50ZWNoXy52aWRlb0hlaWdodCAmJiB0aGlzLnRlY2hfLnZpZGVvSGVpZ2h0KCkgfHwgMDsKICB9OwoKICAvLyBNZXRob2RzIHRvIGFkZCBzdXBwb3J0IGZvcgogIC8vIGluaXRpYWxUaW1lOiBmdW5jdGlvbigpeyByZXR1cm4gdGhpcy50ZWNoQ2FsbF8oJ2luaXRpYWxUaW1lJyk7IH0sCiAgLy8gc3RhcnRPZmZzZXRUaW1lOiBmdW5jdGlvbigpeyByZXR1cm4gdGhpcy50ZWNoQ2FsbF8oJ3N0YXJ0T2Zmc2V0VGltZScpOyB9LAogIC8vIHBsYXllZDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXMudGVjaENhbGxfKCdwbGF5ZWQnKTsgfSwKICAvLyB2aWRlb1RyYWNrczogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXMudGVjaENhbGxfKCd2aWRlb1RyYWNrcycpOyB9LAogIC8vIGF1ZGlvVHJhY2tzOiBmdW5jdGlvbigpeyByZXR1cm4gdGhpcy50ZWNoQ2FsbF8oJ2F1ZGlvVHJhY2tzJyk7IH0sCiAgLy8gZGVmYXVsdFBsYXliYWNrUmF0ZTogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXMudGVjaENhbGxfKCdkZWZhdWx0UGxheWJhY2tSYXRlJyk7IH0sCiAgLy8gZGVmYXVsdE11dGVkOiBmdW5jdGlvbigpeyByZXR1cm4gdGhpcy50ZWNoQ2FsbF8oJ2RlZmF1bHRNdXRlZCcpOyB9CgogIC8qKgogICAqIFRoZSBwbGF5ZXIncyBsYW5ndWFnZSBjb2RlCiAgICogTk9URTogVGhlIGxhbmd1YWdlIHNob3VsZCBiZSBzZXQgaW4gdGhlIHBsYXllciBvcHRpb25zIGlmIHlvdSB3YW50IHRoZQogICAqIHRoZSBjb250cm9scyB0byBiZSBidWlsdCB3aXRoIGEgc3BlY2lmaWMgbGFuZ3VhZ2UuIENoYW5naW5nIHRoZSBsYW51Z2FnZQogICAqIGxhdGVyIHdpbGwgbm90IHVwZGF0ZSBjb250cm9scyB0ZXh0LgogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IGNvZGUgIFRoZSBsb2NhbGUgc3RyaW5nCiAgICogQHJldHVybiB7U3RyaW5nfSAgICAgIFRoZSBsb2NhbGUgc3RyaW5nIHdoZW4gZ2V0dGluZwogICAqIEByZXR1cm4ge1BsYXllcn0gICAgICBzZWxmIHdoZW4gc2V0dGluZwogICAqIEBtZXRob2QgbGFuZ3VhZ2UKICAgKi8KCiAgUGxheWVyLnByb3RvdHlwZS5sYW5ndWFnZSA9IGZ1bmN0aW9uIGxhbmd1YWdlKGNvZGUpIHsKICAgIGlmIChjb2RlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMubGFuZ3VhZ2VfOwogICAgfQoKICAgIHRoaXMubGFuZ3VhZ2VfID0gKCcnICsgY29kZSkudG9Mb3dlckNhc2UoKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAqIEdldCB0aGUgcGxheWVyJ3MgbGFuZ3VhZ2UgZGljdGlvbmFyeQogICAqIE1lcmdlIGV2ZXJ5IHRpbWUsIGJlY2F1c2UgYSBuZXdseSBhZGRlZCBwbHVnaW4gbWlnaHQgY2FsbCB2aWRlb2pzLmFkZExhbmd1YWdlKCkgYXQgYW55IHRpbWUKICAgKiBMYW5ndWFnZXMgc3BlY2lmaWVkIGRpcmVjdGx5IGluIHRoZSBwbGF5ZXIgb3B0aW9ucyBoYXZlIHByZWNlZGVuY2UKICAgKgogICAqIEByZXR1cm4ge0FycmF5fSBBcnJheSBvZiBsYW5ndWFnZXMKICAgKiBAbWV0aG9kIGxhbmd1YWdlcwogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmxhbmd1YWdlcyA9IGZ1bmN0aW9uIGxhbmd1YWdlcygpIHsKICAgIHJldHVybiBfdXRpbHNNZXJnZU9wdGlvbnNKczJbJ2RlZmF1bHQnXShQbGF5ZXIucHJvdG90eXBlLm9wdGlvbnNfLmxhbmd1YWdlcywgdGhpcy5sYW5ndWFnZXNfKTsKICB9OwoKICAvKioKICAgKiBDb252ZXJ0cyB0cmFjayBpbmZvIHRvIEpTT04KICAgKgogICAqIEByZXR1cm4ge09iamVjdH0gSlNPTiBvYmplY3Qgb2Ygb3B0aW9ucwogICAqIEBtZXRob2QgdG9KU09OCiAgICovCgogIFBsYXllci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gdG9KU09OKCkgewogICAgdmFyIG9wdGlvbnMgPSBfdXRpbHNNZXJnZU9wdGlvbnNKczJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnNfKTsKICAgIHZhciB0cmFja3MgPSBvcHRpb25zLnRyYWNrczsKCiAgICBvcHRpb25zLnRyYWNrcyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHJhY2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciB0cmFjayA9IHRyYWNrc1tpXTsKCiAgICAgIC8vIGRlZXAgbWVyZ2UgdHJhY2tzIGFuZCBudWxsIG91dCBwbGF5ZXIgc28gbm8gY2lyY3VsYXIgcmVmZXJlbmNlcwogICAgICB0cmFjayA9IF91dGlsc01lcmdlT3B0aW9uc0pzMlsnZGVmYXVsdCddKHRyYWNrKTsKICAgICAgdHJhY2sucGxheWVyID0gdW5kZWZpbmVkOwogICAgICBvcHRpb25zLnRyYWNrc1tpXSA9IHRyYWNrOwogICAgfQoKICAgIHJldHVybiBvcHRpb25zOwogIH07CgogIC8qKgogICAqIENyZWF0ZXMgYSBzaW1wbGUgbW9kYWwgZGlhbG9nIChhbiBpbnN0YW5jZSBvZiB0aGUgYE1vZGFsRGlhbG9nYAogICAqIGNvbXBvbmVudCkgdGhhdCBpbW1lZGlhdGVseSBvdmVybGF5cyB0aGUgcGxheWVyIHdpdGggYXJiaXRyYXJ5CiAgICogY29udGVudCBhbmQgcmVtb3ZlcyBpdHNlbGYgd2hlbiBjbG9zZWQuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbnxFbGVtZW50fEFycmF5fE51bGx9IGNvbnRlbnQKICAgKiAgICAgICAgU2FtZSBhcyBgTW9kYWxEaWFsb2cjY29udGVudGAncyBwYXJhbSBvZiB0aGUgc2FtZSBuYW1lLgogICAqCiAgICogICAgICAgIFRoZSBtb3N0IHN0cmFpZ2h0LWZvcndhcmQgdXNhZ2UgaXMgdG8gcHJvdmlkZSBhIHN0cmluZyBvciBET00KICAgKiAgICAgICAgZWxlbWVudC4KICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICAgKiAgICAgICAgRXh0cmEgb3B0aW9ucyB3aGljaCB3aWxsIGJlIHBhc3NlZCBvbiB0byB0aGUgYE1vZGFsRGlhbG9nYC4KICAgKgogICAqIEByZXR1cm4ge01vZGFsRGlhbG9nfQogICAqLwoKICBQbGF5ZXIucHJvdG90eXBlLmNyZWF0ZU1vZGFsID0gZnVuY3Rpb24gY3JlYXRlTW9kYWwoY29udGVudCwgb3B0aW9ucykgewogICAgdmFyIHBsYXllciA9IHRoaXM7CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICBvcHRpb25zLmNvbnRlbnQgPSBjb250ZW50IHx8ICcnOwoKICAgIHZhciBtb2RhbCA9IG5ldyBfbW9kYWxEaWFsb2cyWydkZWZhdWx0J10ocGxheWVyLCBvcHRpb25zKTsKCiAgICBwbGF5ZXIuYWRkQ2hpbGQobW9kYWwpOwogICAgbW9kYWwub24oJ2Rpc3Bvc2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHBsYXllci5yZW1vdmVDaGlsZChtb2RhbCk7CiAgICB9KTsKCiAgICByZXR1cm4gbW9kYWwub3BlbigpOwogIH07CgogIC8qKgogICAqIEdldHMgdGFnIHNldHRpbmdzCiAgICoKICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhZyBUaGUgcGxheWVyIHRhZwogICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiBzb3VyY2VzIGFuZCB0cmFjayBvYmplY3RzCiAgICogQHN0YXRpYwogICAqIEBtZXRob2QgZ2V0VGFnU2V0dGluZ3MKICAgKi8KCiAgUGxheWVyLmdldFRhZ1NldHRpbmdzID0gZnVuY3Rpb24gZ2V0VGFnU2V0dGluZ3ModGFnKSB7CiAgICB2YXIgYmFzZU9wdGlvbnMgPSB7CiAgICAgICdzb3VyY2VzJzogW10sCiAgICAgICd0cmFja3MnOiBbXQogICAgfTsKCiAgICB2YXIgdGFnT3B0aW9ucyA9IERvbS5nZXRFbEF0dHJpYnV0ZXModGFnKTsKICAgIHZhciBkYXRhU2V0dXAgPSB0YWdPcHRpb25zWydkYXRhLXNldHVwJ107CgogICAgLy8gQ2hlY2sgaWYgZGF0YS1zZXR1cCBhdHRyIGV4aXN0cy4KICAgIGlmIChkYXRhU2V0dXAgIT09IG51bGwpIHsKICAgICAgLy8gUGFyc2Ugb3B0aW9ucyBKU09OCgogICAgICB2YXIgX3NhZmVQYXJzZVR1cGxlID0gX3NhZmVKc29uUGFyc2VUdXBsZTJbJ2RlZmF1bHQnXShkYXRhU2V0dXAgfHwgJ3t9Jyk7CgogICAgICB2YXIgZXJyID0gX3NhZmVQYXJzZVR1cGxlWzBdOwogICAgICB2YXIgZGF0YSA9IF9zYWZlUGFyc2VUdXBsZVsxXTsKCiAgICAgIGlmIChlcnIpIHsKICAgICAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS5lcnJvcihlcnIpOwogICAgICB9CiAgICAgIF9vYmplY3RBc3NpZ24yWydkZWZhdWx0J10odGFnT3B0aW9ucywgZGF0YSk7CiAgICB9CgogICAgX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXShiYXNlT3B0aW9ucywgdGFnT3B0aW9ucyk7CgogICAgLy8gR2V0IHRhZyBjaGlsZHJlbiBzZXR0aW5ncwogICAgaWYgKHRhZy5oYXNDaGlsZE5vZGVzKCkpIHsKICAgICAgdmFyIGNoaWxkcmVuID0gdGFnLmNoaWxkTm9kZXM7CgogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldOwogICAgICAgIC8vIENoYW5nZSBjYXNlIG5lZWRlZDogaHR0cDovL2Vqb2huLm9yZy9ibG9nL25vZGVuYW1lLWNhc2Utc2Vuc2l0aXZpdHkvCiAgICAgICAgdmFyIGNoaWxkTmFtZSA9IGNoaWxkLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaWYgKGNoaWxkTmFtZSA9PT0gJ3NvdXJjZScpIHsKICAgICAgICAgIGJhc2VPcHRpb25zLnNvdXJjZXMucHVzaChEb20uZ2V0RWxBdHRyaWJ1dGVzKGNoaWxkKSk7CiAgICAgICAgfSBlbHNlIGlmIChjaGlsZE5hbWUgPT09ICd0cmFjaycpIHsKICAgICAgICAgIGJhc2VPcHRpb25zLnRyYWNrcy5wdXNoKERvbS5nZXRFbEF0dHJpYnV0ZXMoY2hpbGQpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYmFzZU9wdGlvbnM7CiAgfTsKCiAgcmV0dXJuIFBsYXllcjsKfSkoX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddKTsKClBsYXllci5wbGF5ZXJzID0ge307Cgp2YXIgbmF2aWdhdG9yID0gX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5uYXZpZ2F0b3I7Ci8qCiAqIFBsYXllciBpbnN0YW5jZSBvcHRpb25zLCBzdXJmYWNlZCB1c2luZyBvcHRpb25zCiAqIG9wdGlvbnMgPSBQbGF5ZXIucHJvdG90eXBlLm9wdGlvbnNfCiAqIE1ha2UgY2hhbmdlcyBpbiBvcHRpb25zLCBub3QgaGVyZS4KICoKICogQHR5cGUge09iamVjdH0KICogQHByaXZhdGUKICovClBsYXllci5wcm90b3R5cGUub3B0aW9uc18gPSB7CiAgLy8gRGVmYXVsdCBvcmRlciBvZiBmYWxsYmFjayB0ZWNobm9sb2d5CiAgdGVjaE9yZGVyOiBbJ2h0bWw1JywgJ2ZsYXNoJ10sCiAgLy8gdGVjaE9yZGVyOiBbJ2ZsYXNoJywnaHRtbDUnXSwKCiAgaHRtbDU6IHt9LAogIGZsYXNoOiB7fSwKCiAgLy8gZGVmYXVsdFZvbHVtZTogMC44NSwKICBkZWZhdWx0Vm9sdW1lOiAwLjAwLCAvLyBUaGUgZnJlYWtpbiBzZWFndWxzIGFyZSBkcml2aW5nIG1lIGNyYXp5IQoKICAvLyBkZWZhdWx0IGluYWN0aXZpdHkgdGltZW91dAogIGluYWN0aXZpdHlUaW1lb3V0OiAyMDAwLAoKICAvLyBkZWZhdWx0IHBsYXliYWNrIHJhdGVzCiAgcGxheWJhY2tSYXRlczogW10sCiAgLy8gQWRkIHBsYXliYWNrIHJhdGUgc2VsZWN0aW9uIGJ5IGFkZGluZyByYXRlcwogIC8vICdwbGF5YmFja1JhdGVzJzogWzAuNSwgMSwgMS41LCAyXSwKCiAgLy8gSW5jbHVkZWQgY29udHJvbCBzZXRzCiAgY2hpbGRyZW46IFsnbWVkaWFMb2FkZXInLCAncG9zdGVySW1hZ2UnLCAndGV4dFRyYWNrRGlzcGxheScsICdsb2FkaW5nU3Bpbm5lcicsICdiaWdQbGF5QnV0dG9uJywgJ2NvbnRyb2xCYXInLCAnZXJyb3JEaXNwbGF5JywgJ3RleHRUcmFja1NldHRpbmdzJ10sCgogIGxhbmd1YWdlOiBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2h0bWwnKVswXS5nZXRBdHRyaWJ1dGUoJ2xhbmcnKSB8fCBuYXZpZ2F0b3IubGFuZ3VhZ2VzICYmIG5hdmlnYXRvci5sYW5ndWFnZXNbMF0gfHwgbmF2aWdhdG9yLnVzZXJMYW5ndWFnZSB8fCBuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgJ2VuJywKCiAgLy8gbG9jYWxlcyBhbmQgdGhlaXIgbGFuZ3VhZ2UgdHJhbnNsYXRpb25zCiAgbGFuZ3VhZ2VzOiB7fSwKCiAgLy8gRGVmYXVsdCBtZXNzYWdlIHRvIHNob3cgd2hlbiBhIHZpZGVvIGNhbm5vdCBiZSBwbGF5ZWQuCiAgbm90U3VwcG9ydGVkTWVzc2FnZTogJ05vIGNvbXBhdGlibGUgc291cmNlIHdhcyBmb3VuZCBmb3IgdGhpcyB2aWRlby4nCn07CgovKioKICogRmlyZWQgd2hlbiB0aGUgcGxheWVyIGhhcyBpbml0aWFsIGR1cmF0aW9uIGFuZCBkaW1lbnNpb24gaW5mb3JtYXRpb24KICoKICogQGV2ZW50IGxvYWRlZG1ldGFkYXRhCiAqLwpQbGF5ZXIucHJvdG90eXBlLmhhbmRsZUxvYWRlZE1ldGFEYXRhXzsKCi8qKgogKiBGaXJlZCB3aGVuIHRoZSBwbGF5ZXIgaGFzIGRvd25sb2FkZWQgZGF0YSBhdCB0aGUgY3VycmVudCBwbGF5YmFjayBwb3NpdGlvbgogKgogKiBAZXZlbnQgbG9hZGVkZGF0YQogKi8KUGxheWVyLnByb3RvdHlwZS5oYW5kbGVMb2FkZWREYXRhXzsKCi8qKgogKiBGaXJlZCB3aGVuIHRoZSB1c2VyIGlzIGFjdGl2ZSwgZS5nLiBtb3ZlcyB0aGUgbW91c2Ugb3ZlciB0aGUgcGxheWVyCiAqCiAqIEBldmVudCB1c2VyYWN0aXZlCiAqLwpQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVVzZXJBY3RpdmVfOwoKLyoqCiAqIEZpcmVkIHdoZW4gdGhlIHVzZXIgaXMgaW5hY3RpdmUsIGUuZy4gYSBzaG9ydCBkZWxheSBhZnRlciB0aGUgbGFzdCBtb3VzZSBtb3ZlIG9yIGNvbnRyb2wgaW50ZXJhY3Rpb24KICoKICogQGV2ZW50IHVzZXJpbmFjdGl2ZQogKi8KUGxheWVyLnByb3RvdHlwZS5oYW5kbGVVc2VySW5hY3RpdmVfOwoKLyoqCiAqIEZpcmVkIHdoZW4gdGhlIGN1cnJlbnQgcGxheWJhY2sgcG9zaXRpb24gaGFzIGNoYW5nZWQgKgogKiBEdXJpbmcgcGxheWJhY2sgdGhpcyBpcyBmaXJlZCBldmVyeSAxNS0yNTAgbWlsbGlzZWNvbmRzLCBkZXBlbmRpbmcgb24gdGhlCiAqIHBsYXliYWNrIHRlY2hub2xvZ3kgaW4gdXNlLgogKgogKiBAZXZlbnQgdGltZXVwZGF0ZQogKi8KUGxheWVyLnByb3RvdHlwZS5oYW5kbGVUaW1lVXBkYXRlXzsKCi8qKgogKiBGaXJlZCB3aGVuIHZpZGVvIHBsYXliYWNrIGVuZHMKICoKICogQGV2ZW50IGVuZGVkCiAqLwpQbGF5ZXIucHJvdG90eXBlLmhhbmRsZVRlY2hFbmRlZF87CgovKioKICogRmlyZWQgd2hlbiB0aGUgdm9sdW1lIGNoYW5nZXMKICoKICogQGV2ZW50IHZvbHVtZWNoYW5nZQogKi8KUGxheWVyLnByb3RvdHlwZS5oYW5kbGVWb2x1bWVDaGFuZ2VfOwoKLyoqCiAqIEZpcmVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzCiAqCiAqIEBldmVudCBlcnJvcgogKi8KUGxheWVyLnByb3RvdHlwZS5oYW5kbGVFcnJvcl87CgpQbGF5ZXIucHJvdG90eXBlLmZsZXhOb3RTdXBwb3J0ZWRfID0gZnVuY3Rpb24gKCkgewogIHZhciBlbGVtID0gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ2knKTsKCiAgLy8gTm90ZTogV2UgZG9uJ3QgYWN0dWFsbHkgdXNlIGZsZXhCYXNpcyAob3IgZmxleE9yZGVyKSwgYnV0IGl0J3Mgb25lIG9mIHRoZSBtb3JlCiAgLy8gY29tbW9uIGZsZXggZmVhdHVyZXMgdGhhdCB3ZSBjYW4gcmVseSBvbiB3aGVuIGNoZWNraW5nIGZvciBmbGV4IHN1cHBvcnQuCiAgcmV0dXJuICEoJ2ZsZXhCYXNpcycgaW4gZWxlbS5zdHlsZSB8fCAnd2Via2l0RmxleEJhc2lzJyBpbiBlbGVtLnN0eWxlIHx8ICdtb3pGbGV4QmFzaXMnIGluIGVsZW0uc3R5bGUgfHwgJ21zRmxleEJhc2lzJyBpbiBlbGVtLnN0eWxlIHx8ICdtc0ZsZXhPcmRlcicgaW4gZWxlbS5zdHlsZSkgLyogSUUxMC1zcGVjaWZpYyAoMjAxMiBmbGV4IHNwZWMpICAqLzsKfTsKCl9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnUGxheWVyJywgUGxheWVyKTsKZXhwb3J0c1snZGVmYXVsdCddID0gUGxheWVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKLy8gSWYgZW1wdHkgc3RyaW5nLCBtYWtlIGl0IGEgcGFyc2FibGUganNvbiBvYmplY3QuCgp9LHsiLi9iaWctcGxheS1idXR0b24uanMiOjYyLCIuL2NvbXBvbmVudC5qcyI6NjUsIi4vY29udHJvbC1iYXIvY29udHJvbC1iYXIuanMiOjY2LCIuL2Vycm9yLWRpc3BsYXkuanMiOjk2LCIuL2Z1bGxzY3JlZW4tYXBpLmpzIjo5OSwiLi9sb2FkaW5nLXNwaW5uZXIuanMiOjEwMCwiLi9tZWRpYS1lcnJvci5qcyI6MTAxLCIuL21vZGFsLWRpYWxvZyI6MTA1LCIuL3Bvc3Rlci1pbWFnZS5qcyI6MTA4LCIuL3RlY2gvaHRtbDUuanMiOjExMywiLi90ZWNoL2xvYWRlci5qcyI6MTE0LCIuL3RlY2gvdGVjaC5qcyI6MTE1LCIuL3RyYWNrcy90ZXh0LXRyYWNrLWRpc3BsYXkuanMiOjExOSwiLi90cmFja3MvdGV4dC10cmFjay1saXN0LWNvbnZlcnRlci5qcyI6MTIxLCIuL3RyYWNrcy90ZXh0LXRyYWNrLXNldHRpbmdzLmpzIjoxMjMsIi4vdXRpbHMvYnJvd3Nlci5qcyI6MTI1LCIuL3V0aWxzL2J1ZmZlci5qcyI6MTI2LCIuL3V0aWxzL2RvbS5qcyI6MTI4LCIuL3V0aWxzL2V2ZW50cy5qcyI6MTI5LCIuL3V0aWxzL2ZuLmpzIjoxMzAsIi4vdXRpbHMvZ3VpZC5qcyI6MTMyLCIuL3V0aWxzL2xvZy5qcyI6MTMzLCIuL3V0aWxzL21lcmdlLW9wdGlvbnMuanMiOjEzNCwiLi91dGlscy9zdHlsZXNoZWV0LmpzIjoxMzUsIi4vdXRpbHMvdGltZS1yYW5nZXMuanMiOjEzNiwiLi91dGlscy90by10aXRsZS1jYXNlLmpzIjoxMzcsImdsb2JhbC9kb2N1bWVudCI6MSwiZ2xvYmFsL3dpbmRvdyI6Miwib2JqZWN0LmFzc2lnbiI6NDUsInNhZmUtanNvbi1wYXJzZS90dXBsZSI6NTN9XSwxMDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgcGx1Z2lucy5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfcGxheWVySnMgPSBfZGVyZXFfKCcuL3BsYXllci5qcycpOwoKdmFyIF9wbGF5ZXJKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbGF5ZXJKcyk7CgovKioKICogVGhlIG1ldGhvZCBmb3IgcmVnaXN0ZXJpbmcgYSB2aWRlby5qcyBwbHVnaW4KICoKICogQHBhcmFtICB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBwbHVnaW4KICogQHBhcmFtICB7RnVuY3Rpb259IGluaXQgVGhlIGZ1bmN0aW9uIHRoYXQgaXMgcnVuIHdoZW4gdGhlIHBsYXllciBpbml0cwogKiBAbWV0aG9kIHBsdWdpbgogKi8KdmFyIHBsdWdpbiA9IGZ1bmN0aW9uIHBsdWdpbihuYW1lLCBpbml0KSB7CiAgX3BsYXllckpzMlsnZGVmYXVsdCddLnByb3RvdHlwZVtuYW1lXSA9IGluaXQ7Cn07CgpleHBvcnRzWydkZWZhdWx0J10gPSBwbHVnaW47Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vcGxheWVyLmpzIjoxMDZ9XSwxMDg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgcG9zdGVyLWltYWdlLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfYnV0dG9uSnMgPSBfZGVyZXFfKCcuL2J1dHRvbi5qcycpOwoKdmFyIF9idXR0b25KczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9idXR0b25Kcyk7Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0Jyb3dzZXJKcyA9IF9kZXJlcV8oJy4vdXRpbHMvYnJvd3Nlci5qcycpOwoKdmFyIGJyb3dzZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNCcm93c2VySnMpOwoKLyoqCiAqIFRoZSBjb21wb25lbnQgdGhhdCBoYW5kbGVzIHNob3dpbmcgdGhlIHBvc3RlciBpbWFnZS4KICoKICogQHBhcmFtIHtQbGF5ZXJ8T2JqZWN0fSBwbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zCiAqIEBleHRlbmRzIEJ1dHRvbgogKiBAY2xhc3MgUG9zdGVySW1hZ2UKICovCgp2YXIgUG9zdGVySW1hZ2UgPSAoZnVuY3Rpb24gKF9CdXR0b24pIHsKICBfaW5oZXJpdHMoUG9zdGVySW1hZ2UsIF9CdXR0b24pOwoKICBmdW5jdGlvbiBQb3N0ZXJJbWFnZShwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb3N0ZXJJbWFnZSk7CgogICAgX0J1dHRvbi5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CgogICAgdGhpcy51cGRhdGUoKTsKICAgIHBsYXllci5vbigncG9zdGVyY2hhbmdlJywgRm4uYmluZCh0aGlzLCB0aGlzLnVwZGF0ZSkpOwogIH0KCiAgLyoqCiAgICogQ2xlYW4gdXAgdGhlIHBvc3RlciBpbWFnZQogICAqCiAgICogQG1ldGhvZCBkaXNwb3NlCiAgICovCgogIFBvc3RlckltYWdlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgIHRoaXMucGxheWVyKCkub2ZmKCdwb3N0ZXJjaGFuZ2UnLCB0aGlzLnVwZGF0ZSk7CiAgICBfQnV0dG9uLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBwb3N0ZXIncyBpbWFnZSBlbGVtZW50CiAgICoKICAgKiBAcmV0dXJuIHtFbGVtZW50fQogICAqIEBtZXRob2QgY3JlYXRlRWwKICAgKi8KCiAgUG9zdGVySW1hZ2UucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICB2YXIgZWwgPSBEb20uY3JlYXRlRWwoJ2RpdicsIHsKICAgICAgY2xhc3NOYW1lOiAndmpzLXBvc3RlcicsCgogICAgICAvLyBEb24ndCB3YW50IHBvc3RlciB0byBiZSB0YWJiYWJsZS4KICAgICAgdGFiSW5kZXg6IC0xCiAgICB9KTsKCiAgICAvLyBUbyBlbnN1cmUgdGhlIHBvc3RlciBpbWFnZSByZXNpemVzIHdoaWxlIG1haW50YWluaW5nIGl0cyBvcmlnaW5hbCBhc3BlY3QKICAgIC8vIHJhdGlvLCB1c2UgYSBkaXYgd2l0aCBgYmFja2dyb3VuZC1zaXplYCB3aGVuIGF2YWlsYWJsZS4gRm9yIGJyb3dzZXJzIHRoYXQKICAgIC8vIGRvIG5vdCBzdXBwb3J0IGBiYWNrZ3JvdW5kLXNpemVgIChlLmcuIElFOCksIGZhbGwgYmFjayBvbiB1c2luZyBhIHJlZ3VsYXIKICAgIC8vIGltZyBlbGVtZW50LgogICAgaWYgKCFicm93c2VyLkJBQ0tHUk9VTkRfU0laRV9TVVBQT1JURUQpIHsKICAgICAgdGhpcy5mYWxsYmFja0ltZ18gPSBEb20uY3JlYXRlRWwoJ2ltZycpOwogICAgICBlbC5hcHBlbmRDaGlsZCh0aGlzLmZhbGxiYWNrSW1nXyk7CiAgICB9CgogICAgcmV0dXJuIGVsOwogIH07CgogIC8qKgogICAqIEV2ZW50IGhhbmRsZXIgZm9yIHVwZGF0ZXMgdG8gdGhlIHBsYXllcidzIHBvc3RlciBzb3VyY2UKICAgKgogICAqIEBtZXRob2QgdXBkYXRlCiAgICovCgogIFBvc3RlckltYWdlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICB2YXIgdXJsID0gdGhpcy5wbGF5ZXIoKS5wb3N0ZXIoKTsKCiAgICB0aGlzLnNldFNyYyh1cmwpOwoKICAgIC8vIElmIHRoZXJlJ3Mgbm8gcG9zdGVyIHNvdXJjZSB3ZSBzaG91bGQgZGlzcGxheTpub25lIG9uIHRoaXMgY29tcG9uZW50CiAgICAvLyBzbyBpdCdzIG5vdCBzdGlsbCBjbGlja2FibGUgb3IgcmlnaHQtY2xpY2thYmxlCiAgICBpZiAodXJsKSB7CiAgICAgIHRoaXMuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5oaWRlKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogU2V0IHRoZSBwb3N0ZXIgc291cmNlIGRlcGVuZGluZyBvbiB0aGUgZGlzcGxheSBtZXRob2QKICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIFVSTCB0byB0aGUgcG9zdGVyIHNvdXJjZQogICAqIEBtZXRob2Qgc2V0U3JjCiAgICovCgogIFBvc3RlckltYWdlLnByb3RvdHlwZS5zZXRTcmMgPSBmdW5jdGlvbiBzZXRTcmModXJsKSB7CiAgICBpZiAodGhpcy5mYWxsYmFja0ltZ18pIHsKICAgICAgdGhpcy5mYWxsYmFja0ltZ18uc3JjID0gdXJsOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGJhY2tncm91bmRJbWFnZSA9ICcnOwogICAgICAvLyBBbnkgZmFsc2V5IHZhbHVlcyBzaG91bGQgc3RheSBhcyBhbiBlbXB0eSBzdHJpbmcsIG90aGVyd2lzZQogICAgICAvLyB0aGlzIHdpbGwgdGhyb3cgYW4gZXh0cmEgZXJyb3IKICAgICAgaWYgKHVybCkgewogICAgICAgIGJhY2tncm91bmRJbWFnZSA9ICd1cmwoIicgKyB1cmwgKyAnIiknOwogICAgICB9CgogICAgICB0aGlzLmVsXy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBiYWNrZ3JvdW5kSW1hZ2U7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogRXZlbnQgaGFuZGxlciBmb3IgY2xpY2tzIG9uIHRoZSBwb3N0ZXIgaW1hZ2UKICAgKgogICAqIEBtZXRob2QgaGFuZGxlQ2xpY2sKICAgKi8KCiAgUG9zdGVySW1hZ2UucHJvdG90eXBlLmhhbmRsZUNsaWNrID0gZnVuY3Rpb24gaGFuZGxlQ2xpY2soKSB7CiAgICAvLyBXZSBkb24ndCB3YW50IGEgY2xpY2sgdG8gdHJpZ2dlciBwbGF5YmFjayB3aGVuIGNvbnRyb2xzIGFyZSBkaXNhYmxlZAogICAgLy8gYnV0IENTUyBzaG91bGQgYmUgaGlkaW5nIHRoZSBwb3N0ZXIgdG8gcHJldmVudCB0aGF0IGZyb20gaGFwcGVuaW5nCiAgICBpZiAodGhpcy5wbGF5ZXJfLnBhdXNlZCgpKSB7CiAgICAgIHRoaXMucGxheWVyXy5wbGF5KCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnBsYXllcl8ucGF1c2UoKTsKICAgIH0KICB9OwoKICByZXR1cm4gUG9zdGVySW1hZ2U7Cn0pKF9idXR0b25KczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1Bvc3RlckltYWdlJywgUG9zdGVySW1hZ2UpOwpleHBvcnRzWydkZWZhdWx0J10gPSBQb3N0ZXJJbWFnZTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9idXR0b24uanMiOjYzLCIuL2NvbXBvbmVudC5qcyI6NjUsIi4vdXRpbHMvYnJvd3Nlci5qcyI6MTI1LCIuL3V0aWxzL2RvbS5qcyI6MTI4LCIuL3V0aWxzL2ZuLmpzIjoxMzB9XSwxMDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgc2V0dXAuanMKICoKICogRnVuY3Rpb25zIGZvciBhdXRvbWF0aWNhbGx5IHNldHRpbmcgdXAgYSBwbGF5ZXIKICogYmFzZWQgb24gdGhlIGRhdGEtc2V0dXAgYXR0cmlidXRlIG9mIHRoZSB2aWRlbyB0YWcKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKdmFyIF91dGlsc0V2ZW50c0pzID0gX2RlcmVxXygnLi91dGlscy9ldmVudHMuanMnKTsKCnZhciBFdmVudHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNFdmVudHNKcyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCnZhciBfZ2xvYmFsV2luZG93ID0gX2RlcmVxXygnZ2xvYmFsL3dpbmRvdycpOwoKdmFyIF9nbG9iYWxXaW5kb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsV2luZG93KTsKCnZhciBfd2luZG93TG9hZGVkID0gZmFsc2U7CnZhciB2aWRlb2pzID0gdW5kZWZpbmVkOwoKLy8gQXV0b21hdGljYWxseSBzZXQgdXAgYW55IHRhZ3MgdGhhdCBoYXZlIGEgZGF0YS1zZXR1cCBhdHRyaWJ1dGUKdmFyIGF1dG9TZXR1cCA9IGZ1bmN0aW9uIGF1dG9TZXR1cCgpIHsKICAvLyBPbmUgZGF5LCB3aGVuIHdlIHN0b3Agc3VwcG9ydGluZyBJRTgsIGdvIGJhY2sgdG8gdGhpcywgYnV0IGluIHRoZSBtZWFudGltZS4uLipoYWNrIGhhY2sgaGFjayoKICAvLyB2YXIgdmlkcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd2aWRlbycpKTsKICAvLyB2YXIgYXVkaW9zID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2F1ZGlvJykpOwogIC8vIHZhciBtZWRpYUVscyA9IHZpZHMuY29uY2F0KGF1ZGlvcyk7CgogIC8vIEJlY2F1c2UgSUU4IGRvZXNuJ3Qgc3VwcG9ydCBjYWxsaW5nIHNsaWNlIG9uIGEgbm9kZSBsaXN0LCB3ZSBuZWVkIHRvIGxvb3AgdGhyb3VnaCBlYWNoIGxpc3Qgb2YgZWxlbWVudHMKICAvLyB0byBidWlsZCB1cCBhIG5ldywgY29tYmluZWQgbGlzdCBvZiBlbGVtZW50cy4KICB2YXIgdmlkcyA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndmlkZW8nKTsKICB2YXIgYXVkaW9zID0gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhdWRpbycpOwogIHZhciBtZWRpYUVscyA9IFtdOwogIGlmICh2aWRzICYmIHZpZHMubGVuZ3RoID4gMCkgewogICAgZm9yICh2YXIgaSA9IDAsIGUgPSB2aWRzLmxlbmd0aDsgaSA8IGU7IGkrKykgewogICAgICBtZWRpYUVscy5wdXNoKHZpZHNbaV0pOwogICAgfQogIH0KICBpZiAoYXVkaW9zICYmIGF1ZGlvcy5sZW5ndGggPiAwKSB7CiAgICBmb3IgKHZhciBpID0gMCwgZSA9IGF1ZGlvcy5sZW5ndGg7IGkgPCBlOyBpKyspIHsKICAgICAgbWVkaWFFbHMucHVzaChhdWRpb3NbaV0pOwogICAgfQogIH0KCiAgLy8gQ2hlY2sgaWYgYW55IG1lZGlhIGVsZW1lbnRzIGV4aXN0CiAgaWYgKG1lZGlhRWxzICYmIG1lZGlhRWxzLmxlbmd0aCA+IDApIHsKCiAgICBmb3IgKHZhciBpID0gMCwgZSA9IG1lZGlhRWxzLmxlbmd0aDsgaSA8IGU7IGkrKykgewogICAgICB2YXIgbWVkaWFFbCA9IG1lZGlhRWxzW2ldOwoKICAgICAgLy8gQ2hlY2sgaWYgZWxlbWVudCBleGlzdHMsIGhhcyBnZXRBdHRyaWJ1dGUgZnVuYy4KICAgICAgLy8gSUUgc2VlbXMgdG8gY29uc2lkZXIgdHlwZW9mIGVsLmdldEF0dHJpYnV0ZSA9PSAnb2JqZWN0JyBpbnN0ZWFkIG9mICdmdW5jdGlvbicgbGlrZSBleHBlY3RlZCwgYXQgbGVhc3Qgd2hlbiBsb2FkaW5nIHRoZSBwbGF5ZXIgaW1tZWRpYXRlbHkuCiAgICAgIGlmIChtZWRpYUVsICYmIG1lZGlhRWwuZ2V0QXR0cmlidXRlKSB7CgogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIHBsYXllciBoYXNuJ3QgYWxyZWFkeSBiZWVuIHNldCB1cC4KICAgICAgICBpZiAobWVkaWFFbFsncGxheWVyJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdmFyIG9wdGlvbnMgPSBtZWRpYUVsLmdldEF0dHJpYnV0ZSgnZGF0YS1zZXR1cCcpOwoKICAgICAgICAgIC8vIENoZWNrIGlmIGRhdGEtc2V0dXAgYXR0ciBleGlzdHMuCiAgICAgICAgICAvLyBXZSBvbmx5IGF1dG8tc2V0dXAgaWYgdGhleSd2ZSBhZGRlZCB0aGUgZGF0YS1zZXR1cCBhdHRyLgogICAgICAgICAgaWYgKG9wdGlvbnMgIT09IG51bGwpIHsKICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyB2aWRlby5qcyBpbnN0YW5jZS4KICAgICAgICAgICAgdmFyIHBsYXllciA9IHZpZGVvanMobWVkaWFFbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBJZiBnZXRBdHRyaWJ1dGUgaXNuJ3QgZGVmaW5lZCwgd2UgbmVlZCB0byB3YWl0IGZvciB0aGUgRE9NLgogICAgICB9IGVsc2UgewogICAgICAgICAgYXV0b1NldHVwVGltZW91dCgxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBObyB2aWRlb3Mgd2VyZSBmb3VuZCwgc28ga2VlcCBsb29waW5nIHVubGVzcyBwYWdlIGlzIGZpbmlzaGVkIGxvYWRpbmcuCiAgfSBlbHNlIGlmICghX3dpbmRvd0xvYWRlZCkgewogICAgICBhdXRvU2V0dXBUaW1lb3V0KDEpOwogICAgfQp9OwoKLy8gUGF1c2UgdG8gbGV0IHRoZSBET00ga2VlcCBwcm9jZXNzaW5nCnZhciBhdXRvU2V0dXBUaW1lb3V0ID0gZnVuY3Rpb24gYXV0b1NldHVwVGltZW91dCh3YWl0LCB2anMpIHsKICB2aWRlb2pzID0gdmpzOwogIHNldFRpbWVvdXQoYXV0b1NldHVwLCB3YWl0KTsKfTsKCmlmIChfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10ucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykgewogIF93aW5kb3dMb2FkZWQgPSB0cnVlOwp9IGVsc2UgewogIEV2ZW50cy5vbmUoX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXSwgJ2xvYWQnLCBmdW5jdGlvbiAoKSB7CiAgICBfd2luZG93TG9hZGVkID0gdHJ1ZTsKICB9KTsKfQoKdmFyIGhhc0xvYWRlZCA9IGZ1bmN0aW9uIGhhc0xvYWRlZCgpIHsKICByZXR1cm4gX3dpbmRvd0xvYWRlZDsKfTsKCmV4cG9ydHMuYXV0b1NldHVwID0gYXV0b1NldHVwOwpleHBvcnRzLmF1dG9TZXR1cFRpbWVvdXQgPSBhdXRvU2V0dXBUaW1lb3V0OwpleHBvcnRzLmhhc0xvYWRlZCA9IGhhc0xvYWRlZDsKCn0seyIuL3V0aWxzL2V2ZW50cy5qcyI6MTI5LCJnbG9iYWwvZG9jdW1lbnQiOjEsImdsb2JhbC93aW5kb3ciOjJ9XSwxMTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgc2xpZGVyLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50SnMgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQuanMnKTsKCnZhciBfY29tcG9uZW50SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50SnMpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgX29iamVjdEFzc2lnbiA9IF9kZXJlcV8oJ29iamVjdC5hc3NpZ24nKTsKCnZhciBfb2JqZWN0QXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdEFzc2lnbik7CgovKioKICogVGhlIGJhc2UgZnVuY3Rpb25hbGl0eSBmb3Igc2xpZGVycyBsaWtlIHRoZSB2b2x1bWUgYmFyIGFuZCBzZWVrIGJhcgogKgogKiBAcGFyYW0ge1BsYXllcnxPYmplY3R9IHBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMKICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBTbGlkZXIKICovCgp2YXIgU2xpZGVyID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFNsaWRlciwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFNsaWRlcihwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGlkZXIpOwoKICAgIF9Db21wb25lbnQuY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMpOwoKICAgIC8vIFNldCBwcm9wZXJ0eSBuYW1lcyB0byBiYXIgdG8gbWF0Y2ggd2l0aCB0aGUgY2hpbGQgU2xpZGVyIGNsYXNzIGlzIGxvb2tpbmcgZm9yCiAgICB0aGlzLmJhciA9IHRoaXMuZ2V0Q2hpbGQodGhpcy5vcHRpb25zXy5iYXJOYW1lKTsKCiAgICAvLyBTZXQgYSBob3Jpem9udGFsIG9yIHZlcnRpY2FsIGNsYXNzIG9uIHRoZSBzbGlkZXIgZGVwZW5kaW5nIG9uIHRoZSBzbGlkZXIgdHlwZQogICAgdGhpcy52ZXJ0aWNhbCghIXRoaXMub3B0aW9uc18udmVydGljYWwpOwoKICAgIHRoaXMub24oJ21vdXNlZG93bicsIHRoaXMuaGFuZGxlTW91c2VEb3duKTsKICAgIHRoaXMub24oJ3RvdWNoc3RhcnQnLCB0aGlzLmhhbmRsZU1vdXNlRG93bik7CiAgICB0aGlzLm9uKCdmb2N1cycsIHRoaXMuaGFuZGxlRm9jdXMpOwogICAgdGhpcy5vbignYmx1cicsIHRoaXMuaGFuZGxlQmx1cik7CiAgICB0aGlzLm9uKCdjbGljaycsIHRoaXMuaGFuZGxlQ2xpY2spOwoKICAgIHRoaXMub24ocGxheWVyLCAnY29udHJvbHN2aXNpYmxlJywgdGhpcy51cGRhdGUpOwogICAgdGhpcy5vbihwbGF5ZXIsIHRoaXMucGxheWVyRXZlbnQsIHRoaXMudXBkYXRlKTsKICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFR5cGUgb2YgZWxlbWVudCB0byBjcmVhdGUKICAgKiBAcGFyYW0ge09iamVjdD19IHByb3BzIExpc3Qgb2YgcHJvcGVydGllcyBpbiBPYmplY3QgZm9ybQogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBTbGlkZXIucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwodHlwZSkgewogICAgdmFyIHByb3BzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CiAgICB2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzJdOwoKICAgIC8vIEFkZCB0aGUgc2xpZGVyIGVsZW1lbnQgY2xhc3MgdG8gYWxsIHN1YiBjbGFzc2VzCiAgICBwcm9wcy5jbGFzc05hbWUgPSBwcm9wcy5jbGFzc05hbWUgKyAnIHZqcy1zbGlkZXInOwogICAgcHJvcHMgPSBfb2JqZWN0QXNzaWduMlsnZGVmYXVsdCddKHsKICAgICAgdGFiSW5kZXg6IDAKICAgIH0sIHByb3BzKTsKCiAgICBhdHRyaWJ1dGVzID0gX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXSh7CiAgICAgICdyb2xlJzogJ3NsaWRlcicsCiAgICAgICdhcmlhLXZhbHVlbm93JzogMCwKICAgICAgJ2FyaWEtdmFsdWVtaW4nOiAwLAogICAgICAnYXJpYS12YWx1ZW1heCc6IDEwMCwKICAgICAgdGFiSW5kZXg6IDAKICAgIH0sIGF0dHJpYnV0ZXMpOwoKICAgIHJldHVybiBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsIHR5cGUsIHByb3BzLCBhdHRyaWJ1dGVzKTsKICB9OwoKICAvKioKICAgKiBIYW5kbGUgbW91c2UgZG93biBvbiBzbGlkZXIKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudCBNb3VzZSBkb3duIGV2ZW50IG9iamVjdAogICAqIEBtZXRob2QgaGFuZGxlTW91c2VEb3duCiAgICovCgogIFNsaWRlci5wcm90b3R5cGUuaGFuZGxlTW91c2VEb3duID0gZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duKGV2ZW50KSB7CiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgRG9tLmJsb2NrVGV4dFNlbGVjdGlvbigpOwoKICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1zbGlkaW5nJyk7CiAgICB0aGlzLnRyaWdnZXIoJ3NsaWRlcmFjdGl2ZScpOwoKICAgIHRoaXMub24oX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAnbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU1vdmUpOwogICAgdGhpcy5vbihfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10sICdtb3VzZXVwJywgdGhpcy5oYW5kbGVNb3VzZVVwKTsKICAgIHRoaXMub24oX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU1vdmUpOwogICAgdGhpcy5vbihfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10sICd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlTW91c2VVcCk7CgogICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUoZXZlbnQpOwogIH07CgogIC8qKgogICAqIFRvIGJlIG92ZXJyaWRkZW4gYnkgYSBzdWJjbGFzcwogICAqCiAgICogQG1ldGhvZCBoYW5kbGVNb3VzZU1vdmUKICAgKi8KCiAgU2xpZGVyLnByb3RvdHlwZS5oYW5kbGVNb3VzZU1vdmUgPSBmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmUoKSB7fTsKCiAgLyoqCiAgICogSGFuZGxlIG1vdXNlIHVwIG9uIFNsaWRlcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVNb3VzZVVwCiAgICovCgogIFNsaWRlci5wcm90b3R5cGUuaGFuZGxlTW91c2VVcCA9IGZ1bmN0aW9uIGhhbmRsZU1vdXNlVXAoKSB7CiAgICBEb20udW5ibG9ja1RleHRTZWxlY3Rpb24oKTsKCiAgICB0aGlzLnJlbW92ZUNsYXNzKCd2anMtc2xpZGluZycpOwogICAgdGhpcy50cmlnZ2VyKCdzbGlkZXJpbmFjdGl2ZScpOwoKICAgIHRoaXMub2ZmKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXSwgJ21vdXNlbW92ZScsIHRoaXMuaGFuZGxlTW91c2VNb3ZlKTsKICAgIHRoaXMub2ZmKF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXSwgJ21vdXNldXAnLCB0aGlzLmhhbmRsZU1vdXNlVXApOwogICAgdGhpcy5vZmYoX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU1vdmUpOwogICAgdGhpcy5vZmYoX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAndG91Y2hlbmQnLCB0aGlzLmhhbmRsZU1vdXNlVXApOwoKICAgIHRoaXMudXBkYXRlKCk7CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIHNsaWRlcgogICAqCiAgICogQG1ldGhvZCB1cGRhdGUKICAgKi8KCiAgU2xpZGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAvLyBJbiBWb2x1bWVCYXIgaW5pdCB3ZSBoYXZlIGEgc2V0VGltZW91dCBmb3IgdXBkYXRlIHRoYXQgcG9wcyBhbmQgdXBkYXRlIHRvIHRoZSBlbmQgb2YgdGhlCiAgICAvLyBleGVjdXRpb24gc3RhY2suIFRoZSBwbGF5ZXIgaXMgZGVzdHJveWVkIGJlZm9yZSB0aGVuIHVwZGF0ZSB3aWxsIGNhdXNlIGFuIGVycm9yCiAgICBpZiAoIXRoaXMuZWxfKSByZXR1cm47CgogICAgLy8gSWYgc2NydWJiaW5nLCB3ZSBjb3VsZCB1c2UgYSBjYWNoZWQgdmFsdWUgdG8gbWFrZSB0aGUgaGFuZGxlIGtlZXAgdXAgd2l0aCB0aGUgdXNlcidzIG1vdXNlLgogICAgLy8gT24gSFRNTDUgYnJvd3NlcnMgc2NydWJiaW5nIGlzIHJlYWxseSBzbW9vdGgsIGJ1dCBzb21lIGZsYXNoIHBsYXllcnMgYXJlIHNsb3csIHNvIHdlIG1pZ2h0IHdhbnQgdG8gdXRpbGl6ZSB0aGlzIGxhdGVyLgogICAgLy8gdmFyIHByb2dyZXNzID0gICh0aGlzLnBsYXllcl8uc2NydWJiaW5nKCkpID8gdGhpcy5wbGF5ZXJfLmdldENhY2hlKCkuY3VycmVudFRpbWUgLyB0aGlzLnBsYXllcl8uZHVyYXRpb24oKSA6IHRoaXMucGxheWVyXy5jdXJyZW50VGltZSgpIC8gdGhpcy5wbGF5ZXJfLmR1cmF0aW9uKCk7CiAgICB2YXIgcHJvZ3Jlc3MgPSB0aGlzLmdldFBlcmNlbnQoKTsKICAgIHZhciBiYXIgPSB0aGlzLmJhcjsKCiAgICAvLyBJZiB0aGVyZSdzIG5vIGJhci4uLgogICAgaWYgKCFiYXIpIHJldHVybjsKCiAgICAvLyBQcm90ZWN0IGFnYWluc3Qgbm8gZHVyYXRpb24gYW5kIG90aGVyIGRpdmlzaW9uIGlzc3VlcwogICAgaWYgKHR5cGVvZiBwcm9ncmVzcyAhPT0gJ251bWJlcicgfHwgcHJvZ3Jlc3MgIT09IHByb2dyZXNzIHx8IHByb2dyZXNzIDwgMCB8fCBwcm9ncmVzcyA9PT0gSW5maW5pdHkpIHsKICAgICAgcHJvZ3Jlc3MgPSAwOwogICAgfQoKICAgIC8vIENvbnZlcnQgdG8gYSBwZXJjZW50YWdlIGZvciBzZXR0aW5nCiAgICB2YXIgcGVyY2VudGFnZSA9IChwcm9ncmVzcyAqIDEwMCkudG9GaXhlZCgyKSArICclJzsKCiAgICAvLyBTZXQgdGhlIG5ldyBiYXIgd2lkdGggb3IgaGVpZ2h0CiAgICBpZiAodGhpcy52ZXJ0aWNhbCgpKSB7CiAgICAgIGJhci5lbCgpLnN0eWxlLmhlaWdodCA9IHBlcmNlbnRhZ2U7CiAgICB9IGVsc2UgewogICAgICBiYXIuZWwoKS5zdHlsZS53aWR0aCA9IHBlcmNlbnRhZ2U7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQ2FsY3VsYXRlIGRpc3RhbmNlIGZvciBzbGlkZXIKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudCBFdmVudCBvYmplY3QKICAgKiBAbWV0aG9kIGNhbGN1bGF0ZURpc3RhbmNlCiAgICovCgogIFNsaWRlci5wcm90b3R5cGUuY2FsY3VsYXRlRGlzdGFuY2UgPSBmdW5jdGlvbiBjYWxjdWxhdGVEaXN0YW5jZShldmVudCkgewogICAgdmFyIHBvc2l0aW9uID0gRG9tLmdldFBvaW50ZXJQb3NpdGlvbih0aGlzLmVsXywgZXZlbnQpOwogICAgaWYgKHRoaXMudmVydGljYWwoKSkgewogICAgICByZXR1cm4gcG9zaXRpb24ueTsKICAgIH0KICAgIHJldHVybiBwb3NpdGlvbi54OwogIH07CgogIC8qKgogICAqIEhhbmRsZSBvbiBmb2N1cyBmb3Igc2xpZGVyCiAgICoKICAgKiBAbWV0aG9kIGhhbmRsZUZvY3VzCiAgICovCgogIFNsaWRlci5wcm90b3R5cGUuaGFuZGxlRm9jdXMgPSBmdW5jdGlvbiBoYW5kbGVGb2N1cygpIHsKICAgIHRoaXMub24oX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLCAna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5UHJlc3MpOwogIH07CgogIC8qKgogICAqIEhhbmRsZSBrZXkgcHJlc3MgZm9yIHNsaWRlcgogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IEV2ZW50IG9iamVjdAogICAqIEBtZXRob2QgaGFuZGxlS2V5UHJlc3MKICAgKi8KCiAgU2xpZGVyLnByb3RvdHlwZS5oYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uIGhhbmRsZUtleVByZXNzKGV2ZW50KSB7CiAgICBpZiAoZXZlbnQud2hpY2ggPT09IDM3IHx8IGV2ZW50LndoaWNoID09PSA0MCkgewogICAgICAvLyBMZWZ0IGFuZCBEb3duIEFycm93cwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLnN0ZXBCYWNrKCk7CiAgICB9IGVsc2UgaWYgKGV2ZW50LndoaWNoID09PSAzOCB8fCBldmVudC53aGljaCA9PT0gMzkpIHsKICAgICAgLy8gVXAgYW5kIFJpZ2h0IEFycm93cwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLnN0ZXBGb3J3YXJkKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogSGFuZGxlIG9uIGJsdXIgZm9yIHNsaWRlcgogICAqCiAgICogQG1ldGhvZCBoYW5kbGVCbHVyCiAgICovCgogIFNsaWRlci5wcm90b3R5cGUuaGFuZGxlQmx1ciA9IGZ1bmN0aW9uIGhhbmRsZUJsdXIoKSB7CiAgICB0aGlzLm9mZihfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10sICdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlQcmVzcyk7CiAgfTsKCiAgLyoqCiAgICogTGlzdGVuZXIgZm9yIGNsaWNrIGV2ZW50cyBvbiBzbGlkZXIsIHVzZWQgdG8gcHJldmVudCBjbGlja3MKICAgKiAgIGZyb20gYnViYmxpbmcgdXAgdG8gcGFyZW50IGVsZW1lbnRzIGxpa2UgYnV0dG9uIG1lbnVzLgogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IEV2ZW50IG9iamVjdAogICAqIEBtZXRob2QgaGFuZGxlQ2xpY2sKICAgKi8KCiAgU2xpZGVyLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50KSB7CiAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgfTsKCiAgLyoqCiAgICogR2V0L3NldCBpZiBzbGlkZXIgaXMgaG9yaXpvbnRhbCBmb3IgdmVydGljYWwKICAgKgogICAqIEBwYXJhbSB7Qm9vbGVhbn0gYm9vbCBUcnVlIGlmIHNsaWRlciBpcyB2ZXJ0aWNhbCwgZmFsc2UgaXMgaG9yaXpvbnRhbAogICAqIEByZXR1cm4ge0Jvb2xlYW59IFRydWUgaWYgc2xpZGVyIGlzIHZlcnRpY2FsLCBmYWxzZSBpcyBob3Jpem9udGFsCiAgICogQG1ldGhvZCB2ZXJ0aWNhbAogICAqLwoKICBTbGlkZXIucHJvdG90eXBlLnZlcnRpY2FsID0gZnVuY3Rpb24gdmVydGljYWwoYm9vbCkgewogICAgaWYgKGJvb2wgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpcy52ZXJ0aWNhbF8gfHwgZmFsc2U7CiAgICB9CgogICAgdGhpcy52ZXJ0aWNhbF8gPSAhIWJvb2w7CgogICAgaWYgKHRoaXMudmVydGljYWxfKSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1zbGlkZXItdmVydGljYWwnKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYWRkQ2xhc3MoJ3Zqcy1zbGlkZXItaG9yaXpvbnRhbCcpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CgogIHJldHVybiBTbGlkZXI7Cn0pKF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXSk7CgpfY29tcG9uZW50SnMyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ1NsaWRlcicsIFNsaWRlcik7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IFNsaWRlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vY29tcG9uZW50LmpzIjo2NSwiLi4vdXRpbHMvZG9tLmpzIjoxMjgsImdsb2JhbC9kb2N1bWVudCI6MSwib2JqZWN0LmFzc2lnbiI6NDV9XSwxMTE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgZmxhc2gtcnRtcC5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKZnVuY3Rpb24gRmxhc2hSdG1wRGVjb3JhdG9yKEZsYXNoKSB7CiAgRmxhc2guc3RyZWFtaW5nRm9ybWF0cyA9IHsKICAgICdydG1wL21wNCc6ICdNUDQnLAogICAgJ3J0bXAvZmx2JzogJ0ZMVicKICB9OwoKICBGbGFzaC5zdHJlYW1Gcm9tUGFydHMgPSBmdW5jdGlvbiAoY29ubmVjdGlvbiwgc3RyZWFtKSB7CiAgICByZXR1cm4gY29ubmVjdGlvbiArICcmJyArIHN0cmVhbTsKICB9OwoKICBGbGFzaC5zdHJlYW1Ub1BhcnRzID0gZnVuY3Rpb24gKHNyYykgewogICAgdmFyIHBhcnRzID0gewogICAgICBjb25uZWN0aW9uOiAnJywKICAgICAgc3RyZWFtOiAnJwogICAgfTsKCiAgICBpZiAoIXNyYykgcmV0dXJuIHBhcnRzOwoKICAgIC8vIExvb2sgZm9yIHRoZSBub3JtYWwgVVJMIHNlcGFyYXRvciB3ZSBleHBlY3QsICcmJy4KICAgIC8vIElmIGZvdW5kLCB3ZSBzcGxpdCB0aGUgVVJMIGludG8gdHdvIHBpZWNlcyBhcm91bmQgdGhlCiAgICAvLyBmaXJzdCAnJicuCiAgICB2YXIgY29ubkVuZCA9IHNyYy5zZWFyY2goLyYoPyFcdys9KS8pOwogICAgdmFyIHN0cmVhbUJlZ2luID0gdW5kZWZpbmVkOwogICAgaWYgKGNvbm5FbmQgIT09IC0xKSB7CiAgICAgIHN0cmVhbUJlZ2luID0gY29ubkVuZCArIDE7CiAgICB9IGVsc2UgewogICAgICAvLyBJZiB0aGVyZSdzIG5vdCBhICcmJywgd2UgdXNlIHRoZSBsYXN0ICcvJyBhcyB0aGUgZGVsaW1pdGVyLgogICAgICBjb25uRW5kID0gc3RyZWFtQmVnaW4gPSBzcmMubGFzdEluZGV4T2YoJy8nKSArIDE7CiAgICAgIGlmIChjb25uRW5kID09PSAwKSB7CiAgICAgICAgLy8gcmVhbGx5LCB0aGVyZSdzIG5vdCBhICcvJz8KICAgICAgICBjb25uRW5kID0gc3RyZWFtQmVnaW4gPSBzcmMubGVuZ3RoOwogICAgICB9CiAgICB9CiAgICBwYXJ0cy5jb25uZWN0aW9uID0gc3JjLnN1YnN0cmluZygwLCBjb25uRW5kKTsKICAgIHBhcnRzLnN0cmVhbSA9IHNyYy5zdWJzdHJpbmcoc3RyZWFtQmVnaW4sIHNyYy5sZW5ndGgpOwoKICAgIHJldHVybiBwYXJ0czsKICB9OwoKICBGbGFzaC5pc1N0cmVhbWluZ1R5cGUgPSBmdW5jdGlvbiAoc3JjVHlwZSkgewogICAgcmV0dXJuIHNyY1R5cGUgaW4gRmxhc2guc3RyZWFtaW5nRm9ybWF0czsKICB9OwoKICAvLyBSVE1QIGhhcyBmb3VyIHZhcmlhdGlvbnMsIGFueSBzdHJpbmcgc3RhcnRpbmcKICAvLyB3aXRoIG9uZSBvZiB0aGVzZSBwcm90b2NvbHMgc2hvdWxkIGJlIHZhbGlkCiAgRmxhc2guUlRNUF9SRSA9IC9ecnRtcFtzZXRdPzpcL1wvL2k7CgogIEZsYXNoLmlzU3RyZWFtaW5nU3JjID0gZnVuY3Rpb24gKHNyYykgewogICAgcmV0dXJuIEZsYXNoLlJUTVBfUkUudGVzdChzcmMpOwogIH07CgogIC8qKgogICAqIEEgc291cmNlIGhhbmRsZXIgZm9yIFJUTVAgdXJscwogICAqIEB0eXBlIHtPYmplY3R9CiAgICovCiAgRmxhc2gucnRtcFNvdXJjZUhhbmRsZXIgPSB7fTsKCiAgLyoqCiAgICogQ2hlY2sgaWYgRmxhc2ggY2FuIHBsYXkgdGhlIGdpdmVuIHZpZGVvdHlwZQogICAqIEBwYXJhbSAge1N0cmluZ30gdHlwZSAgICBUaGUgbWltZXR5cGUgdG8gY2hlY2sKICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICAgKi8KICBGbGFzaC5ydG1wU291cmNlSGFuZGxlci5jYW5QbGF5VHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7CiAgICBpZiAoRmxhc2guaXNTdHJlYW1pbmdUeXBlKHR5cGUpKSB7CiAgICAgIHJldHVybiAnbWF5YmUnOwogICAgfQoKICAgIHJldHVybiAnJzsKICB9OwoKICAvKioKICAgKiBDaGVjayBpZiBGbGFzaCBjYW4gaGFuZGxlIHRoZSBzb3VyY2UgbmF0aXZlbHkKICAgKiBAcGFyYW0gIHtPYmplY3R9IHNvdXJjZSAgVGhlIHNvdXJjZSBvYmplY3QKICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICAgKi8KICBGbGFzaC5ydG1wU291cmNlSGFuZGxlci5jYW5IYW5kbGVTb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlKSB7CiAgICB2YXIgY2FuID0gRmxhc2gucnRtcFNvdXJjZUhhbmRsZXIuY2FuUGxheVR5cGUoc291cmNlLnR5cGUpOwoKICAgIGlmIChjYW4pIHsKICAgICAgcmV0dXJuIGNhbjsKICAgIH0KCiAgICBpZiAoRmxhc2guaXNTdHJlYW1pbmdTcmMoc291cmNlLnNyYykpIHsKICAgICAgcmV0dXJuICdtYXliZSc7CiAgICB9CgogICAgcmV0dXJuICcnOwogIH07CgogIC8qKgogICAqIFBhc3MgdGhlIHNvdXJjZSB0byB0aGUgZmxhc2ggb2JqZWN0CiAgICogQWRhcHRpdmUgc291cmNlIGhhbmRsZXJzIHdpbGwgaGF2ZSBtb3JlIGNvbXBsaWNhdGVkIHdvcmtmbG93cyBiZWZvcmUgcGFzc2luZwogICAqIHZpZGVvIGRhdGEgdG8gdGhlIHZpZGVvIGVsZW1lbnQKICAgKiBAcGFyYW0gIHtPYmplY3R9IHNvdXJjZSAgICBUaGUgc291cmNlIG9iamVjdAogICAqIEBwYXJhbSAge0ZsYXNofSB0ZWNoICAgVGhlIGluc3RhbmNlIG9mIHRoZSBGbGFzaCB0ZWNoCiAgICovCiAgRmxhc2gucnRtcFNvdXJjZUhhbmRsZXIuaGFuZGxlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSwgdGVjaCkgewogICAgdmFyIHNyY1BhcnRzID0gRmxhc2guc3RyZWFtVG9QYXJ0cyhzb3VyY2Uuc3JjKTsKCiAgICB0ZWNoWydzZXRSdG1wQ29ubmVjdGlvbiddKHNyY1BhcnRzLmNvbm5lY3Rpb24pOwogICAgdGVjaFsnc2V0UnRtcFN0cmVhbSddKHNyY1BhcnRzLnN0cmVhbSk7CiAgfTsKCiAgLy8gUmVnaXN0ZXIgdGhlIG5hdGl2ZSBzb3VyY2UgaGFuZGxlcgogIEZsYXNoLnJlZ2lzdGVyU291cmNlSGFuZGxlcihGbGFzaC5ydG1wU291cmNlSGFuZGxlcik7CgogIHJldHVybiBGbGFzaDsKfQoKZXhwb3J0c1snZGVmYXVsdCddID0gRmxhc2hSdG1wRGVjb3JhdG9yOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0se31dLDExMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBmbGFzaC5qcwogKiBWaWRlb0pTLVNXRiAtIEN1c3RvbSBGbGFzaCBQbGF5ZXIgd2l0aCBIVE1MNS1pc2ggQVBJCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS96ZW5jb2Rlci92aWRlby1qcy1zd2YKICogTm90IHVzaW5nIHNldHVwVHJpZ2dlcnMuIFVzaW5nIGdsb2JhbCBvbkV2ZW50IGZ1bmMgdG8gZGlzdHJpYnV0ZSBldmVudHMKICovCgondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfdGVjaCA9IF9kZXJlcV8oJy4vdGVjaCcpOwoKdmFyIF90ZWNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlY2gpOwoKdmFyIF91dGlsc0RvbUpzID0gX2RlcmVxXygnLi4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc1VybEpzID0gX2RlcmVxXygnLi4vdXRpbHMvdXJsLmpzJyk7Cgp2YXIgVXJsID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzVXJsSnMpOwoKdmFyIF91dGlsc1RpbWVSYW5nZXNKcyA9IF9kZXJlcV8oJy4uL3V0aWxzL3RpbWUtcmFuZ2VzLmpzJyk7Cgp2YXIgX2ZsYXNoUnRtcCA9IF9kZXJlcV8oJy4vZmxhc2gtcnRtcCcpOwoKdmFyIF9mbGFzaFJ0bXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmxhc2hSdG1wKTsKCnZhciBfY29tcG9uZW50ID0gX2RlcmVxXygnLi4vY29tcG9uZW50Jyk7Cgp2YXIgX2NvbXBvbmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnQpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF9vYmplY3RBc3NpZ24gPSBfZGVyZXFfKCdvYmplY3QuYXNzaWduJyk7Cgp2YXIgX29iamVjdEFzc2lnbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9vYmplY3RBc3NpZ24pOwoKdmFyIG5hdmlnYXRvciA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10ubmF2aWdhdG9yOwovKioKICogRmxhc2ggTWVkaWEgQ29udHJvbGxlciAtIFdyYXBwZXIgZm9yIGZhbGxiYWNrIFNXRiBBUEkKICoKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zIE9iamVjdCBvZiBvcHRpb24gbmFtZXMgYW5kIHZhbHVlcwogKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcmVhZHkgUmVhZHkgY2FsbGJhY2sgZnVuY3Rpb24KICogQGV4dGVuZHMgVGVjaAogKiBAY2xhc3MgRmxhc2gKICovCgp2YXIgRmxhc2ggPSAoZnVuY3Rpb24gKF9UZWNoKSB7CiAgX2luaGVyaXRzKEZsYXNoLCBfVGVjaCk7CgogIGZ1bmN0aW9uIEZsYXNoKG9wdGlvbnMsIHJlYWR5KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmxhc2gpOwoKICAgIF9UZWNoLmNhbGwodGhpcywgb3B0aW9ucywgcmVhZHkpOwoKICAgIC8vIFNldCB0aGUgc291cmNlIHdoZW4gcmVhZHkKICAgIGlmIChvcHRpb25zLnNvdXJjZSkgewogICAgICB0aGlzLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnNldFNvdXJjZShvcHRpb25zLnNvdXJjZSk7CiAgICAgIH0sIHRydWUpOwogICAgfQoKICAgIC8vIEhhdmluZyBpc3N1ZXMgd2l0aCBGbGFzaCByZWxvYWRpbmcgb24gY2VydGFpbiBwYWdlIGFjdGlvbnMgKGhpZGUvcmVzaXplL2Z1bGxzY3JlZW4pIGluIGNlcnRhaW4gYnJvd3NlcnMKICAgIC8vIFRoaXMgYWxsb3dzIHJlc2V0dGluZyB0aGUgcGxheWhlYWQgd2hlbiB3ZSBjYXRjaCB0aGUgcmVsb2FkCiAgICBpZiAob3B0aW9ucy5zdGFydFRpbWUpIHsKICAgICAgdGhpcy5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5sb2FkKCk7CiAgICAgICAgdGhpcy5wbGF5KCk7CiAgICAgICAgdGhpcy5jdXJyZW50VGltZShvcHRpb25zLnN0YXJ0VGltZSk7CiAgICAgIH0sIHRydWUpOwogICAgfQoKICAgIC8vIEFkZCBnbG9iYWwgd2luZG93IGZ1bmN0aW9ucyB0aGF0IHRoZSBzd2YgZXhwZWN0cwogICAgLy8gQSA0Lnggd29ya2Zsb3cgd2Ugd2VyZW4ndCBhYmxlIHRvIHNvbHZlIGZvciBpbiA1LjAKICAgIC8vIGJlY2F1c2Ugb2YgdGhlIG5lZWQgdG8gaGFyZCBjb2RlIHRoZXNlIGZ1bmN0aW9ucwogICAgLy8gaW50byB0aGUgc3dmIGZvciBzZWN1cml0eSByZWFzb25zCiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMgPSBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMgfHwge307CiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMuRmxhc2ggPSBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMuRmxhc2ggfHwge307CiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMuRmxhc2gub25SZWFkeSA9IEZsYXNoLm9uUmVhZHk7CiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMuRmxhc2gub25FdmVudCA9IEZsYXNoLm9uRXZlbnQ7CiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanMuRmxhc2gub25FcnJvciA9IEZsYXNoLm9uRXJyb3I7CgogICAgdGhpcy5vbignc2Vla2VkJywgZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmxhc3RTZWVrVGFyZ2V0XyA9IHVuZGVmaW5lZDsKICAgIH0pOwogIH0KCiAgLy8gQ3JlYXRlIHNldHRlcnMgYW5kIGdldHRlcnMgZm9yIGF0dHJpYnV0ZXMKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIEZsYXNoLnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNfOwoKICAgIC8vIElmIHZpZGVvLmpzIGlzIGhvc3RlZCBsb2NhbGx5IHlvdSBzaG91bGQgYWxzbyBzZXQgdGhlIGxvY2F0aW9uCiAgICAvLyBmb3IgdGhlIGhvc3RlZCBzd2YsIHdoaWNoIHNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgcGFnZSAobm90IHZpZGVvLmpzKQogICAgLy8gT3RoZXJ3aXNlIHRoaXMgYWRkcyBhIENETiB1cmwuCiAgICAvLyBUaGUgQ0ROIGFsc28gYXV0by1hZGRzIGEgc3dmIFVSTCBmb3IgdGhhdCBzcGVjaWZpYyB2ZXJzaW9uLgogICAgaWYgKCFvcHRpb25zLnN3ZikgewogICAgICBvcHRpb25zLnN3ZiA9ICcvL3Zqcy56ZW5jZG4ubmV0L3N3Zi81LjAuMS92aWRlby1qcy5zd2YnOwogICAgfQoKICAgIC8vIEdlbmVyYXRlIElEIGZvciBzd2Ygb2JqZWN0CiAgICB2YXIgb2JqSWQgPSBvcHRpb25zLnRlY2hJZDsKCiAgICAvLyBNZXJnZSBkZWZhdWx0IGZsYXNodmFycyB3aXRoIG9uZXMgcGFzc2VkIGluIHRvIGluaXQKICAgIHZhciBmbGFzaFZhcnMgPSBfb2JqZWN0QXNzaWduMlsnZGVmYXVsdCddKHsKCiAgICAgIC8vIFNXRiBDYWxsYmFjayBGdW5jdGlvbnMKICAgICAgJ3JlYWR5RnVuY3Rpb24nOiAndmlkZW9qcy5GbGFzaC5vblJlYWR5JywKICAgICAgJ2V2ZW50UHJveHlGdW5jdGlvbic6ICd2aWRlb2pzLkZsYXNoLm9uRXZlbnQnLAogICAgICAnZXJyb3JFdmVudFByb3h5RnVuY3Rpb24nOiAndmlkZW9qcy5GbGFzaC5vbkVycm9yJywKCiAgICAgIC8vIFBsYXllciBTZXR0aW5ncwogICAgICAnYXV0b3BsYXknOiBvcHRpb25zLmF1dG9wbGF5LAogICAgICAncHJlbG9hZCc6IG9wdGlvbnMucHJlbG9hZCwKICAgICAgJ2xvb3AnOiBvcHRpb25zLmxvb3AsCiAgICAgICdtdXRlZCc6IG9wdGlvbnMubXV0ZWQKCiAgICB9LCBvcHRpb25zLmZsYXNoVmFycyk7CgogICAgLy8gTWVyZ2UgZGVmYXVsdCBwYXJhbWVzIHdpdGggb25lcyBwYXNzZWQgaW4KICAgIHZhciBwYXJhbXMgPSBfb2JqZWN0QXNzaWduMlsnZGVmYXVsdCddKHsKICAgICAgJ3dtb2RlJzogJ29wYXF1ZScsIC8vIE9wYXF1ZSBpcyBuZWVkZWQgdG8gb3ZlcmxheSBjb250cm9scywgYnV0IGNhbiBhZmZlY3QgcGxheWJhY2sgcGVyZm9ybWFuY2UKICAgICAgJ2JnY29sb3InOiAnIzAwMDAwMCcgLy8gVXNpbmcgYmdjb2xvciBwcmV2ZW50cyBhIHdoaXRlIGZsYXNoIHdoZW4gdGhlIG9iamVjdCBpcyBsb2FkaW5nCiAgICB9LCBvcHRpb25zLnBhcmFtcyk7CgogICAgLy8gTWVyZ2UgZGVmYXVsdCBhdHRyaWJ1dGVzIHdpdGggb25lcyBwYXNzZWQgaW4KICAgIHZhciBhdHRyaWJ1dGVzID0gX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXSh7CiAgICAgICdpZCc6IG9iaklkLAogICAgICAnbmFtZSc6IG9iaklkLCAvLyBCb3RoIElEIGFuZCBOYW1lIG5lZWRlZCBvciBzd2YgdG8gaWRlbnRpZnkgaXRzZWxmCiAgICAgICdjbGFzcyc6ICd2anMtdGVjaCcKICAgIH0sIG9wdGlvbnMuYXR0cmlidXRlcyk7CgogICAgdGhpcy5lbF8gPSBGbGFzaC5lbWJlZChvcHRpb25zLnN3ZiwgZmxhc2hWYXJzLCBwYXJhbXMsIGF0dHJpYnV0ZXMpOwogICAgdGhpcy5lbF8udGVjaCA9IHRoaXM7CgogICAgcmV0dXJuIHRoaXMuZWxfOwogIH07CgogIC8qKgogICAqIFBsYXkgZm9yIGZsYXNoIHRlY2gKICAgKgogICAqIEBtZXRob2QgcGxheQogICAqLwoKICBGbGFzaC5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIHBsYXkoKSB7CiAgICBpZiAodGhpcy5lbmRlZCgpKSB7CiAgICAgIHRoaXMuc2V0Q3VycmVudFRpbWUoMCk7CiAgICB9CiAgICB0aGlzLmVsXy52anNfcGxheSgpOwogIH07CgogIC8qKgogICAqIFBhdXNlIGZvciBmbGFzaCB0ZWNoCiAgICoKICAgKiBAbWV0aG9kIHBhdXNlCiAgICovCgogIEZsYXNoLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgdGhpcy5lbF8udmpzX3BhdXNlKCk7CiAgfTsKCiAgLyoqCiAgICogR2V0L3NldCB2aWRlbwogICAqCiAgICogQHBhcmFtIHtPYmplY3Q9fSBzcmMgU291cmNlIG9iamVjdAogICAqIEByZXR1cm4ge09iamVjdH0KICAgKiBAbWV0aG9kIHNyYwogICAqLwoKICBGbGFzaC5wcm90b3R5cGUuc3JjID0gZnVuY3Rpb24gc3JjKF9zcmMpIHsKICAgIGlmIChfc3JjID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFNyYygpOwogICAgfQoKICAgIC8vIFNldHRpbmcgc3JjIHRocm91Z2ggYHNyY2Agbm90IGBzZXRTcmNgIHdpbGwgYmUgZGVwcmVjYXRlZAogICAgcmV0dXJuIHRoaXMuc2V0U3JjKF9zcmMpOwogIH07CgogIC8qKgogICAqIFNldCB2aWRlbwogICAqCiAgICogQHBhcmFtIHtPYmplY3Q9fSBzcmMgU291cmNlIG9iamVjdAogICAqIEBkZXByZWNhdGVkCiAgICogQG1ldGhvZCBzZXRTcmMKICAgKi8KCiAgRmxhc2gucHJvdG90eXBlLnNldFNyYyA9IGZ1bmN0aW9uIHNldFNyYyhzcmMpIHsKICAgIC8vIE1ha2Ugc3VyZSBzb3VyY2UgVVJMIGlzIGFic29sdXRlLgogICAgc3JjID0gVXJsLmdldEFic29sdXRlVVJMKHNyYyk7CiAgICB0aGlzLmVsXy52anNfc3JjKHNyYyk7CgogICAgLy8gQ3VycmVudGx5IHRoZSBTV0YgZG9lc24ndCBhdXRvcGxheSBpZiB5b3UgbG9hZCBhIHNvdXJjZSBsYXRlci4KICAgIC8vIGUuZy4gTG9hZCBwbGF5ZXIgdy8gbm8gc291cmNlLCB3YWl0IDJzLCBzZXQgc3JjLgogICAgaWYgKHRoaXMuYXV0b3BsYXkoKSkgewogICAgICB2YXIgdGVjaCA9IHRoaXM7CiAgICAgIHRoaXMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdGVjaC5wbGF5KCk7CiAgICAgIH0sIDApOwogICAgfQogIH07CgogIC8qKgogICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGVjaCBpcyBjdXJyZW50bHkgc2Vla2luZy4KICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIHNlZWtpbmcKICAgKi8KCiAgRmxhc2gucHJvdG90eXBlLnNlZWtpbmcgPSBmdW5jdGlvbiBzZWVraW5nKCkgewogICAgcmV0dXJuIHRoaXMubGFzdFNlZWtUYXJnZXRfICE9PSB1bmRlZmluZWQ7CiAgfTsKCiAgLyoqCiAgICogU2V0IGN1cnJlbnQgdGltZQogICAqCiAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWUgQ3VycmVudCB0aW1lIG9mIHZpZGVvCiAgICogQG1ldGhvZCBzZXRDdXJyZW50VGltZQogICAqLwoKICBGbGFzaC5wcm90b3R5cGUuc2V0Q3VycmVudFRpbWUgPSBmdW5jdGlvbiBzZXRDdXJyZW50VGltZSh0aW1lKSB7CiAgICB2YXIgc2Vla2FibGUgPSB0aGlzLnNlZWthYmxlKCk7CiAgICBpZiAoc2Vla2FibGUubGVuZ3RoKSB7CiAgICAgIC8vIGNsYW1wIHRvIHRoZSBjdXJyZW50IHNlZWthYmxlIHJhbmdlCiAgICAgIHRpbWUgPSB0aW1lID4gc2Vla2FibGUuc3RhcnQoMCkgPyB0aW1lIDogc2Vla2FibGUuc3RhcnQoMCk7CiAgICAgIHRpbWUgPSB0aW1lIDwgc2Vla2FibGUuZW5kKHNlZWthYmxlLmxlbmd0aCAtIDEpID8gdGltZSA6IHNlZWthYmxlLmVuZChzZWVrYWJsZS5sZW5ndGggLSAxKTsKCiAgICAgIHRoaXMubGFzdFNlZWtUYXJnZXRfID0gdGltZTsKICAgICAgdGhpcy50cmlnZ2VyKCdzZWVraW5nJyk7CiAgICAgIHRoaXMuZWxfLnZqc19zZXRQcm9wZXJ0eSgnY3VycmVudFRpbWUnLCB0aW1lKTsKICAgICAgX1RlY2gucHJvdG90eXBlLnNldEN1cnJlbnRUaW1lLmNhbGwodGhpcyk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogR2V0IGN1cnJlbnQgdGltZQogICAqCiAgICogQHBhcmFtIHtOdW1iZXI9fSB0aW1lIEN1cnJlbnQgdGltZSBvZiB2aWRlbwogICAqIEByZXR1cm4ge051bWJlcn0gQ3VycmVudCB0aW1lCiAgICogQG1ldGhvZCBjdXJyZW50VGltZQogICAqLwoKICBGbGFzaC5wcm90b3R5cGUuY3VycmVudFRpbWUgPSBmdW5jdGlvbiBjdXJyZW50VGltZSh0aW1lKSB7CiAgICAvLyB3aGVuIHNlZWtpbmcgbWFrZSB0aGUgcmVwb3J0ZWQgdGltZSBrZWVwIHVwIHdpdGggdGhlIHJlcXVlc3RlZCB0aW1lCiAgICAvLyBieSByZWFkaW5nIHRoZSB0aW1lIHdlJ3JlIHNlZWtpbmcgdG8KICAgIGlmICh0aGlzLnNlZWtpbmcoKSkgewogICAgICByZXR1cm4gdGhpcy5sYXN0U2Vla1RhcmdldF8gfHwgMDsKICAgIH0KICAgIHJldHVybiB0aGlzLmVsXy52anNfZ2V0UHJvcGVydHkoJ2N1cnJlbnRUaW1lJyk7CiAgfTsKCiAgLyoqCiAgICogR2V0IGN1cnJlbnQgc291cmNlCiAgICoKICAgKiBAbWV0aG9kIGN1cnJlbnRTcmMKICAgKi8KCiAgRmxhc2gucHJvdG90eXBlLmN1cnJlbnRTcmMgPSBmdW5jdGlvbiBjdXJyZW50U3JjKCkgewogICAgaWYgKHRoaXMuY3VycmVudFNvdXJjZV8pIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFNvdXJjZV8uc3JjOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMuZWxfLnZqc19nZXRQcm9wZXJ0eSgnY3VycmVudFNyYycpOwogICAgfQogIH07CgogIC8qKgogICAqIExvYWQgbWVkaWEgaW50byBwbGF5ZXIKICAgKgogICAqIEBtZXRob2QgbG9hZAogICAqLwoKICBGbGFzaC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIGxvYWQoKSB7CiAgICB0aGlzLmVsXy52anNfbG9hZCgpOwogIH07CgogIC8qKgogICAqIEdldCBwb3N0ZXIKICAgKgogICAqIEBtZXRob2QgcG9zdGVyCiAgICovCgogIEZsYXNoLnByb3RvdHlwZS5wb3N0ZXIgPSBmdW5jdGlvbiBwb3N0ZXIoKSB7CiAgICB0aGlzLmVsXy52anNfZ2V0UHJvcGVydHkoJ3Bvc3RlcicpOwogIH07CgogIC8qKgogICAqIFBvc3RlciBpbWFnZXMgYXJlIG5vdCBoYW5kbGVkIGJ5IHRoZSBGbGFzaCB0ZWNoIHNvIG1ha2UgdGhpcyBhIG5vLW9wCiAgICoKICAgKiBAbWV0aG9kIHNldFBvc3RlcgogICAqLwoKICBGbGFzaC5wcm90b3R5cGUuc2V0UG9zdGVyID0gZnVuY3Rpb24gc2V0UG9zdGVyKCkge307CgogIC8qKgogICAqIERldGVybWluZSBpZiBjYW4gc2VlayBpbiBtZWRpYQogICAqCiAgICogQHJldHVybiB7VGltZVJhbmdlT2JqZWN0fQogICAqIEBtZXRob2Qgc2Vla2FibGUKICAgKi8KCiAgRmxhc2gucHJvdG90eXBlLnNlZWthYmxlID0gZnVuY3Rpb24gc2Vla2FibGUoKSB7CiAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmR1cmF0aW9uKCk7CiAgICBpZiAoZHVyYXRpb24gPT09IDApIHsKICAgICAgcmV0dXJuIF91dGlsc1RpbWVSYW5nZXNKcy5jcmVhdGVUaW1lUmFuZ2UoKTsKICAgIH0KICAgIHJldHVybiBfdXRpbHNUaW1lUmFuZ2VzSnMuY3JlYXRlVGltZVJhbmdlKDAsIGR1cmF0aW9uKTsKICB9OwoKICAvKioKICAgKiBHZXQgYnVmZmVyZWQgdGltZSByYW5nZQogICAqCiAgICogQHJldHVybiB7VGltZVJhbmdlT2JqZWN0fQogICAqIEBtZXRob2QgYnVmZmVyZWQKICAgKi8KCiAgRmxhc2gucHJvdG90eXBlLmJ1ZmZlcmVkID0gZnVuY3Rpb24gYnVmZmVyZWQoKSB7CiAgICB2YXIgcmFuZ2VzID0gdGhpcy5lbF8udmpzX2dldFByb3BlcnR5KCdidWZmZXJlZCcpOwogICAgaWYgKHJhbmdlcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIF91dGlsc1RpbWVSYW5nZXNKcy5jcmVhdGVUaW1lUmFuZ2UoKTsKICAgIH0KICAgIHJldHVybiBfdXRpbHNUaW1lUmFuZ2VzSnMuY3JlYXRlVGltZVJhbmdlKHJhbmdlc1swXVswXSwgcmFuZ2VzWzBdWzFdKTsKICB9OwoKICAvKioKICAgKiBHZXQgZnVsbHNjcmVlbiBzdXBwb3J0IC0KICAgKiBGbGFzaCBkb2VzIG5vdCBhbGxvdyBmdWxsc2NyZWVuIHRocm91Z2ggamF2YXNjcmlwdAogICAqIHNvIGFsd2F5cyByZXR1cm5zIGZhbHNlCiAgICoKICAgKiBAcmV0dXJuIHtCb29sZWFufSBmYWxzZQogICAqIEBtZXRob2Qgc3VwcG9ydHNGdWxsU2NyZWVuCiAgICovCgogIEZsYXNoLnByb3RvdHlwZS5zdXBwb3J0c0Z1bGxTY3JlZW4gPSBmdW5jdGlvbiBzdXBwb3J0c0Z1bGxTY3JlZW4oKSB7CiAgICByZXR1cm4gZmFsc2U7IC8vIEZsYXNoIGRvZXMgbm90IGFsbG93IGZ1bGxzY3JlZW4gdGhyb3VnaCBqYXZhc2NyaXB0CiAgfTsKCiAgLyoqCiAgICogUmVxdWVzdCB0byBlbnRlciBmdWxsc2NyZWVuCiAgICogRmxhc2ggZG9lcyBub3QgYWxsb3cgZnVsbHNjcmVlbiB0aHJvdWdoIGphdmFzY3JpcHQKICAgKiBzbyBhbHdheXMgcmV0dXJucyBmYWxzZQogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0gZmFsc2UKICAgKiBAbWV0aG9kIGVudGVyRnVsbFNjcmVlbgogICAqLwoKICBGbGFzaC5wcm90b3R5cGUuZW50ZXJGdWxsU2NyZWVuID0gZnVuY3Rpb24gZW50ZXJGdWxsU2NyZWVuKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH07CgogIHJldHVybiBGbGFzaDsKfSkoX3RlY2gyWydkZWZhdWx0J10pOwoKdmFyIF9hcGkgPSBGbGFzaC5wcm90b3R5cGU7CnZhciBfcmVhZFdyaXRlID0gJ3J0bXBDb25uZWN0aW9uLHJ0bXBTdHJlYW0scHJlbG9hZCxkZWZhdWx0UGxheWJhY2tSYXRlLHBsYXliYWNrUmF0ZSxhdXRvcGxheSxsb29wLG1lZGlhR3JvdXAsY29udHJvbGxlcixjb250cm9scyx2b2x1bWUsbXV0ZWQsZGVmYXVsdE11dGVkJy5zcGxpdCgnLCcpOwp2YXIgX3JlYWRPbmx5ID0gJ25ldHdvcmtTdGF0ZSxyZWFkeVN0YXRlLGluaXRpYWxUaW1lLGR1cmF0aW9uLHN0YXJ0T2Zmc2V0VGltZSxwYXVzZWQsZW5kZWQsdmlkZW9UcmFja3MsYXVkaW9UcmFja3MsdmlkZW9XaWR0aCx2aWRlb0hlaWdodCcuc3BsaXQoJywnKTsKCmZ1bmN0aW9uIF9jcmVhdGVTZXR0ZXIoYXR0cikgewogIHZhciBhdHRyVXBwZXIgPSBhdHRyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgYXR0ci5zbGljZSgxKTsKICBfYXBpWydzZXQnICsgYXR0clVwcGVyXSA9IGZ1bmN0aW9uICh2YWwpIHsKICAgIHJldHVybiB0aGlzLmVsXy52anNfc2V0UHJvcGVydHkoYXR0ciwgdmFsKTsKICB9Owp9CmZ1bmN0aW9uIF9jcmVhdGVHZXR0ZXIoYXR0cikgewogIF9hcGlbYXR0cl0gPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8udmpzX2dldFByb3BlcnR5KGF0dHIpOwogIH07Cn0KCi8vIENyZWF0ZSBnZXR0ZXIgYW5kIHNldHRlcnMgZm9yIGFsbCByZWFkL3dyaXRlIGF0dHJpYnV0ZXMKZm9yICh2YXIgaSA9IDA7IGkgPCBfcmVhZFdyaXRlLmxlbmd0aDsgaSsrKSB7CiAgX2NyZWF0ZUdldHRlcihfcmVhZFdyaXRlW2ldKTsKICBfY3JlYXRlU2V0dGVyKF9yZWFkV3JpdGVbaV0pOwp9CgovLyBDcmVhdGUgZ2V0dGVycyBmb3IgcmVhZC1vbmx5IGF0dHJpYnV0ZXMKZm9yICh2YXIgaSA9IDA7IGkgPCBfcmVhZE9ubHkubGVuZ3RoOyBpKyspIHsKICBfY3JlYXRlR2V0dGVyKF9yZWFkT25seVtpXSk7Cn0KCi8qIEZsYXNoIFN1cHBvcnQgVGVzdGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKRmxhc2guaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIEZsYXNoLnZlcnNpb24oKVswXSA+PSAxMDsKICAvLyByZXR1cm4gc3dmb2JqZWN0Lmhhc0ZsYXNoUGxheWVyVmVyc2lvbignMTAnKTsKfTsKCi8vIEFkZCBTb3VyY2UgSGFuZGxlciBwYXR0ZXJuIGZ1bmN0aW9ucyB0byB0aGlzIHRlY2gKX3RlY2gyWydkZWZhdWx0J10ud2l0aFNvdXJjZUhhbmRsZXJzKEZsYXNoKTsKCi8qCiAqIFRoZSBkZWZhdWx0IG5hdGl2ZSBzb3VyY2UgaGFuZGxlci4KICogVGhpcyBzaW1wbHkgcGFzc2VzIHRoZSBzb3VyY2UgdG8gdGhlIHZpZGVvIGVsZW1lbnQuIE5vdGhpbmcgZmFuY3kuCiAqCiAqIEBwYXJhbSAge09iamVjdH0gc291cmNlICAgVGhlIHNvdXJjZSBvYmplY3QKICogQHBhcmFtICB7Rmxhc2h9IHRlY2ggIFRoZSBpbnN0YW5jZSBvZiB0aGUgRmxhc2ggdGVjaAogKi8KRmxhc2gubmF0aXZlU291cmNlSGFuZGxlciA9IHt9OwoKLyoqCiAqIENoZWNrIGlmIEZsYXNoIGNhbiBwbGF5IHRoZSBnaXZlbiB2aWRlb3R5cGUKICogQHBhcmFtICB7U3RyaW5nfSB0eXBlICAgIFRoZSBtaW1ldHlwZSB0byBjaGVjawogKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICovCkZsYXNoLm5hdGl2ZVNvdXJjZUhhbmRsZXIuY2FuUGxheVR5cGUgPSBmdW5jdGlvbiAodHlwZSkgewogIGlmICh0eXBlIGluIEZsYXNoLmZvcm1hdHMpIHsKICAgIHJldHVybiAnbWF5YmUnOwogIH0KCiAgcmV0dXJuICcnOwp9OwoKLyoKICogQ2hlY2sgRmxhc2ggY2FuIGhhbmRsZSB0aGUgc291cmNlIG5hdGl2ZWx5CiAqCiAqIEBwYXJhbSAge09iamVjdH0gc291cmNlICBUaGUgc291cmNlIG9iamVjdAogKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICovCkZsYXNoLm5hdGl2ZVNvdXJjZUhhbmRsZXIuY2FuSGFuZGxlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkgewogIHZhciB0eXBlOwoKICBmdW5jdGlvbiBndWVzc01pbWVUeXBlKHNyYykgewogICAgdmFyIGV4dCA9IFVybC5nZXRGaWxlRXh0ZW5zaW9uKHNyYyk7CiAgICBpZiAoZXh0KSB7CiAgICAgIHJldHVybiAndmlkZW8vJyArIGV4dDsKICAgIH0KICAgIHJldHVybiAnJzsKICB9CgogIGlmICghc291cmNlLnR5cGUpIHsKICAgIHR5cGUgPSBndWVzc01pbWVUeXBlKHNvdXJjZS5zcmMpOwogIH0gZWxzZSB7CiAgICAvLyBTdHJpcCBjb2RlIGluZm9ybWF0aW9uIGZyb20gdGhlIHR5cGUgYmVjYXVzZSB3ZSBkb24ndCBnZXQgdGhhdCBzcGVjaWZpYwogICAgdHlwZSA9IHNvdXJjZS50eXBlLnJlcGxhY2UoLzsuKi8sICcnKS50b0xvd2VyQ2FzZSgpOwogIH0KCiAgcmV0dXJuIEZsYXNoLm5hdGl2ZVNvdXJjZUhhbmRsZXIuY2FuUGxheVR5cGUodHlwZSk7Cn07CgovKgogKiBQYXNzIHRoZSBzb3VyY2UgdG8gdGhlIGZsYXNoIG9iamVjdAogKiBBZGFwdGl2ZSBzb3VyY2UgaGFuZGxlcnMgd2lsbCBoYXZlIG1vcmUgY29tcGxpY2F0ZWQgd29ya2Zsb3dzIGJlZm9yZSBwYXNzaW5nCiAqIHZpZGVvIGRhdGEgdG8gdGhlIHZpZGVvIGVsZW1lbnQKICoKICogQHBhcmFtICB7T2JqZWN0fSBzb3VyY2UgICAgVGhlIHNvdXJjZSBvYmplY3QKICogQHBhcmFtICB7Rmxhc2h9IHRlY2ggICBUaGUgaW5zdGFuY2Ugb2YgdGhlIEZsYXNoIHRlY2gKICovCkZsYXNoLm5hdGl2ZVNvdXJjZUhhbmRsZXIuaGFuZGxlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSwgdGVjaCkgewogIHRlY2guc2V0U3JjKHNvdXJjZS5zcmMpOwp9OwoKLyoKICogQ2xlYW4gdXAgdGhlIHNvdXJjZSBoYW5kbGVyIHdoZW4gZGlzcG9zaW5nIHRoZSBwbGF5ZXIgb3Igc3dpdGNoaW5nIHNvdXJjZXMuLgogKiAobm8gY2xlYW51cCBpcyBuZWVkZWQgd2hlbiBzdXBwb3J0aW5nIHRoZSBmb3JtYXQgbmF0aXZlbHkpCiAqLwpGbGFzaC5uYXRpdmVTb3VyY2VIYW5kbGVyLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7fTsKCi8vIFJlZ2lzdGVyIHRoZSBuYXRpdmUgc291cmNlIGhhbmRsZXIKRmxhc2gucmVnaXN0ZXJTb3VyY2VIYW5kbGVyKEZsYXNoLm5hdGl2ZVNvdXJjZUhhbmRsZXIpOwoKRmxhc2guZm9ybWF0cyA9IHsKICAndmlkZW8vZmx2JzogJ0ZMVicsCiAgJ3ZpZGVvL3gtZmx2JzogJ0ZMVicsCiAgJ3ZpZGVvL21wNCc6ICdNUDQnLAogICd2aWRlby9tNHYnOiAnTVA0Jwp9OwoKRmxhc2gub25SZWFkeSA9IGZ1bmN0aW9uIChjdXJyU3dmKSB7CiAgdmFyIGVsID0gRG9tLmdldEVsKGN1cnJTd2YpOwogIHZhciB0ZWNoID0gZWwgJiYgZWwudGVjaDsKCiAgLy8gaWYgdGhlcmUgaXMgbm8gZWwgdGhlbiB0aGUgdGVjaCBoYXMgYmVlbiBkaXNwb3NlZAogIC8vIGFuZCB0aGUgdGVjaCBlbGVtZW50IHdhcyByZW1vdmVkIGZyb20gdGhlIHBsYXllciBkaXYKICBpZiAodGVjaCAmJiB0ZWNoLmVsKCkpIHsKICAgIC8vIGNoZWNrIHRoYXQgdGhlIGZsYXNoIG9iamVjdCBpcyByZWFsbHkgcmVhZHkKICAgIEZsYXNoLmNoZWNrUmVhZHkodGVjaCk7CiAgfQp9OwoKLy8gVGhlIFNXRiBpc24ndCBhbHdheXMgcmVhZHkgd2hlbiBpdCBzYXlzIGl0IGlzLiBTb21ldGltZXMgdGhlIEFQSSBmdW5jdGlvbnMgc3RpbGwgbmVlZCB0byBiZSBhZGRlZCB0byB0aGUgb2JqZWN0LgovLyBJZiBpdCdzIG5vdCByZWFkeSwgd2Ugc2V0IGEgdGltZW91dCB0byBjaGVjayBhZ2FpbiBzaG9ydGx5LgpGbGFzaC5jaGVja1JlYWR5ID0gZnVuY3Rpb24gKHRlY2gpIHsKICAvLyBzdG9wIHdvcnJ5aW5nIGlmIHRoZSB0ZWNoIGhhcyBiZWVuIGRpc3Bvc2VkCiAgaWYgKCF0ZWNoLmVsKCkpIHsKICAgIHJldHVybjsKICB9CgogIC8vIGNoZWNrIGlmIEFQSSBwcm9wZXJ0eSBleGlzdHMKICBpZiAodGVjaC5lbCgpLnZqc19nZXRQcm9wZXJ0eSkgewogICAgLy8gdGVsbCB0ZWNoIGl0J3MgcmVhZHkKICAgIHRlY2gudHJpZ2dlclJlYWR5KCk7CiAgfSBlbHNlIHsKICAgIC8vIHdhaXQgbG9uZ2VyCiAgICB0aGlzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBGbGFzaFsnY2hlY2tSZWFkeSddKHRlY2gpOwogICAgfSwgNTApOwogIH0KfTsKCi8vIFRyaWdnZXIgZXZlbnRzIGZyb20gdGhlIHN3ZiBvbiB0aGUgcGxheWVyCkZsYXNoLm9uRXZlbnQgPSBmdW5jdGlvbiAoc3dmSUQsIGV2ZW50TmFtZSkgewogIHZhciB0ZWNoID0gRG9tLmdldEVsKHN3ZklEKS50ZWNoOwogIHRlY2gudHJpZ2dlcihldmVudE5hbWUpOwp9OwoKLy8gTG9nIGVycm9ycyBmcm9tIHRoZSBzd2YKRmxhc2gub25FcnJvciA9IGZ1bmN0aW9uIChzd2ZJRCwgZXJyKSB7CiAgdmFyIHRlY2ggPSBEb20uZ2V0RWwoc3dmSUQpLnRlY2g7CgogIC8vIHRyaWdnZXIgTUVESUFfRVJSX1NSQ19OT1RfU1VQUE9SVEVECiAgaWYgKGVyciA9PT0gJ3NyY25vdGZvdW5kJykgewogICAgcmV0dXJuIHRlY2guZXJyb3IoNCk7CiAgfQoKICAvLyB0cmlnZ2VyIGEgY3VzdG9tIGVycm9yCiAgdGVjaC5lcnJvcignRkxBU0g6ICcgKyBlcnIpOwp9OwoKLy8gRmxhc2ggVmVyc2lvbiBDaGVjawpGbGFzaC52ZXJzaW9uID0gZnVuY3Rpb24gKCkgewogIHZhciB2ZXJzaW9uID0gJzAsMCwwJzsKCiAgLy8gSUUKICB0cnkgewogICAgdmVyc2lvbiA9IG5ldyBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLkFjdGl2ZVhPYmplY3QoJ1Nob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoJykuR2V0VmFyaWFibGUoJyR2ZXJzaW9uJykucmVwbGFjZSgvXEQrL2csICcsJykubWF0Y2goL14sPyguKyksPyQvKVsxXTsKCiAgICAvLyBvdGhlciBicm93c2VycwogIH0gY2F0Y2ggKGUpIHsKICAgIHRyeSB7CiAgICAgIGlmIChuYXZpZ2F0b3IubWltZVR5cGVzWydhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCddLmVuYWJsZWRQbHVnaW4pIHsKICAgICAgICB2ZXJzaW9uID0gKG5hdmlnYXRvci5wbHVnaW5zWydTaG9ja3dhdmUgRmxhc2ggMi4wJ10gfHwgbmF2aWdhdG9yLnBsdWdpbnNbJ1Nob2Nrd2F2ZSBGbGFzaCddKS5kZXNjcmlwdGlvbi5yZXBsYWNlKC9cRCsvZywgJywnKS5tYXRjaCgvXiw/KC4rKSw/JC8pWzFdOwogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHt9CiAgfQogIHJldHVybiB2ZXJzaW9uLnNwbGl0KCcsJyk7Cn07CgovLyBGbGFzaCBlbWJlZGRpbmcgbWV0aG9kLiBPbmx5IHVzZWQgaW4gbm9uLWlmcmFtZSBtb2RlCkZsYXNoLmVtYmVkID0gZnVuY3Rpb24gKHN3ZiwgZmxhc2hWYXJzLCBwYXJhbXMsIGF0dHJpYnV0ZXMpIHsKICB2YXIgY29kZSA9IEZsYXNoLmdldEVtYmVkQ29kZShzd2YsIGZsYXNoVmFycywgcGFyYW1zLCBhdHRyaWJ1dGVzKTsKCiAgLy8gR2V0IGVsZW1lbnQgYnkgZW1iZWRkaW5nIGNvZGUgYW5kIHJldHJpZXZpbmcgY3JlYXRlZCBlbGVtZW50CiAgdmFyIG9iaiA9IERvbS5jcmVhdGVFbCgnZGl2JywgeyBpbm5lckhUTUw6IGNvZGUgfSkuY2hpbGROb2Rlc1swXTsKCiAgcmV0dXJuIG9iajsKfTsKCkZsYXNoLmdldEVtYmVkQ29kZSA9IGZ1bmN0aW9uIChzd2YsIGZsYXNoVmFycywgcGFyYW1zLCBhdHRyaWJ1dGVzKSB7CiAgdmFyIG9ialRhZyA9ICc8b2JqZWN0IHR5cGU9ImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoIiAnOwogIHZhciBmbGFzaFZhcnNTdHJpbmcgPSAnJzsKICB2YXIgcGFyYW1zU3RyaW5nID0gJyc7CiAgdmFyIGF0dHJzU3RyaW5nID0gJyc7CgogIC8vIENvbnZlcnQgZmxhc2ggdmFycyB0byBzdHJpbmcKICBpZiAoZmxhc2hWYXJzKSB7CiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhmbGFzaFZhcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICBmbGFzaFZhcnNTdHJpbmcgKz0ga2V5ICsgJz0nICsgZmxhc2hWYXJzW2tleV0gKyAnJmFtcDsnOwogICAgfSk7CiAgfQoKICAvLyBBZGQgc3dmLCBmbGFzaFZhcnMsIGFuZCBvdGhlciBkZWZhdWx0IHBhcmFtcwogIHBhcmFtcyA9IF9vYmplY3RBc3NpZ24yWydkZWZhdWx0J10oewogICAgJ21vdmllJzogc3dmLAogICAgJ2ZsYXNodmFycyc6IGZsYXNoVmFyc1N0cmluZywKICAgICdhbGxvd1NjcmlwdEFjY2Vzcyc6ICdhbHdheXMnLCAvLyBSZXF1aXJlZCB0byB0YWxrIHRvIHN3ZgogICAgJ2FsbG93TmV0d29ya2luZyc6ICdhbGwnIC8vIEFsbCBzaG91bGQgYmUgZGVmYXVsdCwgYnV0IGhhdmluZyBzZWN1cml0eSBpc3N1ZXMuCiAgfSwgcGFyYW1zKTsKCiAgLy8gQ3JlYXRlIHBhcmFtIHRhZ3Mgc3RyaW5nCiAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMocGFyYW1zKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgIHBhcmFtc1N0cmluZyArPSAnPHBhcmFtIG5hbWU9IicgKyBrZXkgKyAnIiB2YWx1ZT0iJyArIHBhcmFtc1trZXldICsgJyIgLz4nOwogIH0pOwoKICBhdHRyaWJ1dGVzID0gX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXSh7CiAgICAvLyBBZGQgc3dmIHRvIGF0dHJpYnV0ZXMgKG5lZWQgYm90aCBmb3IgSUUgYW5kIE90aGVycyB0byB3b3JrKQogICAgJ2RhdGEnOiBzd2YsCgogICAgLy8gRGVmYXVsdCB0byAxMDAlIHdpZHRoL2hlaWdodAogICAgJ3dpZHRoJzogJzEwMCUnLAogICAgJ2hlaWdodCc6ICcxMDAlJwoKICB9LCBhdHRyaWJ1dGVzKTsKCiAgLy8gQ3JlYXRlIEF0dHJpYnV0ZXMgc3RyaW5nCiAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBhdHRyc1N0cmluZyArPSBrZXkgKyAnPSInICsgYXR0cmlidXRlc1trZXldICsgJyIgJzsKICB9KTsKCiAgcmV0dXJuICcnICsgb2JqVGFnICsgYXR0cnNTdHJpbmcgKyAnPicgKyBwYXJhbXNTdHJpbmcgKyAnPC9vYmplY3Q+JzsKfTsKCi8vIFJ1biBGbGFzaCB0aHJvdWdoIHRoZSBSVE1QIGRlY29yYXRvcgpfZmxhc2hSdG1wMlsnZGVmYXVsdCddKEZsYXNoKTsKCl9jb21wb25lbnQyWydkZWZhdWx0J10ucmVnaXN0ZXJDb21wb25lbnQoJ0ZsYXNoJywgRmxhc2gpOwpfdGVjaDJbJ2RlZmF1bHQnXS5yZWdpc3RlclRlY2goJ0ZsYXNoJywgRmxhc2gpOwpleHBvcnRzWydkZWZhdWx0J10gPSBGbGFzaDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vY29tcG9uZW50Ijo2NSwiLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uL3V0aWxzL3RpbWUtcmFuZ2VzLmpzIjoxMzYsIi4uL3V0aWxzL3VybC5qcyI6MTM4LCIuL2ZsYXNoLXJ0bXAiOjExMSwiLi90ZWNoIjoxMTUsImdsb2JhbC93aW5kb3ciOjIsIm9iamVjdC5hc3NpZ24iOjQ1fV0sMTEzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGh0bWw1LmpzCiAqIEhUTUw1IE1lZGlhIENvbnRyb2xsZXIgLSBXcmFwcGVyIGZvciBIVE1MNSBNZWRpYSBBUEkKICovCgondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfdGVjaEpzID0gX2RlcmVxXygnLi90ZWNoLmpzJyk7Cgp2YXIgX3RlY2hKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWNoSnMpOwoKdmFyIF9jb21wb25lbnQgPSBfZGVyZXFfKCcuLi9jb21wb25lbnQnKTsKCnZhciBfY29tcG9uZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudCk7Cgp2YXIgX3V0aWxzRG9tSnMgPSBfZGVyZXFfKCcuLi91dGlscy9kb20uanMnKTsKCnZhciBEb20gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNEb21Kcyk7Cgp2YXIgX3V0aWxzVXJsSnMgPSBfZGVyZXFfKCcuLi91dGlscy91cmwuanMnKTsKCnZhciBVcmwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNVcmxKcyk7Cgp2YXIgX3V0aWxzRm5KcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNMb2dKcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZy5qcycpOwoKdmFyIF91dGlsc0xvZ0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzTG9nSnMpOwoKdmFyIF91dGlsc0Jyb3dzZXJKcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTsKCnZhciBicm93c2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzQnJvd3NlckpzKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF9vYmplY3RBc3NpZ24gPSBfZGVyZXFfKCdvYmplY3QuYXNzaWduJyk7Cgp2YXIgX29iamVjdEFzc2lnbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9vYmplY3RBc3NpZ24pOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uc0pzID0gX2RlcmVxXygnLi4vdXRpbHMvbWVyZ2Utb3B0aW9ucy5qcycpOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uc0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzTWVyZ2VPcHRpb25zSnMpOwoKLyoqCiAqIEhUTUw1IE1lZGlhIENvbnRyb2xsZXIgLSBXcmFwcGVyIGZvciBIVE1MNSBNZWRpYSBBUEkKICoKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zIE9iamVjdCBvZiBvcHRpb24gbmFtZXMgYW5kIHZhbHVlcwogKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcmVhZHkgUmVhZHkgY2FsbGJhY2sgZnVuY3Rpb24KICogQGV4dGVuZHMgVGVjaAogKiBAY2xhc3MgSHRtbDUKICovCgp2YXIgSHRtbDUgPSAoZnVuY3Rpb24gKF9UZWNoKSB7CiAgX2luaGVyaXRzKEh0bWw1LCBfVGVjaCk7CgogIGZ1bmN0aW9uIEh0bWw1KG9wdGlvbnMsIHJlYWR5KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSHRtbDUpOwoKICAgIF9UZWNoLmNhbGwodGhpcywgb3B0aW9ucywgcmVhZHkpOwoKICAgIHZhciBzb3VyY2UgPSBvcHRpb25zLnNvdXJjZTsKCiAgICAvLyBTZXQgdGhlIHNvdXJjZSBpZiBvbmUgaXMgcHJvdmlkZWQKICAgIC8vIDEpIENoZWNrIGlmIHRoZSBzb3VyY2UgaXMgbmV3IChpZiBub3QsIHdlIHdhbnQgdG8ga2VlcCB0aGUgb3JpZ2luYWwgc28gcGxheWJhY2sgaXNuJ3QgaW50ZXJydXB0ZWQpCiAgICAvLyAyKSBDaGVjayB0byBzZWUgaWYgdGhlIG5ldHdvcmsgc3RhdGUgb2YgdGhlIHRhZyB3YXMgZmFpbGVkIGF0IGluaXQsIGFuZCBpZiBzbywgcmVzZXQgdGhlIHNvdXJjZQogICAgLy8gYW55d2F5IHNvIHRoZSBlcnJvciBnZXRzIGZpcmVkLgogICAgaWYgKHNvdXJjZSAmJiAodGhpcy5lbF8uY3VycmVudFNyYyAhPT0gc291cmNlLnNyYyB8fCBvcHRpb25zLnRhZyAmJiBvcHRpb25zLnRhZy5pbml0TmV0d29ya1N0YXRlXyA9PT0gMykpIHsKICAgICAgdGhpcy5zZXRTb3VyY2Uoc291cmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaGFuZGxlTGF0ZUluaXRfKHRoaXMuZWxfKTsKICAgIH0KCiAgICBpZiAodGhpcy5lbF8uaGFzQ2hpbGROb2RlcygpKSB7CgogICAgICB2YXIgbm9kZXMgPSB0aGlzLmVsXy5jaGlsZE5vZGVzOwogICAgICB2YXIgbm9kZXNMZW5ndGggPSBub2Rlcy5sZW5ndGg7CiAgICAgIHZhciByZW1vdmVOb2RlcyA9IFtdOwoKICAgICAgd2hpbGUgKG5vZGVzTGVuZ3RoLS0pIHsKICAgICAgICB2YXIgbm9kZSA9IG5vZGVzW25vZGVzTGVuZ3RoXTsKICAgICAgICB2YXIgbm9kZU5hbWUgPSBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgogICAgICAgIGlmIChub2RlTmFtZSA9PT0gJ3RyYWNrJykgewogICAgICAgICAgaWYgKCF0aGlzLmZlYXR1cmVzTmF0aXZlVGV4dFRyYWNrcykgewogICAgICAgICAgICAvLyBFbXB0eSB2aWRlbyB0YWcgdHJhY2tzIHNvIHRoZSBidWlsdC1pbiBwbGF5ZXIgZG9lc24ndCB1c2UgdGhlbSBhbHNvLgogICAgICAgICAgICAvLyBUaGlzIG1heSBub3QgYmUgZmFzdCBlbm91Z2ggdG8gc3RvcCBIVE1MNSBicm93c2VycyBmcm9tIHJlYWRpbmcgdGhlIHRhZ3MKICAgICAgICAgICAgLy8gc28gd2UnbGwgbmVlZCB0byB0dXJuIG9mZiBhbnkgZGVmYXVsdCB0cmFja3MgaWYgd2UncmUgbWFudWFsbHkgZG9pbmcKICAgICAgICAgICAgLy8gY2FwdGlvbnMgYW5kIHN1YnRpdGxlcy4gdmlkZW9FbGVtZW50LnRleHRUcmFja3MKICAgICAgICAgICAgcmVtb3ZlTm9kZXMucHVzaChub2RlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHN0b3JlIEhUTUxUcmFja0VsZW1lbnQgYW5kIFRleHRUcmFjayB0byByZW1vdGUgbGlzdAogICAgICAgICAgICB0aGlzLnJlbW90ZVRleHRUcmFja0VscygpLmFkZFRyYWNrRWxlbWVudF8obm9kZSk7CiAgICAgICAgICAgIHRoaXMucmVtb3RlVGV4dFRyYWNrcygpLmFkZFRyYWNrXyhub2RlLnRyYWNrKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3ZlTm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLmVsXy5yZW1vdmVDaGlsZChyZW1vdmVOb2Rlc1tpXSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5mZWF0dXJlc05hdGl2ZVRleHRUcmFja3MpIHsKICAgICAgdGhpcy5oYW5kbGVUZXh0VHJhY2tDaGFuZ2VfID0gRm4uYmluZCh0aGlzLCB0aGlzLmhhbmRsZVRleHRUcmFja0NoYW5nZSk7CiAgICAgIHRoaXMuaGFuZGxlVGV4dFRyYWNrQWRkXyA9IEZuLmJpbmQodGhpcywgdGhpcy5oYW5kbGVUZXh0VHJhY2tBZGQpOwogICAgICB0aGlzLmhhbmRsZVRleHRUcmFja1JlbW92ZV8gPSBGbi5iaW5kKHRoaXMsIHRoaXMuaGFuZGxlVGV4dFRyYWNrUmVtb3ZlKTsKICAgICAgdGhpcy5wcm94eU5hdGl2ZVRleHRUcmFja3NfKCk7CiAgICB9CgogICAgLy8gRGV0ZXJtaW5lIGlmIG5hdGl2ZSBjb250cm9scyBzaG91bGQgYmUgdXNlZAogICAgLy8gT3VyIGdvYWwgc2hvdWxkIGJlIHRvIGdldCB0aGUgY3VzdG9tIGNvbnRyb2xzIG9uIG1vYmlsZSBzb2xpZCBldmVyeXdoZXJlCiAgICAvLyBzbyB3ZSBjYW4gcmVtb3ZlIHRoaXMgYWxsIHRvZ2V0aGVyLiBSaWdodCBub3cgdGhpcyB3aWxsIGJsb2NrIGN1c3RvbQogICAgLy8gY29udHJvbHMgb24gdG91Y2ggZW5hYmxlZCBsYXB0b3BzIGxpa2UgdGhlIENocm9tZSBQaXhlbAogICAgaWYgKGJyb3dzZXIuVE9VQ0hfRU5BQkxFRCAmJiBvcHRpb25zLm5hdGl2ZUNvbnRyb2xzRm9yVG91Y2ggPT09IHRydWUgfHwgYnJvd3Nlci5JU19JUEhPTkUgfHwgYnJvd3Nlci5JU19OQVRJVkVfQU5EUk9JRCkgewogICAgICB0aGlzLnNldENvbnRyb2xzKHRydWUpOwogICAgfQoKICAgIHRoaXMudHJpZ2dlclJlYWR5KCk7CiAgfQoKICAvKiBIVE1MNSBTdXBwb3J0IFRlc3RpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKICAvKgogICogRWxlbWVudCBmb3IgdGVzdGluZyBicm93c2VyIEhUTUw1IHZpZGVvIGNhcGFiaWxpdGllcwogICoKICAqIEB0eXBlIHtFbGVtZW50fQogICogQGNvbnN0YW50CiAgKiBAcHJpdmF0ZQogICovCgogIC8qKgogICAqIERpc3Bvc2Ugb2YgaHRtbDUgbWVkaWEgZWxlbWVudAogICAqCiAgICogQG1ldGhvZCBkaXNwb3NlCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgIHZhciB0dCA9IHRoaXMuZWwoKS50ZXh0VHJhY2tzOwogICAgdmFyIGVtdWxhdGVkVHQgPSB0aGlzLnRleHRUcmFja3MoKTsKCiAgICAvLyByZW1vdmUgbmF0aXZlIGV2ZW50IGxpc3RlbmVycwogICAgaWYgKHR0ICYmIHR0LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHsKICAgICAgdHQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5oYW5kbGVUZXh0VHJhY2tDaGFuZ2VfKTsKICAgICAgdHQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCB0aGlzLmhhbmRsZVRleHRUcmFja0FkZF8pOwogICAgICB0dC5yZW1vdmVFdmVudExpc3RlbmVyKCdyZW1vdmV0cmFjaycsIHRoaXMuaGFuZGxlVGV4dFRyYWNrUmVtb3ZlXyk7CiAgICB9CgogICAgLy8gY2xlYXJvdXQgdGhlIGVtdWxhdGVkIHRleHQgdHJhY2sgbGlzdC4KICAgIHZhciBpID0gZW11bGF0ZWRUdC5sZW5ndGg7CgogICAgd2hpbGUgKGktLSkgewogICAgICBlbXVsYXRlZFR0LnJlbW92ZVRyYWNrXyhlbXVsYXRlZFR0W2ldKTsKICAgIH0KCiAgICBIdG1sNS5kaXNwb3NlTWVkaWFFbGVtZW50KHRoaXMuZWxfKTsKICAgIF9UZWNoLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5jcmVhdGVFbCA9IGZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogICAgdmFyIGVsID0gdGhpcy5vcHRpb25zXy50YWc7CgogICAgLy8gQ2hlY2sgaWYgdGhpcyBicm93c2VyIHN1cHBvcnRzIG1vdmluZyB0aGUgZWxlbWVudCBpbnRvIHRoZSBib3guCiAgICAvLyBPbiB0aGUgaVBob25lIHZpZGVvIHdpbGwgYnJlYWsgaWYgeW91IG1vdmUgdGhlIGVsZW1lbnQsCiAgICAvLyBTbyB3ZSBoYXZlIHRvIGNyZWF0ZSBhIGJyYW5kIG5ldyBlbGVtZW50LgogICAgaWYgKCFlbCB8fCB0aGlzWydtb3ZpbmdNZWRpYUVsZW1lbnRJbkRPTSddID09PSBmYWxzZSkgewoKICAgICAgLy8gSWYgdGhlIG9yaWdpbmFsIHRhZyBpcyBzdGlsbCB0aGVyZSwgY2xvbmUgYW5kIHJlbW92ZSBpdC4KICAgICAgaWYgKGVsKSB7CiAgICAgICAgdmFyIGNsb25lID0gZWwuY2xvbmVOb2RlKHRydWUpOwogICAgICAgIGVsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNsb25lLCBlbCk7CiAgICAgICAgSHRtbDUuZGlzcG9zZU1lZGlhRWxlbWVudChlbCk7CiAgICAgICAgZWwgPSBjbG9uZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlbCA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCd2aWRlbycpOwoKICAgICAgICAvLyBkZXRlcm1pbmUgaWYgbmF0aXZlIGNvbnRyb2xzIHNob3VsZCBiZSB1c2VkCiAgICAgICAgdmFyIHRhZ0F0dHJpYnV0ZXMgPSB0aGlzLm9wdGlvbnNfLnRhZyAmJiBEb20uZ2V0RWxBdHRyaWJ1dGVzKHRoaXMub3B0aW9uc18udGFnKTsKICAgICAgICB2YXIgYXR0cmlidXRlcyA9IF91dGlsc01lcmdlT3B0aW9uc0pzMlsnZGVmYXVsdCddKHt9LCB0YWdBdHRyaWJ1dGVzKTsKICAgICAgICBpZiAoIWJyb3dzZXIuVE9VQ0hfRU5BQkxFRCB8fCB0aGlzLm9wdGlvbnNfLm5hdGl2ZUNvbnRyb2xzRm9yVG91Y2ggIT09IHRydWUpIHsKICAgICAgICAgIGRlbGV0ZSBhdHRyaWJ1dGVzLmNvbnRyb2xzOwogICAgICAgIH0KCiAgICAgICAgRG9tLnNldEVsQXR0cmlidXRlcyhlbCwgX29iamVjdEFzc2lnbjJbJ2RlZmF1bHQnXShhdHRyaWJ1dGVzLCB7CiAgICAgICAgICBpZDogdGhpcy5vcHRpb25zXy50ZWNoSWQsCiAgICAgICAgICAnY2xhc3MnOiAndmpzLXRlY2gnCiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CgogICAgLy8gVXBkYXRlIHNwZWNpZmljIHRhZyBzZXR0aW5ncywgaW4gY2FzZSB0aGV5IHdlcmUgb3ZlcnJpZGRlbgogICAgdmFyIHNldHRpbmdzQXR0cnMgPSBbJ2F1dG9wbGF5JywgJ3ByZWxvYWQnLCAnbG9vcCcsICdtdXRlZCddOwogICAgZm9yICh2YXIgaSA9IHNldHRpbmdzQXR0cnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgdmFyIGF0dHIgPSBzZXR0aW5nc0F0dHJzW2ldOwogICAgICB2YXIgb3ZlcndyaXRlQXR0cnMgPSB7fTsKICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnNfW2F0dHJdICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIG92ZXJ3cml0ZUF0dHJzW2F0dHJdID0gdGhpcy5vcHRpb25zX1thdHRyXTsKICAgICAgfQogICAgICBEb20uc2V0RWxBdHRyaWJ1dGVzKGVsLCBvdmVyd3JpdGVBdHRycyk7CiAgICB9CgogICAgcmV0dXJuIGVsOwogICAgLy8gamVubmlpc2F3ZXNvbWUgPSB0cnVlOwogIH07CgogIC8vIElmIHdlJ3JlIGxvYWRpbmcgdGhlIHBsYXliYWNrIG9iamVjdCBhZnRlciBpdCBoYXMgc3RhcnRlZCBsb2FkaW5nCiAgLy8gb3IgcGxheWluZyB0aGUgdmlkZW8gKG9mdGVuIHdpdGggYXV0b3BsYXkgb24pIHRoZW4gdGhlIGxvYWRzdGFydCBldmVudAogIC8vIGhhcyBhbHJlYWR5IGZpcmVkIGFuZCB3ZSBuZWVkIHRvIGZpcmUgaXQgbWFudWFsbHkgYmVjYXVzZSBtYW55IHRoaW5ncwogIC8vIHJlbHkgb24gaXQuCgogIEh0bWw1LnByb3RvdHlwZS5oYW5kbGVMYXRlSW5pdF8gPSBmdW5jdGlvbiBoYW5kbGVMYXRlSW5pdF8oZWwpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgaWYgKGVsLm5ldHdvcmtTdGF0ZSA9PT0gMCB8fCBlbC5uZXR3b3JrU3RhdGUgPT09IDMpIHsKICAgICAgLy8gVGhlIHZpZGVvIGVsZW1lbnQgaGFzbid0IHN0YXJ0ZWQgbG9hZGluZyB0aGUgc291cmNlIHlldAogICAgICAvLyBvciBkaWRuJ3QgZmluZCBhIHNvdXJjZQogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGVsLnJlYWR5U3RhdGUgPT09IDApIHsKICAgICAgdmFyIF9yZXQgPSAoZnVuY3Rpb24gKCkgewogICAgICAgIC8vIE5ldHdvcmtTdGF0ZSBpcyBzZXQgc3luY2hyb25vdXNseSBCVVQgbG9hZHN0YXJ0IGlzIGZpcmVkIGF0IHRoZQogICAgICAgIC8vIGVuZCBvZiB0aGUgY3VycmVudCBzdGFjaywgdXN1YWxseSBiZWZvcmUgc2V0SW50ZXJ2YWwoZm4sIDApLgogICAgICAgIC8vIFNvIGF0IHRoaXMgcG9pbnQgd2Uga25vdyBsb2Fkc3RhcnQgbWF5IGhhdmUgYWxyZWFkeSBmaXJlZCBvciBpcwogICAgICAgIC8vIGFib3V0IHRvIGZpcmUsIGFuZCBlaXRoZXIgd2F5IHRoZSBwbGF5ZXIgaGFzbid0IHNlZW4gaXQgeWV0LgogICAgICAgIC8vIFdlIGRvbid0IHdhbnQgdG8gZmlyZSBsb2Fkc3RhcnQgcHJlbWF0dXJlbHkgaGVyZSBhbmQgY2F1c2UgYQogICAgICAgIC8vIGRvdWJsZSBsb2Fkc3RhcnQgc28gd2UnbGwgd2FpdCBhbmQgc2VlIGlmIGl0IGhhcHBlbnMgYmV0d2VlbiBub3cKICAgICAgICAvLyBhbmQgdGhlIG5leHQgbG9vcCwgYW5kIGZpcmUgaXQgaWYgbm90LgogICAgICAgIC8vIEhPV0VWRVIsIHdlIGFsc28gd2FudCB0byBtYWtlIHN1cmUgaXQgZmlyZXMgYmVmb3JlIGxvYWRlZG1ldGFkYXRhCiAgICAgICAgLy8gd2hpY2ggY291bGQgYWxzbyBoYXBwZW4gYmV0d2VlbiBub3cgYW5kIHRoZSBuZXh0IGxvb3AsIHNvIHdlJ2xsCiAgICAgICAgLy8gd2F0Y2ggZm9yIHRoYXQgYWxzby4KICAgICAgICB2YXIgbG9hZHN0YXJ0RmlyZWQgPSBmYWxzZTsKICAgICAgICB2YXIgc2V0TG9hZHN0YXJ0RmlyZWQgPSBmdW5jdGlvbiBzZXRMb2Fkc3RhcnRGaXJlZCgpIHsKICAgICAgICAgIGxvYWRzdGFydEZpcmVkID0gdHJ1ZTsKICAgICAgICB9OwogICAgICAgIF90aGlzLm9uKCdsb2Fkc3RhcnQnLCBzZXRMb2Fkc3RhcnRGaXJlZCk7CgogICAgICAgIHZhciB0cmlnZ2VyTG9hZHN0YXJ0ID0gZnVuY3Rpb24gdHJpZ2dlckxvYWRzdGFydCgpIHsKICAgICAgICAgIC8vIFdlIGRpZCBtaXNzIHRoZSBvcmlnaW5hbCBsb2Fkc3RhcnQuIE1ha2Ugc3VyZSB0aGUgcGxheWVyCiAgICAgICAgICAvLyBzZWVzIGxvYWRzdGFydCBiZWZvcmUgbG9hZGVkbWV0YWRhdGEKICAgICAgICAgIGlmICghbG9hZHN0YXJ0RmlyZWQpIHsKICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdsb2Fkc3RhcnQnKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLm9uKCdsb2FkZWRtZXRhZGF0YScsIHRyaWdnZXJMb2Fkc3RhcnQpOwoKICAgICAgICBfdGhpcy5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aGlzLm9mZignbG9hZHN0YXJ0Jywgc2V0TG9hZHN0YXJ0RmlyZWQpOwogICAgICAgICAgdGhpcy5vZmYoJ2xvYWRlZG1ldGFkYXRhJywgdHJpZ2dlckxvYWRzdGFydCk7CgogICAgICAgICAgaWYgKCFsb2Fkc3RhcnRGaXJlZCkgewogICAgICAgICAgICAvLyBXZSBkaWQgbWlzcyB0aGUgb3JpZ2luYWwgbmF0aXZlIGxvYWRzdGFydC4gRmlyZSBpdCBub3cuCiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignbG9hZHN0YXJ0Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2OiB1bmRlZmluZWQKICAgICAgICB9OwogICAgICB9KSgpOwoKICAgICAgaWYgKHR5cGVvZiBfcmV0ID09PSAnb2JqZWN0JykgcmV0dXJuIF9yZXQudjsKICAgIH0KCiAgICAvLyBGcm9tIGhlcmUgb24gd2Uga25vdyB0aGF0IGxvYWRzdGFydCBhbHJlYWR5IGZpcmVkIGFuZCB3ZSBtaXNzZWQgaXQuCiAgICAvLyBUaGUgb3RoZXIgcmVhZHlTdGF0ZSBldmVudHMgYXJlbid0IGFzIG11Y2ggb2YgYSBwcm9ibGVtIGlmIHdlIGRvdWJsZQogICAgLy8gdGhlbSwgc28gbm90IGdvaW5nIHRvIGdvIHRvIGFzIG11Y2ggdHJvdWJsZSBhcyBsb2Fkc3RhcnQgdG8gcHJldmVudAogICAgLy8gdGhhdCB1bmxlc3Mgd2UgZmluZCByZWFzb24gdG8uCiAgICB2YXIgZXZlbnRzVG9UcmlnZ2VyID0gWydsb2Fkc3RhcnQnXTsKCiAgICAvLyBsb2FkZWRtZXRhZGF0YTogbmV3bHkgZXF1YWwgdG8gSEFWRV9NRVRBREFUQSAoMSkgb3IgZ3JlYXRlcgogICAgZXZlbnRzVG9UcmlnZ2VyLnB1c2goJ2xvYWRlZG1ldGFkYXRhJyk7CgogICAgLy8gbG9hZGVkZGF0YTogbmV3bHkgaW5jcmVhc2VkIHRvIEhBVkVfQ1VSUkVOVF9EQVRBICgyKSBvciBncmVhdGVyCiAgICBpZiAoZWwucmVhZHlTdGF0ZSA+PSAyKSB7CiAgICAgIGV2ZW50c1RvVHJpZ2dlci5wdXNoKCdsb2FkZWRkYXRhJyk7CiAgICB9CgogICAgLy8gY2FucGxheTogbmV3bHkgaW5jcmVhc2VkIHRvIEhBVkVfRlVUVVJFX0RBVEEgKDMpIG9yIGdyZWF0ZXIKICAgIGlmIChlbC5yZWFkeVN0YXRlID49IDMpIHsKICAgICAgZXZlbnRzVG9UcmlnZ2VyLnB1c2goJ2NhbnBsYXknKTsKICAgIH0KCiAgICAvLyBjYW5wbGF5dGhyb3VnaDogbmV3bHkgZXF1YWwgdG8gSEFWRV9FTk9VR0hfREFUQSAoNCkKICAgIGlmIChlbC5yZWFkeVN0YXRlID49IDQpIHsKICAgICAgZXZlbnRzVG9UcmlnZ2VyLnB1c2goJ2NhbnBsYXl0aHJvdWdoJyk7CiAgICB9CgogICAgLy8gV2Ugc3RpbGwgbmVlZCB0byBnaXZlIHRoZSBwbGF5ZXIgdGltZSB0byBhZGQgZXZlbnQgbGlzdGVuZXJzCiAgICB0aGlzLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgZXZlbnRzVG9UcmlnZ2VyLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICB0aGlzLnRyaWdnZXIodHlwZSk7CiAgICAgIH0sIHRoaXMpOwogICAgfSk7CiAgfTsKCiAgSHRtbDUucHJvdG90eXBlLnByb3h5TmF0aXZlVGV4dFRyYWNrc18gPSBmdW5jdGlvbiBwcm94eU5hdGl2ZVRleHRUcmFja3NfKCkgewogICAgdmFyIHR0ID0gdGhpcy5lbCgpLnRleHRUcmFja3M7CgogICAgaWYgKHR0ICYmIHR0LmFkZEV2ZW50TGlzdGVuZXIpIHsKICAgICAgdHQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5oYW5kbGVUZXh0VHJhY2tDaGFuZ2VfKTsKICAgICAgdHQuYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCB0aGlzLmhhbmRsZVRleHRUcmFja0FkZF8pOwogICAgICB0dC5hZGRFdmVudExpc3RlbmVyKCdyZW1vdmV0cmFjaycsIHRoaXMuaGFuZGxlVGV4dFRyYWNrUmVtb3ZlXyk7CiAgICB9CiAgfTsKCiAgSHRtbDUucHJvdG90eXBlLmhhbmRsZVRleHRUcmFja0NoYW5nZSA9IGZ1bmN0aW9uIGhhbmRsZVRleHRUcmFja0NoYW5nZShlKSB7CiAgICB2YXIgdHQgPSB0aGlzLnRleHRUcmFja3MoKTsKICAgIHRoaXMudGV4dFRyYWNrcygpLnRyaWdnZXIoewogICAgICB0eXBlOiAnY2hhbmdlJywKICAgICAgdGFyZ2V0OiB0dCwKICAgICAgY3VycmVudFRhcmdldDogdHQsCiAgICAgIHNyY0VsZW1lbnQ6IHR0CiAgICB9KTsKICB9OwoKICBIdG1sNS5wcm90b3R5cGUuaGFuZGxlVGV4dFRyYWNrQWRkID0gZnVuY3Rpb24gaGFuZGxlVGV4dFRyYWNrQWRkKGUpIHsKICAgIHRoaXMudGV4dFRyYWNrcygpLmFkZFRyYWNrXyhlLnRyYWNrKTsKICB9OwoKICBIdG1sNS5wcm90b3R5cGUuaGFuZGxlVGV4dFRyYWNrUmVtb3ZlID0gZnVuY3Rpb24gaGFuZGxlVGV4dFRyYWNrUmVtb3ZlKGUpIHsKICAgIHRoaXMudGV4dFRyYWNrcygpLnJlbW92ZVRyYWNrXyhlLnRyYWNrKTsKICB9OwoKICAvKioKICAgKiBQbGF5IGZvciBodG1sNSB0ZWNoCiAgICoKICAgKiBAbWV0aG9kIHBsYXkKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiBwbGF5KCkgewogICAgdGhpcy5lbF8ucGxheSgpOwogIH07CgogIC8qKgogICAqIFBhdXNlIGZvciBodG1sNSB0ZWNoCiAgICoKICAgKiBAbWV0aG9kIHBhdXNlCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgdGhpcy5lbF8ucGF1c2UoKTsKICB9OwoKICAvKioKICAgKiBQYXVzZWQgZm9yIGh0bWw1IHRlY2gKICAgKgogICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICogQG1ldGhvZCBwYXVzZWQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnBhdXNlZCA9IGZ1bmN0aW9uIHBhdXNlZCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5wYXVzZWQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IGN1cnJlbnQgdGltZQogICAqCiAgICogQHJldHVybiB7TnVtYmVyfQogICAqIEBtZXRob2QgY3VycmVudFRpbWUKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmN1cnJlbnRUaW1lID0gZnVuY3Rpb24gY3VycmVudFRpbWUoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8uY3VycmVudFRpbWU7CiAgfTsKCiAgLyoqCiAgICogU2V0IGN1cnJlbnQgdGltZQogICAqCiAgICogQHBhcmFtIHtOdW1iZXJ9IHNlY29uZHMgQ3VycmVudCB0aW1lIG9mIHZpZGVvCiAgICogQG1ldGhvZCBzZXRDdXJyZW50VGltZQogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuc2V0Q3VycmVudFRpbWUgPSBmdW5jdGlvbiBzZXRDdXJyZW50VGltZShzZWNvbmRzKSB7CiAgICB0cnkgewogICAgICB0aGlzLmVsXy5jdXJyZW50VGltZSA9IHNlY29uZHM7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIF91dGlsc0xvZ0pzMlsnZGVmYXVsdCddKGUsICdWaWRlbyBpcyBub3QgcmVhZHkuIChWaWRlby5qcyknKTsKICAgICAgLy8gdGhpcy53YXJuaW5nKFZpZGVvSlMud2FybmluZ3MudmlkZW9Ob3RSZWFkeSk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogR2V0IGR1cmF0aW9uCiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9CiAgICogQG1ldGhvZCBkdXJhdGlvbgogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuZHVyYXRpb24gPSBmdW5jdGlvbiBkdXJhdGlvbigpIHsKICAgIHJldHVybiB0aGlzLmVsXy5kdXJhdGlvbiB8fCAwOwogIH07CgogIC8qKgogICAqIEdldCBhIFRpbWVSYW5nZSBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSBpbnRlcnNlY3Rpb24KICAgKiBvZiB0aGUgdGltZSByYW5nZXMgZm9yIHdoaWNoIHRoZSB1c2VyIGFnZW50IGhhcyBhbGwKICAgKiByZWxldmFudCBtZWRpYQogICAqCiAgICogQHJldHVybiB7VGltZVJhbmdlT2JqZWN0fQogICAqIEBtZXRob2QgYnVmZmVyZWQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmJ1ZmZlcmVkID0gZnVuY3Rpb24gYnVmZmVyZWQoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8uYnVmZmVyZWQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IHZvbHVtZSBsZXZlbAogICAqCiAgICogQHJldHVybiB7TnVtYmVyfQogICAqIEBtZXRob2Qgdm9sdW1lCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS52b2x1bWUgPSBmdW5jdGlvbiB2b2x1bWUoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8udm9sdW1lOwogIH07CgogIC8qKgogICAqIFNldCB2b2x1bWUgbGV2ZWwKICAgKgogICAqIEBwYXJhbSB7TnVtYmVyfSBwZXJjZW50QXNEZWNpbWFsIFZvbHVtZSBwZXJjZW50IGFzIGEgZGVjaW1hbAogICAqIEBtZXRob2Qgc2V0Vm9sdW1lCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5zZXRWb2x1bWUgPSBmdW5jdGlvbiBzZXRWb2x1bWUocGVyY2VudEFzRGVjaW1hbCkgewogICAgdGhpcy5lbF8udm9sdW1lID0gcGVyY2VudEFzRGVjaW1hbDsKICB9OwoKICAvKioKICAgKiBHZXQgaWYgbXV0ZWQKICAgKgogICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICogQG1ldGhvZCBtdXRlZAogICAqLwoKICBIdG1sNS5wcm90b3R5cGUubXV0ZWQgPSBmdW5jdGlvbiBtdXRlZCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5tdXRlZDsKICB9OwoKICAvKioKICAgKiBTZXQgbXV0ZWQKICAgKgogICAqIEBwYXJhbSB7Qm9vbGVhbn0gSWYgcGxheWVyIGlzIHRvIGJlIG11dGVkIG9yIG5vdGUKICAgKiBAbWV0aG9kIHNldE11dGVkCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5zZXRNdXRlZCA9IGZ1bmN0aW9uIHNldE11dGVkKG11dGVkKSB7CiAgICB0aGlzLmVsXy5tdXRlZCA9IG11dGVkOwogIH07CgogIC8qKgogICAqIEdldCBwbGF5ZXIgd2lkdGgKICAgKgogICAqIEByZXR1cm4ge051bWJlcn0KICAgKiBAbWV0aG9kIHdpZHRoCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS53aWR0aCA9IGZ1bmN0aW9uIHdpZHRoKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLm9mZnNldFdpZHRoOwogIH07CgogIC8qKgogICAqIEdldCBwbGF5ZXIgaGVpZ2h0CiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9CiAgICogQG1ldGhvZCBoZWlnaHQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmhlaWdodCA9IGZ1bmN0aW9uIGhlaWdodCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5vZmZzZXRIZWlnaHQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IGlmIHRoZXJlIGlzIGZ1bGxzY3JlZW4gc3VwcG9ydAogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKiBAbWV0aG9kIHN1cHBvcnRzRnVsbFNjcmVlbgogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuc3VwcG9ydHNGdWxsU2NyZWVuID0gZnVuY3Rpb24gc3VwcG9ydHNGdWxsU2NyZWVuKCkgewogICAgaWYgKHR5cGVvZiB0aGlzLmVsXy53ZWJraXRFbnRlckZ1bGxTY3JlZW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgdmFyIHVzZXJBZ2VudCA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10ubmF2aWdhdG9yLnVzZXJBZ2VudDsKICAgICAgLy8gU2VlbXMgdG8gYmUgYnJva2VuIGluIENocm9taXVtL0Nocm9tZSAmJiBTYWZhcmkgaW4gTGVvcGFyZAogICAgICBpZiAoL0FuZHJvaWQvLnRlc3QodXNlckFnZW50KSB8fCAhL0Nocm9tZXxNYWMgT1MgWCAxMC41Ly50ZXN0KHVzZXJBZ2VudCkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGZhbHNlOwogIH07CgogIC8qKgogICAqIFJlcXVlc3QgdG8gZW50ZXIgZnVsbHNjcmVlbgogICAqCiAgICogQG1ldGhvZCBlbnRlckZ1bGxTY3JlZW4KICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmVudGVyRnVsbFNjcmVlbiA9IGZ1bmN0aW9uIGVudGVyRnVsbFNjcmVlbigpIHsKICAgIHZhciB2aWRlbyA9IHRoaXMuZWxfOwoKICAgIGlmICgnd2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW4nIGluIHZpZGVvKSB7CiAgICAgIHRoaXMub25lKCd3ZWJraXRiZWdpbmZ1bGxzY3JlZW4nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5vbmUoJ3dlYmtpdGVuZGZ1bGxzY3JlZW4nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2Z1bGxzY3JlZW5jaGFuZ2UnLCB7IGlzRnVsbHNjcmVlbjogZmFsc2UgfSk7CiAgICAgICAgfSk7CgogICAgICAgIHRoaXMudHJpZ2dlcignZnVsbHNjcmVlbmNoYW5nZScsIHsgaXNGdWxsc2NyZWVuOiB0cnVlIH0pOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAodmlkZW8ucGF1c2VkICYmIHZpZGVvLm5ldHdvcmtTdGF0ZSA8PSB2aWRlby5IQVZFX01FVEFEQVRBKSB7CiAgICAgIC8vIGF0dGVtcHQgdG8gcHJpbWUgdGhlIHZpZGVvIGVsZW1lbnQgZm9yIHByb2dyYW1tYXRpYyBhY2Nlc3MKICAgICAgLy8gdGhpcyBpc24ndCBuZWNlc3Nhcnkgb24gdGhlIGRlc2t0b3AgYnV0IHNob3VsZG4ndCBodXJ0CiAgICAgIHRoaXMuZWxfLnBsYXkoKTsKCiAgICAgIC8vIHBsYXlpbmcgYW5kIHBhdXNpbmcgc3luY2hyb25vdXNseSBkdXJpbmcgdGhlIHRyYW5zaXRpb24gdG8gZnVsbHNjcmVlbgogICAgICAvLyBjYW4gZ2V0IGlPUyB+Ni4xIGRldmljZXMgaW50byBhIHBsYXkvcGF1c2UgbG9vcAogICAgICB0aGlzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHZpZGVvLnBhdXNlKCk7CiAgICAgICAgdmlkZW8ud2Via2l0RW50ZXJGdWxsU2NyZWVuKCk7CiAgICAgIH0sIDApOwogICAgfSBlbHNlIHsKICAgICAgdmlkZW8ud2Via2l0RW50ZXJGdWxsU2NyZWVuKCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogUmVxdWVzdCB0byBleGl0IGZ1bGxzY3JlZW4KICAgKgogICAqIEBtZXRob2QgZXhpdEZ1bGxTY3JlZW4KICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmV4aXRGdWxsU2NyZWVuID0gZnVuY3Rpb24gZXhpdEZ1bGxTY3JlZW4oKSB7CiAgICB0aGlzLmVsXy53ZWJraXRFeGl0RnVsbFNjcmVlbigpOwogIH07CgogIC8qKgogICAqIEdldC9zZXQgdmlkZW8KICAgKgogICAqIEBwYXJhbSB7T2JqZWN0PX0gc3JjIFNvdXJjZSBvYmplY3QKICAgKiBAcmV0dXJuIHtPYmplY3R9CiAgICogQG1ldGhvZCBzcmMKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnNyYyA9IGZ1bmN0aW9uIHNyYyhfc3JjKSB7CiAgICBpZiAoX3NyYyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzLmVsXy5zcmM7CiAgICB9IGVsc2UgewogICAgICAvLyBTZXR0aW5nIHNyYyB0aHJvdWdoIGBzcmNgIGluc3RlYWQgb2YgYHNldFNyY2Agd2lsbCBiZSBkZXByZWNhdGVkCiAgICAgIHRoaXMuc2V0U3JjKF9zcmMpOwogICAgfQogIH07CgogIC8qKgogICAqIFNldCB2aWRlbwogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IHNyYyBTb3VyY2Ugb2JqZWN0CiAgICogQGRlcHJlY2F0ZWQKICAgKiBAbWV0aG9kIHNldFNyYwogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuc2V0U3JjID0gZnVuY3Rpb24gc2V0U3JjKHNyYykgewogICAgdGhpcy5lbF8uc3JjID0gc3JjOwogIH07CgogIC8qKgogICAqIExvYWQgbWVkaWEgaW50byBwbGF5ZXIKICAgKgogICAqIEBtZXRob2QgbG9hZAogICAqLwoKICBIdG1sNS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIGxvYWQoKSB7CiAgICB0aGlzLmVsXy5sb2FkKCk7CiAgfTsKCiAgLyoqCiAgICogUmVzZXQgdGhlIHRlY2guIFJlbW92ZXMgYWxsIHNvdXJjZXMgYW5kIGNhbGxzIGBsb2FkYC4KICAgKgogICAqIEBtZXRob2QgcmVzZXQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQoKSB7CiAgICBIdG1sNS5yZXNldE1lZGlhRWxlbWVudCh0aGlzLmVsXyk7CiAgfTsKCiAgLyoqCiAgICogR2V0IGN1cnJlbnQgc291cmNlCiAgICoKICAgKiBAcmV0dXJuIHtPYmplY3R9CiAgICogQG1ldGhvZCBjdXJyZW50U3JjCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5jdXJyZW50U3JjID0gZnVuY3Rpb24gY3VycmVudFNyYygpIHsKICAgIGlmICh0aGlzLmN1cnJlbnRTb3VyY2VfKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTb3VyY2VfLnNyYzsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLmVsXy5jdXJyZW50U3JjOwogICAgfQogIH07CgogIC8qKgogICAqIEdldCBwb3N0ZXIKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30KICAgKiBAbWV0aG9kIHBvc3RlcgogICAqLwoKICBIdG1sNS5wcm90b3R5cGUucG9zdGVyID0gZnVuY3Rpb24gcG9zdGVyKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLnBvc3RlcjsKICB9OwoKICAvKioKICAgKiBTZXQgcG9zdGVyCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsIFVSTCB0byBwb3N0ZXIgaW1hZ2UKICAgKiBAbWV0aG9kCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5zZXRQb3N0ZXIgPSBmdW5jdGlvbiBzZXRQb3N0ZXIodmFsKSB7CiAgICB0aGlzLmVsXy5wb3N0ZXIgPSB2YWw7CiAgfTsKCiAgLyoqCiAgICogR2V0IHByZWxvYWQgYXR0cmlidXRlCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBwcmVsb2FkCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24gcHJlbG9hZCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5wcmVsb2FkOwogIH07CgogIC8qKgogICAqIFNldCBwcmVsb2FkIGF0dHJpYnV0ZQogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IHZhbCBWYWx1ZSBmb3IgcHJlbG9hZCBhdHRyaWJ1dGUKICAgKiBAbWV0aG9kIHNldFByZWxvYWQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnNldFByZWxvYWQgPSBmdW5jdGlvbiBzZXRQcmVsb2FkKHZhbCkgewogICAgdGhpcy5lbF8ucHJlbG9hZCA9IHZhbDsKICB9OwoKICAvKioKICAgKiBHZXQgYXV0b3BsYXkgYXR0cmlidXRlCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBhdXRvcGxheQogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuYXV0b3BsYXkgPSBmdW5jdGlvbiBhdXRvcGxheSgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5hdXRvcGxheTsKICB9OwoKICAvKioKICAgKiBTZXQgYXV0b3BsYXkgYXR0cmlidXRlCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsIFZhbHVlIGZvciBwcmVsb2FkIGF0dHJpYnV0ZQogICAqIEBtZXRob2Qgc2V0QXV0b3BsYXkKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnNldEF1dG9wbGF5ID0gZnVuY3Rpb24gc2V0QXV0b3BsYXkodmFsKSB7CiAgICB0aGlzLmVsXy5hdXRvcGxheSA9IHZhbDsKICB9OwoKICAvKioKICAgKiBHZXQgY29udHJvbHMgYXR0cmlidXRlCiAgICoKICAgKiBAcmV0dXJuIHtTdHJpbmd9CiAgICogQG1ldGhvZCBjb250cm9scwogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuY29udHJvbHMgPSBmdW5jdGlvbiBjb250cm9scygpIHsKICAgIHJldHVybiB0aGlzLmVsXy5jb250cm9sczsKICB9OwoKICAvKioKICAgKiBTZXQgY29udHJvbHMgYXR0cmlidXRlCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsIFZhbHVlIGZvciBjb250cm9scyBhdHRyaWJ1dGUKICAgKiBAbWV0aG9kIHNldENvbnRyb2xzCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5zZXRDb250cm9scyA9IGZ1bmN0aW9uIHNldENvbnRyb2xzKHZhbCkgewogICAgdGhpcy5lbF8uY29udHJvbHMgPSAhIXZhbDsKICB9OwoKICAvKioKICAgKiBHZXQgbG9vcCBhdHRyaWJ1dGUKICAgKgogICAqIEByZXR1cm4ge1N0cmluZ30KICAgKiBAbWV0aG9kIGxvb3AKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmxvb3AgPSBmdW5jdGlvbiBsb29wKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLmxvb3A7CiAgfTsKCiAgLyoqCiAgICogU2V0IGxvb3AgYXR0cmlidXRlCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsIFZhbHVlIGZvciBsb29wIGF0dHJpYnV0ZQogICAqIEBtZXRob2Qgc2V0TG9vcAogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuc2V0TG9vcCA9IGZ1bmN0aW9uIHNldExvb3AodmFsKSB7CiAgICB0aGlzLmVsXy5sb29wID0gdmFsOwogIH07CgogIC8qKgogICAqIEdldCBlcnJvciB2YWx1ZQogICAqCiAgICogQHJldHVybiB7U3RyaW5nfQogICAqIEBtZXRob2QgZXJyb3IKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gZXJyb3IoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8uZXJyb3I7CiAgfTsKCiAgLyoqCiAgICogR2V0IHdoZXRoZXIgb3Igbm90IHRoZSBwbGF5ZXIgaXMgaW4gdGhlICJzZWVraW5nIiBzdGF0ZQogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKiBAbWV0aG9kIHNlZWtpbmcKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnNlZWtpbmcgPSBmdW5jdGlvbiBzZWVraW5nKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLnNlZWtpbmc7CiAgfTsKCiAgLyoqCiAgICogR2V0IGEgVGltZVJhbmdlcyBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZQogICAqIHJhbmdlcyBvZiB0aGUgbWVkaWEgcmVzb3VyY2UgdG8gd2hpY2ggaXQgaXMgcG9zc2libGUKICAgKiBmb3IgdGhlIHVzZXIgYWdlbnQgdG8gc2Vlay4KICAgKgogICAqIEByZXR1cm4ge1RpbWVSYW5nZU9iamVjdH0KICAgKiBAbWV0aG9kIHNlZWthYmxlCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5zZWVrYWJsZSA9IGZ1bmN0aW9uIHNlZWthYmxlKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLnNlZWthYmxlOwogIH07CgogIC8qKgogICAqIEdldCBpZiB2aWRlbyBlbmRlZAogICAqCiAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgKiBAbWV0aG9kIGVuZGVkCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5lbmRlZCA9IGZ1bmN0aW9uIGVuZGVkKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLmVuZGVkOwogIH07CgogIC8qKgogICAqIEdldCB0aGUgdmFsdWUgb2YgdGhlIG11dGVkIGNvbnRlbnQgYXR0cmlidXRlCiAgICogVGhpcyBhdHRyaWJ1dGUgaGFzIG5vIGR5bmFtaWMgZWZmZWN0LCBpdCBvbmx5CiAgICogY29udHJvbHMgdGhlIGRlZmF1bHQgc3RhdGUgb2YgdGhlIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICogQG1ldGhvZCBkZWZhdWx0TXV0ZWQKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLmRlZmF1bHRNdXRlZCA9IGZ1bmN0aW9uIGRlZmF1bHRNdXRlZCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5kZWZhdWx0TXV0ZWQ7CiAgfTsKCiAgLyoqCiAgICogR2V0IGRlc2lyZWQgc3BlZWQgYXQgd2hpY2ggdGhlIG1lZGlhIHJlc291cmNlIGlzIHRvIHBsYXkKICAgKgogICAqIEByZXR1cm4ge051bWJlcn0KICAgKiBAbWV0aG9kIHBsYXliYWNrUmF0ZQogICAqLwoKICBIdG1sNS5wcm90b3R5cGUucGxheWJhY2tSYXRlID0gZnVuY3Rpb24gcGxheWJhY2tSYXRlKCkgewogICAgcmV0dXJuIHRoaXMuZWxfLnBsYXliYWNrUmF0ZTsKICB9OwoKICAvKioKICAgKiBSZXR1cm5zIGEgVGltZVJhbmdlcyBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSByYW5nZXMgb2YgdGhlCiAgICogbWVkaWEgcmVzb3VyY2UgdGhhdCB0aGUgdXNlciBhZ2VudCBoYXMgcGxheWVkLgogICAqIEByZXR1cm4ge1RpbWVSYW5nZU9iamVjdH0gdGhlIHJhbmdlIG9mIHBvaW50cyBvbiB0aGUgbWVkaWEKICAgKiB0aW1lbGluZSB0aGF0IGhhcyBiZWVuIHJlYWNoZWQgdGhyb3VnaCBub3JtYWwgcGxheWJhY2sKICAgKiBAc2VlIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCNkb20tbWVkaWEtcGxheWVkCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5wbGF5ZWQgPSBmdW5jdGlvbiBwbGF5ZWQoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8ucGxheWVkOwogIH07CgogIC8qKgogICAqIFNldCBkZXNpcmVkIHNwZWVkIGF0IHdoaWNoIHRoZSBtZWRpYSByZXNvdXJjZSBpcyB0byBwbGF5CiAgICoKICAgKiBAcGFyYW0ge051bWJlcn0gdmFsIFNwZWVkIGF0IHdoaWNoIHRoZSBtZWRpYSByZXNvdXJjZSBpcyB0byBwbGF5CiAgICogQG1ldGhvZCBzZXRQbGF5YmFja1JhdGUKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnNldFBsYXliYWNrUmF0ZSA9IGZ1bmN0aW9uIHNldFBsYXliYWNrUmF0ZSh2YWwpIHsKICAgIHRoaXMuZWxfLnBsYXliYWNrUmF0ZSA9IHZhbDsKICB9OwoKICAvKioKICAgKiBHZXQgdGhlIGN1cnJlbnQgc3RhdGUgb2YgbmV0d29yayBhY3Rpdml0eSBmb3IgdGhlIGVsZW1lbnQsIGZyb20KICAgKiB0aGUgbGlzdCBiZWxvdwogICAqIE5FVFdPUktfRU1QVFkgKG51bWVyaWMgdmFsdWUgMCkKICAgKiBORVRXT1JLX0lETEUgKG51bWVyaWMgdmFsdWUgMSkKICAgKiBORVRXT1JLX0xPQURJTkcgKG51bWVyaWMgdmFsdWUgMikKICAgKiBORVRXT1JLX05PX1NPVVJDRSAobnVtZXJpYyB2YWx1ZSAzKQogICAqCiAgICogQHJldHVybiB7TnVtYmVyfQogICAqIEBtZXRob2QgbmV0d29ya1N0YXRlCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5uZXR3b3JrU3RhdGUgPSBmdW5jdGlvbiBuZXR3b3JrU3RhdGUoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8ubmV0d29ya1N0YXRlOwogIH07CgogIC8qKgogICAqIEdldCBhIHZhbHVlIHRoYXQgZXhwcmVzc2VzIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBlbGVtZW50CiAgICogd2l0aCByZXNwZWN0IHRvIHJlbmRlcmluZyB0aGUgY3VycmVudCBwbGF5YmFjayBwb3NpdGlvbiwgZnJvbQogICAqIHRoZSBjb2RlcyBpbiB0aGUgbGlzdCBiZWxvdwogICAqIEhBVkVfTk9USElORyAobnVtZXJpYyB2YWx1ZSAwKQogICAqIEhBVkVfTUVUQURBVEEgKG51bWVyaWMgdmFsdWUgMSkKICAgKiBIQVZFX0NVUlJFTlRfREFUQSAobnVtZXJpYyB2YWx1ZSAyKQogICAqIEhBVkVfRlVUVVJFX0RBVEEgKG51bWVyaWMgdmFsdWUgMykKICAgKiBIQVZFX0VOT1VHSF9EQVRBIChudW1lcmljIHZhbHVlIDQpCiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9CiAgICogQG1ldGhvZCByZWFkeVN0YXRlCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS5yZWFkeVN0YXRlID0gZnVuY3Rpb24gcmVhZHlTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLmVsXy5yZWFkeVN0YXRlOwogIH07CgogIC8qKgogICAqIEdldCB3aWR0aCBvZiB2aWRlbwogICAqCiAgICogQHJldHVybiB7TnVtYmVyfQogICAqIEBtZXRob2QgdmlkZW9XaWR0aAogICAqLwoKICBIdG1sNS5wcm90b3R5cGUudmlkZW9XaWR0aCA9IGZ1bmN0aW9uIHZpZGVvV2lkdGgoKSB7CiAgICByZXR1cm4gdGhpcy5lbF8udmlkZW9XaWR0aDsKICB9OwoKICAvKioKICAgKiBHZXQgaGVpZ2h0IG9mIHZpZGVvCiAgICoKICAgKiBAcmV0dXJuIHtOdW1iZXJ9CiAgICogQG1ldGhvZCB2aWRlb0hlaWdodAogICAqLwoKICBIdG1sNS5wcm90b3R5cGUudmlkZW9IZWlnaHQgPSBmdW5jdGlvbiB2aWRlb0hlaWdodCgpIHsKICAgIHJldHVybiB0aGlzLmVsXy52aWRlb0hlaWdodDsKICB9OwoKICAvKioKICAgKiBHZXQgdGV4dCB0cmFja3MKICAgKgogICAqIEByZXR1cm4ge1RleHRUcmFja0xpc3R9CiAgICogQG1ldGhvZCB0ZXh0VHJhY2tzCiAgICovCgogIEh0bWw1LnByb3RvdHlwZS50ZXh0VHJhY2tzID0gZnVuY3Rpb24gdGV4dFRyYWNrcygpIHsKICAgIHJldHVybiBfVGVjaC5wcm90b3R5cGUudGV4dFRyYWNrcy5jYWxsKHRoaXMpOwogIH07CgogIC8qKgogICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSB0ZXh0IHRyYWNrIG9iamVjdAogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IGtpbmQgVGV4dCB0cmFjayBraW5kIChzdWJ0aXRsZXMsIGNhcHRpb25zLCBkZXNjcmlwdGlvbnMKICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXB0ZXJzIGFuZCBtZXRhZGF0YSkKICAgKiBAcGFyYW0ge1N0cmluZz19IGxhYmVsIExhYmVsIHRvIGlkZW50aWZ5IHRoZSB0ZXh0IHRyYWNrCiAgICogQHBhcmFtIHtTdHJpbmc9fSBsYW5ndWFnZSBUd28gbGV0dGVyIGxhbmd1YWdlIGFiYnJldmlhdGlvbgogICAqIEByZXR1cm4ge1RleHRUcmFja09iamVjdH0KICAgKiBAbWV0aG9kIGFkZFRleHRUcmFjawogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuYWRkVGV4dFRyYWNrID0gZnVuY3Rpb24gYWRkVGV4dFRyYWNrKGtpbmQsIGxhYmVsLCBsYW5ndWFnZSkgewogICAgaWYgKCF0aGlzWydmZWF0dXJlc05hdGl2ZVRleHRUcmFja3MnXSkgewogICAgICByZXR1cm4gX1RlY2gucHJvdG90eXBlLmFkZFRleHRUcmFjay5jYWxsKHRoaXMsIGtpbmQsIGxhYmVsLCBsYW5ndWFnZSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZWxfLmFkZFRleHRUcmFjayhraW5kLCBsYWJlbCwgbGFuZ3VhZ2UpOwogIH07CgogIC8qKgogICAqIENyZWF0ZXMgYSByZW1vdGUgdGV4dCB0cmFjayBvYmplY3QgYW5kIHJldHVybnMgYSBodG1sIHRyYWNrIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIFRoZSBvYmplY3Qgc2hvdWxkIGNvbnRhaW4gdmFsdWVzIGZvcgogICAqIGtpbmQsIGxhbmd1YWdlLCBsYWJlbCBhbmQgc3JjIChsb2NhdGlvbiBvZiB0aGUgV2ViVlRUIGZpbGUpCiAgICogQHJldHVybiB7SFRNTFRyYWNrRWxlbWVudH0KICAgKiBAbWV0aG9kIGFkZFJlbW90ZVRleHRUcmFjawogICAqLwoKICBIdG1sNS5wcm90b3R5cGUuYWRkUmVtb3RlVGV4dFRyYWNrID0gZnVuY3Rpb24gYWRkUmVtb3RlVGV4dFRyYWNrKCkgewogICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTsKCiAgICBpZiAoIXRoaXNbJ2ZlYXR1cmVzTmF0aXZlVGV4dFRyYWNrcyddKSB7CiAgICAgIHJldHVybiBfVGVjaC5wcm90b3R5cGUuYWRkUmVtb3RlVGV4dFRyYWNrLmNhbGwodGhpcywgb3B0aW9ucyk7CiAgICB9CgogICAgdmFyIGh0bWxUcmFja0VsZW1lbnQgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgndHJhY2snKTsKCiAgICBpZiAob3B0aW9ucy5raW5kKSB7CiAgICAgIGh0bWxUcmFja0VsZW1lbnQua2luZCA9IG9wdGlvbnMua2luZDsKICAgIH0KICAgIGlmIChvcHRpb25zLmxhYmVsKSB7CiAgICAgIGh0bWxUcmFja0VsZW1lbnQubGFiZWwgPSBvcHRpb25zLmxhYmVsOwogICAgfQogICAgaWYgKG9wdGlvbnMubGFuZ3VhZ2UgfHwgb3B0aW9ucy5zcmNsYW5nKSB7CiAgICAgIGh0bWxUcmFja0VsZW1lbnQuc3JjbGFuZyA9IG9wdGlvbnMubGFuZ3VhZ2UgfHwgb3B0aW9ucy5zcmNsYW5nOwogICAgfQogICAgaWYgKG9wdGlvbnNbJ2RlZmF1bHQnXSkgewogICAgICBodG1sVHJhY2tFbGVtZW50WydkZWZhdWx0J10gPSBvcHRpb25zWydkZWZhdWx0J107CiAgICB9CiAgICBpZiAob3B0aW9ucy5pZCkgewogICAgICBodG1sVHJhY2tFbGVtZW50LmlkID0gb3B0aW9ucy5pZDsKICAgIH0KICAgIGlmIChvcHRpb25zLnNyYykgewogICAgICBodG1sVHJhY2tFbGVtZW50LnNyYyA9IG9wdGlvbnMuc3JjOwogICAgfQoKICAgIHRoaXMuZWwoKS5hcHBlbmRDaGlsZChodG1sVHJhY2tFbGVtZW50KTsKCiAgICAvLyBzdG9yZSBIVE1MVHJhY2tFbGVtZW50IGFuZCBUZXh0VHJhY2sgdG8gcmVtb3RlIGxpc3QKICAgIHRoaXMucmVtb3RlVGV4dFRyYWNrRWxzKCkuYWRkVHJhY2tFbGVtZW50XyhodG1sVHJhY2tFbGVtZW50KTsKICAgIHRoaXMucmVtb3RlVGV4dFRyYWNrcygpLmFkZFRyYWNrXyhodG1sVHJhY2tFbGVtZW50LnRyYWNrKTsKCiAgICByZXR1cm4gaHRtbFRyYWNrRWxlbWVudDsKICB9OwoKICAvKioKICAgKiBSZW1vdmUgcmVtb3RlIHRleHQgdHJhY2sgZnJvbSBUZXh0VHJhY2tMaXN0IG9iamVjdAogICAqCiAgICogQHBhcmFtIHtUZXh0VHJhY2tPYmplY3R9IHRyYWNrIFRleHR0cmFjayBvYmplY3QgdG8gcmVtb3ZlCiAgICogQG1ldGhvZCByZW1vdmVSZW1vdGVUZXh0VHJhY2sKICAgKi8KCiAgSHRtbDUucHJvdG90eXBlLnJlbW92ZVJlbW90ZVRleHRUcmFjayA9IGZ1bmN0aW9uIHJlbW92ZVJlbW90ZVRleHRUcmFjayh0cmFjaykgewogICAgaWYgKCF0aGlzWydmZWF0dXJlc05hdGl2ZVRleHRUcmFja3MnXSkgewogICAgICByZXR1cm4gX1RlY2gucHJvdG90eXBlLnJlbW92ZVJlbW90ZVRleHRUcmFjay5jYWxsKHRoaXMsIHRyYWNrKTsKICAgIH0KCiAgICB2YXIgdHJhY2tzID0gdW5kZWZpbmVkLAogICAgICAgIGkgPSB1bmRlZmluZWQ7CgogICAgdmFyIHRyYWNrRWxlbWVudCA9IHRoaXMucmVtb3RlVGV4dFRyYWNrRWxzKCkuZ2V0VHJhY2tFbGVtZW50QnlUcmFja18odHJhY2spOwoKICAgIC8vIHJlbW92ZSBIVE1MVHJhY2tFbGVtZW50IGFuZCBUZXh0VHJhY2sgZnJvbSByZW1vdGUgbGlzdAogICAgdGhpcy5yZW1vdGVUZXh0VHJhY2tFbHMoKS5yZW1vdmVUcmFja0VsZW1lbnRfKHRyYWNrRWxlbWVudCk7CiAgICB0aGlzLnJlbW90ZVRleHRUcmFja3MoKS5yZW1vdmVUcmFja18odHJhY2spOwoKICAgIHRyYWNrcyA9IHRoaXMuJCQoJ3RyYWNrJyk7CgogICAgaSA9IHRyYWNrcy5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIGlmICh0cmFjayA9PT0gdHJhY2tzW2ldIHx8IHRyYWNrID09PSB0cmFja3NbaV0udHJhY2spIHsKICAgICAgICB0aGlzLmVsKCkucmVtb3ZlQ2hpbGQodHJhY2tzW2ldKTsKICAgICAgfQogICAgfQogIH07CgogIHJldHVybiBIdG1sNTsKfSkoX3RlY2hKczJbJ2RlZmF1bHQnXSk7CgpIdG1sNS5URVNUX1ZJRCA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCd2aWRlbycpOwp2YXIgdHJhY2sgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgndHJhY2snKTsKdHJhY2sua2luZCA9ICdjYXB0aW9ucyc7CnRyYWNrLnNyY2xhbmcgPSAnZW4nOwp0cmFjay5sYWJlbCA9ICdFbmdsaXNoJzsKSHRtbDUuVEVTVF9WSUQuYXBwZW5kQ2hpbGQodHJhY2spOwoKLyoKICogQ2hlY2sgaWYgSFRNTDUgdmlkZW8gaXMgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci9kZXZpY2UKICoKICogQHJldHVybiB7Qm9vbGVhbn0KICovCkh0bWw1LmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewogIC8vIElFOSB3aXRoIG5vIE1lZGlhIFBsYXllciBpcyBhIExJQVIhICgjOTg0KQogIHRyeSB7CiAgICBIdG1sNS5URVNUX1ZJRFsndm9sdW1lJ10gPSAwLjU7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuICEhSHRtbDUuVEVTVF9WSUQuY2FuUGxheVR5cGU7Cn07CgovLyBBZGQgU291cmNlIEhhbmRsZXIgcGF0dGVybiBmdW5jdGlvbnMgdG8gdGhpcyB0ZWNoCl90ZWNoSnMyWydkZWZhdWx0J10ud2l0aFNvdXJjZUhhbmRsZXJzKEh0bWw1KTsKCi8qCiAqIFRoZSBkZWZhdWx0IG5hdGl2ZSBzb3VyY2UgaGFuZGxlci4KICogVGhpcyBzaW1wbHkgcGFzc2VzIHRoZSBzb3VyY2UgdG8gdGhlIHZpZGVvIGVsZW1lbnQuIE5vdGhpbmcgZmFuY3kuCiAqCiAqIEBwYXJhbSAge09iamVjdH0gc291cmNlICAgVGhlIHNvdXJjZSBvYmplY3QKICogQHBhcmFtICB7SHRtbDV9IHRlY2ggIFRoZSBpbnN0YW5jZSBvZiB0aGUgSFRNTDUgdGVjaAogKi8KSHRtbDUubmF0aXZlU291cmNlSGFuZGxlciA9IHt9OwoKLyoKICogQ2hlY2sgaWYgdGhlIHZpZGVvIGVsZW1lbnQgY2FuIHBsYXkgdGhlIGdpdmVuIHZpZGVvdHlwZQogKgogKiBAcGFyYW0gIHtTdHJpbmd9IHR5cGUgICAgVGhlIG1pbWV0eXBlIHRvIGNoZWNrCiAqIEByZXR1cm4ge1N0cmluZ30gICAgICAgICAncHJvYmFibHknLCAnbWF5YmUnLCBvciAnJyAoZW1wdHkgc3RyaW5nKQogKi8KSHRtbDUubmF0aXZlU291cmNlSGFuZGxlci5jYW5QbGF5VHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7CiAgLy8gSUU5IG9uIFdpbmRvd3MgNyB3aXRob3V0IE1lZGlhUGxheWVyIHRocm93cyBhbiBlcnJvciBoZXJlCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZpZGVvanMvdmlkZW8uanMvaXNzdWVzLzUxOQogIHRyeSB7CiAgICByZXR1cm4gSHRtbDUuVEVTVF9WSUQuY2FuUGxheVR5cGUodHlwZSk7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuICcnOwogIH0KfTsKCi8qCiAqIENoZWNrIGlmIHRoZSB2aWRlbyBlbGVtZW50IGNhbiBoYW5kbGUgdGhlIHNvdXJjZSBuYXRpdmVseQogKgogKiBAcGFyYW0gIHtPYmplY3R9IHNvdXJjZSAgVGhlIHNvdXJjZSBvYmplY3QKICogQHJldHVybiB7U3RyaW5nfSAgICAgICAgICdwcm9iYWJseScsICdtYXliZScsIG9yICcnIChlbXB0eSBzdHJpbmcpCiAqLwpIdG1sNS5uYXRpdmVTb3VyY2VIYW5kbGVyLmNhbkhhbmRsZVNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHsKICB2YXIgbWF0Y2gsIGV4dDsKCiAgLy8gSWYgYSB0eXBlIHdhcyBwcm92aWRlZCB3ZSBzaG91bGQgcmVseSBvbiB0aGF0CiAgaWYgKHNvdXJjZS50eXBlKSB7CiAgICByZXR1cm4gSHRtbDUubmF0aXZlU291cmNlSGFuZGxlci5jYW5QbGF5VHlwZShzb3VyY2UudHlwZSk7CiAgfSBlbHNlIGlmIChzb3VyY2Uuc3JjKSB7CiAgICAvLyBJZiBubyB0eXBlLCBmYWxsIGJhY2sgdG8gY2hlY2tpbmcgJ3ZpZGVvL1tFWFRFTlNJT05dJwogICAgZXh0ID0gVXJsLmdldEZpbGVFeHRlbnNpb24oc291cmNlLnNyYyk7CgogICAgcmV0dXJuIEh0bWw1Lm5hdGl2ZVNvdXJjZUhhbmRsZXIuY2FuUGxheVR5cGUoJ3ZpZGVvLycgKyBleHQpOwogIH0KCiAgcmV0dXJuICcnOwp9OwoKLyoKICogUGFzcyB0aGUgc291cmNlIHRvIHRoZSB2aWRlbyBlbGVtZW50CiAqIEFkYXB0aXZlIHNvdXJjZSBoYW5kbGVycyB3aWxsIGhhdmUgbW9yZSBjb21wbGljYXRlZCB3b3JrZmxvd3MgYmVmb3JlIHBhc3NpbmcKICogdmlkZW8gZGF0YSB0byB0aGUgdmlkZW8gZWxlbWVudAogKgogKiBAcGFyYW0gIHtPYmplY3R9IHNvdXJjZSAgICBUaGUgc291cmNlIG9iamVjdAogKiBAcGFyYW0gIHtIdG1sNX0gdGVjaCAgIFRoZSBpbnN0YW5jZSBvZiB0aGUgSHRtbDUgdGVjaAogKi8KSHRtbDUubmF0aXZlU291cmNlSGFuZGxlci5oYW5kbGVTb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlLCB0ZWNoKSB7CiAgdGVjaC5zZXRTcmMoc291cmNlLnNyYyk7Cn07CgovKgoqIENsZWFuIHVwIHRoZSBzb3VyY2UgaGFuZGxlciB3aGVuIGRpc3Bvc2luZyB0aGUgcGxheWVyIG9yIHN3aXRjaGluZyBzb3VyY2VzLi4KKiAobm8gY2xlYW51cCBpcyBuZWVkZWQgd2hlbiBzdXBwb3J0aW5nIHRoZSBmb3JtYXQgbmF0aXZlbHkpCiovCkh0bWw1Lm5hdGl2ZVNvdXJjZUhhbmRsZXIuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHt9OwoKLy8gUmVnaXN0ZXIgdGhlIG5hdGl2ZSBzb3VyY2UgaGFuZGxlcgpIdG1sNS5yZWdpc3RlclNvdXJjZUhhbmRsZXIoSHRtbDUubmF0aXZlU291cmNlSGFuZGxlcik7CgovKgogKiBDaGVjayBpZiB0aGUgdm9sdW1lIGNhbiBiZSBjaGFuZ2VkIGluIHRoaXMgYnJvd3Nlci9kZXZpY2UuCiAqIFZvbHVtZSBjYW5ub3QgYmUgY2hhbmdlZCBpbiBhIGxvdCBvZiBtb2JpbGUgZGV2aWNlcy4KICogU3BlY2lmaWNhbGx5LCBpdCBjYW4ndCBiZSBjaGFuZ2VkIGZyb20gMSBvbiBpT1MuCiAqCiAqIEByZXR1cm4ge0Jvb2xlYW59CiAqLwpIdG1sNS5jYW5Db250cm9sVm9sdW1lID0gZnVuY3Rpb24gKCkgewogIHZhciB2b2x1bWUgPSBIdG1sNS5URVNUX1ZJRC52b2x1bWU7CiAgSHRtbDUuVEVTVF9WSUQudm9sdW1lID0gdm9sdW1lIC8gMiArIDAuMTsKICByZXR1cm4gdm9sdW1lICE9PSBIdG1sNS5URVNUX1ZJRC52b2x1bWU7Cn07CgovKgogKiBDaGVjayBpZiBwbGF5YmFja1JhdGUgaXMgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3Nlci9kZXZpY2UuCiAqCiAqIEByZXR1cm4ge051bWJlcn0gW2Rlc2NyaXB0aW9uXQogKi8KSHRtbDUuY2FuQ29udHJvbFBsYXliYWNrUmF0ZSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgcGxheWJhY2tSYXRlID0gSHRtbDUuVEVTVF9WSUQucGxheWJhY2tSYXRlOwogIEh0bWw1LlRFU1RfVklELnBsYXliYWNrUmF0ZSA9IHBsYXliYWNrUmF0ZSAvIDIgKyAwLjE7CiAgcmV0dXJuIHBsYXliYWNrUmF0ZSAhPT0gSHRtbDUuVEVTVF9WSUQucGxheWJhY2tSYXRlOwp9OwoKLyoKICogQ2hlY2sgdG8gc2VlIGlmIG5hdGl2ZSB0ZXh0IHRyYWNrcyBhcmUgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci9kZXZpY2UKICoKICogQHJldHVybiB7Qm9vbGVhbn0KICovCkh0bWw1LnN1cHBvcnRzTmF0aXZlVGV4dFRyYWNrcyA9IGZ1bmN0aW9uICgpIHsKICB2YXIgc3VwcG9ydHNUZXh0VHJhY2tzOwoKICAvLyBGaWd1cmUgb3V0IG5hdGl2ZSB0ZXh0IHRyYWNrIHN1cHBvcnQKICAvLyBJZiBtb2RlIGlzIGEgbnVtYmVyLCB3ZSBjYW5ub3QgY2hhbmdlIGl0IGJlY2F1c2UgaXQnbGwgZGlzYXBwZWFyIGZyb20gdmlldy4KICAvLyBCcm93c2VycyB3aXRoIG51bWVyaWMgbW9kZXMgaW5jbHVkZSBJRTEwIGFuZCBvbGRlciAoPD0yMDEzKSBzYW1zdW5nIGFuZHJvaWQgbW9kZWxzLgogIC8vIEZpcmVmb3ggaXNuJ3QgcGxheWluZyBuaWNlIGVpdGhlciB3aXRoIG1vZGlmeWluZyB0aGUgbW9kZQogIC8vIFRPRE86IEludmVzdGlnYXRlIGZpcmVmb3g6IGh0dHBzOi8vZ2l0aHViLmNvbS92aWRlb2pzL3ZpZGVvLmpzL2lzc3Vlcy8xODYyCiAgc3VwcG9ydHNUZXh0VHJhY2tzID0gISFIdG1sNS5URVNUX1ZJRC50ZXh0VHJhY2tzOwogIGlmIChzdXBwb3J0c1RleHRUcmFja3MgJiYgSHRtbDUuVEVTVF9WSUQudGV4dFRyYWNrcy5sZW5ndGggPiAwKSB7CiAgICBzdXBwb3J0c1RleHRUcmFja3MgPSB0eXBlb2YgSHRtbDUuVEVTVF9WSUQudGV4dFRyYWNrc1swXVsnbW9kZSddICE9PSAnbnVtYmVyJzsKICB9CiAgaWYgKHN1cHBvcnRzVGV4dFRyYWNrcyAmJiBicm93c2VyLklTX0ZJUkVGT1gpIHsKICAgIHN1cHBvcnRzVGV4dFRyYWNrcyA9IGZhbHNlOwogIH0KICBpZiAoc3VwcG9ydHNUZXh0VHJhY2tzICYmICEoJ29ucmVtb3ZldHJhY2snIGluIEh0bWw1LlRFU1RfVklELnRleHRUcmFja3MpKSB7CiAgICBzdXBwb3J0c1RleHRUcmFja3MgPSBmYWxzZTsKICB9CgogIHJldHVybiBzdXBwb3J0c1RleHRUcmFja3M7Cn07CgovKioKICogQW4gYXJyYXkgb2YgZXZlbnRzIGF2YWlsYWJsZSBvbiB0aGUgSHRtbDUgdGVjaC4KICoKICogQHByaXZhdGUKICogQHR5cGUge0FycmF5fQogKi8KSHRtbDUuRXZlbnRzID0gWydsb2Fkc3RhcnQnLCAnc3VzcGVuZCcsICdhYm9ydCcsICdlcnJvcicsICdlbXB0aWVkJywgJ3N0YWxsZWQnLCAnbG9hZGVkbWV0YWRhdGEnLCAnbG9hZGVkZGF0YScsICdjYW5wbGF5JywgJ2NhbnBsYXl0aHJvdWdoJywgJ3BsYXlpbmcnLCAnd2FpdGluZycsICdzZWVraW5nJywgJ3NlZWtlZCcsICdlbmRlZCcsICdkdXJhdGlvbmNoYW5nZScsICd0aW1ldXBkYXRlJywgJ3Byb2dyZXNzJywgJ3BsYXknLCAncGF1c2UnLCAncmF0ZWNoYW5nZScsICd2b2x1bWVjaGFuZ2UnXTsKCi8qCiAqIFNldCB0aGUgdGVjaCdzIHZvbHVtZSBjb250cm9sIHN1cHBvcnQgc3RhdHVzCiAqCiAqIEB0eXBlIHtCb29sZWFufQogKi8KSHRtbDUucHJvdG90eXBlWydmZWF0dXJlc1ZvbHVtZUNvbnRyb2wnXSA9IEh0bWw1LmNhbkNvbnRyb2xWb2x1bWUoKTsKCi8qCiAqIFNldCB0aGUgdGVjaCdzIHBsYXliYWNrUmF0ZSBzdXBwb3J0IHN0YXR1cwogKgogKiBAdHlwZSB7Qm9vbGVhbn0KICovCkh0bWw1LnByb3RvdHlwZVsnZmVhdHVyZXNQbGF5YmFja1JhdGUnXSA9IEh0bWw1LmNhbkNvbnRyb2xQbGF5YmFja1JhdGUoKTsKCi8qCiAqIFNldCB0aGUgdGVjaCdzIHN0YXR1cyBvbiBtb3ZpbmcgdGhlIHZpZGVvIGVsZW1lbnQuCiAqIEluIGlPUywgaWYgeW91IG1vdmUgYSB2aWRlbyBlbGVtZW50IGluIHRoZSBET00sIGl0IGJyZWFrcyB2aWRlbyBwbGF5YmFjay4KICoKICogQHR5cGUge0Jvb2xlYW59CiAqLwpIdG1sNS5wcm90b3R5cGVbJ21vdmluZ01lZGlhRWxlbWVudEluRE9NJ10gPSAhYnJvd3Nlci5JU19JT1M7CgovKgogKiBTZXQgdGhlIHRoZSB0ZWNoJ3MgZnVsbHNjcmVlbiByZXNpemUgc3VwcG9ydCBzdGF0dXMuCiAqIEhUTUwgdmlkZW8gaXMgYWJsZSB0byBhdXRvbWF0aWNhbGx5IHJlc2l6ZSB3aGVuIGdvaW5nIHRvIGZ1bGxzY3JlZW4uCiAqIChObyBsb25nZXIgYXBwZWFycyB0byBiZSB1c2VkLiBDYW4gcHJvYmFibHkgYmUgcmVtb3ZlZC4pCiAqLwpIdG1sNS5wcm90b3R5cGVbJ2ZlYXR1cmVzRnVsbHNjcmVlblJlc2l6ZSddID0gdHJ1ZTsKCi8qCiAqIFNldCB0aGUgdGVjaCdzIHByb2dyZXNzIGV2ZW50IHN1cHBvcnQgc3RhdHVzCiAqICh0aGlzIGRpc2FibGVzIHRoZSBtYW51YWwgcHJvZ3Jlc3MgZXZlbnRzIG9mIHRoZSBUZWNoKQogKi8KSHRtbDUucHJvdG90eXBlWydmZWF0dXJlc1Byb2dyZXNzRXZlbnRzJ10gPSB0cnVlOwoKLyoKICogU2V0cyB0aGUgdGVjaCdzIHN0YXR1cyBvbiBuYXRpdmUgdGV4dCB0cmFjayBzdXBwb3J0CiAqCiAqIEB0eXBlIHtCb29sZWFufQogKi8KSHRtbDUucHJvdG90eXBlWydmZWF0dXJlc05hdGl2ZVRleHRUcmFja3MnXSA9IEh0bWw1LnN1cHBvcnRzTmF0aXZlVGV4dFRyYWNrcygpOwoKLy8gSFRNTDUgRmVhdHVyZSBkZXRlY3Rpb24gYW5kIERldmljZSBGaXhlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8KdmFyIGNhblBsYXlUeXBlID0gdW5kZWZpbmVkOwp2YXIgbXBlZ3VybFJFID0gL15hcHBsaWNhdGlvblwvKD86eC18dm5kXC5hcHBsZVwuKW1wZWd1cmwvaTsKdmFyIG1wNFJFID0gL152aWRlb1wvbXA0L2k7CgpIdG1sNS5wYXRjaENhblBsYXlUeXBlID0gZnVuY3Rpb24gKCkgewogIC8vIEFuZHJvaWQgNC4wIGFuZCBhYm92ZSBjYW4gcGxheSBITFMgdG8gc29tZSBleHRlbnQgYnV0IGl0IHJlcG9ydHMgYmVpbmcgdW5hYmxlIHRvIGRvIHNvCiAgaWYgKGJyb3dzZXIuQU5EUk9JRF9WRVJTSU9OID49IDQuMCkgewogICAgaWYgKCFjYW5QbGF5VHlwZSkgewogICAgICBjYW5QbGF5VHlwZSA9IEh0bWw1LlRFU1RfVklELmNvbnN0cnVjdG9yLnByb3RvdHlwZS5jYW5QbGF5VHlwZTsKICAgIH0KCiAgICBIdG1sNS5URVNUX1ZJRC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUuY2FuUGxheVR5cGUgPSBmdW5jdGlvbiAodHlwZSkgewogICAgICBpZiAodHlwZSAmJiBtcGVndXJsUkUudGVzdCh0eXBlKSkgewogICAgICAgIHJldHVybiAnbWF5YmUnOwogICAgICB9CiAgICAgIHJldHVybiBjYW5QbGF5VHlwZS5jYWxsKHRoaXMsIHR5cGUpOwogICAgfTsKICB9CgogIC8vIE92ZXJyaWRlIEFuZHJvaWQgMi4yIGFuZCBsZXNzIGNhblBsYXlUeXBlIG1ldGhvZCB3aGljaCBpcyBicm9rZW4KICBpZiAoYnJvd3Nlci5JU19PTERfQU5EUk9JRCkgewogICAgaWYgKCFjYW5QbGF5VHlwZSkgewogICAgICBjYW5QbGF5VHlwZSA9IEh0bWw1LlRFU1RfVklELmNvbnN0cnVjdG9yLnByb3RvdHlwZS5jYW5QbGF5VHlwZTsKICAgIH0KCiAgICBIdG1sNS5URVNUX1ZJRC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUuY2FuUGxheVR5cGUgPSBmdW5jdGlvbiAodHlwZSkgewogICAgICBpZiAodHlwZSAmJiBtcDRSRS50ZXN0KHR5cGUpKSB7CiAgICAgICAgcmV0dXJuICdtYXliZSc7CiAgICAgIH0KICAgICAgcmV0dXJuIGNhblBsYXlUeXBlLmNhbGwodGhpcywgdHlwZSk7CiAgICB9OwogIH0KfTsKCkh0bWw1LnVucGF0Y2hDYW5QbGF5VHlwZSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgciA9IEh0bWw1LlRFU1RfVklELmNvbnN0cnVjdG9yLnByb3RvdHlwZS5jYW5QbGF5VHlwZTsKICBIdG1sNS5URVNUX1ZJRC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUuY2FuUGxheVR5cGUgPSBjYW5QbGF5VHlwZTsKICBjYW5QbGF5VHlwZSA9IG51bGw7CiAgcmV0dXJuIHI7Cn07CgovLyBieSBkZWZhdWx0LCBwYXRjaCB0aGUgdmlkZW8gZWxlbWVudApIdG1sNS5wYXRjaENhblBsYXlUeXBlKCk7CgpIdG1sNS5kaXNwb3NlTWVkaWFFbGVtZW50ID0gZnVuY3Rpb24gKGVsKSB7CiAgaWYgKCFlbCkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKGVsLnBhcmVudE5vZGUpIHsKICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpOwogIH0KCiAgLy8gcmVtb3ZlIGFueSBjaGlsZCB0cmFjayBvciBzb3VyY2Ugbm9kZXMgdG8gcHJldmVudCB0aGVpciBsb2FkaW5nCiAgd2hpbGUgKGVsLmhhc0NoaWxkTm9kZXMoKSkgewogICAgZWwucmVtb3ZlQ2hpbGQoZWwuZmlyc3RDaGlsZCk7CiAgfQoKICAvLyByZW1vdmUgYW55IHNyYyByZWZlcmVuY2UuIG5vdCBzZXR0aW5nIGBzcmM9JydgIGJlY2F1c2UgdGhhdCBjYXVzZXMgYSB3YXJuaW5nCiAgLy8gaW4gZmlyZWZveAogIGVsLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7CgogIC8vIGZvcmNlIHRoZSBtZWRpYSBlbGVtZW50IHRvIHVwZGF0ZSBpdHMgbG9hZGluZyBzdGF0ZSBieSBjYWxsaW5nIGxvYWQoKQogIC8vIGhvd2V2ZXIgSUUgb24gV2luZG93cyA3TiBoYXMgYSBidWcgdGhhdCB0aHJvd3MgYW4gZXJyb3Igc28gbmVlZCBhIHRyeS9jYXRjaCAoIzc5MykKICBpZiAodHlwZW9mIGVsLmxvYWQgPT09ICdmdW5jdGlvbicpIHsKICAgIC8vIHdyYXBwaW5nIGluIGFuIGlpZmUgc28gaXQncyBub3QgZGVvcHRpbWl6ZWQgKCMxMDYwI2Rpc2N1c3Npb25fcjEwMzI0NDczKQogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgdHJ5IHsKICAgICAgICBlbC5sb2FkKCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBub3Qgc3VwcG9ydGVkCiAgICAgIH0KICAgIH0pKCk7CiAgfQp9OwoKSHRtbDUucmVzZXRNZWRpYUVsZW1lbnQgPSBmdW5jdGlvbiAoZWwpIHsKICBpZiAoIWVsKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgc291cmNlcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NvdXJjZScpOwogIHZhciBpID0gc291cmNlcy5sZW5ndGg7CiAgd2hpbGUgKGktLSkgewogICAgZWwucmVtb3ZlQ2hpbGQoc291cmNlc1tpXSk7CiAgfQoKICAvLyByZW1vdmUgYW55IHNyYyByZWZlcmVuY2UuCiAgLy8gbm90IHNldHRpbmcgYHNyYz0nJ2AgYmVjYXVzZSB0aGF0IHRocm93cyBhbiBlcnJvcgogIGVsLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7CgogIGlmICh0eXBlb2YgZWwubG9hZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgLy8gd3JhcHBpbmcgaW4gYW4gaWlmZSBzbyBpdCdzIG5vdCBkZW9wdGltaXplZCAoIzEwNjAjZGlzY3Vzc2lvbl9yMTAzMjQ0NzMpCiAgICAoZnVuY3Rpb24gKCkgewogICAgICB0cnkgewogICAgICAgIGVsLmxvYWQoKTsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0pKCk7CiAgfQp9OwoKX2NvbXBvbmVudDJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnSHRtbDUnLCBIdG1sNSk7Cl90ZWNoSnMyWydkZWZhdWx0J10ucmVnaXN0ZXJUZWNoKCdIdG1sNScsIEh0bWw1KTsKZXhwb3J0c1snZGVmYXVsdCddID0gSHRtbDU7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2NvbXBvbmVudCI6NjUsIi4uL3V0aWxzL2Jyb3dzZXIuanMiOjEyNSwiLi4vdXRpbHMvZG9tLmpzIjoxMjgsIi4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uL3V0aWxzL2xvZy5qcyI6MTMzLCIuLi91dGlscy9tZXJnZS1vcHRpb25zLmpzIjoxMzQsIi4uL3V0aWxzL3VybC5qcyI6MTM4LCIuL3RlY2guanMiOjExNSwiZ2xvYmFsL2RvY3VtZW50IjoxLCJnbG9iYWwvd2luZG93IjoyLCJvYmplY3QuYXNzaWduIjo0NX1dLDExNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBsb2FkZXIuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudEpzID0gX2RlcmVxXygnLi4vY29tcG9uZW50LmpzJyk7Cgp2YXIgX2NvbXBvbmVudEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudEpzKTsKCnZhciBfdGVjaEpzID0gX2RlcmVxXygnLi90ZWNoLmpzJyk7Cgp2YXIgX3RlY2hKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWNoSnMpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF91dGlsc1RvVGl0bGVDYXNlSnMgPSBfZGVyZXFfKCcuLi91dGlscy90by10aXRsZS1jYXNlLmpzJyk7Cgp2YXIgX3V0aWxzVG9UaXRsZUNhc2VKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc1RvVGl0bGVDYXNlSnMpOwoKLyoqCiAqIFRoZSBNZWRpYSBMb2FkZXIgaXMgdGhlIGNvbXBvbmVudCB0aGF0IGRlY2lkZXMgd2hpY2ggcGxheWJhY2sgdGVjaG5vbG9neSB0byBsb2FkCiAqIHdoZW4gdGhlIHBsYXllciBpcyBpbml0aWFsaXplZC4KICoKICogQHBhcmFtIHtPYmplY3R9IHBsYXllciAgTWFpbiBQbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zIE9iamVjdCBvZiBvcHRpb24gbmFtZXMgYW5kIHZhbHVlcwogKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcmVhZHkgICAgUmVhZHkgY2FsbGJhY2sgZnVuY3Rpb24KICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBNZWRpYUxvYWRlcgogKi8KCnZhciBNZWRpYUxvYWRlciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhNZWRpYUxvYWRlciwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIE1lZGlhTG9hZGVyKHBsYXllciwgb3B0aW9ucywgcmVhZHkpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZWRpYUxvYWRlcik7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucywgcmVhZHkpOwoKICAgIC8vIElmIHRoZXJlIGFyZSBubyBzb3VyY2VzIHdoZW4gdGhlIHBsYXllciBpcyBpbml0aWFsaXplZCwKICAgIC8vIGxvYWQgdGhlIGZpcnN0IHN1cHBvcnRlZCBwbGF5YmFjayB0ZWNobm9sb2d5LgoKICAgIGlmICghb3B0aW9ucy5wbGF5ZXJPcHRpb25zWydzb3VyY2VzJ10gfHwgb3B0aW9ucy5wbGF5ZXJPcHRpb25zWydzb3VyY2VzJ10ubGVuZ3RoID09PSAwKSB7CiAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gb3B0aW9ucy5wbGF5ZXJPcHRpb25zWyd0ZWNoT3JkZXInXTsgaSA8IGoubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgdGVjaE5hbWUgPSBfdXRpbHNUb1RpdGxlQ2FzZUpzMlsnZGVmYXVsdCddKGpbaV0pOwogICAgICAgIHZhciB0ZWNoID0gX3RlY2hKczJbJ2RlZmF1bHQnXS5nZXRUZWNoKHRlY2hOYW1lKTsKICAgICAgICAvLyBTdXBwb3J0IG9sZCBiZWhhdmlvciBvZiB0ZWNocyBiZWluZyByZWdpc3RlcmVkIGFzIGNvbXBvbmVudHMuCiAgICAgICAgLy8gUmVtb3ZlIG9uY2UgdGhhdCBkZXByZWNhdGVkIGJlaGF2aW9yIGlzIHJlbW92ZWQuCiAgICAgICAgaWYgKCF0ZWNoTmFtZSkgewogICAgICAgICAgdGVjaCA9IF9jb21wb25lbnRKczJbJ2RlZmF1bHQnXS5nZXRDb21wb25lbnQodGVjaE5hbWUpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgdGhpcyB0ZWNobm9sb2d5CiAgICAgICAgaWYgKHRlY2ggJiYgdGVjaC5pc1N1cHBvcnRlZCgpKSB7CiAgICAgICAgICBwbGF5ZXIubG9hZFRlY2hfKHRlY2hOYW1lKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gLy8gTG9vcCB0aHJvdWdoIHBsYXliYWNrIHRlY2hub2xvZ2llcyAoSFRNTDUsIEZsYXNoKSBhbmQgY2hlY2sgZm9yIHN1cHBvcnQuCiAgICAgIC8vIC8vIFRoZW4gbG9hZCB0aGUgYmVzdCBzb3VyY2UuCiAgICAgIC8vIC8vIEEgZmV3IGFzc3VtcHRpb25zIGhlcmU6CiAgICAgIC8vIC8vICAgQWxsIHBsYXliYWNrIHRlY2hub2xvZ2llcyByZXNwZWN0IHByZWxvYWQgZmFsc2UuCiAgICAgIHBsYXllci5zcmMob3B0aW9ucy5wbGF5ZXJPcHRpb25zWydzb3VyY2VzJ10pOwogICAgfQogIH0KCiAgcmV0dXJuIE1lZGlhTG9hZGVyOwp9KShfY29tcG9uZW50SnMyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdNZWRpYUxvYWRlcicsIE1lZGlhTG9hZGVyKTsKZXhwb3J0c1snZGVmYXVsdCddID0gTWVkaWFMb2FkZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2NvbXBvbmVudC5qcyI6NjUsIi4uL3V0aWxzL3RvLXRpdGxlLWNhc2UuanMiOjEzNywiLi90ZWNoLmpzIjoxMTUsImdsb2JhbC93aW5kb3ciOjJ9XSwxMTU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgdGVjaC5qcwogKiBNZWRpYSBUZWNobm9sb2d5IENvbnRyb2xsZXIgLSBCYXNlIGNsYXNzIGZvciBtZWRpYSBwbGF5YmFjawogKiB0ZWNobm9sb2d5IGNvbnRyb2xsZXJzIGxpa2UgRmxhc2ggYW5kIEhUTUw1CiAqLwoKJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX2NvbXBvbmVudCA9IF9kZXJlcV8oJy4uL2NvbXBvbmVudCcpOwoKdmFyIF9jb21wb25lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50KTsKCnZhciBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudCA9IF9kZXJlcV8oJy4uL3RyYWNrcy9odG1sLXRyYWNrLWVsZW1lbnQnKTsKCnZhciBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFja3NIdG1sVHJhY2tFbGVtZW50KTsKCnZhciBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudExpc3QgPSBfZGVyZXFfKCcuLi90cmFja3MvaHRtbC10cmFjay1lbGVtZW50LWxpc3QnKTsKCnZhciBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudExpc3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhY2tzSHRtbFRyYWNrRWxlbWVudExpc3QpOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uc0pzID0gX2RlcmVxXygnLi4vdXRpbHMvbWVyZ2Utb3B0aW9ucy5qcycpOwoKdmFyIF91dGlsc01lcmdlT3B0aW9uc0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0aWxzTWVyZ2VPcHRpb25zSnMpOwoKdmFyIF90cmFja3NUZXh0VHJhY2sgPSBfZGVyZXFfKCcuLi90cmFja3MvdGV4dC10cmFjaycpOwoKdmFyIF90cmFja3NUZXh0VHJhY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhY2tzVGV4dFRyYWNrKTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrTGlzdCA9IF9kZXJlcV8oJy4uL3RyYWNrcy90ZXh0LXRyYWNrLWxpc3QnKTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrTGlzdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFja3NUZXh0VHJhY2tMaXN0KTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi4vdXRpbHMvZm4uanMnKTsKCnZhciBGbiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0ZuSnMpOwoKdmFyIF91dGlsc0xvZ0pzID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nLmpzJyk7Cgp2YXIgX3V0aWxzTG9nSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNMb2dKcyk7Cgp2YXIgX3V0aWxzVGltZVJhbmdlc0pzID0gX2RlcmVxXygnLi4vdXRpbHMvdGltZS1yYW5nZXMuanMnKTsKCnZhciBfdXRpbHNCdWZmZXJKcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2J1ZmZlci5qcycpOwoKdmFyIF9tZWRpYUVycm9ySnMgPSBfZGVyZXFfKCcuLi9tZWRpYS1lcnJvci5qcycpOwoKdmFyIF9tZWRpYUVycm9ySnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVkaWFFcnJvckpzKTsKCnZhciBfZ2xvYmFsV2luZG93ID0gX2RlcmVxXygnZ2xvYmFsL3dpbmRvdycpOwoKdmFyIF9nbG9iYWxXaW5kb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsV2luZG93KTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKLyoqCiAqIEJhc2UgY2xhc3MgZm9yIG1lZGlhIChIVE1MNSBWaWRlbywgRmxhc2gpIGNvbnRyb2xsZXJzCiAqCiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyBPcHRpb25zIG9iamVjdAogKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcmVhZHkgUmVhZHkgY2FsbGJhY2sgZnVuY3Rpb24KICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBUZWNoCiAqLwoKdmFyIFRlY2ggPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoVGVjaCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFRlY2goKSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdOwogICAgdmFyIHJlYWR5ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKCkge30gOiBhcmd1bWVudHNbMV07CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRlY2gpOwoKICAgIC8vIHdlIGRvbid0IHdhbnQgdGhlIHRlY2ggdG8gcmVwb3J0IHVzZXIgYWN0aXZpdHkgYXV0b21hdGljYWxseS4KICAgIC8vIFRoaXMgaXMgZG9uZSBtYW51YWxseSBpbiBhZGRDb250cm9sc0xpc3RlbmVycwogICAgb3B0aW9ucy5yZXBvcnRUb3VjaEFjdGl2aXR5ID0gZmFsc2U7CiAgICBfQ29tcG9uZW50LmNhbGwodGhpcywgbnVsbCwgb3B0aW9ucywgcmVhZHkpOwoKICAgIC8vIGtlZXAgdHJhY2sgb2Ygd2hldGhlciB0aGUgY3VycmVudCBzb3VyY2UgaGFzIHBsYXllZCBhdCBhbGwgdG8KICAgIC8vIGltcGxlbWVudCBhIHZlcnkgbGltaXRlZCBwbGF5ZWQoKQogICAgdGhpcy5oYXNTdGFydGVkXyA9IGZhbHNlOwogICAgdGhpcy5vbigncGxheWluZycsIGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5oYXNTdGFydGVkXyA9IHRydWU7CiAgICB9KTsKICAgIHRoaXMub24oJ2xvYWRzdGFydCcsIGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5oYXNTdGFydGVkXyA9IGZhbHNlOwogICAgfSk7CgogICAgdGhpcy50ZXh0VHJhY2tzXyA9IG9wdGlvbnMudGV4dFRyYWNrczsKCiAgICAvLyBNYW51YWxseSB0cmFjayBwcm9ncmVzcyBpbiBjYXNlcyB3aGVyZSB0aGUgYnJvd3Nlci9mbGFzaCBwbGF5ZXIgZG9lc24ndCByZXBvcnQgaXQuCiAgICBpZiAoIXRoaXMuZmVhdHVyZXNQcm9ncmVzc0V2ZW50cykgewogICAgICB0aGlzLm1hbnVhbFByb2dyZXNzT24oKTsKICAgIH0KCiAgICAvLyBNYW51YWxseSB0cmFjayB0aW1ldXBkYXRlcyBpbiBjYXNlcyB3aGVyZSB0aGUgYnJvd3Nlci9mbGFzaCBwbGF5ZXIgZG9lc24ndCByZXBvcnQgaXQuCiAgICBpZiAoIXRoaXMuZmVhdHVyZXNUaW1ldXBkYXRlRXZlbnRzKSB7CiAgICAgIHRoaXMubWFudWFsVGltZVVwZGF0ZXNPbigpOwogICAgfQoKICAgIGlmIChvcHRpb25zLm5hdGl2ZUNhcHRpb25zID09PSBmYWxzZSB8fCBvcHRpb25zLm5hdGl2ZVRleHRUcmFja3MgPT09IGZhbHNlKSB7CiAgICAgIHRoaXMuZmVhdHVyZXNOYXRpdmVUZXh0VHJhY2tzID0gZmFsc2U7CiAgICB9CgogICAgaWYgKCF0aGlzLmZlYXR1cmVzTmF0aXZlVGV4dFRyYWNrcykgewogICAgICB0aGlzLm9uKCdyZWFkeScsIHRoaXMuZW11bGF0ZVRleHRUcmFja3MpOwogICAgfQoKICAgIHRoaXMuaW5pdFRleHRUcmFja0xpc3RlbmVycygpOwoKICAgIC8vIFR1cm4gb24gY29tcG9uZW50IHRhcCBldmVudHMKICAgIHRoaXMuZW1pdFRhcEV2ZW50cygpOwogIH0KCiAgLyoKICAgKiBMaXN0IG9mIGFzc29jaWF0ZWQgdGV4dCB0cmFja3MKICAgKgogICAqIEB0eXBlIHtBcnJheX0KICAgKiBAcHJpdmF0ZQogICAqLwoKICAvKiBGYWxsYmFja3MgZm9yIHVuc3VwcG9ydGVkIGV2ZW50IHR5cGVzCiAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KICAvLyBNYW51YWxseSB0cmlnZ2VyIHByb2dyZXNzIGV2ZW50cyBiYXNlZCBvbiBjaGFuZ2VzIHRvIHRoZSBidWZmZXJlZCBhbW91bnQKICAvLyBNYW55IGZsYXNoIHBsYXllcnMgYW5kIG9sZGVyIEhUTUw1IGJyb3dzZXJzIGRvbid0IHNlbmQgcHJvZ3Jlc3Mgb3IgcHJvZ3Jlc3MtbGlrZSBldmVudHMKICAvKioKICAgKiBUdXJuIG9uIHByb2dyZXNzIGV2ZW50cwogICAqCiAgICogQG1ldGhvZCBtYW51YWxQcm9ncmVzc09uCiAgICovCgogIFRlY2gucHJvdG90eXBlLm1hbnVhbFByb2dyZXNzT24gPSBmdW5jdGlvbiBtYW51YWxQcm9ncmVzc09uKCkgewogICAgdGhpcy5vbignZHVyYXRpb25jaGFuZ2UnLCB0aGlzLm9uRHVyYXRpb25DaGFuZ2UpOwoKICAgIHRoaXMubWFudWFsUHJvZ3Jlc3MgPSB0cnVlOwoKICAgIC8vIFRyaWdnZXIgcHJvZ3Jlc3Mgd2F0Y2hpbmcgd2hlbiBhIHNvdXJjZSBiZWdpbnMgbG9hZGluZwogICAgdGhpcy5vbmUoJ3JlYWR5JywgdGhpcy50cmFja1Byb2dyZXNzKTsKICB9OwoKICAvKioKICAgKiBUdXJuIG9mZiBwcm9ncmVzcyBldmVudHMKICAgKgogICAqIEBtZXRob2QgbWFudWFsUHJvZ3Jlc3NPZmYKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUubWFudWFsUHJvZ3Jlc3NPZmYgPSBmdW5jdGlvbiBtYW51YWxQcm9ncmVzc09mZigpIHsKICAgIHRoaXMubWFudWFsUHJvZ3Jlc3MgPSBmYWxzZTsKICAgIHRoaXMuc3RvcFRyYWNraW5nUHJvZ3Jlc3MoKTsKCiAgICB0aGlzLm9mZignZHVyYXRpb25jaGFuZ2UnLCB0aGlzLm9uRHVyYXRpb25DaGFuZ2UpOwogIH07CgogIC8qKgogICAqIFRyYWNrIHByb2dyZXNzCiAgICoKICAgKiBAbWV0aG9kIHRyYWNrUHJvZ3Jlc3MKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUudHJhY2tQcm9ncmVzcyA9IGZ1bmN0aW9uIHRyYWNrUHJvZ3Jlc3MoKSB7CiAgICB0aGlzLnN0b3BUcmFja2luZ1Byb2dyZXNzKCk7CiAgICB0aGlzLnByb2dyZXNzSW50ZXJ2YWwgPSB0aGlzLnNldEludGVydmFsKEZuLmJpbmQodGhpcywgZnVuY3Rpb24gKCkgewogICAgICAvLyBEb24ndCB0cmlnZ2VyIHVubGVzcyBidWZmZXJlZCBhbW91bnQgaXMgZ3JlYXRlciB0aGFuIGxhc3QgdGltZQoKICAgICAgdmFyIG51bUJ1ZmZlcmVkUGVyY2VudCA9IHRoaXMuYnVmZmVyZWRQZXJjZW50KCk7CgogICAgICBpZiAodGhpcy5idWZmZXJlZFBlcmNlbnRfICE9PSBudW1CdWZmZXJlZFBlcmNlbnQpIHsKICAgICAgICB0aGlzLnRyaWdnZXIoJ3Byb2dyZXNzJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVmZmVyZWRQZXJjZW50XyA9IG51bUJ1ZmZlcmVkUGVyY2VudDsKCiAgICAgIGlmIChudW1CdWZmZXJlZFBlcmNlbnQgPT09IDEpIHsKICAgICAgICB0aGlzLnN0b3BUcmFja2luZ1Byb2dyZXNzKCk7CiAgICAgIH0KICAgIH0pLCA1MDApOwogIH07CgogIC8qKgogICAqIFVwZGF0ZSBkdXJhdGlvbgogICAqCiAgICogQG1ldGhvZCBvbkR1cmF0aW9uQ2hhbmdlCiAgICovCgogIFRlY2gucHJvdG90eXBlLm9uRHVyYXRpb25DaGFuZ2UgPSBmdW5jdGlvbiBvbkR1cmF0aW9uQ2hhbmdlKCkgewogICAgdGhpcy5kdXJhdGlvbl8gPSB0aGlzLmR1cmF0aW9uKCk7CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIGFuZCBnZXQgVGltZVJhbmdlIG9iamVjdCBmb3IgYnVmZmVyaW5nCiAgICoKICAgKiBAcmV0dXJuIHtUaW1lUmFuZ2VPYmplY3R9CiAgICogQG1ldGhvZCBidWZmZXJlZAogICAqLwoKICBUZWNoLnByb3RvdHlwZS5idWZmZXJlZCA9IGZ1bmN0aW9uIGJ1ZmZlcmVkKCkgewogICAgcmV0dXJuIF91dGlsc1RpbWVSYW5nZXNKcy5jcmVhdGVUaW1lUmFuZ2UoMCwgMCk7CiAgfTsKCiAgLyoqCiAgICogR2V0IGJ1ZmZlcmVkIHBlcmNlbnQKICAgKgogICAqIEByZXR1cm4ge051bWJlcn0KICAgKiBAbWV0aG9kIGJ1ZmZlcmVkUGVyY2VudAogICAqLwoKICBUZWNoLnByb3RvdHlwZS5idWZmZXJlZFBlcmNlbnQgPSBmdW5jdGlvbiBidWZmZXJlZFBlcmNlbnQoKSB7CiAgICByZXR1cm4gX3V0aWxzQnVmZmVySnMuYnVmZmVyZWRQZXJjZW50KHRoaXMuYnVmZmVyZWQoKSwgdGhpcy5kdXJhdGlvbl8pOwogIH07CgogIC8qKgogICAqIFN0b3BzIHRyYWNraW5nIHByb2dyZXNzIGJ5IGNsZWFyaW5nIHByb2dyZXNzIGludGVydmFsCiAgICoKICAgKiBAbWV0aG9kIHN0b3BUcmFja2luZ1Byb2dyZXNzCiAgICovCgogIFRlY2gucHJvdG90eXBlLnN0b3BUcmFja2luZ1Byb2dyZXNzID0gZnVuY3Rpb24gc3RvcFRyYWNraW5nUHJvZ3Jlc3MoKSB7CiAgICB0aGlzLmNsZWFySW50ZXJ2YWwodGhpcy5wcm9ncmVzc0ludGVydmFsKTsKICB9OwoKICAvKiEgVGltZSBUcmFja2luZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwogIC8qKgogICAqIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIG9uIHBsYXkgYW5kIHBhdXNlIGFuZCB0cmFja2luZyBjdXJyZW50IHRpbWUKICAgKgogICAqIEBtZXRob2QgbWFudWFsVGltZVVwZGF0ZXNPbgogICAqLwoKICBUZWNoLnByb3RvdHlwZS5tYW51YWxUaW1lVXBkYXRlc09uID0gZnVuY3Rpb24gbWFudWFsVGltZVVwZGF0ZXNPbigpIHsKICAgIHRoaXMubWFudWFsVGltZVVwZGF0ZXMgPSB0cnVlOwoKICAgIHRoaXMub24oJ3BsYXknLCB0aGlzLnRyYWNrQ3VycmVudFRpbWUpOwogICAgdGhpcy5vbigncGF1c2UnLCB0aGlzLnN0b3BUcmFja2luZ0N1cnJlbnRUaW1lKTsKICB9OwoKICAvKioKICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZvciBvbiBwbGF5IGFuZCBwYXVzZSBhbmQgdHJhY2tpbmcgY3VycmVudCB0aW1lCiAgICoKICAgKiBAbWV0aG9kIG1hbnVhbFRpbWVVcGRhdGVzT2ZmCiAgICovCgogIFRlY2gucHJvdG90eXBlLm1hbnVhbFRpbWVVcGRhdGVzT2ZmID0gZnVuY3Rpb24gbWFudWFsVGltZVVwZGF0ZXNPZmYoKSB7CiAgICB0aGlzLm1hbnVhbFRpbWVVcGRhdGVzID0gZmFsc2U7CiAgICB0aGlzLnN0b3BUcmFja2luZ0N1cnJlbnRUaW1lKCk7CiAgICB0aGlzLm9mZigncGxheScsIHRoaXMudHJhY2tDdXJyZW50VGltZSk7CiAgICB0aGlzLm9mZigncGF1c2UnLCB0aGlzLnN0b3BUcmFja2luZ0N1cnJlbnRUaW1lKTsKICB9OwoKICAvKioKICAgKiBUcmFja3MgY3VycmVudCB0aW1lCiAgICoKICAgKiBAbWV0aG9kIHRyYWNrQ3VycmVudFRpbWUKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUudHJhY2tDdXJyZW50VGltZSA9IGZ1bmN0aW9uIHRyYWNrQ3VycmVudFRpbWUoKSB7CiAgICBpZiAodGhpcy5jdXJyZW50VGltZUludGVydmFsKSB7CiAgICAgIHRoaXMuc3RvcFRyYWNraW5nQ3VycmVudFRpbWUoKTsKICAgIH0KICAgIHRoaXMuY3VycmVudFRpbWVJbnRlcnZhbCA9IHRoaXMuc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnRyaWdnZXIoeyB0eXBlOiAndGltZXVwZGF0ZScsIHRhcmdldDogdGhpcywgbWFudWFsbHlUcmlnZ2VyZWQ6IHRydWUgfSk7CiAgICB9LCAyNTApOyAvLyA0MiA9IDI0IGZwcyAvLyAyNTAgaXMgd2hhdCBXZWJraXQgdXNlcyAvLyBGRiB1c2VzIDE1CiAgfTsKCiAgLyoqCiAgICogVHVybiBvZmYgcGxheSBwcm9ncmVzcyB0cmFja2luZyAod2hlbiBwYXVzZWQgb3IgZHJhZ2dpbmcpCiAgICoKICAgKiBAbWV0aG9kIHN0b3BUcmFja2luZ0N1cnJlbnRUaW1lCiAgICovCgogIFRlY2gucHJvdG90eXBlLnN0b3BUcmFja2luZ0N1cnJlbnRUaW1lID0gZnVuY3Rpb24gc3RvcFRyYWNraW5nQ3VycmVudFRpbWUoKSB7CiAgICB0aGlzLmNsZWFySW50ZXJ2YWwodGhpcy5jdXJyZW50VGltZUludGVydmFsKTsKCiAgICAvLyAjMTAwMiAtIGlmIHRoZSB2aWRlbyBlbmRzIHJpZ2h0IGJlZm9yZSB0aGUgbmV4dCB0aW1ldXBkYXRlIHdvdWxkIGhhcHBlbiwKICAgIC8vIHRoZSBwcm9ncmVzcyBiYXIgd29uJ3QgbWFrZSBpdCBhbGwgdGhlIHdheSB0byB0aGUgZW5kCiAgICB0aGlzLnRyaWdnZXIoeyB0eXBlOiAndGltZXVwZGF0ZScsIHRhcmdldDogdGhpcywgbWFudWFsbHlUcmlnZ2VyZWQ6IHRydWUgfSk7CiAgfTsKCiAgLyoqCiAgICogVHVybiBvZmYgYW55IG1hbnVhbCBwcm9ncmVzcyBvciB0aW1ldXBkYXRlIHRyYWNraW5nCiAgICoKICAgKiBAbWV0aG9kIGRpc3Bvc2UKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAvLyBjbGVhciBvdXQgdGV4dCB0cmFja3MgYmVjYXVzZSB3ZSBjYW4ndCByZXVzZSB0aGVtIGJldHdlZW4gdGVjaHMKICAgIHZhciB0ZXh0VHJhY2tzID0gdGhpcy50ZXh0VHJhY2tzKCk7CgogICAgaWYgKHRleHRUcmFja3MpIHsKICAgICAgdmFyIGkgPSB0ZXh0VHJhY2tzLmxlbmd0aDsKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIHRoaXMucmVtb3ZlUmVtb3RlVGV4dFRyYWNrKHRleHRUcmFja3NbaV0pOwogICAgICB9CiAgICB9CgogICAgLy8gVHVybiBvZmYgYW55IG1hbnVhbCBwcm9ncmVzcyBvciB0aW1ldXBkYXRlIHRyYWNraW5nCiAgICBpZiAodGhpcy5tYW51YWxQcm9ncmVzcykgewogICAgICB0aGlzLm1hbnVhbFByb2dyZXNzT2ZmKCk7CiAgICB9CgogICAgaWYgKHRoaXMubWFudWFsVGltZVVwZGF0ZXMpIHsKICAgICAgdGhpcy5tYW51YWxUaW1lVXBkYXRlc09mZigpOwogICAgfQoKICAgIF9Db21wb25lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTsKICB9OwoKICAvKioKICAgKiBSZXNldCB0aGUgdGVjaC4gUmVtb3ZlcyBhbGwgc291cmNlcyBhbmQgcmVzZXRzIHJlYWR5U3RhdGUuCiAgICoKICAgKiBAbWV0aG9kIHJlc2V0CiAgICovCgogIFRlY2gucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQoKSB7fTsKCiAgLyoqCiAgICogV2hlbiBpbnZva2VkIHdpdGhvdXQgYW4gYXJndW1lbnQsIHJldHVybnMgYSBNZWRpYUVycm9yIG9iamVjdAogICAqIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBlcnJvciBzdGF0ZSBvZiB0aGUgcGxheWVyIG9yIG51bGwgaWYKICAgKiB0aGVyZSBpcyBubyBlcnJvci4gV2hlbiBpbnZva2VkIHdpdGggYW4gYXJndW1lbnQsIHNldCB0aGUgY3VycmVudAogICAqIGVycm9yIHN0YXRlIG9mIHRoZSBwbGF5ZXIuCiAgICogQHBhcmFtIHtNZWRpYUVycm9yPX0gZXJyICAgIE9wdGlvbmFsIGFuIGVycm9yIG9iamVjdAogICAqIEByZXR1cm4ge01lZGlhRXJyb3J9ICAgICAgICB0aGUgY3VycmVudCBlcnJvciBvYmplY3Qgb3IgbnVsbAogICAqIEBtZXRob2QgZXJyb3IKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiBlcnJvcihlcnIpIHsKICAgIGlmIChlcnIgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgX21lZGlhRXJyb3JKczJbJ2RlZmF1bHQnXSkgewogICAgICAgIHRoaXMuZXJyb3JfID0gZXJyOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZXJyb3JfID0gbmV3IF9tZWRpYUVycm9ySnMyWydkZWZhdWx0J10oZXJyKTsKICAgICAgfQogICAgICB0aGlzLnRyaWdnZXIoJ2Vycm9yJyk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5lcnJvcl87CiAgfTsKCiAgLyoqCiAgICogUmV0dXJuIHRoZSB0aW1lIHJhbmdlcyB0aGF0IGhhdmUgYmVlbiBwbGF5ZWQgdGhyb3VnaCBmb3IgdGhlCiAgICogY3VycmVudCBzb3VyY2UuIFRoaXMgaW1wbGVtZW50YXRpb24gaXMgaW5jb21wbGV0ZS4gSXQgZG9lcyBub3QKICAgKiB0cmFjayB0aGUgcGxheWVkIHRpbWUgcmFuZ2VzLCBvbmx5IHdoZXRoZXIgdGhlIHNvdXJjZSBoYXMgcGxheWVkCiAgICogYXQgYWxsIG9yIG5vdC4KICAgKiBAcmV0dXJuIHtUaW1lUmFuZ2VPYmplY3R9IGEgc2luZ2xlIHRpbWUgcmFuZ2UgaWYgdGhpcyB2aWRlbyBoYXMKICAgKiBwbGF5ZWQgb3IgYW4gZW1wdHkgc2V0IG9mIHJhbmdlcyBpZiBub3QuCiAgICogQG1ldGhvZCBwbGF5ZWQKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUucGxheWVkID0gZnVuY3Rpb24gcGxheWVkKCkgewogICAgaWYgKHRoaXMuaGFzU3RhcnRlZF8pIHsKICAgICAgcmV0dXJuIF91dGlsc1RpbWVSYW5nZXNKcy5jcmVhdGVUaW1lUmFuZ2UoMCwgMCk7CiAgICB9CiAgICByZXR1cm4gX3V0aWxzVGltZVJhbmdlc0pzLmNyZWF0ZVRpbWVSYW5nZSgpOwogIH07CgogIC8qKgogICAqIFNldCBjdXJyZW50IHRpbWUKICAgKgogICAqIEBtZXRob2Qgc2V0Q3VycmVudFRpbWUKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUuc2V0Q3VycmVudFRpbWUgPSBmdW5jdGlvbiBzZXRDdXJyZW50VGltZSgpIHsKICAgIC8vIGltcHJvdmUgdGhlIGFjY3VyYWN5IG9mIG1hbnVhbCB0aW1ldXBkYXRlcwogICAgaWYgKHRoaXMubWFudWFsVGltZVVwZGF0ZXMpIHsKICAgICAgdGhpcy50cmlnZ2VyKHsgdHlwZTogJ3RpbWV1cGRhdGUnLCB0YXJnZXQ6IHRoaXMsIG1hbnVhbGx5VHJpZ2dlcmVkOiB0cnVlIH0pOwogICAgfQogIH07CgogIC8qKgogICAqIEluaXRpYWxpemUgdGV4dHRyYWNrIGxpc3RlbmVycwogICAqCiAgICogQG1ldGhvZCBpbml0VGV4dFRyYWNrTGlzdGVuZXJzCiAgICovCgogIFRlY2gucHJvdG90eXBlLmluaXRUZXh0VHJhY2tMaXN0ZW5lcnMgPSBmdW5jdGlvbiBpbml0VGV4dFRyYWNrTGlzdGVuZXJzKCkgewogICAgdmFyIHRleHRUcmFja0xpc3RDaGFuZ2VzID0gRm4uYmluZCh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudHJpZ2dlcigndGV4dHRyYWNrY2hhbmdlJyk7CiAgICB9KTsKCiAgICB2YXIgdHJhY2tzID0gdGhpcy50ZXh0VHJhY2tzKCk7CgogICAgaWYgKCF0cmFja3MpIHJldHVybjsKCiAgICB0cmFja3MuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZldHJhY2snLCB0ZXh0VHJhY2tMaXN0Q2hhbmdlcyk7CiAgICB0cmFja3MuYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCB0ZXh0VHJhY2tMaXN0Q2hhbmdlcyk7CgogICAgdGhpcy5vbignZGlzcG9zZScsIEZuLmJpbmQodGhpcywgZnVuY3Rpb24gKCkgewogICAgICB0cmFja3MucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVtb3ZldHJhY2snLCB0ZXh0VHJhY2tMaXN0Q2hhbmdlcyk7CiAgICAgIHRyYWNrcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIHRleHRUcmFja0xpc3RDaGFuZ2VzKTsKICAgIH0pKTsKICB9OwoKICAvKioKICAgKiBFbXVsYXRlIHRleHR0cmFja3MKICAgKgogICAqIEBtZXRob2QgZW11bGF0ZVRleHRUcmFja3MKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUuZW11bGF0ZVRleHRUcmFja3MgPSBmdW5jdGlvbiBlbXVsYXRlVGV4dFRyYWNrcygpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIHRyYWNrcyA9IHRoaXMudGV4dFRyYWNrcygpOwogICAgaWYgKCF0cmFja3MpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXVsnV2ViVlRUJ10gJiYgdGhpcy5lbCgpLnBhcmVudE5vZGUgIT0gbnVsbCkgewogICAgICB2YXIgc2NyaXB0ID0gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgICBzY3JpcHQuc3JjID0gdGhpcy5vcHRpb25zX1sndnR0LmpzJ10gfHwgJ2h0dHBzOi8vY2RuLnJhd2dpdC5jb20vZ2thdHNldi92dHQuanMvdmpzLXYwLjEyLjEvZGlzdC92dHQubWluLmpzJzsKICAgICAgdGhpcy5lbCgpLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKICAgICAgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXVsnV2ViVlRUJ10gPSB0cnVlOwogICAgfQoKICAgIHZhciB1cGRhdGVEaXNwbGF5ID0gZnVuY3Rpb24gdXBkYXRlRGlzcGxheSgpIHsKICAgICAgcmV0dXJuIF90aGlzLnRyaWdnZXIoJ3RleHR0cmFja2NoYW5nZScpOwogICAgfTsKICAgIHZhciB0ZXh0VHJhY2tzQ2hhbmdlcyA9IGZ1bmN0aW9uIHRleHRUcmFja3NDaGFuZ2VzKCkgewogICAgICB1cGRhdGVEaXNwbGF5KCk7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciB0cmFjayA9IHRyYWNrc1tpXTsKICAgICAgICB0cmFjay5yZW1vdmVFdmVudExpc3RlbmVyKCdjdWVjaGFuZ2UnLCB1cGRhdGVEaXNwbGF5KTsKICAgICAgICBpZiAodHJhY2subW9kZSA9PT0gJ3Nob3dpbmcnKSB7CiAgICAgICAgICB0cmFjay5hZGRFdmVudExpc3RlbmVyKCdjdWVjaGFuZ2UnLCB1cGRhdGVEaXNwbGF5KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgdGV4dFRyYWNrc0NoYW5nZXMoKTsKICAgIHRyYWNrcy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0ZXh0VHJhY2tzQ2hhbmdlcyk7CgogICAgdGhpcy5vbignZGlzcG9zZScsIGZ1bmN0aW9uICgpIHsKICAgICAgdHJhY2tzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRleHRUcmFja3NDaGFuZ2VzKTsKICAgIH0pOwogIH07CgogIC8qCiAgICogUHJvdmlkZSBkZWZhdWx0IG1ldGhvZHMgZm9yIHRleHQgdHJhY2tzLgogICAqCiAgICogSHRtbDUgdGVjaCBvdmVycmlkZXMgdGhlc2UuCiAgICovCgogIC8qKgogICAqIEdldCB0ZXh0dHJhY2tzCiAgICoKICAgKiBAcmV0dXJucyB7VGV4dFRyYWNrTGlzdH0KICAgKiBAbWV0aG9kIHRleHRUcmFja3MKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUudGV4dFRyYWNrcyA9IGZ1bmN0aW9uIHRleHRUcmFja3MoKSB7CiAgICB0aGlzLnRleHRUcmFja3NfID0gdGhpcy50ZXh0VHJhY2tzXyB8fCBuZXcgX3RyYWNrc1RleHRUcmFja0xpc3QyWydkZWZhdWx0J10oKTsKICAgIHJldHVybiB0aGlzLnRleHRUcmFja3NfOwogIH07CgogIC8qKgogICAqIEdldCByZW1vdGUgdGV4dHRyYWNrcwogICAqCiAgICogQHJldHVybnMge1RleHRUcmFja0xpc3R9CiAgICogQG1ldGhvZCByZW1vdGVUZXh0VHJhY2tzCiAgICovCgogIFRlY2gucHJvdG90eXBlLnJlbW90ZVRleHRUcmFja3MgPSBmdW5jdGlvbiByZW1vdGVUZXh0VHJhY2tzKCkgewogICAgdGhpcy5yZW1vdGVUZXh0VHJhY2tzXyA9IHRoaXMucmVtb3RlVGV4dFRyYWNrc18gfHwgbmV3IF90cmFja3NUZXh0VHJhY2tMaXN0MlsnZGVmYXVsdCddKCk7CiAgICByZXR1cm4gdGhpcy5yZW1vdGVUZXh0VHJhY2tzXzsKICB9OwoKICAvKioKICAgKiBHZXQgcmVtb3RlIGh0bWx0cmFja2VsZW1lbnRzCiAgICoKICAgKiBAcmV0dXJucyB7SFRNTFRyYWNrRWxlbWVudExpc3R9CiAgICogQG1ldGhvZCByZW1vdGVUZXh0VHJhY2tFbHMKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUucmVtb3RlVGV4dFRyYWNrRWxzID0gZnVuY3Rpb24gcmVtb3RlVGV4dFRyYWNrRWxzKCkgewogICAgdGhpcy5yZW1vdGVUZXh0VHJhY2tFbHNfID0gdGhpcy5yZW1vdGVUZXh0VHJhY2tFbHNfIHx8IG5ldyBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudExpc3QyWydkZWZhdWx0J10oKTsKICAgIHJldHVybiB0aGlzLnJlbW90ZVRleHRUcmFja0Vsc187CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIHJlbW90ZSB0ZXh0IHRyYWNrIG9iamVjdAogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IGtpbmQgVGV4dCB0cmFjayBraW5kIChzdWJ0aXRsZXMsIGNhcHRpb25zLCBkZXNjcmlwdGlvbnMKICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXB0ZXJzIGFuZCBtZXRhZGF0YSkKICAgKiBAcGFyYW0ge1N0cmluZz19IGxhYmVsIExhYmVsIHRvIGlkZW50aWZ5IHRoZSB0ZXh0IHRyYWNrCiAgICogQHBhcmFtIHtTdHJpbmc9fSBsYW5ndWFnZSBUd28gbGV0dGVyIGxhbmd1YWdlIGFiYnJldmlhdGlvbgogICAqIEByZXR1cm4ge1RleHRUcmFja09iamVjdH0KICAgKiBAbWV0aG9kIGFkZFRleHRUcmFjawogICAqLwoKICBUZWNoLnByb3RvdHlwZS5hZGRUZXh0VHJhY2sgPSBmdW5jdGlvbiBhZGRUZXh0VHJhY2soa2luZCwgbGFiZWwsIGxhbmd1YWdlKSB7CiAgICBpZiAoIWtpbmQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZXh0VHJhY2sga2luZCBpcyByZXF1aXJlZCBidXQgd2FzIG5vdCBwcm92aWRlZCcpOwogICAgfQoKICAgIHJldHVybiBjcmVhdGVUcmFja0hlbHBlcih0aGlzLCBraW5kLCBsYWJlbCwgbGFuZ3VhZ2UpOwogIH07CgogIC8qKgogICAqIENyZWF0ZXMgYSByZW1vdGUgdGV4dCB0cmFjayBvYmplY3QgYW5kIHJldHVybnMgYSBlbXVsYXRlZCBodG1sIHRyYWNrIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIFRoZSBvYmplY3Qgc2hvdWxkIGNvbnRhaW4gdmFsdWVzIGZvcgogICAqIGtpbmQsIGxhbmd1YWdlLCBsYWJlbCBhbmQgc3JjIChsb2NhdGlvbiBvZiB0aGUgV2ViVlRUIGZpbGUpCiAgICogQHJldHVybiB7SFRNTFRyYWNrRWxlbWVudH0KICAgKiBAbWV0aG9kIGFkZFJlbW90ZVRleHRUcmFjawogICAqLwoKICBUZWNoLnByb3RvdHlwZS5hZGRSZW1vdGVUZXh0VHJhY2sgPSBmdW5jdGlvbiBhZGRSZW1vdGVUZXh0VHJhY2sob3B0aW9ucykgewogICAgdmFyIHRyYWNrID0gX3V0aWxzTWVyZ2VPcHRpb25zSnMyWydkZWZhdWx0J10ob3B0aW9ucywgewogICAgICB0ZWNoOiB0aGlzCiAgICB9KTsKCiAgICB2YXIgaHRtbFRyYWNrRWxlbWVudCA9IG5ldyBfdHJhY2tzSHRtbFRyYWNrRWxlbWVudDJbJ2RlZmF1bHQnXSh0cmFjayk7CgogICAgLy8gc3RvcmUgSFRNTFRyYWNrRWxlbWVudCBhbmQgVGV4dFRyYWNrIHRvIHJlbW90ZSBsaXN0CiAgICB0aGlzLnJlbW90ZVRleHRUcmFja0VscygpLmFkZFRyYWNrRWxlbWVudF8oaHRtbFRyYWNrRWxlbWVudCk7CiAgICB0aGlzLnJlbW90ZVRleHRUcmFja3MoKS5hZGRUcmFja18oaHRtbFRyYWNrRWxlbWVudC50cmFjayk7CgogICAgLy8gbXVzdCBjb21lIGFmdGVyIHJlbW90ZVRleHRUcmFja3MoKQogICAgdGhpcy50ZXh0VHJhY2tzKCkuYWRkVHJhY2tfKGh0bWxUcmFja0VsZW1lbnQudHJhY2spOwoKICAgIHJldHVybiBodG1sVHJhY2tFbGVtZW50OwogIH07CgogIC8qKgogICAqIFJlbW92ZSByZW1vdGUgdGV4dHRyYWNrCiAgICoKICAgKiBAcGFyYW0ge1RleHRUcmFja09iamVjdH0gdHJhY2sgVGV4dHRyYWNrIHRvIHJlbW92ZQogICAqIEBtZXRob2QgcmVtb3ZlUmVtb3RlVGV4dFRyYWNrCiAgICovCgogIFRlY2gucHJvdG90eXBlLnJlbW92ZVJlbW90ZVRleHRUcmFjayA9IGZ1bmN0aW9uIHJlbW92ZVJlbW90ZVRleHRUcmFjayh0cmFjaykgewogICAgdGhpcy50ZXh0VHJhY2tzKCkucmVtb3ZlVHJhY2tfKHRyYWNrKTsKCiAgICB2YXIgdHJhY2tFbGVtZW50ID0gdGhpcy5yZW1vdGVUZXh0VHJhY2tFbHMoKS5nZXRUcmFja0VsZW1lbnRCeVRyYWNrXyh0cmFjayk7CgogICAgLy8gcmVtb3ZlIEhUTUxUcmFja0VsZW1lbnQgYW5kIFRleHRUcmFjayBmcm9tIHJlbW90ZSBsaXN0CiAgICB0aGlzLnJlbW90ZVRleHRUcmFja0VscygpLnJlbW92ZVRyYWNrRWxlbWVudF8odHJhY2tFbGVtZW50KTsKICAgIHRoaXMucmVtb3RlVGV4dFRyYWNrcygpLnJlbW92ZVRyYWNrXyh0cmFjayk7CiAgfTsKCiAgLyoqCiAgICogUHJvdmlkZSBhIGRlZmF1bHQgc2V0UG9zdGVyIG1ldGhvZCBmb3IgdGVjaHMKICAgKiBQb3N0ZXIgc3VwcG9ydCBmb3IgdGVjaHMgc2hvdWxkIGJlIG9wdGlvbmFsLCBzbyB3ZSBkb24ndCB3YW50IHRlY2hzIHRvCiAgICogYnJlYWsgaWYgdGhleSBkb24ndCBoYXZlIGEgd2F5IHRvIHNldCBhIHBvc3Rlci4KICAgKgogICAqIEBtZXRob2Qgc2V0UG9zdGVyCiAgICovCgogIFRlY2gucHJvdG90eXBlLnNldFBvc3RlciA9IGZ1bmN0aW9uIHNldFBvc3RlcigpIHt9OwoKICAvKgogICAqIENoZWNrIGlmIHRoZSB0ZWNoIGNhbiBzdXBwb3J0IHRoZSBnaXZlbiB0eXBlCiAgICoKICAgKiBUaGUgYmFzZSB0ZWNoIGRvZXMgbm90IHN1cHBvcnQgYW55IHR5cGUsIGJ1dCBzb3VyY2UgaGFuZGxlcnMgbWlnaHQKICAgKiBvdmVyd3JpdGUgdGhpcy4KICAgKgogICAqIEBwYXJhbSAge1N0cmluZ30gdHlwZSAgICBUaGUgbWltZXR5cGUgdG8gY2hlY2sKICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICAgKi8KCiAgVGVjaC5wcm90b3R5cGUuY2FuUGxheVR5cGUgPSBmdW5jdGlvbiBjYW5QbGF5VHlwZSgpIHsKICAgIHJldHVybiAnJzsKICB9OwoKICAvKgogICAqIFJldHVybiB3aGV0aGVyIHRoZSBhcmd1bWVudCBpcyBhIFRlY2ggb3Igbm90LgogICAqIENhbiBiZSBwYXNzZWQgZWl0aGVyIGEgQ2xhc3MgbGlrZSBgSHRtbDVgIG9yIGEgaW5zdGFuY2UgbGlrZSBgcGxheWVyLnRlY2hfYAogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IGNvbXBvbmVudCBBbiBpdGVtIHRvIGNoZWNrCiAgICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgICBXaGV0aGVyIGl0IGlzIGEgdGVjaCBvciBub3QKICAgKi8KCiAgVGVjaC5pc1RlY2ggPSBmdW5jdGlvbiBpc1RlY2goY29tcG9uZW50KSB7CiAgICByZXR1cm4gY29tcG9uZW50LnByb3RvdHlwZSBpbnN0YW5jZW9mIFRlY2ggfHwgY29tcG9uZW50IGluc3RhbmNlb2YgVGVjaCB8fCBjb21wb25lbnQgPT09IFRlY2g7CiAgfTsKCiAgLyoqCiAgICogUmVnaXN0ZXJzIGEgVGVjaAogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgVGVjaCB0byByZWdpc3RlcgogICAqIEBwYXJhbSB7T2JqZWN0fSB0ZWNoIFRoZSB0ZWNoIHRvIHJlZ2lzdGVyCiAgICogQHN0YXRpYwogICAqIEBtZXRob2QgcmVnaXN0ZXJDb21wb25lbnQKICAgKi8KCiAgVGVjaC5yZWdpc3RlclRlY2ggPSBmdW5jdGlvbiByZWdpc3RlclRlY2gobmFtZSwgdGVjaCkgewogICAgaWYgKCFUZWNoLnRlY2hzXykgewogICAgICBUZWNoLnRlY2hzXyA9IHt9OwogICAgfQoKICAgIGlmICghVGVjaC5pc1RlY2godGVjaCkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZWNoICcgKyBuYW1lICsgJyBtdXN0IGJlIGEgVGVjaCcpOwogICAgfQoKICAgIFRlY2gudGVjaHNfW25hbWVdID0gdGVjaDsKICAgIHJldHVybiB0ZWNoOwogIH07CgogIC8qKgogICAqIEdldHMgYSBjb21wb25lbnQgYnkgbmFtZQogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgY29tcG9uZW50IHRvIGdldAogICAqIEByZXR1cm4ge0NvbXBvbmVudH0KICAgKiBAc3RhdGljCiAgICogQG1ldGhvZCBnZXRDb21wb25lbnQKICAgKi8KCiAgVGVjaC5nZXRUZWNoID0gZnVuY3Rpb24gZ2V0VGVjaChuYW1lKSB7CiAgICBpZiAoVGVjaC50ZWNoc18gJiYgVGVjaC50ZWNoc19bbmFtZV0pIHsKICAgICAgcmV0dXJuIFRlY2gudGVjaHNfW25hbWVdOwogICAgfQoKICAgIGlmIChfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddICYmIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10udmlkZW9qcyAmJiBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnZpZGVvanNbbmFtZV0pIHsKICAgICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10ud2FybignVGhlICcgKyBuYW1lICsgJyB0ZWNoIHdhcyBhZGRlZCB0byB0aGUgdmlkZW9qcyBvYmplY3Qgd2hlbiBpdCBzaG91bGQgYmUgcmVnaXN0ZXJlZCB1c2luZyB2aWRlb2pzLnJlZ2lzdGVyVGVjaChuYW1lLCB0ZWNoKScpOwogICAgICByZXR1cm4gX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS52aWRlb2pzW25hbWVdOwogICAgfQogIH07CgogIHJldHVybiBUZWNoOwp9KShfY29tcG9uZW50MlsnZGVmYXVsdCddKTsKClRlY2gucHJvdG90eXBlLnRleHRUcmFja3NfOwoKdmFyIGNyZWF0ZVRyYWNrSGVscGVyID0gZnVuY3Rpb24gY3JlYXRlVHJhY2tIZWxwZXIoc2VsZiwga2luZCwgbGFiZWwsIGxhbmd1YWdlKSB7CiAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDQgfHwgYXJndW1lbnRzWzRdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1s0XTsKCiAgdmFyIHRyYWNrcyA9IHNlbGYudGV4dFRyYWNrcygpOwoKICBvcHRpb25zLmtpbmQgPSBraW5kOwoKICBpZiAobGFiZWwpIHsKICAgIG9wdGlvbnMubGFiZWwgPSBsYWJlbDsKICB9CiAgaWYgKGxhbmd1YWdlKSB7CiAgICBvcHRpb25zLmxhbmd1YWdlID0gbGFuZ3VhZ2U7CiAgfQogIG9wdGlvbnMudGVjaCA9IHNlbGY7CgogIHZhciB0cmFjayA9IG5ldyBfdHJhY2tzVGV4dFRyYWNrMlsnZGVmYXVsdCddKG9wdGlvbnMpOwogIHRyYWNrcy5hZGRUcmFja18odHJhY2spOwoKICByZXR1cm4gdHJhY2s7Cn07CgpUZWNoLnByb3RvdHlwZS5mZWF0dXJlc1ZvbHVtZUNvbnRyb2wgPSB0cnVlOwoKLy8gUmVzaXppbmcgcGx1Z2lucyB1c2luZyByZXF1ZXN0IGZ1bGxzY3JlZW4gcmVsb2FkcyB0aGUgcGx1Z2luClRlY2gucHJvdG90eXBlLmZlYXR1cmVzRnVsbHNjcmVlblJlc2l6ZSA9IGZhbHNlOwpUZWNoLnByb3RvdHlwZS5mZWF0dXJlc1BsYXliYWNrUmF0ZSA9IGZhbHNlOwoKLy8gT3B0aW9uYWwgZXZlbnRzIHRoYXQgd2UgY2FuIG1hbnVhbGx5IG1pbWljIHdpdGggdGltZXJzCi8vIGN1cnJlbnRseSBub3QgdHJpZ2dlcmVkIGJ5IHZpZGVvLWpzLXN3ZgpUZWNoLnByb3RvdHlwZS5mZWF0dXJlc1Byb2dyZXNzRXZlbnRzID0gZmFsc2U7ClRlY2gucHJvdG90eXBlLmZlYXR1cmVzVGltZXVwZGF0ZUV2ZW50cyA9IGZhbHNlOwoKVGVjaC5wcm90b3R5cGUuZmVhdHVyZXNOYXRpdmVUZXh0VHJhY2tzID0gZmFsc2U7CgovKgogKiBBIGZ1bmN0aW9uYWwgbWl4aW4gZm9yIHRlY2hzIHRoYXQgd2FudCB0byB1c2UgdGhlIFNvdXJjZSBIYW5kbGVyIHBhdHRlcm4uCiAqCiAqICMjIyMjIEVYQU1QTEU6CiAqCiAqICAgVGVjaC53aXRoU291cmNlSGFuZGxlcnMuY2FsbChNeVRlY2gpOwogKgogKi8KVGVjaC53aXRoU291cmNlSGFuZGxlcnMgPSBmdW5jdGlvbiAoX1RlY2gpIHsKICAvKgogICAqIFJlZ2lzdGVyIGEgc291cmNlIGhhbmRsZXIKICAgKiBTb3VyY2UgaGFuZGxlcnMgYXJlIHNjcmlwdHMgZm9yIGhhbmRsaW5nIHNwZWNpZmljIGZvcm1hdHMuCiAgICogVGhlIHNvdXJjZSBoYW5kbGVyIHBhdHRlcm4gaXMgdXNlZCBmb3IgYWRhcHRpdmUgZm9ybWF0cyAoSExTLCBEQVNIKSB0aGF0CiAgICogbWFudWFsbHkgbG9hZCB2aWRlbyBkYXRhIGFuZCBmZWVkIGl0IGludG8gYSBTb3VyY2UgQnVmZmVyIChNZWRpYSBTb3VyY2UgRXh0ZW5zaW9ucykKICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gaGFuZGxlciAgVGhlIHNvdXJjZSBoYW5kbGVyCiAgICogQHBhcmFtICB7Qm9vbGVhbn0gIGZpcnN0ICAgIFJlZ2lzdGVyIGl0IGJlZm9yZSBhbnkgZXhpc3RpbmcgaGFuZGxlcnMKICAgKi8KICBfVGVjaC5yZWdpc3RlclNvdXJjZUhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlciwgaW5kZXgpIHsKICAgIHZhciBoYW5kbGVycyA9IF9UZWNoLnNvdXJjZUhhbmRsZXJzOwoKICAgIGlmICghaGFuZGxlcnMpIHsKICAgICAgaGFuZGxlcnMgPSBfVGVjaC5zb3VyY2VIYW5kbGVycyA9IFtdOwogICAgfQoKICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIC8vIGFkZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0CiAgICAgIGluZGV4ID0gaGFuZGxlcnMubGVuZ3RoOwogICAgfQoKICAgIGhhbmRsZXJzLnNwbGljZShpbmRleCwgMCwgaGFuZGxlcik7CiAgfTsKCiAgLyoKICAgKiBDaGVjayBpZiB0aGUgdGVjaCBjYW4gc3VwcG9ydCB0aGUgZ2l2ZW4gdHlwZQogICAqIEBwYXJhbSAge1N0cmluZ30gdHlwZSAgICBUaGUgbWltZXR5cGUgdG8gY2hlY2sKICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgJ3Byb2JhYmx5JywgJ21heWJlJywgb3IgJycgKGVtcHR5IHN0cmluZykKICAgKi8KICBfVGVjaC5jYW5QbGF5VHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7CiAgICB2YXIgaGFuZGxlcnMgPSBfVGVjaC5zb3VyY2VIYW5kbGVycyB8fCBbXTsKICAgIHZhciBjYW4gPSB1bmRlZmluZWQ7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoYW5kbGVycy5sZW5ndGg7IGkrKykgewogICAgICBjYW4gPSBoYW5kbGVyc1tpXS5jYW5QbGF5VHlwZSh0eXBlKTsKCiAgICAgIGlmIChjYW4pIHsKICAgICAgICByZXR1cm4gY2FuOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICcnOwogIH07CgogIC8qCiAgICogUmV0dXJuIHRoZSBmaXJzdCBzb3VyY2UgaGFuZGxlciB0aGF0IHN1cHBvcnRzIHRoZSBzb3VyY2UKICAgKiBUT0RPOiBBbnN3ZXIgcXVlc3Rpb246IHNob3VsZCAncHJvYmFibHknIGJlIHByaW9yaXRpemVkIG92ZXIgJ21heWJlJwogICAqIEBwYXJhbSAge09iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2JqZWN0CiAgICogQHJldHVybnMge09iamVjdH0gICAgICAgVGhlIGZpcnN0IHNvdXJjZSBoYW5kbGVyIHRoYXQgc3VwcG9ydHMgdGhlIHNvdXJjZQogICAqIEByZXR1cm5zIHtudWxsfSAgICAgICAgIE51bGwgaWYgbm8gc291cmNlIGhhbmRsZXIgaXMgZm91bmQKICAgKi8KICBfVGVjaC5zZWxlY3RTb3VyY2VIYW5kbGVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewogICAgdmFyIGhhbmRsZXJzID0gX1RlY2guc291cmNlSGFuZGxlcnMgfHwgW107CiAgICB2YXIgY2FuID0gdW5kZWZpbmVkOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGFuZGxlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgY2FuID0gaGFuZGxlcnNbaV0uY2FuSGFuZGxlU291cmNlKHNvdXJjZSk7CgogICAgICBpZiAoY2FuKSB7CiAgICAgICAgcmV0dXJuIGhhbmRsZXJzW2ldOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfTsKCiAgLyoKICAgKiBDaGVjayBpZiB0aGUgdGVjaCBjYW4gc3VwcG9ydCB0aGUgZ2l2ZW4gc291cmNlCiAgICogQHBhcmFtICB7T2JqZWN0fSBzcmNPYmogIFRoZSBzb3VyY2Ugb2JqZWN0CiAgICogQHJldHVybiB7U3RyaW5nfSAgICAgICAgICdwcm9iYWJseScsICdtYXliZScsIG9yICcnIChlbXB0eSBzdHJpbmcpCiAgICovCiAgX1RlY2guY2FuUGxheVNvdXJjZSA9IGZ1bmN0aW9uIChzcmNPYmopIHsKICAgIHZhciBzaCA9IF9UZWNoLnNlbGVjdFNvdXJjZUhhbmRsZXIoc3JjT2JqKTsKCiAgICBpZiAoc2gpIHsKICAgICAgcmV0dXJuIHNoLmNhbkhhbmRsZVNvdXJjZShzcmNPYmopOwogICAgfQoKICAgIHJldHVybiAnJzsKICB9OwoKICAvKgogICAqIFdoZW4gdXNpbmcgYSBzb3VyY2UgaGFuZGxlciwgcHJlZmVyIGl0cyBpbXBsZW1lbnRhdGlvbiBvZgogICAqIGFueSBmdW5jdGlvbiBub3JtYWxseSBwcm92aWRlZCBieSB0aGUgdGVjaC4KICAgKi8KICB2YXIgZGVmZXJyYWJsZSA9IFsnc2Vla2FibGUnLCAnZHVyYXRpb24nXTsKCiAgZGVmZXJyYWJsZS5mb3JFYWNoKGZ1bmN0aW9uIChmbk5hbWUpIHsKICAgIHZhciBvcmlnaW5hbEZuID0gdGhpc1tmbk5hbWVdOwoKICAgIGlmICh0eXBlb2Ygb3JpZ2luYWxGbiAhPT0gJ2Z1bmN0aW9uJykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpc1tmbk5hbWVdID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcy5zb3VyY2VIYW5kbGVyXyAmJiB0aGlzLnNvdXJjZUhhbmRsZXJfW2ZuTmFtZV0pIHsKICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2VIYW5kbGVyX1tmbk5hbWVdLmFwcGx5KHRoaXMuc291cmNlSGFuZGxlcl8sIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIG9yaWdpbmFsRm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSwgX1RlY2gucHJvdG90eXBlKTsKCiAgLyoKICAgKiBDcmVhdGUgYSBmdW5jdGlvbiBmb3Igc2V0dGluZyB0aGUgc291cmNlIHVzaW5nIGEgc291cmNlIG9iamVjdAogICAqIGFuZCBzb3VyY2UgaGFuZGxlcnMuCiAgICogU2hvdWxkIG5ldmVyIGJlIGNhbGxlZCB1bmxlc3MgYSBzb3VyY2UgaGFuZGxlciB3YXMgZm91bmQuCiAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSAgQSBzb3VyY2Ugb2JqZWN0IHdpdGggc3JjIGFuZCB0eXBlIGtleXMKICAgKiBAcmV0dXJuIHtUZWNofSBzZWxmCiAgICovCiAgX1RlY2gucHJvdG90eXBlLnNldFNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHsKICAgIHZhciBzaCA9IF9UZWNoLnNlbGVjdFNvdXJjZUhhbmRsZXIoc291cmNlKTsKCiAgICBpZiAoIXNoKSB7CiAgICAgIC8vIEZhbGwgYmFjayB0byBhIG5hdGl2ZSBzb3VyY2UgaGFuZGVyIHdoZW4gdW5zdXBwb3J0ZWQgc291cmNlcyBhcmUKICAgICAgLy8gZGVsaWJlcmF0ZWx5IHNldAogICAgICBpZiAoX1RlY2gubmF0aXZlU291cmNlSGFuZGxlcikgewogICAgICAgIHNoID0gX1RlY2gubmF0aXZlU291cmNlSGFuZGxlcjsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS5lcnJvcignTm8gc291cmNlIGhhbmRlciBmb3VuZCBmb3IgdGhlIGN1cnJlbnQgc291cmNlLicpOwogICAgICB9CiAgICB9CgogICAgLy8gRGlzcG9zZSBhbnkgZXhpc3Rpbmcgc291cmNlIGhhbmRsZXIKICAgIHRoaXMuZGlzcG9zZVNvdXJjZUhhbmRsZXIoKTsKICAgIHRoaXMub2ZmKCdkaXNwb3NlJywgdGhpcy5kaXNwb3NlU291cmNlSGFuZGxlcik7CgogICAgdGhpcy5jdXJyZW50U291cmNlXyA9IHNvdXJjZTsKICAgIHRoaXMuc291cmNlSGFuZGxlcl8gPSBzaC5oYW5kbGVTb3VyY2Uoc291cmNlLCB0aGlzKTsKICAgIHRoaXMub24oJ2Rpc3Bvc2UnLCB0aGlzLmRpc3Bvc2VTb3VyY2VIYW5kbGVyKTsKCiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvKgogICAqIENsZWFuIHVwIGFueSBleGlzdGluZyBzb3VyY2UgaGFuZGxlcgogICAqLwogIF9UZWNoLnByb3RvdHlwZS5kaXNwb3NlU291cmNlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLnNvdXJjZUhhbmRsZXJfICYmIHRoaXMuc291cmNlSGFuZGxlcl8uZGlzcG9zZSkgewogICAgICB0aGlzLnNvdXJjZUhhbmRsZXJfLmRpc3Bvc2UoKTsKICAgIH0KICB9Owp9OwoKX2NvbXBvbmVudDJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnVGVjaCcsIFRlY2gpOwovLyBPbGQgbmFtZSBmb3IgVGVjaApfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50KCdNZWRpYVRlY2hDb250cm9sbGVyJywgVGVjaCk7ClRlY2gucmVnaXN0ZXJUZWNoKCdUZWNoJywgVGVjaCk7CmV4cG9ydHNbJ2RlZmF1bHQnXSA9IFRlY2g7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL2NvbXBvbmVudCI6NjUsIi4uL21lZGlhLWVycm9yLmpzIjoxMDEsIi4uL3RyYWNrcy9odG1sLXRyYWNrLWVsZW1lbnQiOjExNywiLi4vdHJhY2tzL2h0bWwtdHJhY2stZWxlbWVudC1saXN0IjoxMTYsIi4uL3RyYWNrcy90ZXh0LXRyYWNrIjoxMjQsIi4uL3RyYWNrcy90ZXh0LXRyYWNrLWxpc3QiOjEyMiwiLi4vdXRpbHMvYnVmZmVyLmpzIjoxMjYsIi4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uL3V0aWxzL2xvZy5qcyI6MTMzLCIuLi91dGlscy9tZXJnZS1vcHRpb25zLmpzIjoxMzQsIi4uL3V0aWxzL3RpbWUtcmFuZ2VzLmpzIjoxMzYsImdsb2JhbC9kb2N1bWVudCI6MSwiZ2xvYmFsL3dpbmRvdyI6Mn1dLDExNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBodG1sLXRyYWNrLWVsZW1lbnQuanMKICovCgondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKdmFyIF91dGlsc0Jyb3dzZXJKcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTsKCnZhciBicm93c2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzQnJvd3NlckpzKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKdmFyIEh0bWxUcmFja0VsZW1lbnRMaXN0ID0gKGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBIdG1sVHJhY2tFbGVtZW50TGlzdCgpIHsKICAgIHZhciB0cmFja0VsZW1lbnRzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gW10gOiBhcmd1bWVudHNbMF07CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEh0bWxUcmFja0VsZW1lbnRMaXN0KTsKCiAgICB2YXIgbGlzdCA9IHRoaXM7CgogICAgaWYgKGJyb3dzZXIuSVNfSUU4KSB7CiAgICAgIGxpc3QgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgnY3VzdG9tJyk7CgogICAgICBmb3IgKHZhciBwcm9wIGluIEh0bWxUcmFja0VsZW1lbnRMaXN0LnByb3RvdHlwZSkgewogICAgICAgIGlmIChwcm9wICE9PSAnY29uc3RydWN0b3InKSB7CiAgICAgICAgICBsaXN0W3Byb3BdID0gSHRtbFRyYWNrRWxlbWVudExpc3QucHJvdG90eXBlW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGxpc3QudHJhY2tFbGVtZW50c18gPSBbXTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobGlzdCwgJ2xlbmd0aCcsIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHJhY2tFbGVtZW50c18ubGVuZ3RoOwogICAgICB9CiAgICB9KTsKCiAgICBmb3IgKHZhciBpID0gMCwgX2xlbmd0aCA9IHRyYWNrRWxlbWVudHMubGVuZ3RoOyBpIDwgX2xlbmd0aDsgaSsrKSB7CiAgICAgIGxpc3QuYWRkVHJhY2tFbGVtZW50Xyh0cmFja0VsZW1lbnRzW2ldKTsKICAgIH0KCiAgICBpZiAoYnJvd3Nlci5JU19JRTgpIHsKICAgICAgcmV0dXJuIGxpc3Q7CiAgICB9CiAgfQoKICBIdG1sVHJhY2tFbGVtZW50TGlzdC5wcm90b3R5cGUuYWRkVHJhY2tFbGVtZW50XyA9IGZ1bmN0aW9uIGFkZFRyYWNrRWxlbWVudF8odHJhY2tFbGVtZW50KSB7CiAgICB0aGlzLnRyYWNrRWxlbWVudHNfLnB1c2godHJhY2tFbGVtZW50KTsKICB9OwoKICBIdG1sVHJhY2tFbGVtZW50TGlzdC5wcm90b3R5cGUuZ2V0VHJhY2tFbGVtZW50QnlUcmFja18gPSBmdW5jdGlvbiBnZXRUcmFja0VsZW1lbnRCeVRyYWNrXyh0cmFjaykgewogICAgdmFyIHRyYWNrRWxlbWVudF8gPSB1bmRlZmluZWQ7CgogICAgZm9yICh2YXIgaSA9IDAsIF9sZW5ndGgyID0gdGhpcy50cmFja0VsZW1lbnRzXy5sZW5ndGg7IGkgPCBfbGVuZ3RoMjsgaSsrKSB7CiAgICAgIGlmICh0cmFjayA9PT0gdGhpcy50cmFja0VsZW1lbnRzX1tpXS50cmFjaykgewogICAgICAgIHRyYWNrRWxlbWVudF8gPSB0aGlzLnRyYWNrRWxlbWVudHNfW2ldOwoKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cmFja0VsZW1lbnRfOwogIH07CgogIEh0bWxUcmFja0VsZW1lbnRMaXN0LnByb3RvdHlwZS5yZW1vdmVUcmFja0VsZW1lbnRfID0gZnVuY3Rpb24gcmVtb3ZlVHJhY2tFbGVtZW50Xyh0cmFja0VsZW1lbnQpIHsKICAgIGZvciAodmFyIGkgPSAwLCBfbGVuZ3RoMyA9IHRoaXMudHJhY2tFbGVtZW50c18ubGVuZ3RoOyBpIDwgX2xlbmd0aDM7IGkrKykgewogICAgICBpZiAodHJhY2tFbGVtZW50ID09PSB0aGlzLnRyYWNrRWxlbWVudHNfW2ldKSB7CiAgICAgICAgdGhpcy50cmFja0VsZW1lbnRzXy5zcGxpY2UoaSwgMSk7CgogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfTsKCiAgcmV0dXJuIEh0bWxUcmFja0VsZW1lbnRMaXN0Owp9KSgpOwoKZXhwb3J0c1snZGVmYXVsdCddID0gSHRtbFRyYWNrRWxlbWVudExpc3Q7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4uL3V0aWxzL2Jyb3dzZXIuanMiOjEyNSwiZ2xvYmFsL2RvY3VtZW50IjoxfV0sMTE3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9Cgp2YXIgX3V0aWxzQnJvd3NlckpzID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpOwoKdmFyIGJyb3dzZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNCcm93c2VySnMpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgX2V2ZW50VGFyZ2V0ID0gX2RlcmVxXygnLi4vZXZlbnQtdGFyZ2V0Jyk7Cgp2YXIgX2V2ZW50VGFyZ2V0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50VGFyZ2V0KTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrID0gX2RlcmVxXygnLi4vdHJhY2tzL3RleHQtdHJhY2snKTsKCnZhciBfdHJhY2tzVGV4dFRyYWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYWNrc1RleHRUcmFjayk7Cgp2YXIgTk9ORSA9IDA7CnZhciBMT0FESU5HID0gMTsKdmFyIExPQURFRCA9IDI7CnZhciBFUlJPUiA9IDM7CgovKioKICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZW1iZWRkZWQtY29udGVudC5odG1sI2h0bWx0cmFja2VsZW1lbnQKICoKICogaW50ZXJmYWNlIEhUTUxUcmFja0VsZW1lbnQgOiBIVE1MRWxlbWVudCB7CiAqICAgYXR0cmlidXRlIERPTVN0cmluZyBraW5kOwogKiAgIGF0dHJpYnV0ZSBET01TdHJpbmcgc3JjOwogKiAgIGF0dHJpYnV0ZSBET01TdHJpbmcgc3JjbGFuZzsKICogICBhdHRyaWJ1dGUgRE9NU3RyaW5nIGxhYmVsOwogKiAgIGF0dHJpYnV0ZSBib29sZWFuIGRlZmF1bHQ7CiAqCiAqICAgY29uc3QgdW5zaWduZWQgc2hvcnQgTk9ORSA9IDA7CiAqICAgY29uc3QgdW5zaWduZWQgc2hvcnQgTE9BRElORyA9IDE7CiAqICAgY29uc3QgdW5zaWduZWQgc2hvcnQgTE9BREVEID0gMjsKICogICBjb25zdCB1bnNpZ25lZCBzaG9ydCBFUlJPUiA9IDM7CiAqICAgcmVhZG9ubHkgYXR0cmlidXRlIHVuc2lnbmVkIHNob3J0IHJlYWR5U3RhdGU7CiAqCiAqICAgcmVhZG9ubHkgYXR0cmlidXRlIFRleHRUcmFjayB0cmFjazsKICogfTsKICoKICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgVGV4dFRyYWNrIGNvbmZpZ3VyYXRpb24KICogQGNsYXNzIEhUTUxUcmFja0VsZW1lbnQKICovCgp2YXIgSFRNTFRyYWNrRWxlbWVudCA9IChmdW5jdGlvbiAoX0V2ZW50VGFyZ2V0KSB7CiAgX2luaGVyaXRzKEhUTUxUcmFja0VsZW1lbnQsIF9FdmVudFRhcmdldCk7CgogIGZ1bmN0aW9uIEhUTUxUcmFja0VsZW1lbnQoKSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBIVE1MVHJhY2tFbGVtZW50KTsKCiAgICBfRXZlbnRUYXJnZXQuY2FsbCh0aGlzKTsKCiAgICB2YXIgcmVhZHlTdGF0ZSA9IHVuZGVmaW5lZCwKICAgICAgICB0cmFja0VsZW1lbnQgPSB0aGlzOwoKICAgIGlmIChicm93c2VyLklTX0lFOCkgewogICAgICB0cmFja0VsZW1lbnQgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgnY3VzdG9tJyk7CgogICAgICBmb3IgKHZhciBwcm9wIGluIEhUTUxUcmFja0VsZW1lbnQucHJvdG90eXBlKSB7CiAgICAgICAgaWYgKHByb3AgIT09ICdjb25zdHJ1Y3RvcicpIHsKICAgICAgICAgIHRyYWNrRWxlbWVudFtwcm9wXSA9IEhUTUxUcmFja0VsZW1lbnQucHJvdG90eXBlW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciB0cmFjayA9IG5ldyBfdHJhY2tzVGV4dFRyYWNrMlsnZGVmYXVsdCddKG9wdGlvbnMpOwoKICAgIHRyYWNrRWxlbWVudC5raW5kID0gdHJhY2sua2luZDsKICAgIHRyYWNrRWxlbWVudC5zcmMgPSB0cmFjay5zcmM7CiAgICB0cmFja0VsZW1lbnQuc3JjbGFuZyA9IHRyYWNrLmxhbmd1YWdlOwogICAgdHJhY2tFbGVtZW50LmxhYmVsID0gdHJhY2subGFiZWw7CiAgICB0cmFja0VsZW1lbnRbJ2RlZmF1bHQnXSA9IHRyYWNrWydkZWZhdWx0J107CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRyYWNrRWxlbWVudCwgJ3JlYWR5U3RhdGUnLCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiByZWFkeVN0YXRlOwogICAgICB9CiAgICB9KTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHJhY2tFbGVtZW50LCAndHJhY2snLCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0cmFjazsKICAgICAgfQogICAgfSk7CgogICAgcmVhZHlTdGF0ZSA9IE5PTkU7CgogICAgdHJhY2suYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkZGF0YScsIGZ1bmN0aW9uICgpIHsKICAgICAgcmVhZHlTdGF0ZSA9IExPQURFRDsKCiAgICAgIHRyYWNrRWxlbWVudC50cmlnZ2VyKHsKICAgICAgICB0eXBlOiAnbG9hZCcsCiAgICAgICAgdGFyZ2V0OiB0cmFja0VsZW1lbnQKICAgICAgfSk7CiAgICB9KTsKCiAgICBpZiAoYnJvd3Nlci5JU19JRTgpIHsKICAgICAgcmV0dXJuIHRyYWNrRWxlbWVudDsKICAgIH0KICB9CgogIHJldHVybiBIVE1MVHJhY2tFbGVtZW50Owp9KShfZXZlbnRUYXJnZXQyWydkZWZhdWx0J10pOwoKSFRNTFRyYWNrRWxlbWVudC5wcm90b3R5cGUuYWxsb3dlZEV2ZW50c18gPSB7CiAgbG9hZDogJ2xvYWQnCn07CgpIVE1MVHJhY2tFbGVtZW50Lk5PTkUgPSBOT05FOwpIVE1MVHJhY2tFbGVtZW50LkxPQURJTkcgPSBMT0FESU5HOwpIVE1MVHJhY2tFbGVtZW50LkxPQURFRCA9IExPQURFRDsKSFRNTFRyYWNrRWxlbWVudC5FUlJPUiA9IEVSUk9SOwoKZXhwb3J0c1snZGVmYXVsdCddID0gSFRNTFRyYWNrRWxlbWVudDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vZXZlbnQtdGFyZ2V0Ijo5NywiLi4vdHJhY2tzL3RleHQtdHJhY2siOjEyNCwiLi4vdXRpbHMvYnJvd3Nlci5qcyI6MTI1LCJnbG9iYWwvZG9jdW1lbnQiOjF9XSwxMTg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgdGV4dC10cmFjay1jdWUtbGlzdC5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmpbJ2RlZmF1bHQnXSA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9Cgp2YXIgX3V0aWxzQnJvd3NlckpzID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpOwoKdmFyIGJyb3dzZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNCcm93c2VySnMpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7CgovKgogKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9lbWJlZGRlZC1jb250ZW50Lmh0bWwjdGV4dHRyYWNrY3VlbGlzdAogKgogKiBpbnRlcmZhY2UgVGV4dFRyYWNrQ3VlTGlzdCB7CiAqICAgcmVhZG9ubHkgYXR0cmlidXRlIHVuc2lnbmVkIGxvbmcgbGVuZ3RoOwogKiAgIGdldHRlciBUZXh0VHJhY2tDdWUgKHVuc2lnbmVkIGxvbmcgaW5kZXgpOwogKiAgIFRleHRUcmFja0N1ZT8gZ2V0Q3VlQnlJZChET01TdHJpbmcgaWQpOwogKiB9OwogKi8KCnZhciBUZXh0VHJhY2tDdWVMaXN0ID0gZnVuY3Rpb24gVGV4dFRyYWNrQ3VlTGlzdChjdWVzKSB7CiAgdmFyIGxpc3QgPSB0aGlzOwoKICBpZiAoYnJvd3Nlci5JU19JRTgpIHsKICAgIGxpc3QgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgnY3VzdG9tJyk7CgogICAgZm9yICh2YXIgcHJvcCBpbiBUZXh0VHJhY2tDdWVMaXN0LnByb3RvdHlwZSkgewogICAgICBpZiAocHJvcCAhPT0gJ2NvbnN0cnVjdG9yJykgewogICAgICAgIGxpc3RbcHJvcF0gPSBUZXh0VHJhY2tDdWVMaXN0LnByb3RvdHlwZVtwcm9wXTsKICAgICAgfQogICAgfQogIH0KCiAgVGV4dFRyYWNrQ3VlTGlzdC5wcm90b3R5cGUuc2V0Q3Vlc18uY2FsbChsaXN0LCBjdWVzKTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGxpc3QsICdsZW5ndGgnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoXzsKICAgIH0KICB9KTsKCiAgaWYgKGJyb3dzZXIuSVNfSUU4KSB7CiAgICByZXR1cm4gbGlzdDsKICB9Cn07CgpUZXh0VHJhY2tDdWVMaXN0LnByb3RvdHlwZS5zZXRDdWVzXyA9IGZ1bmN0aW9uIChjdWVzKSB7CiAgdmFyIG9sZExlbmd0aCA9IHRoaXMubGVuZ3RoIHx8IDA7CiAgdmFyIGkgPSAwOwogIHZhciBsID0gY3Vlcy5sZW5ndGg7CgogIHRoaXMuY3Vlc18gPSBjdWVzOwogIHRoaXMubGVuZ3RoXyA9IGN1ZXMubGVuZ3RoOwoKICB2YXIgZGVmaW5lUHJvcCA9IGZ1bmN0aW9uIGRlZmluZVByb3AoaSkgewogICAgaWYgKCEoJycgKyBpIGluIHRoaXMpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnJyArIGksIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmN1ZXNfW2ldOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfTsKCiAgaWYgKG9sZExlbmd0aCA8IGwpIHsKICAgIGkgPSBvbGRMZW5ndGg7CgogICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgZGVmaW5lUHJvcC5jYWxsKHRoaXMsIGkpOwogICAgfQogIH0KfTsKClRleHRUcmFja0N1ZUxpc3QucHJvdG90eXBlLmdldEN1ZUJ5SWQgPSBmdW5jdGlvbiAoaWQpIHsKICB2YXIgcmVzdWx0ID0gbnVsbDsKICBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICB2YXIgY3VlID0gdGhpc1tpXTsKICAgIGlmIChjdWUuaWQgPT09IGlkKSB7CiAgICAgIHJlc3VsdCA9IGN1ZTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzdWx0Owp9OwoKZXhwb3J0c1snZGVmYXVsdCddID0gVGV4dFRyYWNrQ3VlTGlzdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vdXRpbHMvYnJvd3Nlci5qcyI6MTI1LCJnbG9iYWwvZG9jdW1lbnQiOjF9XSwxMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgdGV4dC10cmFjay1kaXNwbGF5LmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50ID0gX2RlcmVxXygnLi4vY29tcG9uZW50Jyk7Cgp2YXIgX2NvbXBvbmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnQpOwoKdmFyIF9tZW51TWVudUpzID0gX2RlcmVxXygnLi4vbWVudS9tZW51LmpzJyk7Cgp2YXIgX21lbnVNZW51SnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVudU1lbnVKcyk7Cgp2YXIgX21lbnVNZW51SXRlbUpzID0gX2RlcmVxXygnLi4vbWVudS9tZW51LWl0ZW0uanMnKTsKCnZhciBfbWVudU1lbnVJdGVtSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVudU1lbnVJdGVtSnMpOwoKdmFyIF9tZW51TWVudUJ1dHRvbkpzID0gX2RlcmVxXygnLi4vbWVudS9tZW51LWJ1dHRvbi5qcycpOwoKdmFyIF9tZW51TWVudUJ1dHRvbkpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lbnVNZW51QnV0dG9uSnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCnZhciBfZ2xvYmFsV2luZG93ID0gX2RlcmVxXygnZ2xvYmFsL3dpbmRvdycpOwoKdmFyIF9nbG9iYWxXaW5kb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsV2luZG93KTsKCnZhciBkYXJrR3JheSA9ICcjMjIyJzsKdmFyIGxpZ2h0R3JheSA9ICcjY2NjJzsKdmFyIGZvbnRNYXAgPSB7CiAgbW9ub3NwYWNlOiAnbW9ub3NwYWNlJywKICBzYW5zU2VyaWY6ICdzYW5zLXNlcmlmJywKICBzZXJpZjogJ3NlcmlmJywKICBtb25vc3BhY2VTYW5zU2VyaWY6ICciQW5kYWxlIE1vbm8iLCAiTHVjaWRhIENvbnNvbGUiLCBtb25vc3BhY2UnLAogIG1vbm9zcGFjZVNlcmlmOiAnIkNvdXJpZXIgTmV3IiwgbW9ub3NwYWNlJywKICBwcm9wb3J0aW9uYWxTYW5zU2VyaWY6ICdzYW5zLXNlcmlmJywKICBwcm9wb3J0aW9uYWxTZXJpZjogJ3NlcmlmJywKICBjYXN1YWw6ICciQ29taWMgU2FucyBNUyIsIEltcGFjdCwgZmFudGFzeScsCiAgc2NyaXB0OiAnIk1vbm90eXBlIENvcnNpdmEiLCBjdXJzaXZlJywKICBzbWFsbGNhcHM6ICciQW5kYWxlIE1vbm8iLCAiTHVjaWRhIENvbnNvbGUiLCBtb25vc3BhY2UsIHNhbnMtc2VyaWYnCn07CgovKioKICogVGhlIGNvbXBvbmVudCBmb3IgZGlzcGxheWluZyB0ZXh0IHRyYWNrIGN1ZXMKICoKICogQHBhcmFtIHtPYmplY3R9IHBsYXllciAgTWFpbiBQbGF5ZXIKICogQHBhcmFtIHtPYmplY3Q9fSBvcHRpb25zIE9iamVjdCBvZiBvcHRpb24gbmFtZXMgYW5kIHZhbHVlcwogKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcmVhZHkgICAgUmVhZHkgY2FsbGJhY2sgZnVuY3Rpb24KICogQGV4dGVuZHMgQ29tcG9uZW50CiAqIEBjbGFzcyBUZXh0VHJhY2tEaXNwbGF5CiAqLwoKdmFyIFRleHRUcmFja0Rpc3BsYXkgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoVGV4dFRyYWNrRGlzcGxheSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFRleHRUcmFja0Rpc3BsYXkocGxheWVyLCBvcHRpb25zLCByZWFkeSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRleHRUcmFja0Rpc3BsYXkpOwoKICAgIF9Db21wb25lbnQuY2FsbCh0aGlzLCBwbGF5ZXIsIG9wdGlvbnMsIHJlYWR5KTsKCiAgICBwbGF5ZXIub24oJ2xvYWRzdGFydCcsIEZuLmJpbmQodGhpcywgdGhpcy50b2dnbGVEaXNwbGF5KSk7CiAgICBwbGF5ZXIub24oJ3RleHR0cmFja2NoYW5nZScsIEZuLmJpbmQodGhpcywgdGhpcy51cGRhdGVEaXNwbGF5KSk7CgogICAgLy8gVGhpcyB1c2VkIHRvIGJlIGNhbGxlZCBkdXJpbmcgcGxheWVyIGluaXQsIGJ1dCB3YXMgY2F1c2luZyBhbiBlcnJvcgogICAgLy8gaWYgYSB0cmFjayBzaG91bGQgc2hvdyBieSBkZWZhdWx0IGFuZCB0aGUgZGlzcGxheSBoYWRuJ3QgbG9hZGVkIHlldC4KICAgIC8vIFNob3VsZCBwcm9iYWJseSBiZSBtb3ZlZCB0byBhbiBleHRlcm5hbCB0cmFjayBsb2FkZXIgd2hlbiB3ZSBzdXBwb3J0CiAgICAvLyB0cmFja3MgdGhhdCBkb24ndCBuZWVkIGEgZGlzcGxheS4KICAgIHBsYXllci5yZWFkeShGbi5iaW5kKHRoaXMsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHBsYXllci50ZWNoXyAmJiBwbGF5ZXIudGVjaF9bJ2ZlYXR1cmVzTmF0aXZlVGV4dFRyYWNrcyddKSB7CiAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBwbGF5ZXIub24oJ2Z1bGxzY3JlZW5jaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlRGlzcGxheSkpOwoKICAgICAgdmFyIHRyYWNrcyA9IHRoaXMub3B0aW9uc18ucGxheWVyT3B0aW9uc1sndHJhY2tzJ10gfHwgW107CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHJhY2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW2ldOwogICAgICAgIHRoaXMucGxheWVyXy5hZGRSZW1vdGVUZXh0VHJhY2sodHJhY2spOwogICAgICB9CiAgICB9KSk7CiAgfQoKICAvKioKICAqIEFkZCBjdWUgSFRNTCB0byBkaXNwbGF5CiAgKgogICogQHBhcmFtIHtOdW1iZXJ9IGNvbG9yIEhleCBudW1iZXIgZm9yIGNvbG9yLCBsaWtlICNmMGUKICAqIEBwYXJhbSB7TnVtYmVyfSBvcGFjaXR5IFZhbHVlIGZvciBvcGFjaXR5LDAuMCAtIDEuMAogICogQHJldHVybiB7UkdCQUNvbG9yfSBJbiB0aGUgZm9ybSAncmdiYSgyNTUsIDAsIDAsIDAuMyknCiAgKiBAbWV0aG9kIGNvbnN0cnVjdENvbG9yCiAgKi8KCiAgLyoqCiAgICogVG9nZ2xlIGRpc3BsYXkgdGV4dHRyYWNrcwogICAqCiAgICogQG1ldGhvZCB0b2dnbGVEaXNwbGF5CiAgICovCgogIFRleHRUcmFja0Rpc3BsYXkucHJvdG90eXBlLnRvZ2dsZURpc3BsYXkgPSBmdW5jdGlvbiB0b2dnbGVEaXNwbGF5KCkgewogICAgaWYgKHRoaXMucGxheWVyXy50ZWNoXyAmJiB0aGlzLnBsYXllcl8udGVjaF9bJ2ZlYXR1cmVzTmF0aXZlVGV4dFRyYWNrcyddKSB7CiAgICAgIHRoaXMuaGlkZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zaG93KCk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQ3JlYXRlIHRoZSBjb21wb25lbnQncyBET00gZWxlbWVudAogICAqCiAgICogQHJldHVybiB7RWxlbWVudH0KICAgKiBAbWV0aG9kIGNyZWF0ZUVsCiAgICovCgogIFRleHRUcmFja0Rpc3BsYXkucHJvdG90eXBlLmNyZWF0ZUVsID0gZnVuY3Rpb24gY3JlYXRlRWwoKSB7CiAgICByZXR1cm4gX0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRWwuY2FsbCh0aGlzLCAnZGl2JywgewogICAgICBjbGFzc05hbWU6ICd2anMtdGV4dC10cmFjay1kaXNwbGF5JwogICAgfSk7CiAgfTsKCiAgLyoqCiAgICogQ2xlYXIgZGlzcGxheSB0ZXh0dHJhY2tzCiAgICoKICAgKiBAbWV0aG9kIGNsZWFyRGlzcGxheQogICAqLwoKICBUZXh0VHJhY2tEaXNwbGF5LnByb3RvdHlwZS5jbGVhckRpc3BsYXkgPSBmdW5jdGlvbiBjbGVhckRpc3BsYXkoKSB7CiAgICBpZiAodHlwZW9mIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J11bJ1dlYlZUVCddID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J11bJ1dlYlZUVCddWydwcm9jZXNzQ3VlcyddKF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10sIFtdLCB0aGlzLmVsXyk7CiAgICB9CiAgfTsKCiAgLyoqCiAgICogVXBkYXRlIGRpc3BsYXkgdGV4dHRyYWNrcwogICAqCiAgICogQG1ldGhvZCB1cGRhdGVEaXNwbGF5CiAgICovCgogIFRleHRUcmFja0Rpc3BsYXkucHJvdG90eXBlLnVwZGF0ZURpc3BsYXkgPSBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkgewogICAgdmFyIHRyYWNrcyA9IHRoaXMucGxheWVyXy50ZXh0VHJhY2tzKCk7CgogICAgdGhpcy5jbGVhckRpc3BsYXkoKTsKCiAgICBpZiAoIXRyYWNrcykgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW2ldOwogICAgICBpZiAodHJhY2tbJ21vZGUnXSA9PT0gJ3Nob3dpbmcnKSB7CiAgICAgICAgdGhpcy51cGRhdGVGb3JUcmFjayh0cmFjayk7CiAgICAgIH0KICAgIH0KICB9OwoKICAvKioKICAgKiBBZGQgdGV4dHRyYWNrIHRvIHRleHR0cmFjayBsaXN0CiAgICoKICAgKiBAcGFyYW0ge1RleHRUcmFja09iamVjdH0gdHJhY2sgVGV4dHRyYWNrIG9iamVjdCB0byBiZSBhZGRlZCB0byBsaXN0CiAgICogQG1ldGhvZCB1cGRhdGVGb3JUcmFjawogICAqLwoKICBUZXh0VHJhY2tEaXNwbGF5LnByb3RvdHlwZS51cGRhdGVGb3JUcmFjayA9IGZ1bmN0aW9uIHVwZGF0ZUZvclRyYWNrKHRyYWNrKSB7CiAgICBpZiAodHlwZW9mIF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J11bJ1dlYlZUVCddICE9PSAnZnVuY3Rpb24nIHx8ICF0cmFja1snYWN0aXZlQ3VlcyddKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgb3ZlcnJpZGVzID0gdGhpcy5wbGF5ZXJfWyd0ZXh0VHJhY2tTZXR0aW5ncyddLmdldFZhbHVlcygpOwoKICAgIHZhciBjdWVzID0gW107CiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdHJhY2tbJ2FjdGl2ZUN1ZXMnXS5sZW5ndGg7IF9pKyspIHsKICAgICAgY3Vlcy5wdXNoKHRyYWNrWydhY3RpdmVDdWVzJ11bX2ldKTsKICAgIH0KCiAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddWydXZWJWVFQnXVsncHJvY2Vzc0N1ZXMnXShfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLCB0cmFja1snYWN0aXZlQ3VlcyddLCB0aGlzLmVsXyk7CgogICAgdmFyIGkgPSBjdWVzLmxlbmd0aDsKICAgIHdoaWxlIChpLS0pIHsKICAgICAgdmFyIGN1ZSA9IGN1ZXNbaV07CiAgICAgIGlmICghY3VlKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBjdWVEaXYgPSBjdWUuZGlzcGxheVN0YXRlOwogICAgICBpZiAob3ZlcnJpZGVzLmNvbG9yKSB7CiAgICAgICAgY3VlRGl2LmZpcnN0Q2hpbGQuc3R5bGUuY29sb3IgPSBvdmVycmlkZXMuY29sb3I7CiAgICAgIH0KICAgICAgaWYgKG92ZXJyaWRlcy50ZXh0T3BhY2l0eSkgewogICAgICAgIHRyeVVwZGF0ZVN0eWxlKGN1ZURpdi5maXJzdENoaWxkLCAnY29sb3InLCBjb25zdHJ1Y3RDb2xvcihvdmVycmlkZXMuY29sb3IgfHwgJyNmZmYnLCBvdmVycmlkZXMudGV4dE9wYWNpdHkpKTsKICAgICAgfQogICAgICBpZiAob3ZlcnJpZGVzLmJhY2tncm91bmRDb2xvcikgewogICAgICAgIGN1ZURpdi5maXJzdENoaWxkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IG92ZXJyaWRlcy5iYWNrZ3JvdW5kQ29sb3I7CiAgICAgIH0KICAgICAgaWYgKG92ZXJyaWRlcy5iYWNrZ3JvdW5kT3BhY2l0eSkgewogICAgICAgIHRyeVVwZGF0ZVN0eWxlKGN1ZURpdi5maXJzdENoaWxkLCAnYmFja2dyb3VuZENvbG9yJywgY29uc3RydWN0Q29sb3Iob3ZlcnJpZGVzLmJhY2tncm91bmRDb2xvciB8fCAnIzAwMCcsIG92ZXJyaWRlcy5iYWNrZ3JvdW5kT3BhY2l0eSkpOwogICAgICB9CiAgICAgIGlmIChvdmVycmlkZXMud2luZG93Q29sb3IpIHsKICAgICAgICBpZiAob3ZlcnJpZGVzLndpbmRvd09wYWNpdHkpIHsKICAgICAgICAgIHRyeVVwZGF0ZVN0eWxlKGN1ZURpdiwgJ2JhY2tncm91bmRDb2xvcicsIGNvbnN0cnVjdENvbG9yKG92ZXJyaWRlcy53aW5kb3dDb2xvciwgb3ZlcnJpZGVzLndpbmRvd09wYWNpdHkpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3VlRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IG92ZXJyaWRlcy53aW5kb3dDb2xvcjsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG92ZXJyaWRlcy5lZGdlU3R5bGUpIHsKICAgICAgICBpZiAob3ZlcnJpZGVzLmVkZ2VTdHlsZSA9PT0gJ2Ryb3BzaGFkb3cnKSB7CiAgICAgICAgICBjdWVEaXYuZmlyc3RDaGlsZC5zdHlsZS50ZXh0U2hhZG93ID0gJzJweCAycHggM3B4ICcgKyBkYXJrR3JheSArICcsIDJweCAycHggNHB4ICcgKyBkYXJrR3JheSArICcsIDJweCAycHggNXB4ICcgKyBkYXJrR3JheTsKICAgICAgICB9IGVsc2UgaWYgKG92ZXJyaWRlcy5lZGdlU3R5bGUgPT09ICdyYWlzZWQnKSB7CiAgICAgICAgICBjdWVEaXYuZmlyc3RDaGlsZC5zdHlsZS50ZXh0U2hhZG93ID0gJzFweCAxcHggJyArIGRhcmtHcmF5ICsgJywgMnB4IDJweCAnICsgZGFya0dyYXkgKyAnLCAzcHggM3B4ICcgKyBkYXJrR3JheTsKICAgICAgICB9IGVsc2UgaWYgKG92ZXJyaWRlcy5lZGdlU3R5bGUgPT09ICdkZXByZXNzZWQnKSB7CiAgICAgICAgICBjdWVEaXYuZmlyc3RDaGlsZC5zdHlsZS50ZXh0U2hhZG93ID0gJzFweCAxcHggJyArIGxpZ2h0R3JheSArICcsIDAgMXB4ICcgKyBsaWdodEdyYXkgKyAnLCAtMXB4IC0xcHggJyArIGRhcmtHcmF5ICsgJywgMCAtMXB4ICcgKyBkYXJrR3JheTsKICAgICAgICB9IGVsc2UgaWYgKG92ZXJyaWRlcy5lZGdlU3R5bGUgPT09ICd1bmlmb3JtJykgewogICAgICAgICAgY3VlRGl2LmZpcnN0Q2hpbGQuc3R5bGUudGV4dFNoYWRvdyA9ICcwIDAgNHB4ICcgKyBkYXJrR3JheSArICcsIDAgMCA0cHggJyArIGRhcmtHcmF5ICsgJywgMCAwIDRweCAnICsgZGFya0dyYXkgKyAnLCAwIDAgNHB4ICcgKyBkYXJrR3JheTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG92ZXJyaWRlcy5mb250UGVyY2VudCAmJiBvdmVycmlkZXMuZm9udFBlcmNlbnQgIT09IDEpIHsKICAgICAgICB2YXIgZm9udFNpemUgPSBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnBhcnNlRmxvYXQoY3VlRGl2LnN0eWxlLmZvbnRTaXplKTsKICAgICAgICBjdWVEaXYuc3R5bGUuZm9udFNpemUgPSBmb250U2l6ZSAqIG92ZXJyaWRlcy5mb250UGVyY2VudCArICdweCc7CiAgICAgICAgY3VlRGl2LnN0eWxlLmhlaWdodCA9ICdhdXRvJzsKICAgICAgICBjdWVEaXYuc3R5bGUudG9wID0gJ2F1dG8nOwogICAgICAgIGN1ZURpdi5zdHlsZS5ib3R0b20gPSAnMnB4JzsKICAgICAgfQogICAgICBpZiAob3ZlcnJpZGVzLmZvbnRGYW1pbHkgJiYgb3ZlcnJpZGVzLmZvbnRGYW1pbHkgIT09ICdkZWZhdWx0JykgewogICAgICAgIGlmIChvdmVycmlkZXMuZm9udEZhbWlseSA9PT0gJ3NtYWxsLWNhcHMnKSB7CiAgICAgICAgICBjdWVEaXYuZmlyc3RDaGlsZC5zdHlsZS5mb250VmFyaWFudCA9ICdzbWFsbC1jYXBzJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3VlRGl2LmZpcnN0Q2hpbGQuc3R5bGUuZm9udEZhbWlseSA9IGZvbnRNYXBbb3ZlcnJpZGVzLmZvbnRGYW1pbHldOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIHJldHVybiBUZXh0VHJhY2tEaXNwbGF5Owp9KShfY29tcG9uZW50MlsnZGVmYXVsdCddKTsKCmZ1bmN0aW9uIGNvbnN0cnVjdENvbG9yKGNvbG9yLCBvcGFjaXR5KSB7CiAgcmV0dXJuICdyZ2JhKCcgKwogIC8vIGNvbG9yIGxvb2tzIGxpa2UgIiNmMGUiCiAgcGFyc2VJbnQoY29sb3JbMV0gKyBjb2xvclsxXSwgMTYpICsgJywnICsgcGFyc2VJbnQoY29sb3JbMl0gKyBjb2xvclsyXSwgMTYpICsgJywnICsgcGFyc2VJbnQoY29sb3JbM10gKyBjb2xvclszXSwgMTYpICsgJywnICsgb3BhY2l0eSArICcpJzsKfQoKLyoqCiAqIFRyeSB0byB1cGRhdGUgc3R5bGUKICogU29tZSBzdHlsZSBjaGFuZ2VzIHdpbGwgdGhyb3cgYW4gZXJyb3IsIHBhcnRpY3VsYXJseSBpbiBJRTguIFRob3NlIHNob3VsZCBiZSBub29wcy4KICoKICogQHBhcmFtIHtFbGVtZW50fSBlbCBUaGUgZWxlbWVudCB0byBiZSBzdHlsZXMKICogQHBhcmFtIHtDU1NQcm9wZXJ0eX0gc3R5bGUgVGhlIENTUyBwcm9wZXJ0eSB0byBiZSBzdHlsZWQKICogQHBhcmFtIHtDU1NTdHlsZX0gcnVsZSBUaGUgYWN0dWFsIHN0eWxlIHRvIGJlIGFwcGxpZWQgdG8gdGhlIHByb3BlcnR5CiAqIEBtZXRob2QgdHJ5VXBkYXRlU3R5bGUKICovCmZ1bmN0aW9uIHRyeVVwZGF0ZVN0eWxlKGVsLCBzdHlsZSwgcnVsZSkgewogIC8vCiAgdHJ5IHsKICAgIGVsLnN0eWxlW3N0eWxlXSA9IHJ1bGU7CiAgfSBjYXRjaCAoZSkge30KfQoKX2NvbXBvbmVudDJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnVGV4dFRyYWNrRGlzcGxheScsIFRleHRUcmFja0Rpc3BsYXkpOwpleHBvcnRzWydkZWZhdWx0J10gPSBUZXh0VHJhY2tEaXNwbGF5Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9jb21wb25lbnQiOjY1LCIuLi9tZW51L21lbnUtYnV0dG9uLmpzIjoxMDIsIi4uL21lbnUvbWVudS1pdGVtLmpzIjoxMDMsIi4uL21lbnUvbWVudS5qcyI6MTA0LCIuLi91dGlscy9mbi5qcyI6MTMwLCJnbG9iYWwvZG9jdW1lbnQiOjEsImdsb2JhbC93aW5kb3ciOjJ9XSwxMjA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgdGV4dC10cmFjay1lbnVtcy5qcwogKgogKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9lbWJlZGRlZC1jb250ZW50Lmh0bWwjdGV4dHRyYWNrbW9kZQogKgogKiBlbnVtIFRleHRUcmFja01vZGUgeyAiZGlzYWJsZWQiLCAgImhpZGRlbiIsICAic2hvd2luZyIgfTsKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CnZhciBUZXh0VHJhY2tNb2RlID0gewogICdkaXNhYmxlZCc6ICdkaXNhYmxlZCcsCiAgJ2hpZGRlbic6ICdoaWRkZW4nLAogICdzaG93aW5nJzogJ3Nob3dpbmcnCn07CgovKgogKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9lbWJlZGRlZC1jb250ZW50Lmh0bWwjdGV4dHRyYWNra2luZAogKgogKiBlbnVtIFRleHRUcmFja0tpbmQgeyAic3VidGl0bGVzIiwgICJjYXB0aW9ucyIsICAiZGVzY3JpcHRpb25zIiwgICJjaGFwdGVycyIsICAibWV0YWRhdGEiIH07CiAqLwp2YXIgVGV4dFRyYWNrS2luZCA9IHsKICAnc3VidGl0bGVzJzogJ3N1YnRpdGxlcycsCiAgJ2NhcHRpb25zJzogJ2NhcHRpb25zJywKICAnZGVzY3JpcHRpb25zJzogJ2Rlc2NyaXB0aW9ucycsCiAgJ2NoYXB0ZXJzJzogJ2NoYXB0ZXJzJywKICAnbWV0YWRhdGEnOiAnbWV0YWRhdGEnCn07CgpleHBvcnRzLlRleHRUcmFja01vZGUgPSBUZXh0VHJhY2tNb2RlOwpleHBvcnRzLlRleHRUcmFja0tpbmQgPSBUZXh0VHJhY2tLaW5kOwoKfSx7fV0sMTIxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIFV0aWxpdGllcyBmb3IgY2FwdHVyaW5nIHRleHQgdHJhY2sgc3RhdGUgYW5kIHJlLWNyZWF0aW5nIHRyYWNrcwogKiBiYXNlZCBvbiBhIGNhcHR1cmUuCiAqCiAqIEBmaWxlIHRleHQtdHJhY2stbGlzdC1jb252ZXJ0ZXIuanMKICovCgovKioKICogRXhhbWluZSBhIHNpbmdsZSB0ZXh0IHRyYWNrIGFuZCByZXR1cm4gYSBKU09OLWNvbXBhdGlibGUgamF2YXNjcmlwdAogKiBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSB0ZXh0IHRyYWNrJ3Mgc3RhdGUuCiAqIEBwYXJhbSB0cmFjayB7VGV4dFRyYWNrT2JqZWN0fSB0aGUgdGV4dCB0cmFjayB0byBxdWVyeQogKiBAcmV0dXJuIHtPYmplY3R9IGEgc2VyaWFsaXphYmxlIGphdmFzY3JpcHQgcmVwcmVzZW50YXRpb24gb2YgdGhlCiAqIEBwcml2YXRlCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwp2YXIgdHJhY2tUb0pzb25fID0gZnVuY3Rpb24gdHJhY2tUb0pzb25fKHRyYWNrKSB7CiAgdmFyIHJldCA9IFsna2luZCcsICdsYWJlbCcsICdsYW5ndWFnZScsICdpZCcsICdpbkJhbmRNZXRhZGF0YVRyYWNrRGlzcGF0Y2hUeXBlJywgJ21vZGUnLCAnc3JjJ10ucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHByb3AsIGkpIHsKICAgIGlmICh0cmFja1twcm9wXSkgewogICAgICBhY2NbcHJvcF0gPSB0cmFja1twcm9wXTsKICAgIH0KCiAgICByZXR1cm4gYWNjOwogIH0sIHsKICAgIGN1ZXM6IHRyYWNrLmN1ZXMgJiYgQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKHRyYWNrLmN1ZXMsIGZ1bmN0aW9uIChjdWUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGFydFRpbWU6IGN1ZS5zdGFydFRpbWUsCiAgICAgICAgZW5kVGltZTogY3VlLmVuZFRpbWUsCiAgICAgICAgdGV4dDogY3VlLnRleHQsCiAgICAgICAgaWQ6IGN1ZS5pZAogICAgICB9OwogICAgfSkKICB9KTsKCiAgcmV0dXJuIHJldDsKfTsKCi8qKgogKiBFeGFtaW5lIGEgdGVjaCBhbmQgcmV0dXJuIGEgSlNPTi1jb21wYXRpYmxlIGphdmFzY3JpcHQgYXJyYXkgdGhhdAogKiByZXByZXNlbnRzIHRoZSBzdGF0ZSBvZiBhbGwgdGV4dCB0cmFja3MgY3VycmVudGx5IGNvbmZpZ3VyZWQuIFRoZQogKiByZXR1cm4gYXJyYXkgaXMgY29tcGF0aWJsZSB3aXRoIGBqc29uVG9UZXh0VHJhY2tzYC4KICogQHBhcmFtIHRlY2gge3RlY2h9IHRoZSB0ZWNoIG9iamVjdCB0byBxdWVyeQogKiBAcmV0dXJuIHtBcnJheX0gYSBzZXJpYWxpemFibGUgamF2YXNjcmlwdCByZXByZXNlbnRhdGlvbiBvZiB0aGUKICogQGZ1bmN0aW9uIHRleHRUcmFja3NUb0pzb24KICovCnZhciB0ZXh0VHJhY2tzVG9Kc29uID0gZnVuY3Rpb24gdGV4dFRyYWNrc1RvSnNvbih0ZWNoKSB7CgogIHZhciB0cmFja0VscyA9IHRlY2guJCQoJ3RyYWNrJyk7CgogIHZhciB0cmFja09ianMgPSBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwodHJhY2tFbHMsIGZ1bmN0aW9uICh0KSB7CiAgICByZXR1cm4gdC50cmFjazsKICB9KTsKICB2YXIgdHJhY2tzID0gQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKHRyYWNrRWxzLCBmdW5jdGlvbiAodHJhY2tFbCkgewogICAgdmFyIGpzb24gPSB0cmFja1RvSnNvbl8odHJhY2tFbC50cmFjayk7CiAgICBpZiAodHJhY2tFbC5zcmMpIHsKICAgICAganNvbi5zcmMgPSB0cmFja0VsLnNyYzsKICAgIH0KICAgIHJldHVybiBqc29uOwogIH0pOwoKICByZXR1cm4gdHJhY2tzLmNvbmNhdChBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwodGVjaC50ZXh0VHJhY2tzKCksIGZ1bmN0aW9uICh0cmFjaykgewogICAgcmV0dXJuIHRyYWNrT2Jqcy5pbmRleE9mKHRyYWNrKSA9PT0gLTE7CiAgfSkubWFwKHRyYWNrVG9Kc29uXykpOwp9OwoKLyoqCiAqIENyZWF0ZXMgYSBzZXQgb2YgcmVtb3RlIHRleHQgdHJhY2tzIG9uIGEgdGVjaCBiYXNlZCBvbiBhbiBhcnJheSBvZgogKiBqYXZhc2NyaXB0IHRleHQgdHJhY2sgcmVwcmVzZW50YXRpb25zLgogKiBAcGFyYW0ganNvbiB7QXJyYXl9IGFuIGFycmF5IG9mIHRleHQgdHJhY2sgcmVwcmVzZW50YXRpb24gb2JqZWN0cywKICogbGlrZSB0aG9zZSB0aGF0IHdvdWxkIGJlIHByb2R1Y2VkIGJ5IGB0ZXh0VHJhY2tzVG9Kc29uYAogKiBAcGFyYW0gdGVjaCB7dGVjaH0gdGhlIHRlY2ggdG8gY3JlYXRlIHRleHQgdHJhY2tzIG9uCiAqIEBmdW5jdGlvbiBqc29uVG9UZXh0VHJhY2tzCiAqLwp2YXIganNvblRvVGV4dFRyYWNrcyA9IGZ1bmN0aW9uIGpzb25Ub1RleHRUcmFja3MoanNvbiwgdGVjaCkgewogIGpzb24uZm9yRWFjaChmdW5jdGlvbiAodHJhY2spIHsKICAgIHZhciBhZGRlZFRyYWNrID0gdGVjaC5hZGRSZW1vdGVUZXh0VHJhY2sodHJhY2spLnRyYWNrOwogICAgaWYgKCF0cmFjay5zcmMgJiYgdHJhY2suY3VlcykgewogICAgICB0cmFjay5jdWVzLmZvckVhY2goZnVuY3Rpb24gKGN1ZSkgewogICAgICAgIHJldHVybiBhZGRlZFRyYWNrLmFkZEN1ZShjdWUpOwogICAgICB9KTsKICAgIH0KICB9KTsKCiAgcmV0dXJuIHRlY2gudGV4dFRyYWNrcygpOwp9OwoKZXhwb3J0c1snZGVmYXVsdCddID0geyB0ZXh0VHJhY2tzVG9Kc29uOiB0ZXh0VHJhY2tzVG9Kc29uLCBqc29uVG9UZXh0VHJhY2tzOiBqc29uVG9UZXh0VHJhY2tzLCB0cmFja1RvSnNvbl86IHRyYWNrVG9Kc29uXyB9Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0se31dLDEyMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSB0ZXh0LXRyYWNrLWxpc3QuanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF9ldmVudFRhcmdldCA9IF9kZXJlcV8oJy4uL2V2ZW50LXRhcmdldCcpOwoKdmFyIF9ldmVudFRhcmdldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudFRhcmdldCk7Cgp2YXIgX3V0aWxzRm5KcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNCcm93c2VySnMgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7Cgp2YXIgYnJvd3NlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0Jyb3dzZXJKcyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCi8qCiAqIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCN0ZXh0dHJhY2tsaXN0CiAqCiAqIGludGVyZmFjZSBUZXh0VHJhY2tMaXN0IDogRXZlbnRUYXJnZXQgewogKiAgIHJlYWRvbmx5IGF0dHJpYnV0ZSB1bnNpZ25lZCBsb25nIGxlbmd0aDsKICogICBnZXR0ZXIgVGV4dFRyYWNrICh1bnNpZ25lZCBsb25nIGluZGV4KTsKICogICBUZXh0VHJhY2s/IGdldFRyYWNrQnlJZChET01TdHJpbmcgaWQpOwogKgogKiAgIGF0dHJpYnV0ZSBFdmVudEhhbmRsZXIgb25jaGFuZ2U7CiAqICAgYXR0cmlidXRlIEV2ZW50SGFuZGxlciBvbmFkZHRyYWNrOwogKiAgIGF0dHJpYnV0ZSBFdmVudEhhbmRsZXIgb25yZW1vdmV0cmFjazsKICogfTsKICovCnZhciBUZXh0VHJhY2tMaXN0ID0gZnVuY3Rpb24gVGV4dFRyYWNrTGlzdCh0cmFja3MpIHsKICB2YXIgbGlzdCA9IHRoaXM7CgogIGlmIChicm93c2VyLklTX0lFOCkgewogICAgbGlzdCA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCdjdXN0b20nKTsKCiAgICBmb3IgKHZhciBwcm9wIGluIFRleHRUcmFja0xpc3QucHJvdG90eXBlKSB7CiAgICAgIGlmIChwcm9wICE9PSAnY29uc3RydWN0b3InKSB7CiAgICAgICAgbGlzdFtwcm9wXSA9IFRleHRUcmFja0xpc3QucHJvdG90eXBlW3Byb3BdOwogICAgICB9CiAgICB9CiAgfQoKICB0cmFja3MgPSB0cmFja3MgfHwgW107CiAgbGlzdC50cmFja3NfID0gW107CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShsaXN0LCAnbGVuZ3RoJywgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYWNrc18ubGVuZ3RoOwogICAgfQogIH0pOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykgewogICAgbGlzdC5hZGRUcmFja18odHJhY2tzW2ldKTsKICB9CgogIGlmIChicm93c2VyLklTX0lFOCkgewogICAgcmV0dXJuIGxpc3Q7CiAgfQp9OwoKVGV4dFRyYWNrTGlzdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKF9ldmVudFRhcmdldDJbJ2RlZmF1bHQnXS5wcm90b3R5cGUpOwpUZXh0VHJhY2tMaXN0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFRleHRUcmFja0xpc3Q7CgovKgogKiBjaGFuZ2UgLSBPbmUgb3IgbW9yZSB0cmFja3MgaW4gdGhlIHRyYWNrIGxpc3QgaGF2ZSBiZWVuIGVuYWJsZWQgb3IgZGlzYWJsZWQuCiAqIGFkZHRyYWNrIC0gQSB0cmFjayBoYXMgYmVlbiBhZGRlZCB0byB0aGUgdHJhY2sgbGlzdC4KICogcmVtb3ZldHJhY2sgLSBBIHRyYWNrIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgdHJhY2sgbGlzdC4KICovClRleHRUcmFja0xpc3QucHJvdG90eXBlLmFsbG93ZWRFdmVudHNfID0gewogICdjaGFuZ2UnOiAnY2hhbmdlJywKICAnYWRkdHJhY2snOiAnYWRkdHJhY2snLAogICdyZW1vdmV0cmFjayc6ICdyZW1vdmV0cmFjaycKfTsKCi8vIGVtdWxhdGUgYXR0cmlidXRlIEV2ZW50SGFuZGxlciBzdXBwb3J0IHRvIGFsbG93IGZvciBmZWF0dXJlIGRldGVjdGlvbgpmb3IgKHZhciBfZXZlbnQgaW4gVGV4dFRyYWNrTGlzdC5wcm90b3R5cGUuYWxsb3dlZEV2ZW50c18pIHsKICBUZXh0VHJhY2tMaXN0LnByb3RvdHlwZVsnb24nICsgX2V2ZW50XSA9IG51bGw7Cn0KCi8qKgogKiBBZGQgVGV4dFRyYWNrIGZyb20gVGV4dFRyYWNrTGlzdAogKgogKiBAcGFyYW0ge1RleHRUcmFja30gdHJhY2sKICogQG1ldGhvZCBhZGRUcmFja18KICogQHByaXZhdGUKICovClRleHRUcmFja0xpc3QucHJvdG90eXBlLmFkZFRyYWNrXyA9IGZ1bmN0aW9uICh0cmFjaykgewogIHZhciBpbmRleCA9IHRoaXMudHJhY2tzXy5sZW5ndGg7CiAgaWYgKCEoJycgKyBpbmRleCBpbiB0aGlzKSkgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGluZGV4LCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnRyYWNrc19baW5kZXhdOwogICAgICB9CiAgICB9KTsKICB9CgogIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVjaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJyk7CiAgfSkpOwogIHRoaXMudHJhY2tzXy5wdXNoKHRyYWNrKTsKCiAgdGhpcy50cmlnZ2VyKHsKICAgIHR5cGU6ICdhZGR0cmFjaycsCiAgICB0cmFjazogdHJhY2sKICB9KTsKfTsKCi8qKgogKiBSZW1vdmUgVGV4dFRyYWNrIGZyb20gVGV4dFRyYWNrTGlzdAogKiBOT1RFOiBCZSBtaW5kZnVsIG9mIHdoYXQgaXMgcGFzc2VkIGluIGFzIGl0IG1heSBiZSBhIEhUTUxUcmFja0VsZW1lbnQKICoKICogQHBhcmFtIHtUZXh0VHJhY2t9IHJ0cmFjawogKiBAbWV0aG9kIHJlbW92ZVRyYWNrXwogKiBAcHJpdmF0ZQogKi8KVGV4dFRyYWNrTGlzdC5wcm90b3R5cGUucmVtb3ZlVHJhY2tfID0gZnVuY3Rpb24gKHJ0cmFjaykgewogIHZhciB0cmFjayA9IHVuZGVmaW5lZDsKCiAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgaWYgKHRoaXNbaV0gPT09IHJ0cmFjaykgewogICAgICB0cmFjayA9IHRoaXNbaV07CgogICAgICB0aGlzLnRyYWNrc18uc3BsaWNlKGksIDEpOwoKICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICBpZiAoIXRyYWNrKSB7CiAgICByZXR1cm47CiAgfQoKICB0aGlzLnRyaWdnZXIoewogICAgdHlwZTogJ3JlbW92ZXRyYWNrJywKICAgIHRyYWNrOiB0cmFjawogIH0pOwp9OwoKVGV4dFRyYWNrTGlzdC5wcm90b3R5cGUuZ2V0VHJhY2tCeUlkID0gZnVuY3Rpb24gKGlkKSB7CiAgdmFyIHJlc3VsdCA9IG51bGw7CgogIGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIHZhciB0cmFjayA9IHRoaXNbaV07CiAgICBpZiAodHJhY2suaWQgPT09IGlkKSB7CiAgICAgIHJlc3VsdCA9IHRyYWNrOwogICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiByZXN1bHQ7Cn07CgpleHBvcnRzWydkZWZhdWx0J10gPSBUZXh0VHJhY2tMaXN0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9ldmVudC10YXJnZXQiOjk3LCIuLi91dGlscy9icm93c2VyLmpzIjoxMjUsIi4uL3V0aWxzL2ZuLmpzIjoxMzAsImdsb2JhbC9kb2N1bWVudCI6MX1dLDEyMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSB0ZXh0LXRyYWNrLXNldHRpbmdzLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBfY29tcG9uZW50ID0gX2RlcmVxXygnLi4vY29tcG9uZW50Jyk7Cgp2YXIgX2NvbXBvbmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnQpOwoKdmFyIF91dGlsc0V2ZW50c0pzID0gX2RlcmVxXygnLi4vdXRpbHMvZXZlbnRzLmpzJyk7Cgp2YXIgRXZlbnRzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRXZlbnRzSnMpOwoKdmFyIF91dGlsc0ZuSnMgPSBfZGVyZXFfKCcuLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX3V0aWxzTG9nSnMgPSBfZGVyZXFfKCcuLi91dGlscy9sb2cuanMnKTsKCnZhciBfdXRpbHNMb2dKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0xvZ0pzKTsKCnZhciBfc2FmZUpzb25QYXJzZVR1cGxlID0gX2RlcmVxXygnc2FmZS1qc29uLXBhcnNlL3R1cGxlJyk7Cgp2YXIgX3NhZmVKc29uUGFyc2VUdXBsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zYWZlSnNvblBhcnNlVHVwbGUpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKLyoqCiAqIE1hbmlwdWxhdGUgc2V0dGluZ3Mgb2YgdGV4dHRyYWNrcwogKgogKiBAcGFyYW0ge09iamVjdH0gcGxheWVyICBNYWluIFBsYXllcgogKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMgT2JqZWN0IG9mIG9wdGlvbiBuYW1lcyBhbmQgdmFsdWVzCiAqIEBleHRlbmRzIENvbXBvbmVudAogKiBAY2xhc3MgVGV4dFRyYWNrU2V0dGluZ3MKICovCgp2YXIgVGV4dFRyYWNrU2V0dGluZ3MgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoVGV4dFRyYWNrU2V0dGluZ3MsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBUZXh0VHJhY2tTZXR0aW5ncyhwbGF5ZXIsIG9wdGlvbnMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUZXh0VHJhY2tTZXR0aW5ncyk7CgogICAgX0NvbXBvbmVudC5jYWxsKHRoaXMsIHBsYXllciwgb3B0aW9ucyk7CiAgICB0aGlzLmhpZGUoKTsKCiAgICAvLyBHcmFiIGBwZXJzaXN0VGV4dFRyYWNrU2V0dGluZ3NgIGZyb20gdGhlIHBsYXllciBvcHRpb25zIGlmIG5vdCBwYXNzZWQgaW4gY2hpbGQgb3B0aW9ucwogICAgaWYgKG9wdGlvbnMucGVyc2lzdFRleHRUcmFja1NldHRpbmdzID09PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy5vcHRpb25zXy5wZXJzaXN0VGV4dFRyYWNrU2V0dGluZ3MgPSB0aGlzLm9wdGlvbnNfLnBsYXllck9wdGlvbnMucGVyc2lzdFRleHRUcmFja1NldHRpbmdzOwogICAgfQoKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtZG9uZS1idXR0b24nKSwgJ2NsaWNrJywgRm4uYmluZCh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7CiAgICAgIHRoaXMuaGlkZSgpOwogICAgfSkpOwoKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtZGVmYXVsdC1idXR0b24nKSwgJ2NsaWNrJywgRm4uYmluZCh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuJCgnLnZqcy1mZy1jb2xvciA+IHNlbGVjdCcpLnNlbGVjdGVkSW5kZXggPSAwOwogICAgICB0aGlzLiQoJy52anMtYmctY29sb3IgPiBzZWxlY3QnKS5zZWxlY3RlZEluZGV4ID0gMDsKICAgICAgdGhpcy4kKCcud2luZG93LWNvbG9yID4gc2VsZWN0Jykuc2VsZWN0ZWRJbmRleCA9IDA7CiAgICAgIHRoaXMuJCgnLnZqcy10ZXh0LW9wYWNpdHkgPiBzZWxlY3QnKS5zZWxlY3RlZEluZGV4ID0gMDsKICAgICAgdGhpcy4kKCcudmpzLWJnLW9wYWNpdHkgPiBzZWxlY3QnKS5zZWxlY3RlZEluZGV4ID0gMDsKICAgICAgdGhpcy4kKCcudmpzLXdpbmRvdy1vcGFjaXR5ID4gc2VsZWN0Jykuc2VsZWN0ZWRJbmRleCA9IDA7CiAgICAgIHRoaXMuJCgnLnZqcy1lZGdlLXN0eWxlIHNlbGVjdCcpLnNlbGVjdGVkSW5kZXggPSAwOwogICAgICB0aGlzLiQoJy52anMtZm9udC1mYW1pbHkgc2VsZWN0Jykuc2VsZWN0ZWRJbmRleCA9IDA7CiAgICAgIHRoaXMuJCgnLnZqcy1mb250LXBlcmNlbnQgc2VsZWN0Jykuc2VsZWN0ZWRJbmRleCA9IDI7CiAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpOwogICAgfSkpOwoKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtZmctY29sb3IgPiBzZWxlY3QnKSwgJ2NoYW5nZScsIEZuLmJpbmQodGhpcywgdGhpcy51cGRhdGVEaXNwbGF5KSk7CiAgICBFdmVudHMub24odGhpcy4kKCcudmpzLWJnLWNvbG9yID4gc2VsZWN0JyksICdjaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlRGlzcGxheSkpOwogICAgRXZlbnRzLm9uKHRoaXMuJCgnLndpbmRvdy1jb2xvciA+IHNlbGVjdCcpLCAnY2hhbmdlJywgRm4uYmluZCh0aGlzLCB0aGlzLnVwZGF0ZURpc3BsYXkpKTsKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtdGV4dC1vcGFjaXR5ID4gc2VsZWN0JyksICdjaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlRGlzcGxheSkpOwogICAgRXZlbnRzLm9uKHRoaXMuJCgnLnZqcy1iZy1vcGFjaXR5ID4gc2VsZWN0JyksICdjaGFuZ2UnLCBGbi5iaW5kKHRoaXMsIHRoaXMudXBkYXRlRGlzcGxheSkpOwogICAgRXZlbnRzLm9uKHRoaXMuJCgnLnZqcy13aW5kb3ctb3BhY2l0eSA+IHNlbGVjdCcpLCAnY2hhbmdlJywgRm4uYmluZCh0aGlzLCB0aGlzLnVwZGF0ZURpc3BsYXkpKTsKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtZm9udC1wZXJjZW50IHNlbGVjdCcpLCAnY2hhbmdlJywgRm4uYmluZCh0aGlzLCB0aGlzLnVwZGF0ZURpc3BsYXkpKTsKICAgIEV2ZW50cy5vbih0aGlzLiQoJy52anMtZWRnZS1zdHlsZSBzZWxlY3QnKSwgJ2NoYW5nZScsIEZuLmJpbmQodGhpcywgdGhpcy51cGRhdGVEaXNwbGF5KSk7CiAgICBFdmVudHMub24odGhpcy4kKCcudmpzLWZvbnQtZmFtaWx5IHNlbGVjdCcpLCAnY2hhbmdlJywgRm4uYmluZCh0aGlzLCB0aGlzLnVwZGF0ZURpc3BsYXkpKTsKCiAgICBpZiAodGhpcy5vcHRpb25zXy5wZXJzaXN0VGV4dFRyYWNrU2V0dGluZ3MpIHsKICAgICAgdGhpcy5yZXN0b3JlU2V0dGluZ3MoKTsKICAgIH0KICB9CgogIC8qKgogICAqIENyZWF0ZSB0aGUgY29tcG9uZW50J3MgRE9NIGVsZW1lbnQKICAgKgogICAqIEByZXR1cm4ge0VsZW1lbnR9CiAgICogQG1ldGhvZCBjcmVhdGVFbAogICAqLwoKICBUZXh0VHJhY2tTZXR0aW5ncy5wcm90b3R5cGUuY3JlYXRlRWwgPSBmdW5jdGlvbiBjcmVhdGVFbCgpIHsKICAgIHJldHVybiBfQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVFbC5jYWxsKHRoaXMsICdkaXYnLCB7CiAgICAgIGNsYXNzTmFtZTogJ3Zqcy1jYXB0aW9uLXNldHRpbmdzIHZqcy1tb2RhbC1vdmVybGF5JywKICAgICAgaW5uZXJIVE1MOiBjYXB0aW9uT3B0aW9uc01lbnVUZW1wbGF0ZSgpCiAgICB9KTsKICB9OwoKICAvKioKICAgKiBHZXQgdGV4dHRyYWNrIHNldHRpbmdzCiAgICogU2V0dGluZ3MgYXJlCiAgICogLnZqcy1lZGdlLXN0eWxlCiAgICogLnZqcy1mb250LWZhbWlseQogICAqIC52anMtZmctY29sb3IKICAgKiAudmpzLXRleHQtb3BhY2l0eQogICAqIC52anMtYmctY29sb3IKICAgKiAudmpzLWJnLW9wYWNpdHkKICAgKiAud2luZG93LWNvbG9yCiAgICogLnZqcy13aW5kb3ctb3BhY2l0eQogICAqCiAgICogQHJldHVybiB7T2JqZWN0fQogICAqIEBtZXRob2QgZ2V0VmFsdWVzCiAgICovCgogIFRleHRUcmFja1NldHRpbmdzLnByb3RvdHlwZS5nZXRWYWx1ZXMgPSBmdW5jdGlvbiBnZXRWYWx1ZXMoKSB7CiAgICB2YXIgdGV4dEVkZ2UgPSBnZXRTZWxlY3RlZE9wdGlvblZhbHVlKHRoaXMuJCgnLnZqcy1lZGdlLXN0eWxlIHNlbGVjdCcpKTsKICAgIHZhciBmb250RmFtaWx5ID0gZ2V0U2VsZWN0ZWRPcHRpb25WYWx1ZSh0aGlzLiQoJy52anMtZm9udC1mYW1pbHkgc2VsZWN0JykpOwogICAgdmFyIGZnQ29sb3IgPSBnZXRTZWxlY3RlZE9wdGlvblZhbHVlKHRoaXMuJCgnLnZqcy1mZy1jb2xvciA+IHNlbGVjdCcpKTsKICAgIHZhciB0ZXh0T3BhY2l0eSA9IGdldFNlbGVjdGVkT3B0aW9uVmFsdWUodGhpcy4kKCcudmpzLXRleHQtb3BhY2l0eSA+IHNlbGVjdCcpKTsKICAgIHZhciBiZ0NvbG9yID0gZ2V0U2VsZWN0ZWRPcHRpb25WYWx1ZSh0aGlzLiQoJy52anMtYmctY29sb3IgPiBzZWxlY3QnKSk7CiAgICB2YXIgYmdPcGFjaXR5ID0gZ2V0U2VsZWN0ZWRPcHRpb25WYWx1ZSh0aGlzLiQoJy52anMtYmctb3BhY2l0eSA+IHNlbGVjdCcpKTsKICAgIHZhciB3aW5kb3dDb2xvciA9IGdldFNlbGVjdGVkT3B0aW9uVmFsdWUodGhpcy4kKCcud2luZG93LWNvbG9yID4gc2VsZWN0JykpOwogICAgdmFyIHdpbmRvd09wYWNpdHkgPSBnZXRTZWxlY3RlZE9wdGlvblZhbHVlKHRoaXMuJCgnLnZqcy13aW5kb3ctb3BhY2l0eSA+IHNlbGVjdCcpKTsKICAgIHZhciBmb250UGVyY2VudCA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J11bJ3BhcnNlRmxvYXQnXShnZXRTZWxlY3RlZE9wdGlvblZhbHVlKHRoaXMuJCgnLnZqcy1mb250LXBlcmNlbnQgPiBzZWxlY3QnKSkpOwoKICAgIHZhciByZXN1bHQgPSB7CiAgICAgICdiYWNrZ3JvdW5kT3BhY2l0eSc6IGJnT3BhY2l0eSwKICAgICAgJ3RleHRPcGFjaXR5JzogdGV4dE9wYWNpdHksCiAgICAgICd3aW5kb3dPcGFjaXR5Jzogd2luZG93T3BhY2l0eSwKICAgICAgJ2VkZ2VTdHlsZSc6IHRleHRFZGdlLAogICAgICAnZm9udEZhbWlseSc6IGZvbnRGYW1pbHksCiAgICAgICdjb2xvcic6IGZnQ29sb3IsCiAgICAgICdiYWNrZ3JvdW5kQ29sb3InOiBiZ0NvbG9yLAogICAgICAnd2luZG93Q29sb3InOiB3aW5kb3dDb2xvciwKICAgICAgJ2ZvbnRQZXJjZW50JzogZm9udFBlcmNlbnQKICAgIH07CiAgICBmb3IgKHZhciBfbmFtZSBpbiByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdFtfbmFtZV0gPT09ICcnIHx8IHJlc3VsdFtfbmFtZV0gPT09ICdub25lJyB8fCBfbmFtZSA9PT0gJ2ZvbnRQZXJjZW50JyAmJiByZXN1bHRbX25hbWVdID09PSAxLjAwKSB7CiAgICAgICAgZGVsZXRlIHJlc3VsdFtfbmFtZV07CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLyoqCiAgICogU2V0IHRleHR0cmFjayBzZXR0aW5ncwogICAqIFNldHRpbmdzIGFyZQogICAqIC52anMtZWRnZS1zdHlsZQogICAqIC52anMtZm9udC1mYW1pbHkKICAgKiAudmpzLWZnLWNvbG9yCiAgICogLnZqcy10ZXh0LW9wYWNpdHkKICAgKiAudmpzLWJnLWNvbG9yCiAgICogLnZqcy1iZy1vcGFjaXR5CiAgICogLndpbmRvdy1jb2xvcgogICAqIC52anMtd2luZG93LW9wYWNpdHkKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZXMgT2JqZWN0IHdpdGggdGV4dHRyYWNrIHNldHRpbmcgdmFsdWVzCiAgICogQG1ldGhvZCBzZXRWYWx1ZXMKICAgKi8KCiAgVGV4dFRyYWNrU2V0dGluZ3MucHJvdG90eXBlLnNldFZhbHVlcyA9IGZ1bmN0aW9uIHNldFZhbHVlcyh2YWx1ZXMpIHsKICAgIHNldFNlbGVjdGVkT3B0aW9uKHRoaXMuJCgnLnZqcy1lZGdlLXN0eWxlIHNlbGVjdCcpLCB2YWx1ZXMuZWRnZVN0eWxlKTsKICAgIHNldFNlbGVjdGVkT3B0aW9uKHRoaXMuJCgnLnZqcy1mb250LWZhbWlseSBzZWxlY3QnKSwgdmFsdWVzLmZvbnRGYW1pbHkpOwogICAgc2V0U2VsZWN0ZWRPcHRpb24odGhpcy4kKCcudmpzLWZnLWNvbG9yID4gc2VsZWN0JyksIHZhbHVlcy5jb2xvcik7CiAgICBzZXRTZWxlY3RlZE9wdGlvbih0aGlzLiQoJy52anMtdGV4dC1vcGFjaXR5ID4gc2VsZWN0JyksIHZhbHVlcy50ZXh0T3BhY2l0eSk7CiAgICBzZXRTZWxlY3RlZE9wdGlvbih0aGlzLiQoJy52anMtYmctY29sb3IgPiBzZWxlY3QnKSwgdmFsdWVzLmJhY2tncm91bmRDb2xvcik7CiAgICBzZXRTZWxlY3RlZE9wdGlvbih0aGlzLiQoJy52anMtYmctb3BhY2l0eSA+IHNlbGVjdCcpLCB2YWx1ZXMuYmFja2dyb3VuZE9wYWNpdHkpOwogICAgc2V0U2VsZWN0ZWRPcHRpb24odGhpcy4kKCcud2luZG93LWNvbG9yID4gc2VsZWN0JyksIHZhbHVlcy53aW5kb3dDb2xvcik7CiAgICBzZXRTZWxlY3RlZE9wdGlvbih0aGlzLiQoJy52anMtd2luZG93LW9wYWNpdHkgPiBzZWxlY3QnKSwgdmFsdWVzLndpbmRvd09wYWNpdHkpOwoKICAgIHZhciBmb250UGVyY2VudCA9IHZhbHVlcy5mb250UGVyY2VudDsKCiAgICBpZiAoZm9udFBlcmNlbnQpIHsKICAgICAgZm9udFBlcmNlbnQgPSBmb250UGVyY2VudC50b0ZpeGVkKDIpOwogICAgfQoKICAgIHNldFNlbGVjdGVkT3B0aW9uKHRoaXMuJCgnLnZqcy1mb250LXBlcmNlbnQgPiBzZWxlY3QnKSwgZm9udFBlcmNlbnQpOwogIH07CgogIC8qKgogICAqIFJlc3RvcmUgdGV4dHRyYWNrIHNldHRpbmdzCiAgICoKICAgKiBAbWV0aG9kIHJlc3RvcmVTZXR0aW5ncwogICAqLwoKICBUZXh0VHJhY2tTZXR0aW5ncy5wcm90b3R5cGUucmVzdG9yZVNldHRpbmdzID0gZnVuY3Rpb24gcmVzdG9yZVNldHRpbmdzKCkgewogICAgdmFyIF9zYWZlUGFyc2VUdXBsZSA9IF9zYWZlSnNvblBhcnNlVHVwbGUyWydkZWZhdWx0J10oX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndmpzLXRleHQtdHJhY2stc2V0dGluZ3MnKSk7CgogICAgdmFyIGVyciA9IF9zYWZlUGFyc2VUdXBsZVswXTsKICAgIHZhciB2YWx1ZXMgPSBfc2FmZVBhcnNlVHVwbGVbMV07CgogICAgaWYgKGVycikgewogICAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS5lcnJvcihlcnIpOwogICAgfQoKICAgIGlmICh2YWx1ZXMpIHsKICAgICAgdGhpcy5zZXRWYWx1ZXModmFsdWVzKTsKICAgIH0KICB9OwoKICAvKioKICAgKiBTYXZlIHRleHR0cmFjayBzZXR0aW5ncyB0byBsb2NhbCBzdG9yYWdlCiAgICoKICAgKiBAbWV0aG9kIHNhdmVTZXR0aW5ncwogICAqLwoKICBUZXh0VHJhY2tTZXR0aW5ncy5wcm90b3R5cGUuc2F2ZVNldHRpbmdzID0gZnVuY3Rpb24gc2F2ZVNldHRpbmdzKCkgewogICAgaWYgKCF0aGlzLm9wdGlvbnNfLnBlcnNpc3RUZXh0VHJhY2tTZXR0aW5ncykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHZhbHVlcyA9IHRoaXMuZ2V0VmFsdWVzKCk7CiAgICB0cnkgewogICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmFsdWVzKS5sZW5ndGggPiAwKSB7CiAgICAgICAgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndmpzLXRleHQtdHJhY2stc2V0dGluZ3MnLCBKU09OLnN0cmluZ2lmeSh2YWx1ZXMpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd2anMtdGV4dC10cmFjay1zZXR0aW5ncycpOwogICAgICB9CiAgICB9IGNhdGNoIChlKSB7fQogIH07CgogIC8qKgogICAqIFVwZGF0ZSBkaXNwbGF5IG9mIHRleHR0cmFjayBzZXR0aW5ncwogICAqCiAgICogQG1ldGhvZCB1cGRhdGVEaXNwbGF5CiAgICovCgogIFRleHRUcmFja1NldHRpbmdzLnByb3RvdHlwZS51cGRhdGVEaXNwbGF5ID0gZnVuY3Rpb24gdXBkYXRlRGlzcGxheSgpIHsKICAgIHZhciB0dERpc3BsYXkgPSB0aGlzLnBsYXllcl8uZ2V0Q2hpbGQoJ3RleHRUcmFja0Rpc3BsYXknKTsKICAgIGlmICh0dERpc3BsYXkpIHsKICAgICAgdHREaXNwbGF5LnVwZGF0ZURpc3BsYXkoKTsKICAgIH0KICB9OwoKICByZXR1cm4gVGV4dFRyYWNrU2V0dGluZ3M7Cn0pKF9jb21wb25lbnQyWydkZWZhdWx0J10pOwoKX2NvbXBvbmVudDJbJ2RlZmF1bHQnXS5yZWdpc3RlckNvbXBvbmVudCgnVGV4dFRyYWNrU2V0dGluZ3MnLCBUZXh0VHJhY2tTZXR0aW5ncyk7CgpmdW5jdGlvbiBnZXRTZWxlY3RlZE9wdGlvblZhbHVlKHRhcmdldCkgewogIHZhciBzZWxlY3RlZE9wdGlvbiA9IHVuZGVmaW5lZDsKICAvLyBub3QgYWxsIGJyb3dzZXJzIHN1cHBvcnQgc2VsZWN0ZWRPcHRpb25zLCBzbywgZmFsbGJhY2sgdG8gb3B0aW9ucwogIGlmICh0YXJnZXQuc2VsZWN0ZWRPcHRpb25zKSB7CiAgICBzZWxlY3RlZE9wdGlvbiA9IHRhcmdldC5zZWxlY3RlZE9wdGlvbnNbMF07CiAgfSBlbHNlIGlmICh0YXJnZXQub3B0aW9ucykgewogICAgc2VsZWN0ZWRPcHRpb24gPSB0YXJnZXQub3B0aW9uc1t0YXJnZXQub3B0aW9ucy5zZWxlY3RlZEluZGV4XTsKICB9CgogIHJldHVybiBzZWxlY3RlZE9wdGlvbi52YWx1ZTsKfQoKZnVuY3Rpb24gc2V0U2VsZWN0ZWRPcHRpb24odGFyZ2V0LCB2YWx1ZSkgewogIGlmICghdmFsdWUpIHsKICAgIHJldHVybjsKICB9CgogIHZhciBpID0gdW5kZWZpbmVkOwogIGZvciAoaSA9IDA7IGkgPCB0YXJnZXQub3B0aW9ucy5sZW5ndGg7IGkrKykgewogICAgdmFyIG9wdGlvbiA9IHRhcmdldC5vcHRpb25zW2ldOwogICAgaWYgKG9wdGlvbi52YWx1ZSA9PT0gdmFsdWUpIHsKICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICB0YXJnZXQuc2VsZWN0ZWRJbmRleCA9IGk7Cn0KCmZ1bmN0aW9uIGNhcHRpb25PcHRpb25zTWVudVRlbXBsYXRlKCkgewogIHZhciB0ZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPSJ2anMtdHJhY2tzZXR0aW5ncyI+XG4gICAgICA8ZGl2IGNsYXNzPSJ2anMtdHJhY2tzZXR0aW5ncy1jb2xvcnMiPlxuICAgICAgICA8ZGl2IGNsYXNzPSJ2anMtZmctY29sb3IgdmpzLXRyYWNrc2V0dGluZyI+XG4gICAgICAgICAgICA8bGFiZWwgY2xhc3M9InZqcy1sYWJlbCI+Rm9yZWdyb3VuZDwvbGFiZWw+XG4gICAgICAgICAgICA8c2VsZWN0PlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tLTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRkZGIj5XaGl0ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjMDAwIj5CbGFjazwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRjAwIj5SZWQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzBGMCI+R3JlZW48L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzAwRiI+Qmx1ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRkYwIj5ZZWxsb3c8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iI0YwRiI+TWFnZW50YTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjMEZGIj5DeWFuPC9vcHRpb24+XG4gICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ2anMtdGV4dC1vcGFjaXR5IHZqcy1vcGFjaXR5Ij5cbiAgICAgICAgICAgICAgPHNlbGVjdD5cbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tLTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEiPk9wYXF1ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAuNSI+U2VtaS1PcGFxdWU8L29wdGlvbj5cbiAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvZGl2PiA8IS0tIHZqcy1mZy1jb2xvciAtLT5cbiAgICAgICAgPGRpdiBjbGFzcz0idmpzLWJnLWNvbG9yIHZqcy10cmFja3NldHRpbmciPlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJ2anMtbGFiZWwiPkJhY2tncm91bmQ8L2xhYmVsPlxuICAgICAgICAgICAgPHNlbGVjdD5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj4tLS08L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iI0ZGRiI+V2hpdGU8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzAwMCI+QmxhY2s8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iI0YwMCI+UmVkPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiMwRjAiPkdyZWVuPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiMwMEYiPkJsdWU8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iI0ZGMCI+WWVsbG93PC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiNGMEYiPk1hZ2VudGE8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzBGRiI+Q3lhbjwvb3B0aW9uPlxuICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz0idmpzLWJnLW9wYWNpdHkgdmpzLW9wYWNpdHkiPlxuICAgICAgICAgICAgICAgIDxzZWxlY3Q+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tLTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMSI+T3BhcXVlPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwLjUiPlNlbWktVHJhbnNwYXJlbnQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAiPlRyYW5zcGFyZW50PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvZGl2PiA8IS0tIHZqcy1iZy1jb2xvciAtLT5cbiAgICAgICAgPGRpdiBjbGFzcz0id2luZG93LWNvbG9yIHZqcy10cmFja3NldHRpbmciPlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJ2anMtbGFiZWwiPldpbmRvdzwvbGFiZWw+XG4gICAgICAgICAgICA8c2VsZWN0PlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tLTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRkZGIj5XaGl0ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjMDAwIj5CbGFjazwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRjAwIj5SZWQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzBGMCI+R3JlZW48L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIzAwRiI+Qmx1ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjRkYwIj5ZZWxsb3c8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iI0YwRiI+TWFnZW50YTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIjMEZGIj5DeWFuPC9vcHRpb24+XG4gICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ2anMtd2luZG93LW9wYWNpdHkgdmpzLW9wYWNpdHkiPlxuICAgICAgICAgICAgICAgIDxzZWxlY3Q+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tLTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMSI+T3BhcXVlPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwLjUiPlNlbWktVHJhbnNwYXJlbnQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAiPlRyYW5zcGFyZW50PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvZGl2PiA8IS0tIHZqcy13aW5kb3ctY29sb3IgLS0+XG4gICAgICA8L2Rpdj4gPCEtLSB2anMtdHJhY2tzZXR0aW5ncyAtLT5cbiAgICAgIDxkaXYgY2xhc3M9InZqcy10cmFja3NldHRpbmdzLWZvbnQiPlxuICAgICAgICA8ZGl2IGNsYXNzPSJ2anMtZm9udC1wZXJjZW50IHZqcy10cmFja3NldHRpbmciPlxuICAgICAgICAgIDxsYWJlbCBjbGFzcz0idmpzLWxhYmVsIj5Gb250IFNpemU8L2xhYmVsPlxuICAgICAgICAgIDxzZWxlY3Q+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwLjUwIj41MCU8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAuNzUiPjc1JTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMS4wMCIgc2VsZWN0ZWQ+MTAwJTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMS4yNSI+MTI1JTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMS41MCI+MTUwJTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMS43NSI+MTc1JTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMi4wMCI+MjAwJTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMy4wMCI+MzAwJTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNC4wMCI+NDAwJTwvb3B0aW9uPlxuICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICA8L2Rpdj4gPCEtLSB2anMtZm9udC1wZXJjZW50IC0tPlxuICAgICAgICA8ZGl2IGNsYXNzPSJ2anMtZWRnZS1zdHlsZSB2anMtdHJhY2tzZXR0aW5nIj5cbiAgICAgICAgICA8bGFiZWwgY2xhc3M9InZqcy1sYWJlbCI+VGV4dCBFZGdlIFN0eWxlPC9sYWJlbD5cbiAgICAgICAgICA8c2VsZWN0PlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibm9uZSI+Tm9uZTwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0icmFpc2VkIj5SYWlzZWQ8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImRlcHJlc3NlZCI+RGVwcmVzc2VkPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ1bmlmb3JtIj5Vbmlmb3JtPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJkcm9wc2hhZG93Ij5Ecm9wc2hhZG93PC9vcHRpb24+XG4gICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgIDwvZGl2PiA8IS0tIHZqcy1lZGdlLXN0eWxlIC0tPlxuICAgICAgICA8ZGl2IGNsYXNzPSJ2anMtZm9udC1mYW1pbHkgdmpzLXRyYWNrc2V0dGluZyI+XG4gICAgICAgICAgPGxhYmVsIGNsYXNzPSJ2anMtbGFiZWwiPkZvbnQgRmFtaWx5PC9sYWJlbD5cbiAgICAgICAgICA8c2VsZWN0PlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5EZWZhdWx0PC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtb25vc3BhY2VTZXJpZiI+TW9ub3NwYWNlIFNlcmlmPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwcm9wb3J0aW9uYWxTZXJpZiI+UHJvcG9ydGlvbmFsIFNlcmlmPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtb25vc3BhY2VTYW5zU2VyaWYiPk1vbm9zcGFjZSBTYW5zLVNlcmlmPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwcm9wb3J0aW9uYWxTYW5zU2VyaWYiPlByb3BvcnRpb25hbCBTYW5zLVNlcmlmPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJjYXN1YWwiPkNhc3VhbDwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ic2NyaXB0Ij5TY3JpcHQ8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InNtYWxsLWNhcHMiPlNtYWxsIENhcHM8L29wdGlvbj5cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgPC9kaXY+IDwhLS0gdmpzLWZvbnQtZmFtaWx5IC0tPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz0idmpzLXRyYWNrc2V0dGluZ3MtY29udHJvbHMiPlxuICAgICAgPGJ1dHRvbiBjbGFzcz0idmpzLWRlZmF1bHQtYnV0dG9uIj5EZWZhdWx0czwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBjbGFzcz0idmpzLWRvbmUtYnV0dG9uIj5Eb25lPC9idXR0b24+XG4gICAgPC9kaXY+JzsKCiAgcmV0dXJuIHRlbXBsYXRlOwp9CgpleHBvcnRzWydkZWZhdWx0J10gPSBUZXh0VHJhY2tTZXR0aW5nczsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vY29tcG9uZW50Ijo2NSwiLi4vdXRpbHMvZXZlbnRzLmpzIjoxMjksIi4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uL3V0aWxzL2xvZy5qcyI6MTMzLCJnbG9iYWwvd2luZG93IjoyLCJzYWZlLWpzb24tcGFyc2UvdHVwbGUiOjUzfV0sMTI0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHRleHQtdHJhY2suanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF90ZXh0VHJhY2tDdWVMaXN0ID0gX2RlcmVxXygnLi90ZXh0LXRyYWNrLWN1ZS1saXN0Jyk7Cgp2YXIgX3RleHRUcmFja0N1ZUxpc3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGV4dFRyYWNrQ3VlTGlzdCk7Cgp2YXIgX3V0aWxzRm5KcyA9IF9kZXJlcV8oJy4uL3V0aWxzL2ZuLmpzJyk7Cgp2YXIgRm4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNGbkpzKTsKCnZhciBfdXRpbHNHdWlkSnMgPSBfZGVyZXFfKCcuLi91dGlscy9ndWlkLmpzJyk7Cgp2YXIgR3VpZCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc0d1aWRKcyk7Cgp2YXIgX3V0aWxzQnJvd3NlckpzID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpOwoKdmFyIGJyb3dzZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNCcm93c2VySnMpOwoKdmFyIF90ZXh0VHJhY2tFbnVtcyA9IF9kZXJlcV8oJy4vdGV4dC10cmFjay1lbnVtcycpOwoKdmFyIFRleHRUcmFja0VudW0gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdGV4dFRyYWNrRW51bXMpOwoKdmFyIF91dGlsc0xvZ0pzID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nLmpzJyk7Cgp2YXIgX3V0aWxzTG9nSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNMb2dKcyk7Cgp2YXIgX2V2ZW50VGFyZ2V0ID0gX2RlcmVxXygnLi4vZXZlbnQtdGFyZ2V0Jyk7Cgp2YXIgX2V2ZW50VGFyZ2V0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50VGFyZ2V0KTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF91dGlsc1VybEpzID0gX2RlcmVxXygnLi4vdXRpbHMvdXJsLmpzJyk7Cgp2YXIgX3hociA9IF9kZXJlcV8oJ3hocicpOwoKdmFyIF94aHIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfeGhyKTsKCi8qCiAqIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2VtYmVkZGVkLWNvbnRlbnQuaHRtbCN0ZXh0dHJhY2sKICoKICogaW50ZXJmYWNlIFRleHRUcmFjayA6IEV2ZW50VGFyZ2V0IHsKICogICByZWFkb25seSBhdHRyaWJ1dGUgVGV4dFRyYWNrS2luZCBraW5kOwogKiAgIHJlYWRvbmx5IGF0dHJpYnV0ZSBET01TdHJpbmcgbGFiZWw7CiAqICAgcmVhZG9ubHkgYXR0cmlidXRlIERPTVN0cmluZyBsYW5ndWFnZTsKICoKICogICByZWFkb25seSBhdHRyaWJ1dGUgRE9NU3RyaW5nIGlkOwogKiAgIHJlYWRvbmx5IGF0dHJpYnV0ZSBET01TdHJpbmcgaW5CYW5kTWV0YWRhdGFUcmFja0Rpc3BhdGNoVHlwZTsKICoKICogICBhdHRyaWJ1dGUgVGV4dFRyYWNrTW9kZSBtb2RlOwogKgogKiAgIHJlYWRvbmx5IGF0dHJpYnV0ZSBUZXh0VHJhY2tDdWVMaXN0PyBjdWVzOwogKiAgIHJlYWRvbmx5IGF0dHJpYnV0ZSBUZXh0VHJhY2tDdWVMaXN0PyBhY3RpdmVDdWVzOwogKgogKiAgIHZvaWQgYWRkQ3VlKFRleHRUcmFja0N1ZSBjdWUpOwogKiAgIHZvaWQgcmVtb3ZlQ3VlKFRleHRUcmFja0N1ZSBjdWUpOwogKgogKiAgIGF0dHJpYnV0ZSBFdmVudEhhbmRsZXIgb25jdWVjaGFuZ2U7CiAqIH07CiAqLwp2YXIgVGV4dFRyYWNrID0gZnVuY3Rpb24gVGV4dFRyYWNrKCkgewogIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07CgogIGlmICghb3B0aW9ucy50ZWNoKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgdGVjaCB3YXMgbm90IHByb3ZpZGVkLicpOwogIH0KCiAgdmFyIHR0ID0gdGhpczsKICBpZiAoYnJvd3Nlci5JU19JRTgpIHsKICAgIHR0ID0gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ2N1c3RvbScpOwoKICAgIGZvciAodmFyIHByb3AgaW4gVGV4dFRyYWNrLnByb3RvdHlwZSkgewogICAgICBpZiAocHJvcCAhPT0gJ2NvbnN0cnVjdG9yJykgewogICAgICAgIHR0W3Byb3BdID0gVGV4dFRyYWNrLnByb3RvdHlwZVtwcm9wXTsKICAgICAgfQogICAgfQogIH0KCiAgdHQudGVjaF8gPSBvcHRpb25zLnRlY2g7CgogIHZhciBtb2RlID0gVGV4dFRyYWNrRW51bS5UZXh0VHJhY2tNb2RlW29wdGlvbnNbJ21vZGUnXV0gfHwgJ2Rpc2FibGVkJzsKICB2YXIga2luZCA9IFRleHRUcmFja0VudW0uVGV4dFRyYWNrS2luZFtvcHRpb25zWydraW5kJ11dIHx8ICdzdWJ0aXRsZXMnOwogIHZhciBsYWJlbCA9IG9wdGlvbnNbJ2xhYmVsJ10gfHwgJyc7CiAgdmFyIGxhbmd1YWdlID0gb3B0aW9uc1snbGFuZ3VhZ2UnXSB8fCBvcHRpb25zWydzcmNsYW5nJ10gfHwgJyc7CiAgdmFyIGlkID0gb3B0aW9uc1snaWQnXSB8fCAndmpzX3RleHRfdHJhY2tfJyArIEd1aWQubmV3R1VJRCgpOwoKICBpZiAoa2luZCA9PT0gJ21ldGFkYXRhJyB8fCBraW5kID09PSAnY2hhcHRlcnMnKSB7CiAgICBtb2RlID0gJ2hpZGRlbic7CiAgfQoKICB0dC5jdWVzXyA9IFtdOwogIHR0LmFjdGl2ZUN1ZXNfID0gW107CgogIHZhciBjdWVzID0gbmV3IF90ZXh0VHJhY2tDdWVMaXN0MlsnZGVmYXVsdCddKHR0LmN1ZXNfKTsKICB2YXIgYWN0aXZlQ3VlcyA9IG5ldyBfdGV4dFRyYWNrQ3VlTGlzdDJbJ2RlZmF1bHQnXSh0dC5hY3RpdmVDdWVzXyk7CgogIHZhciBjaGFuZ2VkID0gZmFsc2U7CiAgdmFyIHRpbWV1cGRhdGVIYW5kbGVyID0gRm4uYmluZCh0dCwgZnVuY3Rpb24gKCkgewogICAgdGhpc1snYWN0aXZlQ3VlcyddOwogICAgaWYgKGNoYW5nZWQpIHsKICAgICAgdGhpc1sndHJpZ2dlciddKCdjdWVjaGFuZ2UnKTsKICAgICAgY2hhbmdlZCA9IGZhbHNlOwogICAgfQogIH0pOwogIGlmIChtb2RlICE9PSAnZGlzYWJsZWQnKSB7CiAgICB0dC50ZWNoXy5vbigndGltZXVwZGF0ZScsIHRpbWV1cGRhdGVIYW5kbGVyKTsKICB9CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0dCwgJ2tpbmQnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIGtpbmQ7CiAgICB9LAogICAgc2V0OiBGdW5jdGlvbi5wcm90b3R5cGUKICB9KTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR0LCAnbGFiZWwnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIGxhYmVsOwogICAgfSwKICAgIHNldDogRnVuY3Rpb24ucHJvdG90eXBlCiAgfSk7CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0dCwgJ2xhbmd1YWdlJywgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiBsYW5ndWFnZTsKICAgIH0sCiAgICBzZXQ6IEZ1bmN0aW9uLnByb3RvdHlwZQogIH0pOwoKICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHQsICdpZCcsIHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gaWQ7CiAgICB9LAogICAgc2V0OiBGdW5jdGlvbi5wcm90b3R5cGUKICB9KTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR0LCAnbW9kZScsIHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gbW9kZTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdNb2RlKSB7CiAgICAgIGlmICghVGV4dFRyYWNrRW51bS5UZXh0VHJhY2tNb2RlW25ld01vZGVdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIG1vZGUgPSBuZXdNb2RlOwogICAgICBpZiAobW9kZSA9PT0gJ3Nob3dpbmcnKSB7CiAgICAgICAgdGhpcy50ZWNoXy5vbigndGltZXVwZGF0ZScsIHRpbWV1cGRhdGVIYW5kbGVyKTsKICAgICAgfQogICAgICB0aGlzLnRyaWdnZXIoJ21vZGVjaGFuZ2UnKTsKICAgIH0KICB9KTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR0LCAnY3VlcycsIHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAoIXRoaXMubG9hZGVkXykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gY3VlczsKICAgIH0sCiAgICBzZXQ6IEZ1bmN0aW9uLnByb3RvdHlwZQogIH0pOwoKICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHQsICdhY3RpdmVDdWVzJywgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICghdGhpcy5sb2FkZWRfKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzWydjdWVzJ10ubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIGFjdGl2ZUN1ZXM7IC8vIG5vdGhpbmcgdG8gZG8KICAgICAgfQoKICAgICAgdmFyIGN0ID0gdGhpcy50ZWNoXy5jdXJyZW50VGltZSgpOwogICAgICB2YXIgYWN0aXZlID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXNbJ2N1ZXMnXS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgY3VlID0gdGhpc1snY3VlcyddW2ldOwogICAgICAgIGlmIChjdWVbJ3N0YXJ0VGltZSddIDw9IGN0ICYmIGN1ZVsnZW5kVGltZSddID49IGN0KSB7CiAgICAgICAgICBhY3RpdmUucHVzaChjdWUpOwogICAgICAgIH0gZWxzZSBpZiAoY3VlWydzdGFydFRpbWUnXSA9PT0gY3VlWydlbmRUaW1lJ10gJiYgY3VlWydzdGFydFRpbWUnXSA8PSBjdCAmJiBjdWVbJ3N0YXJ0VGltZSddICsgMC41ID49IGN0KSB7CiAgICAgICAgICBhY3RpdmUucHVzaChjdWUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY2hhbmdlZCA9IGZhbHNlOwoKICAgICAgaWYgKGFjdGl2ZS5sZW5ndGggIT09IHRoaXMuYWN0aXZlQ3Vlc18ubGVuZ3RoKSB7CiAgICAgICAgY2hhbmdlZCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhY3RpdmUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChpbmRleE9mLmNhbGwodGhpcy5hY3RpdmVDdWVzXywgYWN0aXZlW2ldKSA9PT0gLTEpIHsKICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFjdGl2ZUN1ZXNfID0gYWN0aXZlOwogICAgICBhY3RpdmVDdWVzLnNldEN1ZXNfKHRoaXMuYWN0aXZlQ3Vlc18pOwoKICAgICAgcmV0dXJuIGFjdGl2ZUN1ZXM7CiAgICB9LAogICAgc2V0OiBGdW5jdGlvbi5wcm90b3R5cGUKICB9KTsKCiAgaWYgKG9wdGlvbnMuc3JjKSB7CiAgICB0dC5zcmMgPSBvcHRpb25zLnNyYzsKICAgIGxvYWRUcmFjayhvcHRpb25zLnNyYywgdHQpOwogIH0gZWxzZSB7CiAgICB0dC5sb2FkZWRfID0gdHJ1ZTsKICB9CgogIGlmIChicm93c2VyLklTX0lFOCkgewogICAgcmV0dXJuIHR0OwogIH0KfTsKClRleHRUcmFjay5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKF9ldmVudFRhcmdldDJbJ2RlZmF1bHQnXS5wcm90b3R5cGUpOwpUZXh0VHJhY2sucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVGV4dFRyYWNrOwoKLyoKICogY3VlY2hhbmdlIC0gT25lIG9yIG1vcmUgY3VlcyBpbiB0aGUgdHJhY2sgaGF2ZSBiZWNvbWUgYWN0aXZlIG9yIHN0b3BwZWQgYmVpbmcgYWN0aXZlLgogKi8KVGV4dFRyYWNrLnByb3RvdHlwZS5hbGxvd2VkRXZlbnRzXyA9IHsKICAnY3VlY2hhbmdlJzogJ2N1ZWNoYW5nZScKfTsKClRleHRUcmFjay5wcm90b3R5cGUuYWRkQ3VlID0gZnVuY3Rpb24gKGN1ZSkgewogIHZhciB0cmFja3MgPSB0aGlzLnRlY2hfLnRleHRUcmFja3MoKTsKCiAgaWYgKHRyYWNrcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHRyYWNrc1tpXSAhPT0gdGhpcykgewogICAgICAgIHRyYWNrc1tpXS5yZW1vdmVDdWUoY3VlKTsKICAgICAgfQogICAgfQogIH0KCiAgdGhpcy5jdWVzXy5wdXNoKGN1ZSk7CiAgdGhpc1snY3VlcyddLnNldEN1ZXNfKHRoaXMuY3Vlc18pOwp9OwoKVGV4dFRyYWNrLnByb3RvdHlwZS5yZW1vdmVDdWUgPSBmdW5jdGlvbiAocmVtb3ZlQ3VlKSB7CiAgdmFyIHJlbW92ZWQgPSBmYWxzZTsKCiAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmN1ZXNfLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgdmFyIGN1ZSA9IHRoaXMuY3Vlc19baV07CiAgICBpZiAoY3VlID09PSByZW1vdmVDdWUpIHsKICAgICAgdGhpcy5jdWVzXy5zcGxpY2UoaSwgMSk7CiAgICAgIHJlbW92ZWQgPSB0cnVlOwogICAgfQogIH0KCiAgaWYgKHJlbW92ZWQpIHsKICAgIHRoaXMuY3Vlcy5zZXRDdWVzXyh0aGlzLmN1ZXNfKTsKICB9Cn07CgovKgoqIERvd25sb2FkaW5nIHN0dWZmIGhhcHBlbnMgYmVsb3cgdGhpcyBwb2ludAoqLwp2YXIgcGFyc2VDdWVzID0gZnVuY3Rpb24gcGFyc2VDdWVzKHNyY0NvbnRlbnQsIHRyYWNrKSB7CiAgdmFyIHBhcnNlciA9IG5ldyBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLldlYlZUVC5QYXJzZXIoX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXSwgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS52dHRqcywgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5XZWJWVFQuU3RyaW5nRGVjb2RlcigpKTsKCiAgcGFyc2VyLm9uY3VlID0gZnVuY3Rpb24gKGN1ZSkgewogICAgdHJhY2suYWRkQ3VlKGN1ZSk7CiAgfTsKCiAgcGFyc2VyLm9ucGFyc2luZ2Vycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7CiAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS5lcnJvcihlcnJvcik7CiAgfTsKCiAgcGFyc2VyLm9uZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgICB0cmFjay50cmlnZ2VyKHsKICAgICAgdHlwZTogJ2xvYWRlZGRhdGEnLAogICAgICB0YXJnZXQ6IHRyYWNrCiAgICB9KTsKICB9OwoKICBwYXJzZXIucGFyc2Uoc3JjQ29udGVudCk7CiAgcGFyc2VyLmZsdXNoKCk7Cn07Cgp2YXIgbG9hZFRyYWNrID0gZnVuY3Rpb24gbG9hZFRyYWNrKHNyYywgdHJhY2spIHsKICB2YXIgb3B0cyA9IHsKICAgIHVyaTogc3JjCiAgfTsKCiAgdmFyIGNyb3NzT3JpZ2luID0gX3V0aWxzVXJsSnMuaXNDcm9zc09yaWdpbihzcmMpOwogIGlmIChjcm9zc09yaWdpbikgewogICAgb3B0cy5jb3JzID0gY3Jvc3NPcmlnaW47CiAgfQoKICBfeGhyMlsnZGVmYXVsdCddKG9wdHMsIEZuLmJpbmQodGhpcywgZnVuY3Rpb24gKGVyciwgcmVzcG9uc2UsIHJlc3BvbnNlQm9keSkgewogICAgaWYgKGVycikgewogICAgICByZXR1cm4gX3V0aWxzTG9nSnMyWydkZWZhdWx0J10uZXJyb3IoZXJyLCByZXNwb25zZSk7CiAgICB9CgogICAgdHJhY2subG9hZGVkXyA9IHRydWU7CgogICAgLy8gTk9URTogdGhpcyBpcyBvbmx5IHVzZWQgZm9yIHRoZSBhbHQvdmlkZW8ubm92dHQuanMgYnVpbGQKICAgIGlmICh0eXBlb2YgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5XZWJWVFQgIT09ICdmdW5jdGlvbicpIHsKICAgICAgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBwYXJzZUN1ZXMocmVzcG9uc2VCb2R5LCB0cmFjayk7CiAgICAgIH0sIDEwMCk7CiAgICB9IGVsc2UgewogICAgICBwYXJzZUN1ZXMocmVzcG9uc2VCb2R5LCB0cmFjayk7CiAgICB9CiAgfSkpOwp9OwoKdmFyIGluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkgewogIGlmICh0aGlzID09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJ0aGlzIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7CiAgfQoKICB2YXIgTyA9IE9iamVjdCh0aGlzKTsKCiAgdmFyIGxlbiA9IE8ubGVuZ3RoID4+PiAwOwoKICBpZiAobGVuID09PSAwKSB7CiAgICByZXR1cm4gLTE7CiAgfQoKICB2YXIgbiA9ICtmcm9tSW5kZXggfHwgMDsKCiAgaWYgKE1hdGguYWJzKG4pID09PSBJbmZpbml0eSkgewogICAgbiA9IDA7CiAgfQoKICBpZiAobiA+PSBsZW4pIHsKICAgIHJldHVybiAtMTsKICB9CgogIHZhciBrID0gTWF0aC5tYXgobiA+PSAwID8gbiA6IGxlbiAtIE1hdGguYWJzKG4pLCAwKTsKCiAgd2hpbGUgKGsgPCBsZW4pIHsKICAgIGlmIChrIGluIE8gJiYgT1trXSA9PT0gc2VhcmNoRWxlbWVudCkgewogICAgICByZXR1cm4gazsKICAgIH0KICAgIGsrKzsKICB9CiAgcmV0dXJuIC0xOwp9OwoKZXhwb3J0c1snZGVmYXVsdCddID0gVGV4dFRyYWNrOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuLi9ldmVudC10YXJnZXQiOjk3LCIuLi91dGlscy9icm93c2VyLmpzIjoxMjUsIi4uL3V0aWxzL2ZuLmpzIjoxMzAsIi4uL3V0aWxzL2d1aWQuanMiOjEzMiwiLi4vdXRpbHMvbG9nLmpzIjoxMzMsIi4uL3V0aWxzL3VybC5qcyI6MTM4LCIuL3RleHQtdHJhY2stY3VlLWxpc3QiOjExOCwiLi90ZXh0LXRyYWNrLWVudW1zIjoxMjAsImdsb2JhbC9kb2N1bWVudCI6MSwiZ2xvYmFsL3dpbmRvdyI6MiwieGhyIjo1NX1dLDEyNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBicm93c2VyLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgX2dsb2JhbFdpbmRvdyA9IF9kZXJlcV8oJ2dsb2JhbC93aW5kb3cnKTsKCnZhciBfZ2xvYmFsV2luZG93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbFdpbmRvdyk7Cgp2YXIgVVNFUl9BR0VOVCA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10ubmF2aWdhdG9yLnVzZXJBZ2VudDsKdmFyIHdlYmtpdFZlcnNpb25NYXAgPSAvQXBwbGVXZWJLaXRcLyhbXGQuXSspL2kuZXhlYyhVU0VSX0FHRU5UKTsKdmFyIGFwcGxlV2Via2l0VmVyc2lvbiA9IHdlYmtpdFZlcnNpb25NYXAgPyBwYXJzZUZsb2F0KHdlYmtpdFZlcnNpb25NYXAucG9wKCkpIDogbnVsbDsKCi8qCiAqIERldmljZSBpcyBhbiBpUGhvbmUKICoKICogQHR5cGUge0Jvb2xlYW59CiAqIEBjb25zdGFudAogKiBAcHJpdmF0ZQogKi8KdmFyIElTX0lQSE9ORSA9IC9pUGhvbmUvaS50ZXN0KFVTRVJfQUdFTlQpOwpleHBvcnRzLklTX0lQSE9ORSA9IElTX0lQSE9ORTsKdmFyIElTX0lQQUQgPSAvaVBhZC9pLnRlc3QoVVNFUl9BR0VOVCk7CmV4cG9ydHMuSVNfSVBBRCA9IElTX0lQQUQ7CnZhciBJU19JUE9EID0gL2lQb2QvaS50ZXN0KFVTRVJfQUdFTlQpOwpleHBvcnRzLklTX0lQT0QgPSBJU19JUE9EOwp2YXIgSVNfSU9TID0gSVNfSVBIT05FIHx8IElTX0lQQUQgfHwgSVNfSVBPRDsKCmV4cG9ydHMuSVNfSU9TID0gSVNfSU9TOwp2YXIgSU9TX1ZFUlNJT04gPSAoZnVuY3Rpb24gKCkgewogIHZhciBtYXRjaCA9IFVTRVJfQUdFTlQubWF0Y2goL09TIChcZCspXy9pKTsKICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHsKICAgIHJldHVybiBtYXRjaFsxXTsKICB9Cn0pKCk7CgpleHBvcnRzLklPU19WRVJTSU9OID0gSU9TX1ZFUlNJT047CnZhciBJU19BTkRST0lEID0gL0FuZHJvaWQvaS50ZXN0KFVTRVJfQUdFTlQpOwpleHBvcnRzLklTX0FORFJPSUQgPSBJU19BTkRST0lEOwp2YXIgQU5EUk9JRF9WRVJTSU9OID0gKGZ1bmN0aW9uICgpIHsKICAvLyBUaGlzIG1hdGNoZXMgQW5kcm9pZCBNYWpvci5NaW5vci5QYXRjaCB2ZXJzaW9ucwogIC8vIEFORFJPSURfVkVSU0lPTiBpcyBNYWpvci5NaW5vciBhcyBhIE51bWJlciwgaWYgTWlub3IgaXNuJ3QgYXZhaWxhYmxlLCB0aGVuIG9ubHkgTWFqb3IgaXMgcmV0dXJuZWQKICB2YXIgbWF0Y2ggPSBVU0VSX0FHRU5ULm1hdGNoKC9BbmRyb2lkIChcZCspKD86XC4oXGQrKSk/KD86XC4oXGQrKSkqL2kpLAogICAgICBtYWpvciwKICAgICAgbWlub3I7CgogIGlmICghbWF0Y2gpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgbWFqb3IgPSBtYXRjaFsxXSAmJiBwYXJzZUZsb2F0KG1hdGNoWzFdKTsKICBtaW5vciA9IG1hdGNoWzJdICYmIHBhcnNlRmxvYXQobWF0Y2hbMl0pOwoKICBpZiAobWFqb3IgJiYgbWlub3IpIHsKICAgIHJldHVybiBwYXJzZUZsb2F0KG1hdGNoWzFdICsgJy4nICsgbWF0Y2hbMl0pOwogIH0gZWxzZSBpZiAobWFqb3IpIHsKICAgIHJldHVybiBtYWpvcjsKICB9IGVsc2UgewogICAgcmV0dXJuIG51bGw7CiAgfQp9KSgpOwpleHBvcnRzLkFORFJPSURfVkVSU0lPTiA9IEFORFJPSURfVkVSU0lPTjsKLy8gT2xkIEFuZHJvaWQgaXMgZGVmaW5lZCBhcyBWZXJzaW9uIG9sZGVyIHRoYW4gMi4zLCBhbmQgcmVxdWlyaW5nIGEgd2Via2l0IHZlcnNpb24gb2YgdGhlIGFuZHJvaWQgYnJvd3Nlcgp2YXIgSVNfT0xEX0FORFJPSUQgPSBJU19BTkRST0lEICYmIC93ZWJraXQvaS50ZXN0KFVTRVJfQUdFTlQpICYmIEFORFJPSURfVkVSU0lPTiA8IDIuMzsKZXhwb3J0cy5JU19PTERfQU5EUk9JRCA9IElTX09MRF9BTkRST0lEOwp2YXIgSVNfTkFUSVZFX0FORFJPSUQgPSBJU19BTkRST0lEICYmIEFORFJPSURfVkVSU0lPTiA8IDUgJiYgYXBwbGVXZWJraXRWZXJzaW9uIDwgNTM3OwoKZXhwb3J0cy5JU19OQVRJVkVfQU5EUk9JRCA9IElTX05BVElWRV9BTkRST0lEOwp2YXIgSVNfRklSRUZPWCA9IC9GaXJlZm94L2kudGVzdChVU0VSX0FHRU5UKTsKZXhwb3J0cy5JU19GSVJFRk9YID0gSVNfRklSRUZPWDsKdmFyIElTX0NIUk9NRSA9IC9DaHJvbWUvaS50ZXN0KFVTRVJfQUdFTlQpOwpleHBvcnRzLklTX0NIUk9NRSA9IElTX0NIUk9NRTsKdmFyIElTX0lFOCA9IC9NU0lFXHM4XC4wLy50ZXN0KFVTRVJfQUdFTlQpOwoKZXhwb3J0cy5JU19JRTggPSBJU19JRTg7CnZhciBUT1VDSF9FTkFCTEVEID0gISEoJ29udG91Y2hzdGFydCcgaW4gX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXSB8fCBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLkRvY3VtZW50VG91Y2ggJiYgX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddIGluc3RhbmNlb2YgX2dsb2JhbFdpbmRvdzJbJ2RlZmF1bHQnXS5Eb2N1bWVudFRvdWNoKTsKZXhwb3J0cy5UT1VDSF9FTkFCTEVEID0gVE9VQ0hfRU5BQkxFRDsKdmFyIEJBQ0tHUk9VTkRfU0laRV9TVVBQT1JURUQgPSAoJ2JhY2tncm91bmRTaXplJyBpbiBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgndmlkZW8nKS5zdHlsZSk7CmV4cG9ydHMuQkFDS0dST1VORF9TSVpFX1NVUFBPUlRFRCA9IEJBQ0tHUk9VTkRfU0laRV9TVVBQT1JURUQ7Cgp9LHsiZ2xvYmFsL2RvY3VtZW50IjoxLCJnbG9iYWwvd2luZG93IjoyfV0sMTI2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGJ1ZmZlci5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKZXhwb3J0cy5idWZmZXJlZFBlcmNlbnQgPSBidWZmZXJlZFBlcmNlbnQ7Cgp2YXIgX3RpbWVSYW5nZXNKcyA9IF9kZXJlcV8oJy4vdGltZS1yYW5nZXMuanMnKTsKCi8qKgogKiBDb21wdXRlIGhvdyBtdWNoIHlvdXIgdmlkZW8gaGFzIGJlZW4gYnVmZmVyZWQKICoKICogQHBhcmFtICB7T2JqZWN0fSBCdWZmZXJlZCBvYmplY3QKICogQHBhcmFtICB7TnVtYmVyfSBUb3RhbCBkdXJhdGlvbgogKiBAcmV0dXJuIHtOdW1iZXJ9IFBlcmNlbnQgYnVmZmVyZWQgb2YgdGhlIHRvdGFsIGR1cmF0aW9uCiAqIEBwcml2YXRlCiAqIEBmdW5jdGlvbiBidWZmZXJlZFBlcmNlbnQKICovCgpmdW5jdGlvbiBidWZmZXJlZFBlcmNlbnQoYnVmZmVyZWQsIGR1cmF0aW9uKSB7CiAgdmFyIGJ1ZmZlcmVkRHVyYXRpb24gPSAwLAogICAgICBzdGFydCwKICAgICAgZW5kOwoKICBpZiAoIWR1cmF0aW9uKSB7CiAgICByZXR1cm4gMDsKICB9CgogIGlmICghYnVmZmVyZWQgfHwgIWJ1ZmZlcmVkLmxlbmd0aCkgewogICAgYnVmZmVyZWQgPSBfdGltZVJhbmdlc0pzLmNyZWF0ZVRpbWVSYW5nZSgwLCAwKTsKICB9CgogIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHsKICAgIHN0YXJ0ID0gYnVmZmVyZWQuc3RhcnQoaSk7CiAgICBlbmQgPSBidWZmZXJlZC5lbmQoaSk7CgogICAgLy8gYnVmZmVyZWQgZW5kIGNhbiBiZSBiaWdnZXIgdGhhbiBkdXJhdGlvbiBieSBhIHZlcnkgc21hbGwgZnJhY3Rpb24KICAgIGlmIChlbmQgPiBkdXJhdGlvbikgewogICAgICBlbmQgPSBkdXJhdGlvbjsKICAgIH0KCiAgICBidWZmZXJlZER1cmF0aW9uICs9IGVuZCAtIHN0YXJ0OwogIH0KCiAgcmV0dXJuIGJ1ZmZlcmVkRHVyYXRpb24gLyBkdXJhdGlvbjsKfQoKfSx7Ii4vdGltZS1yYW5nZXMuanMiOjEzNn1dLDEyNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9Cgp2YXIgX2xvZ0pzID0gX2RlcmVxXygnLi9sb2cuanMnKTsKCnZhciBfbG9nSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nSnMpOwoKLyoqCiAqIE9iamVjdCBjb250YWluaW5nIHRoZSBkZWZhdWx0IGJlaGF2aW9ycyBmb3IgYXZhaWxhYmxlIGhhbmRsZXIgbWV0aG9kcy4KICoKICogQHByaXZhdGUKICogQHR5cGUge09iamVjdH0KICovCnZhciBkZWZhdWx0QmVoYXZpb3JzID0gewogIGdldDogZnVuY3Rpb24gZ2V0KG9iaiwga2V5KSB7CiAgICByZXR1cm4gb2JqW2tleV07CiAgfSwKICBzZXQ6IGZ1bmN0aW9uIHNldChvYmosIGtleSwgdmFsdWUpIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioKICogRXhwb3NlIHByaXZhdGUgb2JqZWN0cyBwdWJsaWNseSB1c2luZyBhIFByb3h5IHRvIGxvZyBkZXByZWNhdGlvbiB3YXJuaW5ncy4KICoKICogQnJvd3NlcnMgdGhhdCBkbyBub3Qgc3VwcG9ydCBQcm94eSBvYmplY3RzIHdpbGwgc2ltcGx5IHJldHVybiB0aGUgYHRhcmdldGAKICogb2JqZWN0LCBzbyBpdCBjYW4gYmUgZGlyZWN0bHkgZXhwb3NlZC4KICoKICogQHBhcmFtIHtPYmplY3R9IHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdC4KICogQHBhcmFtIHtPYmplY3R9IG1lc3NhZ2VzIE1lc3NhZ2VzIHRvIGRpc3BsYXkgZnJvbSBhIFByb3h5LiBPbmx5IG9wZXJhdGlvbnMKICogICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggYW4gYXNzb2NpYXRlZCBtZXNzYWdlIHdpbGwgYmUgcHJveGllZC4KICogQHBhcmFtIHtTdHJpbmd9IFttZXNzYWdlcy5nZXRdCiAqIEBwYXJhbSB7U3RyaW5nfSBbbWVzc2FnZXMuc2V0XQogKiBAcmV0dXJuIHtPYmplY3R9IEEgUHJveHkgaWYgc3VwcG9ydGVkIG9yIHRoZSBgdGFyZ2V0YCBhcmd1bWVudC4KICovCgpleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgdmFyIG1lc3NhZ2VzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07CgogIGlmICh0eXBlb2YgUHJveHkgPT09ICdmdW5jdGlvbicpIHsKICAgIHZhciBfcmV0ID0gKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhhbmRsZXIgPSB7fTsKCiAgICAgIC8vIEJ1aWxkIGEgaGFuZGxlciBvYmplY3QgYmFzZWQgb24gdGhvc2Uga2V5cyB0aGF0IGhhdmUgYm90aCBtZXNzYWdlcwogICAgICAvLyBhbmQgZGVmYXVsdCBiZWhhdmlvcnMuCiAgICAgIE9iamVjdC5rZXlzKG1lc3NhZ2VzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBpZiAoZGVmYXVsdEJlaGF2aW9ycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICBoYW5kbGVyW2tleV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF9sb2dKczJbJ2RlZmF1bHQnXS53YXJuKG1lc3NhZ2VzW2tleV0pOwogICAgICAgICAgICByZXR1cm4gZGVmYXVsdEJlaGF2aW9yc1trZXldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CgogICAgICByZXR1cm4gewogICAgICAgIHY6IG5ldyBQcm94eSh0YXJnZXQsIGhhbmRsZXIpCiAgICAgIH07CiAgICB9KSgpOwoKICAgIGlmICh0eXBlb2YgX3JldCA9PT0gJ29iamVjdCcpIHJldHVybiBfcmV0LnY7CiAgfQogIHJldHVybiB0YXJnZXQ7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuL2xvZy5qcyI6MTMzfV0sMTI4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGRvbS5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKZXhwb3J0cy5nZXRFbCA9IGdldEVsOwpleHBvcnRzLmNyZWF0ZUVsID0gY3JlYXRlRWw7CmV4cG9ydHMudGV4dENvbnRlbnQgPSB0ZXh0Q29udGVudDsKZXhwb3J0cy5pbnNlcnRFbEZpcnN0ID0gaW5zZXJ0RWxGaXJzdDsKZXhwb3J0cy5nZXRFbERhdGEgPSBnZXRFbERhdGE7CmV4cG9ydHMuaGFzRWxEYXRhID0gaGFzRWxEYXRhOwpleHBvcnRzLnJlbW92ZUVsRGF0YSA9IHJlbW92ZUVsRGF0YTsKZXhwb3J0cy5oYXNFbENsYXNzID0gaGFzRWxDbGFzczsKZXhwb3J0cy5hZGRFbENsYXNzID0gYWRkRWxDbGFzczsKZXhwb3J0cy5yZW1vdmVFbENsYXNzID0gcmVtb3ZlRWxDbGFzczsKZXhwb3J0cy50b2dnbGVFbENsYXNzID0gdG9nZ2xlRWxDbGFzczsKZXhwb3J0cy5zZXRFbEF0dHJpYnV0ZXMgPSBzZXRFbEF0dHJpYnV0ZXM7CmV4cG9ydHMuZ2V0RWxBdHRyaWJ1dGVzID0gZ2V0RWxBdHRyaWJ1dGVzOwpleHBvcnRzLmJsb2NrVGV4dFNlbGVjdGlvbiA9IGJsb2NrVGV4dFNlbGVjdGlvbjsKZXhwb3J0cy51bmJsb2NrVGV4dFNlbGVjdGlvbiA9IHVuYmxvY2tUZXh0U2VsZWN0aW9uOwpleHBvcnRzLmZpbmRFbFBvc2l0aW9uID0gZmluZEVsUG9zaXRpb247CmV4cG9ydHMuZ2V0UG9pbnRlclBvc2l0aW9uID0gZ2V0UG9pbnRlclBvc2l0aW9uOwpleHBvcnRzLmlzRWwgPSBpc0VsOwpleHBvcnRzLmlzVGV4dE5vZGUgPSBpc1RleHROb2RlOwpleHBvcnRzLmVtcHR5RWwgPSBlbXB0eUVsOwpleHBvcnRzLm5vcm1hbGl6ZUNvbnRlbnQgPSBub3JtYWxpemVDb250ZW50OwpleHBvcnRzLmFwcGVuZENvbnRlbnQgPSBhcHBlbmRDb250ZW50OwpleHBvcnRzLmluc2VydENvbnRlbnQgPSBpbnNlcnRDb250ZW50OwoKdmFyIF90ZW1wbGF0ZU9iamVjdCA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbJ1NldHRpbmcgYXR0cmlidXRlcyBpbiB0aGUgc2Vjb25kIGFyZ3VtZW50IG9mIGNyZWF0ZUVsKClcbiAgICAgICAgICAgICAgICBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgdGhlIHRoaXJkIGFyZ3VtZW50IGluc3RlYWQuXG4gICAgICAgICAgICAgICAgY3JlYXRlRWwodHlwZSwgcHJvcGVydGllcywgYXR0cmlidXRlcykuIEF0dGVtcHRpbmcgdG8gc2V0ICcsICcgdG8gJywgJy4nXSwgWydTZXR0aW5nIGF0dHJpYnV0ZXMgaW4gdGhlIHNlY29uZCBhcmd1bWVudCBvZiBjcmVhdGVFbCgpXG4gICAgICAgICAgICAgICAgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIHRoZSB0aGlyZCBhcmd1bWVudCBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgIGNyZWF0ZUVsKHR5cGUsIHByb3BlcnRpZXMsIGF0dHJpYnV0ZXMpLiBBdHRlbXB0aW5nIHRvIHNldCAnLCAnIHRvICcsICcuJ10pOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCmZ1bmN0aW9uIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShzdHJpbmdzLCByYXcpIHsgc3RyaW5ncy5yYXcgPSByYXc7IHJldHVybiBzdHJpbmdzOyB9Cgp2YXIgX2dsb2JhbERvY3VtZW50ID0gX2RlcmVxXygnZ2xvYmFsL2RvY3VtZW50Jyk7Cgp2YXIgX2dsb2JhbERvY3VtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbERvY3VtZW50KTsKCnZhciBfZ2xvYmFsV2luZG93ID0gX2RlcmVxXygnZ2xvYmFsL3dpbmRvdycpOwoKdmFyIF9nbG9iYWxXaW5kb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsV2luZG93KTsKCnZhciBfZ3VpZEpzID0gX2RlcmVxXygnLi9ndWlkLmpzJyk7Cgp2YXIgR3VpZCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9ndWlkSnMpOwoKdmFyIF9sb2dKcyA9IF9kZXJlcV8oJy4vbG9nLmpzJyk7Cgp2YXIgX2xvZ0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ0pzKTsKCnZhciBfdHNtbCA9IF9kZXJlcV8oJ3RzbWwnKTsKCnZhciBfdHNtbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90c21sKTsKCi8qKgogKiBEZXRlY3QgaWYgYSB2YWx1ZSBpcyBhIHN0cmluZyB3aXRoIGFueSBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXJzLgogKgogKiBAcGFyYW0gIHtTdHJpbmd9IHN0cgogKiBAcmV0dXJuIHtCb29sZWFufQogKi8KZnVuY3Rpb24gaXNOb25CbGFua1N0cmluZyhzdHIpIHsKICByZXR1cm4gdHlwZW9mIHN0ciA9PT0gJ3N0cmluZycgJiYgL1xTLy50ZXN0KHN0cik7Cn0KCi8qKgogKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHBhc3NlZCBzdHJpbmcgaGFzIHdoaXRlc3BhY2UuIFRoaXMgaXMgdXNlZCBieQogKiBjbGFzcyBtZXRob2RzIHRvIGJlIHJlbGF0aXZlbHkgY29uc2lzdGVudCB3aXRoIHRoZSBjbGFzc0xpc3QgQVBJLgogKgogKiBAcGFyYW0gIHtTdHJpbmd9IHN0cgogKiBAcmV0dXJuIHtCb29sZWFufQogKi8KZnVuY3Rpb24gdGhyb3dJZldoaXRlc3BhY2Uoc3RyKSB7CiAgaWYgKC9ccy8udGVzdChzdHIpKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsYXNzIGhhcyBpbGxlZ2FsIHdoaXRlc3BhY2UgY2hhcmFjdGVycycpOwogIH0KfQoKLyoqCiAqIFByb2R1Y2UgYSByZWd1bGFyIGV4cHJlc3Npb24gZm9yIG1hdGNoaW5nIGEgY2xhc3MgbmFtZS4KICoKICogQHBhcmFtICB7U3RyaW5nfSBjbGFzc05hbWUKICogQHJldHVybiB7UmVnRXhwfQogKi8KZnVuY3Rpb24gY2xhc3NSZWdFeHAoY2xhc3NOYW1lKSB7CiAgcmV0dXJuIG5ldyBSZWdFeHAoJyhefFxccyknICsgY2xhc3NOYW1lICsgJygkfFxccyknKTsKfQoKLyoqCiAqIENyZWF0ZXMgZnVuY3Rpb25zIHRvIHF1ZXJ5IHRoZSBET00gdXNpbmcgYSBnaXZlbiBtZXRob2QuCiAqCiAqIEBmdW5jdGlvbiBjcmVhdGVRdWVyaWVyCiAqIEBwcml2YXRlCiAqIEBwYXJhbSAge1N0cmluZ30gbWV0aG9kCiAqIEByZXR1cm4ge0Z1bmN0aW9ufQogKi8KZnVuY3Rpb24gY3JlYXRlUXVlcmllcihtZXRob2QpIHsKICByZXR1cm4gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICBpZiAoIWlzTm9uQmxhbmtTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgIHJldHVybiBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J11bbWV0aG9kXShudWxsKTsKICAgIH0KICAgIGlmIChpc05vbkJsYW5rU3RyaW5nKGNvbnRleHQpKSB7CiAgICAgIGNvbnRleHQgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10ucXVlcnlTZWxlY3Rvcihjb250ZXh0KTsKICAgIH0KICAgIHJldHVybiAoaXNFbChjb250ZXh0KSA/IGNvbnRleHQgOiBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10pW21ldGhvZF0oc2VsZWN0b3IpOwogIH07Cn0KCi8qKgogKiBTaG9ydGhhbmQgZm9yIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCkKICogQWxzbyBhbGxvd3MgZm9yIENTUyAoalF1ZXJ5KSBJRCBzeW50YXguIEJ1dCBub3RoaW5nIG90aGVyIHRoYW4gSURzLgogKgogKiBAcGFyYW0gIHtTdHJpbmd9IGlkICBFbGVtZW50IElECiAqIEByZXR1cm4ge0VsZW1lbnR9ICAgIEVsZW1lbnQgd2l0aCBzdXBwbGllZCBJRAogKiBAZnVuY3Rpb24gZ2V0RWwKICovCgpmdW5jdGlvbiBnZXRFbChpZCkgewogIGlmIChpZC5pbmRleE9mKCcjJykgPT09IDApIHsKICAgIGlkID0gaWQuc2xpY2UoMSk7CiAgfQoKICByZXR1cm4gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmdldEVsZW1lbnRCeUlkKGlkKTsKfQoKLyoqCiAqIENyZWF0ZXMgYW4gZWxlbWVudCBhbmQgYXBwbGllcyBwcm9wZXJ0aWVzLgogKgogKiBAcGFyYW0gIHtTdHJpbmc9fSB0YWdOYW1lICAgIE5hbWUgb2YgdGFnIHRvIGJlIGNyZWF0ZWQuCiAqIEBwYXJhbSAge09iamVjdD19IHByb3BlcnRpZXMgRWxlbWVudCBwcm9wZXJ0aWVzIHRvIGJlIGFwcGxpZWQuCiAqIEByZXR1cm4ge0VsZW1lbnR9CiAqIEBmdW5jdGlvbiBjcmVhdGVFbAogKi8KCmZ1bmN0aW9uIGNyZWF0ZUVsKCkgewogIHZhciB0YWdOYW1lID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gJ2RpdicgOiBhcmd1bWVudHNbMF07CiAgdmFyIHByb3BlcnRpZXMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTsKICB2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzJdOwoKICB2YXIgZWwgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCh0YWdOYW1lKTsKCiAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMocHJvcGVydGllcykuZm9yRWFjaChmdW5jdGlvbiAocHJvcE5hbWUpIHsKICAgIHZhciB2YWwgPSBwcm9wZXJ0aWVzW3Byb3BOYW1lXTsKCiAgICAvLyBTZWUgIzIxNzYKICAgIC8vIFdlIG9yaWdpbmFsbHkgd2VyZSBhY2NlcHRpbmcgYm90aCBwcm9wZXJ0aWVzIGFuZCBhdHRyaWJ1dGVzIGluIHRoZQogICAgLy8gc2FtZSBvYmplY3QsIGJ1dCB0aGF0IGRvZXNuJ3Qgd29yayBzbyB3ZWxsLgogICAgaWYgKHByb3BOYW1lLmluZGV4T2YoJ2FyaWEtJykgIT09IC0xIHx8IHByb3BOYW1lID09PSAncm9sZScgfHwgcHJvcE5hbWUgPT09ICd0eXBlJykgewogICAgICBfbG9nSnMyWydkZWZhdWx0J10ud2FybihfdHNtbDJbJ2RlZmF1bHQnXShfdGVtcGxhdGVPYmplY3QsIHByb3BOYW1lLCB2YWwpKTsKICAgICAgZWwuc2V0QXR0cmlidXRlKHByb3BOYW1lLCB2YWwpOwogICAgfSBlbHNlIHsKICAgICAgZWxbcHJvcE5hbWVdID0gdmFsOwogICAgfQogIH0pOwoKICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyTmFtZSkgewogICAgdmFyIHZhbCA9IGF0dHJpYnV0ZXNbYXR0ck5hbWVdOwogICAgZWwuc2V0QXR0cmlidXRlKGF0dHJOYW1lLCBhdHRyaWJ1dGVzW2F0dHJOYW1lXSk7CiAgfSk7CgogIHJldHVybiBlbDsKfQoKLyoqCiAqIEluamVjdHMgdGV4dCBpbnRvIGFuIGVsZW1lbnQsIHJlcGxhY2luZyBhbnkgZXhpc3RpbmcgY29udGVudHMgZW50aXJlbHkuCiAqCiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsCiAqIEBwYXJhbSAge1N0cmluZ30gdGV4dAogKiBAcmV0dXJuIHtFbGVtZW50fQogKiBAZnVuY3Rpb24gdGV4dENvbnRlbnQKICovCgpmdW5jdGlvbiB0ZXh0Q29udGVudChlbCwgdGV4dCkgewogIGlmICh0eXBlb2YgZWwudGV4dENvbnRlbnQgPT09ICd1bmRlZmluZWQnKSB7CiAgICBlbC5pbm5lclRleHQgPSB0ZXh0OwogIH0gZWxzZSB7CiAgICBlbC50ZXh0Q29udGVudCA9IHRleHQ7CiAgfQp9CgovKioKICogSW5zZXJ0IGFuIGVsZW1lbnQgYXMgdGhlIGZpcnN0IGNoaWxkIG5vZGUgb2YgYW5vdGhlcgogKgogKiBAcGFyYW0gIHtFbGVtZW50fSBjaGlsZCAgIEVsZW1lbnQgdG8gaW5zZXJ0CiAqIEBwYXJhbSAge0VsZW1lbnR9IHBhcmVudCBFbGVtZW50IHRvIGluc2VydCBjaGlsZCBpbnRvCiAqIEBwcml2YXRlCiAqIEBmdW5jdGlvbiBpbnNlcnRFbEZpcnN0CiAqLwoKZnVuY3Rpb24gaW5zZXJ0RWxGaXJzdChjaGlsZCwgcGFyZW50KSB7CiAgaWYgKHBhcmVudC5maXJzdENoaWxkKSB7CiAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBwYXJlbnQuZmlyc3RDaGlsZCk7CiAgfSBlbHNlIHsKICAgIHBhcmVudC5hcHBlbmRDaGlsZChjaGlsZCk7CiAgfQp9CgovKioKICogRWxlbWVudCBEYXRhIFN0b3JlLiBBbGxvd3MgZm9yIGJpbmRpbmcgZGF0YSB0byBhbiBlbGVtZW50IHdpdGhvdXQgcHV0dGluZyBpdCBkaXJlY3RseSBvbiB0aGUgZWxlbWVudC4KICogRXguIEV2ZW50IGxpc3RlbmVycyBhcmUgc3RvcmVkIGhlcmUuCiAqIChhbHNvIGZyb20ganNuaW5qYS5jb20sIHNsaWdodGx5IG1vZGlmaWVkIGFuZCB1cGRhdGVkIGZvciBjbG9zdXJlIGNvbXBpbGVyKQogKgogKiBAdHlwZSB7T2JqZWN0fQogKiBAcHJpdmF0ZQogKi8KdmFyIGVsRGF0YSA9IHt9OwoKLyoKICogVW5pcXVlIGF0dHJpYnV0ZSBuYW1lIHRvIHN0b3JlIGFuIGVsZW1lbnQncyBndWlkIGluCiAqCiAqIEB0eXBlIHtTdHJpbmd9CiAqIEBjb25zdGFudAogKiBAcHJpdmF0ZQogKi8KdmFyIGVsSWRBdHRyID0gJ3ZkYXRhJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKLyoqCiAqIFJldHVybnMgdGhlIGNhY2hlIG9iamVjdCB3aGVyZSBkYXRhIGZvciBhbiBlbGVtZW50IGlzIHN0b3JlZAogKgogKiBAcGFyYW0gIHtFbGVtZW50fSBlbCBFbGVtZW50IHRvIHN0b3JlIGRhdGEgZm9yLgogKiBAcmV0dXJuIHtPYmplY3R9CiAqIEBmdW5jdGlvbiBnZXRFbERhdGEKICovCgpmdW5jdGlvbiBnZXRFbERhdGEoZWwpIHsKICB2YXIgaWQgPSBlbFtlbElkQXR0cl07CgogIGlmICghaWQpIHsKICAgIGlkID0gZWxbZWxJZEF0dHJdID0gR3VpZC5uZXdHVUlEKCk7CiAgfQoKICBpZiAoIWVsRGF0YVtpZF0pIHsKICAgIGVsRGF0YVtpZF0gPSB7fTsKICB9CgogIHJldHVybiBlbERhdGFbaWRdOwp9CgovKioKICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBhbiBlbGVtZW50IGhhcyBjYWNoZWQgZGF0YQogKgogKiBAcGFyYW0gIHtFbGVtZW50fSBlbCBBIGRvbSBlbGVtZW50CiAqIEByZXR1cm4ge0Jvb2xlYW59CiAqIEBwcml2YXRlCiAqIEBmdW5jdGlvbiBoYXNFbERhdGEKICovCgpmdW5jdGlvbiBoYXNFbERhdGEoZWwpIHsKICB2YXIgaWQgPSBlbFtlbElkQXR0cl07CgogIGlmICghaWQpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiAhIU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGVsRGF0YVtpZF0pLmxlbmd0aDsKfQoKLyoqCiAqIERlbGV0ZSBkYXRhIGZvciB0aGUgZWxlbWVudCBmcm9tIHRoZSBjYWNoZSBhbmQgdGhlIGd1aWQgYXR0ciBmcm9tIGdldEVsZW1lbnRCeUlkCiAqCiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsIFJlbW92ZSBkYXRhIGZvciBhbiBlbGVtZW50CiAqIEBwcml2YXRlCiAqIEBmdW5jdGlvbiByZW1vdmVFbERhdGEKICovCgpmdW5jdGlvbiByZW1vdmVFbERhdGEoZWwpIHsKICB2YXIgaWQgPSBlbFtlbElkQXR0cl07CgogIGlmICghaWQpIHsKICAgIHJldHVybjsKICB9CgogIC8vIFJlbW92ZSBhbGwgc3RvcmVkIGRhdGEKICBkZWxldGUgZWxEYXRhW2lkXTsKCiAgLy8gUmVtb3ZlIHRoZSBlbElkQXR0ciBwcm9wZXJ0eSBmcm9tIHRoZSBET00gbm9kZQogIHRyeSB7CiAgICBkZWxldGUgZWxbZWxJZEF0dHJdOwogIH0gY2F0Y2ggKGUpIHsKICAgIGlmIChlbC5yZW1vdmVBdHRyaWJ1dGUpIHsKICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKGVsSWRBdHRyKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIElFIGRvZXNuJ3QgYXBwZWFyIHRvIHN1cHBvcnQgcmVtb3ZlQXR0cmlidXRlIG9uIHRoZSBkb2N1bWVudCBlbGVtZW50CiAgICAgIGVsW2VsSWRBdHRyXSA9IG51bGw7CiAgICB9CiAgfQp9CgovKioKICogQ2hlY2sgaWYgYW4gZWxlbWVudCBoYXMgYSBDU1MgY2xhc3MKICoKICogQGZ1bmN0aW9uIGhhc0VsQ2xhc3MKICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IEVsZW1lbnQgdG8gY2hlY2sKICogQHBhcmFtIHtTdHJpbmd9IGNsYXNzVG9DaGVjayBDbGFzc25hbWUgdG8gY2hlY2sKICovCgpmdW5jdGlvbiBoYXNFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9DaGVjaykgewogIGlmIChlbGVtZW50LmNsYXNzTGlzdCkgewogICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzVG9DaGVjayk7CiAgfSBlbHNlIHsKICAgIHRocm93SWZXaGl0ZXNwYWNlKGNsYXNzVG9DaGVjayk7CiAgICByZXR1cm4gY2xhc3NSZWdFeHAoY2xhc3NUb0NoZWNrKS50ZXN0KGVsZW1lbnQuY2xhc3NOYW1lKTsKICB9Cn0KCi8qKgogKiBBZGQgYSBDU1MgY2xhc3MgbmFtZSB0byBhbiBlbGVtZW50CiAqCiAqIEBmdW5jdGlvbiBhZGRFbENsYXNzCiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAgICBFbGVtZW50IHRvIGFkZCBjbGFzcyBuYW1lIHRvCiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvQWRkIENsYXNzbmFtZSB0byBhZGQKICovCgpmdW5jdGlvbiBhZGRFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9BZGQpIHsKICBpZiAoZWxlbWVudC5jbGFzc0xpc3QpIHsKICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc1RvQWRkKTsKCiAgICAvLyBEb24ndCBuZWVkIHRvIGB0aHJvd0lmV2hpdGVzcGFjZWAgaGVyZSBiZWNhdXNlIGBoYXNFbENsYXNzYCB3aWxsIGRvIGl0CiAgICAvLyBpbiB0aGUgY2FzZSBvZiBjbGFzc0xpc3Qgbm90IGJlaW5nIHN1cHBvcnRlZC4KICB9IGVsc2UgaWYgKCFoYXNFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9BZGQpKSB7CiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gKGVsZW1lbnQuY2xhc3NOYW1lICsgJyAnICsgY2xhc3NUb0FkZCkudHJpbSgpOwogICAgfQoKICByZXR1cm4gZWxlbWVudDsKfQoKLyoqCiAqIFJlbW92ZSBhIENTUyBjbGFzcyBuYW1lIGZyb20gYW4gZWxlbWVudAogKgogKiBAZnVuY3Rpb24gcmVtb3ZlRWxDbGFzcwogKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgICAgRWxlbWVudCB0byByZW1vdmUgZnJvbSBjbGFzcyBuYW1lCiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvUmVtb3ZlIENsYXNzbmFtZSB0byByZW1vdmUKICovCgpmdW5jdGlvbiByZW1vdmVFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9SZW1vdmUpIHsKICBpZiAoZWxlbWVudC5jbGFzc0xpc3QpIHsKICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc1RvUmVtb3ZlKTsKICB9IGVsc2UgewogICAgdGhyb3dJZldoaXRlc3BhY2UoY2xhc3NUb1JlbW92ZSk7CiAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnNwbGl0KC9ccysvKS5maWx0ZXIoZnVuY3Rpb24gKGMpIHsKICAgICAgcmV0dXJuIGMgIT09IGNsYXNzVG9SZW1vdmU7CiAgICB9KS5qb2luKCcgJyk7CiAgfQoKICByZXR1cm4gZWxlbWVudDsKfQoKLyoqCiAqIEFkZHMgb3IgcmVtb3ZlcyBhIENTUyBjbGFzcyBuYW1lIG9uIGFuIGVsZW1lbnQgZGVwZW5kaW5nIG9uIGFuIG9wdGlvbmFsCiAqIGNvbmRpdGlvbiBvciB0aGUgcHJlc2VuY2UvYWJzZW5jZSBvZiB0aGUgY2xhc3MgbmFtZS4KICoKICogQGZ1bmN0aW9uIHRvZ2dsZUVsQ2xhc3MKICogQHBhcmFtICAgIHtFbGVtZW50fSBlbGVtZW50CiAqIEBwYXJhbSAgICB7U3RyaW5nfSBjbGFzc1RvVG9nZ2xlCiAqIEBwYXJhbSAgICB7Qm9vbGVhbnxGdW5jdGlvbn0gW3ByZWRpY2F0ZV0KICogICAgICAgICAgIENhbiBiZSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIEJvb2xlYW4uIElmIGB0cnVlYCwgdGhlIGNsYXNzCiAqICAgICAgICAgICB3aWxsIGJlIGFkZGVkOyBpZiBgZmFsc2VgLCB0aGUgY2xhc3Mgd2lsbCBiZSByZW1vdmVkLiBJZiBub3QKICogICAgICAgICAgIGdpdmVuLCB0aGUgY2xhc3Mgd2lsbCBiZSBhZGRlZCBpZiBub3QgcHJlc2VudCBhbmQgdmljZSB2ZXJzYS4KICovCgpmdW5jdGlvbiB0b2dnbGVFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9Ub2dnbGUsIHByZWRpY2F0ZSkgewoKICAvLyBUaGlzIENBTk5PVCB1c2UgYGNsYXNzTGlzdGAgaW50ZXJuYWxseSBiZWNhdXNlIElFIGRvZXMgbm90IHN1cHBvcnQgdGhlCiAgLy8gc2Vjb25kIHBhcmFtZXRlciB0byB0aGUgYGNsYXNzTGlzdC50b2dnbGUoKWAgbWV0aG9kISBXaGljaCBpcyBmaW5lIGJlY2F1c2UKICAvLyBgY2xhc3NMaXN0YCB3aWxsIGJlIHVzZWQgYnkgdGhlIGFkZC9yZW1vdmUgZnVuY3Rpb25zLgogIHZhciBoYXMgPSBoYXNFbENsYXNzKGVsZW1lbnQsIGNsYXNzVG9Ub2dnbGUpOwoKICBpZiAodHlwZW9mIHByZWRpY2F0ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgcHJlZGljYXRlID0gcHJlZGljYXRlKGVsZW1lbnQsIGNsYXNzVG9Ub2dnbGUpOwogIH0KCiAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdib29sZWFuJykgewogICAgcHJlZGljYXRlID0gIWhhczsKICB9CgogIC8vIElmIHRoZSBuZWNlc3NhcnkgY2xhc3Mgb3BlcmF0aW9uIG1hdGNoZXMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlCiAgLy8gZWxlbWVudCwgbm8gYWN0aW9uIGlzIHJlcXVpcmVkLgogIGlmIChwcmVkaWNhdGUgPT09IGhhcykgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKHByZWRpY2F0ZSkgewogICAgYWRkRWxDbGFzcyhlbGVtZW50LCBjbGFzc1RvVG9nZ2xlKTsKICB9IGVsc2UgewogICAgcmVtb3ZlRWxDbGFzcyhlbGVtZW50LCBjbGFzc1RvVG9nZ2xlKTsKICB9CgogIHJldHVybiBlbGVtZW50Owp9CgovKioKICogQXBwbHkgYXR0cmlidXRlcyB0byBhbiBIVE1MIGVsZW1lbnQuCiAqCiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsICAgICAgICAgVGFyZ2V0IGVsZW1lbnQuCiAqIEBwYXJhbSAge09iamVjdD19IGF0dHJpYnV0ZXMgRWxlbWVudCBhdHRyaWJ1dGVzIHRvIGJlIGFwcGxpZWQuCiAqIEBwcml2YXRlCiAqIEBmdW5jdGlvbiBzZXRFbEF0dHJpYnV0ZXMKICovCgpmdW5jdGlvbiBzZXRFbEF0dHJpYnV0ZXMoZWwsIGF0dHJpYnV0ZXMpIHsKICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyTmFtZSkgewogICAgdmFyIGF0dHJWYWx1ZSA9IGF0dHJpYnV0ZXNbYXR0ck5hbWVdOwoKICAgIGlmIChhdHRyVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGF0dHJWYWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgYXR0clZhbHVlID09PSBmYWxzZSkgewogICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoYXR0ck5hbWUpOwogICAgfSBlbHNlIHsKICAgICAgZWwuc2V0QXR0cmlidXRlKGF0dHJOYW1lLCBhdHRyVmFsdWUgPT09IHRydWUgPyAnJyA6IGF0dHJWYWx1ZSk7CiAgICB9CiAgfSk7Cn0KCi8qKgogKiBHZXQgYW4gZWxlbWVudCdzIGF0dHJpYnV0ZSB2YWx1ZXMsIGFzIGRlZmluZWQgb24gdGhlIEhUTUwgdGFnCiAqIEF0dHJpYnV0ZXMgYXJlIG5vdCB0aGUgc2FtZSBhcyBwcm9wZXJ0aWVzLiBUaGV5J3JlIGRlZmluZWQgb24gdGhlIHRhZwogKiBvciB3aXRoIHNldEF0dHJpYnV0ZSAod2hpY2ggc2hvdWxkbid0IGJlIHVzZWQgd2l0aCBIVE1MKQogKiBUaGlzIHdpbGwgcmV0dXJuIHRydWUgb3IgZmFsc2UgZm9yIGJvb2xlYW4gYXR0cmlidXRlcy4KICoKICogQHBhcmFtICB7RWxlbWVudH0gdGFnIEVsZW1lbnQgZnJvbSB3aGljaCB0byBnZXQgdGFnIGF0dHJpYnV0ZXMKICogQHJldHVybiB7T2JqZWN0fQogKiBAcHJpdmF0ZQogKiBAZnVuY3Rpb24gZ2V0RWxBdHRyaWJ1dGVzCiAqLwoKZnVuY3Rpb24gZ2V0RWxBdHRyaWJ1dGVzKHRhZykgewogIHZhciBvYmosIGtub3duQm9vbGVhbnMsIGF0dHJzLCBhdHRyTmFtZSwgYXR0clZhbDsKCiAgb2JqID0ge307CgogIC8vIGtub3duIGJvb2xlYW4gYXR0cmlidXRlcwogIC8vIHdlIGNhbiBjaGVjayBmb3IgbWF0Y2hpbmcgYm9vbGVhbiBwcm9wZXJ0aWVzLCBidXQgb2xkZXIgYnJvd3NlcnMKICAvLyB3b24ndCBrbm93IGFib3V0IEhUTUw1IGJvb2xlYW4gYXR0cmlidXRlcyB0aGF0IHdlIHN0aWxsIHJlYWQgZnJvbQogIGtub3duQm9vbGVhbnMgPSAnLCcgKyAnYXV0b3BsYXksY29udHJvbHMsbG9vcCxtdXRlZCxkZWZhdWx0JyArICcsJzsKCiAgaWYgKHRhZyAmJiB0YWcuYXR0cmlidXRlcyAmJiB0YWcuYXR0cmlidXRlcy5sZW5ndGggPiAwKSB7CiAgICBhdHRycyA9IHRhZy5hdHRyaWJ1dGVzOwoKICAgIGZvciAodmFyIGkgPSBhdHRycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICBhdHRyTmFtZSA9IGF0dHJzW2ldLm5hbWU7CiAgICAgIGF0dHJWYWwgPSBhdHRyc1tpXS52YWx1ZTsKCiAgICAgIC8vIGNoZWNrIGZvciBrbm93biBib29sZWFucwogICAgICAvLyB0aGUgbWF0Y2hpbmcgZWxlbWVudCBwcm9wZXJ0eSB3aWxsIHJldHVybiBhIHZhbHVlIGZvciB0eXBlb2YKICAgICAgaWYgKHR5cGVvZiB0YWdbYXR0ck5hbWVdID09PSAnYm9vbGVhbicgfHwga25vd25Cb29sZWFucy5pbmRleE9mKCcsJyArIGF0dHJOYW1lICsgJywnKSAhPT0gLTEpIHsKICAgICAgICAvLyB0aGUgdmFsdWUgb2YgYW4gaW5jbHVkZWQgYm9vbGVhbiBhdHRyaWJ1dGUgaXMgdHlwaWNhbGx5IGFuIGVtcHR5CiAgICAgICAgLy8gc3RyaW5nICgnJykgd2hpY2ggd291bGQgZXF1YWwgZmFsc2UgaWYgd2UganVzdCBjaGVjayBmb3IgYSBmYWxzZSB2YWx1ZS4KICAgICAgICAvLyB3ZSBhbHNvIGRvbid0IHdhbnQgc3VwcG9ydCBiYWQgY29kZSBsaWtlIGF1dG9wbGF5PSdmYWxzZScKICAgICAgICBhdHRyVmFsID0gYXR0clZhbCAhPT0gbnVsbCA/IHRydWUgOiBmYWxzZTsKICAgICAgfQoKICAgICAgb2JqW2F0dHJOYW1lXSA9IGF0dHJWYWw7CiAgICB9CiAgfQoKICByZXR1cm4gb2JqOwp9CgovKioKICogQXR0ZW1wdCB0byBibG9jayB0aGUgYWJpbGl0eSB0byBzZWxlY3QgdGV4dCB3aGlsZSBkcmFnZ2luZyBjb250cm9scwogKgogKiBAcmV0dXJuIHtCb29sZWFufQogKiBAZnVuY3Rpb24gYmxvY2tUZXh0U2VsZWN0aW9uCiAqLwoKZnVuY3Rpb24gYmxvY2tUZXh0U2VsZWN0aW9uKCkgewogIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5ib2R5LmZvY3VzKCk7CiAgX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLm9uc2VsZWN0c3RhcnQgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfTsKfQoKLyoqCiAqIFR1cm4gb2ZmIHRleHQgc2VsZWN0aW9uIGJsb2NraW5nCiAqCiAqIEByZXR1cm4ge0Jvb2xlYW59CiAqIEBmdW5jdGlvbiB1bmJsb2NrVGV4dFNlbGVjdGlvbgogKi8KCmZ1bmN0aW9uIHVuYmxvY2tUZXh0U2VsZWN0aW9uKCkgewogIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRydWU7CiAgfTsKfQoKLyoqCiAqIE9mZnNldCBMZWZ0CiAqIGdldEJvdW5kaW5nQ2xpZW50UmVjdCB0ZWNobmlxdWUgZnJvbQogKiBKb2huIFJlc2lnIGh0dHA6Ly9lam9obi5vcmcvYmxvZy9nZXRib3VuZGluZ2NsaWVudHJlY3QtaXMtYXdlc29tZS8KICoKICogQGZ1bmN0aW9uIGZpbmRFbFBvc2l0aW9uCiAqIEBwYXJhbSB7RWxlbWVudH0gZWwgRWxlbWVudCBmcm9tIHdoaWNoIHRvIGdldCBvZmZzZXQKICogQHJldHVybiB7T2JqZWN0fQogKi8KCmZ1bmN0aW9uIGZpbmRFbFBvc2l0aW9uKGVsKSB7CiAgdmFyIGJveCA9IHVuZGVmaW5lZDsKCiAgaWYgKGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCAmJiBlbC5wYXJlbnROb2RlKSB7CiAgICBib3ggPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICB9CgogIGlmICghYm94KSB7CiAgICByZXR1cm4gewogICAgICBsZWZ0OiAwLAogICAgICB0b3A6IDAKICAgIH07CiAgfQoKICB2YXIgZG9jRWwgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uZG9jdW1lbnRFbGVtZW50OwogIHZhciBib2R5ID0gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmJvZHk7CgogIHZhciBjbGllbnRMZWZ0ID0gZG9jRWwuY2xpZW50TGVmdCB8fCBib2R5LmNsaWVudExlZnQgfHwgMDsKICB2YXIgc2Nyb2xsTGVmdCA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10ucGFnZVhPZmZzZXQgfHwgYm9keS5zY3JvbGxMZWZ0OwogIHZhciBsZWZ0ID0gYm94LmxlZnQgKyBzY3JvbGxMZWZ0IC0gY2xpZW50TGVmdDsKCiAgdmFyIGNsaWVudFRvcCA9IGRvY0VsLmNsaWVudFRvcCB8fCBib2R5LmNsaWVudFRvcCB8fCAwOwogIHZhciBzY3JvbGxUb3AgPSBfZ2xvYmFsV2luZG93MlsnZGVmYXVsdCddLnBhZ2VZT2Zmc2V0IHx8IGJvZHkuc2Nyb2xsVG9wOwogIHZhciB0b3AgPSBib3gudG9wICsgc2Nyb2xsVG9wIC0gY2xpZW50VG9wOwoKICAvLyBBbmRyb2lkIHNvbWV0aW1lcyByZXR1cm5zIHNsaWdodGx5IG9mZiBkZWNpbWFsIHZhbHVlcywgc28gbmVlZCB0byByb3VuZAogIHJldHVybiB7CiAgICBsZWZ0OiBNYXRoLnJvdW5kKGxlZnQpLAogICAgdG9wOiBNYXRoLnJvdW5kKHRvcCkKICB9Owp9CgovKioKICogR2V0IHBvaW50ZXIgcG9zaXRpb24gaW4gZWxlbWVudAogKiBSZXR1cm5zIGFuIG9iamVjdCB3aXRoIHggYW5kIHkgY29vcmRpbmF0ZXMuCiAqIFRoZSBiYXNlIG9uIHRoZSBjb29yZGluYXRlcyBhcmUgdGhlIGJvdHRvbSBsZWZ0IG9mIHRoZSBlbGVtZW50LgogKgogKiBAZnVuY3Rpb24gZ2V0UG9pbnRlclBvc2l0aW9uCiAqIEBwYXJhbSB7RWxlbWVudH0gZWwgRWxlbWVudCBvbiB3aGljaCB0byBnZXQgdGhlIHBvaW50ZXIgcG9zaXRpb24gb24KICogQHBhcmFtIHtFdmVudH0gZXZlbnQgRXZlbnQgb2JqZWN0CiAqIEByZXR1cm4ge09iamVjdH0gVGhpcyBvYmplY3Qgd2lsbCBoYXZlIHggYW5kIHkgY29vcmRpbmF0ZXMgY29ycmVzcG9uZGluZyB0byB0aGUgbW91c2UgcG9zaXRpb24KICovCgpmdW5jdGlvbiBnZXRQb2ludGVyUG9zaXRpb24oZWwsIGV2ZW50KSB7CiAgdmFyIHBvc2l0aW9uID0ge307CiAgdmFyIGJveCA9IGZpbmRFbFBvc2l0aW9uKGVsKTsKICB2YXIgYm94VyA9IGVsLm9mZnNldFdpZHRoOwogIHZhciBib3hIID0gZWwub2Zmc2V0SGVpZ2h0OwoKICB2YXIgYm94WSA9IGJveC50b3A7CiAgdmFyIGJveFggPSBib3gubGVmdDsKICB2YXIgcGFnZVkgPSBldmVudC5wYWdlWTsKICB2YXIgcGFnZVggPSBldmVudC5wYWdlWDsKCiAgaWYgKGV2ZW50LmNoYW5nZWRUb3VjaGVzKSB7CiAgICBwYWdlWCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYOwogICAgcGFnZVkgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWTsKICB9CgogIHBvc2l0aW9uLnkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAoYm94WSAtIHBhZ2VZICsgYm94SCkgLyBib3hIKSk7CiAgcG9zaXRpb24ueCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIChwYWdlWCAtIGJveFgpIC8gYm94VykpOwoKICByZXR1cm4gcG9zaXRpb247Cn0KCi8qKgogKiBEZXRlcm1pbmVzLCB2aWEgZHVjayB0eXBpbmcsIHdoZXRoZXIgb3Igbm90IGEgdmFsdWUgaXMgYSBET00gZWxlbWVudC4KICoKICogQGZ1bmN0aW9uIGlzRWwKICogQHBhcmFtICAgIHtNaXhlZH0gdmFsdWUKICogQHJldHVybiAgIHtCb29sZWFufQogKi8KCmZ1bmN0aW9uIGlzRWwodmFsdWUpIHsKICByZXR1cm4gISF2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlLm5vZGVUeXBlID09PSAxOwp9CgovKioKICogRGV0ZXJtaW5lcywgdmlhIGR1Y2sgdHlwaW5nLCB3aGV0aGVyIG9yIG5vdCBhIHZhbHVlIGlzIGEgdGV4dCBub2RlLgogKgogKiBAcGFyYW0gIHtNaXhlZH0gdmFsdWUKICogQHJldHVybiB7Qm9vbGVhbn0KICovCgpmdW5jdGlvbiBpc1RleHROb2RlKHZhbHVlKSB7CiAgcmV0dXJuICEhdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZS5ub2RlVHlwZSA9PT0gMzsKfQoKLyoqCiAqIEVtcHRpZXMgdGhlIGNvbnRlbnRzIG9mIGFuIGVsZW1lbnQuCiAqCiAqIEBmdW5jdGlvbiBlbXB0eUVsCiAqIEBwYXJhbSAgICB7RWxlbWVudH0gZWwKICogQHJldHVybiAgIHtFbGVtZW50fQogKi8KCmZ1bmN0aW9uIGVtcHR5RWwoZWwpIHsKICB3aGlsZSAoZWwuZmlyc3RDaGlsZCkgewogICAgZWwucmVtb3ZlQ2hpbGQoZWwuZmlyc3RDaGlsZCk7CiAgfQogIHJldHVybiBlbDsKfQoKLyoqCiAqIE5vcm1hbGl6ZXMgY29udGVudCBmb3IgZXZlbnR1YWwgaW5zZXJ0aW9uIGludG8gdGhlIERPTS4KICoKICogVGhpcyBhbGxvd3MgYSB3aWRlIHJhbmdlIG9mIGNvbnRlbnQgZGVmaW5pdGlvbiBtZXRob2RzLCBidXQgcHJvdGVjdHMKICogZnJvbSBmYWxsaW5nIGludG8gdGhlIHRyYXAgb2Ygc2ltcGx5IHdyaXRpbmcgdG8gYGlubmVySFRNTGAsIHdoaWNoIGlzCiAqIGFuIFhTUyBjb25jZXJuLgogKgogKiBUaGUgY29udGVudCBmb3IgYW4gZWxlbWVudCBjYW4gYmUgcGFzc2VkIGluIG11bHRpcGxlIHR5cGVzIGFuZAogKiBjb21iaW5hdGlvbnMsIHdob3NlIGJlaGF2aW9yIGlzIGFzIGZvbGxvd3M6CiAqCiAqIC0gU3RyaW5nCiAqICAgTm9ybWFsaXplZCBpbnRvIGEgdGV4dCBub2RlLgogKgogKiAtIEVsZW1lbnQsIFRleHROb2RlCiAqICAgUGFzc2VkIHRocm91Z2guCiAqCiAqIC0gQXJyYXkKICogICBBIG9uZS1kaW1lbnNpb25hbCBhcnJheSBvZiBzdHJpbmdzLCBlbGVtZW50cywgbm9kZXMsIG9yIGZ1bmN0aW9ucyAod2hpY2gKICogICByZXR1cm4gc2luZ2xlIHN0cmluZ3MsIGVsZW1lbnRzLCBvciBub2RlcykuCiAqCiAqIC0gRnVuY3Rpb24KICogICBJZiB0aGUgc29sZSBhcmd1bWVudCwgaXMgZXhwZWN0ZWQgdG8gcHJvZHVjZSBhIHN0cmluZywgZWxlbWVudCwKICogICBub2RlLCBvciBhcnJheS4KICoKICogQGZ1bmN0aW9uIG5vcm1hbGl6ZUNvbnRlbnQKICogQHBhcmFtICAgIHtTdHJpbmd8RWxlbWVudHxUZXh0Tm9kZXxBcnJheXxGdW5jdGlvbn0gY29udGVudAogKiBAcmV0dXJuICAge0FycmF5fQogKi8KCmZ1bmN0aW9uIG5vcm1hbGl6ZUNvbnRlbnQoY29udGVudCkgewoKICAvLyBGaXJzdCwgaW52b2tlIGNvbnRlbnQgaWYgaXQgaXMgYSBmdW5jdGlvbi4gSWYgaXQgcHJvZHVjZXMgYW4gYXJyYXksCiAgLy8gdGhhdCBuZWVkcyB0byBoYXBwZW4gYmVmb3JlIG5vcm1hbGl6YXRpb24uCiAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICBjb250ZW50ID0gY29udGVudCgpOwogIH0KCiAgLy8gTmV4dCB1cCwgbm9ybWFsaXplIHRvIGFuIGFycmF5LCBzbyBvbmUgb3IgbWFueSBpdGVtcyBjYW4gYmUgbm9ybWFsaXplZCwKICAvLyBmaWx0ZXJlZCwgYW5kIHJldHVybmVkLgogIHJldHVybiAoQXJyYXkuaXNBcnJheShjb250ZW50KSA/IGNvbnRlbnQgOiBbY29udGVudF0pLm1hcChmdW5jdGlvbiAodmFsdWUpIHsKCiAgICAvLyBGaXJzdCwgaW52b2tlIHZhbHVlIGlmIGl0IGlzIGEgZnVuY3Rpb24gdG8gcHJvZHVjZSBhIG5ldyB2YWx1ZSwKICAgIC8vIHdoaWNoIHdpbGwgYmUgc3Vic2VxdWVudGx5IG5vcm1hbGl6ZWQgdG8gYSBOb2RlIG9mIHNvbWUga2luZC4KICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgdmFsdWUgPSB2YWx1ZSgpOwogICAgfQoKICAgIGlmIChpc0VsKHZhbHVlKSB8fCBpc1RleHROb2RlKHZhbHVlKSkgewogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgL1xTLy50ZXN0KHZhbHVlKSkgewogICAgICByZXR1cm4gX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmNyZWF0ZVRleHROb2RlKHZhbHVlKTsKICAgIH0KICB9KS5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfSk7Cn0KCi8qKgogKiBOb3JtYWxpemVzIGFuZCBhcHBlbmRzIGNvbnRlbnQgdG8gYW4gZWxlbWVudC4KICoKICogQGZ1bmN0aW9uIGFwcGVuZENvbnRlbnQKICogQHBhcmFtICAgIHtFbGVtZW50fSBlbAogKiBAcGFyYW0gICAge1N0cmluZ3xFbGVtZW50fFRleHROb2RlfEFycmF5fEZ1bmN0aW9ufSBjb250ZW50CiAqICAgICAgICAgICBTZWU6IGBub3JtYWxpemVDb250ZW50YAogKiBAcmV0dXJuICAge0VsZW1lbnR9CiAqLwoKZnVuY3Rpb24gYXBwZW5kQ29udGVudChlbCwgY29udGVudCkgewogIG5vcm1hbGl6ZUNvbnRlbnQoY29udGVudCkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkgewogICAgcmV0dXJuIGVsLmFwcGVuZENoaWxkKG5vZGUpOwogIH0pOwogIHJldHVybiBlbDsKfQoKLyoqCiAqIE5vcm1hbGl6ZXMgYW5kIGluc2VydHMgY29udGVudCBpbnRvIGFuIGVsZW1lbnQ7IHRoaXMgaXMgaWRlbnRpY2FsIHRvCiAqIGBhcHBlbmRDb250ZW50KClgLCBleGNlcHQgaXQgZW1wdGllcyB0aGUgZWxlbWVudCBmaXJzdC4KICoKICogQGZ1bmN0aW9uIGluc2VydENvbnRlbnQKICogQHBhcmFtICAgIHtFbGVtZW50fSBlbAogKiBAcGFyYW0gICAge1N0cmluZ3xFbGVtZW50fFRleHROb2RlfEFycmF5fEZ1bmN0aW9ufSBjb250ZW50CiAqICAgICAgICAgICBTZWU6IGBub3JtYWxpemVDb250ZW50YAogKiBAcmV0dXJuICAge0VsZW1lbnR9CiAqLwoKZnVuY3Rpb24gaW5zZXJ0Q29udGVudChlbCwgY29udGVudCkgewogIHJldHVybiBhcHBlbmRDb250ZW50KGVtcHR5RWwoZWwpLCBjb250ZW50KTsKfQoKLyoqCiAqIEZpbmRzIGEgc2luZ2xlIERPTSBlbGVtZW50IG1hdGNoaW5nIGBzZWxlY3RvcmAgd2l0aGluIHRoZSBvcHRpb25hbAogKiBgY29udGV4dGAgb2YgYW5vdGhlciBET00gZWxlbWVudCAoZGVmYXVsdGluZyB0byBgZG9jdW1lbnRgKS4KICoKICogQGZ1bmN0aW9uICQKICogQHBhcmFtICAgIHtTdHJpbmd9IHNlbGVjdG9yCiAqICAgICAgICAgICBBIHZhbGlkIENTUyBzZWxlY3Rvciwgd2hpY2ggd2lsbCBiZSBwYXNzZWQgdG8gYHF1ZXJ5U2VsZWN0b3JgLgogKgogKiBAcGFyYW0gICAge0VsZW1lbnR8U3RyaW5nfSBbY29udGV4dD1kb2N1bWVudF0KICogICAgICAgICAgIEEgRE9NIGVsZW1lbnQgd2l0aGluIHdoaWNoIHRvIHF1ZXJ5LiBDYW4gYWxzbyBiZSBhIHNlbGVjdG9yCiAqICAgICAgICAgICBzdHJpbmcgaW4gd2hpY2ggY2FzZSB0aGUgZmlyc3QgbWF0Y2hpbmcgZWxlbWVudCB3aWxsIGJlIHVzZWQKICogICAgICAgICAgIGFzIGNvbnRleHQuIElmIG1pc3NpbmcgKG9yIG5vIGVsZW1lbnQgbWF0Y2hlcyBzZWxlY3RvciksIGZhbGxzCiAqICAgICAgICAgICBiYWNrIHRvIGBkb2N1bWVudGAuCiAqCiAqIEByZXR1cm4gICB7RWxlbWVudHxudWxsfQogKi8KdmFyICQgPSBjcmVhdGVRdWVyaWVyKCdxdWVyeVNlbGVjdG9yJyk7CgpleHBvcnRzLiQgPSAkOwovKioKICogRmluZHMgYSBhbGwgRE9NIGVsZW1lbnRzIG1hdGNoaW5nIGBzZWxlY3RvcmAgd2l0aGluIHRoZSBvcHRpb25hbAogKiBgY29udGV4dGAgb2YgYW5vdGhlciBET00gZWxlbWVudCAoZGVmYXVsdGluZyB0byBgZG9jdW1lbnRgKS4KICoKICogQGZ1bmN0aW9uICQkCiAqIEBwYXJhbSAgICB7U3RyaW5nfSBzZWxlY3RvcgogKiAgICAgICAgICAgQSB2YWxpZCBDU1Mgc2VsZWN0b3IsIHdoaWNoIHdpbGwgYmUgcGFzc2VkIHRvIGBxdWVyeVNlbGVjdG9yQWxsYC4KICoKICogQHBhcmFtICAgIHtFbGVtZW50fFN0cmluZ30gW2NvbnRleHQ9ZG9jdW1lbnRdCiAqICAgICAgICAgICBBIERPTSBlbGVtZW50IHdpdGhpbiB3aGljaCB0byBxdWVyeS4gQ2FuIGFsc28gYmUgYSBzZWxlY3RvcgogKiAgICAgICAgICAgc3RyaW5nIGluIHdoaWNoIGNhc2UgdGhlIGZpcnN0IG1hdGNoaW5nIGVsZW1lbnQgd2lsbCBiZSB1c2VkCiAqICAgICAgICAgICBhcyBjb250ZXh0LiBJZiBtaXNzaW5nIChvciBubyBlbGVtZW50IG1hdGNoZXMgc2VsZWN0b3IpLCBmYWxscwogKiAgICAgICAgICAgYmFjayB0byBgZG9jdW1lbnRgLgogKgogKiBAcmV0dXJuICAge05vZGVMaXN0fQogKi8KdmFyICQkID0gY3JlYXRlUXVlcmllcigncXVlcnlTZWxlY3RvckFsbCcpOwpleHBvcnRzLiQkID0gJCQ7Cgp9LHsiLi9ndWlkLmpzIjoxMzIsIi4vbG9nLmpzIjoxMzMsImdsb2JhbC9kb2N1bWVudCI6MSwiZ2xvYmFsL3dpbmRvdyI6MiwidHNtbCI6NTR9XSwxMjk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgZXZlbnRzLmpzCiAqCiAqIEV2ZW50IFN5c3RlbSAoSm9obiBSZXNpZyAtIFNlY3JldHMgb2YgYSBKUyBOaW5qYSBodHRwOi8vanNuaW5qYS5jb20vKQogKiAoT3JpZ2luYWwgYm9vayB2ZXJzaW9uIHdhc24ndCBjb21wbGV0ZWx5IHVzYWJsZSwgc28gZml4ZWQgc29tZSB0aGluZ3MgYW5kIG1hZGUgQ2xvc3VyZSBDb21waWxlciBjb21wYXRpYmxlKQogKiBUaGlzIHNob3VsZCB3b3JrIHZlcnkgc2ltaWxhcmx5IHRvIGpRdWVyeSdzIGV2ZW50cywgaG93ZXZlciBpdCdzIGJhc2VkIG9mZiB0aGUgYm9vayB2ZXJzaW9uIHdoaWNoIGlzbid0IGFzCiAqIHJvYnVzdCBhcyBqcXVlcnkncywgc28gdGhlcmUncyBwcm9iYWJseSBzb21lIGRpZmZlcmVuY2VzLgogKi8KCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CmV4cG9ydHMub24gPSBvbjsKZXhwb3J0cy5vZmYgPSBvZmY7CmV4cG9ydHMudHJpZ2dlciA9IHRyaWdnZXI7CmV4cG9ydHMub25lID0gb25lOwpleHBvcnRzLmZpeEV2ZW50ID0gZml4RXZlbnQ7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKdmFyIF9kb21KcyA9IF9kZXJlcV8oJy4vZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2RvbUpzKTsKCnZhciBfZ3VpZEpzID0gX2RlcmVxXygnLi9ndWlkLmpzJyk7Cgp2YXIgR3VpZCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9ndWlkSnMpOwoKdmFyIF9nbG9iYWxXaW5kb3cgPSBfZGVyZXFfKCdnbG9iYWwvd2luZG93Jyk7Cgp2YXIgX2dsb2JhbFdpbmRvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxXaW5kb3cpOwoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7CgovKioKICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyIHRvIGVsZW1lbnQKICogSXQgc3RvcmVzIHRoZSBoYW5kbGVyIGZ1bmN0aW9uIGluIGEgc2VwYXJhdGUgY2FjaGUgb2JqZWN0CiAqIGFuZCBhZGRzIGEgZ2VuZXJpYyBoYW5kbGVyIHRvIHRoZSBlbGVtZW50J3MgZXZlbnQsCiAqIGFsb25nIHdpdGggYSB1bmlxdWUgaWQgKGd1aWQpIHRvIHRoZSBlbGVtZW50LgogKgogKiBAcGFyYW0gIHtFbGVtZW50fE9iamVjdH0gICBlbGVtIEVsZW1lbnQgb3Igb2JqZWN0IHRvIGJpbmQgbGlzdGVuZXJzIHRvCiAqIEBwYXJhbSAge1N0cmluZ3xBcnJheX0gICB0eXBlIFR5cGUgb2YgZXZlbnQgdG8gYmluZCB0by4KICogQHBhcmFtICB7RnVuY3Rpb259IGZuICAgRXZlbnQgbGlzdGVuZXIuCiAqIEBtZXRob2Qgb24KICovCgpmdW5jdGlvbiBvbihlbGVtLCB0eXBlLCBmbikgewogIGlmIChBcnJheS5pc0FycmF5KHR5cGUpKSB7CiAgICByZXR1cm4gX2hhbmRsZU11bHRpcGxlRXZlbnRzKG9uLCBlbGVtLCB0eXBlLCBmbik7CiAgfQoKICB2YXIgZGF0YSA9IERvbS5nZXRFbERhdGEoZWxlbSk7CgogIC8vIFdlIG5lZWQgYSBwbGFjZSB0byBzdG9yZSBhbGwgb3VyIGhhbmRsZXIgZGF0YQogIGlmICghZGF0YS5oYW5kbGVycykgZGF0YS5oYW5kbGVycyA9IHt9OwoKICBpZiAoIWRhdGEuaGFuZGxlcnNbdHlwZV0pIGRhdGEuaGFuZGxlcnNbdHlwZV0gPSBbXTsKCiAgaWYgKCFmbi5ndWlkKSBmbi5ndWlkID0gR3VpZC5uZXdHVUlEKCk7CgogIGRhdGEuaGFuZGxlcnNbdHlwZV0ucHVzaChmbik7CgogIGlmICghZGF0YS5kaXNwYXRjaGVyKSB7CiAgICBkYXRhLmRpc2FibGVkID0gZmFsc2U7CgogICAgZGF0YS5kaXNwYXRjaGVyID0gZnVuY3Rpb24gKGV2ZW50LCBoYXNoKSB7CgogICAgICBpZiAoZGF0YS5kaXNhYmxlZCkgcmV0dXJuOwogICAgICBldmVudCA9IGZpeEV2ZW50KGV2ZW50KTsKCiAgICAgIHZhciBoYW5kbGVycyA9IGRhdGEuaGFuZGxlcnNbZXZlbnQudHlwZV07CgogICAgICBpZiAoaGFuZGxlcnMpIHsKICAgICAgICAvLyBDb3B5IGhhbmRsZXJzIHNvIGlmIGhhbmRsZXJzIGFyZSBhZGRlZC9yZW1vdmVkIGR1cmluZyB0aGUgcHJvY2VzcyBpdCBkb2Vzbid0IHRocm93IGV2ZXJ5dGhpbmcgb2ZmLgogICAgICAgIHZhciBoYW5kbGVyc0NvcHkgPSBoYW5kbGVycy5zbGljZSgwKTsKCiAgICAgICAgZm9yICh2YXIgbSA9IDAsIG4gPSBoYW5kbGVyc0NvcHkubGVuZ3RoOyBtIDwgbjsgbSsrKSB7CiAgICAgICAgICBpZiAoZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhhbmRsZXJzQ29weVttXS5jYWxsKGVsZW0sIGV2ZW50LCBoYXNoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICBpZiAoZGF0YS5oYW5kbGVyc1t0eXBlXS5sZW5ndGggPT09IDEpIHsKICAgIGlmIChlbGVtLmFkZEV2ZW50TGlzdGVuZXIpIHsKICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGRhdGEuZGlzcGF0Y2hlciwgZmFsc2UpOwogICAgfSBlbHNlIGlmIChlbGVtLmF0dGFjaEV2ZW50KSB7CiAgICAgIGVsZW0uYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGRhdGEuZGlzcGF0Y2hlcik7CiAgICB9CiAgfQp9CgovKioKICogUmVtb3ZlcyBldmVudCBsaXN0ZW5lcnMgZnJvbSBhbiBlbGVtZW50CiAqCiAqIEBwYXJhbSAge0VsZW1lbnR8T2JqZWN0fSAgIGVsZW0gT2JqZWN0IHRvIHJlbW92ZSBsaXN0ZW5lcnMgZnJvbQogKiBAcGFyYW0gIHtTdHJpbmd8QXJyYXk9fSAgIHR5cGUgVHlwZSBvZiBsaXN0ZW5lciB0byByZW1vdmUuIERvbid0IGluY2x1ZGUgdG8gcmVtb3ZlIGFsbCBldmVudHMgZnJvbSBlbGVtZW50LgogKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gICBTcGVjaWZpYyBsaXN0ZW5lciB0byByZW1vdmUuIERvbid0IGluY2x1ZGUgdG8gcmVtb3ZlIGxpc3RlbmVycyBmb3IgYW4gZXZlbnQgdHlwZS4KICogQG1ldGhvZCBvZmYKICovCgpmdW5jdGlvbiBvZmYoZWxlbSwgdHlwZSwgZm4pIHsKICAvLyBEb24ndCB3YW50IHRvIGFkZCBhIGNhY2hlIG9iamVjdCB0aHJvdWdoIGdldEVsRGF0YSBpZiBub3QgbmVlZGVkCiAgaWYgKCFEb20uaGFzRWxEYXRhKGVsZW0pKSByZXR1cm47CgogIHZhciBkYXRhID0gRG9tLmdldEVsRGF0YShlbGVtKTsKCiAgLy8gSWYgbm8gZXZlbnRzIGV4aXN0LCBub3RoaW5nIHRvIHVuYmluZAogIGlmICghZGF0YS5oYW5kbGVycykgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkodHlwZSkpIHsKICAgIHJldHVybiBfaGFuZGxlTXVsdGlwbGVFdmVudHMob2ZmLCBlbGVtLCB0eXBlLCBmbik7CiAgfQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uCiAgdmFyIHJlbW92ZVR5cGUgPSBmdW5jdGlvbiByZW1vdmVUeXBlKHQpIHsKICAgIGRhdGEuaGFuZGxlcnNbdF0gPSBbXTsKICAgIF9jbGVhblVwRXZlbnRzKGVsZW0sIHQpOwogIH07CgogIC8vIEFyZSB3ZSByZW1vdmluZyBhbGwgYm91bmQgZXZlbnRzPwogIGlmICghdHlwZSkgewogICAgZm9yICh2YXIgdCBpbiBkYXRhLmhhbmRsZXJzKSB7CiAgICAgIHJlbW92ZVR5cGUodCk7CiAgICB9cmV0dXJuOwogIH0KCiAgdmFyIGhhbmRsZXJzID0gZGF0YS5oYW5kbGVyc1t0eXBlXTsKCiAgLy8gSWYgbm8gaGFuZGxlcnMgZXhpc3QsIG5vdGhpbmcgdG8gdW5iaW5kCiAgaWYgKCFoYW5kbGVycykgcmV0dXJuOwoKICAvLyBJZiBubyBsaXN0ZW5lciB3YXMgcHJvdmlkZWQsIHJlbW92ZSBhbGwgbGlzdGVuZXJzIGZvciB0eXBlCiAgaWYgKCFmbikgewogICAgcmVtb3ZlVHlwZSh0eXBlKTsKICAgIHJldHVybjsKICB9CgogIC8vIFdlJ3JlIG9ubHkgcmVtb3ZpbmcgYSBzaW5nbGUgaGFuZGxlcgogIGlmIChmbi5ndWlkKSB7CiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGhhbmRsZXJzLmxlbmd0aDsgbisrKSB7CiAgICAgIGlmIChoYW5kbGVyc1tuXS5ndWlkID09PSBmbi5ndWlkKSB7CiAgICAgICAgaGFuZGxlcnMuc3BsaWNlKG4tLSwgMSk7CiAgICAgIH0KICAgIH0KICB9CgogIF9jbGVhblVwRXZlbnRzKGVsZW0sIHR5cGUpOwp9CgovKioKICogVHJpZ2dlciBhbiBldmVudCBmb3IgYW4gZWxlbWVudAogKgogKiBAcGFyYW0gIHtFbGVtZW50fE9iamVjdH0gICAgICBlbGVtICBFbGVtZW50IHRvIHRyaWdnZXIgYW4gZXZlbnQgb24KICogQHBhcmFtICB7RXZlbnR8T2JqZWN0fFN0cmluZ30gZXZlbnQgQSBzdHJpbmcgKHRoZSB0eXBlKSBvciBhbiBldmVudCBvYmplY3Qgd2l0aCBhIHR5cGUgYXR0cmlidXRlCiAqIEBwYXJhbSAge09iamVjdH0gW2hhc2hdIGRhdGEgaGFzaCB0byBwYXNzIGFsb25nIHdpdGggdGhlIGV2ZW50CiAqIEByZXR1cm4ge0Jvb2xlYW49fSBSZXR1cm5lZCBvbmx5IGlmIGRlZmF1bHQgd2FzIHByZXZlbnRlZAogKiBAbWV0aG9kIHRyaWdnZXIKICovCgpmdW5jdGlvbiB0cmlnZ2VyKGVsZW0sIGV2ZW50LCBoYXNoKSB7CiAgLy8gRmV0Y2hlcyBlbGVtZW50IGRhdGEgYW5kIGEgcmVmZXJlbmNlIHRvIHRoZSBwYXJlbnQgKGZvciBidWJibGluZykuCiAgLy8gRG9uJ3Qgd2FudCB0byBhZGQgYSBkYXRhIG9iamVjdCB0byBjYWNoZSBmb3IgZXZlcnkgcGFyZW50LAogIC8vIHNvIGNoZWNraW5nIGhhc0VsRGF0YSBmaXJzdC4KICB2YXIgZWxlbURhdGEgPSBEb20uaGFzRWxEYXRhKGVsZW0pID8gRG9tLmdldEVsRGF0YShlbGVtKSA6IHt9OwogIHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGUgfHwgZWxlbS5vd25lckRvY3VtZW50OwogIC8vIHR5cGUgPSBldmVudC50eXBlIHx8IGV2ZW50LAogIC8vIGhhbmRsZXI7CgogIC8vIElmIGFuIGV2ZW50IG5hbWUgd2FzIHBhc3NlZCBhcyBhIHN0cmluZywgY3JlYXRlcyBhbiBldmVudCBvdXQgb2YgaXQKICBpZiAodHlwZW9mIGV2ZW50ID09PSAnc3RyaW5nJykgewogICAgZXZlbnQgPSB7IHR5cGU6IGV2ZW50LCB0YXJnZXQ6IGVsZW0gfTsKICB9CiAgLy8gTm9ybWFsaXplcyB0aGUgZXZlbnQgcHJvcGVydGllcy4KICBldmVudCA9IGZpeEV2ZW50KGV2ZW50KTsKCiAgLy8gSWYgdGhlIHBhc3NlZCBlbGVtZW50IGhhcyBhIGRpc3BhdGNoZXIsIGV4ZWN1dGVzIHRoZSBlc3RhYmxpc2hlZCBoYW5kbGVycy4KICBpZiAoZWxlbURhdGEuZGlzcGF0Y2hlcikgewogICAgZWxlbURhdGEuZGlzcGF0Y2hlci5jYWxsKGVsZW0sIGV2ZW50LCBoYXNoKTsKICB9CgogIC8vIFVubGVzcyBleHBsaWNpdGx5IHN0b3BwZWQgb3IgdGhlIGV2ZW50IGRvZXMgbm90IGJ1YmJsZSAoZS5nLiBtZWRpYSBldmVudHMpCiAgLy8gcmVjdXJzaXZlbHkgY2FsbHMgdGhpcyBmdW5jdGlvbiB0byBidWJibGUgdGhlIGV2ZW50IHVwIHRoZSBET00uCiAgaWYgKHBhcmVudCAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSAmJiBldmVudC5idWJibGVzID09PSB0cnVlKSB7CiAgICB0cmlnZ2VyLmNhbGwobnVsbCwgcGFyZW50LCBldmVudCwgaGFzaCk7CgogICAgLy8gSWYgYXQgdGhlIHRvcCBvZiB0aGUgRE9NLCB0cmlnZ2VycyB0aGUgZGVmYXVsdCBhY3Rpb24gdW5sZXNzIGRpc2FibGVkLgogIH0gZWxzZSBpZiAoIXBhcmVudCAmJiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgewogICAgICB2YXIgdGFyZ2V0RGF0YSA9IERvbS5nZXRFbERhdGEoZXZlbnQudGFyZ2V0KTsKCiAgICAgIC8vIENoZWNrcyBpZiB0aGUgdGFyZ2V0IGhhcyBhIGRlZmF1bHQgYWN0aW9uIGZvciB0aGlzIGV2ZW50LgogICAgICBpZiAoZXZlbnQudGFyZ2V0W2V2ZW50LnR5cGVdKSB7CiAgICAgICAgLy8gVGVtcG9yYXJpbHkgZGlzYWJsZXMgZXZlbnQgZGlzcGF0Y2hpbmcgb24gdGhlIHRhcmdldCBhcyB3ZSBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgdGhlIGhhbmRsZXIuCiAgICAgICAgdGFyZ2V0RGF0YS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgLy8gRXhlY3V0ZXMgdGhlIGRlZmF1bHQgYWN0aW9uLgogICAgICAgIGlmICh0eXBlb2YgZXZlbnQudGFyZ2V0W2V2ZW50LnR5cGVdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICBldmVudC50YXJnZXRbZXZlbnQudHlwZV0oKTsKICAgICAgICB9CiAgICAgICAgLy8gUmUtZW5hYmxlcyBldmVudCBkaXNwYXRjaGluZy4KICAgICAgICB0YXJnZXREYXRhLmRpc2FibGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgLy8gSW5mb3JtIHRoZSB0cmlnZ2VyZXIgaWYgdGhlIGRlZmF1bHQgd2FzIHByZXZlbnRlZCBieSByZXR1cm5pbmcgZmFsc2UKICByZXR1cm4gIWV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQ7Cn0KCi8qKgogKiBUcmlnZ2VyIGEgbGlzdGVuZXIgb25seSBvbmNlIGZvciBhbiBldmVudAogKgogKiBAcGFyYW0gIHtFbGVtZW50fE9iamVjdH0gICBlbGVtIEVsZW1lbnQgb3Igb2JqZWN0IHRvCiAqIEBwYXJhbSAge1N0cmluZ3xBcnJheX0gICB0eXBlIE5hbWUvdHlwZSBvZiBldmVudAogKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gRXZlbnQgaGFuZGxlciBmdW5jdGlvbgogKiBAbWV0aG9kIG9uZQogKi8KCmZ1bmN0aW9uIG9uZShlbGVtLCB0eXBlLCBmbikgewogIGlmIChBcnJheS5pc0FycmF5KHR5cGUpKSB7CiAgICByZXR1cm4gX2hhbmRsZU11bHRpcGxlRXZlbnRzKG9uZSwgZWxlbSwgdHlwZSwgZm4pOwogIH0KICB2YXIgZnVuYyA9IGZ1bmN0aW9uIGZ1bmMoKSB7CiAgICBvZmYoZWxlbSwgdHlwZSwgZnVuYyk7CiAgICBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07CiAgLy8gY29weSB0aGUgZ3VpZCB0byB0aGUgbmV3IGZ1bmN0aW9uIHNvIGl0IGNhbiByZW1vdmVkIHVzaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbidzIElECiAgZnVuYy5ndWlkID0gZm4uZ3VpZCA9IGZuLmd1aWQgfHwgR3VpZC5uZXdHVUlEKCk7CiAgb24oZWxlbSwgdHlwZSwgZnVuYyk7Cn0KCi8qKgogKiBGaXggYSBuYXRpdmUgZXZlbnQgdG8gaGF2ZSBzdGFuZGFyZCBwcm9wZXJ0eSB2YWx1ZXMKICoKICogQHBhcmFtICB7T2JqZWN0fSBldmVudCBFdmVudCBvYmplY3QgdG8gZml4CiAqIEByZXR1cm4ge09iamVjdH0KICogQHByaXZhdGUKICogQG1ldGhvZCBmaXhFdmVudAogKi8KCmZ1bmN0aW9uIGZpeEV2ZW50KGV2ZW50KSB7CgogIGZ1bmN0aW9uIHJldHVyblRydWUoKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBUZXN0IGlmIGZpeGluZyB1cCBpcyBuZWVkZWQKICAvLyBVc2VkIHRvIGNoZWNrIGlmICFldmVudC5zdG9wUHJvcGFnYXRpb24gaW5zdGVhZCBvZiBpc1Byb3BhZ2F0aW9uU3RvcHBlZAogIC8vIEJ1dCBuYXRpdmUgZXZlbnRzIHJldHVybiB0cnVlIGZvciBzdG9wUHJvcGFnYXRpb24sIGJ1dCBkb24ndCBoYXZlCiAgLy8gb3RoZXIgZXhwZWN0ZWQgbWV0aG9kcyBsaWtlIGlzUHJvcGFnYXRpb25TdG9wcGVkLiBTZWVtcyB0byBiZSBhIHByb2JsZW0KICAvLyB3aXRoIHRoZSBKYXZhc2NyaXB0IE5pbmphIGNvZGUuIFNvIHdlJ3JlIGp1c3Qgb3ZlcnJpZGluZyBhbGwgZXZlbnRzIG5vdy4KICBpZiAoIWV2ZW50IHx8ICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCkgewogICAgdmFyIG9sZCA9IGV2ZW50IHx8IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10uZXZlbnQ7CgogICAgZXZlbnQgPSB7fTsKICAgIC8vIENsb25lIHRoZSBvbGQgb2JqZWN0IHNvIHRoYXQgd2UgY2FuIG1vZGlmeSB0aGUgdmFsdWVzIGV2ZW50ID0ge307CiAgICAvLyBJRTggRG9lc24ndCBsaWtlIHdoZW4geW91IG1lc3Mgd2l0aCBuYXRpdmUgZXZlbnQgcHJvcGVydGllcwogICAgLy8gRmlyZWZveCByZXR1cm5zIGZhbHNlIGZvciBldmVudC5oYXNPd25Qcm9wZXJ0eSgndHlwZScpIGFuZCBvdGhlciBwcm9wcwogICAgLy8gIHdoaWNoIG1ha2VzIGNvcHlpbmcgbW9yZSBkaWZmaWN1bHQuCiAgICAvLyBUT0RPOiBQcm9iYWJseSBiZXN0IHRvIGNyZWF0ZSBhIHdoaXRlbGlzdCBvZiBldmVudCBwcm9wcwogICAgZm9yICh2YXIga2V5IGluIG9sZCkgewogICAgICAvLyBTYWZhcmkgNi4wLjMgd2FybnMgeW91IGlmIHlvdSB0cnkgdG8gY29weSBkZXByZWNhdGVkIGxheWVyWC9ZCiAgICAgIC8vIENocm9tZSB3YXJucyB5b3UgaWYgeW91IHRyeSB0byBjb3B5IGRlcHJlY2F0ZWQga2V5Ym9hcmRFdmVudC5rZXlMb2NhdGlvbgogICAgICAvLyBhbmQgd2Via2l0TW92ZW1lbnRYL1kKICAgICAgaWYgKGtleSAhPT0gJ2xheWVyWCcgJiYga2V5ICE9PSAnbGF5ZXJZJyAmJiBrZXkgIT09ICdrZXlMb2NhdGlvbicgJiYga2V5ICE9PSAnd2Via2l0TW92ZW1lbnRYJyAmJiBrZXkgIT09ICd3ZWJraXRNb3ZlbWVudFknKSB7CiAgICAgICAgLy8gQ2hyb21lIDMyKyB3YXJucyBpZiB5b3UgdHJ5IHRvIGNvcHkgZGVwcmVjYXRlZCByZXR1cm5WYWx1ZSwgYnV0CiAgICAgICAgLy8gd2Ugc3RpbGwgd2FudCB0byBpZiBwcmV2ZW50RGVmYXVsdCBpc24ndCBzdXBwb3J0ZWQgKElFOCkuCiAgICAgICAgaWYgKCEoa2V5ID09PSAncmV0dXJuVmFsdWUnICYmIG9sZC5wcmV2ZW50RGVmYXVsdCkpIHsKICAgICAgICAgIGV2ZW50W2tleV0gPSBvbGRba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyBUaGUgZXZlbnQgb2NjdXJyZWQgb24gdGhpcyBlbGVtZW50CiAgICBpZiAoIWV2ZW50LnRhcmdldCkgewogICAgICBldmVudC50YXJnZXQgPSBldmVudC5zcmNFbGVtZW50IHx8IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXTsKICAgIH0KCiAgICAvLyBIYW5kbGUgd2hpY2ggb3RoZXIgZWxlbWVudCB0aGUgZXZlbnQgaXMgcmVsYXRlZCB0bwogICAgaWYgKCFldmVudC5yZWxhdGVkVGFyZ2V0KSB7CiAgICAgIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPSBldmVudC5mcm9tRWxlbWVudCA9PT0gZXZlbnQudGFyZ2V0ID8gZXZlbnQudG9FbGVtZW50IDogZXZlbnQuZnJvbUVsZW1lbnQ7CiAgICB9CgogICAgLy8gU3RvcCB0aGUgZGVmYXVsdCBicm93c2VyIGFjdGlvbgogICAgZXZlbnQucHJldmVudERlZmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChvbGQucHJldmVudERlZmF1bHQpIHsKICAgICAgICBvbGQucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICBvbGQucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgZXZlbnQuZGVmYXVsdFByZXZlbnRlZCA9IHRydWU7CiAgICB9OwoKICAgIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgPSBmYWxzZTsKCiAgICAvLyBTdG9wIHRoZSBldmVudCBmcm9tIGJ1YmJsaW5nCiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChvbGQuc3RvcFByb3BhZ2F0aW9uKSB7CiAgICAgICAgb2xkLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9CiAgICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7CiAgICAgIG9sZC5jYW5jZWxCdWJibGUgPSB0cnVlOwogICAgICBldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CiAgICB9OwoKICAgIGV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuRmFsc2U7CgogICAgLy8gU3RvcCB0aGUgZXZlbnQgZnJvbSBidWJibGluZyBhbmQgZXhlY3V0aW5nIG90aGVyIGhhbmRsZXJzCiAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChvbGQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKSB7CiAgICAgICAgb2xkLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwogICAgICB9CiAgICAgIGV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTsKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9OwoKICAgIGV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuRmFsc2U7CgogICAgLy8gSGFuZGxlIG1vdXNlIHBvc2l0aW9uCiAgICBpZiAoZXZlbnQuY2xpZW50WCAhPSBudWxsKSB7CiAgICAgIHZhciBkb2MgPSBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uZG9jdW1lbnRFbGVtZW50LAogICAgICAgICAgYm9keSA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5ib2R5OwoKICAgICAgZXZlbnQucGFnZVggPSBldmVudC5jbGllbnRYICsgKGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwKSAtIChkb2MgJiYgZG9jLmNsaWVudExlZnQgfHwgYm9keSAmJiBib2R5LmNsaWVudExlZnQgfHwgMCk7CiAgICAgIGV2ZW50LnBhZ2VZID0gZXZlbnQuY2xpZW50WSArIChkb2MgJiYgZG9jLnNjcm9sbFRvcCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsVG9wIHx8IDApIC0gKGRvYyAmJiBkb2MuY2xpZW50VG9wIHx8IGJvZHkgJiYgYm9keS5jbGllbnRUb3AgfHwgMCk7CiAgICB9CgogICAgLy8gSGFuZGxlIGtleSBwcmVzc2VzCiAgICBldmVudC53aGljaCA9IGV2ZW50LmNoYXJDb2RlIHx8IGV2ZW50LmtleUNvZGU7CgogICAgLy8gRml4IGJ1dHRvbiBmb3IgbW91c2UgY2xpY2tzOgogICAgLy8gMCA9PSBsZWZ0OyAxID09IG1pZGRsZTsgMiA9PSByaWdodAogICAgaWYgKGV2ZW50LmJ1dHRvbiAhPSBudWxsKSB7CiAgICAgIGV2ZW50LmJ1dHRvbiA9IGV2ZW50LmJ1dHRvbiAmIDEgPyAwIDogZXZlbnQuYnV0dG9uICYgNCA/IDEgOiBldmVudC5idXR0b24gJiAyID8gMiA6IDA7CiAgICB9CiAgfQoKICAvLyBSZXR1cm5zIGZpeGVkLXVwIGluc3RhbmNlCiAgcmV0dXJuIGV2ZW50Owp9CgovKioKICogQ2xlYW4gdXAgdGhlIGxpc3RlbmVyIGNhY2hlIGFuZCBkaXNwYXRjaGVycwoqCiAqIEBwYXJhbSAge0VsZW1lbnR8T2JqZWN0fSBlbGVtIEVsZW1lbnQgdG8gY2xlYW4gdXAKICogQHBhcmFtICB7U3RyaW5nfSB0eXBlIFR5cGUgb2YgZXZlbnQgdG8gY2xlYW4gdXAKICogQHByaXZhdGUKICogQG1ldGhvZCBfY2xlYW5VcEV2ZW50cwogKi8KZnVuY3Rpb24gX2NsZWFuVXBFdmVudHMoZWxlbSwgdHlwZSkgewogIHZhciBkYXRhID0gRG9tLmdldEVsRGF0YShlbGVtKTsKCiAgLy8gUmVtb3ZlIHRoZSBldmVudHMgb2YgYSBwYXJ0aWN1bGFyIHR5cGUgaWYgdGhlcmUgYXJlIG5vbmUgbGVmdAogIGlmIChkYXRhLmhhbmRsZXJzW3R5cGVdLmxlbmd0aCA9PT0gMCkgewogICAgZGVsZXRlIGRhdGEuaGFuZGxlcnNbdHlwZV07CiAgICAvLyBkYXRhLmhhbmRsZXJzW3R5cGVdID0gbnVsbDsKICAgIC8vIFNldHRpbmcgdG8gbnVsbCB3YXMgY2F1c2luZyBhbiBlcnJvciB3aXRoIGRhdGEuaGFuZGxlcnMKCiAgICAvLyBSZW1vdmUgdGhlIG1ldGEtaGFuZGxlciBmcm9tIHRoZSBlbGVtZW50CiAgICBpZiAoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKSB7CiAgICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBkYXRhLmRpc3BhdGNoZXIsIGZhbHNlKTsKICAgIH0gZWxzZSBpZiAoZWxlbS5kZXRhY2hFdmVudCkgewogICAgICBlbGVtLmRldGFjaEV2ZW50KCdvbicgKyB0eXBlLCBkYXRhLmRpc3BhdGNoZXIpOwogICAgfQogIH0KCiAgLy8gUmVtb3ZlIHRoZSBldmVudHMgb2JqZWN0IGlmIHRoZXJlIGFyZSBubyB0eXBlcyBsZWZ0CiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGRhdGEuaGFuZGxlcnMpLmxlbmd0aCA8PSAwKSB7CiAgICBkZWxldGUgZGF0YS5oYW5kbGVyczsKICAgIGRlbGV0ZSBkYXRhLmRpc3BhdGNoZXI7CiAgICBkZWxldGUgZGF0YS5kaXNhYmxlZDsKICB9CgogIC8vIEZpbmFsbHkgcmVtb3ZlIHRoZSBlbGVtZW50IGRhdGEgaWYgdGhlcmUgaXMgbm8gZGF0YSBsZWZ0CiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGRhdGEpLmxlbmd0aCA9PT0gMCkgewogICAgRG9tLnJlbW92ZUVsRGF0YShlbGVtKTsKICB9Cn0KCi8qKgogKiBMb29wcyB0aHJvdWdoIGFuIGFycmF5IG9mIGV2ZW50IHR5cGVzIGFuZCBjYWxscyB0aGUgcmVxdWVzdGVkIG1ldGhvZCBmb3IgZWFjaCB0eXBlLgogKgogKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gICBUaGUgZXZlbnQgbWV0aG9kIHdlIHdhbnQgdG8gdXNlLgogKiBAcGFyYW0gIHtFbGVtZW50fE9iamVjdH0gZWxlbSBFbGVtZW50IG9yIG9iamVjdCB0byBiaW5kIGxpc3RlbmVycyB0bwogKiBAcGFyYW0gIHtTdHJpbmd9ICAgdHlwZSBUeXBlIG9mIGV2ZW50IHRvIGJpbmQgdG8uCiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayAgIEV2ZW50IGxpc3RlbmVyLgogKiBAcHJpdmF0ZQogKiBAZnVuY3Rpb24gX2hhbmRsZU11bHRpcGxlRXZlbnRzCiAqLwpmdW5jdGlvbiBfaGFuZGxlTXVsdGlwbGVFdmVudHMoZm4sIGVsZW0sIHR5cGVzLCBjYWxsYmFjaykgewogIHR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgIC8vQ2FsbCB0aGUgZXZlbnQgbWV0aG9kIGZvciBlYWNoIG9uZSBvZiB0aGUgdHlwZXMKICAgIGZuKGVsZW0sIHR5cGUsIGNhbGxiYWNrKTsKICB9KTsKfQoKfSx7Ii4vZG9tLmpzIjoxMjgsIi4vZ3VpZC5qcyI6MTMyLCJnbG9iYWwvZG9jdW1lbnQiOjEsImdsb2JhbC93aW5kb3ciOjJ9XSwxMzA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgZm4uanMKICovCid1c2Ugc3RyaWN0JzsKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2d1aWRKcyA9IF9kZXJlcV8oJy4vZ3VpZC5qcycpOwoKLyoqCiAqIEJpbmQgKGEuay5hIHByb3h5IG9yIENvbnRleHQpLiBBIHNpbXBsZSBtZXRob2QgZm9yIGNoYW5naW5nIHRoZSBjb250ZXh0IG9mIGEgZnVuY3Rpb24KICogSXQgYWxzbyBzdG9yZXMgYSB1bmlxdWUgaWQgb24gdGhlIGZ1bmN0aW9uIHNvIGl0IGNhbiBiZSBlYXNpbHkgcmVtb3ZlZCBmcm9tIGV2ZW50cwogKgogKiBAcGFyYW0gIHsqfSAgIGNvbnRleHQgVGhlIG9iamVjdCB0byBiaW5kIGFzIHNjb3BlCiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiAgICAgIFRoZSBmdW5jdGlvbiB0byBiZSBib3VuZCB0byBhIHNjb3BlCiAqIEBwYXJhbSAge051bWJlcj19ICAgdWlkICAgICBBbiBvcHRpb25hbCB1bmlxdWUgSUQgZm9yIHRoZSBmdW5jdGlvbiB0byBiZSBzZXQKICogQHJldHVybiB7RnVuY3Rpb259CiAqIEBwcml2YXRlCiAqIEBtZXRob2QgYmluZAogKi8KdmFyIGJpbmQgPSBmdW5jdGlvbiBiaW5kKGNvbnRleHQsIGZuLCB1aWQpIHsKICAvLyBNYWtlIHN1cmUgdGhlIGZ1bmN0aW9uIGhhcyBhIHVuaXF1ZSBJRAogIGlmICghZm4uZ3VpZCkgewogICAgZm4uZ3VpZCA9IF9ndWlkSnMubmV3R1VJRCgpOwogIH0KCiAgLy8gQ3JlYXRlIHRoZSBuZXcgZnVuY3Rpb24gdGhhdCBjaGFuZ2VzIHRoZSBjb250ZXh0CiAgdmFyIHJldCA9IGZ1bmN0aW9uIHJldCgpIHsKICAgIHJldHVybiBmbi5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpOwogIH07CgogIC8vIEFsbG93IGZvciB0aGUgYWJpbGl0eSB0byBpbmRpdmlkdWFsaXplIHRoaXMgZnVuY3Rpb24KICAvLyBOZWVkZWQgaW4gdGhlIGNhc2Ugd2hlcmUgbXVsdGlwbGUgb2JqZWN0cyBtaWdodCBzaGFyZSB0aGUgc2FtZSBwcm90b3R5cGUKICAvLyBJRiBib3RoIGl0ZW1zIGFkZCBhbiBldmVudCBsaXN0ZW5lciB3aXRoIHRoZSBzYW1lIGZ1bmN0aW9uLCB0aGVuIHlvdSB0cnkgdG8gcmVtb3ZlIGp1c3Qgb25lCiAgLy8gaXQgd2lsbCByZW1vdmUgYm90aCBiZWNhdXNlIHRoZXkgYm90aCBoYXZlIHRoZSBzYW1lIGd1aWQuCiAgLy8gd2hlbiB1c2luZyB0aGlzLCB5b3UgbmVlZCB0byB1c2UgdGhlIGJpbmQgbWV0aG9kIHdoZW4geW91IHJlbW92ZSB0aGUgbGlzdGVuZXIgYXMgd2VsbC4KICAvLyBjdXJyZW50bHkgdXNlZCBpbiB0ZXh0IHRyYWNrcwogIHJldC5ndWlkID0gdWlkID8gdWlkICsgJ18nICsgZm4uZ3VpZCA6IGZuLmd1aWQ7CgogIHJldHVybiByZXQ7Cn07CmV4cG9ydHMuYmluZCA9IGJpbmQ7Cgp9LHsiLi9ndWlkLmpzIjoxMzJ9XSwxMzE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgZm9ybWF0LXRpbWUuanMKICoKICogRm9ybWF0IHNlY29uZHMgYXMgYSB0aW1lIHN0cmluZywgSDpNTTpTUyBvciBNOlNTCiAqIFN1cHBseWluZyBhIGd1aWRlIChpbiBzZWNvbmRzKSB3aWxsIGZvcmNlIGEgbnVtYmVyIG9mIGxlYWRpbmcgemVyb3MKICogdG8gY292ZXIgdGhlIGxlbmd0aCBvZiB0aGUgZ3VpZGUKICoKICogQHBhcmFtICB7TnVtYmVyfSBzZWNvbmRzIE51bWJlciBvZiBzZWNvbmRzIHRvIGJlIHR1cm5lZCBpbnRvIGEgc3RyaW5nCiAqIEBwYXJhbSAge051bWJlcn0gZ3VpZGUgICBOdW1iZXIgKGluIHNlY29uZHMpIHRvIG1vZGVsIHRoZSBzdHJpbmcgYWZ0ZXIKICogQHJldHVybiB7U3RyaW5nfSAgICAgICAgIFRpbWUgZm9ybWF0dGVkIGFzIEg6TU06U1Mgb3IgTTpTUwogKiBAcHJpdmF0ZQogKiBAZnVuY3Rpb24gZm9ybWF0VGltZQogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKZnVuY3Rpb24gZm9ybWF0VGltZShzZWNvbmRzKSB7CiAgdmFyIGd1aWRlID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gc2Vjb25kcyA6IGFyZ3VtZW50c1sxXTsKICByZXR1cm4gKGZ1bmN0aW9uICgpIHsKICAgIHNlY29uZHMgPSBzZWNvbmRzIDwgMCA/IDAgOiBzZWNvbmRzOwogICAgdmFyIHMgPSBNYXRoLmZsb29yKHNlY29uZHMgJSA2MCk7CiAgICB2YXIgbSA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwICUgNjApOwogICAgdmFyIGggPSBNYXRoLmZsb29yKHNlY29uZHMgLyAzNjAwKTsKICAgIHZhciBnbSA9IE1hdGguZmxvb3IoZ3VpZGUgLyA2MCAlIDYwKTsKICAgIHZhciBnaCA9IE1hdGguZmxvb3IoZ3VpZGUgLyAzNjAwKTsKCiAgICAvLyBoYW5kbGUgaW52YWxpZCB0aW1lcwogICAgaWYgKGlzTmFOKHNlY29uZHMpIHx8IHNlY29uZHMgPT09IEluZmluaXR5KSB7CiAgICAgIC8vICctJyBpcyBmYWxzZSBmb3IgYWxsIHJlbGF0aW9uYWwgb3BlcmF0b3JzIChlLmcuIDwsID49KSBzbyB0aGlzIHNldHRpbmcKICAgICAgLy8gd2lsbCBhZGQgdGhlIG1pbmltdW0gbnVtYmVyIG9mIGZpZWxkcyBzcGVjaWZpZWQgYnkgdGhlIGd1aWRlCiAgICAgIGggPSBtID0gcyA9ICctJzsKICAgIH0KCiAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHNob3cgaG91cnMKICAgIGggPSBoID4gMCB8fCBnaCA+IDAgPyBoICsgJzonIDogJyc7CgogICAgLy8gSWYgaG91cnMgYXJlIHNob3dpbmcsIHdlIG1heSBuZWVkIHRvIGFkZCBhIGxlYWRpbmcgemVyby4KICAgIC8vIEFsd2F5cyBzaG93IGF0IGxlYXN0IG9uZSBkaWdpdCBvZiBtaW51dGVzLgogICAgbSA9ICgoaCB8fCBnbSA+PSAxMCkgJiYgbSA8IDEwID8gJzAnICsgbSA6IG0pICsgJzonOwoKICAgIC8vIENoZWNrIGlmIGxlYWRpbmcgemVybyBpcyBuZWVkIGZvciBzZWNvbmRzCiAgICBzID0gcyA8IDEwID8gJzAnICsgcyA6IHM7CgogICAgcmV0dXJuIGggKyBtICsgczsKICB9KSgpOwp9CgpleHBvcnRzWydkZWZhdWx0J10gPSBmb3JtYXRUaW1lOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0se31dLDEzMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBndWlkLmpzCiAqCiAqIFVuaXF1ZSBJRCBmb3IgYW4gZWxlbWVudCBvciBmdW5jdGlvbgogKiBAdHlwZSB7TnVtYmVyfQogKiBAcHJpdmF0ZQogKi8KInVzZSBzdHJpY3QiOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKZXhwb3J0cy5uZXdHVUlEID0gbmV3R1VJRDsKdmFyIF9ndWlkID0gMTsKCi8qKgogKiBHZXQgdGhlIG5leHQgdW5pcXVlIElECiAqCiAqIEByZXR1cm4ge1N0cmluZ30gCiAqIEBmdW5jdGlvbiBuZXdHVUlECiAqLwoKZnVuY3Rpb24gbmV3R1VJRCgpIHsKICByZXR1cm4gX2d1aWQrKzsKfQoKfSx7fV0sMTMzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIGxvZy5qcwogKi8KJ3VzZSBzdHJpY3QnOwoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfZ2xvYmFsV2luZG93ID0gX2RlcmVxXygnZ2xvYmFsL3dpbmRvdycpOwoKdmFyIF9nbG9iYWxXaW5kb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsV2luZG93KTsKCi8qKgogKiBMb2cgcGxhaW4gZGVidWcgbWVzc2FnZXMKICovCnZhciBsb2cgPSBmdW5jdGlvbiBsb2coKSB7CiAgX2xvZ1R5cGUobnVsbCwgYXJndW1lbnRzKTsKfTsKCi8qKgogKiBLZWVwIGEgaGlzdG9yeSBvZiBsb2cgbWVzc2FnZXMKICogQHR5cGUge0FycmF5fQogKi8KbG9nLmhpc3RvcnkgPSBbXTsKCi8qKgogKiBMb2cgZXJyb3IgbWVzc2FnZXMKICovCmxvZy5lcnJvciA9IGZ1bmN0aW9uICgpIHsKICBfbG9nVHlwZSgnZXJyb3InLCBhcmd1bWVudHMpOwp9OwoKLyoqCiAqIExvZyB3YXJuaW5nIG1lc3NhZ2VzCiAqLwpsb2cud2FybiA9IGZ1bmN0aW9uICgpIHsKICBfbG9nVHlwZSgnd2FybicsIGFyZ3VtZW50cyk7Cn07CgovKioKICogTG9nIG1lc3NhZ2VzIHRvIHRoZSBjb25zb2xlIGFuZCBoaXN0b3J5IGJhc2VkIG9uIHRoZSB0eXBlIG9mIG1lc3NhZ2UKICoKICogQHBhcmFtICB7U3RyaW5nfSB0eXBlIFRoZSB0eXBlIG9mIG1lc3NhZ2UsIG9yIGBudWxsYCBmb3IgYGxvZ2AKICogQHBhcmFtICB7T2JqZWN0fSBhcmdzIFRoZSBhcmdzIHRvIGJlIHBhc3NlZCB0byB0aGUgbG9nCiAqIEBwcml2YXRlCiAqIEBtZXRob2QgX2xvZ1R5cGUKICovCmZ1bmN0aW9uIF9sb2dUeXBlKHR5cGUsIGFyZ3MpIHsKICAvLyBjb252ZXJ0IGFyZ3MgdG8gYW4gYXJyYXkgdG8gZ2V0IGFycmF5IGZ1bmN0aW9ucwogIHZhciBhcmdzQXJyYXkgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmdzKTsKICAvLyBpZiB0aGVyZSdzIG5vIGNvbnNvbGUgdGhlbiBkb24ndCB0cnkgdG8gb3V0cHV0IG1lc3NhZ2VzCiAgLy8gdGhleSB3aWxsIHN0aWxsIGJlIHN0b3JlZCBpbiBsb2cuaGlzdG9yeQogIC8vIFdhcyBzZXR0aW5nIHRoZXNlIG9uY2Ugb3V0c2lkZSBvZiB0aGlzIGZ1bmN0aW9uLCBidXQgY29udGFpbmluZyB0aGVtCiAgLy8gaW4gdGhlIGZ1bmN0aW9uIG1ha2VzIGl0IGVhc2llciB0byB0ZXN0IGNhc2VzIHdoZXJlIGNvbnNvbGUgZG9lc24ndCBleGlzdAogIHZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9OwoKICB2YXIgY29uc29sZSA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J11bJ2NvbnNvbGUnXSB8fCB7CiAgICAnbG9nJzogbm9vcCwKICAgICd3YXJuJzogbm9vcCwKICAgICdlcnJvcic6IG5vb3AKICB9OwoKICBpZiAodHlwZSkgewogICAgLy8gYWRkIHRoZSB0eXBlIHRvIHRoZSBmcm9udCBvZiB0aGUgbWVzc2FnZQogICAgYXJnc0FycmF5LnVuc2hpZnQodHlwZS50b1VwcGVyQ2FzZSgpICsgJzonKTsKICB9IGVsc2UgewogICAgLy8gZGVmYXVsdCB0byBsb2cgd2l0aCBubyBwcmVmaXgKICAgIHR5cGUgPSAnbG9nJzsKICB9CgogIC8vIGFkZCB0byBoaXN0b3J5CiAgbG9nLmhpc3RvcnkucHVzaChhcmdzQXJyYXkpOwoKICAvLyBhZGQgY29uc29sZSBwcmVmaXggYWZ0ZXIgYWRkaW5nIHRvIGhpc3RvcnkKICBhcmdzQXJyYXkudW5zaGlmdCgnVklERU9KUzonKTsKCiAgLy8gY2FsbCBhcHByb3ByaWF0ZSBsb2cgZnVuY3Rpb24KICBpZiAoY29uc29sZVt0eXBlXS5hcHBseSkgewogICAgY29uc29sZVt0eXBlXS5hcHBseShjb25zb2xlLCBhcmdzQXJyYXkpOwogIH0gZWxzZSB7CiAgICAvLyBpZTggZG9lc24ndCBhbGxvdyBlcnJvci5hcHBseSwgYnV0IGl0IHdpbGwganVzdCBqb2luKCkgdGhlIGFycmF5IGFueXdheQogICAgY29uc29sZVt0eXBlXShhcmdzQXJyYXkuam9pbignICcpKTsKICB9Cn0KCmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGxvZzsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiZ2xvYmFsL3dpbmRvdyI6Mn1dLDEzNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7Ci8qKgogKiBAZmlsZSBtZXJnZS1vcHRpb25zLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwpleHBvcnRzWydkZWZhdWx0J10gPSBtZXJnZU9wdGlvbnM7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9Cgp2YXIgX2xvZGFzaENvbXBhdE9iamVjdE1lcmdlID0gX2RlcmVxXygnbG9kYXNoLWNvbXBhdC9vYmplY3QvbWVyZ2UnKTsKCnZhciBfbG9kYXNoQ29tcGF0T2JqZWN0TWVyZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9kYXNoQ29tcGF0T2JqZWN0TWVyZ2UpOwoKZnVuY3Rpb24gaXNQbGFpbihvYmopIHsKICByZXR1cm4gISFvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqLnRvU3RyaW5nKCkgPT09ICdbb2JqZWN0IE9iamVjdF0nICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0Owp9CgovKioKICogTWVyZ2UgY3VzdG9taXplci4gdmlkZW8uanMgc2ltcGx5IG92ZXJ3cml0ZXMgbm9uLXNpbXBsZSBvYmplY3RzCiAqIChsaWtlIGFycmF5cykgaW5zdGVhZCBvZiBhdHRlbXB0aW5nIHRvIG92ZXJsYXkgdGhlbS4KICogQHNlZSBodHRwczovL2xvZGFzaC5jb20vZG9jcyNtZXJnZQogKi8KdmFyIGN1c3RvbWl6ZXIgPSBmdW5jdGlvbiBjdXN0b21pemVyKGRlc3RpbmF0aW9uLCBzb3VyY2UpIHsKICAvLyBJZiB3ZSdyZSBub3Qgd29ya2luZyB3aXRoIGEgcGxhaW4gb2JqZWN0LCBjb3B5IHRoZSB2YWx1ZSBhcyBpcwogIC8vIElmIHNvdXJjZSBpcyBhbiBhcnJheSwgZm9yIGluc3RhbmNlLCBpdCB3aWxsIHJlcGxhY2UgZGVzdGluYXRpb24KICBpZiAoIWlzUGxhaW4oc291cmNlKSkgewogICAgcmV0dXJuIHNvdXJjZTsKICB9CgogIC8vIElmIHRoZSBuZXcgdmFsdWUgaXMgYSBwbGFpbiBvYmplY3QgYnV0IHRoZSBmaXJzdCBvYmplY3QgdmFsdWUgaXMgbm90CiAgLy8gd2UgbmVlZCB0byBjcmVhdGUgYSBuZXcgb2JqZWN0IGZvciB0aGUgZmlyc3Qgb2JqZWN0IHRvIG1lcmdlIHdpdGguCiAgLy8gVGhpcyBtYWtlcyBpdCBjb25zaXN0ZW50IHdpdGggaG93IG1lcmdlKCkgd29ya3MgYnkgZGVmYXVsdAogIC8vIGFuZCBhbHNvIHByb3RlY3RzIGZyb20gbGF0ZXIgY2hhbmdlcyB0aGUgdG8gZmlyc3Qgb2JqZWN0IGFmZmVjdGluZwogIC8vIHRoZSBzZWNvbmQgb2JqZWN0J3MgdmFsdWVzLgogIGlmICghaXNQbGFpbihkZXN0aW5hdGlvbikpIHsKICAgIHJldHVybiBtZXJnZU9wdGlvbnMoc291cmNlKTsKICB9Cn07CgovKioKICogTWVyZ2Ugb25lIG9yIG1vcmUgb3B0aW9ucyBvYmplY3RzLCByZWN1cnNpdmVseSBtZXJnaW5nICoqb25seSoqCiAqIHBsYWluIG9iamVjdCBwcm9wZXJ0aWVzLiAgUHJldmlvdXNseSBgZGVlcE1lcmdlYC4KICoKICogQHBhcmFtICB7Li4uT2JqZWN0fSBzb3VyY2UgT25lIG9yIG1vcmUgb2JqZWN0cyB0byBtZXJnZQogKiBAcmV0dXJucyB7T2JqZWN0fSAgICAgICAgICBhIG5ldyBvYmplY3QgdGhhdCBpcyB0aGUgdW5pb24gb2YgYWxsCiAqIHByb3ZpZGVkIG9iamVjdHMKICogQGZ1bmN0aW9uIG1lcmdlT3B0aW9ucwogKi8KCmZ1bmN0aW9uIG1lcmdlT3B0aW9ucygpIHsKICAvLyBjb250cnVjdCB0aGUgY2FsbCBkeW5hbWljYWxseSB0byBoYW5kbGUgdGhlIHZhcmlhYmxlIG51bWJlciBvZgogIC8vIG9iamVjdHMgdG8gbWVyZ2UKICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7CgogIC8vIHVuc2hpZnQgYW4gZW1wdHkgb2JqZWN0IGludG8gdGhlIGZyb250IG9mIHRoZSBjYWxsIGFzIHRoZSB0YXJnZXQKICAvLyBvZiB0aGUgbWVyZ2UKICBhcmdzLnVuc2hpZnQoe30pOwoKICAvLyBjdXN0b21pemUgY29uZmxpY3QgcmVzb2x1dGlvbiB0byBtYXRjaCBvdXIgaGlzdG9yaWNhbCBtZXJnZSBiZWhhdmlvcgogIGFyZ3MucHVzaChjdXN0b21pemVyKTsKCiAgX2xvZGFzaENvbXBhdE9iamVjdE1lcmdlMlsnZGVmYXVsdCddLmFwcGx5KG51bGwsIGFyZ3MpOwoKICAvLyByZXR1cm4gdGhlIG11dGF0ZWQgcmVzdWx0IG9iamVjdAogIHJldHVybiBhcmdzWzBdOwp9Cgptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyJsb2Rhc2gtY29tcGF0L29iamVjdC9tZXJnZSI6NDB9XSwxMzU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgY3JlYXRlU3R5bGVFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlU3R5bGVFbGVtZW50KGNsYXNzTmFtZSkgewogIHZhciBzdHlsZSA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogIHN0eWxlLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTsKCiAgcmV0dXJuIHN0eWxlOwp9OwoKZXhwb3J0cy5jcmVhdGVTdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQ7CnZhciBzZXRUZXh0Q29udGVudCA9IGZ1bmN0aW9uIHNldFRleHRDb250ZW50KGVsLCBjb250ZW50KSB7CiAgaWYgKGVsLnN0eWxlU2hlZXQpIHsKICAgIGVsLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNvbnRlbnQ7CiAgfSBlbHNlIHsKICAgIGVsLnRleHRDb250ZW50ID0gY29udGVudDsKICB9Cn07CmV4cG9ydHMuc2V0VGV4dENvbnRlbnQgPSBzZXRUZXh0Q29udGVudDsKCn0seyJnbG9iYWwvZG9jdW1lbnQiOjF9XSwxMzY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwpleHBvcnRzLmNyZWF0ZVRpbWVSYW5nZXMgPSBjcmVhdGVUaW1lUmFuZ2VzOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF9sb2dKcyA9IF9kZXJlcV8oJy4vbG9nLmpzJyk7Cgp2YXIgX2xvZ0pzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ0pzKTsKCi8qKgogKiBAZmlsZSB0aW1lLXJhbmdlcy5qcwogKgogKiBTaG91bGQgY3JlYXRlIGEgZmFrZSBUaW1lUmFuZ2Ugb2JqZWN0CiAqIE1pbWljcyBhbiBIVE1MNSB0aW1lIHJhbmdlIGluc3RhbmNlLCB3aGljaCBoYXMgZnVuY3Rpb25zIHRoYXQKICogcmV0dXJuIHRoZSBzdGFydCBhbmQgZW5kIHRpbWVzIGZvciBhIHJhbmdlCiAqIFRpbWVSYW5nZXMgYXJlIHJldHVybmVkIGJ5IHRoZSBidWZmZXJlZCgpIG1ldGhvZAogKgogKiBAcGFyYW0gIHsoTnVtYmVyfEFycmF5KX0gU3RhcnQgb2YgYSBzaW5nbGUgcmFuZ2Ugb3IgYW4gYXJyYXkgb2YgcmFuZ2VzCiAqIEBwYXJhbSAge051bWJlcn0gRW5kIG9mIGEgc2luZ2xlIHJhbmdlCiAqIEBwcml2YXRlCiAqIEBtZXRob2QgY3JlYXRlVGltZVJhbmdlcwogKi8KCmZ1bmN0aW9uIGNyZWF0ZVRpbWVSYW5nZXMoc3RhcnQsIGVuZCkgewogIGlmIChBcnJheS5pc0FycmF5KHN0YXJ0KSkgewogICAgcmV0dXJuIGNyZWF0ZVRpbWVSYW5nZXNPYmooc3RhcnQpOwogIH0gZWxzZSBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIGNyZWF0ZVRpbWVSYW5nZXNPYmooKTsKICB9CiAgcmV0dXJuIGNyZWF0ZVRpbWVSYW5nZXNPYmooW1tzdGFydCwgZW5kXV0pOwp9CgpleHBvcnRzLmNyZWF0ZVRpbWVSYW5nZSA9IGNyZWF0ZVRpbWVSYW5nZXM7CgpmdW5jdGlvbiBjcmVhdGVUaW1lUmFuZ2VzT2JqKHJhbmdlcykgewogIGlmIChyYW5nZXMgPT09IHVuZGVmaW5lZCB8fCByYW5nZXMubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gewogICAgICBsZW5ndGg6IDAsCiAgICAgIHN0YXJ0OiBmdW5jdGlvbiBzdGFydCgpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgVGltZVJhbmdlcyBvYmplY3QgaXMgZW1wdHknKTsKICAgICAgfSwKICAgICAgZW5kOiBmdW5jdGlvbiBlbmQoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIFRpbWVSYW5nZXMgb2JqZWN0IGlzIGVtcHR5Jyk7CiAgICAgIH0KICAgIH07CiAgfQogIHJldHVybiB7CiAgICBsZW5ndGg6IHJhbmdlcy5sZW5ndGgsCiAgICBzdGFydDogZ2V0UmFuZ2UuYmluZChudWxsLCAnc3RhcnQnLCAwLCByYW5nZXMpLAogICAgZW5kOiBnZXRSYW5nZS5iaW5kKG51bGwsICdlbmQnLCAxLCByYW5nZXMpCiAgfTsKfQoKZnVuY3Rpb24gZ2V0UmFuZ2UoZm5OYW1lLCB2YWx1ZUluZGV4LCByYW5nZXMsIHJhbmdlSW5kZXgpIHsKICBpZiAocmFuZ2VJbmRleCA9PT0gdW5kZWZpbmVkKSB7CiAgICBfbG9nSnMyWydkZWZhdWx0J10ud2FybignREVQUkVDQVRFRDogRnVuY3Rpb24gXCcnICsgZm5OYW1lICsgJ1wnIG9uIFwnVGltZVJhbmdlc1wnIGNhbGxlZCB3aXRob3V0IGFuIGluZGV4IGFyZ3VtZW50LicpOwogICAgcmFuZ2VJbmRleCA9IDA7CiAgfQogIHJhbmdlQ2hlY2soZm5OYW1lLCByYW5nZUluZGV4LCByYW5nZXMubGVuZ3RoIC0gMSk7CiAgcmV0dXJuIHJhbmdlc1tyYW5nZUluZGV4XVt2YWx1ZUluZGV4XTsKfQoKZnVuY3Rpb24gcmFuZ2VDaGVjayhmbk5hbWUsIGluZGV4LCBtYXhJbmRleCkgewogIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPiBtYXhJbmRleCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZXhlY3V0ZSBcJycgKyBmbk5hbWUgKyAnXCcgb24gXCdUaW1lUmFuZ2VzXCc6IFRoZSBpbmRleCBwcm92aWRlZCAoJyArIGluZGV4ICsgJykgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBtYXhpbXVtIGJvdW5kICgnICsgbWF4SW5kZXggKyAnKS4nKTsKICB9Cn0KCn0seyIuL2xvZy5qcyI6MTMzfV0sMTM3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHRvLXRpdGxlLWNhc2UuanMKICoKICogVXBwZXJjYXNlIHRoZSBmaXJzdCBsZXR0ZXIgb2YgYSBzdHJpbmcKICoKICogQHBhcmFtICB7U3RyaW5nfSBzdHJpbmcgU3RyaW5nIHRvIGJlIHVwcGVyY2FzZWQKICogQHJldHVybiB7U3RyaW5nfQogKiBAcHJpdmF0ZQogKiBAbWV0aG9kIHRvVGl0bGVDYXNlCiAqLwoidXNlIHN0cmljdCI7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwpmdW5jdGlvbiB0b1RpdGxlQ2FzZShzdHJpbmcpIHsKICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpOwp9CgpleHBvcnRzWyJkZWZhdWx0Il0gPSB0b1RpdGxlQ2FzZTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWyJkZWZhdWx0Il07Cgp9LHt9XSwxMzg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpewovKioKICogQGZpbGUgdXJsLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfQoKdmFyIF9nbG9iYWxEb2N1bWVudCA9IF9kZXJlcV8oJ2dsb2JhbC9kb2N1bWVudCcpOwoKdmFyIF9nbG9iYWxEb2N1bWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nbG9iYWxEb2N1bWVudCk7Cgp2YXIgX2dsb2JhbFdpbmRvdyA9IF9kZXJlcV8oJ2dsb2JhbC93aW5kb3cnKTsKCnZhciBfZ2xvYmFsV2luZG93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dsb2JhbFdpbmRvdyk7CgovKioKICogUmVzb2x2ZSBhbmQgcGFyc2UgdGhlIGVsZW1lbnRzIG9mIGEgVVJMCiAqCiAqIEBwYXJhbSAge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gcGFyc2UKICogQHJldHVybiB7T2JqZWN0fSAgICAgQW4gb2JqZWN0IG9mIHVybCBkZXRhaWxzCiAqIEBtZXRob2QgcGFyc2VVcmwKICovCnZhciBwYXJzZVVybCA9IGZ1bmN0aW9uIHBhcnNlVXJsKHVybCkgewogIHZhciBwcm9wcyA9IFsncHJvdG9jb2wnLCAnaG9zdG5hbWUnLCAncG9ydCcsICdwYXRobmFtZScsICdzZWFyY2gnLCAnaGFzaCcsICdob3N0J107CgogIC8vIGFkZCB0aGUgdXJsIHRvIGFuIGFuY2hvciBhbmQgbGV0IHRoZSBicm93c2VyIHBhcnNlIHRoZSBVUkwKICB2YXIgYSA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCdhJyk7CiAgYS5ocmVmID0gdXJsOwoKICAvLyBJRTggKGFuZCA5PykgRml4CiAgLy8gaWU4IGRvZXNuJ3QgcGFyc2UgdGhlIFVSTCBjb3JyZWN0bHkgdW50aWwgdGhlIGFuY2hvciBpcyBhY3R1YWxseQogIC8vIGFkZGVkIHRvIHRoZSBib2R5LCBhbmQgYW4gaW5uZXJIVE1MIGlzIG5lZWRlZCB0byB0cmlnZ2VyIHRoZSBwYXJzaW5nCiAgdmFyIGFkZFRvQm9keSA9IGEuaG9zdCA9PT0gJycgJiYgYS5wcm90b2NvbCAhPT0gJ2ZpbGU6JzsKICB2YXIgZGl2ID0gdW5kZWZpbmVkOwogIGlmIChhZGRUb0JvZHkpIHsKICAgIGRpdiA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGRpdi5pbm5lckhUTUwgPSAnPGEgaHJlZj0iJyArIHVybCArICciPjwvYT4nOwogICAgYSA9IGRpdi5maXJzdENoaWxkOwogICAgLy8gcHJldmVudCB0aGUgZGl2IGZyb20gYWZmZWN0aW5nIGxheW91dAogICAgZGl2LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lOyBwb3NpdGlvbjphYnNvbHV0ZTsnKTsKICAgIF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5ib2R5LmFwcGVuZENoaWxkKGRpdik7CiAgfQoKICAvLyBDb3B5IHRoZSBzcGVjaWZpYyBVUkwgcHJvcGVydGllcyB0byBhIG5ldyBvYmplY3QKICAvLyBUaGlzIGlzIGFsc28gbmVlZGVkIGZvciBJRTggYmVjYXVzZSB0aGUgYW5jaG9yIGxvc2VzIGl0cwogIC8vIHByb3BlcnRpZXMgd2hlbiBpdCdzIHJlbW92ZWQgZnJvbSB0aGUgZG9tCiAgdmFyIGRldGFpbHMgPSB7fTsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICBkZXRhaWxzW3Byb3BzW2ldXSA9IGFbcHJvcHNbaV1dOwogIH0KCiAgLy8gSUU5IGFkZHMgdGhlIHBvcnQgdG8gdGhlIGhvc3QgcHJvcGVydHkgdW5saWtlIGV2ZXJ5b25lIGVsc2UuIElmCiAgLy8gYSBwb3J0IGlkZW50aWZpZXIgaXMgYWRkZWQgZm9yIHN0YW5kYXJkIHBvcnRzLCBzdHJpcCBpdC4KICBpZiAoZGV0YWlscy5wcm90b2NvbCA9PT0gJ2h0dHA6JykgewogICAgZGV0YWlscy5ob3N0ID0gZGV0YWlscy5ob3N0LnJlcGxhY2UoLzo4MCQvLCAnJyk7CiAgfQogIGlmIChkZXRhaWxzLnByb3RvY29sID09PSAnaHR0cHM6JykgewogICAgZGV0YWlscy5ob3N0ID0gZGV0YWlscy5ob3N0LnJlcGxhY2UoLzo0NDMkLywgJycpOwogIH0KCiAgaWYgKGFkZFRvQm9keSkgewogICAgX2dsb2JhbERvY3VtZW50MlsnZGVmYXVsdCddLmJvZHkucmVtb3ZlQ2hpbGQoZGl2KTsKICB9CgogIHJldHVybiBkZXRhaWxzOwp9OwoKZXhwb3J0cy5wYXJzZVVybCA9IHBhcnNlVXJsOwovKioKICogR2V0IGFic29sdXRlIHZlcnNpb24gb2YgcmVsYXRpdmUgVVJMLiBVc2VkIHRvIHRlbGwgZmxhc2ggY29ycmVjdCBVUkwuCiAqIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDcwODMyL2dldHRpbmctYW4tYWJzb2x1dGUtdXJsLWZyb20tYS1yZWxhdGl2ZS1vbmUtaWU2LWlzc3VlCiAqCiAqIEBwYXJhbSAge1N0cmluZ30gdXJsIFVSTCB0byBtYWtlIGFic29sdXRlCiAqIEByZXR1cm4ge1N0cmluZ30gICAgIEFic29sdXRlIFVSTAogKiBAcHJpdmF0ZQogKiBAbWV0aG9kIGdldEFic29sdXRlVVJMCiAqLwp2YXIgZ2V0QWJzb2x1dGVVUkwgPSBmdW5jdGlvbiBnZXRBYnNvbHV0ZVVSTCh1cmwpIHsKICAvLyBDaGVjayBpZiBhYnNvbHV0ZSBVUkwKICBpZiAoIXVybC5tYXRjaCgvXmh0dHBzPzpcL1wvLykpIHsKICAgIC8vIENvbnZlcnQgdG8gYWJzb2x1dGUgVVJMLiBGbGFzaCBob3N0ZWQgb2ZmLXNpdGUgbmVlZHMgYW4gYWJzb2x1dGUgVVJMLgogICAgdmFyIGRpdiA9IF9nbG9iYWxEb2N1bWVudDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGRpdi5pbm5lckhUTUwgPSAnPGEgaHJlZj0iJyArIHVybCArICciPng8L2E+JzsKICAgIHVybCA9IGRpdi5maXJzdENoaWxkLmhyZWY7CiAgfQoKICByZXR1cm4gdXJsOwp9OwoKZXhwb3J0cy5nZXRBYnNvbHV0ZVVSTCA9IGdldEFic29sdXRlVVJMOwovKioKICogUmV0dXJucyB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBwYXNzZWQgZmlsZSBuYW1lLiBJdCB3aWxsIHJldHVybiBhbiBlbXB0eSBzdHJpbmcgaWYgeW91IHBhc3MgYW4gaW52YWxpZCBwYXRoCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSAgICBwYXRoICAgIFRoZSBmaWxlTmFtZSBwYXRoIGxpa2UgJy9wYXRoL3RvL2ZpbGUubXA0JwogKiBAcmV0dXJucyB7U3RyaW5nfSAgICAgICAgICBUaGUgZXh0ZW5zaW9uIGluIGxvd2VyIGNhc2Ugb3IgYW4gZW1wdHkgc3RyaW5nIGlmIG5vIGV4dGVuc2lvbiBjb3VsZCBiZSBmb3VuZC4KICogQG1ldGhvZCBnZXRGaWxlRXh0ZW5zaW9uCiAqLwp2YXIgZ2V0RmlsZUV4dGVuc2lvbiA9IGZ1bmN0aW9uIGdldEZpbGVFeHRlbnNpb24ocGF0aCkgewogIGlmICh0eXBlb2YgcGF0aCA9PT0gJ3N0cmluZycpIHsKICAgIHZhciBzcGxpdFBhdGhSZSA9IC9eKFwvPykoW1xzXFNdKj8pKCg/OlwuezEsMn18W15cL10rPykoXC4oW15cLlwvXD9dKykpKSg/OltcL10qfFtcP10uKikkL2k7CiAgICB2YXIgcGF0aFBhcnRzID0gc3BsaXRQYXRoUmUuZXhlYyhwYXRoKTsKCiAgICBpZiAocGF0aFBhcnRzKSB7CiAgICAgIHJldHVybiBwYXRoUGFydHMucG9wKCkudG9Mb3dlckNhc2UoKTsKICAgIH0KICB9CgogIHJldHVybiAnJzsKfTsKCmV4cG9ydHMuZ2V0RmlsZUV4dGVuc2lvbiA9IGdldEZpbGVFeHRlbnNpb247Ci8qKgogKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHVybCBwYXNzZWQgaXMgYSBjcm9zcyBkb21haW4gcmVxdWVzdCBvciBub3QuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIHVybCB0byBjaGVjawogKiBAcmV0dXJuIHtCb29sZWFufSAgIFdoZXRoZXIgaXQgaXMgYSBjcm9zcyBkb21haW4gcmVxdWVzdCBvciBub3QKICogQG1ldGhvZCBpc0Nyb3NzT3JpZ2luCiAqLwp2YXIgaXNDcm9zc09yaWdpbiA9IGZ1bmN0aW9uIGlzQ3Jvc3NPcmlnaW4odXJsKSB7CiAgdmFyIHdpbkxvYyA9IF9nbG9iYWxXaW5kb3cyWydkZWZhdWx0J10ubG9jYXRpb247CiAgdmFyIHVybEluZm8gPSBwYXJzZVVybCh1cmwpOwoKICAvLyBJRTggcHJvdG9jb2wgcmVsYXRpdmUgdXJscyB3aWxsIHJldHVybiAnOicgZm9yIHByb3RvY29sCiAgdmFyIHNyY1Byb3RvY29sID0gdXJsSW5mby5wcm90b2NvbCA9PT0gJzonID8gd2luTG9jLnByb3RvY29sIDogdXJsSW5mby5wcm90b2NvbDsKCiAgLy8gQ2hlY2sgaWYgdXJsIGlzIGZvciBhbm90aGVyIGRvbWFpbi9vcmlnaW4KICAvLyBJRTggZG9lc24ndCBrbm93IGxvY2F0aW9uLm9yaWdpbiwgc28gd2Ugd29uJ3QgcmVseSBvbiBpdCBoZXJlCiAgdmFyIGNyb3NzT3JpZ2luID0gc3JjUHJvdG9jb2wgKyB1cmxJbmZvLmhvc3QgIT09IHdpbkxvYy5wcm90b2NvbCArIHdpbkxvYy5ob3N0OwoKICByZXR1cm4gY3Jvc3NPcmlnaW47Cn07CmV4cG9ydHMuaXNDcm9zc09yaWdpbiA9IGlzQ3Jvc3NPcmlnaW47Cgp9LHsiZ2xvYmFsL2RvY3VtZW50IjoxLCJnbG9iYWwvd2luZG93IjoyfV0sMTM5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBmaWxlIHZpZGVvLmpzCiAqLwondXNlIHN0cmljdCc7CgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09ialsnZGVmYXVsdCddID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH0KCnZhciBfZ2xvYmFsRG9jdW1lbnQgPSBfZGVyZXFfKCdnbG9iYWwvZG9jdW1lbnQnKTsKCnZhciBfZ2xvYmFsRG9jdW1lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2xvYmFsRG9jdW1lbnQpOwoKdmFyIF9zZXR1cCA9IF9kZXJlcV8oJy4vc2V0dXAnKTsKCnZhciBzZXR1cCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9zZXR1cCk7Cgp2YXIgX3V0aWxzU3R5bGVzaGVldEpzID0gX2RlcmVxXygnLi91dGlscy9zdHlsZXNoZWV0LmpzJyk7Cgp2YXIgc3R5bGVzaGVldCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlsc1N0eWxlc2hlZXRKcyk7Cgp2YXIgX2NvbXBvbmVudCA9IF9kZXJlcV8oJy4vY29tcG9uZW50Jyk7Cgp2YXIgX2NvbXBvbmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnQpOwoKdmFyIF9ldmVudFRhcmdldCA9IF9kZXJlcV8oJy4vZXZlbnQtdGFyZ2V0Jyk7Cgp2YXIgX2V2ZW50VGFyZ2V0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50VGFyZ2V0KTsKCnZhciBfdXRpbHNFdmVudHNKcyA9IF9kZXJlcV8oJy4vdXRpbHMvZXZlbnRzLmpzJyk7Cgp2YXIgRXZlbnRzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRXZlbnRzSnMpOwoKdmFyIF9wbGF5ZXIgPSBfZGVyZXFfKCcuL3BsYXllcicpOwoKdmFyIF9wbGF5ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGxheWVyKTsKCnZhciBfcGx1Z2luc0pzID0gX2RlcmVxXygnLi9wbHVnaW5zLmpzJyk7Cgp2YXIgX3BsdWdpbnNKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbHVnaW5zSnMpOwoKdmFyIF9zcmNKc1V0aWxzTWVyZ2VPcHRpb25zSnMgPSBfZGVyZXFfKCcuLi8uLi9zcmMvanMvdXRpbHMvbWVyZ2Utb3B0aW9ucy5qcycpOwoKdmFyIF9zcmNKc1V0aWxzTWVyZ2VPcHRpb25zSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3JjSnNVdGlsc01lcmdlT3B0aW9uc0pzKTsKCnZhciBfdXRpbHNGbkpzID0gX2RlcmVxXygnLi91dGlscy9mbi5qcycpOwoKdmFyIEZuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRm5Kcyk7Cgp2YXIgX3RyYWNrc1RleHRUcmFja0pzID0gX2RlcmVxXygnLi90cmFja3MvdGV4dC10cmFjay5qcycpOwoKdmFyIF90cmFja3NUZXh0VHJhY2tKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFja3NUZXh0VHJhY2tKcyk7Cgp2YXIgX29iamVjdEFzc2lnbiA9IF9kZXJlcV8oJ29iamVjdC5hc3NpZ24nKTsKCnZhciBfb2JqZWN0QXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdEFzc2lnbik7Cgp2YXIgX3V0aWxzVGltZVJhbmdlc0pzID0gX2RlcmVxXygnLi91dGlscy90aW1lLXJhbmdlcy5qcycpOwoKdmFyIF91dGlsc0Zvcm1hdFRpbWVKcyA9IF9kZXJlcV8oJy4vdXRpbHMvZm9ybWF0LXRpbWUuanMnKTsKCnZhciBfdXRpbHNGb3JtYXRUaW1lSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRpbHNGb3JtYXRUaW1lSnMpOwoKdmFyIF91dGlsc0xvZ0pzID0gX2RlcmVxXygnLi91dGlscy9sb2cuanMnKTsKCnZhciBfdXRpbHNMb2dKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0xvZ0pzKTsKCnZhciBfdXRpbHNEb21KcyA9IF9kZXJlcV8oJy4vdXRpbHMvZG9tLmpzJyk7Cgp2YXIgRG9tID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX3V0aWxzRG9tSnMpOwoKdmFyIF91dGlsc0Jyb3dzZXJKcyA9IF9kZXJlcV8oJy4vdXRpbHMvYnJvd3Nlci5qcycpOwoKdmFyIGJyb3dzZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNCcm93c2VySnMpOwoKdmFyIF91dGlsc1VybEpzID0gX2RlcmVxXygnLi91dGlscy91cmwuanMnKTsKCnZhciBVcmwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfdXRpbHNVcmxKcyk7Cgp2YXIgX2V4dGVuZEpzID0gX2RlcmVxXygnLi9leHRlbmQuanMnKTsKCnZhciBfZXh0ZW5kSnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXh0ZW5kSnMpOwoKdmFyIF9sb2Rhc2hDb21wYXRPYmplY3RNZXJnZSA9IF9kZXJlcV8oJ2xvZGFzaC1jb21wYXQvb2JqZWN0L21lcmdlJyk7Cgp2YXIgX2xvZGFzaENvbXBhdE9iamVjdE1lcmdlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZGFzaENvbXBhdE9iamVjdE1lcmdlKTsKCnZhciBfdXRpbHNDcmVhdGVEZXByZWNhdGlvblByb3h5SnMgPSBfZGVyZXFfKCcuL3V0aWxzL2NyZWF0ZS1kZXByZWNhdGlvbi1wcm94eS5qcycpOwoKdmFyIF91dGlsc0NyZWF0ZURlcHJlY2F0aW9uUHJveHlKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGlsc0NyZWF0ZURlcHJlY2F0aW9uUHJveHlKcyk7Cgp2YXIgX3hociA9IF9kZXJlcV8oJ3hocicpOwoKdmFyIF94aHIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfeGhyKTsKCi8vIEluY2x1ZGUgdGhlIGJ1aWx0LWluIHRlY2hzCgp2YXIgX3RlY2hUZWNoSnMgPSBfZGVyZXFfKCcuL3RlY2gvdGVjaC5qcycpOwoKdmFyIF90ZWNoVGVjaEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlY2hUZWNoSnMpOwoKdmFyIF90ZWNoSHRtbDVKcyA9IF9kZXJlcV8oJy4vdGVjaC9odG1sNS5qcycpOwoKdmFyIF90ZWNoSHRtbDVKczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWNoSHRtbDVKcyk7Cgp2YXIgX3RlY2hGbGFzaEpzID0gX2RlcmVxXygnLi90ZWNoL2ZsYXNoLmpzJyk7Cgp2YXIgX3RlY2hGbGFzaEpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlY2hGbGFzaEpzKTsKCi8vIEhUTUw1IEVsZW1lbnQgU2hpbSBmb3IgSUU4CmlmICh0eXBlb2YgSFRNTFZpZGVvRWxlbWVudCA9PT0gJ3VuZGVmaW5lZCcpIHsKICBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgndmlkZW8nKTsKICBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgnYXVkaW8nKTsKICBfZ2xvYmFsRG9jdW1lbnQyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgndHJhY2snKTsKfQoKLyoqCiAqIERvdWJsZXMgYXMgdGhlIG1haW4gZnVuY3Rpb24gZm9yIHVzZXJzIHRvIGNyZWF0ZSBhIHBsYXllciBpbnN0YW5jZSBhbmQgYWxzbwogKiB0aGUgbWFpbiBsaWJyYXJ5IG9iamVjdC4KICogVGhlIGB2aWRlb2pzYCBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBpbml0aWFsaXplIG9yIHJldHJpZXZlIGEgcGxheWVyLgogKiBgYGBqcwogKiAgICAgdmFyIG15UGxheWVyID0gdmlkZW9qcygnbXlfdmlkZW9faWQnKTsKICogYGBgCiAqCiAqIEBwYXJhbSAge1N0cmluZ3xFbGVtZW50fSBpZCAgICAgIFZpZGVvIGVsZW1lbnQgb3IgdmlkZW8gZWxlbWVudCBJRAogKiBAcGFyYW0gIHtPYmplY3Q9fSBvcHRpb25zICAgICAgICBPcHRpb25hbCBvcHRpb25zIG9iamVjdCBmb3IgY29uZmlnL3NldHRpbmdzCiAqIEBwYXJhbSAge0Z1bmN0aW9uPX0gcmVhZHkgICAgICAgIE9wdGlvbmFsIHJlYWR5IGNhbGxiYWNrCiAqIEByZXR1cm4ge1BsYXllcn0gICAgICAgICAgICAgICAgIEEgcGxheWVyIGluc3RhbmNlCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgdmlkZW9qcwogKi8KdmFyIHZpZGVvanMgPSBmdW5jdGlvbiB2aWRlb2pzKGlkLCBvcHRpb25zLCByZWFkeSkgewogIHZhciB0YWc7IC8vIEVsZW1lbnQgb2YgSUQKCiAgLy8gQWxsb3cgZm9yIGVsZW1lbnQgb3IgSUQgdG8gYmUgcGFzc2VkIGluCiAgLy8gU3RyaW5nIElECiAgaWYgKHR5cGVvZiBpZCA9PT0gJ3N0cmluZycpIHsKCiAgICAvLyBBZGp1c3QgZm9yIGpRdWVyeSBJRCBzeW50YXgKICAgIGlmIChpZC5pbmRleE9mKCcjJykgPT09IDApIHsKICAgICAgaWQgPSBpZC5zbGljZSgxKTsKICAgIH0KCiAgICAvLyBJZiBhIHBsYXllciBpbnN0YW5jZSBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgZm9yIHRoaXMgSUQgcmV0dXJuIGl0LgogICAgaWYgKHZpZGVvanMuZ2V0UGxheWVycygpW2lkXSkgewoKICAgICAgLy8gSWYgb3B0aW9ucyBvciByZWFkeSBmdW50aW9uIGFyZSBwYXNzZWQsIHdhcm4KICAgICAgaWYgKG9wdGlvbnMpIHsKICAgICAgICBfdXRpbHNMb2dKczJbJ2RlZmF1bHQnXS53YXJuKCdQbGF5ZXIgIicgKyBpZCArICciIGlzIGFscmVhZHkgaW5pdGlhbGlzZWQuIE9wdGlvbnMgd2lsbCBub3QgYmUgYXBwbGllZC4nKTsKICAgICAgfQoKICAgICAgaWYgKHJlYWR5KSB7CiAgICAgICAgdmlkZW9qcy5nZXRQbGF5ZXJzKClbaWRdLnJlYWR5KHJlYWR5KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZpZGVvanMuZ2V0UGxheWVycygpW2lkXTsKCiAgICAgIC8vIE90aGVyd2lzZSBnZXQgZWxlbWVudCBmb3IgSUQKICAgIH0gZWxzZSB7CiAgICAgICAgdGFnID0gRG9tLmdldEVsKGlkKTsKICAgICAgfQoKICAgIC8vIElEIGlzIGEgbWVkaWEgZWxlbWVudAogIH0gZWxzZSB7CiAgICAgIHRhZyA9IGlkOwogICAgfQoKICAvLyBDaGVjayBmb3IgYSB1c2VhYmxlIGVsZW1lbnQKICBpZiAoIXRhZyB8fCAhdGFnLm5vZGVOYW1lKSB7CiAgICAvLyByZTogbm9kZU5hbWUsIGNvdWxkIGJlIGEgYm94IGRpdiBhbHNvCiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgZWxlbWVudCBvciBJRCBzdXBwbGllZCBpcyBub3QgdmFsaWQuICh2aWRlb2pzKScpOyAvLyBSZXR1cm5zCiAgfQoKICAvLyBFbGVtZW50IG1heSBoYXZlIGEgcGxheWVyIGF0dHIgcmVmZXJyaW5nIHRvIGFuIGFscmVhZHkgY3JlYXRlZCBwbGF5ZXIgaW5zdGFuY2UuCiAgLy8gSWYgbm90LCBzZXQgdXAgYSBuZXcgcGxheWVyIGFuZCByZXR1cm4gdGhlIGluc3RhbmNlLgogIHJldHVybiB0YWdbJ3BsYXllciddIHx8IG5ldyBfcGxheWVyMlsnZGVmYXVsdCddKHRhZywgb3B0aW9ucywgcmVhZHkpOwp9OwoKLy8gQWRkIGRlZmF1bHQgc3R5bGVzCnZhciBzdHlsZSA9IERvbS4kKCcudmpzLXN0eWxlcy1kZWZhdWx0cycpOwppZiAoIXN0eWxlKSB7CiAgc3R5bGUgPSBzdHlsZXNoZWV0LmNyZWF0ZVN0eWxlRWxlbWVudCgndmpzLXN0eWxlcy1kZWZhdWx0cycpOwogIHZhciBoZWFkID0gRG9tLiQoJ2hlYWQnKTsKICBoZWFkLmluc2VydEJlZm9yZShzdHlsZSwgaGVhZC5maXJzdENoaWxkKTsKICBzdHlsZXNoZWV0LnNldFRleHRDb250ZW50KHN0eWxlLCAnXG4gICAgLnZpZGVvLWpzIHtcbiAgICAgIHdpZHRoOiAzMDBweDtcbiAgICAgIGhlaWdodDogMTUwcHg7XG4gICAgfVxuXG4gICAgLnZqcy1mbHVpZCB7XG4gICAgICBwYWRkaW5nLXRvcDogNTYuMjUlXG4gICAgfVxuICAnKTsKfQoKLy8gUnVuIEF1dG8tbG9hZCBwbGF5ZXJzCi8vIFlvdSBoYXZlIHRvIHdhaXQgYXQgbGVhc3Qgb25jZSBpbiBjYXNlIHRoaXMgc2NyaXB0IGlzIGxvYWRlZCBhZnRlciB5b3VyIHZpZGVvIGluIHRoZSBET00gKHdlaXJkIGJlaGF2aW9yIG9ubHkgd2l0aCBtaW5pZmllZCB2ZXJzaW9uKQpzZXR1cC5hdXRvU2V0dXBUaW1lb3V0KDEsIHZpZGVvanMpOwoKLyoKICogQ3VycmVudCBzb2Z0d2FyZSB2ZXJzaW9uIChzZW12ZXIpCiAqCiAqIEB0eXBlIHtTdHJpbmd9CiAqLwp2aWRlb2pzLlZFUlNJT04gPSAnNS40LjQnOwoKLyoqCiAqIFRoZSBnbG9iYWwgb3B0aW9ucyBvYmplY3QuIFRoZXNlIGFyZSB0aGUgc2V0dGluZ3MgdGhhdCB0YWtlIGVmZmVjdAogKiBpZiBubyBvdmVycmlkZXMgYXJlIHNwZWNpZmllZCB3aGVuIHRoZSBwbGF5ZXIgaXMgY3JlYXRlZC4KICoKICogYGBganMKICogICAgIHZpZGVvanMub3B0aW9ucy5hdXRvcGxheSA9IHRydWUKICogICAgIC8vIC0+IGFsbCBwbGF5ZXJzIHdpbGwgYXV0b3BsYXkgYnkgZGVmYXVsdAogKiBgYGAKICoKICogQHR5cGUge09iamVjdH0KICovCnZpZGVvanMub3B0aW9ucyA9IF9wbGF5ZXIyWydkZWZhdWx0J10ucHJvdG90eXBlLm9wdGlvbnNfOwoKLyoqCiAqIEdldCBhbiBvYmplY3Qgd2l0aCB0aGUgY3VycmVudGx5IGNyZWF0ZWQgcGxheWVycywga2V5ZWQgYnkgcGxheWVyIElECiAqCiAqIEByZXR1cm4ge09iamVjdH0gVGhlIGNyZWF0ZWQgcGxheWVycwogKiBAbWl4ZXMgdmlkZW9qcwogKiBAbWV0aG9kIGdldFBsYXllcnMKICovCnZpZGVvanMuZ2V0UGxheWVycyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gX3BsYXllcjJbJ2RlZmF1bHQnXS5wbGF5ZXJzOwp9OwoKLyoqCiAqIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5LCBleHBvc2UgcGxheWVycyBvYmplY3QuCiAqCiAqIEBkZXByZWNhdGVkCiAqIEBtZW1iZXJPZiB2aWRlb2pzCiAqIEBwcm9wZXJ0eSB7T2JqZWN0fFByb3h5fSBwbGF5ZXJzCiAqLwp2aWRlb2pzLnBsYXllcnMgPSBfdXRpbHNDcmVhdGVEZXByZWNhdGlvblByb3h5SnMyWydkZWZhdWx0J10oX3BsYXllcjJbJ2RlZmF1bHQnXS5wbGF5ZXJzLCB7CiAgZ2V0OiAnQWNjZXNzIHRvIHZpZGVvanMucGxheWVycyBpcyBkZXByZWNhdGVkOyB1c2UgdmlkZW9qcy5nZXRQbGF5ZXJzIGluc3RlYWQnLAogIHNldDogJ01vZGlmaWNhdGlvbiBvZiB2aWRlb2pzLnBsYXllcnMgaXMgZGVwcmVjYXRlZCcKfSk7CgovKioKICogR2V0IGEgY29tcG9uZW50IGNsYXNzIG9iamVjdCBieSBuYW1lCiAqIGBgYGpzCiAqICAgICB2YXIgVmpzQnV0dG9uID0gdmlkZW9qcy5nZXRDb21wb25lbnQoJ0J1dHRvbicpOwogKiAgICAgLy8gQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBjb21wb25lbnQKICogICAgIHZhciBteUJ1dHRvbiA9IG5ldyBWanNCdXR0b24obXlQbGF5ZXIpOwogKiBgYGAKICoKICogQHJldHVybiB7Q29tcG9uZW50fSBDb21wb25lbnQgaWRlbnRpZmllZCBieSBuYW1lCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgZ2V0Q29tcG9uZW50CiAqLwp2aWRlb2pzLmdldENvbXBvbmVudCA9IF9jb21wb25lbnQyWydkZWZhdWx0J10uZ2V0Q29tcG9uZW50OwoKLyoqCiAqIFJlZ2lzdGVyIGEgY29tcG9uZW50IHNvIGl0IGNhbiByZWZlcnJlZCB0byBieSBuYW1lCiAqIFVzZWQgd2hlbiBhZGRpbmcgdG8gb3RoZXIKICogY29tcG9uZW50cywgZWl0aGVyIHRocm91Z2ggYWRkQ2hpbGQKICogYGNvbXBvbmVudC5hZGRDaGlsZCgnbXlDb21wb25lbnQnKWAKICogb3IgdGhyb3VnaCBkZWZhdWx0IGNoaWxkcmVuIG9wdGlvbnMKICogYHsgY2hpbGRyZW46IFsnbXlDb21wb25lbnQnXSB9YC4KICogYGBganMKICogICAgIC8vIEdldCBhIGNvbXBvbmVudCB0byBzdWJjbGFzcwogKiAgICAgdmFyIFZqc0J1dHRvbiA9IHZpZGVvanMuZ2V0Q29tcG9uZW50KCdCdXR0b24nKTsKICogICAgIC8vIFN1YmNsYXNzIHRoZSBjb21wb25lbnQgKHNlZSAnZXh0ZW5kJyBkb2MgZm9yIG1vcmUgaW5mbykKICogICAgIHZhciBNeVNwZWNpYWxCdXR0b24gPSB2aWRlb2pzLmV4dGVuZChWanNCdXR0b24sIHt9KTsKICogICAgIC8vIFJlZ2lzdGVyIHRoZSBuZXcgY29tcG9uZW50CiAqICAgICBWanNCdXR0b24ucmVnaXN0ZXJDb21wb25lbnQoJ015U2VwY2lhbEJ1dHRvbicsIE15U2VwY2lhbEJ1dHRvbik7CiAqICAgICAvLyAob3B0aW9uYWxseSkgYWRkIHRoZSBuZXcgY29tcG9uZW50IGFzIGEgZGVmYXVsdCBwbGF5ZXIgY2hpbGQKICogICAgIG15UGxheWVyLmFkZENoaWxkKCdNeVNlcGNpYWxCdXR0b24nKTsKICogYGBgCiAqIE5PVEU6IFlvdSBjb3VsZCBhbHNvIGp1c3QgaW5pdGlhbGl6ZSB0aGUgY29tcG9uZW50IGJlZm9yZSBhZGRpbmcuCiAqIGBjb21wb25lbnQuYWRkQ2hpbGQobmV3IE15Q29tcG9uZW50KCkpO2AKICoKICogQHBhcmFtIHtTdHJpbmd9IFRoZSBjbGFzcyBuYW1lIG9mIHRoZSBjb21wb25lbnQKICogQHBhcmFtIHtDb21wb25lbnR9IFRoZSBjb21wb25lbnQgY2xhc3MKICogQHJldHVybiB7Q29tcG9uZW50fSBUaGUgbmV3bHkgcmVnaXN0ZXJlZCBjb21wb25lbnQKICogQG1peGVzIHZpZGVvanMKICogQG1ldGhvZCByZWdpc3RlckNvbXBvbmVudAogKi8KdmlkZW9qcy5yZWdpc3RlckNvbXBvbmVudCA9IGZ1bmN0aW9uIChuYW1lLCBjb21wKSB7CiAgaWYgKF90ZWNoVGVjaEpzMlsnZGVmYXVsdCddLmlzVGVjaChjb21wKSkgewogICAgX3V0aWxzTG9nSnMyWydkZWZhdWx0J10ud2FybignVGhlICcgKyBuYW1lICsgJyB0ZWNoIHdhcyByZWdpc3RlcmVkIGFzIGEgY29tcG9uZW50LiBJdCBzaG91bGQgaW5zdGVhZCBiZSByZWdpc3RlcmVkIHVzaW5nIHZpZGVvanMucmVnaXN0ZXJUZWNoKG5hbWUsIHRlY2gpJyk7CiAgfQoKICBfY29tcG9uZW50MlsnZGVmYXVsdCddLnJlZ2lzdGVyQ29tcG9uZW50LmNhbGwoX2NvbXBvbmVudDJbJ2RlZmF1bHQnXSwgbmFtZSwgY29tcCk7Cn07CgovKioKICogR2V0IGEgVGVjaCBjbGFzcyBvYmplY3QgYnkgbmFtZQogKiBgYGBqcwogKiAgICAgdmFyIEh0bWw1ID0gdmlkZW9qcy5nZXRUZWNoKCdIdG1sNScpOwogKiAgICAgLy8gQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBjb21wb25lbnQKICogICAgIHZhciBodG1sNSA9IG5ldyBIdG1sNShvcHRpb25zKTsKICogYGBgCiAqCiAqIEByZXR1cm4ge1RlY2h9IFRlY2ggaWRlbnRpZmllZCBieSBuYW1lCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgZ2V0Q29tcG9uZW50CiAqLwp2aWRlb2pzLmdldFRlY2ggPSBfdGVjaFRlY2hKczJbJ2RlZmF1bHQnXS5nZXRUZWNoOwoKLyoqCiAqIFJlZ2lzdGVyIGEgVGVjaCBzbyBpdCBjYW4gcmVmZXJyZWQgdG8gYnkgbmFtZS4KICogVGhpcyBpcyB1c2VkIGluIHRoZSB0ZWNoIG9yZGVyIGZvciB0aGUgcGxheWVyLgogKgogKiBgYGBqcwogKiAgICAgLy8gZ2V0IHRoZSBIdG1sNSBUZWNoCiAqICAgICB2YXIgSHRtbDUgPSB2aWRlb2pzLmdldFRlY2goJ0h0bWw1Jyk7CiAqICAgICB2YXIgTXlUZWNoID0gdmlkZW9qcy5leHRlbmQoSHRtbDUsIHt9KTsKICogICAgIC8vIFJlZ2lzdGVyIHRoZSBuZXcgVGVjaAogKiAgICAgVmpzQnV0dG9uLnJlZ2lzdGVyVGVjaCgnVGVjaCcsIE15VGVjaCk7CiAqICAgICB2YXIgcGxheWVyID0gdmlkZW9qcygnbXlwbGF5ZXInLCB7CiAqICAgICAgIHRlY2hPcmRlcjogWydteVRlY2gnLCAnaHRtbDUnXQogKiAgICAgfSk7CiAqIGBgYAogKgogKiBAcGFyYW0ge1N0cmluZ30gVGhlIGNsYXNzIG5hbWUgb2YgdGhlIHRlY2gKICogQHBhcmFtIHtUZWNofSBUaGUgdGVjaCBjbGFzcwogKiBAcmV0dXJuIHtUZWNofSBUaGUgbmV3bHkgcmVnaXN0ZXJlZCBUZWNoCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgcmVnaXN0ZXJUZWNoCiAqLwp2aWRlb2pzLnJlZ2lzdGVyVGVjaCA9IF90ZWNoVGVjaEpzMlsnZGVmYXVsdCddLnJlZ2lzdGVyVGVjaDsKCi8qKgogKiBBIHN1aXRlIG9mIGJyb3dzZXIgYW5kIGRldmljZSB0ZXN0cwogKgogKiBAdHlwZSB7T2JqZWN0fQogKiBAcHJpdmF0ZQogKi8KdmlkZW9qcy5icm93c2VyID0gYnJvd3NlcjsKCi8qKgogKiBXaGV0aGVyIG9yIG5vdCB0aGUgYnJvd3NlciBzdXBwb3J0cyB0b3VjaCBldmVudHMuIEluY2x1ZGVkIGZvciBiYWNrd2FyZAogKiBjb21wYXRpYmlsaXR5IHdpdGggNC54LCBidXQgZGVwcmVjYXRlZC4gVXNlIGB2aWRlb2pzLmJyb3dzZXIuVE9VQ0hfRU5BQkxFRGAKICogaW5zdGVhZCBnb2luZyBmb3J3YXJkLgogKgogKiBAZGVwcmVjYXRlZAogKiBAdHlwZSB7Qm9vbGVhbn0KICovCnZpZGVvanMuVE9VQ0hfRU5BQkxFRCA9IGJyb3dzZXIuVE9VQ0hfRU5BQkxFRDsKCi8qKgogKiBTdWJjbGFzcyBhbiBleGlzdGluZyBjbGFzcwogKiBNaW1pY3MgRVM2IHN1YmNsYXNzaW5nIHdpdGggdGhlIGBleHRlbmRgIGtleXdvcmQKICogYGBganMKICogICAgIC8vIENyZWF0ZSBhIGJhc2ljIGphdmFzY3JpcHQgJ2NsYXNzJwogKiAgICAgZnVuY3Rpb24gTXlDbGFzcyhuYW1lKXsKICogICAgICAgLy8gU2V0IGEgcHJvcGVydHkgYXQgaW5pdGlhbGl6YXRpb24KICogICAgICAgdGhpcy5teU5hbWUgPSBuYW1lOwogKiAgICAgfQogKiAgICAgLy8gQ3JlYXRlIGFuIGluc3RhbmNlIG1ldGhvZAogKiAgICAgTXlDbGFzcy5wcm90b3R5cGUuc2F5TXlOYW1lID0gZnVuY3Rpb24oKXsKICogICAgICAgYWxlcnQodGhpcy5teU5hbWUpOwogKiAgICAgfTsKICogICAgIC8vIFN1YmNsYXNzIHRoZSBleGlzaXRuZyBjbGFzcyBhbmQgY2hhbmdlIHRoZSBuYW1lCiAqICAgICAvLyB3aGVuIGluaXRpYWxpemluZwogKiAgICAgdmFyIE15U3ViQ2xhc3MgPSB2aWRlb2pzLmV4dGVuZChNeUNsYXNzLCB7CiAqICAgICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihuYW1lKSB7CiAqICAgICAgICAgLy8gQ2FsbCB0aGUgc3VwZXIgY2xhc3MgY29uc3RydWN0b3IgZm9yIHRoZSBzdWJjbGFzcwogKiAgICAgICAgIE15Q2xhc3MuY2FsbCh0aGlzLCBuYW1lKQogKiAgICAgICB9CiAqICAgICB9KTsKICogICAgIC8vIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgbmV3IHN1YiBjbGFzcwogKiAgICAgdmFyIG15SW5zdGFuY2UgPSBuZXcgTXlTdWJDbGFzcygnSm9obicpOwogKiAgICAgbXlJbnN0YW5jZS5zYXlNeU5hbWUoKTsgLy8gLT4gc2hvdWxkIGFsZXJ0ICJKb2huIgogKiBgYGAKICoKICogQHBhcmFtIHtGdW5jdGlvbn0gVGhlIENsYXNzIHRvIHN1YmNsYXNzCiAqIEBwYXJhbSB7T2JqZWN0fSBBbiBvYmplY3QgaW5jbHVkaW5nIGluc3RhY2UgbWV0aG9kcyBmb3IgdGhlIG5ldyBjbGFzcwogKiAgICAgICAgICAgICAgICAgICBPcHRpb25hbGx5IGluY2x1ZGluZyBhIGBjb25zdHJ1Y3RvcmAgZnVuY3Rpb24KICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBuZXdseSBjcmVhdGVkIHN1YmNsYXNzCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgZXh0ZW5kCiAqLwp2aWRlb2pzLmV4dGVuZCA9IF9leHRlbmRKczJbJ2RlZmF1bHQnXTsKCi8qKgogKiBNZXJnZSB0d28gb3B0aW9ucyBvYmplY3RzIHJlY3Vyc2l2ZWx5CiAqIFBlcmZvcm1zIGEgZGVlcCBtZXJnZSBsaWtlIGxvZGFzaC5tZXJnZSBidXQgKipvbmx5IG1lcmdlcyBwbGFpbiBvYmplY3RzKioKICogKG5vdCBhcnJheXMsIGVsZW1lbnRzLCBhbnl0aGluZyBlbHNlKQogKiBPdGhlciB2YWx1ZXMgd2lsbCBiZSBjb3BpZWQgZGlyZWN0bHkgZnJvbSB0aGUgc2Vjb25kIG9iamVjdC4KICogYGBganMKICogICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHsKICogICAgICAgZm9vOiB0cnVlLAogKiAgICAgICBiYXI6IHsKICogICAgICAgICBhOiB0cnVlLAogKiAgICAgICAgIGI6IFsxLDIsM10KICogICAgICAgfQogKiAgICAgfTsKICogICAgIHZhciBuZXdPcHRpb25zID0gewogKiAgICAgICBmb286IGZhbHNlLAogKiAgICAgICBiYXI6IHsKICogICAgICAgICBiOiBbNCw1LDZdCiAqICAgICAgIH0KICogICAgIH07CiAqICAgICB2YXIgcmVzdWx0ID0gdmlkZW9qcy5tZXJnZU9wdGlvbnMoZGVmYXVsdE9wdGlvbnMsIG5ld09wdGlvbnMpOwogKiAgICAgLy8gcmVzdWx0LmZvbyA9IGZhbHNlOwogKiAgICAgLy8gcmVzdWx0LmJhci5hID0gdHJ1ZTsKICogICAgIC8vIHJlc3VsdC5iYXIuYiA9IFs0LDUsNl07CiAqIGBgYAogKgogKiBAcGFyYW0ge09iamVjdH0gZGVmYXVsdHMgIFRoZSBvcHRpb25zIG9iamVjdCB3aG9zZSB2YWx1ZXMgd2lsbCBiZSBvdmVycmlkZW4KICogQHBhcmFtIHtPYmplY3R9IG92ZXJyaWRlcyBUaGUgb3B0aW9ucyBvYmplY3Qgd2l0aCB2YWx1ZXMgdG8gb3ZlcnJpZGUgdGhlIGZpcnN0CiAqIEBwYXJhbSB7T2JqZWN0fSBldGMgICAgICAgQW55IG51bWJlciBvZiBhZGRpdGlvbmFsIG9wdGlvbnMgb2JqZWN0cwogKgogKiBAcmV0dXJuIHtPYmplY3R9IGEgbmV3IG9iamVjdCB3aXRoIHRoZSBtZXJnZWQgdmFsdWVzCiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgbWVyZ2VPcHRpb25zCiAqLwp2aWRlb2pzLm1lcmdlT3B0aW9ucyA9IF9zcmNKc1V0aWxzTWVyZ2VPcHRpb25zSnMyWydkZWZhdWx0J107CgovKioKICogQ2hhbmdlIHRoZSBjb250ZXh0ICh0aGlzKSBvZiBhIGZ1bmN0aW9uCiAqCiAqICAgICB2aWRlb2pzLmJpbmQobmV3Q29udGV4dCwgZnVuY3Rpb24oKXsKICogICAgICAgdGhpcyA9PT0gbmV3Q29udGV4dAogKiAgICAgfSk7CiAqCiAqIE5PVEU6IGFzIG9mIHY1LjAgd2UgcmVxdWlyZSBhbiBFUzUgc2hpbSwgc28geW91IHNob3VsZCB1c2UgdGhlIG5hdGl2ZQogKiBgZnVuY3Rpb24oKXt9LmJpbmQobmV3Q29udGV4dCk7YCBpbnN0ZWFkIG9mIHRoaXMuCiAqCiAqIEBwYXJhbSAgeyp9ICAgICAgICBjb250ZXh0IFRoZSBvYmplY3QgdG8gYmluZCBhcyBzY29wZQogKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gICAgICBUaGUgZnVuY3Rpb24gdG8gYmUgYm91bmQgdG8gYSBzY29wZQogKiBAcGFyYW0gIHtOdW1iZXI9fSAgdWlkICAgICBBbiBvcHRpb25hbCB1bmlxdWUgSUQgZm9yIHRoZSBmdW5jdGlvbiB0byBiZSBzZXQKICogQHJldHVybiB7RnVuY3Rpb259CiAqLwp2aWRlb2pzLmJpbmQgPSBGbi5iaW5kOwoKLyoqCiAqIENyZWF0ZSBhIFZpZGVvLmpzIHBsYXllciBwbHVnaW4KICogUGx1Z2lucyBhcmUgb25seSBpbml0aWFsaXplZCB3aGVuIG9wdGlvbnMgZm9yIHRoZSBwbHVnaW4gYXJlIGluY2x1ZGVkCiAqIGluIHRoZSBwbGF5ZXIgb3B0aW9ucywgb3IgdGhlIHBsdWdpbiBmdW5jdGlvbiBvbiB0aGUgcGxheWVyIGluc3RhbmNlIGlzCiAqIGNhbGxlZC4KICogKipTZWUgdGhlIHBsdWdpbiBndWlkZSBpbiB0aGUgZG9jcyBmb3IgYSBtb3JlIGRldGFpbGVkIGV4YW1wbGUqKgogKiBgYGBqcwogKiAgICAgLy8gTWFrZSBhIHBsdWdpbiB0aGF0IGFsZXJ0cyB3aGVuIHRoZSBwbGF5ZXIgcGxheXMKICogICAgIHZpZGVvanMucGx1Z2luKCdteVBsdWdpbicsIGZ1bmN0aW9uKG15UGx1Z2luT3B0aW9ucykgewogKiAgICAgICBteVBsdWdpbk9wdGlvbnMgPSBteVBsdWdpbk9wdGlvbnMgfHwge307CiAqCiAqICAgICAgIHZhciBwbGF5ZXIgPSB0aGlzOwogKiAgICAgICB2YXIgYWxlcnRUZXh0ID0gbXlQbHVnaW5PcHRpb25zLnRleHQgfHwgJ1BsYXllciBpcyBwbGF5aW5nIScKICoKICogICAgICAgcGxheWVyLm9uKCdwbGF5JywgZnVuY3Rpb24oKXsKICogICAgICAgICBhbGVydChhbGVydFRleHQpOwogKiAgICAgICB9KTsKICogICAgIH0pOwogKiAgICAgLy8gVVNBR0UgRVhBTVBMRVMKICogICAgIC8vIEVYQU1QTEUgMTogTmV3IHBsYXllciB3aXRoIHBsdWdpbiBvcHRpb25zLCBjYWxsIHBsdWdpbiBpbW1lZGlhdGVseQogKiAgICAgdmFyIHBsYXllcjEgPSB2aWRlb2pzKCdpZE9uZScsIHsKICogICAgICAgbXlQbHVnaW46IHsKICogICAgICAgICB0ZXh0OiAnQ3VzdG9tIHRleHQhJwogKiAgICAgICB9CiAqICAgICB9KTsKICogICAgIC8vIENsaWNrIHBsYXkKICogICAgIC8vIC0tPiBTaG91bGQgYWxlcnQgJ0N1c3RvbSB0ZXh0IScKICogICAgIC8vIEVYQU1QTEUgMzogTmV3IHBsYXllciwgaW5pdGlhbGl6ZSBwbHVnaW4gbGF0ZXIKICogICAgIHZhciBwbGF5ZXIzID0gdmlkZW9qcygnaWRUaHJlZScpOwogKiAgICAgLy8gQ2xpY2sgcGxheQogKiAgICAgLy8gLS0+IE5PIEFMRVJUCiAqICAgICAvLyBDbGljayBwYXVzZQogKiAgICAgLy8gSW5pdGlhbGl6ZSBwbHVnaW4gdXNpbmcgdGhlIHBsdWdpbiBmdW5jdGlvbiBvbiB0aGUgcGxheWVyIGluc3RhbmNlCiAqICAgICBwbGF5ZXIzLm15UGx1Z2luKHsKICogICAgICAgdGV4dDogJ1BsdWdpbiBhZGRlZCBsYXRlciEnCiAqICAgICB9KTsKICogICAgIC8vIENsaWNrIHBsYXkKICogICAgIC8vIC0tPiBTaG91bGQgYWxlcnQgJ1BsdWdpbiBhZGRlZCBsYXRlciEnCiAqIGBgYAogKgogKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgcGx1Z2luIG5hbWUKICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHBsdWdpbiBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdpdGggb3B0aW9ucwogKiBAbWl4ZXMgdmlkZW9qcwogKiBAbWV0aG9kIHBsdWdpbgogKi8KdmlkZW9qcy5wbHVnaW4gPSBfcGx1Z2luc0pzMlsnZGVmYXVsdCddOwoKLyoqCiAqIEFkZGluZyBsYW5ndWFnZXMgc28gdGhhdCB0aGV5J3JlIGF2YWlsYWJsZSB0byBhbGwgcGxheWVycy4KICogYGBganMKICogICAgIHZpZGVvanMuYWRkTGFuZ3VhZ2UoJ2VzJywgeyAnSGVsbG8nOiAnSG9sYScgfSk7CiAqIGBgYAogKgogKiBAcGFyYW0gIHtTdHJpbmd9IGNvZGUgVGhlIGxhbmd1YWdlIGNvZGUgb3IgZGljdGlvbmFyeSBwcm9wZXJ0eQogKiBAcGFyYW0gIHtPYmplY3R9IGRhdGEgVGhlIGRhdGEgdmFsdWVzIHRvIGJlIHRyYW5zbGF0ZWQKICogQHJldHVybiB7T2JqZWN0fSBUaGUgcmVzdWx0aW5nIGxhbmd1YWdlIGRpY3Rpb25hcnkgb2JqZWN0CiAqIEBtaXhlcyB2aWRlb2pzCiAqIEBtZXRob2QgYWRkTGFuZ3VhZ2UKICovCnZpZGVvanMuYWRkTGFuZ3VhZ2UgPSBmdW5jdGlvbiAoY29kZSwgZGF0YSkgewogIHZhciBfbWVyZ2U7CgogIGNvZGUgPSAoJycgKyBjb2RlKS50b0xvd2VyQ2FzZSgpOwogIHJldHVybiBfbG9kYXNoQ29tcGF0T2JqZWN0TWVyZ2UyWydkZWZhdWx0J10odmlkZW9qcy5vcHRpb25zLmxhbmd1YWdlcywgKF9tZXJnZSA9IHt9LCBfbWVyZ2VbY29kZV0gPSBkYXRhLCBfbWVyZ2UpKVtjb2RlXTsKfTsKCi8qKgogKiBMb2cgZGVidWcgbWVzc2FnZXMuCiAqCiAqIEBwYXJhbSB7Li4uT2JqZWN0fSBtZXNzYWdlcyBPbmUgb3IgbW9yZSBtZXNzYWdlcyB0byBsb2cKICovCnZpZGVvanMubG9nID0gX3V0aWxzTG9nSnMyWydkZWZhdWx0J107CgovKioKICogQ3JlYXRlcyBhbiBlbXVsYXRlZCBUaW1lUmFuZ2Ugb2JqZWN0LgogKgogKiBAcGFyYW0gIHtOdW1iZXJ8QXJyYXl9IHN0YXJ0IFN0YXJ0IHRpbWUgaW4gc2Vjb25kcyBvciBhbiBhcnJheSBvZiByYW5nZXMKICogQHBhcmFtICB7TnVtYmVyfSBlbmQgICBFbmQgdGltZSBpbiBzZWNvbmRzCiAqIEByZXR1cm4ge09iamVjdH0gICAgICAgRmFrZSBUaW1lUmFuZ2Ugb2JqZWN0CiAqIEBtZXRob2QgY3JlYXRlVGltZVJhbmdlCiAqLwp2aWRlb2pzLmNyZWF0ZVRpbWVSYW5nZSA9IHZpZGVvanMuY3JlYXRlVGltZVJhbmdlcyA9IF91dGlsc1RpbWVSYW5nZXNKcy5jcmVhdGVUaW1lUmFuZ2VzOwoKLyoqCiAqIEZvcm1hdCBzZWNvbmRzIGFzIGEgdGltZSBzdHJpbmcsIEg6TU06U1Mgb3IgTTpTUwogKiBTdXBwbHlpbmcgYSBndWlkZSAoaW4gc2Vjb25kcykgd2lsbCBmb3JjZSBhIG51bWJlciBvZiBsZWFkaW5nIHplcm9zCiAqIHRvIGNvdmVyIHRoZSBsZW5ndGggb2YgdGhlIGd1aWRlCiAqCiAqIEBwYXJhbSAge051bWJlcn0gc2Vjb25kcyBOdW1iZXIgb2Ygc2Vjb25kcyB0byBiZSB0dXJuZWQgaW50byBhIHN0cmluZwogKiBAcGFyYW0gIHtOdW1iZXJ9IGd1aWRlICAgTnVtYmVyIChpbiBzZWNvbmRzKSB0byBtb2RlbCB0aGUgc3RyaW5nIGFmdGVyCiAqIEByZXR1cm4ge1N0cmluZ30gICAgICAgICBUaW1lIGZvcm1hdHRlZCBhcyBIOk1NOlNTIG9yIE06U1MKICogQG1ldGhvZCBmb3JtYXRUaW1lCiAqLwp2aWRlb2pzLmZvcm1hdFRpbWUgPSBfdXRpbHNGb3JtYXRUaW1lSnMyWydkZWZhdWx0J107CgovKioKICogUmVzb2x2ZSBhbmQgcGFyc2UgdGhlIGVsZW1lbnRzIG9mIGEgVVJMCiAqCiAqIEBwYXJhbSAge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gcGFyc2UKICogQHJldHVybiB7T2JqZWN0fSAgICAgQW4gb2JqZWN0IG9mIHVybCBkZXRhaWxzCiAqIEBtZXRob2QgcGFyc2VVcmwKICovCnZpZGVvanMucGFyc2VVcmwgPSBVcmwucGFyc2VVcmw7CgovKioKICogUmV0dXJucyB3aGV0aGVyIHRoZSB1cmwgcGFzc2VkIGlzIGEgY3Jvc3MgZG9tYWluIHJlcXVlc3Qgb3Igbm90LgogKgogKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gY2hlY2sKICogQHJldHVybiB7Qm9vbGVhbn0gICBXaGV0aGVyIGl0IGlzIGEgY3Jvc3MgZG9tYWluIHJlcXVlc3Qgb3Igbm90CiAqIEBtZXRob2QgaXNDcm9zc09yaWdpbgogKi8KdmlkZW9qcy5pc0Nyb3NzT3JpZ2luID0gVXJsLmlzQ3Jvc3NPcmlnaW47CgovKioKICogRXZlbnQgdGFyZ2V0IGNsYXNzLgogKgogKiBAdHlwZSB7RnVuY3Rpb259CiAqLwp2aWRlb2pzLkV2ZW50VGFyZ2V0ID0gX2V2ZW50VGFyZ2V0MlsnZGVmYXVsdCddOwoKLyoqCiAqIEFkZCBhbiBldmVudCBsaXN0ZW5lciB0byBlbGVtZW50CiAqIEl0IHN0b3JlcyB0aGUgaGFuZGxlciBmdW5jdGlvbiBpbiBhIHNlcGFyYXRlIGNhY2hlIG9iamVjdAogKiBhbmQgYWRkcyBhIGdlbmVyaWMgaGFuZGxlciB0byB0aGUgZWxlbWVudCdzIGV2ZW50LAogKiBhbG9uZyB3aXRoIGEgdW5pcXVlIGlkIChndWlkKSB0byB0aGUgZWxlbWVudC4KICoKICogQHBhcmFtICB7RWxlbWVudHxPYmplY3R9ICAgZWxlbSBFbGVtZW50IG9yIG9iamVjdCB0byBiaW5kIGxpc3RlbmVycyB0bwogKiBAcGFyYW0gIHtTdHJpbmd8QXJyYXl9ICAgdHlwZSBUeXBlIG9mIGV2ZW50IHRvIGJpbmQgdG8uCiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiAgIEV2ZW50IGxpc3RlbmVyLgogKiBAbWV0aG9kIG9uCiAqLwp2aWRlb2pzLm9uID0gRXZlbnRzLm9uOwoKLyoqCiAqIFRyaWdnZXIgYSBsaXN0ZW5lciBvbmx5IG9uY2UgZm9yIGFuIGV2ZW50CiAqCiAqIEBwYXJhbSAge0VsZW1lbnR8T2JqZWN0fSAgIGVsZW0gRWxlbWVudCBvciBvYmplY3QgdG8KICogQHBhcmFtICB7U3RyaW5nfEFycmF5fSAgIHR5cGUgTmFtZS90eXBlIG9mIGV2ZW50CiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiBFdmVudCBoYW5kbGVyIGZ1bmN0aW9uCiAqIEBtZXRob2Qgb25lCiAqLwp2aWRlb2pzLm9uZSA9IEV2ZW50cy5vbmU7CgovKioKICogUmVtb3ZlcyBldmVudCBsaXN0ZW5lcnMgZnJvbSBhbiBlbGVtZW50CiAqCiAqIEBwYXJhbSAge0VsZW1lbnR8T2JqZWN0fSAgIGVsZW0gT2JqZWN0IHRvIHJlbW92ZSBsaXN0ZW5lcnMgZnJvbQogKiBAcGFyYW0gIHtTdHJpbmd8QXJyYXk9fSAgIHR5cGUgVHlwZSBvZiBsaXN0ZW5lciB0byByZW1vdmUuIERvbid0IGluY2x1ZGUgdG8gcmVtb3ZlIGFsbCBldmVudHMgZnJvbSBlbGVtZW50LgogKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gICBTcGVjaWZpYyBsaXN0ZW5lciB0byByZW1vdmUuIERvbid0IGluY2x1ZGUgdG8gcmVtb3ZlIGxpc3RlbmVycyBmb3IgYW4gZXZlbnQgdHlwZS4KICogQG1ldGhvZCBvZmYKICovCnZpZGVvanMub2ZmID0gRXZlbnRzLm9mZjsKCi8qKgogKiBUcmlnZ2VyIGFuIGV2ZW50IGZvciBhbiBlbGVtZW50CiAqCiAqIEBwYXJhbSAge0VsZW1lbnR8T2JqZWN0fSAgICAgIGVsZW0gIEVsZW1lbnQgdG8gdHJpZ2dlciBhbiBldmVudCBvbgogKiBAcGFyYW0gIHtFdmVudHxPYmplY3R8U3RyaW5nfSBldmVudCBBIHN0cmluZyAodGhlIHR5cGUpIG9yIGFuIGV2ZW50IG9iamVjdCB3aXRoIGEgdHlwZSBhdHRyaWJ1dGUKICogQHBhcmFtICB7T2JqZWN0fSBbaGFzaF0gZGF0YSBoYXNoIHRvIHBhc3MgYWxvbmcgd2l0aCB0aGUgZXZlbnQKICogQHJldHVybiB7Qm9vbGVhbj19IFJldHVybmVkIG9ubHkgaWYgZGVmYXVsdCB3YXMgcHJldmVudGVkCiAqIEBtZXRob2QgdHJpZ2dlcgogKi8KdmlkZW9qcy50cmlnZ2VyID0gRXZlbnRzLnRyaWdnZXI7CgovKioKICogQSBjcm9zcy1icm93c2VyIFhNTEh0dHBSZXF1ZXN0IHdyYXBwZXIuIEhlcmUncyBhIHNpbXBsZSBleGFtcGxlOgogKgogKiAgICAgdmlkZW9qcy54aHIoewogKiAgICAgICBib2R5OiBzb21lSlNPTlN0cmluZywKICogICAgICAgdXJpOiAiL2ZvbyIsCiAqICAgICAgIGhlYWRlcnM6IHsKICogICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iCiAqICAgICAgIH0KICogICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlc3AsIGJvZHkpIHsKICogICAgICAgLy8gY2hlY2sgcmVzcC5zdGF0dXNDb2RlCiAqICAgICB9KTsKICoKICogQ2hlY2sgb3V0IHRoZSBbZnVsbAogKiBkb2N1bWVudGF0aW9uXShodHRwczovL2dpdGh1Yi5jb20vUmF5bm9zL3hoci9ibG9iL3YyLjEuMC9SRUFETUUubWQpCiAqIGZvciBtb3JlIG9wdGlvbnMuCiAqCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIHNldHRpbmdzIGZvciB0aGUgcmVxdWVzdC4KICogQHJldHVybiB7WE1MSHR0cFJlcXVlc3R8WERvbWFpblJlcXVlc3R9IHRoZSByZXF1ZXN0IG9iamVjdC4KICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vUmF5bm9zL3hocgogKi8KdmlkZW9qcy54aHIgPSBfeGhyMlsnZGVmYXVsdCddOwoKLyoqCiAqIFRleHRUcmFjayBjbGFzcwogKgogKiBAdHlwZSB7RnVuY3Rpb259CiAqLwp2aWRlb2pzLlRleHRUcmFjayA9IF90cmFja3NUZXh0VHJhY2tKczJbJ2RlZmF1bHQnXTsKCi8qKgogKiBEZXRlcm1pbmVzLCB2aWEgZHVjayB0eXBpbmcsIHdoZXRoZXIgb3Igbm90IGEgdmFsdWUgaXMgYSBET00gZWxlbWVudC4KICoKICogQG1ldGhvZCBpc0VsCiAqIEBwYXJhbSAge01peGVkfSB2YWx1ZQogKiBAcmV0dXJuIHtCb29sZWFufQogKi8KdmlkZW9qcy5pc0VsID0gRG9tLmlzRWw7CgovKioKICogRGV0ZXJtaW5lcywgdmlhIGR1Y2sgdHlwaW5nLCB3aGV0aGVyIG9yIG5vdCBhIHZhbHVlIGlzIGEgdGV4dCBub2RlLgogKgogKiBAbWV0aG9kIGlzVGV4dE5vZGUKICogQHBhcmFtICB7TWl4ZWR9IHZhbHVlCiAqIEByZXR1cm4ge0Jvb2xlYW59CiAqLwp2aWRlb2pzLmlzVGV4dE5vZGUgPSBEb20uaXNUZXh0Tm9kZTsKCi8qKgogKiBDaGVjayBpZiBhbiBlbGVtZW50IGhhcyBhIENTUyBjbGFzcwogKgogKiBAbWV0aG9kIGhhc0NsYXNzCiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBFbGVtZW50IHRvIGNoZWNrCiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvQ2hlY2sgQ2xhc3NuYW1lIHRvIGNoZWNrCiAqLwp2aWRlb2pzLmhhc0NsYXNzID0gRG9tLmhhc0VsQ2xhc3M7CgovKioKICogQWRkIGEgQ1NTIGNsYXNzIG5hbWUgdG8gYW4gZWxlbWVudAogKgogKiBAbWV0aG9kIGFkZENsYXNzCiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAgICBFbGVtZW50IHRvIGFkZCBjbGFzcyBuYW1lIHRvCiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvQWRkIENsYXNzbmFtZSB0byBhZGQKICovCnZpZGVvanMuYWRkQ2xhc3MgPSBEb20uYWRkRWxDbGFzczsKCi8qKgogKiBSZW1vdmUgYSBDU1MgY2xhc3MgbmFtZSBmcm9tIGFuIGVsZW1lbnQKICoKICogQG1ldGhvZCByZW1vdmVDbGFzcwogKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgICAgRWxlbWVudCB0byByZW1vdmUgZnJvbSBjbGFzcyBuYW1lCiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc1RvUmVtb3ZlIENsYXNzbmFtZSB0byByZW1vdmUKICovCnZpZGVvanMucmVtb3ZlQ2xhc3MgPSBEb20ucmVtb3ZlRWxDbGFzczsKCi8qKgogKiBBZGRzIG9yIHJlbW92ZXMgYSBDU1MgY2xhc3MgbmFtZSBvbiBhbiBlbGVtZW50IGRlcGVuZGluZyBvbiBhbiBvcHRpb25hbAogKiBjb25kaXRpb24gb3IgdGhlIHByZXNlbmNlL2Fic2VuY2Ugb2YgdGhlIGNsYXNzIG5hbWUuCiAqCiAqIEBtZXRob2QgdG9nZ2xlRWxDbGFzcwogKiBAcGFyYW0gIHtFbGVtZW50fSBlbGVtZW50CiAqIEBwYXJhbSAge1N0cmluZ30gY2xhc3NUb1RvZ2dsZQogKiBAcGFyYW0gIHtCb29sZWFufEZ1bmN0aW9ufSBbcHJlZGljYXRlXQogKiAgICAgICAgIENhbiBiZSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIEJvb2xlYW4uIElmIGB0cnVlYCwgdGhlIGNsYXNzCiAqICAgICAgICAgd2lsbCBiZSBhZGRlZDsgaWYgYGZhbHNlYCwgdGhlIGNsYXNzIHdpbGwgYmUgcmVtb3ZlZC4gSWYgbm90CiAqICAgICAgICAgZ2l2ZW4sIHRoZSBjbGFzcyB3aWxsIGJlIGFkZGVkIGlmIG5vdCBwcmVzZW50IGFuZCB2aWNlIHZlcnNhLgogKi8KdmlkZW9qcy50b2dnbGVDbGFzcyA9IERvbS50b2dnbGVFbENsYXNzOwoKLyoqCiAqIEFwcGx5IGF0dHJpYnV0ZXMgdG8gYW4gSFRNTCBlbGVtZW50LgogKgogKiBAbWV0aG9kIHNldEF0dHJpYnV0ZXMKICogQHBhcmFtICB7RWxlbWVudH0gZWwgICAgICAgICBUYXJnZXQgZWxlbWVudC4KICogQHBhcmFtICB7T2JqZWN0PX0gYXR0cmlidXRlcyBFbGVtZW50IGF0dHJpYnV0ZXMgdG8gYmUgYXBwbGllZC4KICovCnZpZGVvanMuc2V0QXR0cmlidXRlcyA9IERvbS5zZXRFbEF0dHJpYnV0ZXM7CgovKioKICogR2V0IGFuIGVsZW1lbnQncyBhdHRyaWJ1dGUgdmFsdWVzLCBhcyBkZWZpbmVkIG9uIHRoZSBIVE1MIHRhZwogKiBBdHRyaWJ1dGVzIGFyZSBub3QgdGhlIHNhbWUgYXMgcHJvcGVydGllcy4gVGhleSdyZSBkZWZpbmVkIG9uIHRoZSB0YWcKICogb3Igd2l0aCBzZXRBdHRyaWJ1dGUgKHdoaWNoIHNob3VsZG4ndCBiZSB1c2VkIHdpdGggSFRNTCkKICogVGhpcyB3aWxsIHJldHVybiB0cnVlIG9yIGZhbHNlIGZvciBib29sZWFuIGF0dHJpYnV0ZXMuCiAqCiAqIEBtZXRob2QgZ2V0QXR0cmlidXRlcwogKiBAcGFyYW0gIHtFbGVtZW50fSB0YWcgRWxlbWVudCBmcm9tIHdoaWNoIHRvIGdldCB0YWcgYXR0cmlidXRlcwogKiBAcmV0dXJuIHtPYmplY3R9CiAqLwp2aWRlb2pzLmdldEF0dHJpYnV0ZXMgPSBEb20uZ2V0RWxBdHRyaWJ1dGVzOwoKLyoqCiAqIEVtcHRpZXMgdGhlIGNvbnRlbnRzIG9mIGFuIGVsZW1lbnQuCiAqCiAqIEBtZXRob2QgZW1wdHlFbAogKiBAcGFyYW0gIHtFbGVtZW50fSBlbAogKiBAcmV0dXJuIHtFbGVtZW50fQogKi8KdmlkZW9qcy5lbXB0eUVsID0gRG9tLmVtcHR5RWw7CgovKioKICogTm9ybWFsaXplcyBhbmQgYXBwZW5kcyBjb250ZW50IHRvIGFuIGVsZW1lbnQuCiAqCiAqIFRoZSBjb250ZW50IGZvciBhbiBlbGVtZW50IGNhbiBiZSBwYXNzZWQgaW4gbXVsdGlwbGUgdHlwZXMgYW5kCiAqIGNvbWJpbmF0aW9ucywgd2hvc2UgYmVoYXZpb3IgaXMgYXMgZm9sbG93czoKICoKICogLSBTdHJpbmcKICogICBOb3JtYWxpemVkIGludG8gYSB0ZXh0IG5vZGUuCiAqCiAqIC0gRWxlbWVudCwgVGV4dE5vZGUKICogICBQYXNzZWQgdGhyb3VnaC4KICoKICogLSBBcnJheQogKiAgIEEgb25lLWRpbWVuc2lvbmFsIGFycmF5IG9mIHN0cmluZ3MsIGVsZW1lbnRzLCBub2Rlcywgb3IgZnVuY3Rpb25zICh3aGljaAogKiAgIHJldHVybiBzaW5nbGUgc3RyaW5ncywgZWxlbWVudHMsIG9yIG5vZGVzKS4KICoKICogLSBGdW5jdGlvbgogKiAgIElmIHRoZSBzb2xlIGFyZ3VtZW50LCBpcyBleHBlY3RlZCB0byBwcm9kdWNlIGEgc3RyaW5nLCBlbGVtZW50LAogKiAgIG5vZGUsIG9yIGFycmF5LgogKgogKiBAbWV0aG9kIGFwcGVuZENvbnRlbnQKICogQHBhcmFtICB7RWxlbWVudH0gZWwKICogQHBhcmFtICB7U3RyaW5nfEVsZW1lbnR8VGV4dE5vZGV8QXJyYXl8RnVuY3Rpb259IGNvbnRlbnQKICogQHJldHVybiB7RWxlbWVudH0KICovCnZpZGVvanMuYXBwZW5kQ29udGVudCA9IERvbS5hcHBlbmRDb250ZW50OwoKLyoqCiAqIE5vcm1hbGl6ZXMgYW5kIGluc2VydHMgY29udGVudCBpbnRvIGFuIGVsZW1lbnQ7IHRoaXMgaXMgaWRlbnRpY2FsIHRvCiAqIGBhcHBlbmRDb250ZW50KClgLCBleGNlcHQgaXQgZW1wdGllcyB0aGUgZWxlbWVudCBmaXJzdC4KICoKICogVGhlIGNvbnRlbnQgZm9yIGFuIGVsZW1lbnQgY2FuIGJlIHBhc3NlZCBpbiBtdWx0aXBsZSB0eXBlcyBhbmQKICogY29tYmluYXRpb25zLCB3aG9zZSBiZWhhdmlvciBpcyBhcyBmb2xsb3dzOgogKgogKiAtIFN0cmluZwogKiAgIE5vcm1hbGl6ZWQgaW50byBhIHRleHQgbm9kZS4KICoKICogLSBFbGVtZW50LCBUZXh0Tm9kZQogKiAgIFBhc3NlZCB0aHJvdWdoLgogKgogKiAtIEFycmF5CiAqICAgQSBvbmUtZGltZW5zaW9uYWwgYXJyYXkgb2Ygc3RyaW5ncywgZWxlbWVudHMsIG5vZGVzLCBvciBmdW5jdGlvbnMgKHdoaWNoCiAqICAgcmV0dXJuIHNpbmdsZSBzdHJpbmdzLCBlbGVtZW50cywgb3Igbm9kZXMpLgogKgogKiAtIEZ1bmN0aW9uCiAqICAgSWYgdGhlIHNvbGUgYXJndW1lbnQsIGlzIGV4cGVjdGVkIHRvIHByb2R1Y2UgYSBzdHJpbmcsIGVsZW1lbnQsCiAqICAgbm9kZSwgb3IgYXJyYXkuCiAqCiAqIEBtZXRob2QgaW5zZXJ0Q29udGVudAogKiBAcGFyYW0gIHtFbGVtZW50fSBlbAogKiBAcGFyYW0gIHtTdHJpbmd8RWxlbWVudHxUZXh0Tm9kZXxBcnJheXxGdW5jdGlvbn0gY29udGVudAogKiBAcmV0dXJuIHtFbGVtZW50fQogKi8KdmlkZW9qcy5pbnNlcnRDb250ZW50ID0gRG9tLmluc2VydENvbnRlbnQ7CgovKgogKiBDdXN0b20gVW5pdmVyc2FsIE1vZHVsZSBEZWZpbml0aW9uIChVTUQpCiAqCiAqIFZpZGVvLmpzIHdpbGwgbmV2ZXIgYmUgYSBub24tYnJvd3NlciBsaWIgc28gd2UgY2FuIHNpbXBsaWZ5IFVNRCBhIGJ1bmNoIGFuZAogKiBzdGlsbCBzdXBwb3J0IHJlcXVpcmVqcyBhbmQgYnJvd3NlcmlmeS4gVGhpcyBhbHNvIG5lZWRzIHRvIGJlIGNsb3N1cmUKICogY29tcGlsZXIgY29tcGF0aWJsZSwgc28gc3RyaW5nIGtleXMgYXJlIHVzZWQuCiAqLwppZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmVbJ2FtZCddKSB7CiAgZGVmaW5lKCd2aWRlb2pzJywgW10sIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB2aWRlb2pzOwogIH0pOwoKICAvLyBjaGVja2luZyB0aGF0IG1vZHVsZSBpcyBhbiBvYmplY3QgdG9vIGJlY2F1c2Ugb2YgdW1kanMvdW1kIzM1Cn0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKSB7CiAgICBtb2R1bGVbJ2V4cG9ydHMnXSA9IHZpZGVvanM7CiAgfQoKZXhwb3J0c1snZGVmYXVsdCddID0gdmlkZW9qczsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi4vLi4vc3JjL2pzL3V0aWxzL21lcmdlLW9wdGlvbnMuanMiOjEzNCwiLi9jb21wb25lbnQiOjY1LCIuL2V2ZW50LXRhcmdldCI6OTcsIi4vZXh0ZW5kLmpzIjo5OCwiLi9wbGF5ZXIiOjEwNiwiLi9wbHVnaW5zLmpzIjoxMDcsIi4vc2V0dXAiOjEwOSwiLi90ZWNoL2ZsYXNoLmpzIjoxMTIsIi4vdGVjaC9odG1sNS5qcyI6MTEzLCIuL3RlY2gvdGVjaC5qcyI6MTE1LCIuL3RyYWNrcy90ZXh0LXRyYWNrLmpzIjoxMjQsIi4vdXRpbHMvYnJvd3Nlci5qcyI6MTI1LCIuL3V0aWxzL2NyZWF0ZS1kZXByZWNhdGlvbi1wcm94eS5qcyI6MTI3LCIuL3V0aWxzL2RvbS5qcyI6MTI4LCIuL3V0aWxzL2V2ZW50cy5qcyI6MTI5LCIuL3V0aWxzL2ZuLmpzIjoxMzAsIi4vdXRpbHMvZm9ybWF0LXRpbWUuanMiOjEzMSwiLi91dGlscy9sb2cuanMiOjEzMywiLi91dGlscy9zdHlsZXNoZWV0LmpzIjoxMzUsIi4vdXRpbHMvdGltZS1yYW5nZXMuanMiOjEzNiwiLi91dGlscy91cmwuanMiOjEzOCwiZ2xvYmFsL2RvY3VtZW50IjoxLCJsb2Rhc2gtY29tcGF0L29iamVjdC9tZXJnZSI6NDAsIm9iamVjdC5hc3NpZ24iOjQ1LCJ4aHIiOjU1fV19LHt9LFsxMzldKSgxMzkpCn0pOwoKCi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZGVvLmpzLm1hcAovKiB2dHQuanMgLSB2MC4xMi4xIChodHRwczovL2dpdGh1Yi5jb20vbW96aWxsYS92dHQuanMpIGJ1aWx0IG9uIDA4LTA3LTIwMTUgKi8KCihmdW5jdGlvbihyb290KSB7CiAgdmFyIHZ0dGpzID0gcm9vdC52dHRqcyA9IHt9OwogIHZhciBjdWVTaGltID0gdnR0anMuVlRUQ3VlOwogIHZhciByZWdpb25TaGltID0gdnR0anMuVlRUUmVnaW9uOwogIHZhciBvbGRWVFRDdWUgPSByb290LlZUVEN1ZTsKICB2YXIgb2xkVlRUUmVnaW9uID0gcm9vdC5WVFRSZWdpb247CgogIHZ0dGpzLnNoaW0gPSBmdW5jdGlvbigpIHsKICAgIHZ0dGpzLlZUVEN1ZSA9IGN1ZVNoaW07CiAgICB2dHRqcy5WVFRSZWdpb24gPSByZWdpb25TaGltOwogIH07CgogIHZ0dGpzLnJlc3RvcmUgPSBmdW5jdGlvbigpIHsKICAgIHZ0dGpzLlZUVEN1ZSA9IG9sZFZUVEN1ZTsKICAgIHZ0dGpzLlZUVFJlZ2lvbiA9IG9sZFZUVFJlZ2lvbjsKICB9Owp9KHRoaXMpKTsKCi8qKgogKiBDb3B5cmlnaHQgMjAxMyB2dHQuanMgQ29udHJpYnV0b3JzCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCihmdW5jdGlvbihyb290LCB2dHRqcykgewoKICB2YXIgYXV0b0tleXdvcmQgPSAiYXV0byI7CiAgdmFyIGRpcmVjdGlvblNldHRpbmcgPSB7CiAgICAiIjogdHJ1ZSwKICAgICJsciI6IHRydWUsCiAgICAicmwiOiB0cnVlCiAgfTsKICB2YXIgYWxpZ25TZXR0aW5nID0gewogICAgInN0YXJ0IjogdHJ1ZSwKICAgICJtaWRkbGUiOiB0cnVlLAogICAgImVuZCI6IHRydWUsCiAgICAibGVmdCI6IHRydWUsCiAgICAicmlnaHQiOiB0cnVlCiAgfTsKCiAgZnVuY3Rpb24gZmluZERpcmVjdGlvblNldHRpbmcodmFsdWUpIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciBkaXIgPSBkaXJlY3Rpb25TZXR0aW5nW3ZhbHVlLnRvTG93ZXJDYXNlKCldOwogICAgcmV0dXJuIGRpciA/IHZhbHVlLnRvTG93ZXJDYXNlKCkgOiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIGZpbmRBbGlnblNldHRpbmcodmFsdWUpIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciBhbGlnbiA9IGFsaWduU2V0dGluZ1t2YWx1ZS50b0xvd2VyQ2FzZSgpXTsKICAgIHJldHVybiBhbGlnbiA/IHZhbHVlLnRvTG93ZXJDYXNlKCkgOiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIGV4dGVuZChvYmopIHsKICAgIHZhciBpID0gMTsKICAgIGZvciAoOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBjb2JqID0gYXJndW1lbnRzW2ldOwogICAgICBmb3IgKHZhciBwIGluIGNvYmopIHsKICAgICAgICBvYmpbcF0gPSBjb2JqW3BdOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIGZ1bmN0aW9uIFZUVEN1ZShzdGFydFRpbWUsIGVuZFRpbWUsIHRleHQpIHsKICAgIHZhciBjdWUgPSB0aGlzOwogICAgdmFyIGlzSUU4ID0gKC9NU0lFXHM4XC4wLykudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgIHZhciBiYXNlT2JqID0ge307CgogICAgaWYgKGlzSUU4KSB7CiAgICAgIGN1ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2N1c3RvbScpOwogICAgfSBlbHNlIHsKICAgICAgYmFzZU9iai5lbnVtZXJhYmxlID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNoaW0gaW1wbGVtZW50YXRpb24gc3BlY2lmaWMgcHJvcGVydGllcy4gVGhlc2UgcHJvcGVydGllcyBhcmUgbm90IGluCiAgICAgKiB0aGUgc3BlYy4KICAgICAqLwoKICAgIC8vIExldHMgdXMga25vdyB3aGVuIHRoZSBWVFRDdWUncyBkYXRhIGhhcyBjaGFuZ2VkIGluIHN1Y2ggYSB3YXkgdGhhdCB3ZSBuZWVkCiAgICAvLyB0byByZWNvbXB1dGUgaXRzIGRpc3BsYXkgc3RhdGUuIFRoaXMgbGV0cyB1cyBjb21wdXRlIGl0cyBkaXNwbGF5IHN0YXRlCiAgICAvLyBsYXppbHkuCiAgICBjdWUuaGFzQmVlblJlc2V0ID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBWVFRDdWUgYW5kIFRleHRUcmFja0N1ZSBwcm9wZXJ0aWVzCiAgICAgKiBodHRwOi8vZGV2LnczLm9yZy9odG1sNS93ZWJ2dHQvI3Z0dGN1ZS1pbnRlcmZhY2UKICAgICAqLwoKICAgIHZhciBfaWQgPSAiIjsKICAgIHZhciBfcGF1c2VPbkV4aXQgPSBmYWxzZTsKICAgIHZhciBfc3RhcnRUaW1lID0gc3RhcnRUaW1lOwogICAgdmFyIF9lbmRUaW1lID0gZW5kVGltZTsKICAgIHZhciBfdGV4dCA9IHRleHQ7CiAgICB2YXIgX3JlZ2lvbiA9IG51bGw7CiAgICB2YXIgX3ZlcnRpY2FsID0gIiI7CiAgICB2YXIgX3NuYXBUb0xpbmVzID0gdHJ1ZTsKICAgIHZhciBfbGluZSA9ICJhdXRvIjsKICAgIHZhciBfbGluZUFsaWduID0gInN0YXJ0IjsKICAgIHZhciBfcG9zaXRpb24gPSA1MDsKICAgIHZhciBfcG9zaXRpb25BbGlnbiA9ICJtaWRkbGUiOwogICAgdmFyIF9zaXplID0gNTA7CiAgICB2YXIgX2FsaWduID0gIm1pZGRsZSI7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgImlkIiwgZXh0ZW5kKHt9LCBiYXNlT2JqLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfaWQ7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBfaWQgPSAiIiArIHZhbHVlOwogICAgICAgIH0KICAgICAgfSkpOwoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdWUsCiAgICAgICJwYXVzZU9uRXhpdCIsIGV4dGVuZCh7fSwgYmFzZU9iaiwgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX3BhdXNlT25FeGl0OwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgX3BhdXNlT25FeGl0ID0gISF2YWx1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAic3RhcnRUaW1lIiwgZXh0ZW5kKHt9LCBiYXNlT2JqLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfc3RhcnRUaW1lOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gIm51bWJlciIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3RhcnQgdGltZSBtdXN0IGJlIHNldCB0byBhIG51bWJlci4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF9zdGFydFRpbWUgPSB2YWx1ZTsKICAgICAgICAgIHRoaXMuaGFzQmVlblJlc2V0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAiZW5kVGltZSIsIGV4dGVuZCh7fSwgYmFzZU9iaiwgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX2VuZFRpbWU7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAibnVtYmVyIikgewogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJFbmQgdGltZSBtdXN0IGJlIHNldCB0byBhIG51bWJlci4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF9lbmRUaW1lID0gdmFsdWU7CiAgICAgICAgICB0aGlzLmhhc0JlZW5SZXNldCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KSk7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgInRleHQiLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF90ZXh0OwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgX3RleHQgPSAiIiArIHZhbHVlOwogICAgICAgICAgdGhpcy5oYXNCZWVuUmVzZXQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSkpOwoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdWUsCiAgICAgICJyZWdpb24iLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9yZWdpb247CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBfcmVnaW9uID0gdmFsdWU7CiAgICAgICAgICB0aGlzLmhhc0JlZW5SZXNldCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KSk7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgInZlcnRpY2FsIiwgZXh0ZW5kKHt9LCBiYXNlT2JqLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfdmVydGljYWw7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICB2YXIgc2V0dGluZyA9IGZpbmREaXJlY3Rpb25TZXR0aW5nKHZhbHVlKTsKICAgICAgICAgIC8vIEhhdmUgdG8gY2hlY2sgZm9yIGZhbHNlIGJlY2F1c2UgdGhlIHNldHRpbmcgYW4gYmUgYW4gZW1wdHkgc3RyaW5nLgogICAgICAgICAgaWYgKHNldHRpbmcgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3ZlcnRpY2FsID0gc2V0dGluZzsKICAgICAgICAgIHRoaXMuaGFzQmVlblJlc2V0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAic25hcFRvTGluZXMiLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9zbmFwVG9MaW5lczsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIF9zbmFwVG9MaW5lcyA9ICEhdmFsdWU7CiAgICAgICAgICB0aGlzLmhhc0JlZW5SZXNldCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KSk7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgImxpbmUiLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9saW5lOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gIm51bWJlciIgJiYgdmFsdWUgIT09IGF1dG9LZXl3b3JkKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQW4gaW52YWxpZCBudW1iZXIgb3IgaWxsZWdhbCBzdHJpbmcgd2FzIHNwZWNpZmllZC4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF9saW5lID0gdmFsdWU7CiAgICAgICAgICB0aGlzLmhhc0JlZW5SZXNldCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KSk7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgImxpbmVBbGlnbiIsIGV4dGVuZCh7fSwgYmFzZU9iaiwgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX2xpbmVBbGlnbjsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIHZhciBzZXR0aW5nID0gZmluZEFsaWduU2V0dGluZyh2YWx1ZSk7CiAgICAgICAgICBpZiAoIXNldHRpbmcpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJBbiBpbnZhbGlkIG9yIGlsbGVnYWwgc3RyaW5nIHdhcyBzcGVjaWZpZWQuIik7CiAgICAgICAgICB9CiAgICAgICAgICBfbGluZUFsaWduID0gc2V0dGluZzsKICAgICAgICAgIHRoaXMuaGFzQmVlblJlc2V0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAicG9zaXRpb24iLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9wb3NpdGlvbjsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIGlmICh2YWx1ZSA8IDAgfHwgdmFsdWUgPiAxMDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb3NpdGlvbiBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3Bvc2l0aW9uID0gdmFsdWU7CiAgICAgICAgICB0aGlzLmhhc0JlZW5SZXNldCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KSk7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1ZSwKICAgICAgInBvc2l0aW9uQWxpZ24iLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9wb3NpdGlvbkFsaWduOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgdmFyIHNldHRpbmcgPSBmaW5kQWxpZ25TZXR0aW5nKHZhbHVlKTsKICAgICAgICAgIGlmICghc2V0dGluZykgewogICAgICAgICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoIkFuIGludmFsaWQgb3IgaWxsZWdhbCBzdHJpbmcgd2FzIHNwZWNpZmllZC4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF9wb3NpdGlvbkFsaWduID0gc2V0dGluZzsKICAgICAgICAgIHRoaXMuaGFzQmVlblJlc2V0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAic2l6ZSIsIGV4dGVuZCh7fSwgYmFzZU9iaiwgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX3NpemU7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gMTAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiU2l6ZSBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3NpemUgPSB2YWx1ZTsKICAgICAgICAgIHRoaXMuaGFzQmVlblJlc2V0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pKTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VlLAogICAgICAiYWxpZ24iLCBleHRlbmQoe30sIGJhc2VPYmosIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9hbGlnbjsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIHZhciBzZXR0aW5nID0gZmluZEFsaWduU2V0dGluZyh2YWx1ZSk7CiAgICAgICAgICBpZiAoIXNldHRpbmcpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJBbiBpbnZhbGlkIG9yIGlsbGVnYWwgc3RyaW5nIHdhcyBzcGVjaWZpZWQuIik7CiAgICAgICAgICB9CiAgICAgICAgICBfYWxpZ24gPSBzZXR0aW5nOwogICAgICAgICAgdGhpcy5oYXNCZWVuUmVzZXQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSkpOwoKICAgIC8qKgogICAgICogT3RoZXIgPHRyYWNrPiBzcGVjIGRlZmluZWQgcHJvcGVydGllcwogICAgICovCgogICAgLy8gaHR0cDovL3d3dy53aGF0d2cub3JnL3NwZWNzL3dlYi1hcHBzL2N1cnJlbnQtd29yay9tdWx0aXBhZ2UvdGhlLXZpZGVvLWVsZW1lbnQuaHRtbCN0ZXh0LXRyYWNrLWN1ZS1kaXNwbGF5LXN0YXRlCiAgICBjdWUuZGlzcGxheVN0YXRlID0gdW5kZWZpbmVkOwoKICAgIGlmIChpc0lFOCkgewogICAgICByZXR1cm4gY3VlOwogICAgfQogIH0KCiAgLyoqCiAgICogVlRUQ3VlIG1ldGhvZHMKICAgKi8KCiAgVlRUQ3VlLnByb3RvdHlwZS5nZXRDdWVBc0hUTUwgPSBmdW5jdGlvbigpIHsKICAgIC8vIEFzc3VtZSBXZWJWVFQuY29udmVydEN1ZVRvRE9NVHJlZSBpcyBvbiB0aGUgZ2xvYmFsLgogICAgcmV0dXJuIFdlYlZUVC5jb252ZXJ0Q3VlVG9ET01UcmVlKHdpbmRvdywgdGhpcy50ZXh0KTsKICB9OwoKICByb290LlZUVEN1ZSA9IHJvb3QuVlRUQ3VlIHx8IFZUVEN1ZTsKICB2dHRqcy5WVFRDdWUgPSBWVFRDdWU7Cn0odGhpcywgKHRoaXMudnR0anMgfHwge30pKSk7CgovKioKICogQ29weXJpZ2h0IDIwMTMgdnR0LmpzIENvbnRyaWJ1dG9ycwogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgooZnVuY3Rpb24ocm9vdCwgdnR0anMpIHsKCiAgdmFyIHNjcm9sbFNldHRpbmcgPSB7CiAgICAiIjogdHJ1ZSwKICAgICJ1cCI6IHRydWUKICB9OwoKICBmdW5jdGlvbiBmaW5kU2Nyb2xsU2V0dGluZyh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gInN0cmluZyIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdmFyIHNjcm9sbCA9IHNjcm9sbFNldHRpbmdbdmFsdWUudG9Mb3dlckNhc2UoKV07CiAgICByZXR1cm4gc2Nyb2xsID8gdmFsdWUudG9Mb3dlckNhc2UoKSA6IGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gaXNWYWxpZFBlcmNlbnRWYWx1ZSh2YWx1ZSkgewogICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgJiYgKHZhbHVlID49IDAgJiYgdmFsdWUgPD0gMTAwKTsKICB9CgogIC8vIFZUVFJlZ2lvbiBzaGltIGh0dHA6Ly9kZXYudzMub3JnL2h0bWw1L3dlYnZ0dC8jdnR0cmVnaW9uLWludGVyZmFjZQogIGZ1bmN0aW9uIFZUVFJlZ2lvbigpIHsKICAgIHZhciBfd2lkdGggPSAxMDA7CiAgICB2YXIgX2xpbmVzID0gMzsKICAgIHZhciBfcmVnaW9uQW5jaG9yWCA9IDA7CiAgICB2YXIgX3JlZ2lvbkFuY2hvclkgPSAxMDA7CiAgICB2YXIgX3ZpZXdwb3J0QW5jaG9yWCA9IDA7CiAgICB2YXIgX3ZpZXdwb3J0QW5jaG9yWSA9IDEwMDsKICAgIHZhciBfc2Nyb2xsID0gIiI7CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgICAid2lkdGgiOiB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF93aWR0aDsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIGlmICghaXNWYWxpZFBlcmNlbnRWYWx1ZSh2YWx1ZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJXaWR0aCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3dpZHRoID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9LAogICAgICAibGluZXMiOiB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9saW5lczsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJudW1iZXIiKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkxpbmVzIG11c3QgYmUgc2V0IHRvIGEgbnVtYmVyLiIpOwogICAgICAgICAgfQogICAgICAgICAgX2xpbmVzID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9LAogICAgICAicmVnaW9uQW5jaG9yWSI6IHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX3JlZ2lvbkFuY2hvclk7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICBpZiAoIWlzVmFsaWRQZXJjZW50VmFsdWUodmFsdWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUmVnaW9uQW5jaG9yWCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3JlZ2lvbkFuY2hvclkgPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICJyZWdpb25BbmNob3JYIjogewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfcmVnaW9uQW5jaG9yWDsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIGlmKCFpc1ZhbGlkUGVyY2VudFZhbHVlKHZhbHVlKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlJlZ2lvbkFuY2hvclkgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDEwMC4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF9yZWdpb25BbmNob3JYID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9LAogICAgICAidmlld3BvcnRBbmNob3JZIjogewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBfdmlld3BvcnRBbmNob3JZOwogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgaWYgKCFpc1ZhbGlkUGVyY2VudFZhbHVlKHZhbHVlKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlZpZXdwb3J0QW5jaG9yWSBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3ZpZXdwb3J0QW5jaG9yWSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgInZpZXdwb3J0QW5jaG9yWCI6IHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX3ZpZXdwb3J0QW5jaG9yWDsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgIGlmICghaXNWYWxpZFBlcmNlbnRWYWx1ZSh2YWx1ZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJWaWV3cG9ydEFuY2hvclggbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDEwMC4iKTsKICAgICAgICAgIH0KICAgICAgICAgIF92aWV3cG9ydEFuY2hvclggPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICJzY3JvbGwiOiB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF9zY3JvbGw7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICB2YXIgc2V0dGluZyA9IGZpbmRTY3JvbGxTZXR0aW5nKHZhbHVlKTsKICAgICAgICAgIC8vIEhhdmUgdG8gY2hlY2sgZm9yIGZhbHNlIGFzIGFuIGVtcHR5IHN0cmluZyBpcyBhIGxlZ2FsIHZhbHVlLgogICAgICAgICAgaWYgKHNldHRpbmcgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkLiIpOwogICAgICAgICAgfQogICAgICAgICAgX3Njcm9sbCA9IHNldHRpbmc7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIHJvb3QuVlRUUmVnaW9uID0gcm9vdC5WVFRSZWdpb24gfHwgVlRUUmVnaW9uOwogIHZ0dGpzLlZUVFJlZ2lvbiA9IFZUVFJlZ2lvbjsKfSh0aGlzLCAodGhpcy52dHRqcyB8fCB7fSkpKTsKCi8qKgogKiBDb3B5cmlnaHQgMjAxMyB2dHQuanMgQ29udHJpYnV0b3JzCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCi8qIC0qLSBNb2RlOiBKYXZhOyB0YWItd2lkdGg6IDI7IGluZGVudC10YWJzLW1vZGU6IG5pbDsgYy1iYXNpYy1vZmZzZXQ6IDIgLSotICovCi8qIHZpbTogc2V0IHNoaWZ0d2lkdGg9MiB0YWJzdG9wPTIgYXV0b2luZGVudCBjaW5kZW50IGV4cGFuZHRhYjogKi8KCihmdW5jdGlvbihnbG9iYWwpIHsKCiAgdmFyIF9vYmpDcmVhdGUgPSBPYmplY3QuY3JlYXRlIHx8IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIEYoKSB7fQogICAgcmV0dXJuIGZ1bmN0aW9uKG8pIHsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09iamVjdC5jcmVhdGUgc2hpbSBvbmx5IGFjY2VwdHMgb25lIHBhcmFtZXRlci4nKTsKICAgICAgfQogICAgICBGLnByb3RvdHlwZSA9IG87CiAgICAgIHJldHVybiBuZXcgRigpOwogICAgfTsKICB9KSgpOwoKICAvLyBDcmVhdGVzIGEgbmV3IFBhcnNlckVycm9yIG9iamVjdCBmcm9tIGFuIGVycm9yRGF0YSBvYmplY3QuIFRoZSBlcnJvckRhdGEKICAvLyBvYmplY3Qgc2hvdWxkIGhhdmUgZGVmYXVsdCBjb2RlIGFuZCBtZXNzYWdlIHByb3BlcnRpZXMuIFRoZSBkZWZhdWx0IG1lc3NhZ2UKICAvLyBwcm9wZXJ0eSBjYW4gYmUgb3ZlcnJpZGVuIGJ5IHBhc3NpbmcgaW4gYSBtZXNzYWdlIHBhcmFtZXRlci4KICAvLyBTZWUgUGFyc2luZ0Vycm9yLkVycm9ycyBiZWxvdyBmb3IgYWNjZXB0YWJsZSBlcnJvcnMuCiAgZnVuY3Rpb24gUGFyc2luZ0Vycm9yKGVycm9yRGF0YSwgbWVzc2FnZSkgewogICAgdGhpcy5uYW1lID0gIlBhcnNpbmdFcnJvciI7CiAgICB0aGlzLmNvZGUgPSBlcnJvckRhdGEuY29kZTsKICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgZXJyb3JEYXRhLm1lc3NhZ2U7CiAgfQogIFBhcnNpbmdFcnJvci5wcm90b3R5cGUgPSBfb2JqQ3JlYXRlKEVycm9yLnByb3RvdHlwZSk7CiAgUGFyc2luZ0Vycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBhcnNpbmdFcnJvcjsKCiAgLy8gUGFyc2luZ0Vycm9yIG1ldGFkYXRhIGZvciBhY2NlcHRhYmxlIFBhcnNpbmdFcnJvcnMuCiAgUGFyc2luZ0Vycm9yLkVycm9ycyA9IHsKICAgIEJhZFNpZ25hdHVyZTogewogICAgICBjb2RlOiAwLAogICAgICBtZXNzYWdlOiAiTWFsZm9ybWVkIFdlYlZUVCBzaWduYXR1cmUuIgogICAgfSwKICAgIEJhZFRpbWVTdGFtcDogewogICAgICBjb2RlOiAxLAogICAgICBtZXNzYWdlOiAiTWFsZm9ybWVkIHRpbWUgc3RhbXAuIgogICAgfQogIH07CgogIC8vIFRyeSB0byBwYXJzZSBpbnB1dCBhcyBhIHRpbWUgc3RhbXAuCiAgZnVuY3Rpb24gcGFyc2VUaW1lU3RhbXAoaW5wdXQpIHsKCiAgICBmdW5jdGlvbiBjb21wdXRlU2Vjb25kcyhoLCBtLCBzLCBmKSB7CiAgICAgIHJldHVybiAoaCB8IDApICogMzYwMCArIChtIHwgMCkgKiA2MCArIChzIHwgMCkgKyAoZiB8IDApIC8gMTAwMDsKICAgIH0KCiAgICB2YXIgbSA9IGlucHV0Lm1hdGNoKC9eKFxkKyk6KFxkezJ9KSg6XGR7Mn0pP1wuKFxkezN9KS8pOwogICAgaWYgKCFtKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChtWzNdKSB7CiAgICAgIC8vIFRpbWVzdGFtcCB0YWtlcyB0aGUgZm9ybSBvZiBbaG91cnNdOlttaW51dGVzXTpbc2Vjb25kc10uW21pbGxpc2Vjb25kc10KICAgICAgcmV0dXJuIGNvbXB1dGVTZWNvbmRzKG1bMV0sIG1bMl0sIG1bM10ucmVwbGFjZSgiOiIsICIiKSwgbVs0XSk7CiAgICB9IGVsc2UgaWYgKG1bMV0gPiA1OSkgewogICAgICAvLyBUaW1lc3RhbXAgdGFrZXMgdGhlIGZvcm0gb2YgW2hvdXJzXTpbbWludXRlc10uW21pbGxpc2Vjb25kc10KICAgICAgLy8gRmlyc3QgcG9zaXRpb24gaXMgaG91cnMgYXMgaXQncyBvdmVyIDU5LgogICAgICByZXR1cm4gY29tcHV0ZVNlY29uZHMobVsxXSwgbVsyXSwgMCwgIG1bNF0pOwogICAgfSBlbHNlIHsKICAgICAgLy8gVGltZXN0YW1wIHRha2VzIHRoZSBmb3JtIG9mIFttaW51dGVzXTpbc2Vjb25kc10uW21pbGxpc2Vjb25kc10KICAgICAgcmV0dXJuIGNvbXB1dGVTZWNvbmRzKDAsIG1bMV0sIG1bMl0sIG1bNF0pOwogICAgfQogIH0KCiAgLy8gQSBzZXR0aW5ncyBvYmplY3QgaG9sZHMga2V5L3ZhbHVlIHBhaXJzIGFuZCB3aWxsIGlnbm9yZSBhbnl0aGluZyBidXQgdGhlIGZpcnN0CiAgLy8gYXNzaWdubWVudCB0byBhIHNwZWNpZmljIGtleS4KICBmdW5jdGlvbiBTZXR0aW5ncygpIHsKICAgIHRoaXMudmFsdWVzID0gX29iakNyZWF0ZShudWxsKTsKICB9CgogIFNldHRpbmdzLnByb3RvdHlwZSA9IHsKICAgIC8vIE9ubHkgYWNjZXB0IHRoZSBmaXJzdCBhc3NpZ25tZW50IHRvIGFueSBrZXkuCiAgICBzZXQ6IGZ1bmN0aW9uKGssIHYpIHsKICAgICAgaWYgKCF0aGlzLmdldChrKSAmJiB2ICE9PSAiIikgewogICAgICAgIHRoaXMudmFsdWVzW2tdID0gdjsKICAgICAgfQogICAgfSwKICAgIC8vIFJldHVybiB0aGUgdmFsdWUgZm9yIGEga2V5LCBvciBhIGRlZmF1bHQgdmFsdWUuCiAgICAvLyBJZiAnZGVmYXVsdEtleScgaXMgcGFzc2VkIHRoZW4gJ2RmbHQnIGlzIGFzc3VtZWQgdG8gYmUgYW4gb2JqZWN0IHdpdGgKICAgIC8vIGEgbnVtYmVyIG9mIHBvc3NpYmxlIGRlZmF1bHQgdmFsdWVzIGFzIHByb3BlcnRpZXMgd2hlcmUgJ2RlZmF1bHRLZXknIGlzCiAgICAvLyB0aGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0aGF0IHdpbGwgYmUgY2hvc2VuOyBvdGhlcndpc2UgaXQncyBhc3N1bWVkIHRvIGJlCiAgICAvLyBhIHNpbmdsZSB2YWx1ZS4KICAgIGdldDogZnVuY3Rpb24oaywgZGZsdCwgZGVmYXVsdEtleSkgewogICAgICBpZiAoZGVmYXVsdEtleSkgewogICAgICAgIHJldHVybiB0aGlzLmhhcyhrKSA/IHRoaXMudmFsdWVzW2tdIDogZGZsdFtkZWZhdWx0S2V5XTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5oYXMoaykgPyB0aGlzLnZhbHVlc1trXSA6IGRmbHQ7CiAgICB9LAogICAgLy8gQ2hlY2sgd2hldGhlciB3ZSBoYXZlIGEgdmFsdWUgZm9yIGEga2V5LgogICAgaGFzOiBmdW5jdGlvbihrKSB7CiAgICAgIHJldHVybiBrIGluIHRoaXMudmFsdWVzOwogICAgfSwKICAgIC8vIEFjY2VwdCBhIHNldHRpbmcgaWYgaXRzIG9uZSBvZiB0aGUgZ2l2ZW4gYWx0ZXJuYXRpdmVzLgogICAgYWx0OiBmdW5jdGlvbihrLCB2LCBhKSB7CiAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgYS5sZW5ndGg7ICsrbikgewogICAgICAgIGlmICh2ID09PSBhW25dKSB7CiAgICAgICAgICB0aGlzLnNldChrLCB2KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIEFjY2VwdCBhIHNldHRpbmcgaWYgaXRzIGEgdmFsaWQgKHNpZ25lZCkgaW50ZWdlci4KICAgIGludGVnZXI6IGZ1bmN0aW9uKGssIHYpIHsKICAgICAgaWYgKC9eLT9cZCskLy50ZXN0KHYpKSB7IC8vIGludGVnZXIKICAgICAgICB0aGlzLnNldChrLCBwYXJzZUludCh2LCAxMCkpOwogICAgICB9CiAgICB9LAogICAgLy8gQWNjZXB0IGEgc2V0dGluZyBpZiBpdHMgYSB2YWxpZCBwZXJjZW50YWdlLgogICAgcGVyY2VudDogZnVuY3Rpb24oaywgdikgewogICAgICB2YXIgbTsKICAgICAgaWYgKChtID0gdi5tYXRjaCgvXihbXGRdezEsM30pKFwuW1xkXSopPyUkLykpKSB7CiAgICAgICAgdiA9IHBhcnNlRmxvYXQodik7CiAgICAgICAgaWYgKHYgPj0gMCAmJiB2IDw9IDEwMCkgewogICAgICAgICAgdGhpcy5zZXQoaywgdik7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH07CgogIC8vIEhlbHBlciBmdW5jdGlvbiB0byBwYXJzZSBpbnB1dCBpbnRvIGdyb3VwcyBzZXBhcmF0ZWQgYnkgJ2dyb3VwRGVsaW0nLCBhbmQKICAvLyBpbnRlcnByZXRlIGVhY2ggZ3JvdXAgYXMgYSBrZXkvdmFsdWUgcGFpciBzZXBhcmF0ZWQgYnkgJ2tleVZhbHVlRGVsaW0nLgogIGZ1bmN0aW9uIHBhcnNlT3B0aW9ucyhpbnB1dCwgY2FsbGJhY2ssIGtleVZhbHVlRGVsaW0sIGdyb3VwRGVsaW0pIHsKICAgIHZhciBncm91cHMgPSBncm91cERlbGltID8gaW5wdXQuc3BsaXQoZ3JvdXBEZWxpbSkgOiBbaW5wdXRdOwogICAgZm9yICh2YXIgaSBpbiBncm91cHMpIHsKICAgICAgaWYgKHR5cGVvZiBncm91cHNbaV0gIT09ICJzdHJpbmciKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgdmFyIGt2ID0gZ3JvdXBzW2ldLnNwbGl0KGtleVZhbHVlRGVsaW0pOwogICAgICBpZiAoa3YubGVuZ3RoICE9PSAyKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgdmFyIGsgPSBrdlswXTsKICAgICAgdmFyIHYgPSBrdlsxXTsKICAgICAgY2FsbGJhY2soaywgdik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUN1ZShpbnB1dCwgY3VlLCByZWdpb25MaXN0KSB7CiAgICAvLyBSZW1lbWJlciB0aGUgb3JpZ2luYWwgaW5wdXQgaWYgd2UgbmVlZCB0byB0aHJvdyBhbiBlcnJvci4KICAgIHZhciBvSW5wdXQgPSBpbnB1dDsKICAgIC8vIDQuMSBXZWJWVFQgdGltZXN0YW1wCiAgICBmdW5jdGlvbiBjb25zdW1lVGltZVN0YW1wKCkgewogICAgICB2YXIgdHMgPSBwYXJzZVRpbWVTdGFtcChpbnB1dCk7CiAgICAgIGlmICh0cyA9PT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBQYXJzaW5nRXJyb3IoUGFyc2luZ0Vycm9yLkVycm9ycy5CYWRUaW1lU3RhbXAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYWxmb3JtZWQgdGltZXN0YW1wOiAiICsgb0lucHV0KTsKICAgICAgfQogICAgICAvLyBSZW1vdmUgdGltZSBzdGFtcCBmcm9tIGlucHV0LgogICAgICBpbnB1dCA9IGlucHV0LnJlcGxhY2UoL15bXlxzYS16QS1aLV0rLywgIiIpOwogICAgICByZXR1cm4gdHM7CiAgICB9CgogICAgLy8gNC40LjIgV2ViVlRUIGN1ZSBzZXR0aW5ncwogICAgZnVuY3Rpb24gY29uc3VtZUN1ZVNldHRpbmdzKGlucHV0LCBjdWUpIHsKICAgICAgdmFyIHNldHRpbmdzID0gbmV3IFNldHRpbmdzKCk7CgogICAgICBwYXJzZU9wdGlvbnMoaW5wdXQsIGZ1bmN0aW9uIChrLCB2KSB7CiAgICAgICAgc3dpdGNoIChrKSB7CiAgICAgICAgY2FzZSAicmVnaW9uIjoKICAgICAgICAgIC8vIEZpbmQgdGhlIGxhc3QgcmVnaW9uIHdlIHBhcnNlZCB3aXRoIHRoZSBzYW1lIHJlZ2lvbiBpZC4KICAgICAgICAgIGZvciAodmFyIGkgPSByZWdpb25MaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIGlmIChyZWdpb25MaXN0W2ldLmlkID09PSB2KSB7CiAgICAgICAgICAgICAgc2V0dGluZ3Muc2V0KGssIHJlZ2lvbkxpc3RbaV0ucmVnaW9uKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAidmVydGljYWwiOgogICAgICAgICAgc2V0dGluZ3MuYWx0KGssIHYsIFsicmwiLCAibHIiXSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJsaW5lIjoKICAgICAgICAgIHZhciB2YWxzID0gdi5zcGxpdCgiLCIpLAogICAgICAgICAgICAgIHZhbHMwID0gdmFsc1swXTsKICAgICAgICAgIHNldHRpbmdzLmludGVnZXIoaywgdmFsczApOwogICAgICAgICAgc2V0dGluZ3MucGVyY2VudChrLCB2YWxzMCkgPyBzZXR0aW5ncy5zZXQoInNuYXBUb0xpbmVzIiwgZmFsc2UpIDogbnVsbDsKICAgICAgICAgIHNldHRpbmdzLmFsdChrLCB2YWxzMCwgWyJhdXRvIl0pOwogICAgICAgICAgaWYgKHZhbHMubGVuZ3RoID09PSAyKSB7CiAgICAgICAgICAgIHNldHRpbmdzLmFsdCgibGluZUFsaWduIiwgdmFsc1sxXSwgWyJzdGFydCIsICJtaWRkbGUiLCAiZW5kIl0pOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAicG9zaXRpb24iOgogICAgICAgICAgdmFscyA9IHYuc3BsaXQoIiwiKTsKICAgICAgICAgIHNldHRpbmdzLnBlcmNlbnQoaywgdmFsc1swXSk7CiAgICAgICAgICBpZiAodmFscy5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgc2V0dGluZ3MuYWx0KCJwb3NpdGlvbkFsaWduIiwgdmFsc1sxXSwgWyJzdGFydCIsICJtaWRkbGUiLCAiZW5kIl0pOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAic2l6ZSI6CiAgICAgICAgICBzZXR0aW5ncy5wZXJjZW50KGssIHYpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiYWxpZ24iOgogICAgICAgICAgc2V0dGluZ3MuYWx0KGssIHYsIFsic3RhcnQiLCAibWlkZGxlIiwgImVuZCIsICJsZWZ0IiwgInJpZ2h0Il0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9LCAvOi8sIC9ccy8pOwoKICAgICAgLy8gQXBwbHkgZGVmYXVsdCB2YWx1ZXMgZm9yIGFueSBtaXNzaW5nIGZpZWxkcy4KICAgICAgY3VlLnJlZ2lvbiA9IHNldHRpbmdzLmdldCgicmVnaW9uIiwgbnVsbCk7CiAgICAgIGN1ZS52ZXJ0aWNhbCA9IHNldHRpbmdzLmdldCgidmVydGljYWwiLCAiIik7CiAgICAgIGN1ZS5saW5lID0gc2V0dGluZ3MuZ2V0KCJsaW5lIiwgImF1dG8iKTsKICAgICAgY3VlLmxpbmVBbGlnbiA9IHNldHRpbmdzLmdldCgibGluZUFsaWduIiwgInN0YXJ0Iik7CiAgICAgIGN1ZS5zbmFwVG9MaW5lcyA9IHNldHRpbmdzLmdldCgic25hcFRvTGluZXMiLCB0cnVlKTsKICAgICAgY3VlLnNpemUgPSBzZXR0aW5ncy5nZXQoInNpemUiLCAxMDApOwogICAgICBjdWUuYWxpZ24gPSBzZXR0aW5ncy5nZXQoImFsaWduIiwgIm1pZGRsZSIpOwogICAgICBjdWUucG9zaXRpb24gPSBzZXR0aW5ncy5nZXQoInBvc2l0aW9uIiwgewogICAgICAgIHN0YXJ0OiAwLAogICAgICAgIGxlZnQ6IDAsCiAgICAgICAgbWlkZGxlOiA1MCwKICAgICAgICBlbmQ6IDEwMCwKICAgICAgICByaWdodDogMTAwCiAgICAgIH0sIGN1ZS5hbGlnbik7CiAgICAgIGN1ZS5wb3NpdGlvbkFsaWduID0gc2V0dGluZ3MuZ2V0KCJwb3NpdGlvbkFsaWduIiwgewogICAgICAgIHN0YXJ0OiAic3RhcnQiLAogICAgICAgIGxlZnQ6ICJzdGFydCIsCiAgICAgICAgbWlkZGxlOiAibWlkZGxlIiwKICAgICAgICBlbmQ6ICJlbmQiLAogICAgICAgIHJpZ2h0OiAiZW5kIgogICAgICB9LCBjdWUuYWxpZ24pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNraXBXaGl0ZXNwYWNlKCkgewogICAgICBpbnB1dCA9IGlucHV0LnJlcGxhY2UoL15ccysvLCAiIik7CiAgICB9CgogICAgLy8gNC4xIFdlYlZUVCBjdWUgdGltaW5ncy4KICAgIHNraXBXaGl0ZXNwYWNlKCk7CiAgICBjdWUuc3RhcnRUaW1lID0gY29uc3VtZVRpbWVTdGFtcCgpOyAgIC8vICgxKSBjb2xsZWN0IGN1ZSBzdGFydCB0aW1lCiAgICBza2lwV2hpdGVzcGFjZSgpOwogICAgaWYgKGlucHV0LnN1YnN0cigwLCAzKSAhPT0gIi0tPiIpIHsgICAgIC8vICgzKSBuZXh0IGNoYXJhY3RlcnMgbXVzdCBtYXRjaCAiLS0+IgogICAgICB0aHJvdyBuZXcgUGFyc2luZ0Vycm9yKFBhcnNpbmdFcnJvci5FcnJvcnMuQmFkVGltZVN0YW1wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYWxmb3JtZWQgdGltZSBzdGFtcCAodGltZSBzdGFtcHMgbXVzdCBiZSBzZXBhcmF0ZWQgYnkgJy0tPicpOiAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvSW5wdXQpOwogICAgfQogICAgaW5wdXQgPSBpbnB1dC5zdWJzdHIoMyk7CiAgICBza2lwV2hpdGVzcGFjZSgpOwogICAgY3VlLmVuZFRpbWUgPSBjb25zdW1lVGltZVN0YW1wKCk7ICAgICAvLyAoNSkgY29sbGVjdCBjdWUgZW5kIHRpbWUKCiAgICAvLyA0LjEgV2ViVlRUIGN1ZSBzZXR0aW5ncyBsaXN0LgogICAgc2tpcFdoaXRlc3BhY2UoKTsKICAgIGNvbnN1bWVDdWVTZXR0aW5ncyhpbnB1dCwgY3VlKTsKICB9CgogIHZhciBFU0NBUEUgPSB7CiAgICAiJmFtcDsiOiAiJiIsCiAgICAiJmx0OyI6ICI8IiwKICAgICImZ3Q7IjogIj4iLAogICAgIiZscm07IjogIlx1MjAwZSIsCiAgICAiJnJsbTsiOiAiXHUyMDBmIiwKICAgICImbmJzcDsiOiAiXHUwMGEwIgogIH07CgogIHZhciBUQUdfTkFNRSA9IHsKICAgIGM6ICJzcGFuIiwKICAgIGk6ICJpIiwKICAgIGI6ICJiIiwKICAgIHU6ICJ1IiwKICAgIHJ1Ynk6ICJydWJ5IiwKICAgIHJ0OiAicnQiLAogICAgdjogInNwYW4iLAogICAgbGFuZzogInNwYW4iCiAgfTsKCiAgdmFyIFRBR19BTk5PVEFUSU9OID0gewogICAgdjogInRpdGxlIiwKICAgIGxhbmc6ICJsYW5nIgogIH07CgogIHZhciBORUVEU19QQVJFTlQgPSB7CiAgICBydDogInJ1YnkiCiAgfTsKCiAgLy8gUGFyc2UgY29udGVudCBpbnRvIGEgZG9jdW1lbnQgZnJhZ21lbnQuCiAgZnVuY3Rpb24gcGFyc2VDb250ZW50KHdpbmRvdywgaW5wdXQpIHsKICAgIGZ1bmN0aW9uIG5leHRUb2tlbigpIHsKICAgICAgLy8gQ2hlY2sgZm9yIGVuZC1vZi1zdHJpbmcuCiAgICAgIGlmICghaW5wdXQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgLy8gQ29uc3VtZSAnbicgY2hhcmFjdGVycyBmcm9tIHRoZSBpbnB1dC4KICAgICAgZnVuY3Rpb24gY29uc3VtZShyZXN1bHQpIHsKICAgICAgICBpbnB1dCA9IGlucHV0LnN1YnN0cihyZXN1bHQubGVuZ3RoKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CgogICAgICB2YXIgbSA9IGlucHV0Lm1hdGNoKC9eKFtePF0qKSg8W14+XSs+Pyk/Lyk7CiAgICAgIC8vIElmIHRoZXJlIGlzIHNvbWUgdGV4dCBiZWZvcmUgdGhlIG5leHQgdGFnLCByZXR1cm4gaXQsIG90aGVyd2lzZSByZXR1cm4KICAgICAgLy8gdGhlIHRhZy4KICAgICAgcmV0dXJuIGNvbnN1bWUobVsxXSA/IG1bMV0gOiBtWzJdKTsKICAgIH0KCiAgICAvLyBVbmVzY2FwZSBhIHN0cmluZyAncycuCiAgICBmdW5jdGlvbiB1bmVzY2FwZTEoZSkgewogICAgICByZXR1cm4gRVNDQVBFW2VdOwogICAgfQogICAgZnVuY3Rpb24gdW5lc2NhcGUocykgewogICAgICB3aGlsZSAoKG0gPSBzLm1hdGNoKC8mKGFtcHxsdHxndHxscm18cmxtfG5ic3ApOy8pKSkgewogICAgICAgIHMgPSBzLnJlcGxhY2UobVswXSwgdW5lc2NhcGUxKTsKICAgICAgfQogICAgICByZXR1cm4gczsKICAgIH0KCiAgICBmdW5jdGlvbiBzaG91bGRBZGQoY3VycmVudCwgZWxlbWVudCkgewogICAgICByZXR1cm4gIU5FRURTX1BBUkVOVFtlbGVtZW50LmxvY2FsTmFtZV0gfHwKICAgICAgICAgICAgIE5FRURTX1BBUkVOVFtlbGVtZW50LmxvY2FsTmFtZV0gPT09IGN1cnJlbnQubG9jYWxOYW1lOwogICAgfQoKICAgIC8vIENyZWF0ZSBhbiBlbGVtZW50IGZvciB0aGlzIHRhZy4KICAgIGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodHlwZSwgYW5ub3RhdGlvbikgewogICAgICB2YXIgdGFnTmFtZSA9IFRBR19OQU1FW3R5cGVdOwogICAgICBpZiAoIXRhZ05hbWUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB2YXIgZWxlbWVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpOwogICAgICBlbGVtZW50LmxvY2FsTmFtZSA9IHRhZ05hbWU7CiAgICAgIHZhciBuYW1lID0gVEFHX0FOTk9UQVRJT05bdHlwZV07CiAgICAgIGlmIChuYW1lICYmIGFubm90YXRpb24pIHsKICAgICAgICBlbGVtZW50W25hbWVdID0gYW5ub3RhdGlvbi50cmltKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIGVsZW1lbnQ7CiAgICB9CgogICAgdmFyIHJvb3REaXYgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksCiAgICAgICAgY3VycmVudCA9IHJvb3REaXYsCiAgICAgICAgdCwKICAgICAgICB0YWdTdGFjayA9IFtdOwoKICAgIHdoaWxlICgodCA9IG5leHRUb2tlbigpKSAhPT0gbnVsbCkgewogICAgICBpZiAodFswXSA9PT0gJzwnKSB7CiAgICAgICAgaWYgKHRbMV0gPT09ICIvIikgewogICAgICAgICAgLy8gSWYgdGhlIGNsb3NpbmcgdGFnIG1hdGNoZXMsIG1vdmUgYmFjayB1cCB0byB0aGUgcGFyZW50IG5vZGUuCiAgICAgICAgICBpZiAodGFnU3RhY2subGVuZ3RoICYmCiAgICAgICAgICAgICAgdGFnU3RhY2tbdGFnU3RhY2subGVuZ3RoIC0gMV0gPT09IHQuc3Vic3RyKDIpLnJlcGxhY2UoIj4iLCAiIikpIHsKICAgICAgICAgICAgdGFnU3RhY2sucG9wKCk7CiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudE5vZGU7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBPdGhlcndpc2UganVzdCBpZ25vcmUgdGhlIGVuZCB0YWcuCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgdmFyIHRzID0gcGFyc2VUaW1lU3RhbXAodC5zdWJzdHIoMSwgdC5sZW5ndGggLSAyKSk7CiAgICAgICAgdmFyIG5vZGU7CiAgICAgICAgaWYgKHRzKSB7CiAgICAgICAgICAvLyBUaW1lc3RhbXBzIGFyZSBsZWFkIG5vZGVzIGFzIHdlbGwuCiAgICAgICAgICBub2RlID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZVByb2Nlc3NpbmdJbnN0cnVjdGlvbigidGltZXN0YW1wIiwgdHMpOwogICAgICAgICAgY3VycmVudC5hcHBlbmRDaGlsZChub2RlKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICB2YXIgbSA9IHQubWF0Y2goL148KFteLlxzLzAtOT5dKykoXC5bXlxzXFw+XSspPyhbXj5cXF0rKT8oXFw/KT4/JC8pOwogICAgICAgIC8vIElmIHdlIGNhbid0IHBhcnNlIHRoZSB0YWcsIHNraXAgdG8gdGhlIG5leHQgdGFnLgogICAgICAgIGlmICghbSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIC8vIFRyeSB0byBjb25zdHJ1Y3QgYW4gZWxlbWVudCwgYW5kIGlnbm9yZSB0aGUgdGFnIGlmIHdlIGNvdWxkbid0LgogICAgICAgIG5vZGUgPSBjcmVhdGVFbGVtZW50KG1bMV0sIG1bM10pOwogICAgICAgIGlmICghbm9kZSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIC8vIERldGVybWluZSBpZiB0aGUgdGFnIHNob3VsZCBiZSBhZGRlZCBiYXNlZCBvbiB0aGUgY29udGV4dCBvZiB3aGVyZSBpdAogICAgICAgIC8vIGlzIHBsYWNlZCBpbiB0aGUgY3VldGV4dC4KICAgICAgICBpZiAoIXNob3VsZEFkZChjdXJyZW50LCBub2RlKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIC8vIFNldCB0aGUgY2xhc3MgbGlzdCAoYXMgYSBsaXN0IG9mIGNsYXNzZXMsIHNlcGFyYXRlZCBieSBzcGFjZSkuCiAgICAgICAgaWYgKG1bMl0pIHsKICAgICAgICAgIG5vZGUuY2xhc3NOYW1lID0gbVsyXS5zdWJzdHIoMSkucmVwbGFjZSgnLicsICcgJyk7CiAgICAgICAgfQogICAgICAgIC8vIEFwcGVuZCB0aGUgbm9kZSB0byB0aGUgY3VycmVudCBub2RlLCBhbmQgZW50ZXIgdGhlIHNjb3BlIG9mIHRoZSBuZXcKICAgICAgICAvLyBub2RlLgogICAgICAgIHRhZ1N0YWNrLnB1c2gobVsxXSk7CiAgICAgICAgY3VycmVudC5hcHBlbmRDaGlsZChub2RlKTsKICAgICAgICBjdXJyZW50ID0gbm9kZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgLy8gVGV4dCBub2RlcyBhcmUgbGVhZiBub2Rlcy4KICAgICAgY3VycmVudC5hcHBlbmRDaGlsZCh3aW5kb3cuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodW5lc2NhcGUodCkpKTsKICAgIH0KCiAgICByZXR1cm4gcm9vdERpdjsKICB9CgogIC8vIFRoaXMgaXMgYSBsaXN0IG9mIGFsbCB0aGUgVW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgaGF2ZSBhIHN0cm9uZwogIC8vIHJpZ2h0LXRvLWxlZnQgY2F0ZWdvcnkuIFdoYXQgdGhpcyBtZWFucyBpcyB0aGF0IHRoZXNlIGNoYXJhY3RlcnMgYXJlCiAgLy8gd3JpdHRlbiByaWdodC10by1sZWZ0IGZvciBzdXJlLiBJdCB3YXMgZ2VuZXJhdGVkIGJ5IHB1bGxpbmcgYWxsIHRoZSBzdHJvbmcKICAvLyByaWdodC10by1sZWZ0IGNoYXJhY3RlcnMgb3V0IG9mIHRoZSBVbmljb2RlIGRhdGEgdGFibGUuIFRoYXQgdGFibGUgY2FuCiAgLy8gZm91bmQgYXQ6IGh0dHA6Ly93d3cudW5pY29kZS5vcmcvUHVibGljL1VOSURBVEEvVW5pY29kZURhdGEudHh0CiAgdmFyIHN0cm9uZ1JUTENoYXJzID0gWzB4MDVCRSwgMHgwNUMwLCAweDA1QzMsIDB4MDVDNiwgMHgwNUQwLCAweDA1RDEsCiAgICAgIDB4MDVEMiwgMHgwNUQzLCAweDA1RDQsIDB4MDVENSwgMHgwNUQ2LCAweDA1RDcsIDB4MDVEOCwgMHgwNUQ5LCAweDA1REEsCiAgICAgIDB4MDVEQiwgMHgwNURDLCAweDA1REQsIDB4MDVERSwgMHgwNURGLCAweDA1RTAsIDB4MDVFMSwgMHgwNUUyLCAweDA1RTMsCiAgICAgIDB4MDVFNCwgMHgwNUU1LCAweDA1RTYsIDB4MDVFNywgMHgwNUU4LCAweDA1RTksIDB4MDVFQSwgMHgwNUYwLCAweDA1RjEsCiAgICAgIDB4MDVGMiwgMHgwNUYzLCAweDA1RjQsIDB4MDYwOCwgMHgwNjBCLCAweDA2MEQsIDB4MDYxQiwgMHgwNjFFLCAweDA2MUYsCiAgICAgIDB4MDYyMCwgMHgwNjIxLCAweDA2MjIsIDB4MDYyMywgMHgwNjI0LCAweDA2MjUsIDB4MDYyNiwgMHgwNjI3LCAweDA2MjgsCiAgICAgIDB4MDYyOSwgMHgwNjJBLCAweDA2MkIsIDB4MDYyQywgMHgwNjJELCAweDA2MkUsIDB4MDYyRiwgMHgwNjMwLCAweDA2MzEsCiAgICAgIDB4MDYzMiwgMHgwNjMzLCAweDA2MzQsIDB4MDYzNSwgMHgwNjM2LCAweDA2MzcsIDB4MDYzOCwgMHgwNjM5LCAweDA2M0EsCiAgICAgIDB4MDYzQiwgMHgwNjNDLCAweDA2M0QsIDB4MDYzRSwgMHgwNjNGLCAweDA2NDAsIDB4MDY0MSwgMHgwNjQyLCAweDA2NDMsCiAgICAgIDB4MDY0NCwgMHgwNjQ1LCAweDA2NDYsIDB4MDY0NywgMHgwNjQ4LCAweDA2NDksIDB4MDY0QSwgMHgwNjZELCAweDA2NkUsCiAgICAgIDB4MDY2RiwgMHgwNjcxLCAweDA2NzIsIDB4MDY3MywgMHgwNjc0LCAweDA2NzUsIDB4MDY3NiwgMHgwNjc3LCAweDA2NzgsCiAgICAgIDB4MDY3OSwgMHgwNjdBLCAweDA2N0IsIDB4MDY3QywgMHgwNjdELCAweDA2N0UsIDB4MDY3RiwgMHgwNjgwLCAweDA2ODEsCiAgICAgIDB4MDY4MiwgMHgwNjgzLCAweDA2ODQsIDB4MDY4NSwgMHgwNjg2LCAweDA2ODcsIDB4MDY4OCwgMHgwNjg5LCAweDA2OEEsCiAgICAgIDB4MDY4QiwgMHgwNjhDLCAweDA2OEQsIDB4MDY4RSwgMHgwNjhGLCAweDA2OTAsIDB4MDY5MSwgMHgwNjkyLCAweDA2OTMsCiAgICAgIDB4MDY5NCwgMHgwNjk1LCAweDA2OTYsIDB4MDY5NywgMHgwNjk4LCAweDA2OTksIDB4MDY5QSwgMHgwNjlCLCAweDA2OUMsCiAgICAgIDB4MDY5RCwgMHgwNjlFLCAweDA2OUYsIDB4MDZBMCwgMHgwNkExLCAweDA2QTIsIDB4MDZBMywgMHgwNkE0LCAweDA2QTUsCiAgICAgIDB4MDZBNiwgMHgwNkE3LCAweDA2QTgsIDB4MDZBOSwgMHgwNkFBLCAweDA2QUIsIDB4MDZBQywgMHgwNkFELCAweDA2QUUsCiAgICAgIDB4MDZBRiwgMHgwNkIwLCAweDA2QjEsIDB4MDZCMiwgMHgwNkIzLCAweDA2QjQsIDB4MDZCNSwgMHgwNkI2LCAweDA2QjcsCiAgICAgIDB4MDZCOCwgMHgwNkI5LCAweDA2QkEsIDB4MDZCQiwgMHgwNkJDLCAweDA2QkQsIDB4MDZCRSwgMHgwNkJGLCAweDA2QzAsCiAgICAgIDB4MDZDMSwgMHgwNkMyLCAweDA2QzMsIDB4MDZDNCwgMHgwNkM1LCAweDA2QzYsIDB4MDZDNywgMHgwNkM4LCAweDA2QzksCiAgICAgIDB4MDZDQSwgMHgwNkNCLCAweDA2Q0MsIDB4MDZDRCwgMHgwNkNFLCAweDA2Q0YsIDB4MDZEMCwgMHgwNkQxLCAweDA2RDIsCiAgICAgIDB4MDZEMywgMHgwNkQ0LCAweDA2RDUsIDB4MDZFNSwgMHgwNkU2LCAweDA2RUUsIDB4MDZFRiwgMHgwNkZBLCAweDA2RkIsCiAgICAgIDB4MDZGQywgMHgwNkZELCAweDA2RkUsIDB4MDZGRiwgMHgwNzAwLCAweDA3MDEsIDB4MDcwMiwgMHgwNzAzLCAweDA3MDQsCiAgICAgIDB4MDcwNSwgMHgwNzA2LCAweDA3MDcsIDB4MDcwOCwgMHgwNzA5LCAweDA3MEEsIDB4MDcwQiwgMHgwNzBDLCAweDA3MEQsCiAgICAgIDB4MDcwRiwgMHgwNzEwLCAweDA3MTIsIDB4MDcxMywgMHgwNzE0LCAweDA3MTUsIDB4MDcxNiwgMHgwNzE3LCAweDA3MTgsCiAgICAgIDB4MDcxOSwgMHgwNzFBLCAweDA3MUIsIDB4MDcxQywgMHgwNzFELCAweDA3MUUsIDB4MDcxRiwgMHgwNzIwLCAweDA3MjEsCiAgICAgIDB4MDcyMiwgMHgwNzIzLCAweDA3MjQsIDB4MDcyNSwgMHgwNzI2LCAweDA3MjcsIDB4MDcyOCwgMHgwNzI5LCAweDA3MkEsCiAgICAgIDB4MDcyQiwgMHgwNzJDLCAweDA3MkQsIDB4MDcyRSwgMHgwNzJGLCAweDA3NEQsIDB4MDc0RSwgMHgwNzRGLCAweDA3NTAsCiAgICAgIDB4MDc1MSwgMHgwNzUyLCAweDA3NTMsIDB4MDc1NCwgMHgwNzU1LCAweDA3NTYsIDB4MDc1NywgMHgwNzU4LCAweDA3NTksCiAgICAgIDB4MDc1QSwgMHgwNzVCLCAweDA3NUMsIDB4MDc1RCwgMHgwNzVFLCAweDA3NUYsIDB4MDc2MCwgMHgwNzYxLCAweDA3NjIsCiAgICAgIDB4MDc2MywgMHgwNzY0LCAweDA3NjUsIDB4MDc2NiwgMHgwNzY3LCAweDA3NjgsIDB4MDc2OSwgMHgwNzZBLCAweDA3NkIsCiAgICAgIDB4MDc2QywgMHgwNzZELCAweDA3NkUsIDB4MDc2RiwgMHgwNzcwLCAweDA3NzEsIDB4MDc3MiwgMHgwNzczLCAweDA3NzQsCiAgICAgIDB4MDc3NSwgMHgwNzc2LCAweDA3NzcsIDB4MDc3OCwgMHgwNzc5LCAweDA3N0EsIDB4MDc3QiwgMHgwNzdDLCAweDA3N0QsCiAgICAgIDB4MDc3RSwgMHgwNzdGLCAweDA3ODAsIDB4MDc4MSwgMHgwNzgyLCAweDA3ODMsIDB4MDc4NCwgMHgwNzg1LCAweDA3ODYsCiAgICAgIDB4MDc4NywgMHgwNzg4LCAweDA3ODksIDB4MDc4QSwgMHgwNzhCLCAweDA3OEMsIDB4MDc4RCwgMHgwNzhFLCAweDA3OEYsCiAgICAgIDB4MDc5MCwgMHgwNzkxLCAweDA3OTIsIDB4MDc5MywgMHgwNzk0LCAweDA3OTUsIDB4MDc5NiwgMHgwNzk3LCAweDA3OTgsCiAgICAgIDB4MDc5OSwgMHgwNzlBLCAweDA3OUIsIDB4MDc5QywgMHgwNzlELCAweDA3OUUsIDB4MDc5RiwgMHgwN0EwLCAweDA3QTEsCiAgICAgIDB4MDdBMiwgMHgwN0EzLCAweDA3QTQsIDB4MDdBNSwgMHgwN0IxLCAweDA3QzAsIDB4MDdDMSwgMHgwN0MyLCAweDA3QzMsCiAgICAgIDB4MDdDNCwgMHgwN0M1LCAweDA3QzYsIDB4MDdDNywgMHgwN0M4LCAweDA3QzksIDB4MDdDQSwgMHgwN0NCLCAweDA3Q0MsCiAgICAgIDB4MDdDRCwgMHgwN0NFLCAweDA3Q0YsIDB4MDdEMCwgMHgwN0QxLCAweDA3RDIsIDB4MDdEMywgMHgwN0Q0LCAweDA3RDUsCiAgICAgIDB4MDdENiwgMHgwN0Q3LCAweDA3RDgsIDB4MDdEOSwgMHgwN0RBLCAweDA3REIsIDB4MDdEQywgMHgwN0RELCAweDA3REUsCiAgICAgIDB4MDdERiwgMHgwN0UwLCAweDA3RTEsIDB4MDdFMiwgMHgwN0UzLCAweDA3RTQsIDB4MDdFNSwgMHgwN0U2LCAweDA3RTcsCiAgICAgIDB4MDdFOCwgMHgwN0U5LCAweDA3RUEsIDB4MDdGNCwgMHgwN0Y1LCAweDA3RkEsIDB4MDgwMCwgMHgwODAxLCAweDA4MDIsCiAgICAgIDB4MDgwMywgMHgwODA0LCAweDA4MDUsIDB4MDgwNiwgMHgwODA3LCAweDA4MDgsIDB4MDgwOSwgMHgwODBBLCAweDA4MEIsCiAgICAgIDB4MDgwQywgMHgwODBELCAweDA4MEUsIDB4MDgwRiwgMHgwODEwLCAweDA4MTEsIDB4MDgxMiwgMHgwODEzLCAweDA4MTQsCiAgICAgIDB4MDgxNSwgMHgwODFBLCAweDA4MjQsIDB4MDgyOCwgMHgwODMwLCAweDA4MzEsIDB4MDgzMiwgMHgwODMzLCAweDA4MzQsCiAgICAgIDB4MDgzNSwgMHgwODM2LCAweDA4MzcsIDB4MDgzOCwgMHgwODM5LCAweDA4M0EsIDB4MDgzQiwgMHgwODNDLCAweDA4M0QsCiAgICAgIDB4MDgzRSwgMHgwODQwLCAweDA4NDEsIDB4MDg0MiwgMHgwODQzLCAweDA4NDQsIDB4MDg0NSwgMHgwODQ2LCAweDA4NDcsCiAgICAgIDB4MDg0OCwgMHgwODQ5LCAweDA4NEEsIDB4MDg0QiwgMHgwODRDLCAweDA4NEQsIDB4MDg0RSwgMHgwODRGLCAweDA4NTAsCiAgICAgIDB4MDg1MSwgMHgwODUyLCAweDA4NTMsIDB4MDg1NCwgMHgwODU1LCAweDA4NTYsIDB4MDg1NywgMHgwODU4LCAweDA4NUUsCiAgICAgIDB4MDhBMCwgMHgwOEEyLCAweDA4QTMsIDB4MDhBNCwgMHgwOEE1LCAweDA4QTYsIDB4MDhBNywgMHgwOEE4LCAweDA4QTksCiAgICAgIDB4MDhBQSwgMHgwOEFCLCAweDA4QUMsIDB4MjAwRiwgMHhGQjFELCAweEZCMUYsIDB4RkIyMCwgMHhGQjIxLCAweEZCMjIsCiAgICAgIDB4RkIyMywgMHhGQjI0LCAweEZCMjUsIDB4RkIyNiwgMHhGQjI3LCAweEZCMjgsIDB4RkIyQSwgMHhGQjJCLCAweEZCMkMsCiAgICAgIDB4RkIyRCwgMHhGQjJFLCAweEZCMkYsIDB4RkIzMCwgMHhGQjMxLCAweEZCMzIsIDB4RkIzMywgMHhGQjM0LCAweEZCMzUsCiAgICAgIDB4RkIzNiwgMHhGQjM4LCAweEZCMzksIDB4RkIzQSwgMHhGQjNCLCAweEZCM0MsIDB4RkIzRSwgMHhGQjQwLCAweEZCNDEsCiAgICAgIDB4RkI0MywgMHhGQjQ0LCAweEZCNDYsIDB4RkI0NywgMHhGQjQ4LCAweEZCNDksIDB4RkI0QSwgMHhGQjRCLCAweEZCNEMsCiAgICAgIDB4RkI0RCwgMHhGQjRFLCAweEZCNEYsIDB4RkI1MCwgMHhGQjUxLCAweEZCNTIsIDB4RkI1MywgMHhGQjU0LCAweEZCNTUsCiAgICAgIDB4RkI1NiwgMHhGQjU3LCAweEZCNTgsIDB4RkI1OSwgMHhGQjVBLCAweEZCNUIsIDB4RkI1QywgMHhGQjVELCAweEZCNUUsCiAgICAgIDB4RkI1RiwgMHhGQjYwLCAweEZCNjEsIDB4RkI2MiwgMHhGQjYzLCAweEZCNjQsIDB4RkI2NSwgMHhGQjY2LCAweEZCNjcsCiAgICAgIDB4RkI2OCwgMHhGQjY5LCAweEZCNkEsIDB4RkI2QiwgMHhGQjZDLCAweEZCNkQsIDB4RkI2RSwgMHhGQjZGLCAweEZCNzAsCiAgICAgIDB4RkI3MSwgMHhGQjcyLCAweEZCNzMsIDB4RkI3NCwgMHhGQjc1LCAweEZCNzYsIDB4RkI3NywgMHhGQjc4LCAweEZCNzksCiAgICAgIDB4RkI3QSwgMHhGQjdCLCAweEZCN0MsIDB4RkI3RCwgMHhGQjdFLCAweEZCN0YsIDB4RkI4MCwgMHhGQjgxLCAweEZCODIsCiAgICAgIDB4RkI4MywgMHhGQjg0LCAweEZCODUsIDB4RkI4NiwgMHhGQjg3LCAweEZCODgsIDB4RkI4OSwgMHhGQjhBLCAweEZCOEIsCiAgICAgIDB4RkI4QywgMHhGQjhELCAweEZCOEUsIDB4RkI4RiwgMHhGQjkwLCAweEZCOTEsIDB4RkI5MiwgMHhGQjkzLCAweEZCOTQsCiAgICAgIDB4RkI5NSwgMHhGQjk2LCAweEZCOTcsIDB4RkI5OCwgMHhGQjk5LCAweEZCOUEsIDB4RkI5QiwgMHhGQjlDLCAweEZCOUQsCiAgICAgIDB4RkI5RSwgMHhGQjlGLCAweEZCQTAsIDB4RkJBMSwgMHhGQkEyLCAweEZCQTMsIDB4RkJBNCwgMHhGQkE1LCAweEZCQTYsCiAgICAgIDB4RkJBNywgMHhGQkE4LCAweEZCQTksIDB4RkJBQSwgMHhGQkFCLCAweEZCQUMsIDB4RkJBRCwgMHhGQkFFLCAweEZCQUYsCiAgICAgIDB4RkJCMCwgMHhGQkIxLCAweEZCQjIsIDB4RkJCMywgMHhGQkI0LCAweEZCQjUsIDB4RkJCNiwgMHhGQkI3LCAweEZCQjgsCiAgICAgIDB4RkJCOSwgMHhGQkJBLCAweEZCQkIsIDB4RkJCQywgMHhGQkJELCAweEZCQkUsIDB4RkJCRiwgMHhGQkMwLCAweEZCQzEsCiAgICAgIDB4RkJEMywgMHhGQkQ0LCAweEZCRDUsIDB4RkJENiwgMHhGQkQ3LCAweEZCRDgsIDB4RkJEOSwgMHhGQkRBLCAweEZCREIsCiAgICAgIDB4RkJEQywgMHhGQkRELCAweEZCREUsIDB4RkJERiwgMHhGQkUwLCAweEZCRTEsIDB4RkJFMiwgMHhGQkUzLCAweEZCRTQsCiAgICAgIDB4RkJFNSwgMHhGQkU2LCAweEZCRTcsIDB4RkJFOCwgMHhGQkU5LCAweEZCRUEsIDB4RkJFQiwgMHhGQkVDLCAweEZCRUQsCiAgICAgIDB4RkJFRSwgMHhGQkVGLCAweEZCRjAsIDB4RkJGMSwgMHhGQkYyLCAweEZCRjMsIDB4RkJGNCwgMHhGQkY1LCAweEZCRjYsCiAgICAgIDB4RkJGNywgMHhGQkY4LCAweEZCRjksIDB4RkJGQSwgMHhGQkZCLCAweEZCRkMsIDB4RkJGRCwgMHhGQkZFLCAweEZCRkYsCiAgICAgIDB4RkMwMCwgMHhGQzAxLCAweEZDMDIsIDB4RkMwMywgMHhGQzA0LCAweEZDMDUsIDB4RkMwNiwgMHhGQzA3LCAweEZDMDgsCiAgICAgIDB4RkMwOSwgMHhGQzBBLCAweEZDMEIsIDB4RkMwQywgMHhGQzBELCAweEZDMEUsIDB4RkMwRiwgMHhGQzEwLCAweEZDMTEsCiAgICAgIDB4RkMxMiwgMHhGQzEzLCAweEZDMTQsIDB4RkMxNSwgMHhGQzE2LCAweEZDMTcsIDB4RkMxOCwgMHhGQzE5LCAweEZDMUEsCiAgICAgIDB4RkMxQiwgMHhGQzFDLCAweEZDMUQsIDB4RkMxRSwgMHhGQzFGLCAweEZDMjAsIDB4RkMyMSwgMHhGQzIyLCAweEZDMjMsCiAgICAgIDB4RkMyNCwgMHhGQzI1LCAweEZDMjYsIDB4RkMyNywgMHhGQzI4LCAweEZDMjksIDB4RkMyQSwgMHhGQzJCLCAweEZDMkMsCiAgICAgIDB4RkMyRCwgMHhGQzJFLCAweEZDMkYsIDB4RkMzMCwgMHhGQzMxLCAweEZDMzIsIDB4RkMzMywgMHhGQzM0LCAweEZDMzUsCiAgICAgIDB4RkMzNiwgMHhGQzM3LCAweEZDMzgsIDB4RkMzOSwgMHhGQzNBLCAweEZDM0IsIDB4RkMzQywgMHhGQzNELCAweEZDM0UsCiAgICAgIDB4RkMzRiwgMHhGQzQwLCAweEZDNDEsIDB4RkM0MiwgMHhGQzQzLCAweEZDNDQsIDB4RkM0NSwgMHhGQzQ2LCAweEZDNDcsCiAgICAgIDB4RkM0OCwgMHhGQzQ5LCAweEZDNEEsIDB4RkM0QiwgMHhGQzRDLCAweEZDNEQsIDB4RkM0RSwgMHhGQzRGLCAweEZDNTAsCiAgICAgIDB4RkM1MSwgMHhGQzUyLCAweEZDNTMsIDB4RkM1NCwgMHhGQzU1LCAweEZDNTYsIDB4RkM1NywgMHhGQzU4LCAweEZDNTksCiAgICAgIDB4RkM1QSwgMHhGQzVCLCAweEZDNUMsIDB4RkM1RCwgMHhGQzVFLCAweEZDNUYsIDB4RkM2MCwgMHhGQzYxLCAweEZDNjIsCiAgICAgIDB4RkM2MywgMHhGQzY0LCAweEZDNjUsIDB4RkM2NiwgMHhGQzY3LCAweEZDNjgsIDB4RkM2OSwgMHhGQzZBLCAweEZDNkIsCiAgICAgIDB4RkM2QywgMHhGQzZELCAweEZDNkUsIDB4RkM2RiwgMHhGQzcwLCAweEZDNzEsIDB4RkM3MiwgMHhGQzczLCAweEZDNzQsCiAgICAgIDB4RkM3NSwgMHhGQzc2LCAweEZDNzcsIDB4RkM3OCwgMHhGQzc5LCAweEZDN0EsIDB4RkM3QiwgMHhGQzdDLCAweEZDN0QsCiAgICAgIDB4RkM3RSwgMHhGQzdGLCAweEZDODAsIDB4RkM4MSwgMHhGQzgyLCAweEZDODMsIDB4RkM4NCwgMHhGQzg1LCAweEZDODYsCiAgICAgIDB4RkM4NywgMHhGQzg4LCAweEZDODksIDB4RkM4QSwgMHhGQzhCLCAweEZDOEMsIDB4RkM4RCwgMHhGQzhFLCAweEZDOEYsCiAgICAgIDB4RkM5MCwgMHhGQzkxLCAweEZDOTIsIDB4RkM5MywgMHhGQzk0LCAweEZDOTUsIDB4RkM5NiwgMHhGQzk3LCAweEZDOTgsCiAgICAgIDB4RkM5OSwgMHhGQzlBLCAweEZDOUIsIDB4RkM5QywgMHhGQzlELCAweEZDOUUsIDB4RkM5RiwgMHhGQ0EwLCAweEZDQTEsCiAgICAgIDB4RkNBMiwgMHhGQ0EzLCAweEZDQTQsIDB4RkNBNSwgMHhGQ0E2LCAweEZDQTcsIDB4RkNBOCwgMHhGQ0E5LCAweEZDQUEsCiAgICAgIDB4RkNBQiwgMHhGQ0FDLCAweEZDQUQsIDB4RkNBRSwgMHhGQ0FGLCAweEZDQjAsIDB4RkNCMSwgMHhGQ0IyLCAweEZDQjMsCiAgICAgIDB4RkNCNCwgMHhGQ0I1LCAweEZDQjYsIDB4RkNCNywgMHhGQ0I4LCAweEZDQjksIDB4RkNCQSwgMHhGQ0JCLCAweEZDQkMsCiAgICAgIDB4RkNCRCwgMHhGQ0JFLCAweEZDQkYsIDB4RkNDMCwgMHhGQ0MxLCAweEZDQzIsIDB4RkNDMywgMHhGQ0M0LCAweEZDQzUsCiAgICAgIDB4RkNDNiwgMHhGQ0M3LCAweEZDQzgsIDB4RkNDOSwgMHhGQ0NBLCAweEZDQ0IsIDB4RkNDQywgMHhGQ0NELCAweEZDQ0UsCiAgICAgIDB4RkNDRiwgMHhGQ0QwLCAweEZDRDEsIDB4RkNEMiwgMHhGQ0QzLCAweEZDRDQsIDB4RkNENSwgMHhGQ0Q2LCAweEZDRDcsCiAgICAgIDB4RkNEOCwgMHhGQ0Q5LCAweEZDREEsIDB4RkNEQiwgMHhGQ0RDLCAweEZDREQsIDB4RkNERSwgMHhGQ0RGLCAweEZDRTAsCiAgICAgIDB4RkNFMSwgMHhGQ0UyLCAweEZDRTMsIDB4RkNFNCwgMHhGQ0U1LCAweEZDRTYsIDB4RkNFNywgMHhGQ0U4LCAweEZDRTksCiAgICAgIDB4RkNFQSwgMHhGQ0VCLCAweEZDRUMsIDB4RkNFRCwgMHhGQ0VFLCAweEZDRUYsIDB4RkNGMCwgMHhGQ0YxLCAweEZDRjIsCiAgICAgIDB4RkNGMywgMHhGQ0Y0LCAweEZDRjUsIDB4RkNGNiwgMHhGQ0Y3LCAweEZDRjgsIDB4RkNGOSwgMHhGQ0ZBLCAweEZDRkIsCiAgICAgIDB4RkNGQywgMHhGQ0ZELCAweEZDRkUsIDB4RkNGRiwgMHhGRDAwLCAweEZEMDEsIDB4RkQwMiwgMHhGRDAzLCAweEZEMDQsCiAgICAgIDB4RkQwNSwgMHhGRDA2LCAweEZEMDcsIDB4RkQwOCwgMHhGRDA5LCAweEZEMEEsIDB4RkQwQiwgMHhGRDBDLCAweEZEMEQsCiAgICAgIDB4RkQwRSwgMHhGRDBGLCAweEZEMTAsIDB4RkQxMSwgMHhGRDEyLCAweEZEMTMsIDB4RkQxNCwgMHhGRDE1LCAweEZEMTYsCiAgICAgIDB4RkQxNywgMHhGRDE4LCAweEZEMTksIDB4RkQxQSwgMHhGRDFCLCAweEZEMUMsIDB4RkQxRCwgMHhGRDFFLCAweEZEMUYsCiAgICAgIDB4RkQyMCwgMHhGRDIxLCAweEZEMjIsIDB4RkQyMywgMHhGRDI0LCAweEZEMjUsIDB4RkQyNiwgMHhGRDI3LCAweEZEMjgsCiAgICAgIDB4RkQyOSwgMHhGRDJBLCAweEZEMkIsIDB4RkQyQywgMHhGRDJELCAweEZEMkUsIDB4RkQyRiwgMHhGRDMwLCAweEZEMzEsCiAgICAgIDB4RkQzMiwgMHhGRDMzLCAweEZEMzQsIDB4RkQzNSwgMHhGRDM2LCAweEZEMzcsIDB4RkQzOCwgMHhGRDM5LCAweEZEM0EsCiAgICAgIDB4RkQzQiwgMHhGRDNDLCAweEZEM0QsIDB4RkQ1MCwgMHhGRDUxLCAweEZENTIsIDB4RkQ1MywgMHhGRDU0LCAweEZENTUsCiAgICAgIDB4RkQ1NiwgMHhGRDU3LCAweEZENTgsIDB4RkQ1OSwgMHhGRDVBLCAweEZENUIsIDB4RkQ1QywgMHhGRDVELCAweEZENUUsCiAgICAgIDB4RkQ1RiwgMHhGRDYwLCAweEZENjEsIDB4RkQ2MiwgMHhGRDYzLCAweEZENjQsIDB4RkQ2NSwgMHhGRDY2LCAweEZENjcsCiAgICAgIDB4RkQ2OCwgMHhGRDY5LCAweEZENkEsIDB4RkQ2QiwgMHhGRDZDLCAweEZENkQsIDB4RkQ2RSwgMHhGRDZGLCAweEZENzAsCiAgICAgIDB4RkQ3MSwgMHhGRDcyLCAweEZENzMsIDB4RkQ3NCwgMHhGRDc1LCAweEZENzYsIDB4RkQ3NywgMHhGRDc4LCAweEZENzksCiAgICAgIDB4RkQ3QSwgMHhGRDdCLCAweEZEN0MsIDB4RkQ3RCwgMHhGRDdFLCAweEZEN0YsIDB4RkQ4MCwgMHhGRDgxLCAweEZEODIsCiAgICAgIDB4RkQ4MywgMHhGRDg0LCAweEZEODUsIDB4RkQ4NiwgMHhGRDg3LCAweEZEODgsIDB4RkQ4OSwgMHhGRDhBLCAweEZEOEIsCiAgICAgIDB4RkQ4QywgMHhGRDhELCAweEZEOEUsIDB4RkQ4RiwgMHhGRDkyLCAweEZEOTMsIDB4RkQ5NCwgMHhGRDk1LCAweEZEOTYsCiAgICAgIDB4RkQ5NywgMHhGRDk4LCAweEZEOTksIDB4RkQ5QSwgMHhGRDlCLCAweEZEOUMsIDB4RkQ5RCwgMHhGRDlFLCAweEZEOUYsCiAgICAgIDB4RkRBMCwgMHhGREExLCAweEZEQTIsIDB4RkRBMywgMHhGREE0LCAweEZEQTUsIDB4RkRBNiwgMHhGREE3LCAweEZEQTgsCiAgICAgIDB4RkRBOSwgMHhGREFBLCAweEZEQUIsIDB4RkRBQywgMHhGREFELCAweEZEQUUsIDB4RkRBRiwgMHhGREIwLCAweEZEQjEsCiAgICAgIDB4RkRCMiwgMHhGREIzLCAweEZEQjQsIDB4RkRCNSwgMHhGREI2LCAweEZEQjcsIDB4RkRCOCwgMHhGREI5LCAweEZEQkEsCiAgICAgIDB4RkRCQiwgMHhGREJDLCAweEZEQkQsIDB4RkRCRSwgMHhGREJGLCAweEZEQzAsIDB4RkRDMSwgMHhGREMyLCAweEZEQzMsCiAgICAgIDB4RkRDNCwgMHhGREM1LCAweEZEQzYsIDB4RkRDNywgMHhGREYwLCAweEZERjEsIDB4RkRGMiwgMHhGREYzLCAweEZERjQsCiAgICAgIDB4RkRGNSwgMHhGREY2LCAweEZERjcsIDB4RkRGOCwgMHhGREY5LCAweEZERkEsIDB4RkRGQiwgMHhGREZDLCAweEZFNzAsCiAgICAgIDB4RkU3MSwgMHhGRTcyLCAweEZFNzMsIDB4RkU3NCwgMHhGRTc2LCAweEZFNzcsIDB4RkU3OCwgMHhGRTc5LCAweEZFN0EsCiAgICAgIDB4RkU3QiwgMHhGRTdDLCAweEZFN0QsIDB4RkU3RSwgMHhGRTdGLCAweEZFODAsIDB4RkU4MSwgMHhGRTgyLCAweEZFODMsCiAgICAgIDB4RkU4NCwgMHhGRTg1LCAweEZFODYsIDB4RkU4NywgMHhGRTg4LCAweEZFODksIDB4RkU4QSwgMHhGRThCLCAweEZFOEMsCiAgICAgIDB4RkU4RCwgMHhGRThFLCAweEZFOEYsIDB4RkU5MCwgMHhGRTkxLCAweEZFOTIsIDB4RkU5MywgMHhGRTk0LCAweEZFOTUsCiAgICAgIDB4RkU5NiwgMHhGRTk3LCAweEZFOTgsIDB4RkU5OSwgMHhGRTlBLCAweEZFOUIsIDB4RkU5QywgMHhGRTlELCAweEZFOUUsCiAgICAgIDB4RkU5RiwgMHhGRUEwLCAweEZFQTEsIDB4RkVBMiwgMHhGRUEzLCAweEZFQTQsIDB4RkVBNSwgMHhGRUE2LCAweEZFQTcsCiAgICAgIDB4RkVBOCwgMHhGRUE5LCAweEZFQUEsIDB4RkVBQiwgMHhGRUFDLCAweEZFQUQsIDB4RkVBRSwgMHhGRUFGLCAweEZFQjAsCiAgICAgIDB4RkVCMSwgMHhGRUIyLCAweEZFQjMsIDB4RkVCNCwgMHhGRUI1LCAweEZFQjYsIDB4RkVCNywgMHhGRUI4LCAweEZFQjksCiAgICAgIDB4RkVCQSwgMHhGRUJCLCAweEZFQkMsIDB4RkVCRCwgMHhGRUJFLCAweEZFQkYsIDB4RkVDMCwgMHhGRUMxLCAweEZFQzIsCiAgICAgIDB4RkVDMywgMHhGRUM0LCAweEZFQzUsIDB4RkVDNiwgMHhGRUM3LCAweEZFQzgsIDB4RkVDOSwgMHhGRUNBLCAweEZFQ0IsCiAgICAgIDB4RkVDQywgMHhGRUNELCAweEZFQ0UsIDB4RkVDRiwgMHhGRUQwLCAweEZFRDEsIDB4RkVEMiwgMHhGRUQzLCAweEZFRDQsCiAgICAgIDB4RkVENSwgMHhGRUQ2LCAweEZFRDcsIDB4RkVEOCwgMHhGRUQ5LCAweEZFREEsIDB4RkVEQiwgMHhGRURDLCAweEZFREQsCiAgICAgIDB4RkVERSwgMHhGRURGLCAweEZFRTAsIDB4RkVFMSwgMHhGRUUyLCAweEZFRTMsIDB4RkVFNCwgMHhGRUU1LCAweEZFRTYsCiAgICAgIDB4RkVFNywgMHhGRUU4LCAweEZFRTksIDB4RkVFQSwgMHhGRUVCLCAweEZFRUMsIDB4RkVFRCwgMHhGRUVFLCAweEZFRUYsCiAgICAgIDB4RkVGMCwgMHhGRUYxLCAweEZFRjIsIDB4RkVGMywgMHhGRUY0LCAweEZFRjUsIDB4RkVGNiwgMHhGRUY3LCAweEZFRjgsCiAgICAgIDB4RkVGOSwgMHhGRUZBLCAweEZFRkIsIDB4RkVGQywgMHgxMDgwMCwgMHgxMDgwMSwgMHgxMDgwMiwgMHgxMDgwMywKICAgICAgMHgxMDgwNCwgMHgxMDgwNSwgMHgxMDgwOCwgMHgxMDgwQSwgMHgxMDgwQiwgMHgxMDgwQywgMHgxMDgwRCwgMHgxMDgwRSwKICAgICAgMHgxMDgwRiwgMHgxMDgxMCwgMHgxMDgxMSwgMHgxMDgxMiwgMHgxMDgxMywgMHgxMDgxNCwgMHgxMDgxNSwgMHgxMDgxNiwKICAgICAgMHgxMDgxNywgMHgxMDgxOCwgMHgxMDgxOSwgMHgxMDgxQSwgMHgxMDgxQiwgMHgxMDgxQywgMHgxMDgxRCwgMHgxMDgxRSwKICAgICAgMHgxMDgxRiwgMHgxMDgyMCwgMHgxMDgyMSwgMHgxMDgyMiwgMHgxMDgyMywgMHgxMDgyNCwgMHgxMDgyNSwgMHgxMDgyNiwKICAgICAgMHgxMDgyNywgMHgxMDgyOCwgMHgxMDgyOSwgMHgxMDgyQSwgMHgxMDgyQiwgMHgxMDgyQywgMHgxMDgyRCwgMHgxMDgyRSwKICAgICAgMHgxMDgyRiwgMHgxMDgzMCwgMHgxMDgzMSwgMHgxMDgzMiwgMHgxMDgzMywgMHgxMDgzNCwgMHgxMDgzNSwgMHgxMDgzNywKICAgICAgMHgxMDgzOCwgMHgxMDgzQywgMHgxMDgzRiwgMHgxMDg0MCwgMHgxMDg0MSwgMHgxMDg0MiwgMHgxMDg0MywgMHgxMDg0NCwKICAgICAgMHgxMDg0NSwgMHgxMDg0NiwgMHgxMDg0NywgMHgxMDg0OCwgMHgxMDg0OSwgMHgxMDg0QSwgMHgxMDg0QiwgMHgxMDg0QywKICAgICAgMHgxMDg0RCwgMHgxMDg0RSwgMHgxMDg0RiwgMHgxMDg1MCwgMHgxMDg1MSwgMHgxMDg1MiwgMHgxMDg1MywgMHgxMDg1NCwKICAgICAgMHgxMDg1NSwgMHgxMDg1NywgMHgxMDg1OCwgMHgxMDg1OSwgMHgxMDg1QSwgMHgxMDg1QiwgMHgxMDg1QywgMHgxMDg1RCwKICAgICAgMHgxMDg1RSwgMHgxMDg1RiwgMHgxMDkwMCwgMHgxMDkwMSwgMHgxMDkwMiwgMHgxMDkwMywgMHgxMDkwNCwgMHgxMDkwNSwKICAgICAgMHgxMDkwNiwgMHgxMDkwNywgMHgxMDkwOCwgMHgxMDkwOSwgMHgxMDkwQSwgMHgxMDkwQiwgMHgxMDkwQywgMHgxMDkwRCwKICAgICAgMHgxMDkwRSwgMHgxMDkwRiwgMHgxMDkxMCwgMHgxMDkxMSwgMHgxMDkxMiwgMHgxMDkxMywgMHgxMDkxNCwgMHgxMDkxNSwKICAgICAgMHgxMDkxNiwgMHgxMDkxNywgMHgxMDkxOCwgMHgxMDkxOSwgMHgxMDkxQSwgMHgxMDkxQiwgMHgxMDkyMCwgMHgxMDkyMSwKICAgICAgMHgxMDkyMiwgMHgxMDkyMywgMHgxMDkyNCwgMHgxMDkyNSwgMHgxMDkyNiwgMHgxMDkyNywgMHgxMDkyOCwgMHgxMDkyOSwKICAgICAgMHgxMDkyQSwgMHgxMDkyQiwgMHgxMDkyQywgMHgxMDkyRCwgMHgxMDkyRSwgMHgxMDkyRiwgMHgxMDkzMCwgMHgxMDkzMSwKICAgICAgMHgxMDkzMiwgMHgxMDkzMywgMHgxMDkzNCwgMHgxMDkzNSwgMHgxMDkzNiwgMHgxMDkzNywgMHgxMDkzOCwgMHgxMDkzOSwKICAgICAgMHgxMDkzRiwgMHgxMDk4MCwgMHgxMDk4MSwgMHgxMDk4MiwgMHgxMDk4MywgMHgxMDk4NCwgMHgxMDk4NSwgMHgxMDk4NiwKICAgICAgMHgxMDk4NywgMHgxMDk4OCwgMHgxMDk4OSwgMHgxMDk4QSwgMHgxMDk4QiwgMHgxMDk4QywgMHgxMDk4RCwgMHgxMDk4RSwKICAgICAgMHgxMDk4RiwgMHgxMDk5MCwgMHgxMDk5MSwgMHgxMDk5MiwgMHgxMDk5MywgMHgxMDk5NCwgMHgxMDk5NSwgMHgxMDk5NiwKICAgICAgMHgxMDk5NywgMHgxMDk5OCwgMHgxMDk5OSwgMHgxMDk5QSwgMHgxMDk5QiwgMHgxMDk5QywgMHgxMDk5RCwgMHgxMDk5RSwKICAgICAgMHgxMDk5RiwgMHgxMDlBMCwgMHgxMDlBMSwgMHgxMDlBMiwgMHgxMDlBMywgMHgxMDlBNCwgMHgxMDlBNSwgMHgxMDlBNiwKICAgICAgMHgxMDlBNywgMHgxMDlBOCwgMHgxMDlBOSwgMHgxMDlBQSwgMHgxMDlBQiwgMHgxMDlBQywgMHgxMDlBRCwgMHgxMDlBRSwKICAgICAgMHgxMDlBRiwgMHgxMDlCMCwgMHgxMDlCMSwgMHgxMDlCMiwgMHgxMDlCMywgMHgxMDlCNCwgMHgxMDlCNSwgMHgxMDlCNiwKICAgICAgMHgxMDlCNywgMHgxMDlCRSwgMHgxMDlCRiwgMHgxMEEwMCwgMHgxMEExMCwgMHgxMEExMSwgMHgxMEExMiwgMHgxMEExMywKICAgICAgMHgxMEExNSwgMHgxMEExNiwgMHgxMEExNywgMHgxMEExOSwgMHgxMEExQSwgMHgxMEExQiwgMHgxMEExQywgMHgxMEExRCwKICAgICAgMHgxMEExRSwgMHgxMEExRiwgMHgxMEEyMCwgMHgxMEEyMSwgMHgxMEEyMiwgMHgxMEEyMywgMHgxMEEyNCwgMHgxMEEyNSwKICAgICAgMHgxMEEyNiwgMHgxMEEyNywgMHgxMEEyOCwgMHgxMEEyOSwgMHgxMEEyQSwgMHgxMEEyQiwgMHgxMEEyQywgMHgxMEEyRCwKICAgICAgMHgxMEEyRSwgMHgxMEEyRiwgMHgxMEEzMCwgMHgxMEEzMSwgMHgxMEEzMiwgMHgxMEEzMywgMHgxMEE0MCwgMHgxMEE0MSwKICAgICAgMHgxMEE0MiwgMHgxMEE0MywgMHgxMEE0NCwgMHgxMEE0NSwgMHgxMEE0NiwgMHgxMEE0NywgMHgxMEE1MCwgMHgxMEE1MSwKICAgICAgMHgxMEE1MiwgMHgxMEE1MywgMHgxMEE1NCwgMHgxMEE1NSwgMHgxMEE1NiwgMHgxMEE1NywgMHgxMEE1OCwgMHgxMEE2MCwKICAgICAgMHgxMEE2MSwgMHgxMEE2MiwgMHgxMEE2MywgMHgxMEE2NCwgMHgxMEE2NSwgMHgxMEE2NiwgMHgxMEE2NywgMHgxMEE2OCwKICAgICAgMHgxMEE2OSwgMHgxMEE2QSwgMHgxMEE2QiwgMHgxMEE2QywgMHgxMEE2RCwgMHgxMEE2RSwgMHgxMEE2RiwgMHgxMEE3MCwKICAgICAgMHgxMEE3MSwgMHgxMEE3MiwgMHgxMEE3MywgMHgxMEE3NCwgMHgxMEE3NSwgMHgxMEE3NiwgMHgxMEE3NywgMHgxMEE3OCwKICAgICAgMHgxMEE3OSwgMHgxMEE3QSwgMHgxMEE3QiwgMHgxMEE3QywgMHgxMEE3RCwgMHgxMEE3RSwgMHgxMEE3RiwgMHgxMEIwMCwKICAgICAgMHgxMEIwMSwgMHgxMEIwMiwgMHgxMEIwMywgMHgxMEIwNCwgMHgxMEIwNSwgMHgxMEIwNiwgMHgxMEIwNywgMHgxMEIwOCwKICAgICAgMHgxMEIwOSwgMHgxMEIwQSwgMHgxMEIwQiwgMHgxMEIwQywgMHgxMEIwRCwgMHgxMEIwRSwgMHgxMEIwRiwgMHgxMEIxMCwKICAgICAgMHgxMEIxMSwgMHgxMEIxMiwgMHgxMEIxMywgMHgxMEIxNCwgMHgxMEIxNSwgMHgxMEIxNiwgMHgxMEIxNywgMHgxMEIxOCwKICAgICAgMHgxMEIxOSwgMHgxMEIxQSwgMHgxMEIxQiwgMHgxMEIxQywgMHgxMEIxRCwgMHgxMEIxRSwgMHgxMEIxRiwgMHgxMEIyMCwKICAgICAgMHgxMEIyMSwgMHgxMEIyMiwgMHgxMEIyMywgMHgxMEIyNCwgMHgxMEIyNSwgMHgxMEIyNiwgMHgxMEIyNywgMHgxMEIyOCwKICAgICAgMHgxMEIyOSwgMHgxMEIyQSwgMHgxMEIyQiwgMHgxMEIyQywgMHgxMEIyRCwgMHgxMEIyRSwgMHgxMEIyRiwgMHgxMEIzMCwKICAgICAgMHgxMEIzMSwgMHgxMEIzMiwgMHgxMEIzMywgMHgxMEIzNCwgMHgxMEIzNSwgMHgxMEI0MCwgMHgxMEI0MSwgMHgxMEI0MiwKICAgICAgMHgxMEI0MywgMHgxMEI0NCwgMHgxMEI0NSwgMHgxMEI0NiwgMHgxMEI0NywgMHgxMEI0OCwgMHgxMEI0OSwgMHgxMEI0QSwKICAgICAgMHgxMEI0QiwgMHgxMEI0QywgMHgxMEI0RCwgMHgxMEI0RSwgMHgxMEI0RiwgMHgxMEI1MCwgMHgxMEI1MSwgMHgxMEI1MiwKICAgICAgMHgxMEI1MywgMHgxMEI1NCwgMHgxMEI1NSwgMHgxMEI1OCwgMHgxMEI1OSwgMHgxMEI1QSwgMHgxMEI1QiwgMHgxMEI1QywKICAgICAgMHgxMEI1RCwgMHgxMEI1RSwgMHgxMEI1RiwgMHgxMEI2MCwgMHgxMEI2MSwgMHgxMEI2MiwgMHgxMEI2MywgMHgxMEI2NCwKICAgICAgMHgxMEI2NSwgMHgxMEI2NiwgMHgxMEI2NywgMHgxMEI2OCwgMHgxMEI2OSwgMHgxMEI2QSwgMHgxMEI2QiwgMHgxMEI2QywKICAgICAgMHgxMEI2RCwgMHgxMEI2RSwgMHgxMEI2RiwgMHgxMEI3MCwgMHgxMEI3MSwgMHgxMEI3MiwgMHgxMEI3OCwgMHgxMEI3OSwKICAgICAgMHgxMEI3QSwgMHgxMEI3QiwgMHgxMEI3QywgMHgxMEI3RCwgMHgxMEI3RSwgMHgxMEI3RiwgMHgxMEMwMCwgMHgxMEMwMSwKICAgICAgMHgxMEMwMiwgMHgxMEMwMywgMHgxMEMwNCwgMHgxMEMwNSwgMHgxMEMwNiwgMHgxMEMwNywgMHgxMEMwOCwgMHgxMEMwOSwKICAgICAgMHgxMEMwQSwgMHgxMEMwQiwgMHgxMEMwQywgMHgxMEMwRCwgMHgxMEMwRSwgMHgxMEMwRiwgMHgxMEMxMCwgMHgxMEMxMSwKICAgICAgMHgxMEMxMiwgMHgxMEMxMywgMHgxMEMxNCwgMHgxMEMxNSwgMHgxMEMxNiwgMHgxMEMxNywgMHgxMEMxOCwgMHgxMEMxOSwKICAgICAgMHgxMEMxQSwgMHgxMEMxQiwgMHgxMEMxQywgMHgxMEMxRCwgMHgxMEMxRSwgMHgxMEMxRiwgMHgxMEMyMCwgMHgxMEMyMSwKICAgICAgMHgxMEMyMiwgMHgxMEMyMywgMHgxMEMyNCwgMHgxMEMyNSwgMHgxMEMyNiwgMHgxMEMyNywgMHgxMEMyOCwgMHgxMEMyOSwKICAgICAgMHgxMEMyQSwgMHgxMEMyQiwgMHgxMEMyQywgMHgxMEMyRCwgMHgxMEMyRSwgMHgxMEMyRiwgMHgxMEMzMCwgMHgxMEMzMSwKICAgICAgMHgxMEMzMiwgMHgxMEMzMywgMHgxMEMzNCwgMHgxMEMzNSwgMHgxMEMzNiwgMHgxMEMzNywgMHgxMEMzOCwgMHgxMEMzOSwKICAgICAgMHgxMEMzQSwgMHgxMEMzQiwgMHgxMEMzQywgMHgxMEMzRCwgMHgxMEMzRSwgMHgxMEMzRiwgMHgxMEM0MCwgMHgxMEM0MSwKICAgICAgMHgxMEM0MiwgMHgxMEM0MywgMHgxMEM0NCwgMHgxMEM0NSwgMHgxMEM0NiwgMHgxMEM0NywgMHgxMEM0OCwgMHgxRUUwMCwKICAgICAgMHgxRUUwMSwgMHgxRUUwMiwgMHgxRUUwMywgMHgxRUUwNSwgMHgxRUUwNiwgMHgxRUUwNywgMHgxRUUwOCwgMHgxRUUwOSwKICAgICAgMHgxRUUwQSwgMHgxRUUwQiwgMHgxRUUwQywgMHgxRUUwRCwgMHgxRUUwRSwgMHgxRUUwRiwgMHgxRUUxMCwgMHgxRUUxMSwKICAgICAgMHgxRUUxMiwgMHgxRUUxMywgMHgxRUUxNCwgMHgxRUUxNSwgMHgxRUUxNiwgMHgxRUUxNywgMHgxRUUxOCwgMHgxRUUxOSwKICAgICAgMHgxRUUxQSwgMHgxRUUxQiwgMHgxRUUxQywgMHgxRUUxRCwgMHgxRUUxRSwgMHgxRUUxRiwgMHgxRUUyMSwgMHgxRUUyMiwKICAgICAgMHgxRUUyNCwgMHgxRUUyNywgMHgxRUUyOSwgMHgxRUUyQSwgMHgxRUUyQiwgMHgxRUUyQywgMHgxRUUyRCwgMHgxRUUyRSwKICAgICAgMHgxRUUyRiwgMHgxRUUzMCwgMHgxRUUzMSwgMHgxRUUzMiwgMHgxRUUzNCwgMHgxRUUzNSwgMHgxRUUzNiwgMHgxRUUzNywKICAgICAgMHgxRUUzOSwgMHgxRUUzQiwgMHgxRUU0MiwgMHgxRUU0NywgMHgxRUU0OSwgMHgxRUU0QiwgMHgxRUU0RCwgMHgxRUU0RSwKICAgICAgMHgxRUU0RiwgMHgxRUU1MSwgMHgxRUU1MiwgMHgxRUU1NCwgMHgxRUU1NywgMHgxRUU1OSwgMHgxRUU1QiwgMHgxRUU1RCwKICAgICAgMHgxRUU1RiwgMHgxRUU2MSwgMHgxRUU2MiwgMHgxRUU2NCwgMHgxRUU2NywgMHgxRUU2OCwgMHgxRUU2OSwgMHgxRUU2QSwKICAgICAgMHgxRUU2QywgMHgxRUU2RCwgMHgxRUU2RSwgMHgxRUU2RiwgMHgxRUU3MCwgMHgxRUU3MSwgMHgxRUU3MiwgMHgxRUU3NCwKICAgICAgMHgxRUU3NSwgMHgxRUU3NiwgMHgxRUU3NywgMHgxRUU3OSwgMHgxRUU3QSwgMHgxRUU3QiwgMHgxRUU3QywgMHgxRUU3RSwKICAgICAgMHgxRUU4MCwgMHgxRUU4MSwgMHgxRUU4MiwgMHgxRUU4MywgMHgxRUU4NCwgMHgxRUU4NSwgMHgxRUU4NiwgMHgxRUU4NywKICAgICAgMHgxRUU4OCwgMHgxRUU4OSwgMHgxRUU4QiwgMHgxRUU4QywgMHgxRUU4RCwgMHgxRUU4RSwgMHgxRUU4RiwgMHgxRUU5MCwKICAgICAgMHgxRUU5MSwgMHgxRUU5MiwgMHgxRUU5MywgMHgxRUU5NCwgMHgxRUU5NSwgMHgxRUU5NiwgMHgxRUU5NywgMHgxRUU5OCwKICAgICAgMHgxRUU5OSwgMHgxRUU5QSwgMHgxRUU5QiwgMHgxRUVBMSwgMHgxRUVBMiwgMHgxRUVBMywgMHgxRUVBNSwgMHgxRUVBNiwKICAgICAgMHgxRUVBNywgMHgxRUVBOCwgMHgxRUVBOSwgMHgxRUVBQiwgMHgxRUVBQywgMHgxRUVBRCwgMHgxRUVBRSwgMHgxRUVBRiwKICAgICAgMHgxRUVCMCwgMHgxRUVCMSwgMHgxRUVCMiwgMHgxRUVCMywgMHgxRUVCNCwgMHgxRUVCNSwgMHgxRUVCNiwgMHgxRUVCNywKICAgICAgMHgxRUVCOCwgMHgxRUVCOSwgMHgxRUVCQSwgMHgxRUVCQiwgMHgxMEZGRkRdOwoKICBmdW5jdGlvbiBkZXRlcm1pbmVCaWRpKGN1ZURpdikgewogICAgdmFyIG5vZGVTdGFjayA9IFtdLAogICAgICAgIHRleHQgPSAiIiwKICAgICAgICBjaGFyQ29kZTsKCiAgICBpZiAoIWN1ZURpdiB8fCAhY3VlRGl2LmNoaWxkTm9kZXMpIHsKICAgICAgcmV0dXJuICJsdHIiOwogICAgfQoKICAgIGZ1bmN0aW9uIHB1c2hOb2Rlcyhub2RlU3RhY2ssIG5vZGUpIHsKICAgICAgZm9yICh2YXIgaSA9IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIG5vZGVTdGFjay5wdXNoKG5vZGUuY2hpbGROb2Rlc1tpXSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBuZXh0VGV4dE5vZGUobm9kZVN0YWNrKSB7CiAgICAgIGlmICghbm9kZVN0YWNrIHx8ICFub2RlU3RhY2subGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBub2RlID0gbm9kZVN0YWNrLnBvcCgpLAogICAgICAgICAgdGV4dCA9IG5vZGUudGV4dENvbnRlbnQgfHwgbm9kZS5pbm5lclRleHQ7CiAgICAgIGlmICh0ZXh0KSB7CiAgICAgICAgLy8gVE9ETzogVGhpcyBzaG91bGQgbWF0Y2ggYWxsIHVuaWNvZGUgdHlwZSBCIGNoYXJhY3RlcnMgKHBhcmFncmFwaAogICAgICAgIC8vIHNlcGFyYXRvciBjaGFyYWN0ZXJzKS4gU2VlIGlzc3VlICMxMTUuCiAgICAgICAgdmFyIG0gPSB0ZXh0Lm1hdGNoKC9eLiooXG58XHIpLyk7CiAgICAgICAgaWYgKG0pIHsKICAgICAgICAgIG5vZGVTdGFjay5sZW5ndGggPSAwOwogICAgICAgICAgcmV0dXJuIG1bMF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0ZXh0OwogICAgICB9CiAgICAgIGlmIChub2RlLnRhZ05hbWUgPT09ICJydWJ5IikgewogICAgICAgIHJldHVybiBuZXh0VGV4dE5vZGUobm9kZVN0YWNrKTsKICAgICAgfQogICAgICBpZiAobm9kZS5jaGlsZE5vZGVzKSB7CiAgICAgICAgcHVzaE5vZGVzKG5vZGVTdGFjaywgbm9kZSk7CiAgICAgICAgcmV0dXJuIG5leHRUZXh0Tm9kZShub2RlU3RhY2spOwogICAgICB9CiAgICB9CgogICAgcHVzaE5vZGVzKG5vZGVTdGFjaywgY3VlRGl2KTsKICAgIHdoaWxlICgodGV4dCA9IG5leHRUZXh0Tm9kZShub2RlU3RhY2spKSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHsKICAgICAgICBjaGFyQ29kZSA9IHRleHQuY2hhckNvZGVBdChpKTsKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHN0cm9uZ1JUTENoYXJzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoc3Ryb25nUlRMQ2hhcnNbal0gPT09IGNoYXJDb2RlKSB7CiAgICAgICAgICAgIHJldHVybiAicnRsIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAibHRyIjsKICB9CgogIGZ1bmN0aW9uIGNvbXB1dGVMaW5lUG9zKGN1ZSkgewogICAgaWYgKHR5cGVvZiBjdWUubGluZSA9PT0gIm51bWJlciIgJiYKICAgICAgICAoY3VlLnNuYXBUb0xpbmVzIHx8IChjdWUubGluZSA+PSAwICYmIGN1ZS5saW5lIDw9IDEwMCkpKSB7CiAgICAgIHJldHVybiBjdWUubGluZTsKICAgIH0KICAgIGlmICghY3VlLnRyYWNrIHx8ICFjdWUudHJhY2sudGV4dFRyYWNrTGlzdCB8fAogICAgICAgICFjdWUudHJhY2sudGV4dFRyYWNrTGlzdC5tZWRpYUVsZW1lbnQpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgdmFyIHRyYWNrID0gY3VlLnRyYWNrLAogICAgICAgIHRyYWNrTGlzdCA9IHRyYWNrLnRleHRUcmFja0xpc3QsCiAgICAgICAgY291bnQgPSAwOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFja0xpc3QubGVuZ3RoICYmIHRyYWNrTGlzdFtpXSAhPT0gdHJhY2s7IGkrKykgewogICAgICBpZiAodHJhY2tMaXN0W2ldLm1vZGUgPT09ICJzaG93aW5nIikgewogICAgICAgIGNvdW50Kys7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiArK2NvdW50ICogLTE7CiAgfQoKICBmdW5jdGlvbiBTdHlsZUJveCgpIHsKICB9CgogIC8vIEFwcGx5IHN0eWxlcyB0byBhIGRpdi4gSWYgdGhlcmUgaXMgbm8gZGl2IHBhc3NlZCB0aGVuIGl0IGRlZmF1bHRzIHRvIHRoZQogIC8vIGRpdiBvbiAndGhpcycuCiAgU3R5bGVCb3gucHJvdG90eXBlLmFwcGx5U3R5bGVzID0gZnVuY3Rpb24oc3R5bGVzLCBkaXYpIHsKICAgIGRpdiA9IGRpdiB8fCB0aGlzLmRpdjsKICAgIGZvciAodmFyIHByb3AgaW4gc3R5bGVzKSB7CiAgICAgIGlmIChzdHlsZXMuaGFzT3duUHJvcGVydHkocHJvcCkpIHsKICAgICAgICBkaXYuc3R5bGVbcHJvcF0gPSBzdHlsZXNbcHJvcF07CiAgICAgIH0KICAgIH0KICB9OwoKICBTdHlsZUJveC5wcm90b3R5cGUuZm9ybWF0U3R5bGUgPSBmdW5jdGlvbih2YWwsIHVuaXQpIHsKICAgIHJldHVybiB2YWwgPT09IDAgPyAwIDogdmFsICsgdW5pdDsKICB9OwoKICAvLyBDb25zdHJ1Y3RzIHRoZSBjb21wdXRlZCBkaXNwbGF5IHN0YXRlIG9mIHRoZSBjdWUgKGEgZGl2KS4gUGxhY2VzIHRoZSBkaXYKICAvLyBpbnRvIHRoZSBvdmVybGF5IHdoaWNoIHNob3VsZCBiZSBhIGJsb2NrIGxldmVsIGVsZW1lbnQgKHVzdWFsbHkgYSBkaXYpLgogIGZ1bmN0aW9uIEN1ZVN0eWxlQm94KHdpbmRvdywgY3VlLCBzdHlsZU9wdGlvbnMpIHsKICAgIHZhciBpc0lFOCA9ICgvTVNJRVxzOFwuMC8pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICB2YXIgY29sb3IgPSAicmdiYSgyNTUsIDI1NSwgMjU1LCAxKSI7CiAgICB2YXIgYmFja2dyb3VuZENvbG9yID0gInJnYmEoMCwgMCwgMCwgMC44KSI7CgogICAgaWYgKGlzSUU4KSB7CiAgICAgIGNvbG9yID0gInJnYigyNTUsIDI1NSwgMjU1KSI7CiAgICAgIGJhY2tncm91bmRDb2xvciA9ICJyZ2IoMCwgMCwgMCkiOwogICAgfQoKICAgIFN0eWxlQm94LmNhbGwodGhpcyk7CiAgICB0aGlzLmN1ZSA9IGN1ZTsKCiAgICAvLyBQYXJzZSBvdXIgY3VlJ3MgdGV4dCBpbnRvIGEgRE9NIHRyZWUgcm9vdGVkIGF0ICdjdWVEaXYnLiBUaGlzIGRpdiB3aWxsCiAgICAvLyBoYXZlIGlubGluZSBwb3NpdGlvbmluZyBhbmQgd2lsbCBmdW5jdGlvbiBhcyB0aGUgY3VlIGJhY2tncm91bmQgYm94LgogICAgdGhpcy5jdWVEaXYgPSBwYXJzZUNvbnRlbnQod2luZG93LCBjdWUudGV4dCk7CiAgICB2YXIgc3R5bGVzID0gewogICAgICBjb2xvcjogY29sb3IsCiAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZENvbG9yLAogICAgICBwb3NpdGlvbjogInJlbGF0aXZlIiwKICAgICAgbGVmdDogMCwKICAgICAgcmlnaHQ6IDAsCiAgICAgIHRvcDogMCwKICAgICAgYm90dG9tOiAwLAogICAgICBkaXNwbGF5OiAiaW5saW5lIgogICAgfTsKCiAgICBpZiAoIWlzSUU4KSB7CiAgICAgIHN0eWxlcy53cml0aW5nTW9kZSA9IGN1ZS52ZXJ0aWNhbCA9PT0gIiIgPyAiaG9yaXpvbnRhbC10YiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGN1ZS52ZXJ0aWNhbCA9PT0gImxyIiA/ICJ2ZXJ0aWNhbC1sciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICJ2ZXJ0aWNhbC1ybCI7CiAgICAgIHN0eWxlcy51bmljb2RlQmlkaSA9ICJwbGFpbnRleHQiOwogICAgfQogICAgdGhpcy5hcHBseVN0eWxlcyhzdHlsZXMsIHRoaXMuY3VlRGl2KTsKCiAgICAvLyBDcmVhdGUgYW4gYWJzb2x1dGVseSBwb3NpdGlvbmVkIGRpdiB0aGF0IHdpbGwgYmUgdXNlZCB0byBwb3NpdGlvbiB0aGUgY3VlCiAgICAvLyBkaXYuIE5vdGUsIGFsbCBXZWJWVFQgY3VlLXNldHRpbmcgYWxpZ25tZW50cyBhcmUgZXF1aXZhbGVudCB0byB0aGUgQ1NTCiAgICAvLyBtaXJyb3JzIG9mIHRoZW0gZXhjZXB0ICJtaWRkbGUiIHdoaWNoIGlzICJjZW50ZXIiIGluIENTUy4KICAgIHRoaXMuZGl2ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgc3R5bGVzID0gewogICAgICB0ZXh0QWxpZ246IGN1ZS5hbGlnbiA9PT0gIm1pZGRsZSIgPyAiY2VudGVyIiA6IGN1ZS5hbGlnbiwKICAgICAgZm9udDogc3R5bGVPcHRpb25zLmZvbnQsCiAgICAgIHdoaXRlU3BhY2U6ICJwcmUtbGluZSIsCiAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiCiAgICB9OwoKICAgIGlmICghaXNJRTgpIHsKICAgICAgc3R5bGVzLmRpcmVjdGlvbiA9IGRldGVybWluZUJpZGkodGhpcy5jdWVEaXYpOwogICAgICBzdHlsZXMud3JpdGluZ01vZGUgPSBjdWUudmVydGljYWwgPT09ICIiID8gImhvcml6b250YWwtdGIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjdWUudmVydGljYWwgPT09ICJsciIgPyAidmVydGljYWwtbHIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAidmVydGljYWwtcmwiLgogICAgICBzdHlsZXN1bmljb2RlQmlkaSA9ICAicGxhaW50ZXh0IjsKICAgIH0KCiAgICB0aGlzLmFwcGx5U3R5bGVzKHN0eWxlcyk7CgogICAgdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5jdWVEaXYpOwoKICAgIC8vIENhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgcmVmZXJlbmNlIGVkZ2Ugb2YgdGhlIHZpZXdwb3J0IHRvIHRoZSB0ZXh0CiAgICAvLyBwb3NpdGlvbiBvZiB0aGUgY3VlIGJveC4gVGhlIHJlZmVyZW5jZSBlZGdlIHdpbGwgYmUgcmVzb2x2ZWQgbGF0ZXIgd2hlbgogICAgLy8gdGhlIGJveCBvcmllbnRhdGlvbiBzdHlsZXMgYXJlIGFwcGxpZWQuCiAgICB2YXIgdGV4dFBvcyA9IDA7CiAgICBzd2l0Y2ggKGN1ZS5wb3NpdGlvbkFsaWduKSB7CiAgICBjYXNlICJzdGFydCI6CiAgICAgIHRleHRQb3MgPSBjdWUucG9zaXRpb247CiAgICAgIGJyZWFrOwogICAgY2FzZSAibWlkZGxlIjoKICAgICAgdGV4dFBvcyA9IGN1ZS5wb3NpdGlvbiAtIChjdWUuc2l6ZSAvIDIpOwogICAgICBicmVhazsKICAgIGNhc2UgImVuZCI6CiAgICAgIHRleHRQb3MgPSBjdWUucG9zaXRpb24gLSBjdWUuc2l6ZTsKICAgICAgYnJlYWs7CiAgICB9CgogICAgLy8gSG9yaXpvbnRhbCBib3ggb3JpZW50YXRpb247IHRleHRQb3MgaXMgdGhlIGRpc3RhbmNlIGZyb20gdGhlIGxlZnQgZWRnZSBvZiB0aGUKICAgIC8vIGFyZWEgdG8gdGhlIGxlZnQgZWRnZSBvZiB0aGUgYm94IGFuZCBjdWUuc2l6ZSBpcyB0aGUgZGlzdGFuY2UgZXh0ZW5kaW5nIHRvCiAgICAvLyB0aGUgcmlnaHQgZnJvbSB0aGVyZS4KICAgIGlmIChjdWUudmVydGljYWwgPT09ICIiKSB7CiAgICAgIHRoaXMuYXBwbHlTdHlsZXMoewogICAgICAgIGxlZnQ6ICB0aGlzLmZvcm1hdFN0eWxlKHRleHRQb3MsICIlIiksCiAgICAgICAgd2lkdGg6IHRoaXMuZm9ybWF0U3R5bGUoY3VlLnNpemUsICIlIikKICAgICAgfSk7CiAgICAvLyBWZXJ0aWNhbCBib3ggb3JpZW50YXRpb247IHRleHRQb3MgaXMgdGhlIGRpc3RhbmNlIGZyb20gdGhlIHRvcCBlZGdlIG9mIHRoZQogICAgLy8gYXJlYSB0byB0aGUgdG9wIGVkZ2Ugb2YgdGhlIGJveCBhbmQgY3VlLnNpemUgaXMgdGhlIGhlaWdodCBleHRlbmRpbmcKICAgIC8vIGRvd253YXJkcyBmcm9tIHRoZXJlLgogICAgfSBlbHNlIHsKICAgICAgdGhpcy5hcHBseVN0eWxlcyh7CiAgICAgICAgdG9wOiB0aGlzLmZvcm1hdFN0eWxlKHRleHRQb3MsICIlIiksCiAgICAgICAgaGVpZ2h0OiB0aGlzLmZvcm1hdFN0eWxlKGN1ZS5zaXplLCAiJSIpCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMubW92ZSA9IGZ1bmN0aW9uKGJveCkgewogICAgICB0aGlzLmFwcGx5U3R5bGVzKHsKICAgICAgICB0b3A6IHRoaXMuZm9ybWF0U3R5bGUoYm94LnRvcCwgInB4IiksCiAgICAgICAgYm90dG9tOiB0aGlzLmZvcm1hdFN0eWxlKGJveC5ib3R0b20sICJweCIpLAogICAgICAgIGxlZnQ6IHRoaXMuZm9ybWF0U3R5bGUoYm94LmxlZnQsICJweCIpLAogICAgICAgIHJpZ2h0OiB0aGlzLmZvcm1hdFN0eWxlKGJveC5yaWdodCwgInB4IiksCiAgICAgICAgaGVpZ2h0OiB0aGlzLmZvcm1hdFN0eWxlKGJveC5oZWlnaHQsICJweCIpLAogICAgICAgIHdpZHRoOiB0aGlzLmZvcm1hdFN0eWxlKGJveC53aWR0aCwgInB4IikKICAgICAgfSk7CiAgICB9OwogIH0KICBDdWVTdHlsZUJveC5wcm90b3R5cGUgPSBfb2JqQ3JlYXRlKFN0eWxlQm94LnByb3RvdHlwZSk7CiAgQ3VlU3R5bGVCb3gucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ3VlU3R5bGVCb3g7CgogIC8vIFJlcHJlc2VudHMgdGhlIGNvLW9yZGluYXRlcyBvZiBhbiBFbGVtZW50IGluIGEgd2F5IHRoYXQgd2UgY2FuIGVhc2lseQogIC8vIGNvbXB1dGUgdGhpbmdzIHdpdGggc3VjaCBhcyBpZiBpdCBvdmVybGFwcyBvciBpbnRlcnNlY3RzIHdpdGggYW5vdGhlciBFbGVtZW50LgogIC8vIENhbiBpbml0aWFsaXplIGl0IHdpdGggZWl0aGVyIGEgU3R5bGVCb3ggb3IgYW5vdGhlciBCb3hQb3NpdGlvbi4KICBmdW5jdGlvbiBCb3hQb3NpdGlvbihvYmopIHsKICAgIHZhciBpc0lFOCA9ICgvTVNJRVxzOFwuMC8pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CgogICAgLy8gRWl0aGVyIGEgQm94UG9zaXRpb24gd2FzIHBhc3NlZCBpbiBhbmQgd2UgbmVlZCB0byBjb3B5IGl0LCBvciBhIFN0eWxlQm94CiAgICAvLyB3YXMgcGFzc2VkIGluIGFuZCB3ZSBuZWVkIHRvIGNvcHkgdGhlIHJlc3VsdHMgb2YgJ2dldEJvdW5kaW5nQ2xpZW50UmVjdCcKICAgIC8vIGFzIHRoZSBvYmplY3QgcmV0dXJuZWQgaXMgcmVhZG9ubHkuIEFsbCBjby1vcmRpbmF0ZSB2YWx1ZXMgYXJlIGluIHJlZmVyZW5jZQogICAgLy8gdG8gdGhlIHZpZXdwb3J0IG9yaWdpbiAodG9wIGxlZnQpLgogICAgdmFyIGxoLCBoZWlnaHQsIHdpZHRoLCB0b3A7CiAgICBpZiAob2JqLmRpdikgewogICAgICBoZWlnaHQgPSBvYmouZGl2Lm9mZnNldEhlaWdodDsKICAgICAgd2lkdGggPSBvYmouZGl2Lm9mZnNldFdpZHRoOwogICAgICB0b3AgPSBvYmouZGl2Lm9mZnNldFRvcDsKCiAgICAgIHZhciByZWN0cyA9IChyZWN0cyA9IG9iai5kaXYuY2hpbGROb2RlcykgJiYgKHJlY3RzID0gcmVjdHNbMF0pICYmCiAgICAgICAgICAgICAgICAgIHJlY3RzLmdldENsaWVudFJlY3RzICYmIHJlY3RzLmdldENsaWVudFJlY3RzKCk7CiAgICAgIG9iaiA9IG9iai5kaXYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIC8vIEluIGNlcnRhaW4gY2FzZXMgdGhlIG91dHRlciBkaXYgd2lsbCBiZSBzbGlnaHRseSBsYXJnZXIgdGhlbiB0aGUgc3VtIG9mCiAgICAgIC8vIHRoZSBpbm5lciBkaXYncyBsaW5lcy4gVGhpcyBjb3VsZCBiZSBkdWUgdG8gYm9sZCB0ZXh0LCBldGMsIG9uIHNvbWUgcGxhdGZvcm1zLgogICAgICAvLyBJbiB0aGlzIGNhc2Ugd2Ugc2hvdWxkIGdldCB0aGUgYXZlcmFnZSBsaW5lIGhlaWdodCBhbmQgdXNlIHRoYXQuIFRoaXMgd2lsbAogICAgICAvLyByZXN1bHQgaW4gdGhlIGRlc2lyZWQgYmVoYXZpb3VyLgogICAgICBsaCA9IHJlY3RzID8gTWF0aC5tYXgoKHJlY3RzWzBdICYmIHJlY3RzWzBdLmhlaWdodCkgfHwgMCwgb2JqLmhlaWdodCAvIHJlY3RzLmxlbmd0aCkKICAgICAgICAgICAgICAgICA6IDA7CgogICAgfQogICAgdGhpcy5sZWZ0ID0gb2JqLmxlZnQ7CiAgICB0aGlzLnJpZ2h0ID0gb2JqLnJpZ2h0OwogICAgdGhpcy50b3AgPSBvYmoudG9wIHx8IHRvcDsKICAgIHRoaXMuaGVpZ2h0ID0gb2JqLmhlaWdodCB8fCBoZWlnaHQ7CiAgICB0aGlzLmJvdHRvbSA9IG9iai5ib3R0b20gfHwgKHRvcCArIChvYmouaGVpZ2h0IHx8IGhlaWdodCkpOwogICAgdGhpcy53aWR0aCA9IG9iai53aWR0aCB8fCB3aWR0aDsKICAgIHRoaXMubGluZUhlaWdodCA9IGxoICE9PSB1bmRlZmluZWQgPyBsaCA6IG9iai5saW5lSGVpZ2h0OwoKICAgIGlmIChpc0lFOCAmJiAhdGhpcy5saW5lSGVpZ2h0KSB7CiAgICAgIHRoaXMubGluZUhlaWdodCA9IDEzOwogICAgfQogIH0KCiAgLy8gTW92ZSB0aGUgYm94IGFsb25nIGEgcGFydGljdWxhciBheGlzLiBPcHRpb25hbGx5IHBhc3MgaW4gYW4gYW1vdW50IHRvIG1vdmUKICAvLyB0aGUgYm94LiBJZiBubyBhbW91bnQgaXMgcGFzc2VkIHRoZW4gdGhlIGRlZmF1bHQgaXMgdGhlIGxpbmUgaGVpZ2h0IG9mIHRoZQogIC8vIGJveC4KICBCb3hQb3NpdGlvbi5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKGF4aXMsIHRvTW92ZSkgewogICAgdG9Nb3ZlID0gdG9Nb3ZlICE9PSB1bmRlZmluZWQgPyB0b01vdmUgOiB0aGlzLmxpbmVIZWlnaHQ7CiAgICBzd2l0Y2ggKGF4aXMpIHsKICAgIGNhc2UgIit4IjoKICAgICAgdGhpcy5sZWZ0ICs9IHRvTW92ZTsKICAgICAgdGhpcy5yaWdodCArPSB0b01vdmU7CiAgICAgIGJyZWFrOwogICAgY2FzZSAiLXgiOgogICAgICB0aGlzLmxlZnQgLT0gdG9Nb3ZlOwogICAgICB0aGlzLnJpZ2h0IC09IHRvTW92ZTsKICAgICAgYnJlYWs7CiAgICBjYXNlICIreSI6CiAgICAgIHRoaXMudG9wICs9IHRvTW92ZTsKICAgICAgdGhpcy5ib3R0b20gKz0gdG9Nb3ZlOwogICAgICBicmVhazsKICAgIGNhc2UgIi15IjoKICAgICAgdGhpcy50b3AgLT0gdG9Nb3ZlOwogICAgICB0aGlzLmJvdHRvbSAtPSB0b01vdmU7CiAgICAgIGJyZWFrOwogICAgfQogIH07CgogIC8vIENoZWNrIGlmIHRoaXMgYm94IG92ZXJsYXBzIGFub3RoZXIgYm94LCBiMi4KICBCb3hQb3NpdGlvbi5wcm90b3R5cGUub3ZlcmxhcHMgPSBmdW5jdGlvbihiMikgewogICAgcmV0dXJuIHRoaXMubGVmdCA8IGIyLnJpZ2h0ICYmCiAgICAgICAgICAgdGhpcy5yaWdodCA+IGIyLmxlZnQgJiYKICAgICAgICAgICB0aGlzLnRvcCA8IGIyLmJvdHRvbSAmJgogICAgICAgICAgIHRoaXMuYm90dG9tID4gYjIudG9wOwogIH07CgogIC8vIENoZWNrIGlmIHRoaXMgYm94IG92ZXJsYXBzIGFueSBvdGhlciBib3hlcyBpbiBib3hlcy4KICBCb3hQb3NpdGlvbi5wcm90b3R5cGUub3ZlcmxhcHNBbnkgPSBmdW5jdGlvbihib3hlcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib3hlcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAodGhpcy5vdmVybGFwcyhib3hlc1tpXSkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGZhbHNlOwogIH07CgogIC8vIENoZWNrIGlmIHRoaXMgYm94IGlzIHdpdGhpbiBhbm90aGVyIGJveC4KICBCb3hQb3NpdGlvbi5wcm90b3R5cGUud2l0aGluID0gZnVuY3Rpb24oY29udGFpbmVyKSB7CiAgICByZXR1cm4gdGhpcy50b3AgPj0gY29udGFpbmVyLnRvcCAmJgogICAgICAgICAgIHRoaXMuYm90dG9tIDw9IGNvbnRhaW5lci5ib3R0b20gJiYKICAgICAgICAgICB0aGlzLmxlZnQgPj0gY29udGFpbmVyLmxlZnQgJiYKICAgICAgICAgICB0aGlzLnJpZ2h0IDw9IGNvbnRhaW5lci5yaWdodDsKICB9OwoKICAvLyBDaGVjayBpZiB0aGlzIGJveCBpcyBlbnRpcmVseSB3aXRoaW4gdGhlIGNvbnRhaW5lciBvciBpdCBpcyBvdmVybGFwcGluZwogIC8vIG9uIHRoZSBlZGdlIG9wcG9zaXRlIG9mIHRoZSBheGlzIGRpcmVjdGlvbiBwYXNzZWQuIEZvciBleGFtcGxlLCBpZiAiK3giIGlzCiAgLy8gcGFzc2VkIGFuZCB0aGUgYm94IGlzIG92ZXJsYXBwaW5nIG9uIHRoZSBsZWZ0IGVkZ2Ugb2YgdGhlIGNvbnRhaW5lciwgdGhlbgogIC8vIHJldHVybiB0cnVlLgogIEJveFBvc2l0aW9uLnByb3RvdHlwZS5vdmVybGFwc09wcG9zaXRlQXhpcyA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgYXhpcykgewogICAgc3dpdGNoIChheGlzKSB7CiAgICBjYXNlICIreCI6CiAgICAgIHJldHVybiB0aGlzLmxlZnQgPCBjb250YWluZXIubGVmdDsKICAgIGNhc2UgIi14IjoKICAgICAgcmV0dXJuIHRoaXMucmlnaHQgPiBjb250YWluZXIucmlnaHQ7CiAgICBjYXNlICIreSI6CiAgICAgIHJldHVybiB0aGlzLnRvcCA8IGNvbnRhaW5lci50b3A7CiAgICBjYXNlICIteSI6CiAgICAgIHJldHVybiB0aGlzLmJvdHRvbSA+IGNvbnRhaW5lci5ib3R0b207CiAgICB9CiAgfTsKCiAgLy8gRmluZCB0aGUgcGVyY2VudGFnZSBvZiB0aGUgYXJlYSB0aGF0IHRoaXMgYm94IGlzIG92ZXJsYXBwaW5nIHdpdGggYW5vdGhlcgogIC8vIGJveC4KICBCb3hQb3NpdGlvbi5wcm90b3R5cGUuaW50ZXJzZWN0UGVyY2VudGFnZSA9IGZ1bmN0aW9uKGIyKSB7CiAgICB2YXIgeCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMucmlnaHQsIGIyLnJpZ2h0KSAtIE1hdGgubWF4KHRoaXMubGVmdCwgYjIubGVmdCkpLAogICAgICAgIHkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih0aGlzLmJvdHRvbSwgYjIuYm90dG9tKSAtIE1hdGgubWF4KHRoaXMudG9wLCBiMi50b3ApKSwKICAgICAgICBpbnRlcnNlY3RBcmVhID0geCAqIHk7CiAgICByZXR1cm4gaW50ZXJzZWN0QXJlYSAvICh0aGlzLmhlaWdodCAqIHRoaXMud2lkdGgpOwogIH07CgogIC8vIENvbnZlcnQgdGhlIHBvc2l0aW9ucyBmcm9tIHRoaXMgYm94IHRvIENTUyBjb21wYXRpYmxlIHBvc2l0aW9ucyB1c2luZwogIC8vIHRoZSByZWZlcmVuY2UgY29udGFpbmVyJ3MgcG9zaXRpb25zLiBUaGlzIGhhcyB0byBiZSBkb25lIGJlY2F1c2UgdGhpcwogIC8vIGJveCdzIHBvc2l0aW9ucyBhcmUgaW4gcmVmZXJlbmNlIHRvIHRoZSB2aWV3cG9ydCBvcmlnaW4sIHdoZXJlYXMsIENTUwogIC8vIHZhbHVlcyBhcmUgaW4gcmVmZXJlY25lIHRvIHRoZWlyIHJlc3BlY3RpdmUgZWRnZXMuCiAgQm94UG9zaXRpb24ucHJvdG90eXBlLnRvQ1NTQ29tcGF0VmFsdWVzID0gZnVuY3Rpb24ocmVmZXJlbmNlKSB7CiAgICByZXR1cm4gewogICAgICB0b3A6IHRoaXMudG9wIC0gcmVmZXJlbmNlLnRvcCwKICAgICAgYm90dG9tOiByZWZlcmVuY2UuYm90dG9tIC0gdGhpcy5ib3R0b20sCiAgICAgIGxlZnQ6IHRoaXMubGVmdCAtIHJlZmVyZW5jZS5sZWZ0LAogICAgICByaWdodDogcmVmZXJlbmNlLnJpZ2h0IC0gdGhpcy5yaWdodCwKICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCwKICAgICAgd2lkdGg6IHRoaXMud2lkdGgKICAgIH07CiAgfTsKCiAgLy8gR2V0IGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgdGhlIGJveCdzIHBvc2l0aW9uIHdpdGhvdXQgYW55dGhpbmcgZXh0cmEuCiAgLy8gQ2FuIHBhc3MgYSBTdHlsZUJveCwgSFRNTEVsZW1lbnQsIG9yIGFub3RoZXIgQm94UG9zaXRvbi4KICBCb3hQb3NpdGlvbi5nZXRTaW1wbGVCb3hQb3NpdGlvbiA9IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIGhlaWdodCA9IG9iai5kaXYgPyBvYmouZGl2Lm9mZnNldEhlaWdodCA6IG9iai50YWdOYW1lID8gb2JqLm9mZnNldEhlaWdodCA6IDA7CiAgICB2YXIgd2lkdGggPSBvYmouZGl2ID8gb2JqLmRpdi5vZmZzZXRXaWR0aCA6IG9iai50YWdOYW1lID8gb2JqLm9mZnNldFdpZHRoIDogMDsKICAgIHZhciB0b3AgPSBvYmouZGl2ID8gb2JqLmRpdi5vZmZzZXRUb3AgOiBvYmoudGFnTmFtZSA/IG9iai5vZmZzZXRUb3AgOiAwOwoKICAgIG9iaiA9IG9iai5kaXYgPyBvYmouZGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDoKICAgICAgICAgICAgICAgICAgb2JqLnRhZ05hbWUgPyBvYmouZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBvYmo7CiAgICB2YXIgcmV0ID0gewogICAgICBsZWZ0OiBvYmoubGVmdCwKICAgICAgcmlnaHQ6IG9iai5yaWdodCwKICAgICAgdG9wOiBvYmoudG9wIHx8IHRvcCwKICAgICAgaGVpZ2h0OiBvYmouaGVpZ2h0IHx8IGhlaWdodCwKICAgICAgYm90dG9tOiBvYmouYm90dG9tIHx8ICh0b3AgKyAob2JqLmhlaWdodCB8fCBoZWlnaHQpKSwKICAgICAgd2lkdGg6IG9iai53aWR0aCB8fCB3aWR0aAogICAgfTsKICAgIHJldHVybiByZXQ7CiAgfTsKCiAgLy8gTW92ZSBhIFN0eWxlQm94IHRvIGl0cyBzcGVjaWZpZWQsIG9yIG5leHQgYmVzdCwgcG9zaXRpb24uIFRoZSBjb250YWluZXJCb3gKICAvLyBpcyB0aGUgYm94IHRoYXQgY29udGFpbnMgdGhlIFN0eWxlQm94LCBzdWNoIGFzIGEgZGl2LiBib3hQb3NpdGlvbnMgYXJlCiAgLy8gYSBsaXN0IG9mIG90aGVyIGJveGVzIHRoYXQgdGhlIHN0eWxlQm94IGNhbid0IG92ZXJsYXAgd2l0aC4KICBmdW5jdGlvbiBtb3ZlQm94VG9MaW5lUG9zaXRpb24od2luZG93LCBzdHlsZUJveCwgY29udGFpbmVyQm94LCBib3hQb3NpdGlvbnMpIHsKCiAgICAvLyBGaW5kIHRoZSBiZXN0IHBvc2l0aW9uIGZvciBhIGN1ZSBib3gsIGIsIG9uIHRoZSB2aWRlby4gVGhlIGF4aXMgcGFyYW1ldGVyCiAgICAvLyBpcyBhIGxpc3Qgb2YgYXhpcywgdGhlIG9yZGVyIG9mIHdoaWNoLCBpdCB3aWxsIG1vdmUgdGhlIGJveCBhbG9uZy4gRm9yIGV4YW1wbGU6CiAgICAvLyBQYXNzaW5nIFsiK3giLCAiLXgiXSB3aWxsIG1vdmUgdGhlIGJveCBmaXJzdCBhbG9uZyB0aGUgeCBheGlzIGluIHRoZSBwb3NpdGl2ZQogICAgLy8gZGlyZWN0aW9uLiBJZiBpdCBkb2Vzbid0IGZpbmQgYSBnb29kIHBvc2l0aW9uIGZvciBpdCB0aGVyZSBpdCB3aWxsIHRoZW4gbW92ZQogICAgLy8gaXQgYWxvbmcgdGhlIHggYXhpcyBpbiB0aGUgbmVnYXRpdmUgZGlyZWN0aW9uLgogICAgZnVuY3Rpb24gZmluZEJlc3RQb3NpdGlvbihiLCBheGlzKSB7CiAgICAgIHZhciBiZXN0UG9zaXRpb24sCiAgICAgICAgICBzcGVjaWZpZWRQb3NpdGlvbiA9IG5ldyBCb3hQb3NpdGlvbihiKSwKICAgICAgICAgIHBlcmNlbnRhZ2UgPSAxOyAvLyBIaWdoZXN0IHBvc3NpYmxlIHNvIHRoZSBmaXJzdCB0aGluZyB3ZSBnZXQgaXMgYmV0dGVyLgoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBheGlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgd2hpbGUgKGIub3ZlcmxhcHNPcHBvc2l0ZUF4aXMoY29udGFpbmVyQm94LCBheGlzW2ldKSB8fAogICAgICAgICAgICAgICAoYi53aXRoaW4oY29udGFpbmVyQm94KSAmJiBiLm92ZXJsYXBzQW55KGJveFBvc2l0aW9ucykpKSB7CiAgICAgICAgICBiLm1vdmUoYXhpc1tpXSk7CiAgICAgICAgfQogICAgICAgIC8vIFdlIGZvdW5kIGEgc3BvdCB3aGVyZSB3ZSBhcmVuJ3Qgb3ZlcmxhcHBpbmcgYW55dGhpbmcuIFRoaXMgaXMgb3VyCiAgICAgICAgLy8gYmVzdCBwb3NpdGlvbi4KICAgICAgICBpZiAoYi53aXRoaW4oY29udGFpbmVyQm94KSkgewogICAgICAgICAgcmV0dXJuIGI7CiAgICAgICAgfQogICAgICAgIHZhciBwID0gYi5pbnRlcnNlY3RQZXJjZW50YWdlKGNvbnRhaW5lckJveCk7CiAgICAgICAgLy8gSWYgd2UncmUgb3V0c2lkZSB0aGUgY29udGFpbmVyIGJveCBsZXNzIHRoZW4gd2Ugd2VyZSBvbiBvdXIgbGFzdCB0cnkKICAgICAgICAvLyB0aGVuIHJlbWVtYmVyIHRoaXMgcG9zaXRpb24gYXMgdGhlIGJlc3QgcG9zaXRpb24uCiAgICAgICAgaWYgKHBlcmNlbnRhZ2UgPiBwKSB7CiAgICAgICAgICBiZXN0UG9zaXRpb24gPSBuZXcgQm94UG9zaXRpb24oYik7CiAgICAgICAgICBwZXJjZW50YWdlID0gcDsKICAgICAgICB9CiAgICAgICAgLy8gUmVzZXQgdGhlIGJveCBwb3NpdGlvbiB0byB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uLgogICAgICAgIGIgPSBuZXcgQm94UG9zaXRpb24oc3BlY2lmaWVkUG9zaXRpb24pOwogICAgICB9CiAgICAgIHJldHVybiBiZXN0UG9zaXRpb24gfHwgc3BlY2lmaWVkUG9zaXRpb247CiAgICB9CgogICAgdmFyIGJveFBvc2l0aW9uID0gbmV3IEJveFBvc2l0aW9uKHN0eWxlQm94KSwKICAgICAgICBjdWUgPSBzdHlsZUJveC5jdWUsCiAgICAgICAgbGluZVBvcyA9IGNvbXB1dGVMaW5lUG9zKGN1ZSksCiAgICAgICAgYXhpcyA9IFtdOwoKICAgIC8vIElmIHdlIGhhdmUgYSBsaW5lIG51bWJlciB0byBhbGlnbiB0aGUgY3VlIHRvLgogICAgaWYgKGN1ZS5zbmFwVG9MaW5lcykgewogICAgICB2YXIgc2l6ZTsKICAgICAgc3dpdGNoIChjdWUudmVydGljYWwpIHsKICAgICAgY2FzZSAiIjoKICAgICAgICBheGlzID0gWyAiK3kiLCAiLXkiIF07CiAgICAgICAgc2l6ZSA9ICJoZWlnaHQiOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJybCI6CiAgICAgICAgYXhpcyA9IFsgIit4IiwgIi14IiBdOwogICAgICAgIHNpemUgPSAid2lkdGgiOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJsciI6CiAgICAgICAgYXhpcyA9IFsgIi14IiwgIit4IiBdOwogICAgICAgIHNpemUgPSAid2lkdGgiOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICB2YXIgc3RlcCA9IGJveFBvc2l0aW9uLmxpbmVIZWlnaHQsCiAgICAgICAgICBwb3NpdGlvbiA9IHN0ZXAgKiBNYXRoLnJvdW5kKGxpbmVQb3MpLAogICAgICAgICAgbWF4UG9zaXRpb24gPSBjb250YWluZXJCb3hbc2l6ZV0gKyBzdGVwLAogICAgICAgICAgaW5pdGlhbEF4aXMgPSBheGlzWzBdOwoKICAgICAgLy8gSWYgdGhlIHNwZWNpZmllZCBpbnRpYWwgcG9zaXRpb24gaXMgZ3JlYXRlciB0aGVuIHRoZSBtYXggcG9zaXRpb24gdGhlbgogICAgICAvLyBjbGFtcCB0aGUgYm94IHRvIHRoZSBhbW91bnQgb2Ygc3RlcHMgaXQgd291bGQgdGFrZSBmb3IgdGhlIGJveCB0bwogICAgICAvLyByZWFjaCB0aGUgbWF4IHBvc2l0aW9uLgogICAgICBpZiAoTWF0aC5hYnMocG9zaXRpb24pID4gbWF4UG9zaXRpb24pIHsKICAgICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIDwgMCA/IC0xIDogMTsKICAgICAgICBwb3NpdGlvbiAqPSBNYXRoLmNlaWwobWF4UG9zaXRpb24gLyBzdGVwKSAqIHN0ZXA7CiAgICAgIH0KCiAgICAgIC8vIElmIGNvbXB1dGVkIGxpbmUgcG9zaXRpb24gcmV0dXJucyBuZWdhdGl2ZSB0aGVuIGxpbmUgbnVtYmVycyBhcmUKICAgICAgLy8gcmVsYXRpdmUgdG8gdGhlIGJvdHRvbSBvZiB0aGUgdmlkZW8gaW5zdGVhZCBvZiB0aGUgdG9wLiBUaGVyZWZvcmUsIHdlCiAgICAgIC8vIG5lZWQgdG8gaW5jcmVhc2Ugb3VyIGluaXRpYWwgcG9zaXRpb24gYnkgdGhlIGxlbmd0aCBvciB3aWR0aCBvZiB0aGUKICAgICAgLy8gdmlkZW8sIGRlcGVuZGluZyBvbiB0aGUgd3JpdGluZyBkaXJlY3Rpb24sIGFuZCByZXZlcnNlIG91ciBheGlzIGRpcmVjdGlvbnMuCiAgICAgIGlmIChsaW5lUG9zIDwgMCkgewogICAgICAgIHBvc2l0aW9uICs9IGN1ZS52ZXJ0aWNhbCA9PT0gIiIgPyBjb250YWluZXJCb3guaGVpZ2h0IDogY29udGFpbmVyQm94LndpZHRoOwogICAgICAgIGF4aXMgPSBheGlzLnJldmVyc2UoKTsKICAgICAgfQoKICAgICAgLy8gTW92ZSB0aGUgYm94IHRvIHRoZSBzcGVjaWZpZWQgcG9zaXRpb24uIFRoaXMgbWF5IG5vdCBiZSBpdHMgYmVzdAogICAgICAvLyBwb3NpdGlvbi4KICAgICAgYm94UG9zaXRpb24ubW92ZShpbml0aWFsQXhpcywgcG9zaXRpb24pOwoKICAgIH0gZWxzZSB7CiAgICAgIC8vIElmIHdlIGhhdmUgYSBwZXJjZW50YWdlIGxpbmUgdmFsdWUgZm9yIHRoZSBjdWUuCiAgICAgIHZhciBjYWxjdWxhdGVkUGVyY2VudGFnZSA9IChib3hQb3NpdGlvbi5saW5lSGVpZ2h0IC8gY29udGFpbmVyQm94LmhlaWdodCkgKiAxMDA7CgogICAgICBzd2l0Y2ggKGN1ZS5saW5lQWxpZ24pIHsKICAgICAgY2FzZSAibWlkZGxlIjoKICAgICAgICBsaW5lUG9zIC09IChjYWxjdWxhdGVkUGVyY2VudGFnZSAvIDIpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJlbmQiOgogICAgICAgIGxpbmVQb3MgLT0gY2FsY3VsYXRlZFBlcmNlbnRhZ2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIC8vIEFwcGx5IGluaXRpYWwgbGluZSBwb3NpdGlvbiB0byB0aGUgY3VlIGJveC4KICAgICAgc3dpdGNoIChjdWUudmVydGljYWwpIHsKICAgICAgY2FzZSAiIjoKICAgICAgICBzdHlsZUJveC5hcHBseVN0eWxlcyh7CiAgICAgICAgICB0b3A6IHN0eWxlQm94LmZvcm1hdFN0eWxlKGxpbmVQb3MsICIlIikKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAicmwiOgogICAgICAgIHN0eWxlQm94LmFwcGx5U3R5bGVzKHsKICAgICAgICAgIGxlZnQ6IHN0eWxlQm94LmZvcm1hdFN0eWxlKGxpbmVQb3MsICIlIikKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAibHIiOgogICAgICAgIHN0eWxlQm94LmFwcGx5U3R5bGVzKHsKICAgICAgICAgIHJpZ2h0OiBzdHlsZUJveC5mb3JtYXRTdHlsZShsaW5lUG9zLCAiJSIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGF4aXMgPSBbICIreSIsICIteCIsICIreCIsICIteSIgXTsKCiAgICAgIC8vIEdldCB0aGUgYm94IHBvc2l0aW9uIGFnYWluIGFmdGVyIHdlJ3ZlIGFwcGxpZWQgdGhlIHNwZWNpZmllZCBwb3NpdGlvbmluZwogICAgICAvLyB0byBpdC4KICAgICAgYm94UG9zaXRpb24gPSBuZXcgQm94UG9zaXRpb24oc3R5bGVCb3gpOwogICAgfQoKICAgIHZhciBiZXN0UG9zaXRpb24gPSBmaW5kQmVzdFBvc2l0aW9uKGJveFBvc2l0aW9uLCBheGlzKTsKICAgIHN0eWxlQm94Lm1vdmUoYmVzdFBvc2l0aW9uLnRvQ1NTQ29tcGF0VmFsdWVzKGNvbnRhaW5lckJveCkpOwogIH0KCiAgZnVuY3Rpb24gV2ViVlRUKCkgewogICAgLy8gTm90aGluZwogIH0KCiAgLy8gSGVscGVyIHRvIGFsbG93IHN0cmluZ3MgdG8gYmUgZGVjb2RlZCBpbnN0ZWFkIG9mIHRoZSBkZWZhdWx0IGJpbmFyeSB1dGY4IGRhdGEuCiAgV2ViVlRULlN0cmluZ0RlY29kZXIgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGRlY29kZTogZnVuY3Rpb24oZGF0YSkgewogICAgICAgIGlmICghZGF0YSkgewogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJzdHJpbmciKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVycm9yIC0gZXhwZWN0ZWQgc3RyaW5nIGRhdGEuIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZW5jb2RlVVJJQ29tcG9uZW50KGRhdGEpKTsKICAgICAgfQogICAgfTsKICB9OwoKICBXZWJWVFQuY29udmVydEN1ZVRvRE9NVHJlZSA9IGZ1bmN0aW9uKHdpbmRvdywgY3VldGV4dCkgewogICAgaWYgKCF3aW5kb3cgfHwgIWN1ZXRleHQpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICByZXR1cm4gcGFyc2VDb250ZW50KHdpbmRvdywgY3VldGV4dCk7CiAgfTsKCiAgdmFyIEZPTlRfU0laRV9QRVJDRU5UID0gMC4wNTsKICB2YXIgRk9OVF9TVFlMRSA9ICJzYW5zLXNlcmlmIjsKICB2YXIgQ1VFX0JBQ0tHUk9VTkRfUEFERElORyA9ICIxLjUlIjsKCiAgLy8gUnVucyB0aGUgcHJvY2Vzc2luZyBtb2RlbCBvdmVyIHRoZSBjdWVzIGFuZCByZWdpb25zIHBhc3NlZCB0byBpdC4KICAvLyBAcGFyYW0gb3ZlcmxheSBBIGJsb2NrIGxldmVsIGVsZW1lbnQgKHVzdWFsbHkgYSBkaXYpIHRoYXQgdGhlIGNvbXB1dGVkIGN1ZXMKICAvLyAgICAgICAgICAgICAgICBhbmQgcmVnaW9ucyB3aWxsIGJlIHBsYWNlZCBpbnRvLgogIFdlYlZUVC5wcm9jZXNzQ3VlcyA9IGZ1bmN0aW9uKHdpbmRvdywgY3Vlcywgb3ZlcmxheSkgewogICAgaWYgKCF3aW5kb3cgfHwgIWN1ZXMgfHwgIW92ZXJsYXkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLy8gUmVtb3ZlIGFsbCBwcmV2aW91cyBjaGlsZHJlbi4KICAgIHdoaWxlIChvdmVybGF5LmZpcnN0Q2hpbGQpIHsKICAgICAgb3ZlcmxheS5yZW1vdmVDaGlsZChvdmVybGF5LmZpcnN0Q2hpbGQpOwogICAgfQoKICAgIHZhciBwYWRkZWRPdmVybGF5ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgcGFkZGVkT3ZlcmxheS5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICBwYWRkZWRPdmVybGF5LnN0eWxlLmxlZnQgPSAiMCI7CiAgICBwYWRkZWRPdmVybGF5LnN0eWxlLnJpZ2h0ID0gIjAiOwogICAgcGFkZGVkT3ZlcmxheS5zdHlsZS50b3AgPSAiMCI7CiAgICBwYWRkZWRPdmVybGF5LnN0eWxlLmJvdHRvbSA9ICIwIjsKICAgIHBhZGRlZE92ZXJsYXkuc3R5bGUubWFyZ2luID0gQ1VFX0JBQ0tHUk9VTkRfUEFERElORzsKICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQocGFkZGVkT3ZlcmxheSk7CgogICAgLy8gRGV0ZXJtaW5lIGlmIHdlIG5lZWQgdG8gY29tcHV0ZSB0aGUgZGlzcGxheSBzdGF0ZXMgb2YgdGhlIGN1ZXMuIFRoaXMgY291bGQKICAgIC8vIGJlIHRoZSBjYXNlIGlmIGEgY3VlJ3Mgc3RhdGUgaGFzIGJlZW4gY2hhbmdlZCBzaW5jZSB0aGUgbGFzdCBjb21wdXRhdGlvbiBvcgogICAgLy8gaWYgaXQgaGFzIG5vdCBiZWVuIGNvbXB1dGVkIHlldC4KICAgIGZ1bmN0aW9uIHNob3VsZENvbXB1dGUoY3VlcykgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoY3Vlc1tpXS5oYXNCZWVuUmVzZXQgfHwgIWN1ZXNbaV0uZGlzcGxheVN0YXRlKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gcmVjb21wdXRlIHRoZSBjdWVzJyBkaXNwbGF5IHN0YXRlcy4gSnVzdCByZXVzZSB0aGVtLgogICAgaWYgKCFzaG91bGRDb21wdXRlKGN1ZXMpKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3Vlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHBhZGRlZE92ZXJsYXkuYXBwZW5kQ2hpbGQoY3Vlc1tpXS5kaXNwbGF5U3RhdGUpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYm94UG9zaXRpb25zID0gW10sCiAgICAgICAgY29udGFpbmVyQm94ID0gQm94UG9zaXRpb24uZ2V0U2ltcGxlQm94UG9zaXRpb24ocGFkZGVkT3ZlcmxheSksCiAgICAgICAgZm9udFNpemUgPSBNYXRoLnJvdW5kKGNvbnRhaW5lckJveC5oZWlnaHQgKiBGT05UX1NJWkVfUEVSQ0VOVCAqIDEwMCkgLyAxMDA7CiAgICB2YXIgc3R5bGVPcHRpb25zID0gewogICAgICBmb250OiBmb250U2l6ZSArICJweCAiICsgRk9OVF9TVFlMRQogICAgfTsKCiAgICAoZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzdHlsZUJveCwgY3VlOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY3VlID0gY3Vlc1tpXTsKCiAgICAgICAgLy8gQ29tcHV0ZSB0aGUgaW50aWFsIHBvc2l0aW9uIGFuZCBzdHlsZXMgb2YgdGhlIGN1ZSBkaXYuCiAgICAgICAgc3R5bGVCb3ggPSBuZXcgQ3VlU3R5bGVCb3god2luZG93LCBjdWUsIHN0eWxlT3B0aW9ucyk7CiAgICAgICAgcGFkZGVkT3ZlcmxheS5hcHBlbmRDaGlsZChzdHlsZUJveC5kaXYpOwoKICAgICAgICAvLyBNb3ZlIHRoZSBjdWUgZGl2IHRvIGl0J3MgY29ycmVjdCBsaW5lIHBvc2l0aW9uLgogICAgICAgIG1vdmVCb3hUb0xpbmVQb3NpdGlvbih3aW5kb3csIHN0eWxlQm94LCBjb250YWluZXJCb3gsIGJveFBvc2l0aW9ucyk7CgogICAgICAgIC8vIFJlbWVtYmVyIHRoZSBjb21wdXRlZCBkaXYgc28gdGhhdCB3ZSBkb24ndCBoYXZlIHRvIHJlY29tcHV0ZSBpdCBsYXRlcgogICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgdG9vLgogICAgICAgIGN1ZS5kaXNwbGF5U3RhdGUgPSBzdHlsZUJveC5kaXY7CgogICAgICAgIGJveFBvc2l0aW9ucy5wdXNoKEJveFBvc2l0aW9uLmdldFNpbXBsZUJveFBvc2l0aW9uKHN0eWxlQm94KSk7CiAgICAgIH0KICAgIH0pKCk7CiAgfTsKCiAgV2ViVlRULlBhcnNlciA9IGZ1bmN0aW9uKHdpbmRvdywgdnR0anMsIGRlY29kZXIpIHsKICAgIGlmICghZGVjb2RlcikgewogICAgICBkZWNvZGVyID0gdnR0anM7CiAgICAgIHZ0dGpzID0ge307CiAgICB9CiAgICBpZiAoIXZ0dGpzKSB7CiAgICAgIHZ0dGpzID0ge307CiAgICB9CgogICAgdGhpcy53aW5kb3cgPSB3aW5kb3c7CiAgICB0aGlzLnZ0dGpzID0gdnR0anM7CiAgICB0aGlzLnN0YXRlID0gIklOSVRJQUwiOwogICAgdGhpcy5idWZmZXIgPSAiIjsKICAgIHRoaXMuZGVjb2RlciA9IGRlY29kZXIgfHwgbmV3IFRleHREZWNvZGVyKCJ1dGY4Iik7CiAgICB0aGlzLnJlZ2lvbkxpc3QgPSBbXTsKICB9OwoKICBXZWJWVFQuUGFyc2VyLnByb3RvdHlwZSA9IHsKICAgIC8vIElmIHRoZSBlcnJvciBpcyBhIFBhcnNpbmdFcnJvciB0aGVuIHJlcG9ydCBpdCB0byB0aGUgY29uc3VtZXIgaWYKICAgIC8vIHBvc3NpYmxlLiBJZiBpdCdzIG5vdCBhIFBhcnNpbmdFcnJvciB0aGVuIHRocm93IGl0IGxpa2Ugbm9ybWFsLgogICAgcmVwb3J0T3JUaHJvd0Vycm9yOiBmdW5jdGlvbihlKSB7CiAgICAgIGlmIChlIGluc3RhbmNlb2YgUGFyc2luZ0Vycm9yKSB7CiAgICAgICAgdGhpcy5vbnBhcnNpbmdlcnJvciAmJiB0aGlzLm9ucGFyc2luZ2Vycm9yKGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IGU7CiAgICAgIH0KICAgIH0sCiAgICBwYXJzZTogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gZGF0YSB0aGVuIHdlIHdvbid0IGRlY29kZSBpdCwgYnV0IHdpbGwganVzdCB0cnkgdG8gcGFyc2UKICAgICAgLy8gd2hhdGV2ZXIgaXMgaW4gYnVmZmVyIGFscmVhZHkuIFRoaXMgbWF5IG9jY3VyIGluIGNpcmN1bXN0YW5jZXMsIGZvcgogICAgICAvLyBleGFtcGxlIHdoZW4gZmx1c2goKSBpcyBjYWxsZWQuCiAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgLy8gVHJ5IHRvIGRlY29kZSB0aGUgZGF0YSB0aGF0IHdlIHJlY2VpdmVkLgogICAgICAgIHNlbGYuYnVmZmVyICs9IHNlbGYuZGVjb2Rlci5kZWNvZGUoZGF0YSwge3N0cmVhbTogdHJ1ZX0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjb2xsZWN0TmV4dExpbmUoKSB7CiAgICAgICAgdmFyIGJ1ZmZlciA9IHNlbGYuYnVmZmVyOwogICAgICAgIHZhciBwb3MgPSAwOwogICAgICAgIHdoaWxlIChwb3MgPCBidWZmZXIubGVuZ3RoICYmIGJ1ZmZlcltwb3NdICE9PSAnXHInICYmIGJ1ZmZlcltwb3NdICE9PSAnXG4nKSB7CiAgICAgICAgICArK3BvczsKICAgICAgICB9CiAgICAgICAgdmFyIGxpbmUgPSBidWZmZXIuc3Vic3RyKDAsIHBvcyk7CiAgICAgICAgLy8gQWR2YW5jZSB0aGUgYnVmZmVyIGVhcmx5IGluIGNhc2Ugd2UgZmFpbCBiZWxvdy4KICAgICAgICBpZiAoYnVmZmVyW3Bvc10gPT09ICdccicpIHsKICAgICAgICAgICsrcG9zOwogICAgICAgIH0KICAgICAgICBpZiAoYnVmZmVyW3Bvc10gPT09ICdcbicpIHsKICAgICAgICAgICsrcG9zOwogICAgICAgIH0KICAgICAgICBzZWxmLmJ1ZmZlciA9IGJ1ZmZlci5zdWJzdHIocG9zKTsKICAgICAgICByZXR1cm4gbGluZTsKICAgICAgfQoKICAgICAgLy8gMy40IFdlYlZUVCByZWdpb24gYW5kIFdlYlZUVCByZWdpb24gc2V0dGluZ3Mgc3ludGF4CiAgICAgIGZ1bmN0aW9uIHBhcnNlUmVnaW9uKGlucHV0KSB7CiAgICAgICAgdmFyIHNldHRpbmdzID0gbmV3IFNldHRpbmdzKCk7CgogICAgICAgIHBhcnNlT3B0aW9ucyhpbnB1dCwgZnVuY3Rpb24gKGssIHYpIHsKICAgICAgICAgIHN3aXRjaCAoaykgewogICAgICAgICAgY2FzZSAiaWQiOgogICAgICAgICAgICBzZXR0aW5ncy5zZXQoaywgdik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAid2lkdGgiOgogICAgICAgICAgICBzZXR0aW5ncy5wZXJjZW50KGssIHYpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImxpbmVzIjoKICAgICAgICAgICAgc2V0dGluZ3MuaW50ZWdlcihrLCB2KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJyZWdpb25hbmNob3IiOgogICAgICAgICAgY2FzZSAidmlld3BvcnRhbmNob3IiOgogICAgICAgICAgICB2YXIgeHkgPSB2LnNwbGl0KCcsJyk7CiAgICAgICAgICAgIGlmICh4eS5sZW5ndGggIT09IDIpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBXZSBoYXZlIHRvIG1ha2Ugc3VyZSBib3RoIHggYW5kIHkgcGFyc2UsIHNvIHVzZSBhIHRlbXBvcmFyeQogICAgICAgICAgICAvLyBzZXR0aW5ncyBvYmplY3QgaGVyZS4KICAgICAgICAgICAgdmFyIGFuY2hvciA9IG5ldyBTZXR0aW5ncygpOwogICAgICAgICAgICBhbmNob3IucGVyY2VudCgieCIsIHh5WzBdKTsKICAgICAgICAgICAgYW5jaG9yLnBlcmNlbnQoInkiLCB4eVsxXSk7CiAgICAgICAgICAgIGlmICghYW5jaG9yLmhhcygieCIpIHx8ICFhbmNob3IuaGFzKCJ5IikpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXR0aW5ncy5zZXQoayArICJYIiwgYW5jaG9yLmdldCgieCIpKTsKICAgICAgICAgICAgc2V0dGluZ3Muc2V0KGsgKyAiWSIsIGFuY2hvci5nZXQoInkiKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAic2Nyb2xsIjoKICAgICAgICAgICAgc2V0dGluZ3MuYWx0KGssIHYsIFsidXAiXSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0sIC89LywgL1xzLyk7CgogICAgICAgIC8vIENyZWF0ZSB0aGUgcmVnaW9uLCB1c2luZyBkZWZhdWx0IHZhbHVlcyBmb3IgYW55IHZhbHVlcyB0aGF0IHdlcmUgbm90CiAgICAgICAgLy8gc3BlY2lmaWVkLgogICAgICAgIGlmIChzZXR0aW5ncy5oYXMoImlkIikpIHsKICAgICAgICAgIHZhciByZWdpb24gPSBuZXcgKHNlbGYudnR0anMuVlRUUmVnaW9uIHx8IHNlbGYud2luZG93LlZUVFJlZ2lvbikoKTsKICAgICAgICAgIHJlZ2lvbi53aWR0aCA9IHNldHRpbmdzLmdldCgid2lkdGgiLCAxMDApOwogICAgICAgICAgcmVnaW9uLmxpbmVzID0gc2V0dGluZ3MuZ2V0KCJsaW5lcyIsIDMpOwogICAgICAgICAgcmVnaW9uLnJlZ2lvbkFuY2hvclggPSBzZXR0aW5ncy5nZXQoInJlZ2lvbmFuY2hvclgiLCAwKTsKICAgICAgICAgIHJlZ2lvbi5yZWdpb25BbmNob3JZID0gc2V0dGluZ3MuZ2V0KCJyZWdpb25hbmNob3JZIiwgMTAwKTsKICAgICAgICAgIHJlZ2lvbi52aWV3cG9ydEFuY2hvclggPSBzZXR0aW5ncy5nZXQoInZpZXdwb3J0YW5jaG9yWCIsIDApOwogICAgICAgICAgcmVnaW9uLnZpZXdwb3J0QW5jaG9yWSA9IHNldHRpbmdzLmdldCgidmlld3BvcnRhbmNob3JZIiwgMTAwKTsKICAgICAgICAgIHJlZ2lvbi5zY3JvbGwgPSBzZXR0aW5ncy5nZXQoInNjcm9sbCIsICIiKTsKICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSByZWdpb24uCiAgICAgICAgICBzZWxmLm9ucmVnaW9uICYmIHNlbGYub25yZWdpb24ocmVnaW9uKTsKICAgICAgICAgIC8vIFJlbWVtYmVyIHRoZSBWVFRSZWdpb24gZm9yIGxhdGVyIGluIGNhc2Ugd2UgcGFyc2UgYW55IFZUVEN1ZXMgdGhhdAogICAgICAgICAgLy8gcmVmZXJlbmNlIGl0LgogICAgICAgICAgc2VsZi5yZWdpb25MaXN0LnB1c2goewogICAgICAgICAgICBpZDogc2V0dGluZ3MuZ2V0KCJpZCIpLAogICAgICAgICAgICByZWdpb246IHJlZ2lvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyAzLjIgV2ViVlRUIG1ldGFkYXRhIGhlYWRlciBzeW50YXgKICAgICAgZnVuY3Rpb24gcGFyc2VIZWFkZXIoaW5wdXQpIHsKICAgICAgICBwYXJzZU9wdGlvbnMoaW5wdXQsIGZ1bmN0aW9uIChrLCB2KSB7CiAgICAgICAgICBzd2l0Y2ggKGspIHsKICAgICAgICAgIGNhc2UgIlJlZ2lvbiI6CiAgICAgICAgICAgIC8vIDMuMyBXZWJWVFQgcmVnaW9uIG1ldGFkYXRhIGhlYWRlciBzeW50YXgKICAgICAgICAgICAgcGFyc2VSZWdpb24odik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0sIC86Lyk7CiAgICAgIH0KCiAgICAgIC8vIDUuMSBXZWJWVFQgZmlsZSBwYXJzaW5nLgogICAgICB0cnkgewogICAgICAgIHZhciBsaW5lOwogICAgICAgIGlmIChzZWxmLnN0YXRlID09PSAiSU5JVElBTCIpIHsKICAgICAgICAgIC8vIFdlIGNhbid0IHN0YXJ0IHBhcnNpbmcgdW50aWwgd2UgaGF2ZSB0aGUgZmlyc3QgbGluZS4KICAgICAgICAgIGlmICghL1xyXG58XG4vLnRlc3Qoc2VsZi5idWZmZXIpKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfQoKICAgICAgICAgIGxpbmUgPSBjb2xsZWN0TmV4dExpbmUoKTsKCiAgICAgICAgICB2YXIgbSA9IGxpbmUubWF0Y2goL15XRUJWVFQoWyBcdF0uKik/JC8pOwogICAgICAgICAgaWYgKCFtIHx8ICFtWzBdKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQYXJzaW5nRXJyb3IoUGFyc2luZ0Vycm9yLkVycm9ycy5CYWRTaWduYXR1cmUpOwogICAgICAgICAgfQoKICAgICAgICAgIHNlbGYuc3RhdGUgPSAiSEVBREVSIjsKICAgICAgICB9CgogICAgICAgIHZhciBhbHJlYWR5Q29sbGVjdGVkTGluZSA9IGZhbHNlOwogICAgICAgIHdoaWxlIChzZWxmLmJ1ZmZlcikgewogICAgICAgICAgLy8gV2UgY2FuJ3QgcGFyc2UgYSBsaW5lIHVudGlsIHdlIGhhdmUgdGhlIGZ1bGwgbGluZS4KICAgICAgICAgIGlmICghL1xyXG58XG4vLnRlc3Qoc2VsZi5idWZmZXIpKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghYWxyZWFkeUNvbGxlY3RlZExpbmUpIHsKICAgICAgICAgICAgbGluZSA9IGNvbGxlY3ROZXh0TGluZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxyZWFkeUNvbGxlY3RlZExpbmUgPSBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzd2l0Y2ggKHNlbGYuc3RhdGUpIHsKICAgICAgICAgIGNhc2UgIkhFQURFUiI6CiAgICAgICAgICAgIC8vIDEzLTE4IC0gQWxsb3cgYSBoZWFkZXIgKG1ldGFkYXRhKSB1bmRlciB0aGUgV0VCVlRUIGxpbmUuCiAgICAgICAgICAgIGlmICgvOi8udGVzdChsaW5lKSkgewogICAgICAgICAgICAgIHBhcnNlSGVhZGVyKGxpbmUpOwogICAgICAgICAgICB9IGVsc2UgaWYgKCFsaW5lKSB7CiAgICAgICAgICAgICAgLy8gQW4gZW1wdHkgbGluZSB0ZXJtaW5hdGVzIHRoZSBoZWFkZXIgYW5kIHN0YXJ0cyB0aGUgYm9keSAoY3VlcykuCiAgICAgICAgICAgICAgc2VsZi5zdGF0ZSA9ICJJRCI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICBjYXNlICJOT1RFIjoKICAgICAgICAgICAgLy8gSWdub3JlIE5PVEUgYmxvY2tzLgogICAgICAgICAgICBpZiAoIWxpbmUpIHsKICAgICAgICAgICAgICBzZWxmLnN0YXRlID0gIklEIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIGNhc2UgIklEIjoKICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBOT1RFIGJsb2Nrcy4KICAgICAgICAgICAgaWYgKC9eTk9URSgkfFsgXHRdKS8udGVzdChsaW5lKSkgewogICAgICAgICAgICAgIHNlbGYuc3RhdGUgPSAiTk9URSI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gMTktMjkgLSBBbGxvdyBhbnkgbnVtYmVyIG9mIGxpbmUgdGVybWluYXRvcnMsIHRoZW4gaW5pdGlhbGl6ZSBuZXcgY3VlIHZhbHVlcy4KICAgICAgICAgICAgaWYgKCFsaW5lKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5jdWUgPSBuZXcgKHNlbGYudnR0anMuVlRUQ3VlIHx8IHNlbGYud2luZG93LlZUVEN1ZSkoMCwgMCwgIiIpOwogICAgICAgICAgICBzZWxmLnN0YXRlID0gIkNVRSI7CiAgICAgICAgICAgIC8vIDMwLTM5IC0gQ2hlY2sgaWYgc2VsZiBsaW5lIGNvbnRhaW5zIGFuIG9wdGlvbmFsIGlkZW50aWZpZXIgb3IgdGltaW5nIGRhdGEuCiAgICAgICAgICAgIGlmIChsaW5lLmluZGV4T2YoIi0tPiIpID09PSAtMSkgewogICAgICAgICAgICAgIHNlbGYuY3VlLmlkID0gbGluZTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBQcm9jZXNzIGxpbmUgYXMgc3RhcnQgb2YgYSBjdWUuCiAgICAgICAgICAgIC8qZmFsbHMgdGhyb3VnaCovCiAgICAgICAgICBjYXNlICJDVUUiOgogICAgICAgICAgICAvLyA0MCAtIENvbGxlY3QgY3VlIHRpbWluZ3MgYW5kIHNldHRpbmdzLgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHBhcnNlQ3VlKGxpbmUsIHNlbGYuY3VlLCBzZWxmLnJlZ2lvbkxpc3QpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgc2VsZi5yZXBvcnRPclRocm93RXJyb3IoZSk7CiAgICAgICAgICAgICAgLy8gSW4gY2FzZSBvZiBhbiBlcnJvciBpZ25vcmUgcmVzdCBvZiB0aGUgY3VlLgogICAgICAgICAgICAgIHNlbGYuY3VlID0gbnVsbDsKICAgICAgICAgICAgICBzZWxmLnN0YXRlID0gIkJBRENVRSI7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5zdGF0ZSA9ICJDVUVURVhUIjsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICBjYXNlICJDVUVURVhUIjoKICAgICAgICAgICAgdmFyIGhhc1N1YnN0cmluZyA9IGxpbmUuaW5kZXhPZigiLS0+IikgIT09IC0xOwogICAgICAgICAgICAvLyAzNCAtIElmIHdlIGhhdmUgYW4gZW1wdHkgbGluZSB0aGVuIHJlcG9ydCB0aGUgY3VlLgogICAgICAgICAgICAvLyAzNSAtIElmIHdlIGhhdmUgdGhlIHNwZWNpYWwgc3Vic3RyaW5nICctLT4nIHRoZW4gcmVwb3J0IHRoZSBjdWUsCiAgICAgICAgICAgIC8vIGJ1dCBkbyBub3QgY29sbGVjdCB0aGUgbGluZSBhcyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGN1cnJlbnQKICAgICAgICAgICAgLy8gb25lIGFzIGEgbmV3IGN1ZS4KICAgICAgICAgICAgaWYgKCFsaW5lIHx8IGhhc1N1YnN0cmluZyAmJiAoYWxyZWFkeUNvbGxlY3RlZExpbmUgPSB0cnVlKSkgewogICAgICAgICAgICAgIC8vIFdlIGFyZSBkb25lIHBhcnNpbmcgc2VsZiBjdWUuCiAgICAgICAgICAgICAgc2VsZi5vbmN1ZSAmJiBzZWxmLm9uY3VlKHNlbGYuY3VlKTsKICAgICAgICAgICAgICBzZWxmLmN1ZSA9IG51bGw7CiAgICAgICAgICAgICAgc2VsZi5zdGF0ZSA9ICJJRCI7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNlbGYuY3VlLnRleHQpIHsKICAgICAgICAgICAgICBzZWxmLmN1ZS50ZXh0ICs9ICJcbiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5jdWUudGV4dCArPSBsaW5lOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIGNhc2UgIkJBRENVRSI6IC8vIEJBRENVRQogICAgICAgICAgICAvLyA1NC02MiAtIENvbGxlY3QgYW5kIGRpc2NhcmQgdGhlIHJlbWFpbmluZyBjdWUuCiAgICAgICAgICAgIGlmICghbGluZSkgewogICAgICAgICAgICAgIHNlbGYuc3RhdGUgPSAiSUQiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHNlbGYucmVwb3J0T3JUaHJvd0Vycm9yKGUpOwoKICAgICAgICAvLyBJZiB3ZSBhcmUgY3VycmVudGx5IHBhcnNpbmcgYSBjdWUsIHJlcG9ydCB3aGF0IHdlIGhhdmUuCiAgICAgICAgaWYgKHNlbGYuc3RhdGUgPT09ICJDVUVURVhUIiAmJiBzZWxmLmN1ZSAmJiBzZWxmLm9uY3VlKSB7CiAgICAgICAgICBzZWxmLm9uY3VlKHNlbGYuY3VlKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5jdWUgPSBudWxsOwogICAgICAgIC8vIEVudGVyIEJBRFdFQlZUVCBzdGF0ZSBpZiBoZWFkZXIgd2FzIG5vdCBwYXJzZWQgY29ycmVjdGx5IG90aGVyd2lzZQogICAgICAgIC8vIGFub3RoZXIgZXhjZXB0aW9uIG9jY3VycmVkIHNvIGVudGVyIEJBRENVRSBzdGF0ZS4KICAgICAgICBzZWxmLnN0YXRlID0gc2VsZi5zdGF0ZSA9PT0gIklOSVRJQUwiID8gIkJBRFdFQlZUVCIgOiAiQkFEQ1VFIjsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBmbHVzaDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHRyeSB7CiAgICAgICAgLy8gRmluaXNoIGRlY29kaW5nIHRoZSBzdHJlYW0uCiAgICAgICAgc2VsZi5idWZmZXIgKz0gc2VsZi5kZWNvZGVyLmRlY29kZSgpOwogICAgICAgIC8vIFN5bnRoZXNpemUgdGhlIGVuZCBvZiB0aGUgY3VycmVudCBjdWUgb3IgcmVnaW9uLgogICAgICAgIGlmIChzZWxmLmN1ZSB8fCBzZWxmLnN0YXRlID09PSAiSEVBREVSIikgewogICAgICAgICAgc2VsZi5idWZmZXIgKz0gIlxuXG4iOwogICAgICAgICAgc2VsZi5wYXJzZSgpOwogICAgICAgIH0KICAgICAgICAvLyBJZiB3ZSd2ZSBmbHVzaGVkLCBwYXJzZWQsIGFuZCB3ZSdyZSBzdGlsbCBvbiB0aGUgSU5JVElBTCBzdGF0ZSB0aGVuCiAgICAgICAgLy8gdGhhdCBtZWFucyB3ZSBkb24ndCBoYXZlIGVub3VnaCBvZiB0aGUgc3RyZWFtIHRvIHBhcnNlIHRoZSBmaXJzdAogICAgICAgIC8vIGxpbmUuCiAgICAgICAgaWYgKHNlbGYuc3RhdGUgPT09ICJJTklUSUFMIikgewogICAgICAgICAgdGhyb3cgbmV3IFBhcnNpbmdFcnJvcihQYXJzaW5nRXJyb3IuRXJyb3JzLkJhZFNpZ25hdHVyZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoKGUpIHsKICAgICAgICBzZWxmLnJlcG9ydE9yVGhyb3dFcnJvcihlKTsKICAgICAgfQogICAgICBzZWxmLm9uZmx1c2ggJiYgc2VsZi5vbmZsdXNoKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CgogIGdsb2JhbC5XZWJWVFQgPSBXZWJWVFQ7Cgp9KHRoaXMsICh0aGlzLnZ0dGpzIHx8IHt9KSkpOwoKIWZ1bmN0aW9uKCl7IWZ1bmN0aW9uKGEpe3ZhciBiPWEmJmEudmlkZW9qcztpZihiKXtiLkNETl9WRVJTSU9OPSI1LjQuNCI7dmFyIGM9Imh0dHBzOiI9PT1hLmxvY2F0aW9uLnByb3RvY29sPyJodHRwczovLyI6Imh0dHA6Ly8iO2Iub3B0aW9ucy5mbGFzaC5zd2Y9YysidmpzLnplbmNkbi5uZXQvc3dmLzUuMC4xL3ZpZGVvLWpzLnN3ZiJ9fSh3aW5kb3cpLGZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe2ImJmIuSEVMUF9JTVBST1ZFX1ZJREVPSlMhPT0hMSYmKGUucmFuZG9tKCk+LjAxfHwoZj1iLmxvY2F0aW9uLGc9Yi52aWRlb2pzfHx7fSxhLnNyYz0iLy93d3cuZ29vZ2xlLWFuYWx5dGljcy5jb20vX191dG0uZ2lmP3V0bXd2PTUuNC4yJnV0bWFjPVVBLTE2NTA1Mjk2LTMmdXRtbj0xJnV0bWhuPSIrZChmLmhvc3RuYW1lKSsiJnV0bXNyPSIrYi5zY3JlZW4uYXZhaWxXaWR0aCsieCIrYi5zY3JlZW4uYXZhaWxIZWlnaHQrIiZ1dG11bD0iKyhjLmxhbmd1YWdlfHxjLnVzZXJMYW5ndWFnZXx8IiIpLnRvTG93ZXJDYXNlKCkrIiZ1dG1yPSIrZChmLmhyZWYpKyImdXRtcD0iK2QoZi5ob3N0bmFtZStmLnBhdGhuYW1lKSsiJnV0bWNjPV9fdXRtYSUzRDEuIitlLmZsb29yKDFlMTAqZS5yYW5kb20oKSkrIi4xLjEuMS4xJTNCJnV0bWU9OCh2anN2KmNkbnYpOSgiK2cuVkVSU0lPTisiKiIrZy5DRE5fVkVSU0lPTisiKSIpKX0obmV3IEltYWdlLHdpbmRvdyxuYXZpZ2F0b3IsZW5jb2RlVVJJQ29tcG9uZW50LE1hdGgpfSgpOw=="></script>

</body>
</html>
